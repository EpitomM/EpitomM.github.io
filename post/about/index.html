<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="keywords" content="Grideaé™æ€ä¸ªäººåšå®¢">
<meta name="description" content="çƒ­å¿ƒå–„è‰¯çš„è€å­¦å§">
<meta name="theme-color" content="#000">
<title>å…³äº | SSM</title>
<link rel="shortcut icon" href="/favicon.ico?v=1589639744111">
<link rel="stylesheet" href="/media/css/gemini.css">
<link rel="stylesheet" href="/media/fonts/font-awesome.css">
<link
  href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Rosario:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext"
  rel="stylesheet" type="text/css">

<link href="/media/hljs/styles/androidstudio.css"
  rel="stylesheet">

<link rel="stylesheet" href="/styles/main.css">

<script src="/media/hljs/highlight.js"></script>
<script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.0/velocity.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.0/velocity.ui.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"
  integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"
  integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"
  integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
  onload="renderMathInElement(document.body);"></script>





  <meta name="description" content="å…³äº" />
  <meta name="keywords" content="" />
</head>

<body>
  <div class="head-top-line"></div>
  <div class="header-box">
    
<div class="gemini">
  <header class="header  ">
    <div class="blog-header box-shadow-wrapper bg-color " id="header">
      <div class="nav-toggle" id="nav_toggle">
        <div class="toggle-box">
          <div class="line line-top"></div>
          <div class="line line-center"></div>
          <div class="line line-bottom"></div>
        </div>
      </div>
      <div class="site-meta">       
        <div class="site-title">
          
            <a href="/" class="brand">
              <span>SSM</span>
            </a>  
          
        </div>
        
          <p class="subtitle">ä¸€ä¸ªæ•²çƒ­å¿ƒçš„è€å­¦å§</p>
        
      </div>
      <nav class="site-nav" id="site_nav">
        <ul id="nav_ul">
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/" target="_self">
                  <i class="fa fa-home"></i> é¦–é¡µ
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/archives/" target="_self">
                  <i class="fa fa-archive"></i> å½’æ¡£
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/tags/" target="_self">
                  <i class="fa fa-tags"></i> æ ‡ç­¾
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/post/about/" target="_self">
                  <i class="fa fa-user"></i> å…³äº
                </a>
              
            </li>
          
          
            
              <li class="nav-item ">
                <a href="/friends/" target="_self">
                  
                    <i class="fa fa-address-book"></i> å‹æƒ…é“¾æ¥
                  
                </a>
              </li>
            
          
          
            <li id="fa_search" class="nav-item">
              <a href="javascript:void(0);">
                <i class="fa fa-search"></i> <span class="language" data-lan="search">æœç´¢</span>
              </a>
            </li>
          
        </ul>
      </nav>
    </div>
  </header>
</div>

<script type="text/javascript"> 
 
  let showNav = true;

  let navToggle = document.querySelector('#nav_toggle'),
  siteNav = document.querySelector('#site_nav');
  
  function navClick() {
    let sideBar = document.querySelector('.sidebar');
    let navUl = document.querySelector('#nav_ul');
    navToggle.classList.toggle('nav-toggle-active');
    siteNav.classList.toggle('nav-menu-active');
    if (siteNav.classList.contains('nav-menu-active')) {
      siteNav.style = "height: " + (navUl.children.length * 42) +"px !important";
    } else {
      siteNav.style = "";
    }
  }

  navToggle.addEventListener('click',navClick);  
</script>
  </div>
  <div class="main-continer">
    
    <div
      class="section-layout gemini ">
      <div class="section-layout-wrapper">
        

<div class="sidebar">
  
    <div class="sidebar-box box-shadow-wrapper bg-color right-motion" id="sidebar">
      
        <div class="post-list-sidebar">
          <div class="sidebar-title">
            <span id="tocSideBar" class="sidebar-title-item sidebar-title-active language" data-lan="index">æ–‡ç« ç›®å½•</span>
            <span id="metaSideBar" class="sidebar-title-item language" data-lan="preview">ç«™ç‚¹æ¦‚è§ˆ</span>
          </div>
        </div>
      
      <div class="sidebar-body gemini" id="sidebar_body">
        
          
            <div class="post-side-meta" id="post_side_meta">
              
<div class="sidebar-wrapper box-shadow-wrapper bg-color">
  <div class="sidebar-item">
    <img class="site-author-image right-motion" src="/images/avatar.png"/>
    <p class="site-author-name">SSM</p>
    
  </div>
  <div class="sidebar-item side-item-stat right-motion">
    <div class="sidebar-item-box">
      <a href="/archives/">
        
        <span class="site-item-stat-count">40</span>
        <span class="site-item-stat-name language" data-lan="article">æ–‡ç« </span>
      </a>
    </div>
    <div class="sidebar-item-box">
      <a href="">
        <span class="site-item-stat-count">19</span>
        <span class="site-item-stat-name language" data-lan="category">åˆ†ç±»</span>
      </a>
    </div>
    <div class="sidebar-item-box">
      <a href="/tags/">
        <span class="site-item-stat-count">19</span>
        <span class="site-item-stat-name language" data-lan="tag">æ ‡ç­¾</span>
      </a>
    </div>
  </div>
  
    
  
  


</div>
            </div>
            <div class="post-toc sidebar-body-active" id="post_toc" style="opacity: 1;">
              <div class="toc-box right-motion">
  <div class="toc-wrapper auto-number auto"
    id="toc_wrapper">
    <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#%E5%85%B3%E4%BA%8E%E6%9C%AC%E7%AB%99">ğŸ  å…³äºæœ¬ç«™</a></li>
<li><a href="#%E5%8D%9A%E4%B8%BB%E6%98%AF%E8%B0%81">ğŸ‘¨â€ğŸ’» åšä¸»æ˜¯è°</a></li>
<li><a href="#%E8%81%94%E7%B3%BB%E6%88%91%E5%91%80">ğŸ“¬ è”ç³»æˆ‘å‘€</a></li>
</ul>
</li>
</ul>

  </div>
</div>

<script>

  let lastTop = 0, lList = [], hList = [], postBody, lastIndex = -1;
  let active = 'active-show', activeClass = 'active-current';
  let tocWrapper = document.querySelector('#toc_wrapper');
  let tocContent = tocWrapper.children[0];
  let autoNumber = tocWrapper && tocWrapper.classList.contains('auto-number');

  function addTocNumber(elem, deep) {
    if (!elem) {
      return;
    }
    let prop = elem.__proto__;

    if (prop === HTMLUListElement.prototype) {
      for (let i = 0; i < elem.children.length; i++) {
        addTocNumber(elem.children[i], deep + (i + 1) + '.');
      }
    } else if (prop === HTMLLIElement.prototype) {
      // ä¿å­˜liå…ƒç´ 
      if (elem.children[0].__proto__ === HTMLAnchorElement.prototype) {
        lList.push(elem);
      }
      for (let i = 0; i < elem.children.length; i++) {
        let cur = elem.children[i];
        if (cur.__proto__ === HTMLAnchorElement.prototype) {
          if (autoNumber) {
            cur.text = deep + ' ' + cur.text;
          }
        } else if (cur.__proto__ === HTMLUListElement.prototype) {
          addTocNumber(cur, deep);
        }
      }
    }
  }

  function removeParentActiveClass() {
    let parents = tocContent.querySelectorAll('.' + active)
    parents.forEach(function (elem) {
      elem.classList.remove(active);
    });
  }

  function addActiveClass(index) {
    if (index >= 0 && index < hList.length) {
      lList[index].classList.add(activeClass);
    }
  }

  function removeActiveClass(index) {
    if (index >= 0 && index < hList.length) {
      lList[index].classList.remove(activeClass);
    }
  }

  function addActiveLiElemment(elem, parent) {
    if (!elem || elem === parent) {
      return;
    } else {
      if (elem.__proto__ === HTMLLIElement.prototype) {
        elem.classList.add(active);
      }
      addActiveLiElemment(elem.parentElement, parent);
    }
  }

  function showToc() {
    if (tocWrapper) {
      postBody = document.querySelector('#post_body');
      for (let i = 0; i < postBody.children.length; i++) {
        if (postBody.children[i].__proto__ === HTMLHeadingElement.prototype) {
          hList.push(postBody.children[i]);
        }
      }
      if (tocWrapper.classList.contains('compress')) {
        tocContent.classList.add('closed');
      } else if (tocWrapper.classList.contains('no_compress')) {
        tocContent.classList.add('expanded');
      } else {
        if (hList.length > 10) {
          active = 'active-hidden'
          tocContent.classList.add('closed');
        } else {
          tocContent.classList.add('expanded');
        }
      }
    }
  }

  (function () {
    // å¤„ç†ä¸æ˜¯ä»#ä¸€çº§æ ‡é¢˜å¼€å§‹ç›®å½•
    if (tocContent.children.length === 1 && tocContent.children[0].__proto__ === HTMLLIElement.prototype) {
      let con = tocContent.children[0].children[0];
      tocContent.innerHTML = con.innerHTML;
    }
    let markdownItTOC = document.querySelector('.markdownIt-TOC');
    let innerHeight = window.innerHeight;
    markdownItTOC.style = `max-height: ${innerHeight - 80 > 0 ? innerHeight - 80 : innerHeight}px`
    addTocNumber(tocContent, '');
  })();

  document.addEventListener('scroll', function (e) {
    if (lList.length <= 0) {
      return;
    }
    let scrollTop = document.scrollingElement.scrollTop + 10;
    let dir;

    if (lastTop - scrollTop > 0) {
      dir = 'up';
    } else {
      dir = 'down';
    }

    lastTop = scrollTop;
    if (scrollTop <= 0) {
      if (lastIndex >= 0 && lastIndex < hList.length) {
        lList[lastIndex].classList.remove(activeClass);
      }
      return;
    }

    let current = 0, hasFind = false;
    for (let i = 0; i < hList.length; i++) {
      if (hList[i].offsetTop > scrollTop) {
        current = i;
        hasFind = true;
        break;
      }
    }
    if (!hasFind && scrollTop > lList[lList.length - 1].offsetTop) {
      current = hList.length - 1;
    } else {
      current--;
    }
    if (dir === 'down') {
      if (current > lastIndex) {
        addActiveClass(current);
        removeActiveClass(lastIndex)
        lastIndex = current;
        removeParentActiveClass();
        lList[current] && addActiveLiElemment(lList[current].parentElement, tocContent);
      }
    } else {
      if (current < lastIndex) {
        addActiveClass(current);
        removeActiveClass(lastIndex);
        lastIndex = current;
        removeParentActiveClass();
        lList[current] && addActiveLiElemment(lList[current].parentElement, tocContent);
      }
    }
  });


  window.addEventListener('load', function () {
    showToc();
    document.querySelector('#sidebar').style = 'display: block;';
    tocWrapper.classList.add('toc-active');
    setTimeout(function () {
      if ("createEvent" in document) {
        let evt = document.createEvent("HTMLEvents");
        evt.initEvent("scroll", false, true);
        document.dispatchEvent(evt);
      }
      else {
        document.fireEvent("scroll");
      }
    }, 500)
  })

</script>
            </div>
          
        
      </div>
    </div>
  
</div>
<script>
  const SIDEBAR_TITLE_ACTIVE = 'sidebar-title-active';
  const SIDEBAR_BODY_ACTIVE = 'sidebar-body-active';
  const SLIDE_UP_IN = 'slide-up-in';

  let sidebar = document.querySelector('#sidebar'),
  tocSideBar = document.querySelector('#tocSideBar'),
  metaSideBar = document.querySelector('#metaSideBar'),
  postToc = document.querySelector('#post_toc'),
  postSiteMeta = document.querySelector('#post_side_meta'),
  sidebarTitle = document.querySelector('.sidebar-title'),
  sidebarBody = document.querySelector('#sidebar_body');

  tocSideBar && tocSideBar.addEventListener('click', (e) => {
    toggleSidebar(e);
  });

  metaSideBar && metaSideBar.addEventListener('click', (e) => {
    toggleSidebar(e);
  });

  function toggleSidebar(e) {
    let currentTitle = document.querySelector("."+SIDEBAR_TITLE_ACTIVE);
    if (currentTitle == e.srcElement) {
      return ;
    }
    let current, showElement, hideElement;
    if (e.srcElement == metaSideBar) {
      showElement = postSiteMeta;
      hideElement = postToc;
    } else if (e.srcElement == tocSideBar){
      showElement = postToc;
      hideElement = postSiteMeta;
    }
    currentTitle.classList.remove(SIDEBAR_TITLE_ACTIVE);
    e.srcElement.classList.add(SIDEBAR_TITLE_ACTIVE);

    window.Velocity(hideElement, 'stop');
    window.Velocity(hideElement, 'transition.slideUpOut', {
      display: 'none',
      duration: 200,
      complete: function () {
        window.Velocity(showElement, 'transition.slideDownIn', {
          duration: 200
        });
      }
    })
    hideElement.classList.remove(SIDEBAR_BODY_ACTIVE);
    showElement.classList.add(SIDEBAR_BODY_ACTIVE);
  }

  postToc && postToc.addEventListener('transitionend', function() {
    this.classList.remove(SLIDE_UP_IN);
  });

  if (sidebarBody) {
    if (sidebarBody.classList.contains('pisces') || sidebarBody.classList.contains('gemini')) {
      let hasFix = false;
      let scrollEl = document.querySelector('.main-continer');
      let limitTop = document.querySelector('#nav_ul').children.length * 42 + 162;
      window.addEventListener('scroll', function(e) {
        if (document.scrollingElement.scrollTop >= limitTop) {
          if (!hasFix) {
            sidebar.classList.add('sidebar-fixed');
            hasFix = true;
          }
        } else {
          if (hasFix) {
            sidebar.classList.remove('sidebar-fixed');
            hasFix = false;
          }
        }
      });
    }
  }
  
</script>
        <div class="section-box box-shadow-wrapper">
          <div class="section bg-color post post-page">
            <header class="post-header">
  <h1 class="post-title">
    <a class="post-title-link" href="https://epitomm.github.io/post/about/">
      å…³äº
    </a>
  </h1>
  <div class="post-meta">
    
    <span class="meta-item pc-show">
      <i class="fa fa-calendar-o"></i>
      <span class="language" data-lan="publish">å‘å¸ƒäº</span>
      <span>2019-01-25</span>
      <span class="post-meta-divider pc-show">|</span>
    </span>
    
    <span class="meta-item">
      <i class="fa fa-clock-o"></i>
      <span>1<span class="language" data-lan="minute">åˆ†é’Ÿ</span></span>
    </span>
    <span class="meta-item">
      <span class="post-meta-divider">|</span>
      <i class="fa fa-file-word-o"></i>
      <span>193<span class="pc-show language" data-lan="words">å­—æ•°</span></span>
    </span>
    
  </div>
</header>
            <div class="post-body next-md-body" id="post_body">
              <blockquote>
<p>æ¬¢è¿æ¥åˆ°æˆ‘çš„å°ç«™å‘€ï¼Œå¾ˆé«˜å…´é‡è§ä½ ï¼ğŸ¤</p>
</blockquote>
<h2 id="å…³äºæœ¬ç«™">ğŸ  å…³äºæœ¬ç«™</h2>
<p>æœ¬ç«™æ˜¯ä½¿ç”¨ <code>Gridea</code> æ­å»ºçš„åšå®¢ã€‚</p>
<h2 id="åšä¸»æ˜¯è°">ğŸ‘¨â€ğŸ’» åšä¸»æ˜¯è°</h2>
<p>åšä¸»æ˜¯ä¸€ä¸ª<strong>çƒ­æƒ…è€å¿ƒ</strong>ï¼Œç›®å‰æ­£å‡†å¤‡æ‰¾å·¥ä½œçš„è€å­¦å§å‘€ï¼Œå¦‚æœæœ‰å¿—åŒé“åˆæƒ³è¦ä¸€èµ·å­¦ä¹ çš„å°ä¼™ä¼´ï¼Œæ¬¢è¿è”ç³»æˆ‘ä¸€èµ·å­¦ä¹ è¿›æ­¥å‘€ï¼›å¦‚æœæœ‰å¯¹å‰è·¯è¿·èŒ«ä¸çŸ¥æ‰€æªçš„å­¦å¼Ÿå­¦å¦¹ï¼Œä¹Ÿæ¬¢è¿è”ç³»æˆ‘æŠŠæˆ‘å­¦ä¹ çš„ç»éªŒä¼ æˆç»™ä½ ä»¬ï¼Œä¸æ•¢è¯´åšä½ ä»¬çš„æŒ‡è·¯æ˜ç¯ï¼Œä½†è‡³å°‘ä¼šè®©ä½ ä»¬åšå®šä¿¡å¿ƒã€ä¸å†ä¸çŸ¥æ‰€æªï¼›å¦‚æœæœ‰é—®é¢˜æƒ³å‘æˆ‘è¯·æ•™ï¼Œä¹Ÿæ¬¢è¿éšæ—¶æ¥æ‰¾æˆ‘å‘€ï¼Œæˆ‘æ˜¯çœŸçš„å¸®åŠ©å¾ˆå¤šäººè§£å†³è¿‡å„ç§<code>bug</code> çš„ã€‚</p>
<h2 id="è”ç³»æˆ‘å‘€">ğŸ“¬ è”ç³»æˆ‘å‘€</h2>
<p><a href="tencent://AddContact/?fromId=45&amp;fromSubId=1&amp;subcmd=all&amp;uin=985317010&amp;website=www.oicqzone.com">QQ</a><br>
é‚®ç®±ï¼š985317010@qq.com</p>

            </div>
            
            
  
    
      <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container"></div>

<script>
  var gitalk = new Gitalk({
    clientID: '974bd77fbbd52c2a0647',
    clientSecret: '6344370ca1314dbd553f45e75a2121a160ef1c44',
    repo: 'EpitomM.github.io',
    owner: 'EpitomM',
    admin: ['EpitomM'],
    id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
    distractionFreeMode: false  // Facebook-like distraction free mode
  })
  gitalk.render('gitalk-container')
</script>
    
    
  

          </div>
        </div>
      </div>
    </div>
    <div class="footer-box">
  <footer class="footer">
    <div class="copyright">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | Â© 2019-2020 Theme By <a href="https://github.com/hsxyhao/gridea-theme-next" target="_blank">HsxyHao</a>
    </div>
    <div class="poweredby">
      Powered by <a href="https://github.com/EpitomM/EpitomM.github.io" target="_blank">EpitomM</a>
    </div>
  </footer>
  
  
  <div class="gemini back-to-top" id="back_to_top">
    <i class="fa fa-arrow-up"></i>
    
    <span class="scrollpercent">
      <span id="back_to_top_text">0</span>%
    </span>
    
  </div>
  
    
    <div class="bg-img">
      <img src="\media\images\custom-bgImg.png" />
    </div>
  
  
  
</div>
<script>

  let sideBarOpen = 'sidebar-open';
  let body = document.body;
  let back2Top = document.querySelector('#back_to_top'),
  back2TopText = document.querySelector('#back_to_top_text'),
  drawerBox = document.querySelector('#drawer_box'),
  rightSideBar = document.querySelector('.sidebar'),
  viewport = document.querySelector('body');

  function scrollAnimation(currentY, targetY) {
   
    let needScrollTop = targetY - currentY
    let _currentY = currentY
    setTimeout(() => {
      const dist = Math.ceil(needScrollTop / 10)
      _currentY += dist
      window.scrollTo(_currentY, currentY)
      if (needScrollTop > 10 || needScrollTop < -10) {
        scrollAnimation(_currentY, targetY)
      } else {
        window.scrollTo(_currentY, targetY)
      }
    }, 1)
  }

  back2Top.addEventListener("click", function(e) {
    scrollAnimation(document.scrollingElement.scrollTop, 0);
    e.stopPropagation();
    return false;
  });
  
  window.addEventListener('scroll', function(e) {
    let percent = document.scrollingElement.scrollTop / (document.scrollingElement.scrollHeight - document.scrollingElement.clientHeight) * 100;
    if (percent > 1 && !back2Top.classList.contains('back-top-active')) {
      back2Top.classList.add('back-top-active');
    }
    if (percent == 0) {
      back2Top.classList.remove('back-top-active');
    }
    if (back2TopText) {
      back2TopText.textContent = Math.floor(percent);
    }
  });

  
  let hasCacu = false;
  window.onresize = function() {
    if (window.width > 991) {
      calcuHeight();
    } else {
      hasCacu = false;
    }
  }

  function calcuHeight() {
    // åŠ¨æ€è°ƒæ•´ç«™ç‚¹æ¦‚è§ˆé«˜åº¦
    if (!hasCacu && back2Top.classList.contains('pisces') || back2Top.classList.contains('gemini')) {
      let sideBar = document.querySelector('.sidebar');
      let navUl = document.querySelector('#site_nav');
      sideBar.style = 'margin-top:' + (navUl.offsetHeight + navUl.offsetTop + 15) + 'px;';
      hasCacu = true;
    }
  }
  calcuHeight();
  
  let open = false, MOTION_TIME = 300, RIGHT_MOVE_DIS = '320px';

  if (drawerBox) {
    let rightMotions = document.querySelectorAll('.right-motion');
    let right = drawerBox.classList.contains('right');

    let transitionDir = right ? "transition.slideRightIn" : "transition.slideLeftIn";

    let openProp, closeProp;
    if (right) {
      openProp = {
        paddingRight: RIGHT_MOVE_DIS 
      };
      closeProp = {
        paddingRight: '0px'
      };
    } else {
      openProp = {
        paddingLeft: RIGHT_MOVE_DIS 
      };
      closeProp = {
        paddingLeft: '0px'
      };
    }

    drawerBox.onclick = function() {
      open = !open;
      window.Velocity(rightSideBar, 'stop');
      window.Velocity(viewport, 'stop');
      window.Velocity(rightMotions, 'stop');
      if (open) {
        window.Velocity(rightSideBar, {
          width: RIGHT_MOVE_DIS
        }, {
          duration: MOTION_TIME,
          begin: function() {
            window.Velocity(rightMotions, transitionDir,{ });
          }
        })
        window.Velocity(viewport, openProp,{
          duration: MOTION_TIME
        });
      } else {
        window.Velocity(rightSideBar, {
          width: '0px'
        }, {
          duration: MOTION_TIME,
          begin: function() {
            window.Velocity(rightMotions, {
              opacity: 0
            });
          }
        })
        window.Velocity(viewport, closeProp ,{
          duration: MOTION_TIME
        });
      }
      for (let i = 0; i < drawerBox.children.length; i++) {
        drawerBox.children[i].classList.toggle('muse-line');
      }
      drawerBox.classList.toggle(sideBarOpen);
    }
  }

  // é“¾æ¥è·³è½¬
  let newWindow = 'false'
  if (newWindow === 'true') {
    let links = document.querySelectorAll('.post-body a')
    links.forEach(item => {
      if (!item.classList.contains('btn')) {
        item.setAttribute("target","_blank");
      }
    })
  }

  let faSearch = document.querySelector('#fa_search');
  faSearch.addEventListener('click', function() {
    document.querySelector('#search_mask').style = ''
  })

  // ä»£ç é«˜äº®
  hljs.initHighlightingOnLoad();

</script>
    <div class="light-box" id="light_box"></div>
<script>
  let imgs = document.querySelectorAll('.post-body img');
  let lightBox = document.querySelector('#light_box');
  lightBox.addEventListener('mousedown', (e) => {
    e.preventDefault()
  })
  lightBox.addEventListener('mousewheel', (e) => {
    e.preventDefault()
  })
  let width = window.innerWidth * 0.8;
  lightBox.onclick = () => {
    let img = lightBox.querySelector('img');
    lightBox.style = '';
    img && img.remove();
  }
  imgs.forEach(item => {
    item.onclick = function (e) {
      let lightImg = document.createElement('img');
      lightImg.src = this.src;
      lightBox.style = `height: 100%; opacity: 1; background-color: rgba(0, 0, 0, 0.5);cursor: zoom-out;`;
      lightImg.style = `width: ${width}px; border: 1px solid #fff; border-radius: 2px;`;
      lightImg.onclick = function () {
        lightBox.style = '';
        this.remove();
      }
      lightBox.append(lightImg);
    }
  })
</script>
  </div>
</body>

  <div class="search-mask" id="search_mask" style="display: none;">
  <div class="search-box">
    <div class="search-title">
      <i class="fa fa-search"></i>
      <div class="input-box">
        <input id="search" type="text" class="language" data-lan="search" placeholder="æœç´¢">
      </div>
      <i id="close" class="fa fa-times-circle"></i>
    </div>
    <div class="stat-box">
      <span id="stat_count">0</span><span class="language" data-lan="stat">æ¡ç›¸å…³æ¡ç›®ï¼Œä½¿ç”¨äº†</span><span id="stat_times">0</span><span class="language" data-lan="stat-time">æ¯«ç§’</span>
      <hr>
    </div>
    <div class="result" id="result">
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/spring-xi-lie-shi-spring-yuan-ma/"" data-c="
          &lt;h1 id=&#34;processconfigurationclass&#34;&gt;processConfigurationClass&lt;/h1&gt;
&lt;p&gt;context.&lt;em&gt;refresh&lt;/em&gt;(); ---&amp;gt;Â &lt;em&gt;invokeBeanFactoryPostProcessors&lt;/em&gt;(beanFactory); ---&amp;gt; PostProcessorRegistrationDelegate.invokeBeanFactoryPostProcessors(beanFactory, getBeanFactoryPostProcessors()); ---&amp;gt;invokeBeanDefinitionRegistryPostProcessors(currentRegistryProcessors,Â registry); ---&amp;gt; postProcessor.&lt;em&gt;postProcessBeanDefinitionRegistry&lt;/em&gt;(registry); ---&amp;gt;Â &lt;em&gt;processConfigBeanDefinitions&lt;/em&gt;(registry);å¤„ç†@Configuration ---&amp;gt; parser.parse(candidates); è§£ææ³¨è§£å¯¹è±¡---&amp;gt; parse(((AnnotatedBeanDefinition) bd).getMetadata(), holder.getBeanName()); ---&amp;gt; processConfigurationClass(new ConfigurationClass(metadata, beanName)); å¤„ç†Import---&amp;gt; sourceClass = doProcessConfigurationClass(configClass, sourceClass); ---&amp;gt; this.componentScanParser.parse(componentScan, sourceClass.getMetadata().getClassName()); ---&amp;gt; scanner.doScan(StringUtils.toStringArray(basePackages));æ‰«æåŒ…&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;protected void processConfigurationClass(ConfigurationClass configClass) throws IOException {
   // åˆ¤æ–­æ˜¯å¦åº”è¯¥è·³è¿‡è§£æ
   if (this.conditionEvaluator.shouldSkip(configClass.getMetadata(), ConfigurationPhase.PARSE_CONFIGURATION)) {
      return;
   }
   // å¤„ç† Imported çš„æƒ…å†µ
   // å°±æ˜¯å½“å‰è¿™ä¸ªç±»æœ‰æ²¡æœ‰è¢«åˆ«çš„ç±» @Import
   ConfigurationClass existingClass = this.configurationClasses.get(configClass);
   if (existingClass != null) {
      if (configClass.isImported()) {
         if (existingClass.isImported()) {
            existingClass.mergeImportedBy(configClass);
         }
         // Otherwise ignore new imported config class; existing non-imported class overrides it.
         return;
      }
      else {
         // Explicit bean definition found, probably replacing an import.
         // Let&#39;s remove the old one and go with the new one.
         this.configurationClasses.remove(configClass);
         this.knownSuperclasses.values().removeIf(configClass::equals);
      }
   }
   // Recursively process the configuration class and its superclass hierarchy.
   SourceClass sourceClass = asSourceClass(configClass);
   do {
      sourceClass = doProcessConfigurationClass(configClass, sourceClass);
   }
   while (sourceClass != null);
   // ä¸€ä¸ª mapï¼Œç”¨æ¥å­˜æ”¾æ‰«æå‡ºæ¥çš„ beanï¼ˆæ³¨æ„è¿™é‡Œçš„ bean ä¸æ˜¯å¯¹è±¡ï¼Œä»…ä»…æ˜¯ bean çš„ä¿¡æ¯ï¼Œå› ä¸ºè¿˜æ²¡åˆ°å®ä¾‹åŒ–ï¼‰
   this.configurationClasses.put(configClass, configClass);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;æ‰«ææ™®é€šç±»componentå¹¶æ”¾åˆ°-map-ä¸­&#34;&gt;æ‰«ææ™®é€šç±»@Componentï¼Œå¹¶æ”¾åˆ° map ä¸­&lt;/h2&gt;
&lt;h3 id=&#34;doprocessconfigurationclass&#34;&gt;doProcessConfigurationClass&lt;/h3&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 29 è¡Œï¼šè§£ææ³¨è§£ç±»&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;protected final SourceClass doProcessConfigurationClass(ConfigurationClass configClass, SourceClass sourceClass)
      throws IOException {
   // Recursively process any member (nested) classes first
   // å¤„ç†å†…éƒ¨ç±»
   processMemberClasses(configClass, sourceClass);
   // Process any @PropertySource annotations
   for (AnnotationAttributes propertySource : AnnotationConfigUtils.attributesForRepeatable(
         sourceClass.getMetadata(), PropertySources.class,
         org.springframework.context.annotation.PropertySource.class)) {
      if (this.environment instanceof ConfigurableEnvironment) {
         processPropertySource(propertySource);
      }
      else {
         logger.warn(&amp;quot;Ignoring @PropertySource annotation on [&amp;quot; + sourceClass.getMetadata().getClassName() +
               &amp;quot;]. Reason: Environment must implement ConfigurableEnvironment&amp;quot;);
      }
   }
   // Process any @ComponentScan annotations
   Set&amp;lt;AnnotationAttributes&amp;gt; componentScans = AnnotationConfigUtils.attributesForRepeatable(
         sourceClass.getMetadata(), ComponentScans.class, ComponentScan.class);
   if (!componentScans.isEmpty() &amp;amp;&amp;amp;
         !this.conditionEvaluator.shouldSkip(sourceClass.getMetadata(), ConfigurationPhase.REGISTER_BEAN)) {
      for (AnnotationAttributes componentScan : componentScans) {
         // The config class is annotated with @ComponentScan -&amp;gt; perform the scan immediately
         // æ‰«ææ™®é€šç±»=componentScan=com.ssm
         // è¿™é‡Œæ‰«æå‡ºæ¥æ‰€æœ‰ @Component
         Set&amp;lt;BeanDefinitionHolder&amp;gt; scannedBeanDefinitions =
               this.componentScanParser.parse(componentScan, sourceClass.getMetadata().getClassName());
         // Check the set of scanned definitions for any further config classes and parse recursively if needed
         // æ£€æŸ¥æ‰«æå‡ºæ¥çš„ç±»å½“ä¸­æ˜¯å¦è¿˜æœ‰ Configuration
         for (BeanDefinitionHolder holder : scannedBeanDefinitions) {
            BeanDefinition bdCand = holder.getBeanDefinition().getOriginatingBeanDefinition();
            if (bdCand == null) {
               bdCand = holder.getBeanDefinition();
            }
            if (ConfigurationClassUtils.checkConfigurationClassCandidate(bdCand, this.metadataReaderFactory)) {
               parse(bdCand.getBeanClassName(), holder.getBeanName());
            }
         }
      }
   }
   /**
    * ä¸Šé¢çš„ä»£ç å°±æ˜¯æ‰«ææ™®é€šç±»â€”â€”@Component
    * å¹¶ä¸”æ”¾åˆ°äº†mapå½“ä¸­
    */
   // Process any @Import annotations
   // å¤„ç† @Importï¼šä¸‰ç§æƒ…å†µ
   // ImportSelectorã€ImportBeanDefinitionRegistrarã€æ™®é€šç±»
   /**
    * è¿™é‡Œå¤„ç†çš„ import æ˜¯éœ€è¦åˆ¤æ–­æˆ‘ä»¬çš„ç±»å½“ä¸­æ˜¯å¦æœ‰@Importæ³¨è§£ï¼š getImports(sourceClass)
    * å¦‚æœæœ‰ @Import æ³¨è§£ï¼Œå°±æŠŠè¿™ä¸ªå€¼æ‹¿å‡ºæ¥ï¼Œæ˜¯ä¸€ä¸ªç±»
    * æ¯”å¦‚ @Import(xxxx.class)ï¼Œé‚£ä¹ˆè¿™é‡Œä¾¿æŠŠ xxxx ä¼ è¿›å»è¿›è¡Œè§£æ
    * åœ¨è§£æçš„è¿‡ç¨‹ä¸­å¦‚æœå‘è§‰æ˜¯ä¸€ä¸ª importSelector é‚£ä¹ˆå°±å›è°ƒ selector çš„æ–¹æ³•
    * è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ˆç±»åï¼‰ï¼Œé€šè¿‡è¿™ä¸ªå­—ç¬¦ä¸²å¾—åˆ°ä¸€ä¸ªç±»
    * ç»§è€Œåœ¨é€’å½’è°ƒç”¨æœ¬æ–¹æ³•æ¥å¤„ç†è¿™ä¸ªç±»
    *
    * åˆ¤æ–­ä¸€ç»„ç±»æ˜¯ä¸æ˜¯ imports(3ç§import)
    */
   processImports(configClass, sourceClass, getImports(sourceClass), true);
   // Process any @ImportResource annotations
   AnnotationAttributes importResource =
         AnnotationConfigUtils.attributesFor(sourceClass.getMetadata(), ImportResource.class);
   if (importResource != null) {
      String[] resources = importResource.getStringArray(&amp;quot;locations&amp;quot;);
      Class&amp;lt;? extends BeanDefinitionReader&amp;gt; readerClass = importResource.getClass(&amp;quot;reader&amp;quot;);
      for (String resource : resources) {
         String resolvedResource = this.environment.resolveRequiredPlaceholders(resource);
         configClass.addImportedResource(resolvedResource, readerClass);
      }
   }
   // Process individual @Bean methods
   Set&amp;lt;MethodMetadata&amp;gt; beanMethods = retrieveBeanMethodMetadata(sourceClass);
   for (MethodMetadata methodMetadata : beanMethods) {
      configClass.addBeanMethod(new BeanMethod(methodMetadata, configClass));
   }
   // Process default methods on interfaces
   processInterfaces(configClass, sourceClass);
   // Process superclass, if any
   if (sourceClass.getMetadata().hasSuperClass()) {
      String superclass = sourceClass.getMetadata().getSuperClassName();
      if (superclass != null &amp;amp;&amp;amp; !superclass.startsWith(&amp;quot;java&amp;quot;) &amp;amp;&amp;amp;
            !this.knownSuperclasses.containsKey(superclass)) {
         this.knownSuperclasses.put(superclass, configClass);
         // Superclass found, return its annotation metadata and recurse
         return sourceClass.getSuperClass();
      }
   }
   // No superclass -&amp;gt; processing is complete
   return null;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ™®é€šç±»æ‰«æåå°±å®Œæˆäº†æ³¨å†Œï¼šä¸Šè¿°ä»£ç ç¬¬ 26 è¡Œï¼š&lt;br&gt;
ä¸Šè¿°ä»£ç ç¬¬ 31 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public Set&amp;lt;BeanDefinitionHolder&amp;gt; parse(AnnotationAttributes componentScan, final String declaringClass) {
   ClassPathBeanDefinitionScanner scanner = new ClassPathBeanDefinitionScanner(this.registry,
         componentScan.getBoolean(&amp;quot;useDefaultFilters&amp;quot;), this.environment, this.resourceLoader);
   // BeanNameGeneratorï¼šBeanåå­—ç”Ÿæˆå™¨
   Class&amp;lt;? extends BeanNameGenerator&amp;gt; generatorClass = componentScan.getClass(&amp;quot;nameGenerator&amp;quot;);
   boolean useInheritedGenerator = (BeanNameGenerator.class == generatorClass);
   scanner.setBeanNameGenerator(useInheritedGenerator ? this.beanNameGenerator :
         BeanUtils.instantiateClass(generatorClass));
   ScopedProxyMode scopedProxyMode = componentScan.getEnum(&amp;quot;scopedProxy&amp;quot;);
   if (scopedProxyMode != ScopedProxyMode.DEFAULT) {
      scanner.setScopedProxyMode(scopedProxyMode);
   }
   else {
      Class&amp;lt;? extends ScopeMetadataResolver&amp;gt; resolverClass = componentScan.getClass(&amp;quot;scopeResolver&amp;quot;);
      scanner.setScopeMetadataResolver(BeanUtils.instantiateClass(resolverClass));
   }
   scanner.setResourcePattern(componentScan.getString(&amp;quot;resourcePattern&amp;quot;));
   // éå†å½“ä¸­çš„è¿‡æ»¤
   for (AnnotationAttributes filter : componentScan.getAnnotationArray(&amp;quot;includeFilters&amp;quot;)) {
      for (TypeFilter typeFilter : typeFiltersFor(filter)) {
         scanner.addIncludeFilter(typeFilter);
      }
   }
   for (AnnotationAttributes filter : componentScan.getAnnotationArray(&amp;quot;excludeFilters&amp;quot;)) {
      for (TypeFilter typeFilter : typeFiltersFor(filter)) {
         scanner.addExcludeFilter(typeFilter);
      }
   }
   // æ‰«æå‡ºæ¥çš„è¿™ä¸ªç±»æ˜¯å¦éœ€è¦æ‡’åŠ è½½ï¼šé»˜è®¤ false
   // xml é…ç½®æ‡’åŠ è½½ï¼š&amp;lt;beans lazy=&amp;quot;true&amp;quot;&amp;gt;&amp;lt;bean&amp;gt;&amp;lt;/bean&amp;gt;&amp;lt;/beans&amp;gt;
   // JavaConfigé…ç½®æ‡’åŠ è½½ï¼š@Lazy   public class AppConfig{
   boolean lazyInit = componentScan.getBoolean(&amp;quot;lazyInit&amp;quot;);
   if (lazyInit) {
      scanner.getBeanDefinitionDefaults().setLazyInit(true);
   }
   Set&amp;lt;String&amp;gt; basePackages = new LinkedHashSet&amp;lt;&amp;gt;();
   String[] basePackagesArray = componentScan.getStringArray(&amp;quot;basePackages&amp;quot;);
   for (String pkg : basePackagesArray) {
      String[] tokenized = StringUtils.tokenizeToStringArray(this.environment.resolvePlaceholders(pkg),
            ConfigurableApplicationContext.CONFIG_LOCATION_DELIMITERS);
      Collections.addAll(basePackages, tokenized);
   }
   for (Class&amp;lt;?&amp;gt; clazz : componentScan.getClassArray(&amp;quot;basePackageClasses&amp;quot;)) {
      basePackages.add(ClassUtils.getPackageName(clazz));
   }
   if (basePackages.isEmpty()) {
      basePackages.add(ClassUtils.getPackageName(declaringClass));
   }
   scanner.addExcludeFilter(new AbstractTypeHierarchyTraversingFilter(false, false) {
      @Override
      protected boolean matchClassName(String className) {
         return declaringClass.equals(className);
      }
   });
   return scanner.doScan(StringUtils.toStringArray(basePackages));
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 62 è¡Œï¼Œè°ƒç”¨ doScan æ–¹æ³•å®Œæˆæ‰«æ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;protected Set&amp;lt;BeanDefinitionHolder&amp;gt; doScan(String... basePackages) {
   Assert.notEmpty(basePackages, &amp;quot;At least one base package must be specified&amp;quot;);
   Set&amp;lt;BeanDefinitionHolder&amp;gt; beanDefinitions = new LinkedHashSet&amp;lt;&amp;gt;();
   // å¾ªç¯æ‰€æœ‰ basePackagesï¼Œå› ä¸º@ComponentScan({&amp;quot;com.ssm.dao&amp;quot;},{&amp;quot;com.ssm.service&amp;quot;})å¯ä»¥å†™å¤šä¸ª
   for (String basePackage : basePackages) {
      // æ‰«è¡¨ basePackage è·¯å¾„ä¸‹çš„ java æ–‡ä»¶
      // å¹¶æŠŠå®ƒè½¬æˆ BeanDefinition ç±»å‹
      Set&amp;lt;BeanDefinition&amp;gt; candidates = findCandidateComponents(basePackage);
      for (BeanDefinition candidate : candidates) {
         // è§£æ scope å±æ€§
         ScopeMetadata scopeMetadata = this.scopeMetadataResolver.resolveScopeMetadata(candidate);
         candidate.setScope(scopeMetadata.getScopeName());
         String beanName = this.beanNameGenerator.generateBeanName(candidate, this.registry);
         if (candidate instanceof AbstractBeanDefinition) {
            // å¦‚æœè¿™ä¸ªç±»æ˜¯ AbstractBeanDefinition çš„å­ç±»
            // åˆ™ä¸ºå®ƒè®¾ç½®é»˜è®¤å€¼ï¼Œæ¯”å¦‚ lazyï¼Œinit destroy
            postProcessBeanDefinition((AbstractBeanDefinition) candidate, beanName);
         }
         if (candidate instanceof AnnotatedBeanDefinition) {
            // æ£€æŸ¥å¹¶ä¸”å¤„ç†å¸¸ç”¨çš„æ³¨è§£
            // è¿™é‡Œçš„å¤„ç†ä¸»è¦æ˜¯æŒ‡æŠŠå¸¸ç”¨æ³¨è§£çš„å€¼è®¾ç½®åˆ° AnnotatedBeanDefinition å½“ä¸­
            // å½“å‰å‰ææ˜¯è¿™ä¸ªç±»å¿…é¡»æ˜¯ AnnotatedBeanDefinition ç±»å‹çš„ï¼Œè¯´ç™½äº†å°±æ˜¯åŠ äº†æ³¨è§£çš„ç±»
            AnnotationConfigUtils.processCommonDefinitionAnnotations((AnnotatedBeanDefinition) candidate);
         }
         if (checkCandidate(beanName, candidate)) {
            BeanDefinitionHolder definitionHolder = new BeanDefinitionHolder(candidate, beanName);
            definitionHolder =
                  AnnotationConfigUtils.applyScopedProxyMode(scopeMetadata, definitionHolder, this.registry);
            beanDefinitions.add(definitionHolder);
            // åŠ å…¥åˆ° map ä¸­
            registerBeanDefinition(definitionHolder, this.registry);
         }
      }
   }
   return beanDefinitions;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 8 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;Set&amp;lt;BeanDefinition&amp;gt; candidates = findCandidateComponents(basePackage);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è°ƒç”¨ findCandidateComponents æ–¹æ³•å®Œæˆæ‰«æï¼Œå¹¶æŠŠæ‰«æå‡ºæ¥çš„ç±»éƒ½è½¬åŒ–æˆ BeanDefinitionï¼Œ&lt;br&gt;
ç¬¬ 31 è¡Œï¼šæŠŠæ‰€æœ‰çš„ BeanDefinition æ³¨å†Œåˆ° map ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;å³ï¼šæ™®é€šç±»æ‰«æåå°±å®Œæˆäº†æ³¨å†Œã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Import(MyImportSelector.class)
@ComponentScan
public class AppConfig{
  
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç å®Œæˆäº†ï¼šæ‰«ææ‰€æœ‰çš„ @ComponentScanï¼Œå¹¶æŠŠ BeanDefinition æ”¾åˆ° map ä¸­ã€‚&lt;br&gt;
è¿˜æ²¡æœ‰å¼€å§‹å¤„ç† @Importã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¤„ç†-import&#34;&gt;å¤„ç† @Import&lt;/h2&gt;
&lt;p&gt;ä»€ä¹ˆæ—¶å€™å¤„ç† @Importå‘¢ï¼Ÿä¸Šè¿° processConfigurationClass æ–¹æ³•çš„ç¬¬ 64 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
 * è¿™é‡Œå¤„ç†çš„ import æ˜¯éœ€è¦åˆ¤æ–­æˆ‘ä»¬çš„ç±»å½“ä¸­æ˜¯å¦æœ‰@Importæ³¨è§£ï¼š getImports(sourceClass)
 * å¦‚æœæœ‰ @Import æ³¨è§£ï¼Œå°±æŠŠè¿™ä¸ªå€¼æ‹¿å‡ºæ¥ï¼Œæ˜¯ä¸€ä¸ªç±»
 * æ¯”å¦‚ @Import(xxxx.class)ï¼Œé‚£ä¹ˆè¿™é‡Œä¾¿æŠŠ xxxx ä¼ è¿›å»è¿›è¡Œè§£æ
 * åœ¨è§£æçš„è¿‡ç¨‹ä¸­å¦‚æœå‘è§‰æ˜¯ä¸€ä¸ª importSelector é‚£ä¹ˆå°±å›è°ƒ selector çš„æ–¹æ³•
 * è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ˆç±»åï¼‰ï¼Œé€šè¿‡è¿™ä¸ªå­—ç¬¦ä¸²å¾—åˆ°ä¸€ä¸ªç±»
 * ç»§è€Œåœ¨é€’å½’è°ƒç”¨æœ¬æ–¹æ³•æ¥å¤„ç†è¿™ä¸ªç±»
 *
 * åˆ¤æ–­ä¸€ç»„ç±»æ˜¯ä¸æ˜¯ imports(3ä¸­import)
 */
processImports(configClass, sourceClass, getImports(sourceClass), true);
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;ç¤ºä¾‹ä»£ç &#34;&gt;ç¤ºä¾‹ä»£ç &lt;/h3&gt;
&lt;p&gt;1ã€æœ‰ä¸€ä¸ªé…ç½®ç±»ï¼š&lt;/p&gt;
&lt;p&gt;â‘  æ‰«æåŒ… com.ssmï¼›&lt;/p&gt;
&lt;p&gt;â‘¡ @Import(MyImportSelector.class)ï¼›&lt;/p&gt;
&lt;p&gt;â‘¢ é€šè¿‡ @Bean æ³¨å…¥ IndexDaoImpl2&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;@ComponentScan(&amp;quot;com.ssm&amp;quot;)
@Import(MyImportSelector.class)
public class AppConfig {
   @Bean
   public IndexDaoImpl2 indexDaoImpl2(){
      return new IndexDaoImpl2();
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€æœ‰ä¸€ä¸ª IndexDaoImpl é€šè¿‡ @Repository(&amp;quot;indexDao&amp;quot;) æ³¨å…¥åˆ° Spring å®¹å™¨ä¸­ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Repository(&amp;quot;indexDao&amp;quot;)
public class IndexDaoImpl implements IndexDao{
   @Override
   public void query() {
      System.out.println(&amp;quot;dao...æ¨¡æ‹ŸæŸ¥è¯¢æ•°æ®åº“&amp;quot;);
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3ã€æœ‰ä¸€ä¸ª IndexDaoImpl2 åœ¨æ­¤ç±»ä¸­å¹¶æœªæ·»åŠ  @Componentï¼Œä½†æ˜¯åœ¨ AppConfig é€šè¿‡ @Bean çš„æ–¹å¼ new IndexDaoImpl2 æ·»åŠ åˆ° Spring å®¹å™¨ä¸­äº†ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class IndexDaoImpl2 implements IndexDao{
   @Override
   public void query() {
      System.out.println(&amp;quot;dao2...æ¨¡æ‹ŸæŸ¥è¯¢æ•°æ®åº“&amp;quot;);
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;4ã€MyImportSelectorÂ implements ImportSelectorï¼Œè¿”å› â€œç±»çš„å­—ç¬¦ä¸²â€ï¼Œå³ IndexDaoImpl3.class.getName()&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class MyImportSelector implements ImportSelector {
   @Override
   public String[] selectImports(AnnotationMetadata importingClassMetadata) {
      return new String[]{IndexDaoImpl3.class.getName()};
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;5ã€IndexDaoImpl3 implements BeanPostProcessor&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class IndexDaoImpl3 implements IndexDao, BeanPostProcessor {
   @Override
   public Object postProcessBeforeInitialization(Object bean, String beanName) throws BeansException {
      if(beanName.equals(&amp;quot;indexDao&amp;quot;)){
         bean = Proxy.newProxyInstance(this.getClass().getClassLoader(), new Class[]{IndexDao.class},new MyInvocationHandler(bean));
      }
      return bean;
   }
   @Override
   public Object postProcessAfterInitialization(Object bean, String beanName) throws BeansException {
      return null;
   }
   @Override
   public void query() {
      System.out.println(&amp;quot;dao3...æ¨¡æ‹ŸæŸ¥è¯¢æ•°æ®åº“&amp;quot;);
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;6ã€MyInvocationHandler implements InvocationHandler&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class MyInvocationHandler implements InvocationHandler {
   Object target;
   public MyInvocationHandler(Object target){
      this.target = target;
   }
   @Override
   public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
      System.out.println(&amp;quot;ä»£ç†æ–¹æ³•...&amp;quot;);
      return method.invoke(target,args);
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;7ã€æµ‹è¯•ç±»&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
   public static void main(String[] args) {
      // æŠŠ Spring æ‰€æœ‰å‰æç¯å¢ƒå‡†å¤‡å¥½
      // 1.å‡†å¤‡å·¥å‚=DefaultListableBeanFactory
      // å®ä¾‹åŒ–ä¸€ä¸ª bdReader å’Œä¸€ä¸ª scanner
      AnnotationConfigApplicationContext context =
            new AnnotationConfigApplicationContext();
      // æŠŠä¸€ä¸ª class è½¬æˆ bdï¼Œæœ€å put åˆ° map
      // map ä½ç½® DefaultListableBeanFactory çš„ beanDefinitionMap
      context.register(AppConfig.class);
      // åˆå§‹åŒ– Spring çš„ç¯å¢ƒ
      context. refresh();
      IndexDao dao = (IndexDao) context.getBean(&amp;quot;indexDao&amp;quot;);
      dao.query();
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;8ã€è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ä»£ç†æ–¹æ³•...
dao...æ¨¡æ‹ŸæŸ¥è¯¢æ•°æ®åº“
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;processimports&#34;&gt;processImports&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;private void processImports(ConfigurationClass configClass, SourceClass currentSourceClass,
      Collection&amp;lt;SourceClass&amp;gt; importCandidates, boolean checkForCircularImports) {
   // å¦‚æœæ²¡æœ‰åŠ @Importï¼Œç›´æ¥è¿”å›
   if (importCandidates.isEmpty()) {
      return;
   }
   if (checkForCircularImports &amp;amp;&amp;amp; isChainedImportOnStack(configClass)) {
      this.problemReporter.error(new CircularImportProblem(configClass, this.importStack));
   }
   else {
      this.importStack.push(configClass);
      try {
         for (SourceClass candidate : importCandidates) {
            // @Import(IndexDao.class)ã€@Import(ImportSelector)ã€@Import(ImportBeanDefinitionRegistrar)
            // åˆ¤æ–­æ˜¯ä¸æ˜¯ ImportSelector
            if (candidate.isAssignable(ImportSelector.class)) {
               // Candidate class is an ImportSelector -&amp;gt; delegate to it to determine imports
               Class&amp;lt;?&amp;gt; candidateClass = candidate.loadClass();
               // åå°„å®ç°ä¸€ä¸ªå¯¹è±¡
               ImportSelector selector = BeanUtils.instantiateClass(candidateClass, ImportSelector.class);
               ParserStrategyUtils.invokeAwareMethods(
                     selector, this.environment, this.resourceLoader, this.registry);
               if (this.deferredImportSelectors != null &amp;amp;&amp;amp; selector instanceof DeferredImportSelector) {
                  this.deferredImportSelectors.add(
                        new DeferredImportSelectorHolder(configClass, (DeferredImportSelector) selector));
               }
               else {
                  // å›è°ƒ
                  String[] importClassNames = selector.selectImports(currentSourceClass.getMetadata());
                  Collection&amp;lt;SourceClass&amp;gt; importSourceClasses = asSourceClasses(importClassNames);
                  // é€’å½’ï¼Œè¿™é‡Œç¬¬äºŒæ¬¡è°ƒç”¨ processImports
                  // å¦‚æœæ˜¯ä¸€ä¸ªæ™®é€šç±»ï¼Œä¼šè¿› else
                  processImports(configClass, currentSourceClass, importSourceClasses, false);
               }
            }
            // åˆ¤æ–­æ˜¯ä¸æ˜¯ ImportBeanDefinitionRegistrar
            else if (candidate.isAssignable(ImportBeanDefinitionRegistrar.class)) {
               // Candidate class is an ImportBeanDefinitionRegistrar -&amp;gt;
               // delegate to it to register additional bean definitions
               Class&amp;lt;?&amp;gt; candidateClass = candidate.loadClass();
               ImportBeanDefinitionRegistrar registrar =
                     BeanUtils.instantiateClass(candidateClass, ImportBeanDefinitionRegistrar.class);
               ParserStrategyUtils.invokeAwareMethods(
                     registrar, this.environment, this.resourceLoader, this.registry);
               // æ·»åŠ åˆ°ä¸€ä¸ª list å½“ä¸­å’Œ importSelector ä¸åŒ
               configClass.addImportBeanDefinitionRegistrar(registrar, currentSourceClass.getMetadata());
            }
            // æ™®é€šç±»ï¼š@Import(IndexDao.class)
            else {
               // Candidate class not an ImportSelector or ImportBeanDefinitionRegistrar -&amp;gt;
               // process it as an @Configuration class
               // å¦åˆ™ï¼ŒåŠ å…¥åˆ° importStack åè°ƒç”¨ processConfigurationClass è¿›è¡Œå¤„ç†
               // processConfigurationClass é‡Œé¢ä¸»è¦å°±æ˜¯æŠŠç±»æ”¾åˆ° configurationClasses
               // configurationClasses æ˜¯ä¸€ä¸ªé›†åˆï¼Œä¼šåœ¨åé¢æ‹¿å‡ºæ¥è§£ææˆ bd ç»§è€Œæ³¨å†Œ
               // å¯ä»¥çœ‹åˆ°æ™®é€šç±»åœ¨æ‰«æå‡ºæ¥çš„æ—¶å€™å°±è¢«æ³¨å†Œäº†
               // å¦‚æœæ˜¯ importSelectorï¼Œä¼šå…ˆæ”¾åˆ° configurationClasses åé¢è¿›è¡Œå‡ºæ¥æ³¨å†Œ
               this.importStack.registerImport(
                     currentSourceClass.getMetadata(), candidate.getMetadata().getClassName());
               processConfigurationClass(candidate.asConfigClass(configClass));
            }
         }
      }
      catch (BeanDefinitionStoreException ex) {
         throw ex;
      }
      catch (Throwable ex) {
         throw new BeanDefinitionStoreException(
               &amp;quot;Failed to process import candidates for configuration class [&amp;quot; +
               configClass.getMetadata().getClassName() + &amp;quot;]&amp;quot;, ex);
      }
      finally {
         this.importStack.pop();
      }
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/candidate.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 15-20 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;for (SourceClass candidate : importCandidates) {
    // @Import(IndexDao.class)ã€@Import(ImportSelector)ã€@Import(ImportBeanDefinitionRegistrar)
    // åˆ¤æ–­æ˜¯ä¸æ˜¯ ImportSelector
    if (candidate.isAssignable(ImportSelector.class)) {
    // Candidate class is an ImportSelector -&amp;gt; delegate to it to determine imports
        Class&amp;lt;?&amp;gt; candidateClass = candidate.loadClass(
        
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è§£æåˆ°äº† @Import(MyImportSelector.class)ï¼Œ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class MyImportSelector implements ImportSelector {
   @Override
   public String[] selectImports(AnnotationMetadata importingClassMetadata) {
      return new String[]{IndexDaoImpl3.class.getName()};
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è§£æåˆ° @MyImportSelector åï¼Œä¼šè¿”å›ä¸€ä¸ª â€œç±»çš„å­—ç¬¦ä¸²â€ï¼Œå¦‚ä¸Šè¿°ä»£ç ç¬¬ 4 è¡Œæ‰€ç¤ºã€‚&lt;br&gt;
è¿™ä¸ª â€œç±»çš„å­—ç¬¦ä¸²â€ è‚¯å®šä¼šæ”¾åˆ° map ä¸­ï¼Œä½†æ­¤æ—¶è¿˜æ²¡æœ‰æ”¾è¿›å»ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/candidateClass.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;æ™®é€šç±»é€šè¿‡ doScan æ–¹æ³•è¢«æ‰«æå‡ºæ¥ï¼Œè½¬åŒ–æˆ BeanDefinitionï¼Œå¹¶è¢«åŠ å…¥åˆ° map ä¸­ï¼šæ‰€ä»¥è¢« @Reposity ä¿®é¥°çš„ IndexDaoImpl æ­¤æ—¶å·²ç»åœ¨å®¹å™¨ä¸­äº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä½•æ—¶å°†-importselector-è¿”å›çš„å­—ç¬¦ä¸²æ”¾åˆ°-map-ä¸­&#34;&gt;ä½•æ—¶å°† @ImportSelector è¿”å›çš„å­—ç¬¦ä¸²æ”¾åˆ° map ä¸­&lt;/h3&gt;
&lt;p&gt;åå°„å®ç°ä¸€ä¸ªå¯¹è±¡ï¼šSpring è¦çŸ¥é“è¿™ä¸ª ImportSelectorÂ  åˆ°åº•è¿”å›äº†å“ªäº›å­—ç¬¦ä¸²ï¼ˆreturn new String[]{IndexDaoImpl3.class.getName()};ï¼‰ï¼Œç„¶åé€šè¿‡è¿™ä¸ªå­—ç¬¦ä¸²åå°„å¾—åˆ°ç±»åã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class MyImportSelector implements ImportSelector {
   @Override
   public String[] selectImports(AnnotationMetadata importingClassMetadata) {
      return new String[]{IndexDaoImpl3.class.getName()};
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¾—åˆ° selectImports æ–¹æ³•è¿”å›çš„å­—ç¬¦ä¸²æ•°ç»„ï¼šString[] strs = selectImports();&lt;br&gt;
for(String str: strs){&lt;/p&gt;
&lt;p&gt;// é€šè¿‡åå°„å¾—åˆ°ç±»å&lt;/p&gt;
&lt;p&gt;class = Class.forName(str);&lt;/p&gt;
&lt;p&gt;}&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/importSourceClasses.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;é€’å½’è°ƒç”¨-processimports&#34;&gt;é€’å½’è°ƒç”¨ processImports&lt;/h2&gt;
&lt;p&gt;å¾—åˆ°ç±»å IndexDaoImpl3ï¼Œæ­£å¸¸æƒ…å†µå¯èƒ½ä¼šæƒ³ï¼šå°† IndexDaoImpl3 è½¬åŒ–æˆ BeanDefinitionï¼Œç„¶åæ”¾åˆ° map ä¸­ï¼Œä½†æ˜¯ï¼ŒSpring å¹¶ä¸æ˜¯è¿™æ ·åšçš„ï¼Œå› ä¸ºæœ‰å¯èƒ½è¿™ä¸ª IndexDaoImpl3 é‡Œé¢ä¹Ÿæœ‰ä¸€ä¸ª @Importï¼Œæ‰€ä»¥ Spring è¿›è¡Œé€’å½’å¤„ç†ã€‚&lt;/p&gt;
&lt;p&gt;ä¸Šè¿° processImports æ–¹æ³•çš„ç¬¬ 30-35 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// å¾—åˆ°ç±»å
String[] importClassNames = selector.selectImports(currentSourceClass.getMetadata());
Collection&amp;lt;SourceClass&amp;gt; importSourceClasses = asSourceClasses(importClassNames);
// é€’å½’ï¼Œè¿™é‡Œç¬¬äºŒæ¬¡è°ƒç”¨ processImports
// å¦‚æœæ˜¯ä¸€ä¸ªæ™®é€šç±»ï¼Œä¼šè¿› else
processImports(configClass, currentSourceClass, importSourceClasses, false);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;äºæ˜¯å†æ¬¡è°ƒç”¨ processImports æ–¹æ³•ï¼š&lt;br&gt;
ä¸Šè¿° processImports  æ–¹æ³•ç¬¬ 18 è¡Œåˆ¤æ–­ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;if (candidate.isAssignable(ImportSelector.class)) {
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;IndexDaoImpl3 ä¸æ˜¯ä¸€ä¸ª ImportSelector&lt;br&gt;
ä¸Šè¿° processImports  æ–¹æ³•ç¬¬ 39 è¡Œåˆ¤æ–­ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;else if (candidate.isAssignable(ImportBeanDefinitionRegistrar.class)) {
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;IndexDaoImpl3 ä¸æ˜¯ä¸€ä¸ª ImportBeanDefinitionRegistrar&lt;br&gt;
æ‰€ä»¥è¿›å…¥ processImports  æ–¹æ³•çš„ç¬¬ 51 è¡Œ else åˆ†æ”¯&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;else{
  this.importStack.registerImport(
      currentSourceClass.getMetadata(), candidate.getMetadata().getClassName());
processConfigurationClass(candidate.asConfigClass(configClass));
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;å¤–éƒ¨è°ƒç”¨&#34;&gt;å¤–éƒ¨è°ƒç”¨&lt;/h3&gt;
&lt;p&gt;ä»å¤–éƒ¨è°ƒç”¨æ—¶ï¼ŒdoProcessConfigurationClass æ–¹æ³•çš„ç¬¬ 64 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;processImports(configClass, sourceClass, getImports(sourceClass), true);
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/getImports.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ä¼ é€’çš„ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯è·å¾— @Import(MyImportSelector.class) çš„å€¼ï¼šMyImportSelectorã€‚åˆ¤æ–­ AppConfig ä¸­ @Import çš„å€¼åˆ°åº•æ˜¯å“ªä¸€ç§ Importï¼Œç„¶åå†æ¥è¿›è¡Œå¤„ç†ã€‚&lt;/p&gt;
&lt;p&gt;å†æ¥çœ‹ processImports æ–¹æ³•çš„å‚æ•°&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;private void processImports(ConfigurationClass configClass, SourceClass currentSourceClass,
      Collection&amp;lt;SourceClass&amp;gt; importCandidates, boolean checkForCircularImports) {
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç¬¬ä¸‰ä¸ªå‚æ•° importCandidates å³ MyImportSelector&lt;/p&gt;
&lt;h3 id=&#34;å†…éƒ¨è°ƒç”¨&#34;&gt;å†…éƒ¨è°ƒç”¨&lt;/h3&gt;
&lt;p&gt;å†…éƒ¨é€’å½’è°ƒç”¨æ—¶ï¼Œä¼ é€’çš„ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯å½“å‰ç±»ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;processImports(configClass, currentSourceClass, importSourceClasses, false);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å†…éƒ¨è°ƒç”¨åˆ¤æ–­å½“å‰ç±» IndexDaoImpl3 åˆ°åº•æ˜¯å“ªä¸€ç§ @Importã€‚&lt;br&gt;
&lt;strong&gt;getImports(sourceClass) æ˜¯è·å– @Import æ³¨è§£å†…çš„å€¼ï¼Œè€Œ processImports ä»…ä»…åˆ¤æ–­ä¼ è¿›æ¥çš„ç±»ï¼ˆç¬¬ä¸‰ä¸ªå‚æ•°ï¼‰æ˜¯ ä¸‰ç§Import ä¸­çš„å“ªä¸€ç§&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;processconfigurationclass-2&#34;&gt;processConfigurationClass&lt;/h2&gt;
&lt;p&gt;å‰é¢æåˆ°é€’å½’è°ƒç”¨ä¼šè¿›å…¥ else åˆ†æ”¯ï¼Œè°ƒç”¨ processConfigurationClass æ–¹æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;protected void processConfigurationClass(ConfigurationClass configClass) throws IOException {
   // åˆ¤æ–­æ˜¯å¦åº”è¯¥è·³è¿‡è§£æ
   if (this.conditionEvaluator.shouldSkip(configClass.getMetadata(), ConfigurationPhase.PARSE_CONFIGURATION)) {
      return;
   }
   // å¤„ç† Imported çš„æƒ…å†µ
   // å°±æ˜¯å½“å‰è¿™ä¸ªç±»æœ‰æ²¡æœ‰è¢«åˆ«çš„ç±» @Import
   ConfigurationClass existingClass = this.configurationClasses.get(configClass);
   if (existingClass != null) {
      if (configClass.isImported()) {
         if (existingClass.isImported()) {
            existingClass.mergeImportedBy(configClass);
         }
         // Otherwise ignore new imported config class; existing non-imported class overrides it.
         return;
      }
      else {
         // Explicit bean definition found, probably replacing an import.
         // Let&#39;s remove the old one and go with the new one.
         this.configurationClasses.remove(configClass);
         this.knownSuperclasses.values().removeIf(configClass::equals);
      }
   }
   // Recursively process the configuration class and its superclass hierarchy.
   SourceClass sourceClass = asSourceClass(configClass);
   do {
      sourceClass = doProcessConfigurationClass(configClass, sourceClass);
   }
   while (sourceClass != null);
   // ä¸€ä¸ª mapï¼Œç”¨æ¥å­˜æ”¾æ‰«æå‡ºæ¥çš„ beanï¼ˆæ³¨æ„è¿™é‡Œçš„ bean ä¸æ˜¯å¯¹è±¡ï¼Œä»…ä»…æ˜¯ bean çš„ä¿¡æ¯ï¼Œå› ä¸ºè¿˜æ²¡åˆ°å®ä¾‹åŒ–ï¼‰
   this.configurationClasses.put(configClass, configClass);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 34 è¡Œï¼šå°†ç±»æ”¾åˆ° configurationClasses å˜é‡ä¸­ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;private final Map&amp;lt;ConfigurationClass, ConfigurationClass&amp;gt; configurationClasses = new LinkedHashMap&amp;lt;&amp;gt;();
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;spring-å¤„ç†å››ç§ç±»&#34;&gt;Spring å¤„ç†å››ç§ç±»&lt;/h1&gt;
&lt;h2 id=&#34;æ™®é€šç±»-component&#34;&gt;æ™®é€šç±» @Component&lt;/h2&gt;
&lt;p&gt;æ‰«æå®Œæˆåæ³¨å†Œ&lt;/p&gt;
&lt;h2 id=&#34;importselector&#34;&gt;importSelector&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;å…ˆæ”¾åˆ° Map&amp;lt;ConfigurationClass, ConfigurationClass&amp;gt; configurationClasses = new LinkedHashMap&amp;lt;&amp;gt;(); ä¸­ï¼Œç„¶åå†æ³¨å†Œ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;context.&lt;em&gt;refresh&lt;/em&gt;(); ---&amp;gt;Â &lt;em&gt;invokeBeanFactoryPostProcessors&lt;/em&gt;(beanFactory); ---&amp;gt; PostProcessorRegistrationDelegate.invokeBeanFactoryPostProcessors(beanFactory, getBeanFactoryPostProcessors()); ---&amp;gt;invokeBeanDefinitionRegistryPostProcessors(currentRegistryProcessors,Â registry); ---&amp;gt; postProcessor.&lt;em&gt;postProcessBeanDefinitionRegistry&lt;/em&gt;(registry); ---&amp;gt;Â &lt;em&gt;processConfigBeanDefinitions&lt;/em&gt;(registry);å¤„ç†@Configuration ---&amp;gt; parser.parse(candidates); è§£ææ³¨è§£å¯¹è±¡---&amp;gt; parse(((AnnotatedBeanDefinition) bd).getMetadata(), holder.getBeanName()); ---&amp;gt; processConfigurationClass(new ConfigurationClass(metadata, beanName)); å¤„ç†Import&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;protected void processConfigurationClass(ConfigurationClass configClass) throws IOException {
   // åˆ¤æ–­æ˜¯å¦åº”è¯¥è·³è¿‡è§£æ
   if (this.conditionEvaluator.shouldSkip(configClass.getMetadata(), ConfigurationPhase.PARSE_CONFIGURATION)) {
      return;
   }
   // å¤„ç† Imported çš„æƒ…å†µ
   // å°±æ˜¯å½“å‰è¿™ä¸ªç±»æœ‰æ²¡æœ‰è¢«åˆ«çš„ç±» @Import
   ConfigurationClass existingClass = this.configurationClasses.get(configClass);
   if (existingClass != null) {
      if (configClass.isImported()) {
         if (existingClass.isImported()) {
            existingClass.mergeImportedBy(configClass);
         }
         // Otherwise ignore new imported config class; existing non-imported class overrides it.
         return;
      }
      else {
         // Explicit bean definition found, probably replacing an import.
         // Let&#39;s remove the old one and go with the new one.
         this.configurationClasses.remove(configClass);
         this.knownSuperclasses.values().removeIf(configClass::equals);
      }
   }
   // Recursively process the configuration class and its superclass hierarchy.
   SourceClass sourceClass = asSourceClass(configClass);
   do {
      sourceClass = doProcessConfigurationClass(configClass, sourceClass);
   }
   while (sourceClass != null);
   // ä¸€ä¸ª mapï¼Œç”¨æ¥å­˜æ”¾æ‰«æå‡ºæ¥çš„ beanï¼ˆæ³¨æ„è¿™é‡Œçš„ bean ä¸æ˜¯å¯¹è±¡ï¼Œä»…ä»…æ˜¯ bean çš„ä¿¡æ¯ï¼Œå› ä¸ºè¿˜æ²¡åˆ°å®ä¾‹åŒ–ï¼‰
   this.configurationClasses.put(configClass, configClass);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/map%E4%B8%AD%E6%9C%898%E4%B8%AA.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;context. refresh(); ---&amp;gt; invokeBeanFactoryPostProcessors(beanFactory); ---&amp;gt; PostProcessorRegistrationDelegate.invokeBeanFactoryPostProcessors(beanFactory, getBeanFactoryPostProcessors()); ---&amp;gt; invokeBeanDefinitionRegistryPostProcessors(currentRegistryProcessors, registry); ---&amp;gt; postProcessor.postProcessBeanDefinitionRegistry(registry); ---&amp;gt; processConfigBeanDefinitions(registry); ---&amp;gt; this.reader.loadBeanDefinitions(configClasses);&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public void processConfigBeanDefinitions(BeanDefinitionRegistry registry) {
   //å®šä¹‰ä¸€ä¸ª list å­˜æ”¾ app æä¾›çš„ bdï¼šé¡¹ç›®å½“ä¸­æä¾›äº† @Component
   List&amp;lt;BeanDefinitionHolder&amp;gt; configCandidates = new ArrayList&amp;lt;&amp;gt;();
   // è·å–å®¹å™¨ä¸­æ³¨å†Œçš„æ‰€æœ‰ bd åå­—
   // 7 ä¸ª
   String[] candidateNames = registry.getBeanDefinitionNames();
   // ä¾æ¬¡å–å‡ºæ¯ä¸ª&amp;lt;beanName,beanDefinition&amp;gt;
   /**
    * full
    * lite
    */
   for (String beanName : candidateNames) {
      BeanDefinition beanDef = registry.getBeanDefinition(beanName);
      // åˆ¤æ–­å½“å‰ bean æ˜¯å¦è¢«å¤„ç†è¿‡ï¼šä½¿ç”¨ isFullConfigurationClass æ¥æ ‡è¯†
      if (ConfigurationClassUtils.isFullConfigurationClass(beanDef) ||
            ConfigurationClassUtils.isLiteConfigurationClass(beanDef)) {
         // å¦‚æœ BeanDefinition ä¸­çš„ configurationClass å±æ€§ä¸º full æˆ–è€… liteï¼Œåˆ™æ„å‘³ç€å·²ç»å¤„ç†è¿‡äº†ï¼Œç›´æ¥è·³è¿‡
         // è¿™é‡Œéœ€è¦ç»“åˆä¸‹é¢çš„ä»£ç æ‰èƒ½ç†è§£
         if (logger.isDebugEnabled()) {
            logger.debug(&amp;quot;Bean definition has already been processed as a configuration class: &amp;quot; + beanDef);
         }
      }
      // åˆ¤æ–­è¿™ä¸ª BeanDefinition æ˜¯å¦æ˜¯ Configurationç±»ï¼Œå¦‚æœåŠ äº† Configuration ä¸‹é¢çš„è¿™å‡ ä¸ªæ³¨è§£å°±ä¸å†åˆ¤æ–­äº†
      // è¿˜æœ‰  add(Component.class.getName())
      //         candidateIndicators.add(ComponentScan.class.getName())
      //         candidateIndicators.add(Import.class.getName())
      //         candidateIndicators.add(ImportResource.class.getName())
      else if (ConfigurationClassUtils.checkConfigurationClassCandidate(beanDef, this.metadataReaderFactory)) {
         configCandidates.add(new BeanDefinitionHolder(beanDef, beanName));
      }
   }
   // Return immediately if no @Configuration classes were found
   if (configCandidates.isEmpty()) {
      return;
   }
   // æ’åºï¼Œæ ¹æ® orderï¼Œä¸é‡è¦
   // Sort by previously determined @Order value, if applicable
   configCandidates.sort((bd1, bd2) -&amp;gt; {
      int i1 = ConfigurationClassUtils.getOrder(bd1.getBeanDefinition());
      int i2 = ConfigurationClassUtils.getOrder(bd2.getBeanDefinition());
      return Integer.compare(i1, i2);
   });
   // Detect any custom bean name generation strategy supplied through the enclosing application context
   SingletonBeanRegistry sbr = null;
   // å¦‚æœ BeanDefinitionRegistry æ˜¯ SingletonBeanRegistry å­ç±»çš„è¯
   // ç”±äºä¼šå°† registry å¼ºè½¬ä¸º SingletonBeanRegistry
   if (registry instanceof SingletonBeanRegistry) {
      sbr = (SingletonBeanRegistry) registry;
      if (!this.localBeanNameGeneratorSet) {//æ˜¯å¦æœ‰è‡ªå®šä¹‰çš„
         BeanNameGenerator generator = (BeanNameGenerator) sbr.getSingleton(CONFIGURATION_BEAN_NAME_GENERATOR);
         // SingletonBeanRegistry ä¸­æœ‰ id ä¸º org.springframework.context.annotation.internalConfigurationBeanNameGenerator
         // å¦‚æœæœ‰åˆ™åˆ©ç”¨å®ƒçš„ï¼Œå¦åˆ™åˆ™ä½¿ç”¨ Spring é»˜è®¤çš„
         if (generator != null) {
            this.componentScanBeanNameGenerator = generator;
            this.importBeanNameGenerator = generator;
         }
      }
   }
   if (this.environment == null) {
      this.environment = new StandardEnvironment();
   }
   // Parse each @Configuration class
   // å®ä¾‹åŒ– ConfigurationClassParser ä¸ºäº†è§£æå„ä¸ªé…ç½®ç±»
   ConfigurationClassParser parser = new ConfigurationClassParser(
         this.metadataReaderFactory, this.problemReporter, this.environment,
         this.resourceLoader, this.componentScanBeanNameGenerator, registry);
   // å®ä¾‹åŒ– 2 ä¸ª setï¼Œcandidates ç”¨äºå°†ä¹‹å‰åŠ å…¥çš„ configCandidates è¿›è¡Œå»é‡
   // å› ä¸ºå¯èƒ½æœ‰å¤šä¸ªé…ç½®ç±»é‡å¤äº†
   // alreadyParsed ç”¨æˆ·åˆ¤æ–­æ˜¯å¦å¤„ç†è¿‡
   Set&amp;lt;BeanDefinitionHolder&amp;gt; candidates = new LinkedHashSet&amp;lt;&amp;gt;(configCandidates);
   Set&amp;lt;ConfigurationClass&amp;gt; alreadyParsed = new HashSet&amp;lt;&amp;gt;(configCandidates.size());
   do {
      parser.parse(candidates);
      parser.validate();
      Set&amp;lt;ConfigurationClass&amp;gt; configClasses = new LinkedHashSet&amp;lt;&amp;gt;(parser.getConfigurationClasses());
      configClasses.removeAll(alreadyParsed);
      // Read the model and create bean definitions based on its content
      if (this.reader == null) {
         this.reader = new ConfigurationClassBeanDefinitionReader(
               registry, this.sourceExtractor, this.resourceLoader, this.environment,
               this.importBeanNameGenerator, parser.getImportRegistry());
      }
      // æŠŠæ‰«æå‡ºæ¥çš„ bean å¯¹åº”çš„ beanDefinitions æ·»åŠ åˆ° factory çš„ map å½“ä¸­
      this.reader.loadBeanDefinitions(configClasses);
      alreadyParsed.addAll(configClasses);
      candidates.clear();
      if (registry.getBeanDefinitionCount() &amp;gt; candidateNames.length) {
         String[] newCandidateNames = registry.getBeanDefinitionNames();
         Set&amp;lt;String&amp;gt; oldCandidateNames = new HashSet&amp;lt;&amp;gt;(Arrays.asList(candidateNames));
         Set&amp;lt;String&amp;gt; alreadyParsedClasses = new HashSet&amp;lt;&amp;gt;();
         for (ConfigurationClass configurationClass : alreadyParsed) {
            alreadyParsedClasses.add(configurationClass.getMetadata().getClassName());
         }
         for (String candidateName : newCandidateNames) {
            if (!oldCandidateNames.contains(candidateName)) {
               BeanDefinition bd = registry.getBeanDefinition(candidateName);
               if (ConfigurationClassUtils.checkConfigurationClassCandidate(bd, this.metadataReaderFactory) &amp;amp;&amp;amp;
                     !alreadyParsedClasses.contains(bd.getBeanClassName())) {
                  candidates.add(new BeanDefinitionHolder(bd, candidateName));
               }
            }
         }
         candidateNames = newCandidateNames;
      }
   }
   while (!candidates.isEmpty());
   // Register the ImportRegistry as a bean in order to support ImportAware @Configuration classes
   if (sbr != null &amp;amp;&amp;amp; !sbr.containsSingleton(IMPORT_REGISTRY_BEAN_NAME)) {
      sbr.registerSingleton(IMPORT_REGISTRY_BEAN_NAME, parser.getImportRegistry());
   }
   if (this.metadataReaderFactory instanceof CachingMetadataReaderFactory) {
      // Clear cache in externally provided MetadataReaderFactory; this is a no-op
      // for a shared cache since it&#39;ll be cleared by the ApplicationContext.
      ((CachingMetadataReaderFactory) this.metadataReaderFactory).clearCache();
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 82 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;Set&amp;lt;ConfigurationClass&amp;gt; configClasses = new LinkedHashSet&amp;lt;&amp;gt;(parser.getConfigurationClasses());
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;public Set&amp;lt;ConfigurationClass&amp;gt; getConfigurationClasses() {
   return this.configurationClasses.keySet();
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;private final Map&amp;lt;ConfigurationClass, ConfigurationClass&amp;gt; configurationClasses = new LinkedHashMap&amp;lt;&amp;gt;();
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/getConfigurationClasses.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;é€šè¿‡ parser.getConfigurationClasses() æ–¹æ³•ï¼Œå¾—åˆ°ï¼šæ™®é€šç±» @Componentã€ @Import ç±»ã€æœ¬èº«ç±» appConfig ï¼Œå…¶ä¸­ æ™®é€šç±»ã€æœ¬èº«ç±»å·²ç»æ³¨å†Œäº†ï¼Œ@Import ç±»è¿˜æ²¡æœ‰æ³¨å†Œã€‚&lt;/p&gt;
&lt;p&gt;å¦‚ä½•çŸ¥é“å“ªäº›ç±»è¿˜æ²¡æœ‰æ³¨å†Œå‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 92 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;this.reader.loadBeanDefinitions(configClasses);
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%89%A7%E8%A1%8CloadBeanDefinitions%E5%89%8D.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public void loadBeanDefinitions(Set&amp;lt;ConfigurationClass&amp;gt; configurationModel) {
   TrackedConditionEvaluator trackedConditionEvaluator = new TrackedConditionEvaluator();
   for (ConfigurationClass configClass : configurationModel) {
      loadBeanDefinitionsForConfigurationClass(configClass, trackedConditionEvaluator);
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;private void loadBeanDefinitionsForConfigurationClass(
      ConfigurationClass configClass, TrackedConditionEvaluator trackedConditionEvaluator) {
   if (trackedConditionEvaluator.shouldSkip(configClass)) {
      String beanName = configClass.getBeanName();
      if (StringUtils.hasLength(beanName) &amp;amp;&amp;amp; this.registry.containsBeanDefinition(beanName)) {
         this.registry.removeBeanDefinition(beanName);
      }
      this.importRegistry.removeImportingClass(configClass.getMetadata().getClassName());
      return;
   }
   if (configClass.isImported()) {
      registerBeanDefinitionForImportedConfigurationClass(configClass);
   }
   for (BeanMethod beanMethod : configClass.getBeanMethods()) {
      loadBeanDefinitionsForBeanMethod(beanMethod);
   }
   loadBeanDefinitionsFromImportedResources(configClass.getImportedResources());
   // æ³¨å†Œ Registrar
loadBeanDefinitionsFromRegistrars(configClass.getImportBeanDefinitionRegistrars());
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 22 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;private void loadBeanDefinitionsFromRegistrars(Map&amp;lt;ImportBeanDefinitionRegistrar, AnnotationMetadata&amp;gt; registrars) {
   registrars.forEach((registrar, metadata) -&amp;gt;
         registrar.registerBeanDefinitions(metadata, this.registry));
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœä¸€ä¸ªç±»æ˜¯ Registrarï¼Œå°†å®ƒæ”¾åˆ° importBeanDefinitionRegistrars ä¸­ï¼Œå¾ªç¯éå† importBeanDefinitionRegistrarsÂ  æ³¨å†Œã€‚&lt;br&gt;
å½“æ‰§è¡Œå®Œ this.reader.loadBeanDefinitions(configClasses);&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%89%A7%E8%A1%8CloadBeanDefinitions%E5%90%8E.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;IndexDaoImpl2 æ˜¯é€šè¿‡ @Bean æ³¨å…¥åˆ°å®¹å™¨ä¸­çš„ï¼ŒIndexDaoImpl3 æ˜¯é€šè¿‡ â€œå°† @ImportSelector è¿”å›çš„å­—ç¬¦ä¸²æ”¾åˆ° map ä¸­â€ æ³¨å…¥åˆ°å®¹å™¨ä¸­çš„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;registrar&#34;&gt;Registrar&lt;/h2&gt;
&lt;p&gt;å…ˆæ”¾åˆ° importBeanDefinitionRegistrars ä¸­ï¼Œç„¶åå† é€šè¿‡ loadBeanDefinitionsFromRegistrars æ–¹æ³•æ³¨å†Œã€‚&lt;/p&gt;
&lt;p&gt;processImports æ–¹æ³•çš„ç¬¬ 39-49 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;else if (candidate.isAssignable(ImportBeanDefinitionRegistrar.class)) {
    // Candidate class is an ImportBeanDefinitionRegistrar -&amp;gt;
    // delegate to it to register additional bean definitions
    Class&amp;lt;?&amp;gt; candidateClass = candidate.loadClass();
    ImportBeanDefinitionRegistrar registrar = BeanUtils.instantiateClass(candidateClass, ImportBeanDefinitionRegistrar.class);
    ParserStrategyUtils.invokeAwareMethods(registrar, this.environment, this.resourceLoader, this.registry);
    // æ·»åŠ åˆ°ä¸€ä¸ª list å½“ä¸­å’Œ importSelector ä¸åŒ
    configClass.addImportBeanDefinitionRegistrar(registrar, currentSourceClass.getMetadata());
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœæœ‰ä¸€ä¸ªç±»æ˜¯ ImportBeanDefinitionRegistrarï¼ŒæŠŠè¿™ä¸ªç±»æ‹¿å‡ºæ¥ï¼ŒæŠŠå®ƒå®ä¾‹åŒ–ï¼Œæ”¾åˆ° configClass ä¸­ã€‚&lt;br&gt;
ä¸Šè¿°ä»£ç ç¬¬ 8 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public void addImportBeanDefinitionRegistrar(ImportBeanDefinitionRegistrar registrar, AnnotationMetadata importingClassMetadata) {
   this.importBeanDefinitionRegistrars.put(registrar, importingClassMetadata);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;private final Map&amp;lt;ImportBeanDefinitionRegistrar, AnnotationMetadata&amp;gt; importBeanDefinitionRegistrars = new LinkedHashMap&amp;lt;&amp;gt;();
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;import-æ™®é€šç±»&#34;&gt;import æ™®é€šç±»&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;å…ˆæ”¾åˆ° configurationClassesï¼Œæ³¨å†Œæ—¶åˆ¤æ–­é‡Œé¢æœ‰æ²¡æœ‰ï¼Œå¦‚æœæœ‰å°±ä¸æ³¨å†Œäº†ï¼Œå› ä¸ºæ‰«æå‡ºæ¥çš„å·²ç»æœ‰äº†&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;processImports æ–¹æ³•ç¬¬ 51-62 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;else {
    // Candidate class not an ImportSelector or ImportBeanDefinitionRegistrar -&amp;gt;
    // process it as an @Configuration class
    // å¦åˆ™ï¼ŒåŠ å…¥åˆ° importStack åè°ƒç”¨ processConfigurationClass è¿›è¡Œå¤„ç†
    // processConfigurationClass é‡Œé¢ä¸»è¦å°±æ˜¯æŠŠç±»æ”¾åˆ° configurationClasses
    // configurationClasses æ˜¯ä¸€ä¸ªé›†åˆï¼Œä¼šåœ¨åé¢æ‹¿å‡ºæ¥è§£ææˆ bd ç»§è€Œæ³¨å†Œ
    // å¯ä»¥çœ‹åˆ°æ™®é€šç±»åœ¨æ‰«æå‡ºæ¥çš„æ—¶å€™å°±è¢«æ³¨å†Œäº†
    // å¦‚æœæ˜¯ importSelectorï¼Œä¼šå…ˆæ”¾åˆ° configurationClasses åé¢è¿›è¡Œå‡ºæ¥æ³¨å†Œ
    this.importStack.registerImport(currentSourceClass.getMetadata(), candidate.getMetadata().getClassName());
               processConfigurationClass(candidate.asConfigClass(configClass));
}     
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 10 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;protected void processConfigurationClass(ConfigurationClass configClass) throws IOException {
   // åˆ¤æ–­æ˜¯å¦åº”è¯¥è·³è¿‡è§£æ
   if (this.conditionEvaluator.shouldSkip(configClass.getMetadata(), ConfigurationPhase.PARSE_CONFIGURATION)) {
      return;
   }
   // å¤„ç† Imported çš„æƒ…å†µ
   // å°±æ˜¯å½“å‰è¿™ä¸ªç±»æœ‰æ²¡æœ‰è¢«åˆ«çš„ç±» @Import
   ConfigurationClass existingClass = this.configurationClasses.get(configClass);
   if (existingClass != null) {
      if (configClass.isImported()) {
         if (existingClass.isImported()) {
            existingClass.mergeImportedBy(configClass);
         }
         // Otherwise ignore new imported config class; existing non-imported class overrides it.
         return;
      }
      else {
         // Explicit bean definition found, probably replacing an import.
         // Let&#39;s remove the old one and go with the new one.
         this.configurationClasses.remove(configClass);
         this.knownSuperclasses.values().removeIf(configClass::equals);
      }
   }
   // Recursively process the configuration class and its superclass hierarchy.
   SourceClass sourceClass = asSourceClass(configClass);
   do {
      sourceClass = doProcessConfigurationClass(configClass, sourceClass);
   }
   while (sourceClass != null);
   // ä¸€ä¸ª mapï¼Œç”¨æ¥å­˜æ”¾æ‰«æå‡ºæ¥çš„ beanï¼ˆæ³¨æ„è¿™é‡Œçš„ bean ä¸æ˜¯å¯¹è±¡ï¼Œä»…ä»…æ˜¯ bean çš„ä¿¡æ¯ï¼Œå› ä¸ºè¿˜æ²¡åˆ°å®ä¾‹åŒ–ï¼‰
   this.configurationClasses.put(configClass, configClass);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è‡³æ­¤ä¸ºæ­¢ï¼Œæ‰§è¡Œå®Œäº† è‡ªå®šä¹‰çš„ BeanDefinitionRegistryPostProcessor + Spring å†…éƒ¨çš„ BeanDefinitionRegistryPostProcessor æ‰€æœ‰çš„ postProcessBeanDefinitionRegistry æ–¹æ³•ã€‚&lt;br&gt;
context. refresh(); ---&amp;gt; invokeBeanFactoryPostProcessors(beanFactory); ---&amp;gt; PostProcessorRegistrationDelegate.invokeBeanFactoryPostProcessors(beanFactory, getBeanFactoryPostProcessors()); è·å–&lt;strong&gt;è‡ªå®šä¹‰çš„ beanFactoryPostProcessors+ Spring å†…éƒ¨è‡ªå·±å®ç°äº† BeanDefinitionRegistryPostProcessor æ¥å£çš„å¯¹è±¡&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;---&amp;gt; invokeBeanDefinitionRegistryPostProcessors(currentRegistryProcessors, registry); &lt;strong&gt;æ‰§è¡Œæ‰€æœ‰ BeanDefinitionRegistryPostProcessor&lt;/strong&gt;---&amp;gt; postProcessor.postProcessBeanDefinitionRegistry(registry); ---&amp;gt; processConfigBeanDefinitions(registry); ---&amp;gt; parser.parse(candidates); è§£æï¼šæŠŠæ™®é€šç±»æ”¾åˆ° map ä¸­ï¼›this.reader.loadBeanDefinitions(configClasses); ç‰¹æ®Šç±»ï¼šå¤„ç†æ‰€æœ‰çš„ @Importï¼›&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public static void invokeBeanFactoryPostProcessors(
      ConfigurableListableBeanFactory beanFactory, List&amp;lt;BeanFactoryPostProcessor&amp;gt; beanFactoryPostProcessors) {
   // Invoke BeanDefinitionRegistryPostProcessors first, if any.
   Set&amp;lt;String&amp;gt; processedBeans = new HashSet&amp;lt;&amp;gt;();
   if (beanFactory instanceof BeanDefinitionRegistry) {
      BeanDefinitionRegistry registry = (BeanDefinitionRegistry) beanFactory;
      // å®šä¹‰ä¸¤ä¸ª listï¼Œ BeanDefinitionRegistryPostProcessor å®ç°äº† BeanFactoryPostProcessor æ¥å£
      // å› ä¸º bdrp æ˜¯å­ç±»ï¼Œå­ç±»è‚¯å®šæ‰©å±•äº†çˆ¶ç±»ä¸­çš„åŠŸèƒ½ã€‚
      List&amp;lt;BeanFactoryPostProcessor&amp;gt; regularPostProcessors = new ArrayList&amp;lt;&amp;gt;();
      List&amp;lt;BeanDefinitionRegistryPostProcessor&amp;gt; registryProcessors = new ArrayList&amp;lt;&amp;gt;();
      // è‡ªå®šä¹‰çš„ beanFactoryPostProcessors
      for (BeanFactoryPostProcessor postProcessor : beanFactoryPostProcessors) {
         if (postProcessor instanceof BeanDefinitionRegistryPostProcessor) {
            BeanDefinitionRegistryPostProcessor registryProcessor =
                  (BeanDefinitionRegistryPostProcessor) postProcessor;
            registryProcessor.postProcessBeanDefinitionRegistry(registry);
            registryProcessors.add(registryProcessor);
         }
         else {
            regularPostProcessors.add(postProcessor);
         }
      }
      // Do not initialize FactoryBeans here: We need to leave all regular beans
      // uninitialized to let the bean factory post-processors apply to them!
      // Separate between BeanDefinitionRegistryPostProcessors that implement
      // PriorityOrdered, Ordered, and the rest.
      // è¿™ä¸ª currentRegistryProcessors æ”¾çš„æ˜¯ Spring å†…éƒ¨è‡ªå·±å®ç°äº† BeanDefinitionRegistryPostProcessor æ¥å£çš„å¯¹è±¡
      List&amp;lt;BeanDefinitionRegistryPostProcessor&amp;gt; currentRegistryProcessors = new ArrayList&amp;lt;&amp;gt;();
      // First, invoke the BeanDefinitionRegistryPostProcessors that implement PriorityOrdered.
      // BeanDefinitionRegistryPostProcessor ç­‰äº BeanFactoryPostProcessor
      // getBeanNamesForTypeï¼šæ ¹æ® bean çš„ Type ç±»å‹è·å– bean çš„åå­—
      String[] postProcessorNames =
            beanFactory.getBeanNamesForType(BeanDefinitionRegistryPostProcessor.class, true, false);
      // è¿™ä¸ªåœ°æ–¹å¯ä»¥å¾—åˆ°ä¸€ä¸ª BeanFactoryPostProcessorï¼Œå› ä¸ºæ˜¯ Spring é»˜è®¤åœ¨æœ€å¼€å§‹è‡ªå·±æ³¨å†Œçš„
      // ä¸ºä»€ä¹ˆè¦åœ¨æœ€å¼€å§‹æ³¨å†Œè¿™ä¸ªå‘¢ï¼Ÿ
      // å› ä¸º Spring çš„å·¥å‚éœ€è¦æ³¨è§£å»æ‰«æç­‰ç­‰åŠŸèƒ½
      // è€Œè¿™äº›åŠŸèƒ½éƒ½æ˜¯éœ€è¦åœ¨ Spring å·¥å‚åˆå§‹åŒ–å®Œæˆä¹‹å‰å°±æ‰§è¡Œ
      // è¦ä¹ˆåœ¨å·¥å‚æœ€å¼€å§‹çš„æ—¶å€™ï¼Œè¦ä¹ˆåœ¨å·¥å‚åˆå§‹åŒ–ä¹‹ä¸­ï¼Œåæ­£ä¸èƒ½åœ¨ä¹‹å
      // å› ä¸ºå¦‚æœåœ¨ä¹‹åå°±æ²¡æœ‰æ„ä¹‰ï¼Œå› ä¸ºé‚£ä¸ªæ—¶å€™å·²ç»éœ€è¦ä½¿ç”¨å·¥å‚äº†
      // æ‰€ä»¥è¿™é‡Œ Spring åœ¨ä¸€å¼€å§‹å°±æ³¨å†Œäº†ä¸€ä¸ª BeanFactoryPostProcessorï¼Œç”¨æ¥æ’æ‰‹ springFactory çš„å®ä¾‹åŒ–è¿‡ç¨‹
      // åœ¨è¿™ä¸ªåœ°æ–¹æ–­ç‚¹å¯ä»¥çŸ¥é“è¿™ä¸ªç±»å«åš ConfigurationClassPostProcessor
      // ConfigurationClassPostProcessor é‚£ä¹ˆè¿™ä¸ªç±»èƒ½å¹²å˜›å‘¢ï¼Ÿå¯ä»¥å‚è€ƒæºç 
      // ä¸‹é¢å¯¹è¿™ä¸ªâ€œæ’æ‰‹ Spring å·¥å‚å®ä¾‹åŒ–è¿‡ç¨‹â€çš„ç±»é‡ç‚¹è§£é‡Š
      for (String ppName : postProcessorNames) {
         if (beanFactory.isTypeMatch(ppName, PriorityOrdered.class)) {
            currentRegistryProcessors.add(beanFactory.getBean(ppName, BeanDefinitionRegistryPostProcessor.class));
            processedBeans.add(ppName);
         }
      }
      // æ’åºä¸é‡è¦ï¼Œå†µä¸” currentRegistryProcessor è¿™é‡Œä¹Ÿåªæœ‰ä¸€ä¸ªæ•°æ®
      sortPostProcessors(currentRegistryProcessors, beanFactory);
      // åˆå¹¶ Listï¼Œä¸é‡è¦ï¼ˆä¸ºä»€ä¹ˆè¦åˆå¹¶ï¼Œå› ä¸ºæœ‰è‡ªå®šä¹‰çš„Springè‡ªå·±çš„ï¼‰
      registryProcessors.addAll(currentRegistryProcessors);
      // æœ€é‡è¦ã€‚æ³¨æ„è¿™é‡Œæ˜¯æ–¹æ³•è°ƒç”¨
      // æ‰§è¡Œæ‰€æœ‰ BeanDefinitionRegistryPostProcessor
      invokeBeanDefinitionRegistryPostProcessors(currentRegistryProcessors, registry);
      // æ‰§è¡Œå®Œäº†æ‰€æœ‰çš„ BeanDefinitionRegistryPostProcessor
      // è¿™ä¸ª list åªæ˜¯ä¸€ä¸ªä¸´æ—¶å˜é‡ï¼Œæ•…è€Œè¦æ¸…é™¤
      currentRegistryProcessors.clear();
      // Next, invoke the BeanDefinitionRegistryPostProcessors that implement Ordered.
      postProcessorNames = beanFactory.getBeanNamesForType(BeanDefinitionRegistryPostProcessor.class, true, false);
      for (String ppName : postProcessorNames) {
         if (!processedBeans.contains(ppName) &amp;amp;&amp;amp; beanFactory.isTypeMatch(ppName, Ordered.class)) {
            currentRegistryProcessors.add(beanFactory.getBean(ppName, BeanDefinitionRegistryPostProcessor.class));
            processedBeans.add(ppName);
         }
      }
      sortPostProcessors(currentRegistryProcessors, beanFactory);
      registryProcessors.addAll(currentRegistryProcessors);
      invokeBeanDefinitionRegistryPostProcessors(currentRegistryProcessors, registry);
      currentRegistryProcessors.clear();
      // Finally, invoke all other BeanDefinitionRegistryPostProcessors until no further ones appear.
      boolean reiterate = true;
      while (reiterate) {
         reiterate = false;
         postProcessorNames = beanFactory.getBeanNamesForType(BeanDefinitionRegistryPostProcessor.class, true, false);
         for (String ppName : postProcessorNames) {
            if (!processedBeans.contains(ppName)) {
               currentRegistryProcessors.add(beanFactory.getBean(ppName, BeanDefinitionRegistryPostProcessor.class));
               processedBeans.add(ppName);
               reiterate = true;
            }
         }
         sortPostProcessors(currentRegistryProcessors, beanFactory);
         registryProcessors.addAll(currentRegistryProcessors);
         invokeBeanDefinitionRegistryPostProcessors(currentRegistryProcessors, registry);
         currentRegistryProcessors.clear();
      }
      // Now, invoke the postProcessBeanFactory callback of all processors handled so far.
      // æ‰§è¡Œ BeanFactoryPostProcessor çš„å›è°ƒï¼Œå‰é¢ä¸æ˜¯å—ï¼Ÿ
      // å‰é¢æ‰§è¡Œçš„ BeanFactoryPostProcessor çš„å­ç±» BeanDefinitionRegistryPostProcessor çš„å›è°ƒ
      // è¿™é‡Œæ‰§è¡Œçš„æ˜¯ BeanFactoryPostProcessor çš„å›è°ƒ
      invokeBeanFactoryPostProcessors(registryProcessors, beanFactory);
      //
      invokeBeanFactoryPostProcessors(regularPostProcessors, beanFactory);
   }
   else {
      // Invoke factory processors registered with the context instance.
      invokeBeanFactoryPostProcessors(beanFactoryPostProcessors, beanFactory);
   }
   // Do not initialize FactoryBeans here: We need to leave all regular beans
   // uninitialized to let the bean factory post-processors apply to them!
   String[] postProcessorNames =
         beanFactory.getBeanNamesForType(BeanFactoryPostProcessor.class, true, false);
   // Separate between BeanFactoryPostProcessors that implement PriorityOrdered,
   // Ordered, and the rest.
   List&amp;lt;BeanFactoryPostProcessor&amp;gt; priorityOrderedPostProcessors = new ArrayList&amp;lt;&amp;gt;();
   List&amp;lt;String&amp;gt; orderedPostProcessorNames = new ArrayList&amp;lt;&amp;gt;();
   List&amp;lt;String&amp;gt; nonOrderedPostProcessorNames = new ArrayList&amp;lt;&amp;gt;();
   for (String ppName : postProcessorNames) {
      if (processedBeans.contains(ppName)) {
         // skip - already processed in first phase above
      }
      else if (beanFactory.isTypeMatch(ppName, PriorityOrdered.class)) {
         priorityOrderedPostProcessors.add(beanFactory.getBean(ppName, BeanFactoryPostProcessor.class));
      }
      else if (beanFactory.isTypeMatch(ppName, Ordered.class)) {
         orderedPostProcessorNames.add(ppName);
      }
      else {
         nonOrderedPostProcessorNames.add(ppName);
      }
   }
   // First, invoke the BeanFactoryPostProcessors that implement PriorityOrdered.
   sortPostProcessors(priorityOrderedPostProcessors, beanFactory);
   invokeBeanFactoryPostProcessors(priorityOrderedPostProcessors, beanFactory);
   // Next, invoke the BeanFactoryPostProcessors that implement Ordered.
   List&amp;lt;BeanFactoryPostProcessor&amp;gt; orderedPostProcessors = new ArrayList&amp;lt;&amp;gt;();
   for (String postProcessorName : orderedPostProcessorNames) {
      orderedPostProcessors.add(beanFactory.getBean(postProcessorName, BeanFactoryPostProcessor.class));
   }
   sortPostProcessors(orderedPostProcessors, beanFactory);
   invokeBeanFactoryPostProcessors(orderedPostProcessors, beanFactory);
   // Finally, invoke all other BeanFactoryPostProcessors.
   List&amp;lt;BeanFactoryPostProcessor&amp;gt; nonOrderedPostProcessors = new ArrayList&amp;lt;&amp;gt;();
   for (String postProcessorName : nonOrderedPostProcessorNames) {
      nonOrderedPostProcessors.add(beanFactory.getBean(postProcessorName, BeanFactoryPostProcessor.class));
   }
   invokeBeanFactoryPostProcessors(nonOrderedPostProcessors, beanFactory);
   // Clear cached merged bean definitions since the post-processors might have
   // modified the original metadata, e.g. replacing placeholders in values...
   beanFactory.clearMetadataCache();
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ç¬¬ 98-102 è¡Œä»£ç ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// Now, invoke the postProcessBeanFactory callback of all processors handled so far.
// æ‰§è¡Œ BeanFactoryPostProcessor çš„å›è°ƒï¼Œå‰é¢ä¸æ˜¯å—ï¼Ÿ
// å‰é¢æ‰§è¡Œçš„ BeanFactoryPostProcessor çš„å­ç±» BeanDefinitionRegistryPostProcessor çš„å›è°ƒ
// è¿™é‡Œæ‰§è¡Œçš„æ˜¯ BeanFactoryPostProcessor çš„å›è°ƒ
invokeBeanFactoryPostProcessors(registryProcessors, beanFactory);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‰§è¡Œ BeanFactoryPostProcessor çš„å›è°ƒï¼Œå‰é¢ä¸æ˜¯å—ï¼Ÿ&lt;br&gt;
å‰é¢æ‰§è¡Œçš„ BeanFactoryPostProcessor çš„å­ç±» BeanDefinitionRegistryPostProcessor çš„å›è°ƒã€‚è¿™é‡Œæ‰§è¡Œçš„æ˜¯ BeanFactoryPostProcessor çš„å›è°ƒã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å‰é¢çš„ä»£ç éªŒè¯ä¸€ä¸‹ï¼Œä¸Šè¿°æ–¹æ³•ç¬¬ 16 è¡Œï¼Œåˆ¤æ–­æ˜¯ä¸æ˜¯ BeanDefinitionRegistryPostProcessorï¼Œå¦‚æœæ˜¯ï¼Œå°±æŠŠå®ƒæ”¾åˆ° registryProcessors ä¸­ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;for (BeanFactoryPostProcessor postProcessor : beanFactoryPostProcessors) {
   if (postProcessor instanceof BeanDefinitionRegistryPostProcessor) {
      BeanDefinitionRegistryPostProcessor registryProcessor =
            (BeanDefinitionRegistryPostProcessor) postProcessor;
      registryProcessor.postProcessBeanDefinitionRegistry(registry);
      registryProcessors.add(registryProcessor);
   }
   else {
      regularPostProcessors.add(postProcessor);
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ¥ä¸‹æ¥çœ‹ invokeBeanFactoryPostProcessors æ–¹æ³•ï¼šå®Œæˆ BeanFactoryPostProcessor çš„å›è°ƒ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;private static void invokeBeanFactoryPostProcessors(
      Collection&amp;lt;? extends BeanFactoryPostProcessor&amp;gt; postProcessors, ConfigurableListableBeanFactory beanFactory) {
   for (BeanFactoryPostProcessor postProcessor : postProcessors) {
      postProcessor.postProcessBeanFactory(beanFactory);
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç‚¹è¿›æ¥è¿™ä¸ªæ–¹æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public void postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory) {
   int factoryId = System.identityHashCode(beanFactory);
   if (this.factoriesPostProcessed.contains(factoryId)) {
      throw new IllegalStateException(
            &amp;quot;postProcessBeanFactory already called on this post-processor against &amp;quot; + beanFactory);
   }
   this.factoriesPostProcessed.add(factoryId);
   if (!this.registriesPostProcessed.contains(factoryId)) {
      // BeanDefinitionRegistryPostProcessor hook apparently not supported...
      // Simply call processConfigurationClasses lazily at this point then.
      processConfigBeanDefinitions((BeanDefinitionRegistry) beanFactory);
   }
   // äº§ç”Ÿ cglib ä»£ç†
   // ä¸ºä»€ä¹ˆéœ€è¦äº§ç”Ÿ cglib ä»£ç†
   enhanceConfigurationClasses(beanFactory);
   beanFactory.addBeanPostProcessor(new ImportAwareBeanPostProcessor(beanFactory));
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;full-ä¸-lite&#34;&gt;FULL ä¸ LITE&lt;/h1&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 16 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public void enhanceConfigurationClasses(ConfigurableListableBeanFactory beanFactory) {
   Map&amp;lt;String, AbstractBeanDefinition&amp;gt; configBeanDefs = new LinkedHashMap&amp;lt;&amp;gt;();
   for (String beanName : beanFactory.getBeanDefinitionNames()) {
      BeanDefinition beanDef = beanFactory.getBeanDefinition(beanName);
      // åˆ¤æ–­æ˜¯å¦æ˜¯ä¸€ä¸ªå…¨æ³¨è§£ç±»
      // ä»€ä¹ˆæ˜¯å…¨æ³¨è§£ç±»ï¼ŸFULL å’Œ LITE
      if (ConfigurationClassUtils.isFullConfigurationClass(beanDef)) {
         if (!(beanDef instanceof AbstractBeanDefinition)) {
            throw new BeanDefinitionStoreException(&amp;quot;Cannot enhance @Configuration bean definition &#39;&amp;quot; +
                  beanName + &amp;quot;&#39; since it is not stored in an AbstractBeanDefinition subclass&amp;quot;);
         }
         else if (logger.isWarnEnabled() &amp;amp;&amp;amp; beanFactory.containsSingleton(beanName)) {
            logger.warn(&amp;quot;Cannot enhance @Configuration bean definition &#39;&amp;quot; + beanName +
                  &amp;quot;&#39; since its singleton instance has been created too early. The typical cause &amp;quot; +
                  &amp;quot;is a non-static @Bean method with a BeanDefinitionRegistryPostProcessor &amp;quot; +
                  &amp;quot;return type: Consider declaring such methods as &#39;static&#39;.&amp;quot;);
         }
         configBeanDefs.put(beanName, (AbstractBeanDefinition) beanDef);
      }
   }
   if (configBeanDefs.isEmpty()) {
      // nothing to enhance -&amp;gt; return immediately
      return;
   }
   ConfigurationClassEnhancer enhancer = new ConfigurationClassEnhancer();
   for (Map.Entry&amp;lt;String, AbstractBeanDefinition&amp;gt; entry : configBeanDefs.entrySet()) {
      AbstractBeanDefinition beanDef = entry.getValue();
      // If a @Configuration class gets proxied, always proxy the target class
      beanDef.setAttribute(AutoProxyUtils.PRESERVE_TARGET_CLASS_ATTRIBUTE, Boolean.TRUE);
      try {
         // Set enhanced subclass of the user-specified bean class
         Class&amp;lt;?&amp;gt; configClass = beanDef.resolveBeanClass(this.beanClassLoader);
         if (configClass != null) {
            Class&amp;lt;?&amp;gt; enhancedClass = enhancer.enhance(configClass, this.beanClassLoader);
            if (configClass != enhancedClass) {
               if (logger.isDebugEnabled()) {
                  logger.debug(String.format(&amp;quot;Replacing bean definition &#39;%s&#39; existing class &#39;%s&#39; with &amp;quot; +
                        &amp;quot;enhanced class &#39;%s&#39;&amp;quot;, entry.getKey(), configClass.getName(), enhancedClass.getName()));
               }
               beanDef.setBeanClass(enhancedClass);
            }
         }
      }
      catch (Throwable ex) {
         throw new IllegalStateException(&amp;quot;Cannot load configuration class: &amp;quot; + beanDef.getBeanClassName(), ex);
      }
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœæ²¡æœ‰æ·»åŠ  @Configuration ä¼šç›´æ¥åœ¨ä¸Šè¿°ä»£ç ç¬¬ 23 è¡Œ return;&lt;br&gt;
å¦‚æœæ·»åŠ äº† @Configuration åï¼Œå°±ä¸ä¼šåœ¨ç¬¬ 23 è¡Œ return;è€Œæ˜¯ä¼šç»§ç»­å‘ä¸‹èµ°åˆ°ç¬¬ 26 è¡Œã€‚&lt;/p&gt;
&lt;p&gt;åŠ äº† @Configuration ä¼šè¿›è¡Œ cglib ä»£ç†ï¼Œå¦‚æœä¸åŠ  @Configuration  å°±ä¸ä¼šè¿›è¡Œ cglib åŠ¨æ€ä»£ç†ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆåŠ äº† @Configuration èƒ½å¤Ÿå‘ä¸‹èµ°åˆ°ç¬¬ 26 è¡Œå‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 5-8 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// åˆ¤æ–­æ˜¯å¦æ˜¯ä¸€ä¸ªå…¨æ³¨è§£ç±»
// ä»€ä¹ˆæ˜¯å…¨æ³¨è§£ç±»ï¼ŸFULL å’Œ LITE
if (ConfigurationClassUtils.isFullConfigurationClass(beanDef)) {
  if (!(beanDef instanceof AbstractBeanDefinition)) {  
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åœ¨è§£æ AppConfig æ—¶ï¼Œå¦‚æœ AppConfig æœ‰ @Configuration æ³¨è§£ï¼Œå°±ä¼šç»™å®ƒè®¾ç½®ä¸€ä¸ªå±æ€§ FULLï¼›å¦‚æœæ²¡æœ‰ï¼Œå°±è®¾ç½®å±æ€§ LITEã€‚&lt;br&gt;
&lt;strong&gt;FULL ä¸ LITE åªæ˜¯ Spring å½“ä¸­çš„ä¸€ä¸ªæ ‡è¯†ï¼ŒSpring æ ‡è¯†ä¸º FULLï¼Œè¡¨ç¤ºå®ƒæ˜¯ä¸€ä¸ªå…¨é…ç½®ç±»ï¼ŒSpring åœ¨ä¸ºå®ƒç”Ÿæˆ Bean æ—¶ï¼Œä¼šåŠ ä¸Š cglib ä»£ç†ã€‚æ ‡å¿—ä¸º LITEï¼Œè¡¨ç¤ºå®ƒæ˜¯ä¸€ä¸ªéƒ¨åˆ†é…ç½®ç±»&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%B7%BB%E5%8A%A0@Configuration%E6%B3%A8%E8%A7%A3.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E4%B8%8D%E6%B7%BB%E5%8A%A0@Configuration%E6%B3%A8%E8%A7%A3.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;ä¸ºä»€ä¹ˆè¦ç»™è¿™ä¸ªç±»åŠ ä¸Š-cglib-åŠ¨æ€ä»£ç†&#34;&gt;ä¸ºä»€ä¹ˆè¦ç»™è¿™ä¸ªç±»åŠ ä¸Š cglib åŠ¨æ€ä»£ç†&lt;/h1&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class IndexDaoImpl2 implements IndexDao{
   @Override
   public void query() {
      System.out.println(&amp;quot;dao2...æ¨¡æ‹ŸæŸ¥è¯¢æ•°æ®åº“&amp;quot;);
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class IndexDaoImpl implements IndexDao{
   public IndexDaoImpl(){
      System.out.println(&amp;quot;indexDao...constructor&amp;quot;);
   }
   @Override
   public void query() {
      System.out.println(&amp;quot;dao...æ¨¡æ‹ŸæŸ¥è¯¢æ•°æ®åº“&amp;quot;);
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@ComponentScan(&amp;quot;com.ssm&amp;quot;)
public class AppConfig {
   @Bean
   public IndexDao indexDao2(){
      return new IndexDaoImpl2();
   }
   @Bean
   public IndexDao indexDao(){
      return new IndexDaoImpl();
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
   public static void main(String[] args) {
      // æŠŠ Spring æ‰€æœ‰å‰æç¯å¢ƒå‡†å¤‡å¥½
      // 1.å‡†å¤‡å·¥å‚=DefaultListableBeanFactory
      // å®ä¾‹åŒ–ä¸€ä¸ª bdReader å’Œä¸€ä¸ª scanner
      AnnotationConfigApplicationContext context =
            new AnnotationConfigApplicationContext();
      // æŠŠä¸€ä¸ª class è½¬æˆ bdï¼Œæœ€å put åˆ° map
      // map ä½ç½® DefaultListableBeanFactory çš„ beanDefinitionMap
      context.register(AppConfig.class);
      // åˆå§‹åŒ– Spring çš„ç¯å¢ƒ
      context. refresh();
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;indexDao...constructor
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åˆ†æï¼šå½“æ‰§è¡Œ indexDao() æ—¶ï¼Œnew IndexDaoImpl()ï¼Œè°ƒç”¨ IndexDaoImpl çš„æ„é€ æ–¹æ³•ï¼Œæ‰€ä»¥IndexDaoImpl çš„æ„é€ æ–¹æ³•æ‰§è¡Œä¸€æ¬¡ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@ComponentScan(&amp;quot;com.ssm&amp;quot;)
public class AppConfig {
   @Bean
   public IndexDao indexDao2(){
      indexDao();
      return new IndexDaoImpl2();
   }
   @Bean
   public IndexDao indexDao(){
      return new IndexDaoImpl();
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;indexDao...constructor
indexDao...constructor
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åˆ†æï¼šå½“æ‰§è¡Œ indexDao() æ—¶ï¼Œnew IndexDaoImpl()ï¼Œè°ƒç”¨ IndexDaoImpl çš„æ„é€ æ–¹æ³•ã€‚&lt;br&gt;
å½“æ‰§è¡Œ indexDao2 æ–¹æ³•æ—¶ï¼Œå†æ¬¡è°ƒç”¨ indexDao(); æ–¹æ³•ï¼Œæ‰€ä»¥IndexDaoImpl çš„æ„é€ æ–¹æ³•å…±æ‰§è¡Œäº†ä¸¤æ¬¡ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Configuration
@ComponentScan(&amp;quot;com.ssm&amp;quot;)
public class AppConfig {
   @Bean
   public IndexDao indexDao2(){
      indexDao();
      return new IndexDaoImpl2();
   }
   @Bean
   public IndexDao indexDao(){
      return new IndexDaoImpl();
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;indexDao...constructor
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åˆ†æï¼š&lt;strong&gt;æ·»åŠ äº† @Configuration åï¼Œä»…è°ƒç”¨ä¸€æ¬¡ IndexDao çš„æ„é€ æ–¹æ³•&lt;/strong&gt;ã€‚&lt;br&gt;
indexDao() æ–¹æ³•è¢«æ”¹å˜äº†ï¼Œå³ä½¿åœ¨ indexDao2() å†…å†æ¬¡è°ƒç”¨ indexDao()ï¼Œä¹Ÿä¸ä¼šæ‰§è¡Œæ–¹æ³•å†…çš„ä»£ç  new IndexDaoImpl(); äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚ä½•æ”¹å˜ä¸€ä¸ªæ–¹æ³• indexD()ï¼Ÿ&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä»£ç† AppConfig&lt;/strong&gt;ï¼Œå½“è°ƒç”¨ AppConfig çš„ indexDao() æ—¶ï¼Œè°ƒç”¨çš„æ˜¯ä»£ç†ç±» AppConfig å†…éƒ¨çš„ indexDao()ï¼Œè€Œä¸æ˜¯æ™®é€šç±» AppConfig å†…éƒ¨çš„ indexDao()ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public void enhanceConfigurationClasses(ConfigurableListableBeanFactory beanFactory) {
   Map&amp;lt;String, AbstractBeanDefinition&amp;gt; configBeanDefs = new LinkedHashMap&amp;lt;&amp;gt;();
   for (String beanName : beanFactory.getBeanDefinitionNames()) {
      BeanDefinition beanDef = beanFactory.getBeanDefinition(beanName);
      // åˆ¤æ–­æ˜¯å¦æ˜¯ä¸€ä¸ªå…¨æ³¨è§£ç±»
      // ä»€ä¹ˆæ˜¯å…¨æ³¨è§£ç±»ï¼ŸFULL å’Œ LITE
      if (ConfigurationClassUtils.isFullConfigurationClass(beanDef)) {
         if (!(beanDef instanceof AbstractBeanDefinition)) {
            throw new BeanDefinitionStoreException(&amp;quot;Cannot enhance @Configuration bean definition &#39;&amp;quot; +
                  beanName + &amp;quot;&#39; since it is not stored in an AbstractBeanDefinition subclass&amp;quot;);
         }
         else if (logger.isWarnEnabled() &amp;amp;&amp;amp; beanFactory.containsSingleton(beanName)) {
            logger.warn(&amp;quot;Cannot enhance @Configuration bean definition &#39;&amp;quot; + beanName +
                  &amp;quot;&#39; since its singleton instance has been created too early. The typical cause &amp;quot; +
                  &amp;quot;is a non-static @Bean method with a BeanDefinitionRegistryPostProcessor &amp;quot; +
                  &amp;quot;return type: Consider declaring such methods as &#39;static&#39;.&amp;quot;);
         }
         //  å¦‚æœæ˜¯ä¸€ä¸ªå…¨æ³¨è§£ï¼Œæ·»åŠ åˆ° configBeanDefs ä¸­ï¼›å¦‚æœä¸æ˜¯å…¨æ³¨è§£ï¼Œåˆ™ä¸ä¼šputï¼Œå³ configBeanDefs ä¸ºç©º
         configBeanDefs.put(beanName, (AbstractBeanDefinition) beanDef);
      }
   }
   // å¦‚æœä¸æ˜¯å…¨æ³¨è§£ï¼ŒconfigBeanDefs ä¸ºç©ºï¼Œç›´æ¥ return;
   if (configBeanDefs.isEmpty()) {
      // nothing to enhance -&amp;gt; return immediately
      return;
   }
   ConfigurationClassEnhancer enhancer = new ConfigurationClassEnhancer();
   for (Map.Entry&amp;lt;String, AbstractBeanDefinition&amp;gt; entry : configBeanDefs.entrySet()) {
      AbstractBeanDefinition beanDef = entry.getValue();
      // If a @Configuration class gets proxied, always proxy the target class
      beanDef.setAttribute(AutoProxyUtils.PRESERVE_TARGET_CLASS_ATTRIBUTE, Boolean.TRUE);
      try {
         // Set enhanced subclass of the user-specified bean class
         Class&amp;lt;?&amp;gt; configClass = beanDef.resolveBeanClass(this.beanClassLoader);
         if (configClass != null) {
            // å®Œæˆå¯¹å…¨æ³¨è§£ç±»çš„ cglib ä»£ç†
            Class&amp;lt;?&amp;gt; enhancedClass = enhancer.enhance(configClass, this.beanClassLoader);
            if (configClass != enhancedClass) {
               if (logger.isDebugEnabled()) {
                  logger.debug(String.format(&amp;quot;Replacing bean definition &#39;%s&#39; existing class &#39;%s&#39; with &amp;quot; +
                        &amp;quot;enhanced class &#39;%s&#39;&amp;quot;, entry.getKey(), configClass.getName(), enhancedClass.getName()));
               }
               beanDef.setBeanClass(enhancedClass);
            }
         }
      }
      catch (Throwable ex) {
         throw new IllegalStateException(&amp;quot;Cannot load configuration class: &amp;quot; + beanDef.getBeanClassName(), ex);
      }
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 38 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public Class&amp;lt;?&amp;gt; enhance(Class&amp;lt;?&amp;gt; configClass, @Nullable ClassLoader classLoader) {
   if (EnhancedConfiguration.class.isAssignableFrom(configClass)) {
      if (logger.isDebugEnabled()) {
         logger.debug(String.format(&amp;quot;Ignoring request to enhance %s as it has &amp;quot; +
               &amp;quot;already been enhanced. This usually indicates that more than one &amp;quot; +
               &amp;quot;ConfigurationClassPostProcessor has been registered (e.g. via &amp;quot; +
               &amp;quot;&amp;lt;context:annotation-config&amp;gt;). This is harmless, but you may &amp;quot; +
               &amp;quot;want check your configuration and remove one CCPP if possible&amp;quot;,
               configClass.getName()));
      }
      return configClass;
   }
   // cglib ä»£ç†
   Class&amp;lt;?&amp;gt; enhancedClass = createClass(newEnhancer(configClass, classLoader));
   if (logger.isDebugEnabled()) {
      logger.debug(String.format(&amp;quot;Successfully enhanced %s; enhanced class name is: %s&amp;quot;,
            configClass.getName(), enhancedClass.getName()));
   }
   return enhancedClass;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åˆ›å»ºä¸€ä¸ªç±»ï¼ŒæŠŠè¿™ä¸ªç±» enhancedClassÂ  è¿”å›ï¼Œå› ä¸ºæ­¤æ—¶è¿˜æ²¡æœ‰å®ä¾‹åŒ–å¯¹è±¡ï¼Œ&lt;br&gt;
AppConfig - cglibçš„class - BeanDefinition - cglibçš„Bean&lt;/p&gt;
&lt;p&gt;å¦‚ä½•è¿”å›ä¸€ä¸ª cglib çš„ classï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 14 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;private Enhancer newEnhancer(Class&amp;lt;?&amp;gt; configSuperClass, @Nullable ClassLoader classLoader) {
   Enhancer enhancer = new Enhancer();
   // å¢å¼ºçˆ¶ç±»ï¼Œcglib æ˜¯åŸºäºç»§æ‰¿æ¥çš„
   // æŠŠå½“å‰ç±» configSuperClass ä½œä¸º enhancer çš„çˆ¶ç±»
   enhancer.setSuperclass(configSuperClass);
   // å¢å¼ºæ¥å£ï¼Œä¸ºä»€ä¹ˆè¦å¢å¼ºæ¥å£ï¼Ÿ
   // ä¾¿äºåˆ¤æ–­ï¼Œè¡¨ç¤ºä¸€ä¸ªç±»å·²ç»è¢«å¢å¼ºäº†
   enhancer.setInterfaces(new Class&amp;lt;?&amp;gt;[] {EnhancedConfiguration.class});
   enhancer.setUseFactory(false);
   enhancer.setNamingPolicy(SpringNamingPolicy.INSTANCE);
   // BeanFactoryAwareGeneratorStrategy æ˜¯ä¸€ä¸ªç”Ÿæˆç­–ç•¥
   // ä¸»è¦ä¸ºç”Ÿæˆçš„ CGLIB ç±»ä¸­æ·»åŠ æˆå‘˜å˜é‡ $$beanFactory
   // åŒæ—¶åŸºäºæ¥å£ EnhancedConfiguration çš„çˆ¶æ¥å£ BeanFactoryAware ä¸­çš„ setBeanFactory æ–¹æ³•ï¼Œ
   // è®¾ç½®æ­¤å˜é‡çš„å€¼ä¸ºå½“å‰ Context ä¸­çš„ beanFactoryï¼Œè¿™æ ·ä¸€æ¥æˆ‘ä»¬è¿™ä¸ª cglib ä»£ç†çš„å¯¹è±¡å°±æœ‰äº† beanFactory
   // æœ‰äº† factory å°±èƒ½è·å¾—å¯¹è±¡ï¼Œè€Œä¸ç”¨å»é€šè¿‡æ–¹æ³•è·å¾—å¯¹è±¡äº†ï¼Œå› ä¸ºé€šè¿‡æ–¹æ³•è·å¾—å¯¹è±¡ä¸èƒ½æ§åˆ¶å…¶è¿‡ç¨‹
   // BeanFactory çš„ä½œç”¨æ˜¯åœ¨ this è°ƒç”¨æ—¶æ‹¦æˆªè¯¥è°ƒç”¨ï¼Œå¹¶ç›´æ¥åœ¨ beanFactory ä¸­è·å¾—ç›®æ ‡ bean
   enhancer.setStrategy(new BeanFactoryAwareGeneratorStrategy(classLoader));
   // å½“è°ƒç”¨ indexDao() æ—¶è¿›è¡Œæ‹¦æˆª
   enhancer.setCallbackFilter(CALLBACK_FILTER);
   enhancer.setCallbackTypes(CALLBACK_FILTER.getCallbackTypes());
   return enhancer;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;EnhancedConfiguration ç»§æ‰¿äº† BeanFactoryAware&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public interface EnhancedConfiguration extends BeanFactoryAware {
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;BeanFactoryAware å®ç°äº† Awareï¼ŒAware é‡Œé¢æœ‰ä¸€ä¸ª setBeanFactory æ–¹æ³•&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public interface BeanFactoryAware extends Aware {
   /**
    * Callback that supplies the owning factory to a bean instance.
    * &amp;lt;p&amp;gt;Invoked after the population of normal bean properties
    * but before an initialization callback such as
    * {@link InitializingBean#afterPropertiesSet()} or a custom init-method.
    * @param beanFactory owning BeanFactory (never {@code null}).
    * The bean can immediately call methods on the factory.
    * @throws BeansException in case of initialization errors
    * @see BeanInitializationException
    */
   void setBeanFactory(BeanFactory beanFactory) throws BeansException;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è®© CGLIB äº§ç”Ÿçš„ä»£ç†å¯¹è±¡èƒ½å¤Ÿè·å¾— BeanFactoryã€‚&lt;/p&gt;
&lt;h3 id=&#34;cglib-çš„ä»£ç†å¯¹è±¡ä¸ºä»€ä¹ˆè¦å¾—åˆ°-beanfactory&#34;&gt;CGLIB çš„ä»£ç†å¯¹è±¡ä¸ºä»€ä¹ˆè¦å¾—åˆ° BeanFactoryï¼Ÿ&lt;/h3&gt;
&lt;p&gt;AppConfig åœ¨æ‰§è¡Œä»£ç†å‰ç›´æ¥ä½¿ç”¨å®ƒå¾—åˆ°åŸå§‹ç±»ï¼Œå°±ä¼šæ‰§è¡ŒåŸå§‹ç±»ä¸­çš„åŸå§‹æ–¹æ³•ï¼Œæ¯è°ƒç”¨ä¸€æ¬¡ indexDao() æ–¹æ³•ï¼Œå°±ä¼š new IndexDaoImpl(); è¿èƒŒäº† Spring ä¸­çš„å•ä¾‹åŸåˆ™ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨åŸå§‹å¯¹è±¡ï¼Œå°±éœ€è¦ä½¿ç”¨ä»£ç†å¯¹è±¡ï¼Œå½“å†æ¬¡è°ƒç”¨ indexDao() æ–¹æ³•æ—¶ï¼Œæ‰§è¡Œä»£ç†å¯¹è±¡å†…çš„ indexDao() æ–¹æ³•ï¼Œä¸å† new  IndexDaoImpl()ï¼Œè€Œæ˜¯ç›´æ¥è¿”å›å·²ç»å­˜åœ¨çš„ IndexDaoImplã€‚&lt;/p&gt;
&lt;p&gt;![å›¾ç‰‡](https://epitomm.github.io/post-images/CGLIBçš„ä»£ç†å¯¹è±¡ä¸ºä»€ä¹ˆè¦å¾—åˆ° BeanFactory.png)&lt;/p&gt;
&lt;p&gt;å½“ç¬¬ä¸€æ¬¡è°ƒç”¨ indexDao() æ—¶ï¼Œnew IndexDaoImpl()ï¼Œæ”¾åˆ°å®¹å™¨ä¸­ï¼Œå½“ç¬¬äºŒæ¬¡è°ƒç”¨æ—¶ï¼Œä¸å† newï¼Œè€Œæ˜¯ç›´æ¥ä»å®¹å™¨ä¸­æ‹¿å‡ºæ¥ &lt;strong&gt;factory.getBean()&lt;/strong&gt;ï¼Œå°±éœ€è¦åœ¨ä»£ç†å¯¹è±¡ä¸­æœ‰ä¸€ä¸ª BeanFactoryï¼Œä¸ç„¶æ²¡åŠæ³• factory.getBean()ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¦‚ä½•å¾—åˆ°ä¸€ä¸ª-beanfactory&#34;&gt;å¦‚ä½•å¾—åˆ°ä¸€ä¸ª BeanFactoryï¼Ÿ&lt;/h3&gt;
&lt;p&gt;å®ç° BeanFactoryAware æ¥å£ï¼Œåç½®å¤„ç†å™¨åœ¨å®ä¾‹åŒ–å¯¹è±¡å‰ï¼ŒæŠŠå®ƒæ”¾è¿›æ¥ã€‚&lt;/p&gt;
&lt;p&gt;BeanFactoryAwareGeneratorStrategyï¼šCGLIB ç”Ÿæˆç±»çš„ç­–ç•¥ã€‚&lt;/p&gt;
&lt;p&gt;é»˜è®¤ç­–ç•¥ï¼šDefaultGeneratorStrategyï¼Œç”ŸæˆåŸºæœ¬çš„ã€‚å¦‚æœéœ€è¦æ‰©å±•ï¼Œä½¿ç”¨ä¸€ä¸ªç±» BeanFactoryAwareGeneratorStrategyï¼šCGLIB  ç»§æ‰¿ DefaultGeneratorStrategyï¼Œåœ¨ç”Ÿæˆè¿™ä¸ªç±»çš„è¿‡ç¨‹ä¸­ï¼Œè°ƒç”¨ declare_field æ–¹æ³•ï¼šå£°æ˜ä¸€ä¸ªå±æ€§ $$beanFactoryã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;protected ClassGenerator transform(ClassGenerator cg) throws Exception {
   ClassEmitterTransformer transformer = new ClassEmitterTransformer() {
      @Override
      public void end_class() {
         declare_field(Constants.ACC_PUBLIC, BEAN_FACTORY_FIELD, Type.getType(BeanFactory.class), null);
         super.end_class();
      }
   };
   return new TransformingClassGenerator(cg, transformer);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;private static final String BEAN_FACTORY_FIELD = &amp;quot;$$beanFactory&amp;quot;;
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
   public static void main(String[] args) {
      // æŠŠ Spring æ‰€æœ‰å‰æç¯å¢ƒå‡†å¤‡å¥½
      // 1.å‡†å¤‡å·¥å‚=DefaultListableBeanFactory
      // å®ä¾‹åŒ–ä¸€ä¸ª bdReader å’Œä¸€ä¸ª scanner
      AnnotationConfigApplicationContext context =
            new AnnotationConfigApplicationContext();
      // æŠŠä¸€ä¸ª class è½¬æˆ bdï¼Œæœ€å put åˆ° map
      // map ä½ç½® DefaultListableBeanFactory çš„ beanDefinitionMap
      context.register(AppConfig.class);
      // åˆå§‹åŒ– Spring çš„ç¯å¢ƒ
      context. refresh();
      /**
        * å¯¹ç›®æ ‡å¯¹è±¡çš„æ‰€æœ‰æ–¹æ³•è¿›è¡Œæ‹¦æˆª
        */
      Enhancer enhancer = new Enhancer();
      enhancer.setSuperclass(IndexDaoImpl.class);
      // å¢å¼ºæ¥å£
      enhancer.setNamingPolicy(SpringNamingPolicy.INSTANCE);
      // æ·»åŠ æ–¹æ³•è¿‡æ»¤å™¨
      enhancer.setCallback(new TestMethodCallabck());
      IndexDaoImpl indexDao = (IndexDaoImpl) enhancer.create();
      indexDao.query();
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class TestMethodCallabck implements MethodInterceptor {
   /**
    *
    * @param o ä»£ç†å¯¹è±¡
    * @param method å½“å‰æ–¹æ³•ï¼Œç›®æ ‡å¯¹è±¡çš„æ–¹æ³•
    * @param objects å‚æ•°
    * @param methodProxy ä»£ç†å¯¹è±¡çš„æ–¹æ³•
    * @return
    * @throws Throwable
    */
   @Override
   public Object intercept(Object o, Method method, Object[] objects, MethodProxy methodProxy) throws Throwable {
      System.out.println(&amp;quot;method...&amp;quot;);
      return methodProxy.invokeSuper(o,objects);
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;indexDao...constructor
indexDao...constructor
method...
dao...æ¨¡æ‹ŸæŸ¥è¯¢æ•°æ®åº“
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;newEnhancer æ–¹æ³•çš„ç¬¬ 19 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;private static final ConditionalCallbackFilter CALLBACK_FILTER = new ConditionalCallbackFilter(CALLBACKS);
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;private static final Callback[] CALLBACKS = new Callback[] {
      new BeanMethodInterceptor(),
      new BeanFactoryAwareMethodInterceptor(),
      NoOp.INSTANCE
};
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;configuration&#34;&gt;@Configuration&lt;/h1&gt;
&lt;p&gt;è®© AppConfig äº§ç”Ÿä¸€ä¸ª CGLIB åŠ¨æ€ä»£ç†ç±»ï¼Œè¿™ä¸ª CGLIB ä»£ç†ç±»ä¼šå»å®ç°ä¸€ä¸ª BeanFactoryAware æ¥å£ï¼Œè‡ªåŠ¨æ³¨å…¥ä¸€ä¸ª BeanFactoryï¼Œäºæ˜¯å½“å†æ¬¡è°ƒç”¨ indexDao() æ—¶ï¼Œé¦–å…ˆä¼šåˆ¤æ–­æ˜¯ä¸æ˜¯ç¬¬ä¸€æ¬¡ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ new IndexDaoImplï¼›å¦‚æœä¸æ˜¯ï¼Œä» BeanFactory ä¸­å¾—åˆ°è¿™ä¸ª Bean å¹¶è¿”å›ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Configuration
@ComponentScan(&amp;quot;com.ssm&amp;quot;)
public class AppConfig {
   @Bean
   public IndexDao indexDao2(){
      indexDao();
      return new IndexDaoImpl2();
   }
   @Bean
   public static IndexDao indexDao(){
      return new IndexDaoImpl();
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å³ä½¿æ·»åŠ äº† @Configurationï¼Œå¦‚æœ ä½¿ç”¨ static ä¿®é¥° indexDao()ï¼Œä¹Ÿä¼šåˆ›å»ºä¸¤é&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;indexDao...constructor
indexDao...constructor
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;private void loadBeanDefinitionsForConfigurationClass(
      ConfigurationClass configClass, TrackedConditionEvaluator trackedConditionEvaluator) {
   if (trackedConditionEvaluator.shouldSkip(configClass)) {
      String beanName = configClass.getBeanName();
      if (StringUtils.hasLength(beanName) &amp;amp;&amp;amp; this.registry.containsBeanDefinition(beanName)) {
         this.registry.removeBeanDefinition(beanName);
      }
      this.importRegistry.removeImportingClass(configClass.getMetadata().getClassName());
      return;
   }
   // å¦‚æœä¸€ä¸ªç±»æ˜¯è¢« import çš„ï¼Œä¼šè¢« Spring æ ‡æ³¨
   // åœ¨è¿™é‡Œå®Œæˆæ³¨å†Œ
   if (configClass.isImported()) {
      registerBeanDefinitionForImportedConfigurationClass(configClass);
   }
   // BeanMethodï¼šå¾—åˆ° AppConfig ä¸­çš„æ‰€æœ‰åŒ…ï¼Œ
   for (BeanMethod beanMethod : configClass.getBeanMethods()) {
      loadBeanDefinitionsForBeanMethod(beanMethod);
   }
   // xml
   loadBeanDefinitionsFromImportedResources(configClass.getImportedResources());
   // æ³¨å†Œ Registrar
   loadBeanDefinitionsFromRegistrars(configClass.getImportBeanDefinitionRegistrars());
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;private void loadBeanDefinitionsForBeanMethod(BeanMethod beanMethod) {
   ConfigurationClass configClass = beanMethod.getConfigurationClass();
   MethodMetadata metadata = beanMethod.getMetadata();
   String methodName = metadata.getMethodName();
   // Do we need to mark the bean as skipped by its condition?
   if (this.conditionEvaluator.shouldSkip(metadata, ConfigurationPhase.REGISTER_BEAN)) {
      configClass.skippedBeanMethods.add(methodName);
      return;
   }
   if (configClass.skippedBeanMethods.contains(methodName)) {
      return;
   }
   AnnotationAttributes bean = AnnotationConfigUtils.attributesFor(metadata, Bean.class);
   Assert.state(bean != null, &amp;quot;No @Bean annotation attributes&amp;quot;);
   // Consider name and any aliases
   List&amp;lt;String&amp;gt; names = new ArrayList&amp;lt;&amp;gt;(Arrays.asList(bean.getStringArray(&amp;quot;name&amp;quot;)));
   String beanName = (!names.isEmpty() ? names.remove(0) : methodName);
   // Register aliases even when overridden
   for (String alias : names) {
      this.registry.registerAlias(beanName, alias);
   }
   // Has this effectively been overridden before (e.g. via XML)?
   if (isOverriddenByExistingDefinition(beanMethod, beanName)) {
      if (beanName.equals(beanMethod.getConfigurationClass().getBeanName())) {
         throw new BeanDefinitionStoreException(beanMethod.getConfigurationClass().getResource().getDescription(),
               beanName, &amp;quot;Bean name derived from @Bean method &#39;&amp;quot; + beanMethod.getMetadata().getMethodName() +
               &amp;quot;&#39; clashes with bean name for containing configuration class; please make those names unique!&amp;quot;);
      }
      return;
   }
   ConfigurationClassBeanDefinition beanDef = new ConfigurationClassBeanDefinition(configClass, metadata);
   beanDef.setSource(this.sourceExtractor.extractSource(metadata, configClass.getResource()));
   if (metadata.isStatic()) {
      // static @Bean method
      beanDef.setBeanClassName(configClass.getMetadata().getClassName());
      beanDef.setFactoryMethodName(methodName);
   }
   else {
      // instance @Bean method
      beanDef.setFactoryBeanName(configClass.getBeanName());
      beanDef.setUniqueFactoryMethodName(methodName);
   }
   beanDef.setAutowireMode(AbstractBeanDefinition.AUTOWIRE_CONSTRUCTOR);
   beanDef.setAttribute(RequiredAnnotationBeanPostProcessor.SKIP_REQUIRED_CHECK_ATTRIBUTE, Boolean.TRUE);
   AnnotationConfigUtils.processCommonDefinitionAnnotations(beanDef, metadata);
   Autowire autowire = bean.getEnum(&amp;quot;autowire&amp;quot;);
   if (autowire.isAutowire()) {
      beanDef.setAutowireMode(autowire.value());
   }
   String initMethodName = bean.getString(&amp;quot;initMethod&amp;quot;);
   if (StringUtils.hasText(initMethodName)) {
      beanDef.setInitMethodName(initMethodName);
   }
   String destroyMethodName = bean.getString(&amp;quot;destroyMethod&amp;quot;);
   beanDef.setDestroyMethodName(destroyMethodName);
   // Consider scoping
   ScopedProxyMode proxyMode = ScopedProxyMode.NO;
   AnnotationAttributes attributes = AnnotationConfigUtils.attributesFor(metadata, Scope.class);
   if (attributes != null) {
      beanDef.setScope(attributes.getString(&amp;quot;value&amp;quot;));
      proxyMode = attributes.getEnum(&amp;quot;proxyMode&amp;quot;);
      if (proxyMode == ScopedProxyMode.DEFAULT) {
         proxyMode = ScopedProxyMode.NO;
      }
   }
   // Replace the original bean definition with the target one, if necessary
   BeanDefinition beanDefToRegister = beanDef;
   if (proxyMode != ScopedProxyMode.NO) {
      BeanDefinitionHolder proxyDef = ScopedProxyCreator.createScopedProxy(
            new BeanDefinitionHolder(beanDef, beanName), this.registry,
            proxyMode == ScopedProxyMode.TARGET_CLASS);
      beanDefToRegister = new ConfigurationClassBeanDefinition(
            (RootBeanDefinition) proxyDef.getBeanDefinition(), configClass, metadata);
   }
   if (logger.isDebugEnabled()) {
      logger.debug(String.format(&amp;quot;Registering bean definition for @Bean method %s.%s()&amp;quot;,
            configClass.getMetadata().getClassName(), beanName));
   }
   this.registry.registerBeanDefinition(beanName, beanDefToRegister);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 40 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;if (metadata.isStatic()) {
   // static @Bean method
   // å¦‚æœæ˜¯é™æ€çš„ï¼ŒBeanDefinition ä¸­æ”¾çš„æ˜¯ Bean   beanDef.setBeanClassName(configClass.getMetadata().getClassName());
   beanDef.setFactoryMethodName(methodName);
}
else {
   // instance @Bean method
   // å¦‚æœä¸æ˜¯é™æ€çš„ï¼ŒBeanDefinition ä¸­æ”¾çš„æ˜¯ FactoryBean
   // FactoryBean æ˜¯æ€æ ·è¢«åˆ›å»ºå‡ºæ¥çš„ï¼Ÿ
   // FactoryBean æœ‰ä¸¤ä¸ªæ„ä¹‰ï¼šæœ¬èº«æ˜¯ä¸€ä¸ª Beanï¼Œ
   // å¦‚ä½• new å‡ºæ¥ä¸€ä¸ª FactoryBean ç»™å®ƒå‘¢ï¼Ÿ
   // é€šè¿‡ setUniqueFactoryMethodName
   beanDef.setFactoryBeanName(configClass.getBeanName());
   beanDef.setUniqueFactoryMethodName(methodName);
}
&lt;/code&gt;&lt;/pre&gt;
">Springç³»åˆ—ï¼ˆåï¼‰Springæºç è§£æ</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/spring-xi-lie-jiu-yuan-ma-jie-xi/"" data-c="
          &lt;h1 id=&#34;spring-bean-çš„ç”Ÿå‘½å‘¨æœŸ&#34;&gt;Spring Bean çš„ç”Ÿå‘½å‘¨æœŸ&lt;/h1&gt;
&lt;h2 id=&#34;1å¾—åˆ°ç”¨æˆ·è‡ªå®šä¹‰çš„-beandefinitionregistrypostprocessor&#34;&gt;1.å¾—åˆ°ç”¨æˆ·è‡ªå®šä¹‰çš„ BeanDefinitionRegistryPostProcessor&lt;/h2&gt;
&lt;p&gt;å…·ä½“æµç¨‹ï¼š&lt;/p&gt;
&lt;p&gt;context.&lt;em&gt;refresh&lt;/em&gt;(); ---&amp;gt; invokeBeanFactoryPostProcessors(beanFactory); ---&amp;gt; 		PostProcessorRegistrationDelegate.invokeBeanFactoryPostProcessors(beanFactory, getBeanFactoryPostProcessors()); ---&amp;gt; å…¶ä¸­ getBeanFactoryPostProcessors() æ–¹æ³•è¿”å›å€¼æ˜¯BeanFactoryPostProcessor ---&amp;gt; ConfigurationClassPostProcessor å®ç°äº† BeanDefinitionRegistryPostProcessorï¼Œè€Œ BeanDefinitionRegistryPostProcessor ç»§æ‰¿äº† BeanFactoryPostProcessorã€‚&lt;/p&gt;
&lt;h2 id=&#34;2å¾—åˆ°-spring-å†…ç½®çš„-beandefinitionregistrypostprocessor&#34;&gt;2.å¾—åˆ° Spring å†…ç½®çš„ BeanDefinitionRegistryPostProcessor&lt;/h2&gt;
&lt;p&gt;&lt;em&gt;ç›®å‰ Spring åªå†…ç½®äº†ä¸€ä¸ª &lt;em&gt;BeanDefinitionRegistryPostProcessorï¼Œä¹Ÿå°±æ˜¯&lt;/em&gt;ConfigurationClassPostProcessor&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;å…·ä½“æµç¨‹ï¼š&lt;/p&gt;
&lt;p&gt;context.&lt;em&gt;refresh&lt;/em&gt;(); ---&amp;gt; &lt;em&gt;invokeBeanFactoryPostProcessors&lt;/em&gt;(beanFactory); ---&amp;gt; PostProcessorRegistrationDelegate.invokeBeanFactoryPostProcessors(beanFactory, getBeanFactoryPostProcessors()); ---&amp;gt; List&lt;BeanDefinitionRegistryPostProcessor&gt; currentRegistryProcessors = new ArrayList&amp;lt;&amp;gt;(); è¿™ä¸ª currentRegistryProcessors ä¸­æ”¾çš„å°±æ˜¯ Spring å†…éƒ¨è‡ªå·±å®ç°äº† BeanDefinitionRegistryPostProcessor æ¥å£çš„å¯¹è±¡&lt;/p&gt;
&lt;h2 id=&#34;3å¤„ç†-beandefinitionregistrypostprocessor&#34;&gt;3.å¤„ç† BeanDefinitionRegistryPostProcessor&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;private static void invokeBeanDefinitionRegistryPostProcessors(
      Collection&amp;lt;? extends BeanDefinitionRegistryPostProcessor&amp;gt; postProcessors, BeanDefinitionRegistry registry) {
   // éå†æ‰€æœ‰ &amp;quot;ç”¨æˆ·è‡ªå®šä¹‰+Spirngå†…ç½®&amp;quot; çš„ BeanDefinitionRegistryPostProcessorÂ 
   for (BeanDefinitionRegistryPostProcessor postProcessor : postProcessors) {
      // è°ƒç”¨ postProcessBeanDefinitionRegistry æ–¹æ³•å¤„ç†æ¯ä¸€ä¸ª postProcessor
      postProcessor.postProcessBeanDefinitionRegistry(registry);
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å…·ä½“æµç¨‹ï¼š&lt;br&gt;
context.&lt;em&gt;refresh&lt;/em&gt;(); ---&amp;gt; &lt;em&gt;invokeBeanFactoryPostProcessors&lt;/em&gt;(beanFactory); ---&amp;gt; PostProcessorRegistrationDelegate.invokeBeanFactoryPostProcessors(beanFactory, getBeanFactoryPostProcessors()); ---&amp;gt;invokeBeanDefinitionRegistryPostProcessors(currentRegistryProcessors, registry); ---&amp;gt; postProcessor.&lt;em&gt;postProcessBeanDefinitionRegistry&lt;/em&gt;(registry); ---&amp;gt; &lt;em&gt;processConfigBeanDefinitions&lt;/em&gt;(registry);å¤„ç†@Configuration ---&amp;gt; parser.parse(candidates); è§£ææ³¨è§£å¯¹è±¡---&amp;gt; parse(((AnnotatedBeanDefinition) bd).getMetadata(), holder.getBeanName()); ---&amp;gt; processConfigurationClass(new ConfigurationClass(metadata, beanName)); å¤„ç†Import---&amp;gt; sourceClass = doProcessConfigurationClass(configClass, sourceClass); ---&amp;gt; this.componentScanParser.parse(componentScan, sourceClass.getMetadata().getClassName()); ---&amp;gt; scanner.doScan(StringUtils.toStringArray(basePackages));æ‰«æåŒ…&lt;/p&gt;
&lt;h1 id=&#34;spring-æºç è§£æ&#34;&gt;Spring æºç è§£æ&lt;/h1&gt;
&lt;h2 id=&#34;é…ç½®ç±»åªæ‰«æåŒ…æ²¡æœ‰æ·»åŠ -configurationæ³¨è§£&#34;&gt;é…ç½®ç±»åªæ‰«æåŒ…ï¼Œæ²¡æœ‰æ·»åŠ  @Configurationæ³¨è§£&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@ComponentScan(&amp;quot;com.ssm&amp;quot;)
public class AppConfig {
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Repository(&amp;quot;indexDao&amp;quot;)
public class IndexDaoImpl implements IndexDao{
   @Override
   public void query() {
      System.out.println(&amp;quot;dao...æ¨¡æ‹ŸæŸ¥è¯¢æ•°æ®åº“&amp;quot;);
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
   public static void main(String[] args) {
      // æŠŠ Spring æ‰€æœ‰å‰æç¯å¢ƒå‡†å¤‡å¥½
      // 1.å‡†å¤‡å·¥å‚=DefaultListableBeanFactory
      // å®ä¾‹åŒ–ä¸€ä¸ª bdReader å’Œä¸€ä¸ª scanner
      AnnotationConfigApplicationContext context =
            new AnnotationConfigApplicationContext();
      // æŠŠä¸€ä¸ª class è½¬æˆ bdï¼Œæœ€å put åˆ° map
      // map ä½ç½® DefaultListableBeanFactory çš„ beanDefinitionMap
      context.register(AppConfig.class);
//    context.addBeanFactoryPostProcessor(new MyBeanFactoryProcessor());
      // åˆå§‹åŒ– Spring çš„ç¯å¢ƒ
      context.refresh();
      IndexDao indexDao = context.getBean(IndexDaoImpl.class);
      indexDao.query();
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;dao...æ¨¡æ‹ŸæŸ¥è¯¢æ•°æ®åº“
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ€»ç»“ï¼šå³ä½¿æ²¡æœ‰æ·»åŠ  @Configuration æ³¨è§£ï¼Œä¹Ÿèƒ½æ­£ç¡®å®Œæˆå¯¹ AppConfig ç±»çš„æ‰«æï¼šæ‰«æåŒ… com.ssmã€‚é‚£ä¹ˆ @Configuration åˆ°åº•æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ&lt;/p&gt;
&lt;h1 id=&#34;1processconfigbeandefinitions&#34;&gt;1.processConfigBeanDefinitions&lt;/h1&gt;
&lt;p&gt;context.&lt;em&gt;refresh&lt;/em&gt;(); ---&amp;gt; invokeBeanFactoryPostProcessors(beanFactory); ---&amp;gt; 		PostProcessorRegistrationDelegate.invokeBeanFactoryPostProcessors(beanFactory, getBeanFactoryPostProcessors()); ---&amp;gt; invokeBeanDefinitionRegistryPostProcessors(currentRegistryProcessors, registry); ---&amp;gt; postProcessor.postProcessBeanDefinitionRegistry(registry); ---&amp;gt; processConfigBeanDefinitions(registry);&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public void processConfigBeanDefinitions(BeanDefinitionRegistry registry) {
   //å®šä¹‰ä¸€ä¸ª list å­˜æ”¾ app æä¾›çš„ bdï¼šé¡¹ç›®å½“ä¸­æä¾›äº† @Component
   List&amp;lt;BeanDefinitionHolder&amp;gt; configCandidates = new ArrayList&amp;lt;&amp;gt;();
   // è·å–å®¹å™¨ä¸­æ³¨å†Œçš„æ‰€æœ‰ bd åå­—
   // 7 ä¸ª
   String[] candidateNames = registry.getBeanDefinitionNames();
   // ä¾æ¬¡å–å‡ºæ¯ä¸ª&amp;lt;beanName,beanDefinition&amp;gt;
   /**
    * full
    * lite
    */
   for (String beanName : candidateNames) {
      BeanDefinition beanDef = registry.getBeanDefinition(beanName);
      // åˆ¤æ–­å½“å‰ bean æ˜¯å¦è¢«å¤„ç†è¿‡ï¼šä½¿ç”¨ isFullConfigurationClass æ¥æ ‡è¯†
      if (ConfigurationClassUtils.isFullConfigurationClass(beanDef) ||
            ConfigurationClassUtils.isLiteConfigurationClass(beanDef)) {
         // å¦‚æœ BeanDefinition ä¸­çš„ configurationClass å±æ€§ä¸º full æˆ–è€… liteï¼Œåˆ™æ„å‘³ç€å·²ç»å¤„ç†è¿‡äº†ï¼Œç›´æ¥è·³è¿‡
         // è¿™é‡Œéœ€è¦ç»“åˆä¸‹é¢çš„ä»£ç æ‰èƒ½ç†è§£
         if (logger.isDebugEnabled()) {
            logger.debug(&amp;quot;Bean definition has already been processed as a configuration class: &amp;quot; + beanDef);
         }
      }
      // åˆ¤æ–­è¿™ä¸ª BeanDefinition æ˜¯å¦æ˜¯ Configurationç±»ï¼Œå¦‚æœåŠ äº† Configuration ä¸‹é¢çš„è¿™å‡ ä¸ªæ³¨è§£å°±ä¸å†åˆ¤æ–­äº†
      // è¿˜æœ‰  add(Component.class.getName())
      //         candidateIndicators.add(ComponentScan.class.getName())
      //         candidateIndicators.add(Import.class.getName())
      //         candidateIndicators.add(ImportResource.class.getName())
      else if (ConfigurationClassUtils.checkConfigurationClassCandidate(beanDef, this.metadataReaderFactory)) {
         configCandidates.add(new BeanDefinitionHolder(beanDef, beanName));
      }
   }
   // Return immediately if no @Configuration classes were found
   if (configCandidates.isEmpty()) {
      return;
   }
   // æ’åºï¼Œæ ¹æ® orderï¼Œä¸é‡è¦
   // Sort by previously determined @Order value, if applicable
   configCandidates.sort((bd1, bd2) -&amp;gt; {
      int i1 = ConfigurationClassUtils.getOrder(bd1.getBeanDefinition());
      int i2 = ConfigurationClassUtils.getOrder(bd2.getBeanDefinition());
      return Integer.compare(i1, i2);
   });
   // Detect any custom bean name generation strategy supplied through the enclosing application context
   SingletonBeanRegistry sbr = null;
   // å¦‚æœ BeanDefinitionRegistry æ˜¯ SingletonBeanRegistry å­ç±»çš„è¯
   // ç”±äºä¼šå°† registry å¼ºè½¬ä¸º SingletonBeanRegistry
   if (registry instanceof SingletonBeanRegistry) {
      sbr = (SingletonBeanRegistry) registry;
      if (!this.localBeanNameGeneratorSet) {//æ˜¯å¦æœ‰è‡ªå®šä¹‰çš„
         BeanNameGenerator generator = (BeanNameGenerator) sbr.getSingleton(CONFIGURATION_BEAN_NAME_GENERATOR);
         // SingletonBeanRegistry ä¸­æœ‰ id ä¸º org.springframework.context.annotation.internalConfigurationBeanNameGenerator
         // å¦‚æœæœ‰åˆ™åˆ©ç”¨å®ƒçš„ï¼Œå¦åˆ™åˆ™ä½¿ç”¨ Spring é»˜è®¤çš„
         if (generator != null) {
            this.componentScanBeanNameGenerator = generator;
            this.importBeanNameGenerator = generator;
         }
      }
   }
   if (this.environment == null) {
      this.environment = new StandardEnvironment();
   }
   // Parse each @Configuration class
   // å®ä¾‹åŒ– ConfigurationClassParser ä¸ºäº†è§£æå„ä¸ªé…ç½®ç±»
   ConfigurationClassParser parser = new ConfigurationClassParser(
         this.metadataReaderFactory, this.problemReporter, this.environment,
         this.resourceLoader, this.componentScanBeanNameGenerator, registry);
   // å®ä¾‹åŒ– 2 ä¸ª setï¼Œcandidates ç”¨äºå°†ä¹‹å‰åŠ å…¥çš„ configCandidates è¿›è¡Œå»é‡
   // å› ä¸ºå¯èƒ½æœ‰å¤šä¸ªé…ç½®ç±»é‡å¤äº†
   // alreadyParsed ç”¨æˆ·åˆ¤æ–­æ˜¯å¦å¤„ç†è¿‡
   Set&amp;lt;BeanDefinitionHolder&amp;gt; candidates = new LinkedHashSet&amp;lt;&amp;gt;(configCandidates);
   Set&amp;lt;ConfigurationClass&amp;gt; alreadyParsed = new HashSet&amp;lt;&amp;gt;(configCandidates.size());
   do {
      parser.parse(candidates);
      parser.validate();
      Set&amp;lt;ConfigurationClass&amp;gt; configClasses = new LinkedHashSet&amp;lt;&amp;gt;(parser.getConfigurationClasses());
      configClasses.removeAll(alreadyParsed);
      // Read the model and create bean definitions based on its content
      if (this.reader == null) {
         this.reader = new ConfigurationClassBeanDefinitionReader(
               registry, this.sourceExtractor, this.resourceLoader, this.environment,
               this.importBeanNameGenerator, parser.getImportRegistry());
      }
      // æŠŠæ‰«æå‡ºæ¥çš„ bean å¯¹åº”çš„ beanDefinitions æ·»åŠ åˆ° factory çš„ map å½“ä¸­
      this.reader.loadBeanDefinitions(configClasses);
      alreadyParsed.addAll(configClasses);
      candidates.clear();
      if (registry.getBeanDefinitionCount() &amp;gt; candidateNames.length) {
         String[] newCandidateNames = registry.getBeanDefinitionNames();
         Set&amp;lt;String&amp;gt; oldCandidateNames = new HashSet&amp;lt;&amp;gt;(Arrays.asList(candidateNames));
         Set&amp;lt;String&amp;gt; alreadyParsedClasses = new HashSet&amp;lt;&amp;gt;();
         for (ConfigurationClass configurationClass : alreadyParsed) {
            alreadyParsedClasses.add(configurationClass.getMetadata().getClassName());
         }
         for (String candidateName : newCandidateNames) {
            if (!oldCandidateNames.contains(candidateName)) {
               BeanDefinition bd = registry.getBeanDefinition(candidateName);
               if (ConfigurationClassUtils.checkConfigurationClassCandidate(bd, this.metadataReaderFactory) &amp;amp;&amp;amp;
                     !alreadyParsedClasses.contains(bd.getBeanClassName())) {
                  candidates.add(new BeanDefinitionHolder(bd, candidateName));
               }
            }
         }
         candidateNames = newCandidateNames;
      }
   }
   while (!candidates.isEmpty());
   // Register the ImportRegistry as a bean in order to support ImportAware @Configuration classes
   if (sbr != null &amp;amp;&amp;amp; !sbr.containsSingleton(IMPORT_REGISTRY_BEAN_NAME)) {
      sbr.registerSingleton(IMPORT_REGISTRY_BEAN_NAME, parser.getImportRegistry());
   }
   if (this.metadataReaderFactory instanceof CachingMetadataReaderFactory) {
      // Clear cache in externally provided MetadataReaderFactory; this is a no-op
      // for a shared cache since it&#39;ll be cleared by the ApplicationContext.
      ((CachingMetadataReaderFactory) this.metadataReaderFactory).clearCache();
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 28 è¡Œåˆ¤æ–­è¿™ä¸ª bd æ˜¯å¦åŠ äº† @Configuration æ³¨è§£&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// åˆ¤æ–­è¿™ä¸ª BeanDefinition æ˜¯å¦æ˜¯ Configurationç±»ï¼Œå¦‚æœåŠ äº† Configuration ä¸‹é¢çš„è¿™å‡ ä¸ªæ³¨è§£å°±ä¸å†åˆ¤æ–­äº†
// è¿˜æœ‰  add(Component.class.getName())
//         candidateIndicators.add(ComponentScan.class.getName())
//         candidateIndicators.add(Import.class.getName())
//         candidateIndicators.add(ImportResource.class.getName())
else if (ConfigurationClassUtils.checkConfigurationClassCandidate(beanDef, this.metadataReaderFactory)) {
   configCandidates.add(new BeanDefinitionHolder(beanDef, beanName));
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ‘ä»¬ç‚¹è¿› ConfigurationClassUtils.checkConfigurationClassCandidate(beanDef, this.metadataReaderFactory) è¿™ä¸ªæ–¹æ³•&lt;/p&gt;
&lt;h2 id=&#34;11-checkconfigurationclasscandidate&#34;&gt;1.1 checkConfigurationClassCandidate&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;    public static boolean checkConfigurationClassCandidate(BeanDefinition beanDef, MetadataReaderFactory metadataReaderFactory) {
      String className = beanDef.getBeanClassName();
      if (className == null || beanDef.getFactoryMethodName() != null) {
         return false;
      }
      AnnotationMetadata metadata;
      if (beanDef instanceof AnnotatedBeanDefinition &amp;amp;&amp;amp;
            className.equals(((AnnotatedBeanDefinition) beanDef).getMetadata().getClassName())) {
         // Can reuse the pre-parsed metadata from the given BeanDefinition...
         // å¦‚æœ BeanDefinition æ˜¯ AnnotatedBeanDefinition çš„å®ä¾‹ï¼Œå¹¶ä¸” className å’Œ BeanDefinition ä¸­çš„å…ƒæ•°æ®çš„ç±»åç›¸åŒ
         // åˆ™ç›´æ¥ä» BeanDefinition è·å¾—å…ƒæ•°æ®Metadata
         metadata = ((AnnotatedBeanDefinition) beanDef).getMetadata();
      }
      else if (beanDef instanceof AbstractBeanDefinition &amp;amp;&amp;amp; ((AbstractBeanDefinition) beanDef).hasBeanClass()) {
         // Check already loaded Class if present...
         // since we possibly can&#39;t even load the class file for this Class.
         // å¦‚æœ BeanDefinition æ˜¯ AbstractBeanDefinition çš„å®ä¾‹ï¼Œå¹¶ä¸” beanDef æœ‰ beanClass å±æ€§å­˜åœ¨
         // åˆ™å®ä¾‹åŒ– StandardAnnotationMetadata
         Class&amp;lt;?&amp;gt; beanClass = ((AbstractBeanDefinition) beanDef).getBeanClass();
         metadata = new StandardAnnotationMetadata(beanClass, true);
      }
      else {
         try {
            MetadataReader metadataReader = metadataReaderFactory.getMetadataReader(className);
            metadata = metadataReader.getAnnotationMetadata();
         }
         catch (IOException ex) {
            if (logger.isDebugEnabled()) {
               logger.debug(&amp;quot;Could not find class file for introspecting configuration annotations: &amp;quot; + className, ex);
            }
            return false;
         }
      }
      // åˆ¤æ–­å½“å‰è¿™ä¸ª bd ä¸­å­˜åœ¨çš„ç±»æ˜¯ä¸æ˜¯åŠ äº† @Configuration æ³¨è§£ï¼Œä½†æ˜¯å¦‚æœåŠ äº† @Configurationï¼Œä¸‹é¢çš„è¿™å‡ ä¸ªæ³¨è§£å°±ä¸å†åˆ¤æ–­ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ª if-else if åˆ†æ”¯
      // åªæœ‰æ»¡è¶³äº† &amp;quot;æ²¡æœ‰åŠ  @Configurationæ³¨è§£&amp;quot;ï¼Œæ‰ä¼šèµ° else åˆ†æ”¯å»åˆ¤æ–­æ˜¯å¦æ·»åŠ äº†å…¶ä»–æ³¨è§£
      // å¦‚æœå­˜åœ¨åˆ™ Spring è®¤ä¸ºå®ƒæ˜¯ä¸€ä¸ªå…¨æ³¨è§£ FULL çš„ç±»
      if (isFullConfigurationCandidate(metadata)) {
         // å¦‚æœå­˜åœ¨ Configuration æ³¨è§£ï¼Œåˆ™ä¸º BeanDefinition è®¾ç½® configurationClass å±æ€§ä¸º FULL
         beanDef.setAttribute(CONFIGURATION_CLASS_ATTRIBUTE, CONFIGURATION_CLASS_FULL);
      }
      // åˆ¤æ–­æ˜¯å¦åŠ äº†ä»¥ä¸‹æ³¨è§£ï¼Œæ‘˜å½• isLiteConfigurationCandidate çš„æºç 
//    candidateIndicators.add(Component.class.getName());
//    candidateIndicators.add(ComponentScan.class.getName());
//    candidateIndicators.add(Import.class.getName());
//    candidateIndicators.add(ImportResource.class.getName());
//    å¦‚æœä¸å­˜åœ¨ @Configuration æ³¨è§£ï¼ŒSpring åˆ™è®¤ä¸ºæ˜¯ä¸€ä¸ªéƒ¨åˆ†æ³¨è§£ LITE ç±»
      else if (isLiteConfigurationCandidate(metadata)) {
         beanDef.setAttribute(CONFIGURATION_CLASS_ATTRIBUTE, CONFIGURATION_CLASS_LITE);
      }
      else {
         return false;
      }
      // It&#39;s a full or lite configuration candidate... Let&#39;s determine the order value, if any.
      Integer order = getOrder(metadata);
      if ( order != null) {
         beanDef.setAttribute(ORDER_ATTRIBUTE, order);
      }
      return true;
   }
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;111-isfullconfigurationcandidate&#34;&gt;1.1.1 isFullConfigurationCandidate&lt;/h3&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 39 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public static boolean isFullConfigurationCandidate(AnnotationMetadata metadata) {
   return metadata.isAnnotated(Configuration.class.getName());
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;112-isliteconfigurationcandidate&#34;&gt;1.1.2 isLiteConfigurationCandidate&lt;/h3&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 49 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public static boolean isLiteConfigurationCandidate(AnnotationMetadata metadata) {
   // Do not consider an interface or an annotation...
   if (metadata.isInterface()) {
      return false;
   }
   // Any of the typical annotations found?
   for (String indicator : candidateIndicators) {
      if (metadata.isAnnotated(indicator)) {
         return true;
      }
   }
   // Finally, let&#39;s look for @Bean methods...
   try {
      return metadata.hasAnnotatedMethods(Bean.class.getName());
   }
   catch (Throwable ex) {
      if (logger.isDebugEnabled()) {
         logger.debug(&amp;quot;Failed to introspect @Bean methods on class [&amp;quot; + metadata.getClassName() + &amp;quot;]: &amp;quot; + ex);
      }
      return false;
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ç¬¬ 8 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;private static final Set&amp;lt;String&amp;gt; candidateIndicators = new HashSet&amp;lt;&amp;gt;(8);
static {
   candidateIndicators.add(Component.class.getName());
   candidateIndicators.add(ComponentScan.class.getName());
   candidateIndicators.add(Import.class.getName());
   candidateIndicators.add(ImportResource.class.getName());
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿° checkConfigurationClassCandidate æ–¹æ³•çš„ç¬¬ 39-51 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;      // åˆ¤æ–­å½“å‰è¿™ä¸ª bd ä¸­å­˜åœ¨çš„ç±»æ˜¯ä¸æ˜¯åŠ äº† @Configuration æ³¨è§£ï¼Œä½†æ˜¯å¦‚æœåŠ äº† @Configurationï¼Œä¸‹é¢çš„è¿™å‡ ä¸ªæ³¨è§£å°±ä¸å†åˆ¤æ–­ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ª if-else if åˆ†æ”¯
      // åªæœ‰æ»¡è¶³äº† &amp;quot;æ²¡æœ‰åŠ  @Configurationæ³¨è§£&amp;quot;ï¼Œæ‰ä¼šèµ° else åˆ†æ”¯å»åˆ¤æ–­æ˜¯å¦æ·»åŠ äº†å…¶ä»–æ³¨è§£
      if (isFullConfigurationCandidate(metadata)) {
         // å¦‚æœå­˜åœ¨ Configuration æ³¨è§£ï¼Œåˆ™ä¸º BeanDefinition è®¾ç½® configurationClass å±æ€§ä¸º FULL
         beanDef.setAttribute(CONFIGURATION_CLASS_ATTRIBUTE, CONFIGURATION_CLASS_FULL);
      }
      // åˆ¤æ–­æ˜¯å¦åŠ äº†ä»¥ä¸‹æ³¨è§£ï¼Œæ‘˜å½• isLiteConfigurationCandidate çš„æºç 
/nss/    candidateIndicators.add(Component.class.getName());
//    candidateIndicators.add(ComponentScan.class.getName());
//    candidateIndicators.add(Import.class.getName());
//    candidateIndicators.add(ImportResource.class.getName());
      else if (isLiteConfigurationCandidate(metadata)) {
         beanDef.setAttribute(CONFIGURATION_CLASS_ATTRIBUTE, CONFIGURATION_CLASS_LITE);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœä¸€ä¸ªç±»åŠ äº† @Configuration æ³¨è§£ï¼ŒBeanDefinition ä¸­çš„ attribute =  CONFIGURATION_CLASS_FULLï¼›å¦åˆ™ï¼ŒBeanDefinition ä¸­çš„ attribute =   CONFIGURATION_CLASS_LITE&lt;/p&gt;
&lt;h3 id=&#34;113-parse&#34;&gt;1.1.3 parse&lt;/h3&gt;
&lt;p&gt;ä¸Šè¿° checkConfigurationClassCandidate æ–¹æ³•çš„ç¬¬ 79 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt; parser.parse(candidates);
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/parse%E5%8F%AA%E6%9C%89%E4%B8%80%E4%B8%AAappConfig%E9%9C%80%E8%A6%81%E6%9B%B4%E6%96%B0.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public void parse(Set&amp;lt;BeanDefinitionHolder&amp;gt; configCandidates) {
   // deferredï¼šå»¶è¿Ÿçš„
   this.deferredImportSelectors = new LinkedList&amp;lt;&amp;gt;();
   // æ ¹æ® BeanDefinition çš„ç±»å‹åšä¸åŒçš„å¤„ç†ï¼Œä¸€èˆ¬éƒ½ä¼šè°ƒç”¨ ConfigurationClassParse#parse è¿›è¡Œè§£æ
   for (BeanDefinitionHolder holder : configCandidates) {
      BeanDefinition bd = holder.getBeanDefinition();
      try {
         // åˆ¤æ–­è¿™ä¸ª bd æ˜¯å¦è¢«åŠ äº†æ³¨è§£
         if (bd instanceof AnnotatedBeanDefinition) {
            // è§£ææ³¨è§£å¯¹è±¡ï¼Œå¹¶ä¸”æŠŠè§£æå‡ºæ¥çš„ bd æ”¾åˆ° mapï¼Œä½†æ˜¯è¿™é‡Œçš„ bd æŒ‡çš„æ˜¯æ™®é€šçš„
            // ä½•ä¸ºä¸æ™®é€šçš„å‘¢ï¼Ÿæ¯”å¦‚ @Bean å’Œ beanFactoryPostProcessor å¾—åˆ°çš„ bean ä¸åœ¨
            // ä½†æ˜¯æ˜¯è¿™é‡Œè§£æï¼Œåªæ˜¯ä¸ put è€Œå·²
            parse(((AnnotatedBeanDefinition) bd).getMetadata(), holder.getBeanName());
         }
         else if (bd instanceof AbstractBeanDefinition &amp;amp;&amp;amp; ((AbstractBeanDefinition) bd).hasBeanClass()) {
            parse(((AbstractBeanDefinition) bd).getBeanClass(), holder.getBeanName());
         }
         else {
            parse(bd.getBeanClassName(), holder.getBeanName());
         }
      }
      catch (BeanDefinitionStoreException ex) {
         throw ex;
      }
      catch (Throwable ex) {
         throw new BeanDefinitionStoreException(
               &amp;quot;Failed to parse configuration class [&amp;quot; + bd.getBeanClassName() + &amp;quot;]&amp;quot;, ex);
      }
   }
   processDeferredImportSelectors();
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 13 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;protected final void parse(AnnotationMetadata metadata, String beanName) throws IOException {
   processConfigurationClass(new ConfigurationClass(metadata, beanName));
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 2 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;protected void processConfigurationClass(ConfigurationClass configClass) throws IOException {
   // åˆ¤æ–­æ˜¯å¦åº”è¯¥è·³è¿‡è§£æ
   if (this.conditionEvaluator.shouldSkip(configClass.getMetadata(), ConfigurationPhase.PARSE_CONFIGURATION)) {
      return;
   }
   // å¤„ç† Imported çš„æƒ…å†µ
   // å°±æ˜¯å½“å‰è¿™ä¸ªç±»æœ‰æ²¡æœ‰è¢«åˆ«çš„ç±» @Import
   ConfigurationClass existingClass = this.configurationClasses.get(configClass);
   if (existingClass != null) {
      if (configClass.isImported()) {
         if (existingClass.isImported()) {
            existingClass.mergeImportedBy(configClass);
         }
         // Otherwise ignore new imported config class; existing non-imported class overrides it.
         return;
      }
      else {
         // Explicit bean definition found, probably replacing an import.
         // Let&#39;s remove the old one and go with the new one.
         this.configurationClasses.remove(configClass);
         this.knownSuperclasses.values().removeIf(configClass::equals);
      }
   }
   // Recursively process the configuration class and its superclass hierarchy.
   // å°† AppConfig è¿™ä¸ªç±»è½¬åŒ–æˆ SourceClassÂ 
   SourceClass sourceClass = asSourceClass(configClass);
   do {
      sourceClass = doProcessConfigurationClass(configClass, sourceClass);
   }
   while (sourceClass != null);
   // ä¸€ä¸ª mapï¼Œç”¨æ¥å­˜æ”¾æ‰«æå‡ºæ¥çš„ beanï¼ˆæ³¨æ„è¿™é‡Œçš„ bean ä¸æ˜¯å¯¹è±¡ï¼Œä»…ä»…æ˜¯ bean çš„ä¿¡æ¯ï¼Œå› ä¸ºè¿˜æ²¡åˆ°å®ä¾‹åŒ–ï¼‰
   this.configurationClasses.put(configClass, configClass);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;1131-doprocessconfigurationclass&#34;&gt;1.1.3.1  doProcessConfigurationClass&lt;/h4&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 30 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;protected final SourceClass doProcessConfigurationClass(ConfigurationClass configClass, SourceClass sourceClass)
      throws IOException {
   // Recursively process any member (nested) classes first
   // å¤„ç†å†…éƒ¨ç±»
   processMemberClasses(configClass, sourceClass);
   // å¤„ç† @PropertySource æ³¨è§£
   for (AnnotationAttributes propertySource : AnnotationConfigUtils.attributesForRepeatable(
         sourceClass.getMetadata(), PropertySources.class,
         org.springframework.context.annotation.PropertySource.class)) {
      if (this.environment instanceof ConfigurableEnvironment) {
         processPropertySource(propertySource);
      }
      else {
         logger.warn(&amp;quot;Ignoring @PropertySource annotation on [&amp;quot; + sourceClass.getMetadata().getClassName() +
               &amp;quot;]. Reason: Environment must implement ConfigurableEnvironment&amp;quot;);
      }
   }
   // å¤„ç† @ComponentScan æ³¨è§£
   Set&amp;lt;AnnotationAttributes&amp;gt; componentScans = AnnotationConfigUtils.attributesForRepeatable(
         sourceClass.getMetadata(), ComponentScans.class, ComponentScan.class);
   if (!componentScans.isEmpty() &amp;amp;&amp;amp;
         !this.conditionEvaluator.shouldSkip(sourceClass.getMetadata(), ConfigurationPhase.REGISTER_BEAN)) {
      for (AnnotationAttributes componentScan : componentScans) {
         // The config class is annotated with @ComponentScan -&amp;gt; perform the scan immediately
         // æ‰«ææ™®é€šç±» componentScan=com.ssm 
         // è¿™é‡Œæ‰«æå‡ºæ¥æ‰€æœ‰ @Component
         Set&amp;lt;BeanDefinitionHolder&amp;gt; scannedBeanDefinitions =
               this.componentScanParser.parse(componentScan, sourceClass.getMetadata().getClassName());
         // Check the set of scanned definitions for any further config classes and parse recursively if needed
         // æ£€æŸ¥æ‰«æå‡ºæ¥çš„ç±»å½“ä¸­æ˜¯å¦è¿˜æœ‰ Configuration
         for (BeanDefinitionHolder holder : scannedBeanDefinitions) {
            BeanDefinition bdCand = holder.getBeanDefinition().getOriginatingBeanDefinition();
            if (bdCand == null) {
               bdCand = holder.getBeanDefinition();
            }
            if (ConfigurationClassUtils.checkConfigurationClassCandidate(bdCand, this.metadataReaderFactory)) {
               parse(bdCand.getBeanClassName(), holder.getBeanName());
            }
         }
      }
   }
   // Process any @Import annotations
   // å¤„ç† @Import
   processImports(configClass, sourceClass, getImports(sourceClass), true);
   // Process any @ImportResource annotations
   AnnotationAttributes importResource =
         AnnotationConfigUtils.attributesFor(sourceClass.getMetadata(), ImportResource.class);
   if (importResource != null) {
      String[] resources = importResource.getStringArray(&amp;quot;locations&amp;quot;);
      Class&amp;lt;? extends BeanDefinitionReader&amp;gt; readerClass = importResource.getClass(&amp;quot;reader&amp;quot;);
      for (String resource : resources) {
         String resolvedResource = this.environment.resolveRequiredPlaceholders(resource);
         configClass.addImportedResource(resolvedResource, readerClass);
      }
   }
   // Process individual @Bean methods
   Set&amp;lt;MethodMetadata&amp;gt; beanMethods = retrieveBeanMethodMetadata(sourceClass);
   for (MethodMetadata methodMetadata : beanMethods) {
      configClass.addBeanMethod(new BeanMethod(methodMetadata, configClass));
   }
   // Process default methods on interfaces
   processInterfaces(configClass, sourceClass);
   // Process superclass, if any
   if (sourceClass.getMetadata().hasSuperClass()) {
      String superclass = sourceClass.getMetadata().getSuperClassName();
      if (superclass != null &amp;amp;&amp;amp; !superclass.startsWith(&amp;quot;java&amp;quot;) &amp;amp;&amp;amp;
            !this.knownSuperclasses.containsKey(superclass)) {
         this.knownSuperclasses.put(superclass, configClass);
         // Superclass found, return its annotation metadata and recurse
         return sourceClass.getSuperClass();
      }
   }
   // No superclass -&amp;gt; processing is complete
   return null;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 30 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public Set&amp;lt;BeanDefinitionHolder&amp;gt; parse(AnnotationAttributes componentScan, final String declaringClass) {
   ClassPathBeanDefinitionScanner scanner = new ClassPathBeanDefinitionScanner(this.registry,
         componentScan.getBoolean(&amp;quot;useDefaultFilters&amp;quot;), this.environment, this.resourceLoader);
   
   // BeanNameGeneratorï¼šBeanåå­—ç”Ÿæˆå™¨
   Class&amp;lt;? extends BeanNameGenerator&amp;gt; generatorClass = componentScan.getClass(&amp;quot;nameGenerator&amp;quot;);
   boolean useInheritedGenerator = (BeanNameGenerator.class == generatorClass);
   scanner.setBeanNameGenerator(useInheritedGenerator ? this.beanNameGenerator :
         BeanUtils.instantiateClass(generatorClass));
   ScopedProxyMode scopedProxyMode = componentScan.getEnum(&amp;quot;scopedProxy&amp;quot;);
   if (scopedProxyMode != ScopedProxyMode.DEFAULT) {
      scanner.setScopedProxyMode(scopedProxyMode);
   }
   else {
      Class&amp;lt;? extends ScopeMetadataResolver&amp;gt; resolverClass = componentScan.getClass(&amp;quot;scopeResolver&amp;quot;);
      scanner.setScopeMetadataResolver(BeanUtils.instantiateClass(resolverClass));
   }
   scanner.setResourcePattern(componentScan.getString(&amp;quot;resourcePattern&amp;quot;));
   for (AnnotationAttributes filter : componentScan.getAnnotationArray(&amp;quot;includeFilters&amp;quot;)) {
      for (TypeFilter typeFilter : typeFiltersFor(filter)) {
         scanner.addIncludeFilter(typeFilter);
      }
   }
   for (AnnotationAttributes filter : componentScan.getAnnotationArray(&amp;quot;excludeFilters&amp;quot;)) {
      for (TypeFilter typeFilter : typeFiltersFor(filter)) {
         scanner.addExcludeFilter(typeFilter);
      }
   }
  
    // æ‰«æå‡ºæ¥çš„è¿™ä¸ªç±»æ˜¯å¦éœ€è¦æ‡’åŠ è½½ï¼šé»˜è®¤ false
   // xml é…ç½®æ‡’åŠ è½½ï¼š&amp;lt;beans lazy=&amp;quot;true&amp;quot;&amp;gt;&amp;lt;bean&amp;gt;&amp;lt;/bean&amp;gt;&amp;lt;/beans&amp;gt;
   // JavaConfigé…ç½®æ‡’åŠ è½½ï¼š@Lazy   public class AppConfig{
   boolean lazyInit = componentScan.getBoolean(&amp;quot;lazyInit&amp;quot;);
   if (lazyInit) {
      scanner.getBeanDefinitionDefaults().setLazyInit(true);
   }
   Set&amp;lt;String&amp;gt; basePackages = new LinkedHashSet&amp;lt;&amp;gt;();
   String[] basePackagesArray = componentScan.getStringArray(&amp;quot;basePackages&amp;quot;);
   for (String pkg : basePackagesArray) {
      String[] tokenized = StringUtils.tokenizeToStringArray(this.environment.resolvePlaceholders(pkg),
            ConfigurableApplicationContext.CONFIG_LOCATION_DELIMITERS);
      Collections.addAll(basePackages, tokenized);
   }
   for (Class&amp;lt;?&amp;gt; clazz : componentScan.getClassArray(&amp;quot;basePackageClasses&amp;quot;)) {
      basePackages.add(ClassUtils.getPackageName(clazz));
   }
   if (basePackages.isEmpty()) {
      basePackages.add(ClassUtils.getPackageName(declaringClass));
   }
   scanner.addExcludeFilter(new AbstractTypeHierarchyTraversingFilter(false, false) {
      @Override
      protected boolean matchClassName(String className) {
         return declaringClass.equals(className);
      }
   });
   return scanner.doScan(StringUtils.toStringArray(basePackages));
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬  12 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;   ClassPathBeanDefinitionScanner scanner = new ClassPathBeanDefinitionScanner(this.registry,
         componentScan.getBoolean(&amp;quot;useDefaultFilters&amp;quot;), this.environment, this.resourceLoader);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™é‡Œ new äº†ä¸€ä¸ª ClassPathBeanDefinitionScanner çœŸæ­£å»æ‰«æåŒ…çš„ç±»ã€‚&lt;br&gt;
æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹æ„é€ æ–¹æ³•ä¸­çš„ scannerï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public AnnotationConfigApplicationContext() {
   /**
    * çˆ¶ç±»çš„æ„é€ æ–¹æ³• super()
    *åˆ›å»ºä¸€ä¸ªè¯»å–æ³¨è§£çš„ Bean å®šä¹‰è¯»å–å™¨ï¼šreader èƒ½è¯»å–è¢«åŠ äº†æ³¨è§£çš„ç±»
    * ä»€ä¹ˆæ˜¯ bean å®šä¹‰ï¼ŸBeanDefinition
    */
   this.reader = new AnnotatedBeanDefinitionReader(this);
   // å®šä¹‰æ‰«æå™¨
   // å¯ä»¥ç”¨æ¥æ‰«æåŒ…ï¼Œç»§è€Œè½¬æ¢æˆ bd
   // ä½†æ˜¯å®é™…ä¸Šæˆ‘ä»¬æ‰«æåŒ…å·¥ä½œä¸æ˜¯ scanner è¿™ä¸ªå¯¹è±¡
   // æ˜¯ Spring è‡ªå·± new çš„ä¸€ä¸ª ClasspathBeanDefinitionScanner
   // è¿™é‡Œçš„ scanner ä»…ä»…æ˜¯ä¸ºäº†ç¨‹åºå‘˜èƒ½å¤Ÿåœ¨å¤–éƒ¨è°ƒç”¨ AnnotationConfigApplicationContext å¯¹è±¡çš„ scan æ–¹æ³•ç”¨çš„ã€‚
   this.scanner = new ClassPathBeanDefinitionScanner(this);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™é‡Œçš„ scanner ä»…ä»…æ˜¯ä¸ºäº†ç¨‹åºå‘˜èƒ½å¤Ÿåœ¨å¤–éƒ¨è°ƒç”¨ AnnotationConfigApplicationContext å¯¹è±¡çš„ scan æ–¹æ³•ç”¨çš„ï¼Œè€Œä¸æ˜¯çœŸæ­£çš„æ‰«æåŒ…ã€‚&lt;br&gt;
ä¸Šè¿° parse æ–¹æ³•çš„ç¬¬ 36-39 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// æ‰«æå‡ºæ¥çš„è¿™ä¸ªç±»æ˜¯å¦éœ€è¦æ‡’åŠ è½½ï¼šé»˜è®¤ false
// xml é…ç½®æ‡’åŠ è½½ï¼š&amp;lt;beans lazy=&amp;quot;true&amp;quot;&amp;gt;&amp;lt;bean&amp;gt;&amp;lt;/bean&amp;gt;&amp;lt;/beans&amp;gt;
// JavaConfigé…ç½®æ‡’åŠ è½½ï¼š@Lazy   public class AppConfig{
boolean lazyInit = componentScan.getBoolean(&amp;quot;lazyInit&amp;quot;);   
if (lazyInit) {
  scanner.getBeanDefinitionDefaults().setLazyInit(true);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™é‡Œè®¾ç½®æ‡’åŠ è½½æ—¶ï¼Œå°† isLazyInit è®¾ç½®ä¸º trueï¼Œè€Œä¸æ˜¯å°† BeanDefinition å†…çš„ lazy è®¾ç½®ä¸º trueï¼Œå› ä¸ºè¿™ä¸ªæ—¶å€™è¿˜æ²¡æœ‰ BeanDefinitionã€‚&lt;br&gt;
ä¸Šè¿° parse æ–¹æ³•ç¬¬ 61 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;return scanner.doScan(StringUtils.toStringArray(basePackages));
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;doscan&#34;&gt;doScan&lt;/h4&gt;
&lt;p&gt;ç‚¹è¿›å» doScan æ–¹æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;protected Set&amp;lt;BeanDefinitionHolder&amp;gt; doScan(String... basePackages) {
   Assert.notEmpty(basePackages, &amp;quot;At least one base package must be specified&amp;quot;);
   Set&amp;lt;BeanDefinitionHolder&amp;gt; beanDefinitions = new LinkedHashSet&amp;lt;&amp;gt;();
   // å¾ªç¯æ‰€æœ‰ basePackagesï¼Œå› ä¸º@ComponentScan({&amp;quot;com.ssm.dao&amp;quot;},{&amp;quot;com.ssm.service&amp;quot;})å¯ä»¥å†™å¤šä¸ª
   for (String basePackage : basePackages) {
      // æ‰«è¡¨ basePackage è·¯å¾„ä¸‹çš„ java æ–‡ä»¶
      // å¹¶æŠŠå®ƒè½¬æˆ BeanDefinition ç±»å‹
      Set&amp;lt;BeanDefinition&amp;gt; candidates = findCandidateComponents(basePackage);
      for (BeanDefinition candidate : candidates) {
         // è§£æ scope å±æ€§
         ScopeMetadata scopeMetadata = this.scopeMetadataResolver.resolveScopeMetadata(candidate);
         candidate.setScope(scopeMetadata.getScopeName());
         String beanName = this.beanNameGenerator.generateBeanName(candidate, this.registry);
         if (candidate instanceof AbstractBeanDefinition) {
            // å¦‚æœè¿™ä¸ªç±»æ˜¯ AbstractBeanDefinition çš„å­ç±»
            // åˆ™ä¸ºå®ƒè®¾ç½®é»˜è®¤å€¼ï¼Œæ¯”å¦‚ lazyï¼Œinit destroy
            postProcessBeanDefinition((AbstractBeanDefinition) candidate, beanName);
         }
         if (candidate instanceof AnnotatedBeanDefinition) {
            // æ£€æŸ¥å¹¶ä¸”å¤„ç†å¸¸ç”¨çš„æ³¨è§£
            // è¿™é‡Œçš„å¤„ç†ä¸»è¦æ˜¯æŒ‡æŠŠå¸¸ç”¨æ³¨è§£çš„å€¼è®¾ç½®åˆ° AnnotatedBeanDefinition å½“ä¸­
            // å½“å‰å‰ææ˜¯è¿™ä¸ªç±»å¿…é¡»æ˜¯ AnnotatedBeanDefinition ç±»å‹çš„ï¼Œè¯´ç™½äº†å°±æ˜¯åŠ äº†æ³¨è§£çš„ç±»
            AnnotationConfigUtils.processCommonDefinitionAnnotations((AnnotatedBeanDefinition) candidate);
         }
         if (checkCandidate(beanName, candidate)) {
            BeanDefinitionHolder definitionHolder = new BeanDefinitionHolder(candidate, beanName);
            definitionHolder =
                  AnnotationConfigUtils.applyScopedProxyMode(scopeMetadata, definitionHolder, this.registry);
            beanDefinitions.add(definitionHolder);
            registerBeanDefinition(definitionHolder, this.registry);
         }
      }
   }
   return beanDefinitions;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ç¬¬ 8 è¡Œä»£ç ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public Set&amp;lt;BeanDefinition&amp;gt; findCandidateComponents(String basePackage) {
   if (this.componentsIndex != null &amp;amp;&amp;amp; indexSupportsIncludeFilters()) {
      return addCandidateComponentsFromIndex(this.componentsIndex, basePackage);
   }
   else {
      return scanCandidateComponents(basePackage);
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ç¬¬ 6 è¡Œï¼Œasm è¯»å– class æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;private Set&amp;lt;BeanDefinition&amp;gt; scanCandidateComponents(String basePackage) {
   Set&amp;lt;BeanDefinition&amp;gt; candidates = new LinkedHashSet&amp;lt;&amp;gt;();
   try {
      String packageSearchPath = ResourcePatternResolver.CLASSPATH_ALL_URL_PREFIX +
            resolveBasePackage(basePackage) + &#39;/&#39; + this.resourcePattern;
      // asm è¯»å– class æ–‡ä»¶
      Resource[] resources = getResourcePatternResolver().getResources(packageSearchPath);
      boolean traceEnabled = logger.isTraceEnabled();
      boolean debugEnabled = logger.isDebugEnabled();
      for (Resource resource : resources) {
         if (traceEnabled) {
            logger.trace(&amp;quot;Scanning &amp;quot; + resource);
         }
         if (resource.isReadable()) {
            try {
               MetadataReader metadataReader = getMetadataReaderFactory().getMetadataReader(resource);
               if (isCandidateComponent(metadataReader)) {
                  // é€šè¿‡ Spring æ‰«æå‡ºæ¥çš„ BeanDefinition å« ScannedGenericBeanDefinitionÂ 
                  ScannedGenericBeanDefinition sbd = new ScannedGenericBeanDefinition(metadataReader);
                  sbd.setSource(resource);
                  if (isCandidateComponent(sbd)) {
                     if (debugEnabled) {
                        logger.debug(&amp;quot;Identified candidate component class: &amp;quot; + resource);
                     }
                     candidates.add(sbd);
                  }
                  else {
                     if (debugEnabled) {
                        logger.debug(&amp;quot;Ignored because not a concrete top-level class: &amp;quot; + resource);
                     }
                  }
               }
               else {
                  if (traceEnabled) {
                     logger.trace(&amp;quot;Ignored because not matching any filter: &amp;quot; + resource);
                  }
               }
            }
            catch (Throwable ex) {
               throw new BeanDefinitionStoreException(
                     &amp;quot;Failed to read candidate component class: &amp;quot; + resource, ex);
            }
         }
         else {
            if (traceEnabled) {
               logger.trace(&amp;quot;Ignored because not readable: &amp;quot; + resource);
            }
         }
      }
   }
   catch (IOException ex) {
      throw new BeanDefinitionStoreException(&amp;quot;I/O failure during classpath scanning&amp;quot;, ex);
   }
   return candidates;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/asm%E6%89%AB%E6%8F%8F%E6%96%87%E4%BB%B6.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 17 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;protected boolean isCandidateComponent(MetadataReader metadataReader) throws IOException {
   // å½“å‰è¿™ä¸ªç±»æ˜¯å¦åœ¨ excludeFilters å½“ä¸­
   for (TypeFilter tf : this.excludeFilters) {
      if (tf.match(metadataReader, getMetadataReaderFactory())) {
         // å¦‚æœå½“å‰ç±»åœ¨æ’é™¤æ¡ä»¶ä¸­ï¼Œè¿”å› false
         return false;
      }
   }
   // å½“å‰è¿™ä¸ªç±»æ˜¯å¦åœ¨ includeFilterså½“ä¸­
   for (TypeFilter tf : this.includeFilters) {
      if (tf.match(metadataReader, getMetadataReaderFactory())) {
         return isConditionMatch(metadataReader);
      }
   }
   return false;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 19 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// é€šè¿‡ Spring æ‰«æå‡ºæ¥çš„ BeanDefinition å« ScannedGenericBeanDefinition 
ScannedGenericBeanDefinition sbd = new ScannedGenericBeanDefinition(metadataReader);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ¥çœ‹ä¸€ä¸‹è¿™ä¸ªç±» ScannedGenericBeanDefinitionï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class ScannedGenericBeanDefinition extends GenericBeanDefinition implements AnnotatedBeanDefinition {
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è€Œ GenericBeanDefinition ç±»ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class GenericBeanDefinition extends AbstractBeanDefinition {
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‰€ä»¥ï¼šæ‰€æœ‰æ‰«æå‡ºæ¥çš„ç±»éƒ½ instanceof AbstractBeanDefinitionÂ &lt;br&gt;
ä¸Šè¿°ä»£ç ç¬¬ 21 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;protected boolean isCandidateComponent(AnnotatedBeanDefinition beanDefinition) {
   AnnotationMetadata metadata = beanDefinition.getMetadata();
   return (metadata.isIndependent() &amp;amp;&amp;amp; (metadata.isConcrete() ||
         (metadata.isAbstract() &amp;amp;&amp;amp; metadata.hasAnnotatedMethods(Lookup.class.getName()))));
}
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/candidates.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;doScan æ–¹æ³•ç¬¬ 14-24 è¡Œ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// æ‰€æœ‰æ‰«æå‡ºæ¥çš„ç±»éƒ½ instanceof AbstractBeanDefinitionÂ 
if (candidate instanceof AbstractBeanDefinition) {
    // å¦‚æœè¿™ä¸ªç±»æ˜¯ AbstractBeanDefinition çš„å­ç±»
    // åˆ™ä¸ºå®ƒè®¾ç½®é»˜è®¤å€¼ï¼Œæ¯”å¦‚ lazyï¼Œinit destroy
    postProcessBeanDefinition((AbstractBeanDefinition) candidate, beanName);
}
// å¦‚æœè¿™ä¸ªç±»æ˜¯è¢«åŠ äº†æ³¨è§£çš„
if (candidate instanceof AnnotatedBeanDefinition) {
    // æ£€æŸ¥å¹¶ä¸”å¤„ç†å¸¸ç”¨çš„æ³¨è§£
    // è¿™é‡Œçš„å¤„ç†ä¸»è¦æ˜¯æŒ‡æŠŠå¸¸ç”¨æ³¨è§£çš„å€¼è®¾ç½®åˆ° AnnotatedBeanDefinition å½“ä¸­
    // å½“å‰å‰ææ˜¯è¿™ä¸ªç±»å¿…é¡»æ˜¯ AnnotatedBeanDefinition ç±»å‹çš„ï¼Œè¯´ç™½äº†å°±æ˜¯åŠ äº†æ³¨è§£çš„ç±»
          AnnotationConfigUtils.processCommonDefinitionAnnotations((AnnotatedBeanDefinition) candidate);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç”±äºä¸Šé¢çš„åˆ†æï¼Œä¸Šè¿°åˆ¤æ–­çš„ç¬¬ 1 è¡Œçš„ if åˆ†æ”¯æˆç«‹&lt;br&gt;
æŠŠä¸€ä¸ªç±»æ‰«æå‡ºæ¥åï¼Œéœ€è¦å¡«å…… BeanDefinitionï¼ŒpostProcessBeanDefinition å°±æ˜¯å¡«å……è¿™ä¸ª BeanDefinitionï¼Œä¸ºå®ƒè®¾ç½®é»˜è®¤å€¼ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;protected void postProcessBeanDefinition(AbstractBeanDefinition beanDefinition, String beanName) {
   beanDefinition.applyDefaults(this.beanDefinitionDefaults);
   if (this.autowireCandidatePatterns != null) {
      beanDefinition.setAutowireCandidate(PatternMatchUtils.simpleMatch(this.autowireCandidatePatterns, beanName));
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 2 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// ä¸º BeanDefinition è®¾ç½®é»˜è®¤å€¼
public void applyDefaults(BeanDefinitionDefaults defaults) {
   // é»˜è®¤è®¾ç½®æ‡’åŠ è½½
   setLazyInit(defaults.isLazyInit());
   setAutowireMode(defaults.getAutowireMode());
   setDependencyCheck(defaults.getDependencyCheck());
   setInitMethodName(defaults.getInitMethodName());
   setEnforceInitMethod(false);
   setDestroyMethodName(defaults.getDestroyMethodName());
   setEnforceDestroyMethod(false);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°åˆ¤æ–­æ‡’åŠ è½½æ—¶ï¼Œå°† isLazyInit è®¾ç½®ä¸º trueï¼Œè€Œä¸æ˜¯å°† BeanDefinition å†…çš„ lazy è®¾ç½®ä¸º trueï¼Œå› ä¸ºé‚£æ—¶å€™è¿˜æ²¡æœ‰ BeanDefinitionã€‚&lt;br&gt;
çœ‹ä¸€ä¸‹ç¬¬ 12 è¡Œçš„åˆ¤æ–­ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;AnnotationConfigUtils.processCommonDefinitionAnnotations((AnnotatedBeanDefinition) candidate);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç‚¹è¿›å»è¿™ä¸ª processCommonDefinitionAnnotations æ–¹æ³•&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public static void processCommonDefinitionAnnotations(AnnotatedBeanDefinition abd) {
   processCommonDefinitionAnnotations(abd, abd.getMetadata());
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç‚¹è¿›å»è¿™ä¸ª processCommonDefinitionAnnotations æ–¹æ³•&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;static void processCommonDefinitionAnnotations(AnnotatedBeanDefinition abd, AnnotatedTypeMetadata metadata) {
   AnnotationAttributes lazy = attributesFor(metadata, Lazy.class);
   if (lazy != null) {
      abd.setLazyInit(lazy.getBoolean(&amp;quot;value&amp;quot;));
   }
   else if (abd.getMetadata() != metadata) {
      lazy = attributesFor(abd.getMetadata(), Lazy.class);
      if (lazy != null) {
         abd.setLazyInit(lazy.getBoolean(&amp;quot;value&amp;quot;));
      }
   }
   if (metadata.isAnnotated(Primary.class.getName())) {
      abd.setPrimary(true);
   }
   AnnotationAttributes dependsOn = attributesFor(metadata, DependsOn.class);
   if (dependsOn != null) {
      abd.setDependsOn(dependsOn.getStringArray(&amp;quot;value&amp;quot;));
   }
   if (abd instanceof AbstractBeanDefinition) {
      AbstractBeanDefinition absBd = (AbstractBeanDefinition) abd;
      AnnotationAttributes role = attributesFor(metadata, Role.class);
      if (role != null) {
         absBd.setRole(role.getNumber(&amp;quot;value&amp;quot;).intValue());
      }
      AnnotationAttributes description = attributesFor(metadata, Description.class);
      if (description != null) {
         absBd.setDescription(description.getString(&amp;quot;value&amp;quot;));
      }
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;doScan æ–¹æ³•çš„ç¬¬ 30 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// åŠ å…¥åˆ° map ä¸­
registerBeanDefinition(definitionHolder, this.registry);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç‚¹è¿›å» registerBeanDefinitionï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;protected void registerBeanDefinition(BeanDefinitionHolder definitionHolder, BeanDefinitionRegistry registry) {
   BeanDefinitionReaderUtils.registerBeanDefinition(definitionHolder, registry);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åœ¨ç‚¹è¿›å» registerBeanDefinitionï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public static void registerBeanDefinition(
      BeanDefinitionHolder definitionHolder, BeanDefinitionRegistry registry)
      throws BeanDefinitionStoreException {
   // Register bean definition under primary name.
   String beanName = definitionHolder.getBeanName();
   registry.registerBeanDefinition(beanName, definitionHolder.getBeanDefinition());
   // Register aliases for bean name, if any.
   String[] aliases = definitionHolder.getAliases();
   if (aliases != null) {
      for (String alias : aliases) {
         registry.registerAlias(beanName, alias);
      }
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;doProcessConfigurationClass ä»£ç çš„ç¬¬ 48 è¡Œ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// å¤„ç† @Import
processImports(configClass, sourceClass,getImports(sourceClass), true);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç‚¹è¿›å»è¿™ä¸ª processImports æ–¹æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;private void processImports(ConfigurationClass configClass, SourceClass currentSourceClass,
      Collection&amp;lt;SourceClass&amp;gt; importCandidates, boolean checkForCircularImports) {
   // å¦‚æœæ²¡æœ‰åŠ @Importï¼Œç›´æ¥è¿”å›
   if (importCandidates.isEmpty()) {
      return;
   }
   if (checkForCircularImports &amp;amp;&amp;amp; isChainedImportOnStack(configClass)) {
      this.problemReporter.error(new CircularImportProblem(configClass, this.importStack));
   }
   else {
      this.importStack.push(configClass);
      try {
         for (SourceClass candidate : importCandidates) {
            // @Import(IndexDao.class)ã€@Import(ImportSelector)ã€@Import(ImportBeanDefinitionRegistrar)
            // åˆ¤æ–­æ˜¯ä¸æ˜¯ ImportSelector
            if (candidate.isAssignable(ImportSelector.class)) {
               // Candidate class is an ImportSelector -&amp;gt; delegate to it to determine imports
               Class&amp;lt;?&amp;gt; candidateClass = candidate.loadClass();
               // é€šè¿‡åå°„å®ç°ä¸€ä¸ªå¯¹è±¡ 
               ImportSelector selector = BeanUtils.instantiateClass(candidateClass, ImportSelector.class);
               ParserStrategyUtils.invokeAwareMethods(
                     selector, this.environment, this.resourceLoader, this.registry);
               if (this.deferredImportSelectors != null &amp;amp;&amp;amp; selector instanceof DeferredImportSelector) {
                  this.deferredImportSelectors.add(
                        new DeferredImportSelectorHolder(configClass, (DeferredImportSelector) selector));
               }
               else {
                  String[] importClassNames = selector.selectImports(currentSourceClass.getMetadata());
                  Collection&amp;lt;SourceClass&amp;gt; importSourceClasses = asSourceClasses(importClassNames);
                  processImports(configClass, currentSourceClass, importSourceClasses, false);
               }
            }
            // åˆ¤æ–­æ˜¯ä¸æ˜¯ ImportBeanDefinitionRegistrar
            else if (candidate.isAssignable(ImportBeanDefinitionRegistrar.class)) {
               // Candidate class is an ImportBeanDefinitionRegistrar -&amp;gt;
               // delegate to it to register additional bean definitions
               Class&amp;lt;?&amp;gt; candidateClass = candidate.loadClass();
               ImportBeanDefinitionRegistrar registrar =
                     BeanUtils.instantiateClass(candidateClass, ImportBeanDefinitionRegistrar.class);
               ParserStrategyUtils.invokeAwareMethods(
                     registrar, this.environment, this.resourceLoader, this.registry);
               configClass.addImportBeanDefinitionRegistrar(registrar, currentSourceClass.getMetadata());
            }
            // æ™®é€šç±»ï¼š@Import(IndexDao.class)
            else {
               // Candidate class not an ImportSelector or ImportBeanDefinitionRegistrar -&amp;gt;
               // process it as an @Configuration class
               this.importStack.registerImport(
                     currentSourceClass.getMetadata(), candidate.getMetadata().getClassName());
               processConfigurationClass(candidate.asConfigClass(configClass));
            }
         }
      }
      catch (BeanDefinitionStoreException ex) {
         throw ex;
      }
      catch (Throwable ex) {
         throw new BeanDefinitionStoreException(
               &amp;quot;Failed to process import candidates for configuration class [&amp;quot; +
               configClass.getMetadata().getClassName() + &amp;quot;]&amp;quot;, ex);
      }
      finally {
         this.importStack.pop();
      }
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;import&#34;&gt;Import&lt;/h1&gt;
&lt;h2 id=&#34;importselector&#34;&gt;ImportSelector&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class MyImportSelector implements ImportSelector {
   @Override
   public String[] selectImports(AnnotationMetadata importingClassMetadata) {
      return new String[]{IndexDaoImpl3.class.getName()};
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@ComponentScan(&amp;quot;com.ssm&amp;quot;)
@Import(MyImportSelector.class)
public class AppConfig {
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class IndexDaoImpl3 implements IndexDao{
   @Override
   public void query() {
      System.out.println(&amp;quot;dao3...æ¨¡æ‹ŸæŸ¥è¯¢æ•°æ®åº“&amp;quot;);
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
   public static void main(String[] args) {
      // æŠŠ Spring æ‰€æœ‰å‰æç¯å¢ƒå‡†å¤‡å¥½
      // 1.å‡†å¤‡å·¥å‚=DefaultListableBeanFactory
      // å®ä¾‹åŒ–ä¸€ä¸ª bdReader å’Œä¸€ä¸ª scanner
      AnnotationConfigApplicationContext context =
            new AnnotationConfigApplicationContext();
      // æŠŠä¸€ä¸ª class è½¬æˆ bdï¼Œæœ€å put åˆ° map
      // map ä½ç½® DefaultListableBeanFactory çš„ beanDefinitionMap
      context.register(AppConfig.class);
      // åˆå§‹åŒ– Spring çš„ç¯å¢ƒ
      context. refresh();
      IndexDao dao = context.getBean(IndexDaoImpl3.class);
      dao.query();
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;dao3...æ¨¡æ‹ŸæŸ¥è¯¢æ•°æ®åº“
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç›´æ¥åœ¨ IndexDaoImpl3 æ·»åŠ  @Component æ³¨è§£ä¹Ÿèƒ½å®ç°å°† å¯¹è±¡æ³¨å…¥åˆ° Spring å®¹å™¨ä¸­ï¼Œä¸ºä»€ä¹ˆè¦ä½¿ç”¨ä¸€ä¸ª MyImportSelector implements ImportSelector ç±»å‘¢ï¼Ÿ&lt;br&gt;
å› ä¸ºæœ‰çš„åŠŸèƒ½éœ€è¦ Spring åŠ¨æ€å¸®æˆ‘ä»¬åŠ è½½ï¼Œæ¯”å¦‚ IndexDaoImpl3 æ˜¯æˆ‘å¼€å‘çš„ç¨‹åºï¼Œæˆ‘å¼€å‘çš„ç¨‹åºå¹¶ä¸ä¸€å®šåœ¨æˆ‘çš„é¡¹ç›®ä¸­ï¼Œå¯ä»¥åœ¨ AppConfig ä¸­ä¿®æ”¹æ‰«æåŒ…ï¼Œä½†æ˜¯å¦‚æœåªæœ‰ä¸€ä¸ªç±»éœ€è¦å¼•ç”¨ï¼Œä¿®æ”¹æ‰«æåŒ… @ComponentScan ä¸æ˜¯å¥½çš„åŠæ³•ã€‚å¯ä»¥å¼€å…³é—­æŸäº›åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;åŠ¨æ€ä»£ç†ï¼š&lt;/p&gt;
&lt;p&gt;Spring åº•å±‚çš„ AOP æä¾›ä¸€ä¸ªå¼€å…³æ¥å¼€å¯æ˜¯å¦è¦å¯¹ AOP çš„æ”¯æŒ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class IndexDaoImpl3 implements IndexDao, BeanPostProcessor {
   @Override
   public Object postProcessBeforeInitialization(Object bean, String beanName) throws BeansException {
      if(beanName.equals(&amp;quot;indexDao&amp;quot;)){
         bean = Proxy.newProxyInstance(this.getClass().getClassLoader(), new Class[]{IndexDao.class},new MyInvocationHandler(bean));
      }
      return bean;
   }
   @Override
   public Object postProcessAfterInitialization(Object bean, String beanName) throws BeansException {
      return null;
   }
   @Override
   public void query() {
      System.out.println(&amp;quot;dao3...æ¨¡æ‹ŸæŸ¥è¯¢æ•°æ®åº“&amp;quot;);
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ€æ ·å®ç° Spring åŠ¨æ€åŠ è½½ï¼Ÿ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class MyImportSelector implements ImportSelector {
   @Override
   public String[] selectImports(AnnotationMetadata importingClassMetadata) {
      // å¾—åˆ° @EnableLuban æ³¨è§£çš„å€¼
      // int value = importingClassMetadata.getAnnotationTypes().value
      // if(value)   return new String[]{IndexDaoImpl3.class.getName()};
      return new String[]{IndexDaoImpl3.class.getName()};
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Retention(RetentionPolicy.RUNTIME)
@Import(MyImportSelector.class)
public @interface EnableLuban {
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@ComponentScan(&amp;quot;com.ssm&amp;quot;)
@EnableLuban
public class AppConfig {
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœé…ç½®ç±»æœ‰ @EnableLuban æ³¨è§£ï¼Œè¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;dao3...æ¨¡æ‹ŸæŸ¥è¯¢æ•°æ®åº“
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœé…ç½®ç±»æ²¡æœ‰ @EnableLuban æ³¨è§£ï¼Œè¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Exception in thread &amp;quot;main&amp;quot; org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type &#39;com.ssm.dao.impl.IndexDaoImpl3&#39; available
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class MyInvocationHandler implements InvocationHandler {
   Object target;
   public MyInvocationHandler(Object target){
      this.target = target;
   }
   @Override
   public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
      System.out.println(&amp;quot;ä»£ç†æ–¹æ³•...&amp;quot;);
      return method.invoke(target,args);
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
   public static void main(String[] args) {
      // æŠŠ Spring æ‰€æœ‰å‰æç¯å¢ƒå‡†å¤‡å¥½
      // 1.å‡†å¤‡å·¥å‚=DefaultListableBeanFactory
      // å®ä¾‹åŒ–ä¸€ä¸ª bdReader å’Œä¸€ä¸ª scanner
      AnnotationConfigApplicationContext context =
            new AnnotationConfigApplicationContext();
      // æŠŠä¸€ä¸ª class è½¬æˆ bdï¼Œæœ€å put åˆ° map
      // map ä½ç½® DefaultListableBeanFactory çš„ beanDefinitionMap
      context.register(AppConfig.class);
      // åˆå§‹åŒ– Spring çš„ç¯å¢ƒ
      context. refresh();
      IndexDao dao = (IndexDao) context.getBean(&amp;quot;indexDao&amp;quot;);
      dao.query();
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ä»£ç†æ–¹æ³•...
dao...æ¨¡æ‹ŸæŸ¥è¯¢æ•°æ®åº“
&lt;/code&gt;&lt;/pre&gt;
">Springç³»åˆ—ï¼ˆä¹ï¼‰Springæºç è§£æ</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/spring-xi-lie-ba-spring-yuan-ma-jie-xi/"" data-c="
          &lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
   public static void main(String[] args) {
      // åˆå§‹åŒ– Spring ç¯å¢ƒ
      // 1.å‡†å¤‡å·¥å‚=DefaultListableBeanFactory
      // å®ä¾‹åŒ–ä¸€ä¸ª bdReader å’Œä¸€ä¸ª scanner
      AnnotationConfigApplicationContext context =
            new AnnotationConfigApplicationContext();
      // æŠŠä¸€ä¸ª class è½¬æˆ bdï¼Œæœ€å put åˆ° map
      // æ³¨å†Œ AppConfig.class
      context.register(AppConfig.class);
      // è§£æ AppConfig.class
      context.refresh();
      IndexDao indexDao = context.getBean(IndexDaoImpl.class);
      indexDao.query();
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;1new-annotationconfigapplicationcontext&#34;&gt;1.new AnnotationConfigApplicationContext();&lt;/h1&gt;
&lt;p&gt;ç¬¬ 6-7 è¡Œä»£ç ï¼šç”±äº AnnotationConfigApplicationContextÂ æœ‰çˆ¶ç±»ï¼Œæ‰€ä»¥ä¼šå…ˆè°ƒç”¨çˆ¶ç±»æ„é€ æ–¹æ³•ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class AnnotationConfigApplicationContext extends GenericApplicationContext implements AnnotationConfigRegistry {
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;çˆ¶ç±»æ„é€ æ–¹æ³• GenericApplicationContext() ä¸­åˆ›å»ºä¸€ä¸ª DefaultListableBeanFactory å·¥å‚ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public GenericApplicationContext() {
   this.beanFactory = new DefaultListableBeanFactory();
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;çˆ¶ç±»æ„é€ æ–¹æ³•è°ƒç”¨å®Œæˆåï¼Œè°ƒç”¨æœ¬ç±»æ„é€ æ–¹æ³•ï¼Œåˆå§‹åŒ–è¯»å–å™¨ AnnotatedBeanDefinitionReader å’Œæ‰«æå™¨ ClassPathBeanDefinitionScannerï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public AnnotationConfigApplicationContext() {
   /**
    * çˆ¶ç±»çš„æ„é€ æ–¹æ³• super()
    *åˆ›å»ºä¸€ä¸ªè¯»å–æ³¨è§£çš„ Bean å®šä¹‰è¯»å–å™¨ï¼šreader èƒ½è¯»å–è¢«åŠ äº†æ³¨è§£çš„ç±»
    * ä»€ä¹ˆæ˜¯ bean å®šä¹‰ï¼ŸBeanDefinition
    */
   this.reader = new AnnotatedBeanDefinitionReader(this);
   // å®šä¹‰æ‰«æå™¨
   // å¯ä»¥ç”¨æ¥æ‰«æåŒ…ï¼Œç»§è€Œè½¬æ¢æˆ bd
   // ä½†æ˜¯å®é™…ä¸Šæˆ‘ä»¬æ‰«æåŒ…å·¥ä½œä¸æ˜¯ scanner è¿™ä¸ªå¯¹è±¡
   // æ˜¯ Spring è‡ªå·± new çš„ä¸€ä¸ª ClasspathBeanDefinitionScanner
   // è¿™é‡Œçš„ scanner ä»…ä»…æ˜¯ä¸ºäº†ç¨‹åºå‘˜èƒ½å¤Ÿåœ¨å¤–éƒ¨è°ƒç”¨ AnnotationConfigApplicationContext å¯¹è±¡çš„ scan æ–¹æ³•ç”¨çš„ã€‚
   this.scanner = new ClassPathBeanDefinitionScanner(this);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;11-new-annotatedbeandefinitionreaderthis&#34;&gt;1.1 new AnnotatedBeanDefinitionReader(this)&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/7%E4%B8%AA%E5%AF%B9%E8%B1%A1%E7%B1%BB%E5%9E%8B.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h1 id=&#34;2contextrefresh&#34;&gt;2.context.refresh();&lt;/h1&gt;
&lt;p&gt;Test ç±»ç¬¬ 12 è¡Œä»£ç ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;context.refresh();
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç‚¹è¿›å»å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public void refresh() throws BeansException, IllegalStateException {
   synchronized (this.startupShutdownMonitor) {
      // Prepare this context for refreshing.
      // å‡†å¤‡å·¥ä½œåŒ…æ‹¬è®¾ç½®å¯åŠ¨æ—¶é—´ã€æ˜¯å¦æ¿€æ´»æ ‡è¯†ä½ï¼Œåˆå§‹åŒ–å±æ€§æºï¼ˆproperty sourceï¼‰é…ç½®
      prepareRefresh();
      // Tell the subclass to refresh the internal bean factory.
      ConfigurableListableBeanFactory beanFactory = obtainFreshBeanFactory();
      // Prepare the bean factory for use in this context.
      // å‡†å¤‡ Bean å·¥å‚
      prepareBeanFactory(beanFactory);
      try {
         // Allows post-processing of the bean factory in context subclasses.
         // è¿™ä¸ªæ–¹æ³•åœ¨å½“å‰ç‰ˆæœ¬çš„ spring æ˜¯æ²¡æœ‰ä»»ä½•ä»£ç çš„
         // å¯èƒ½ Spring æœŸå¾…åœ¨åé¢çš„ç‰ˆæœ¬ä¸­å»æ‰©å±•å§
         postProcessBeanFactory(beanFactory);
         // Invoke factory processors registered as beans in the context.
         // åœ¨ Spring çš„ç¯å¢ƒä¸­æ‰§è¡Œå·²ç»è¢«æ³¨å†Œçš„ factory processors
         // è®¾ç½®æ‰§è¡Œè‡ªå®šä¹‰çš„ ProcessBeanFactory å’Œ Spring å†…éƒ¨è‡ªå·±å®šä¹‰çš„ï¼Œæ¯”å¦‚ ConfigurationClassPostProcessor
         invokeBeanFactoryPostProcessors(beanFactory);
         // Register bean processors that intercept bean creation.
         registerBeanPostProcessors(beanFactory);
         // Initialize message source for this context.
         initMessageSource();
         // Initialize event multicaster for this context.
         initApplicationEventMulticaster();
         // Initialize other special beans in specific context subclasses.
         onRefresh();
         // Check for listener beans and register them.
         registerListeners();
         // Instantiate all remaining (non-lazy-init) singletons.
         finishBeanFactoryInitialization(beanFactory);
         // Last step: publish corresponding event.
         finishRefresh();
      }
      catch (BeansException ex) {
         if (logger.isWarnEnabled()) {
            logger.warn(&amp;quot;Exception encountered during context initialization - &amp;quot; +
                  &amp;quot;cancelling refresh attempt: &amp;quot; + ex);
         }
         // Destroy already created singletons to avoid dangling resources.
         destroyBeans();
         // Reset &#39;active&#39; flag.
         cancelRefresh(ex);
         // Propagate exception to caller.
         throw ex;
      }
      finally {
         // Reset common introspection caches in Spring&#39;s core, since we
         // might not ever need metadata for singleton beans anymore...
         resetCommonCaches();
      }
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;21-preparebeanfactory&#34;&gt;2.1 prepareBeanFactory&lt;/h2&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 12 è¡Œå‡†å¤‡ Bean å·¥å‚ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
 * é…ç½®å·¥å‚æ ‡å‡†çš„ç‰¹å¾ï¼Œæ¯”å¦‚ä¸Šä¸‹æ–‡çš„åŠ è½½å™¨ ClassLoader å’Œ post-processors å›è°ƒ
 * Configure the factory&#39;s standard context characteristics,
 * such as the context&#39;s ClassLoader and post-processors.
 * @param beanFactory the BeanFactory to configure
 */
protected void prepareBeanFactory(ConfigurableListableBeanFactory beanFactory) {
   // Tell the internal bean factory to use the context&#39;s class loader etc.
   beanFactory.setBeanClassLoader(getClassLoader());
   // bean è¡¨è¾¾å¼è§£æå™¨ï¼Œèƒ½å¤Ÿåœ¨å‰å°é¡µé¢è·å– bean å½“ä¸­çš„å±æ€§
   beanFactory.setBeanExpressionResolver(new StandardBeanExpressionResolver(beanFactory.getBeanClassLoader()));
   // å¯¹è±¡ä¸ string ç±»å‹çš„è½¬æ¢ &amp;lt;property ref=&amp;quot;dao&amp;quot;&amp;gt; å°†daoè½¬ä¸ºå¯¹è±¡
   beanFactory.addPropertyEditorRegistrar(new ResourceEditorRegistrar(this, getEnvironment()));
   // Configure the bean factory with context callbacks.
   // æ·»åŠ ä¸€ä¸ªåç½®ç®¡ç†å™¨ï¼šApplicationContextAwareProcessor å®ç°äº† BeanPostProcessoræ¥å£ï¼šæ’æ‰‹ Bean çš„åˆ›å»ºè¿‡ç¨‹
   beanFactory.addBeanPostProcessor(new ApplicationContextAwareProcessor(this));
   // å¿½ç•¥æ¥å£
   beanFactory.ignoreDependencyInterface(EnvironmentAware.class);
   beanFactory.ignoreDependencyInterface(EmbeddedValueResolverAware.class);
   beanFactory.ignoreDependencyInterface(ResourceLoaderAware.class);
   beanFactory.ignoreDependencyInterface(ApplicationEventPublisherAware.class);
   beanFactory.ignoreDependencyInterface(MessageSourceAware.class);
   beanFactory.ignoreDependencyInterface(ApplicationContextAware.class);
   // BeanFactory interface not registered as resolvable type in a plain factory.
   // MessageSource registered (and found for autowiring) as a bean.
   // ä¾èµ–æ›¿æ¢ï¼šå¦‚æœæ³¨å…¥çš„æ˜¯ BeanFactoryï¼Œå°±ç”¨ beanFactory æ›¿ä»£
   beanFactory.registerResolvableDependency(BeanFactory.class, beanFactory);
   beanFactory.registerResolvableDependency(ResourceLoader.class, this);
   beanFactory.registerResolvableDependency(ApplicationEventPublisher.class, this);
   beanFactory.registerResolvableDependency(ApplicationContext.class, this);
   // Register early post-processor for detecting inner beans as ApplicationListeners.
   beanFactory.addBeanPostProcessor(new ApplicationListenerDetector(this));
   // Detect a LoadTimeWeaver and prepare for weaving, if found.
   if (beanFactory.containsBean(LOAD_TIME_WEAVER_BEAN_NAME)) {
      beanFactory.addBeanPostProcessor(new LoadTimeWeaverAwareProcessor(beanFactory));
      // Set a temporary ClassLoader for type matching.
      beanFactory.setTempClassLoader(new ContextTypeMatchClassLoader(beanFactory.getBeanClassLoader()));
   }
   // æ„æ€æ˜¯å¦‚æœè‡ªå®šä¹‰çš„ Bean ä¸­æ²¡æœ‰åä¸º &amp;quot;systemProperties&amp;quot; å’Œ &amp;quot;systemEnvironment&amp;quot; çš„ Bean
   // åˆ™æ³¨å†Œä¸¤ä¸ª Beanï¼Œkey ä¸º &amp;quot;systemProperties&amp;quot; å’Œ &amp;quot;systemEnvironment&amp;quot;, value ä¸º map
   // è¿™ä¸¤ä¸ª Bean å°±æ˜¯ä¸€äº›ç³»ç»Ÿé…ç½®å’Œç³»ç»Ÿç¯å¢ƒä¿¡æ¯
   // Register default environment beans.
   if (!beanFactory.containsLocalBean(ENVIRONMENT_BEAN_NAME)) {
      beanFactory.registerSingleton(ENVIRONMENT_BEAN_NAME, getEnvironment());
   }
   if (!beanFactory.containsLocalBean(SYSTEM_PROPERTIES_BEAN_NAME)) {
      beanFactory.registerSingleton(SYSTEM_PROPERTIES_BEAN_NAME, getEnvironment().getSystemProperties());
   }
   if (!beanFactory.containsLocalBean(SYSTEM_ENVIRONMENT_BEAN_NAME)) {
      beanFactory.registerSingleton(SYSTEM_ENVIRONMENT_BEAN_NAME, getEnvironment().getSystemEnvironment());
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;22-invokebeanfactorypostprocessors&#34;&gt;2.2 invokeBeanFactoryPostProcessors&lt;/h2&gt;
&lt;p&gt;çœ‹ refresh æ–¹æ³•çš„ç¬¬ 23 è¡Œ ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;invokeBeanFactoryPostProcessors(beanFactory);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç‚¹è¿›å»è¿™ä¸ªæ–¹æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;protected void invokeBeanFactoryPostProcessors(ConfigurableListableBeanFactory beanFactory) {
   // è¿™ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ getBeanFactoryPostProcessors() æ˜¯è·å–æ‰‹åŠ¨ç»™ Spring çš„ BeanFactoryPostProcessor
   // è‡ªå®šä¹‰çš„å¹¶ä¸ä»…ä»…æ˜¯ç¨‹åºå‘˜è‡ªå·±å†™çš„
   // è‡ªå·±å†™çš„å¯ä»¥åŠ  @Component,ä¹Ÿå¯ä»¥ä¸åŠ ï¼Œ
   // å¦‚æœåŠ äº†@Componentè¿™ä¸ªgetBeanFactoryPostProcessors()æ–¹æ³•å¾—ä¸åˆ°ï¼Œåº”è¯¥æ˜¯ Spring è‡ªå·±æ‰«æçš„
   // ä¸ºä»€ä¹ˆå¾—ä¸åˆ°ï¼Ÿå› ä¸º getBeanFactoryPostProcessors() è¿™ä¸ªæ–¹æ³•æ˜¯ç›´æ¥è·å–ä¸€ä¸ª listï¼Œ
   // è¿™ä¸ª list æ˜¯åœ¨ AnnotationConfigApplicationContextè¢«å®šä¹‰
   // æ‰€è°“çš„è‡ªå®šä¹‰çš„å°±æ˜¯ä½ æ‰‹åŠ¨è°ƒç”¨ AnnotationConfigApplicationContext.addBeanFactoryPostProcessor(new XxxBeanFactoryPostProcessor());
   PostProcessorRegistrationDelegate.invokeBeanFactoryPostProcessors(beanFactory, getBeanFactoryPostProcessors());
   // Detect a LoadTimeWeaver and prepare for weaving, if found in the meantime
   // (e.g. through an @Bean method registered by ConfigurationClassPostProcessor)
   if (beanFactory.getTempClassLoader() == null &amp;amp;&amp;amp; beanFactory.containsBean(LOAD_TIME_WEAVER_BEAN_NAME)) {
      beanFactory.addBeanPostProcessor(new LoadTimeWeaverAwareProcessor(beanFactory));
      beanFactory.setTempClassLoader(new ContextTypeMatchClassLoader(beanFactory.getBeanClassLoader()));
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;221-getbeanfactorypostprocessors&#34;&gt;2.2.1 getBeanFactoryPostProcessors&lt;/h3&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 9 è¡Œä¸­çš„ getBeanFactoryPostProcessors()ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public List&amp;lt;BeanFactoryPostProcessor&amp;gt; getBeanFactoryPostProcessors() {
   return this.beanFactoryPostProcessors;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;beanFactoryPostProcessors å˜é‡çš„å®šä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;private final List&amp;lt;BeanFactoryPostProcessor&amp;gt; beanFactoryPostProcessors = new ArrayList&amp;lt;&amp;gt;();
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%87%AA%E5%AE%9A%E4%B9%89beanFactoryPostProcessor.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;222-invokebeanfactorypostprocessors&#34;&gt;2.2.2 invokeBeanFactoryPostProcessors&lt;/h3&gt;
&lt;p&gt;åŒæ ·çš„ invokeBeanFactoryPostProcessors æ–¹æ³•çš„ç¬¬ 9 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public static void invokeBeanFactoryPostProcessors(
      ConfigurableListableBeanFactory beanFactory, List&amp;lt;BeanFactoryPostProcessor&amp;gt; beanFactoryPostProcessors) {
   // Invoke BeanDefinitionRegistryPostProcessors first, if any.
   Set&amp;lt;String&amp;gt; processedBeans = new HashSet&amp;lt;&amp;gt;();
   if (beanFactory instanceof BeanDefinitionRegistry) {
      BeanDefinitionRegistry registry = (BeanDefinitionRegistry) beanFactory;
      // å®šä¹‰ä¸¤ä¸ª listï¼Œ BeanDefinitionRegistryPostProcessor å®ç°äº† BeanFactoryPostProcessor æ¥å£
      // å› ä¸º bdrp æ˜¯å­ç±»ï¼Œå­ç±»æ‰©å±•äº†çˆ¶ç±»ä¸­çš„åŠŸèƒ½ã€‚
      List&amp;lt;BeanFactoryPostProcessor&amp;gt; regularPostProcessors = new ArrayList&amp;lt;&amp;gt;();
      List&amp;lt;BeanDefinitionRegistryPostProcessor&amp;gt; registryProcessors = new ArrayList&amp;lt;&amp;gt;(); 
      // è‡ªå®šä¹‰çš„ beanFactoryPostProcessors
      // å› ä¸ºä¼ å‚ï¼Œæ‰€ä»¥ beanFactoryPostProcessors æ˜¯ BeanFactoryPostProcessor ç±»å‹
      // è¿™é‡Œå› ä¸º beanFactoryPostProcessorsé•¿åº¦ä¸º0ï¼Œæ‰€ä»¥ä¸ä¼šè¿›å…¥ for å¾ªç¯ 
      for (BeanFactoryPostProcessor postProcessor : beanFactoryPostProcessors) {
         // åˆ¤æ–­ postProcessorÂ æ˜¯å¦æ˜¯ BeanFactoryPostProcessorÂ çš„å­ç±» BeanDefinitionRegistryPostProcessor
         if (postProcessor instanceof BeanDefinitionRegistryPostProcessor) {
            BeanDefinitionRegistryPostProcessor registryProcessor =
                  (BeanDefinitionRegistryPostProcessor) postProcessor;
            registryProcessor.postProcessBeanDefinitionRegistry(registry);
            registryProcessors.add(registryProcessor);
         }
         else {
         // å¦‚æœ postProcessorÂ ä¸æ˜¯ BeanFactoryPostProcessorÂ çš„å­ç±» BeanDefinitionRegistryPostProcessorï¼Œé‚£ postProcessor å°±ä¸€å®šæ˜¯ BeanFactoryPostProcessorÂ ç±»å‹ï¼Œæ·»åŠ åˆ° List&amp;lt;BeanFactoryPostProcessor&amp;gt; regularPostProcessors ä¸­
            regularPostProcessors.add(postProcessor);
         }
      }
      
      // è¿™ä¸ª currentRegistryProcessors æ”¾çš„æ˜¯ Spring å†…éƒ¨è‡ªå·±å®ç°äº† BeanDefinitionRegistryPostProcessor æ¥å£çš„å¯¹è±¡
      List&amp;lt;BeanDefinitionRegistryPostProcessor&amp;gt; currentRegistryProcessors = new ArrayList&amp;lt;&amp;gt;();
      // BeanDefinitionRegistryPostProcessor ç­‰äº BeanFactoryPostProcessor
      String[] postProcessorNames =
            beanFactory.getBeanNamesForType(BeanDefinitionRegistryPostProcessor.class, true, false);
      // è¿™ä¸ªåœ°æ–¹å¯ä»¥å¾—åˆ°ä¸€ä¸ª BeanFactoryPostProcessorï¼Œå› ä¸ºæ˜¯ Spring é»˜è®¤åœ¨æœ€å¼€å§‹è‡ªå·±æ³¨å†Œçš„
      // ä¸ºä»€ä¹ˆè¦åœ¨æœ€å¼€å§‹æ³¨å†Œè¿™ä¸ªå‘¢ï¼Ÿ
      // å› ä¸º Spring çš„å·¥å‚éœ€è¦æ³¨è§£å»æ‰«æç­‰ç­‰åŠŸèƒ½
      // è€Œè¿™äº›åŠŸèƒ½éƒ½æ˜¯éœ€è¦åœ¨ Spring å·¥å‚åˆå§‹åŒ–å®Œæˆä¹‹å‰å°±æ‰§è¡Œ
      // è¦ä¹ˆåœ¨å·¥å‚æœ€å¼€å§‹çš„æ—¶å€™ï¼Œè¦ä¹ˆåœ¨å·¥å‚åˆå§‹åŒ–ä¹‹ä¸­ï¼Œåæ­£ä¸èƒ½åœ¨ä¹‹å
      // å› ä¸ºå¦‚æœåœ¨ä¹‹åå°±æ²¡æœ‰æ„ä¹‰ï¼Œå› ä¸ºé‚£ä¸ªæ—¶å€™å·²ç»éœ€è¦ä½¿ç”¨å·¥å‚äº†
      // æ‰€ä»¥è¿™é‡Œ Spring åœ¨ä¸€å¼€å§‹å°±æ³¨å†Œäº†ä¸€ä¸ª BeanFactoryPostProcessorï¼Œç”¨æ¥æ’æ‰‹ springFactory çš„å®ä¾‹åŒ–è¿‡ç¨‹
      // åœ¨è¿™ä¸ªåœ°æ–¹æ–­ç‚¹å¯ä»¥çŸ¥é“è¿™ä¸ªç±»å«åš ConfigurationClassPostProcessor
      // ConfigurationClassPostProcessor é‚£ä¹ˆè¿™ä¸ªç±»èƒ½å¹²å˜›å‘¢ï¼Ÿå¯ä»¥å‚è€ƒæºç 
      // ä¸‹é¢å¯¹è¿™ä¸ªâ€œæ’æ‰‹ Spring å·¥å‚å®ä¾‹åŒ–è¿‡ç¨‹â€çš„ç±»é‡ç‚¹è§£é‡Š
      for (String ppName : postProcessorNames) {
         if (beanFactory.isTypeMatch(ppName, PriorityOrdered.class)) {
            currentRegistryProcessors.add(beanFactory.getBean(ppName, BeanDefinitionRegistryPostProcessor.class));
            processedBeans.add(ppName);
         }
      }
      // æ’åºä¸é‡è¦ï¼Œå†µä¸” currentRegistryProcessor è¿™é‡Œä¹Ÿåªæœ‰ä¸€ä¸ªæ•°æ®
      sortPostProcessors(currentRegistryProcessors, beanFactory);
      // åˆå¹¶ Listï¼Œä¸é‡è¦ï¼ˆä¸ºä»€ä¹ˆè¦åˆå¹¶ï¼Œå› ä¸ºæœ‰è‡ªå®šä¹‰çš„Springè‡ªå·±çš„ï¼‰
      registryProcessors.addAll(currentRegistryProcessors);
      // æœ€é‡è¦ã€‚æ³¨æ„è¿™é‡Œæ˜¯æ–¹æ³•è°ƒç”¨
      invokeBeanDefinitionRegistryPostProcessors(currentRegistryProcessors, registry);
      currentRegistryProcessors.clear();
      // Next, invoke the BeanDefinitionRegistryPostProcessors that implement Ordered.
      postProcessorNames = beanFactory.getBeanNamesForType(BeanDefinitionRegistryPostProcessor.class, true, false);
      for (String ppName : postProcessorNames) {
         if (!processedBeans.contains(ppName) &amp;amp;&amp;amp; beanFactory.isTypeMatch(ppName, Ordered.class)) {
            currentRegistryProcessors.add(beanFactory.getBean(ppName, BeanDefinitionRegistryPostProcessor.class));
            processedBeans.add(ppName);
         }
      }
      sortPostProcessors(currentRegistryProcessors, beanFactory);
      registryProcessors.addAll(currentRegistryProcessors);
      invokeBeanDefinitionRegistryPostProcessors(currentRegistryProcessors, registry);
      currentRegistryProcessors.clear();
      // Finally, invoke all other BeanDefinitionRegistryPostProcessors until no further ones appear.
      boolean reiterate = true;
      while (reiterate) {
         reiterate = false;
         postProcessorNames = beanFactory.getBeanNamesForType(BeanDefinitionRegistryPostProcessor.class, true, false);
         for (String ppName : postProcessorNames) {
            if (!processedBeans.contains(ppName)) {
               currentRegistryProcessors.add(beanFactory.getBean(ppName, BeanDefinitionRegistryPostProcessor.class));
               processedBeans.add(ppName);
               reiterate = true;
            }
         }
         sortPostProcessors(currentRegistryProcessors, beanFactory);
         registryProcessors.addAll(currentRegistryProcessors);
         invokeBeanDefinitionRegistryPostProcessors(currentRegistryProcessors, registry);
         currentRegistryProcessors.clear();
      }
      // Now, invoke the postProcessBeanFactory callback of all processors handled so far.
      invokeBeanFactoryPostProcessors(registryProcessors, beanFactory);
      invokeBeanFactoryPostProcessors(regularPostProcessors, beanFactory);
   }
   else {
      // Invoke factory processors registered with the context instance.
      invokeBeanFactoryPostProcessors(beanFactoryPostProcessors, beanFactory);
   }
   // Do not initialize FactoryBeans here: We need to leave all regular beans
   // uninitialized to let the bean factory post-processors apply to them!
   String[] postProcessorNames =
         beanFactory.getBeanNamesForType(BeanFactoryPostProcessor.class, true, false);
   // Separate between BeanFactoryPostProcessors that implement PriorityOrdered,
   // Ordered, and the rest.
   List&amp;lt;BeanFactoryPostProcessor&amp;gt; priorityOrderedPostProcessors = new ArrayList&amp;lt;&amp;gt;();
   List&amp;lt;String&amp;gt; orderedPostProcessorNames = new ArrayList&amp;lt;&amp;gt;();
   List&amp;lt;String&amp;gt; nonOrderedPostProcessorNames = new ArrayList&amp;lt;&amp;gt;();
   for (String ppName : postProcessorNames) {
      if (processedBeans.contains(ppName)) {
         // skip - already processed in first phase above
      }
      else if (beanFactory.isTypeMatch(ppName, PriorityOrdered.class)) {
         priorityOrderedPostProcessors.add(beanFactory.getBean(ppName, BeanFactoryPostProcessor.class));
      }
      else if (beanFactory.isTypeMatch(ppName, Ordered.class)) {
         orderedPostProcessorNames.add(ppName);
      }
      else {
         nonOrderedPostProcessorNames.add(ppName);
      }
   }
   // First, invoke the BeanFactoryPostProcessors that implement PriorityOrdered.
   sortPostProcessors(priorityOrderedPostProcessors, beanFactory);
   invokeBeanFactoryPostProcessors(priorityOrderedPostProcessors, beanFactory);
   // Next, invoke the BeanFactoryPostProcessors that implement Ordered.
   List&amp;lt;BeanFactoryPostProcessor&amp;gt; orderedPostProcessors = new ArrayList&amp;lt;&amp;gt;();
   for (String postProcessorName : orderedPostProcessorNames) {
      orderedPostProcessors.add(beanFactory.getBean(postProcessorName, BeanFactoryPostProcessor.class));
   }
   sortPostProcessors(orderedPostProcessors, beanFactory);
   invokeBeanFactoryPostProcessors(orderedPostProcessors, beanFactory);
   // Finally, invoke all other BeanFactoryPostProcessors.
   List&amp;lt;BeanFactoryPostProcessor&amp;gt; nonOrderedPostProcessors = new ArrayList&amp;lt;&amp;gt;();
   for (String postProcessorName : nonOrderedPostProcessorNames) {
      nonOrderedPostProcessors.add(beanFactory.getBean(postProcessorName, BeanFactoryPostProcessor.class));
   }
   invokeBeanFactoryPostProcessors(nonOrderedPostProcessors, beanFactory);
   // Clear cached merged bean definitions since the post-processors might have
   // modified the original metadata, e.g. replacing placeholders in values...
   beanFactory.clearMetadataCache();
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ç¬¬ 11ã€12ã€31 è¡Œåˆ†åˆ«å®šä¹‰äº†ä¸€ä¸ª Listï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;List&lt;BeanFactoryPostProcessor&gt; regularPostProcessorsï¼šæ”¾ç¨‹åºå‘˜æ‰‹åŠ¨æ·»åŠ çš„ BeanFactoryPostProcessor&lt;/li&gt;
&lt;li&gt;List&lt;BeanDefinitionRegistryPostProcessor&gt; registryProcessorsï¼šæ”¾ç¨‹åºå‘˜æ‰‹åŠ¨æ·»åŠ çš„ BeanDefinitionRegistryPostProcessor&lt;/li&gt;
&lt;li&gt;List&lt;BeanDefinitionRegistryPostProcessor&gt; currentRegistryProcessorsï¼šæ”¾ Spring å†…éƒ¨è‡ªå·±çš„ BeanDefinitionRegistryPostProcessor&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸Šè¿°ç¬¬ 35-36 è¡Œä»£ç ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/currentRegistryProcessors.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ä¸Šè¿°ç¬¬ 47-51 è¡Œä»£ç ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/postProcessorNames.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 58 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;private static void invokeBeanDefinitionRegistryPostProcessors(
      Collection&amp;lt;? extends BeanDefinitionRegistryPostProcessor&amp;gt; postProcessors, BeanDefinitionRegistry registry) {
   for (BeanDefinitionRegistryPostProcessor postProcessor : postProcessors) {
      postProcessor.postProcessBeanDefinitionRegistry(registry);
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/postProcessors.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ç‚¹è¿›å»ä¸Šè¿°ç¬¬  5 è¡Œä»£ç ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Override
public void postProcessBeanDefinitionRegistry(BeanDefinitionRegistry registry) {
   int registryId = System.identityHashCode(registry);
   if (this.registriesPostProcessed.contains(registryId)) {
      throw new IllegalStateException(
            &amp;quot;postProcessBeanDefinitionRegistry already called on this post-processor against &amp;quot; + registry);
   }
   if (this.factoriesPostProcessed.contains(registryId)) {
      throw new IllegalStateException(
            &amp;quot;postProcessBeanFactory already called on this post-processor against &amp;quot; + registry);
   }
   this.registriesPostProcessed.add(registryId);
   processConfigBeanDefinitions(registry);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;2221-processconfigbeandefinitions&#34;&gt;2.2.2.1 processConfigBeanDefinitions&lt;/h4&gt;
&lt;p&gt;ç‚¹è¿›ä¸Šè¿°ç¬¬ 14 è¡Œä»£ç ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public void processConfigBeanDefinitions(BeanDefinitionRegistry registry) {
   // app æä¾›çš„ beanï¼šæ¯æ‰«æåˆ°æ·»åŠ äº† @Configuraion æ³¨è§£çš„ç±»å°±æ·»åŠ åˆ°è¿™ä¸ª set é›†åˆä¸­
   List&amp;lt;BeanDefinitionHolder&amp;gt; configCandidates = new ArrayList&amp;lt;&amp;gt;();
   // è·å–å®¹å™¨ä¸­æ³¨å†Œçš„æ‰€æœ‰ bean åå­—
   String[] candidateNames = registry.getBeanDefinitionNames();
   // ä¾æ¬¡å–å‡ºæ¯ä¸ª&amp;lt;beanName,beanDefinition&amp;gt;
   for (String beanName : candidateNames) {
      BeanDefinition beanDef = registry.getBeanDefinition(beanName);
      // åˆ¤æ–­å½“å‰ bean æ˜¯å¦è¢«å¤„ç†è¿‡ï¼šä½¿ç”¨ isFullConfigurationClass æ¥æ ‡è¯†
      if (ConfigurationClassUtils.isFullConfigurationClass(beanDef) ||
            ConfigurationClassUtils.isLiteConfigurationClass(beanDef)) {
         // å¦‚æœ BeanDefinition ä¸­çš„ configurationClass å±æ€§ä¸º full æˆ–è€… liteï¼Œåˆ™æ„å‘³ç€å·²ç»å¤„ç†è¿‡äº†ï¼Œç›´æ¥è·³è¿‡
         // è¿™é‡Œéœ€è¦ç»“åˆä¸‹é¢çš„ä»£ç æ‰èƒ½ç†è§£
         if (logger.isDebugEnabled()) {
            logger.debug(&amp;quot;Bean definition has already been processed as a configuration class: &amp;quot; + beanDef);
         }
      }
      // åˆ¤æ–­è¿™ä¸ª BeanDefinition æ˜¯å¦æ˜¯ Configurationç±»ï¼Œè¿™å…¶å®ä¸»è¦æ˜¯çœ‹æ˜¯å¦æœ‰
      else if (ConfigurationClassUtils.checkConfigurationClassCandidate(beanDef, this.metadataReaderFactory)) {
         configCandidates.add(new BeanDefinitionHolder(beanDef, beanName));
      }
   }
   // Return immediately if no @Configuration classes were found
   if (configCandidates.isEmpty()) {
      return;
   }
   // æ’åºï¼Œæ ¹æ® orderï¼Œä¸é‡è¦
   // Sort by previously determined @Order value, if applicable
   configCandidates.sort((bd1, bd2) -&amp;gt; {
      int i1 = ConfigurationClassUtils.getOrder(bd1.getBeanDefinition());
      int i2 = ConfigurationClassUtils.getOrder(bd2.getBeanDefinition());
      return Integer.compare(i1, i2);
   });
   // Detect any custom bean name generation strategy supplied through the enclosing application context
   SingletonBeanRegistry sbr = null;
   // å¦‚æœ BeanDefinitionRegistry æ˜¯ SingletonBeanRegistry å­ç±»çš„è¯
   // ç”±äºä¼šå°† registry å¼ºè½¬ä¸º SingletonBeanRegistry
   if (registry instanceof SingletonBeanRegistry) {
      sbr = (SingletonBeanRegistry) registry;
      if (!this.localBeanNameGeneratorSet) {//æ˜¯å¦æœ‰è‡ªå®šä¹‰çš„
         BeanNameGenerator generator = (BeanNameGenerator) sbr.getSingleton(CONFIGURATION_BEAN_NAME_GENERATOR);
         // SingletonBeanRegistry ä¸­æœ‰ id ä¸º org.springframework.context.annotation.internalConfigurationBeanNameGenerator
         // å¦‚æœæœ‰åˆ™åˆ©ç”¨å®ƒçš„ï¼Œå¦åˆ™åˆ™ä½¿ç”¨ Spring é»˜è®¤çš„
         if (generator != null) {
            this.componentScanBeanNameGenerator = generator;
            this.importBeanNameGenerator = generator;
         }
      }
   }
   if (this.environment == null) {
      this.environment = new StandardEnvironment();
   }
   // Parse each @Configuration class
   // å®ä¾‹åŒ– ConfigurationClassParser ä¸ºäº†è§£æå„ä¸ªé…ç½®ç±»
   ConfigurationClassParser parser = new ConfigurationClassParser(
         this.metadataReaderFactory, this.problemReporter, this.environment,
         this.resourceLoader, this.componentScanBeanNameGenerator, registry);
   // å®ä¾‹åŒ– 2 ä¸ª setï¼Œcandidates ç”¨äºå°†ä¹‹å‰åŠ å…¥çš„ configCandidates è¿›è¡Œå»é‡
   // å› ä¸ºå¯èƒ½æœ‰å¤šä¸ªé…ç½®ç±»é‡å¤äº†
   // alreadyParsed ç”¨æˆ·åˆ¤æ–­æ˜¯å¦å¤„ç†è¿‡
   Set&amp;lt;BeanDefinitionHolder&amp;gt; candidates = new LinkedHashSet&amp;lt;&amp;gt;(configCandidates);
   Set&amp;lt;ConfigurationClass&amp;gt; alreadyParsed = new HashSet&amp;lt;&amp;gt;(configCandidates.size());
   do {
      parser.parse(candidates);
      parser.validate();
      Set&amp;lt;ConfigurationClass&amp;gt; configClasses = new LinkedHashSet&amp;lt;&amp;gt;(parser.getConfigurationClasses());
      configClasses.removeAll(alreadyParsed);
      // Read the model and create bean definitions based on its content
      if (this.reader == null) {
         this.reader = new ConfigurationClassBeanDefinitionReader(
               registry, this.sourceExtractor, this.resourceLoader, this.environment,
               this.importBeanNameGenerator, parser.getImportRegistry());
      }
      // æŠŠæ‰«æå‡ºæ¥çš„ bean å¯¹åº”çš„ beanDefinitions æ·»åŠ åˆ° factory çš„ map å½“ä¸­
      this.reader.loadBeanDefinitions(configClasses);
      alreadyParsed.addAll(configClasses);
      candidates.clear();
      if (registry.getBeanDefinitionCount() &amp;gt; candidateNames.length) {
         String[] newCandidateNames = registry.getBeanDefinitionNames();
         Set&amp;lt;String&amp;gt; oldCandidateNames = new HashSet&amp;lt;&amp;gt;(Arrays.asList(candidateNames));
         Set&amp;lt;String&amp;gt; alreadyParsedClasses = new HashSet&amp;lt;&amp;gt;();
         for (ConfigurationClass configurationClass : alreadyParsed) {
            alreadyParsedClasses.add(configurationClass.getMetadata().getClassName());
         }
         for (String candidateName : newCandidateNames) {
            if (!oldCandidateNames.contains(candidateName)) {
               BeanDefinition bd = registry.getBeanDefinition(candidateName);
               if (ConfigurationClassUtils.checkConfigurationClassCandidate(bd, this.metadataReaderFactory) &amp;amp;&amp;amp;
                     !alreadyParsedClasses.contains(bd.getBeanClassName())) {
                  candidates.add(new BeanDefinitionHolder(bd, candidateName));
               }
            }
         }
         candidateNames = newCandidateNames;
      }
   }
   while (!candidates.isEmpty());
   // Register the ImportRegistry as a bean in order to support ImportAware @Configuration classes
   if (sbr != null &amp;amp;&amp;amp; !sbr.containsSingleton(IMPORT_REGISTRY_BEAN_NAME)) {
      sbr.registerSingleton(IMPORT_REGISTRY_BEAN_NAME, parser.getImportRegistry());
   }
   if (this.metadataReaderFactory instanceof CachingMetadataReaderFactory) {
      // Clear cache in externally provided MetadataReaderFactory; this is a no-op
      // for a shared cache since it&#39;ll be cleared by the ApplicationContext.
      ((CachingMetadataReaderFactory) this.metadataReaderFactory).clearCache();
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/getBeanDefinitionNames.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h5 id=&#34;22211-checkconfigurationclasscandidate&#34;&gt;2.2.2.1.1 checkConfigurationClassCandidate&lt;/h5&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 19 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;else if (ConfigurationClassUtils.checkConfigurationClassCandidate(beanDef, this.metadataReaderFactory)) {
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;refresh() çš„ä¸»è¦åŠŸèƒ½æ˜¯è¦è§£æç±»ï¼šSpring è®¤ä¸ºæ·»åŠ äº†@Configurationã€@Componentã€@Import...æ³¨è§£çš„ç±»éƒ½æ˜¯éœ€è¦è§£æçš„ç±»ã€‚&lt;br&gt;
å¦‚ä½•å°†ä¸€ä¸ª User ç±»å˜æˆ BeanDefinitionï¼šXxxBeanDefinition bd = new XxxBeanDefinition(user);&lt;/p&gt;
&lt;p&gt;Spring å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªç±»æ˜¯å¦æ˜¯åº”è¯¥è§£æçš„ç±»ï¼Ÿ&lt;/p&gt;
&lt;p&gt;â‘ åˆ¤æ–­ä¸€ä¸ª bd æ˜¯å¦è¢«åŠ äº†æ³¨è§£ï¼ˆAnnotatedBeanDefinition abd = new AnnotatedBeanDefinition(AppConfig.class); register.regisyBD(abd); ï¼‰ï¼›â‘¡æŠŠä¿¡æ¯ï¼ˆå…ƒæ•°æ®ï¼‰æ‹¿å‡ºæ¥ï¼›â‘¢æ ¹æ®ä¿¡æ¯åˆ¤æ–­åŠ äº†ä»€ä¹ˆæ³¨è§£&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public static boolean checkConfigurationClassCandidate(BeanDefinition beanDef, MetadataReaderFactory metadataReaderFactory) {
   String className = beanDef.getBeanClassName();
   if (className == null || beanDef.getFactoryMethodName() != null) {
      return false;
   }
   AnnotationMetadata metadata;
   // åˆ¤æ–­è¿™ä¸ª bd æ˜¯å¦è¢«åŠ äº†æ³¨è§£
   if (beanDef instanceof AnnotatedBeanDefinition &amp;amp;&amp;amp;
         className.equals(((AnnotatedBeanDefinition) beanDef).getMetadata().getClassName())) {
      // Can reuse the pre-parsed metadata from the given BeanDefinition...
      // å¦‚æœ BeanDefinition æ˜¯ AnnotatedBeanDefinition çš„å®ä¾‹ï¼Œå¹¶ä¸” className å’Œ BeanDefinition ä¸­çš„å…ƒæ•°æ®çš„ç±»åç›¸åŒ
      // åˆ™ç›´æ¥ä» BeanDefinition è·å¾—å…ƒæ•°æ®Metadata
      metadata = ((AnnotatedBeanDefinition) beanDef).getMetadata();
   }
   else if (beanDef instanceof AbstractBeanDefinition &amp;amp;&amp;amp; ((AbstractBeanDefinition) beanDef).hasBeanClass()) {
      // Check already loaded Class if present...
      // since we possibly can&#39;t even load the class file for this Class.
      // å¦‚æœ BeanDefinition æ˜¯ AbstractBeanDefinition çš„å®ä¾‹ï¼Œå¹¶ä¸” beanDef æœ‰ beanClass å±æ€§å­˜åœ¨
      // åˆ™å®ä¾‹åŒ– StandardAnnotationMetadata
      Class&amp;lt;?&amp;gt; beanClass = ((AbstractBeanDefinition) beanDef).getBeanClass();
      metadata = new StandardAnnotationMetadata(beanClass, true);
   }
   else {
      try {
         MetadataReader metadataReader = metadataReaderFactory.getMetadataReader(className);
         metadata = metadataReader.getAnnotationMetadata();
      }
      catch (IOException ex) {
         if (logger.isDebugEnabled()) {
            logger.debug(&amp;quot;Could not find class file for introspecting configuration annotations: &amp;quot; + className, ex);
         }
         return false;
      }
   }
   // åˆ¤æ–­å½“å‰è¿™ä¸ª bd ä¸­å­˜åœ¨çš„ç±»æ˜¯ä¸æ˜¯åŠ äº† @Configuration æ³¨è§£ï¼Œä½†æ˜¯å¦‚æœåŠ äº† @Configurationï¼Œä¸‹é¢çš„è¿™å‡ ä¸ªæ³¨è§£å°±ä¸å†åˆ¤æ–­ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ª if-else if åˆ†æ”¯
   // åªæœ‰æ»¡è¶³äº† &amp;quot;æ²¡æœ‰åŠ  @Configurationæ³¨è§£&amp;quot;ï¼Œæ‰ä¼šèµ° else åˆ†æ”¯å»åˆ¤æ–­æ˜¯å¦æ·»åŠ äº†å…¶ä»–æ³¨è§£
   if (isFullConfigurationCandidate(metadata)) {
      // å¦‚æœå­˜åœ¨ Configuration æ³¨è§£ï¼Œåˆ™ä¸º BeanDefinition è®¾ç½® configurationClass å±æ€§ä¸º FULL
      beanDef.setAttribute(CONFIGURATION_CLASS_ATTRIBUTE, CONFIGURATION_CLASS_FULL);
   }
   // åˆ¤æ–­æ˜¯å¦åŠ äº†ä»¥ä¸‹æ³¨è§£ï¼Œæ‘˜å½• isLiteConfigurationCandidate çš„æºç 
   // candidateIndicators.add(Component.class.getName());
   // candidateIndicators.add(ComponentScan.class.getName());
   // candidateIndicators.add(Import.class.getName());
   // candidateIndicators.add(ImportResource.class.getName());
   else if (isLiteConfigurationCandidate(metadata)) {
      beanDef.setAttribute(CONFIGURATION_CLASS_ATTRIBUTE, CONFIGURATION_CLASS_LITE);
   }
   else {
      return false;
   }
   // It&#39;s a full or lite configuration candidate... Let&#39;s determine the order value, if any.
   Integer order = getOrder(metadata);
   if (order != null) {
      beanDef.setAttribute(ORDER_ATTRIBUTE, order);
   }
   return true;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 39 è¡Œï¼Œåˆ¤æ–­æ˜¯å¦åŠ äº† @Configuration æ³¨è§£&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public static boolean isFullConfigurationCandidate(AnnotationMetadata metadata) {
   return metadata.isAnnotated(Configuration.class.getName());
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 48 è¡Œï¼Œåˆ¤æ–­æ˜¯å¦åŠ äº†å…¶ä»–æ³¨è§£ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public static boolean isLiteConfigurationCandidate(AnnotationMetadata metadata) {
   // Do not consider an interface or an annotation...
   if (metadata.isInterface()) {
      return false;
   }
   // Any of the typical annotations found?
   for (String indicator : candidateIndicators) {
      if (metadata.isAnnotated(indicator)) {
         return true;
      }
   }
   // Finally, let&#39;s look for @Bean methods...
   try {
      return metadata.hasAnnotatedMethods(Bean.class.getName());
   }
   catch (Throwable ex) {
      if (logger.isDebugEnabled()) {
         logger.debug(&amp;quot;Failed to introspect @Bean methods on class [&amp;quot; + metadata.getClassName() + &amp;quot;]: &amp;quot; + ex);
      }
      return false;
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 8 è¡Œä¸­æåˆ°çš„ candidateIndicators&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;private static final Set&amp;lt;String&amp;gt; candidateIndicators = new HashSet&amp;lt;&amp;gt;(8);
static {
   candidateIndicators.add(Component.class.getName());
   candidateIndicators.add(ComponentScan.class.getName());
   candidateIndicators.add(Import.class.getName());
   candidateIndicators.add(ImportResource.class.getName());
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å…³äº 39-48 è¡Œçš„ if-else if åˆ¤æ–­æ˜¯å¦æ·»åŠ æ³¨è§£ï¼Œå…¶ä¸­ &amp;quot;eles if&amp;quot; åˆ†æ”¯çš„ä½œç”¨ï¼Œè¡¥å……è¯´æ˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœä¸€ä¸ªç±»æ·»åŠ äº† @Configurationï¼ŒSpring æŠŠå®ƒæ‰«æå‡ºæ¥ï¼ŒçŸ¥é“å®ƒæ˜¯ä¸€ä¸ªé…ç½®ç±»ï¼Œç„¶åå†å»è§£æè¿™ä¸ªç±»ï¼Œå°±å¯ä»¥ä¾æ¬¡æ‰«æåˆ°å…¶ä»–æ³¨è§£ï¼š@ComponentScanã€@Import&lt;/li&gt;
&lt;li&gt;ä½†æ˜¯å¦‚æœä¸€ä¸ªç±»æ²¡æœ‰æ·»åŠ  @Configuration æ³¨è§£ï¼ŒåªåŠ å…¥äº† @ImportResource(&amp;quot;spring.xml&amp;quot;) æ³¨è§£ï¼Œè¿™æ—¶å€™å°±éœ€è¦ä½¿ç”¨åˆ°ä¸Šè¿°çš„ eles if åˆ†æ”¯å•ç‹¬è¿›è¡Œå¤„ç†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸Šè¿° processConfigBeanDefinitions æ–¹æ³•çš„ç¬¬ 79 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;parser.parse(candidates);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç‚¹è¿›è¿™ä¸ªæ–¹æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public void parse(Set&amp;lt;BeanDefinitionHolder&amp;gt; configCandidates) {
   this.deferredImportSelectors = new LinkedList&amp;lt;&amp;gt;();
   // æ ¹æ® BeanDefinition çš„ç±»å‹åšä¸åŒçš„å¤„ç†ï¼Œä¸€èˆ¬éƒ½ä¼šè°ƒç”¨ ConfigurationClassParse#parse è¿›è¡Œè§£æ
   for (BeanDefinitionHolder holder : configCandidates) {
      BeanDefinition bd = holder.getBeanDefinition();
      try {
         // åˆ¤æ–­è¿™ä¸ª bd æ˜¯å¦è¢«åŠ äº†æ³¨è§£
         if (bd instanceof AnnotatedBeanDefinition) {
            parse(((AnnotatedBeanDefinition) bd).getMetadata(), holder.getBeanName());
         }
         else if (bd instanceof AbstractBeanDefinition &amp;amp;&amp;amp; ((AbstractBeanDefinition) bd).hasBeanClass()) {
            parse(((AbstractBeanDefinition) bd).getBeanClass(), holder.getBeanName());
         }
         else {
            parse(bd.getBeanClassName(), holder.getBeanName());
         }
      }
      catch (BeanDefinitionStoreException ex) {
         throw ex;
      }
      catch (Throwable ex) {
         throw new BeanDefinitionStoreException(
               &amp;quot;Failed to parse configuration class [&amp;quot; + bd.getBeanClassName() + &amp;quot;]&amp;quot;, ex);
      }
   }
   processDeferredImportSelectors();
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 9 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;parse(((AnnotatedBeanDefinition) bd).getMetadata(), holder.getBeanName());
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç‚¹è¿›è¿™ä¸ªæ–¹æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;protected final void parse(AnnotationMetadata metadata, String beanName) throws IOException {
   processConfigurationClass(new ConfigurationClass(metadata, beanName));
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç‚¹è¿›ç¬¬ 2 è¡Œè¿™ä¸ªæ–¹æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;protected void processConfigurationClass(ConfigurationClass configClass) throws IOException {
   // åˆ¤æ–­æ˜¯å¦åº”è¯¥è·³è¿‡è§£æ
   if (this.conditionEvaluator.shouldSkip(configClass.getMetadata(), ConfigurationPhase.PARSE_CONFIGURATION)) {
      return;
   }
   // å¤„ç† Imported çš„æƒ…å†µ
   ConfigurationClass existingClass = this.configurationClasses.get(configClass);
   if (existingClass != null) {
      if (configClass.isImported()) {
         if (existingClass.isImported()) {
            existingClass.mergeImportedBy(configClass);
         }
         // Otherwise ignore new imported config class; existing non-imported class overrides it.
         return;
      }
      else {
         // Explicit bean definition found, probably replacing an import.
         // Let&#39;s remove the old one and go with the new one.
         this.configurationClasses.remove(configClass);
         this.knownSuperclasses.values().removeIf(configClass::equals);
      }
   }
   // Recursively process the configuration class and its superclass hierarchy.
   SourceClass sourceClass = asSourceClass(configClass);
   do {
      sourceClass = doProcessConfigurationClass(configClass, sourceClass);
   }
   while (sourceClass != null);
   // ä¸€ä¸ª mapï¼Œç”¨æ¥å­˜æ”¾æ‰«æå‡ºæ¥çš„ beanï¼ˆæ³¨æ„è¿™é‡Œçš„ bean ä¸æ˜¯å¯¹è±¡ï¼Œä»…ä»…æ˜¯ bean çš„ä¿¡æ¯ï¼Œå› ä¸ºè¿˜æ²¡åˆ°å®ä¾‹åŒ–ï¼‰
   this.configurationClasses.put(configClass, configClass);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 28 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Nullable
protected final SourceClass doProcessConfigurationClass(ConfigurationClass configClass, SourceClass sourceClass)
      throws IOException {
   // Recursively process any member (nested) classes first
   // å¤„ç†å†…éƒ¨ç±»
   processMemberClasses(configClass, sourceClass);
   // Process any @PropertySource annotations
   for (AnnotationAttributes propertySource : AnnotationConfigUtils.attributesForRepeatable(
         sourceClass.getMetadata(), PropertySources.class,
         org.springframework.context.annotation.PropertySource.class)) {
      if (this.environment instanceof ConfigurableEnvironment) {
         processPropertySource(propertySource);
      }
      else {
         logger.warn(&amp;quot;Ignoring @PropertySource annotation on [&amp;quot; + sourceClass.getMetadata().getClassName() +
               &amp;quot;]. Reason: Environment must implement ConfigurableEnvironment&amp;quot;);
      }
   }
   // Process any @ComponentScan annotations
   Set&amp;lt;AnnotationAttributes&amp;gt; componentScans = AnnotationConfigUtils.attributesForRepeatable(
         sourceClass.getMetadata(), ComponentScans.class, ComponentScan.class);
   if (!componentScans.isEmpty() &amp;amp;&amp;amp;
         !this.conditionEvaluator.shouldSkip(sourceClass.getMetadata(), ConfigurationPhase.REGISTER_BEAN)) {
      for (AnnotationAttributes componentScan : componentScans) {
         // The config class is annotated with @ComponentScan -&amp;gt; perform the scan immediately
         Set&amp;lt;BeanDefinitionHolder&amp;gt; scannedBeanDefinitions =
               this.componentScanParser.parse(componentScan, sourceClass.getMetadata().getClassName());
         // Check the set of scanned definitions for any further config classes and parse recursively if needed
         // æ£€æŸ¥æ‰«æå‡ºæ¥çš„ç±»å½“ä¸­æ˜¯å¦è¿˜æœ‰ Configuration
         for (BeanDefinitionHolder holder : scannedBeanDefinitions) {
            BeanDefinition bdCand = holder.getBeanDefinition().getOriginatingBeanDefinition();
            if (bdCand == null) {
               bdCand = holder.getBeanDefinition();
            }
            if (ConfigurationClassUtils.checkConfigurationClassCandidate(bdCand, this.metadataReaderFactory)) {
               parse(bdCand.getBeanClassName(), holder.getBeanName());
            }
         }
      }
   }
   // Process any @Import annotations
   // å¤„ç† @Import
   processImports(configClass, sourceClass, getImports(sourceClass), true);
   // Process any @ImportResource annotations
   AnnotationAttributes importResource =
         AnnotationConfigUtils.attributesFor(sourceClass.getMetadata(), ImportResource.class);
   if (importResource != null) {
      String[] resources = importResource.getStringArray(&amp;quot;locations&amp;quot;);
      Class&amp;lt;? extends BeanDefinitionReader&amp;gt; readerClass = importResource.getClass(&amp;quot;reader&amp;quot;);
      for (String resource : resources) {
         String resolvedResource = this.environment.resolveRequiredPlaceholders(resource);
         configClass.addImportedResource(resolvedResource, readerClass);
      }
   }
   // Process individual @Bean methods
   Set&amp;lt;MethodMetadata&amp;gt; beanMethods = retrieveBeanMethodMetadata(sourceClass);
   for (MethodMetadata methodMetadata : beanMethods) {
      configClass.addBeanMethod(new BeanMethod(methodMetadata, configClass));
   }
   // Process default methods on interfaces
   processInterfaces(configClass, sourceClass);
   // Process superclass, if any
   if (sourceClass.getMetadata().hasSuperClass()) {
      String superclass = sourceClass.getMetadata().getSuperClassName();
      if (superclass != null &amp;amp;&amp;amp; !superclass.startsWith(&amp;quot;java&amp;quot;) &amp;amp;&amp;amp;
            !this.knownSuperclasses.containsKey(superclass)) {
         this.knownSuperclasses.put(superclass, configClass);
         // Superclass found, return its annotation metadata and recurse
         return sourceClass.getSuperClass();
      }
   }
   // No superclass -&amp;gt; processing is complete
   return null;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 47 è¡Œï¼Œåˆ¤æ–­æœ‰æ²¡æœ‰åŠ  Import æ ‡ç­¾&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;private Set&amp;lt;SourceClass&amp;gt; getImports(SourceClass sourceClass) throws IOException {
   Set&amp;lt;SourceClass&amp;gt; imports = new LinkedHashSet&amp;lt;&amp;gt;();
   Set&amp;lt;SourceClass&amp;gt; visited = new LinkedHashSet&amp;lt;&amp;gt;();
   collectImports(sourceClass, imports, visited);
   return imports;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;@Import æ³¨è§£ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;@Import(IndexDao.class)ã€&lt;/li&gt;
&lt;li&gt;@Import(ImportSelector)ã€&lt;/li&gt;
&lt;li&gt;@Import(ImportBeanDefinitionRegistrar)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åŒæ ·çš„ä¸Šè¿°ä»£ç ç¬¬ 47 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;private void processImports(ConfigurationClass configClass, SourceClass currentSourceClass,
      Collection&amp;lt;SourceClass&amp;gt; importCandidates, boolean checkForCircularImports) {
   // å¦‚æœæ²¡æœ‰åŠ @Importï¼Œç›´æ¥è¿”å›
   if (importCandidates.isEmpty()) {
      return;
   }
   if (checkForCircularImports &amp;amp;&amp;amp; isChainedImportOnStack(configClass)) {
      this.problemReporter.error(new CircularImportProblem(configClass, this.importStack));
   }
   else {
      this.importStack.push(configClass);
      try {
         for (SourceClass candidate : importCandidates) {
            // @Import(IndexDao.class)ã€@Import(ImportSelector)ã€@Import(ImportBeanDefinitionRegistrar)
            // åˆ¤æ–­æ˜¯ä¸æ˜¯ ImportSelector
            if (candidate.isAssignable(ImportSelector.class)) {
               // Candidate class is an ImportSelector -&amp;gt; delegate to it to determine imports
               Class&amp;lt;?&amp;gt; candidateClass = candidate.loadClass();
               ImportSelector selector = BeanUtils.instantiateClass(candidateClass, ImportSelector.class);
               ParserStrategyUtils.invokeAwareMethods(
                     selector, this.environment, this.resourceLoader, this.registry);
               if (this.deferredImportSelectors != null &amp;amp;&amp;amp; selector instanceof DeferredImportSelector) {
                  this.deferredImportSelectors.add(
                        new DeferredImportSelectorHolder(configClass, (DeferredImportSelector) selector));
               }
               else {
                  String[] importClassNames = selector.selectImports(currentSourceClass.getMetadata());
                  Collection&amp;lt;SourceClass&amp;gt; importSourceClasses = asSourceClasses(importClassNames);
                  processImports(configClass, currentSourceClass, importSourceClasses, false);
               }
            }
            // åˆ¤æ–­æ˜¯ä¸æ˜¯ ImportBeanDefinitionRegistrar
            else if (candidate.isAssignable(ImportBeanDefinitionRegistrar.class)) {
               // Candidate class is an ImportBeanDefinitionRegistrar -&amp;gt;
               // delegate to it to register additional bean definitions
               Class&amp;lt;?&amp;gt; candidateClass = candidate.loadClass();
               ImportBeanDefinitionRegistrar registrar =
                     BeanUtils.instantiateClass(candidateClass, ImportBeanDefinitionRegistrar.class);
               ParserStrategyUtils.invokeAwareMethods(
                     registrar, this.environment, this.resourceLoader, this.registry);
               configClass.addImportBeanDefinitionRegistrar(registrar, currentSourceClass.getMetadata());
            }
            // æ™®é€šç±»ï¼š@Import(IndexDao.class)
            else {
               // Candidate class not an ImportSelector or ImportBeanDefinitionRegistrar -&amp;gt;
               // process it as an @Configuration class
               this.importStack.registerImport(
                     currentSourceClass.getMetadata(), candidate.getMetadata().getClassName());
               processConfigurationClass(candidate.asConfigClass(configClass));
            }
         }
      }
      catch (BeanDefinitionStoreException ex) {
         throw ex;
      }
      catch (Throwable ex) {
         throw new BeanDefinitionStoreException(
               &amp;quot;Failed to process import candidates for configuration class [&amp;quot; +
               configClass.getMetadata().getClassName() + &amp;quot;]&amp;quot;, ex);
      }
      finally {
         this.importStack.pop();
      }
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ’æ‰‹ Spring ä¸­ Bean å·¥å‚çš„å»ºè®¾ï¼š&lt;br&gt;
BeanFactoryPostProcessorï¼šæŠŠå®ƒè®¾ç½®ä¸ºä¸€ä¸ª Bean çš„å±æ€§ã€‚&lt;/p&gt;
&lt;p&gt;ImportBeanDefinitionRegistrarï¼šæŠŠ map æš´éœ²å‡ºæ¥ï¼Œç”¨æˆ·å°±å¯ä»¥å‘ map ä¸­åŠ¨æ€æ·»åŠ  bean äº†ã€‚&lt;/p&gt;
&lt;h1 id=&#34;æ³¨å†Œ-bean-çš„æ–¹æ³•&#34;&gt;æ³¨å†Œ Bean çš„æ–¹æ³•&lt;/h1&gt;
&lt;h2 id=&#34;registerindexdaoimplclass&#34;&gt;register(IndexDaoImpl.class);&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;bdmap.put()&lt;/li&gt;
&lt;li&gt;éœ€è¦çš„æ˜¯ä¸€ä¸ªç±»ï¼Œä¸€ä¸ªç±»å˜æˆ BeanDefinition çš„è¿‡ç¨‹æ˜¯æ²¡åŠæ³•å‚ä¸çš„&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;scancomssm&#34;&gt;scan(&amp;quot;com.ssm&amp;quot;)&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;éœ€è¦çš„æ˜¯ä¸€ä¸ªç±»ï¼Œä¸€ä¸ªç±»å˜æˆ BeanDefinition çš„è¿‡ç¨‹æ˜¯æ²¡åŠæ³•å‚ä¸çš„&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;importbeandefinitionregistrar&#34;&gt;ImportBeanDefinitionRegistrar&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å‘ map ä¸­æ·»åŠ ä¸€ä¸ª bd&lt;/li&gt;
&lt;li&gt;å¥½å¤„ï¼šå¯ä»¥å‚ä¸ä¸€ä¸ªç±»å˜æˆ BeanDefinition çš„è¿‡ç¨‹&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;@MapperScan() çš„ä½œç”¨ï¼šæ‰«æ mapper&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Configuration
@ComponentScan(&amp;quot;com.ssm&amp;quot;)
@MapperScan(&amp;quot;com.ssm.dao&amp;quot;)
public class AppConfig{
    @Bean
    public DataSource dataSource(){
        DriverManagerDataSource dataSource = new DriverManagerDataSource();
        dataSource.setDriverClassName(&amp;quot;com.mysql.jdbc.Driver&amp;quot;);
        dataSource.setUsername(&amp;quot;root&amp;quot;);
        dataSource.setPassword(&amp;quot;123456&amp;quot;);
        dataSource.setUrl(&amp;quot;jdbc:mysql://localhost:3306/card&amp;quot;);
        return dataSource;
    }
    @Bean
    public SqlSessionFactoryBean sqlSessionFactoryBean(DataSource dataSource){
        SqlSessionFactoryBean sqlSessionFactoryBean =  new SqlSessionFactoryBean();
        sqlSessionFactoryBean.setDataSource(dataSource);
        return sqlSessionFactoryBean;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Component
public class CardService{
  @Autowired
  CardDao cardDao;
  public void list(){
    System.out.println(cardDao.list(&amp;quot;xxx&amp;quot;));
  }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public interface CardDao{
  @Select(&amp;quot;select * from card where card_number like &#39;%s{number}%&#39;&amp;quot;)
  public List&amp;lt;Map&amp;lt;Integer,String&amp;gt;&amp;gt; list(@Param(&amp;quot;number&amp;quot;) String number);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;CardDao æ˜¯ä¸€ä¸ªæ¥å£ï¼Œä¸€ä¸ªæ¥å£å¦‚ä½•å˜æˆä¸€ä¸ªå¯¹è±¡ï¼Ÿ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) {
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(AppConfig.class);
        context.getBean(CardService.class).list();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;@MapperScan() ï¼šå°†ä¸€ä¸ªæ¥å£å˜æˆä¸€ä¸ªå¯¹è±¡ï¼Œä¸”æŠŠå˜æˆçš„è¿™ä¸ªå¯¹è±¡æ”¾åˆ° Spring å®¹å™¨ä¸­ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.TYPE)
@Documented
@Import(MapperScannerRegistrar.class)
public @interface MapperScan {
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Spring åœ¨è§£æåˆ° @MapperScan åï¼Œåˆä¼šå»è§£æ @Importï¼Œç„¶åå†è§£æ MapperScannerRegistrar&lt;br&gt;
MapperScannerRegistrar ç±»ä¸­æœ‰ä¸€ä¸ª registerBeanDefinitions æ–¹æ³•ï¼Œæ­¤æ–¹æ³•æœ‰ä¸€ä¸ªå‚æ•°æ˜¯ BeanDefinitionRegistryï¼Œå³æŠŠæ³¨å†Œå™¨æš´éœ²å‡ºæ¥ï¼Œå°±å¯ä»¥å‘å®¹å™¨ä¸­æ·»åŠ  Bean äº†ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯åœ¨æ‰€æœ‰ Bean æ‰§è¡Œä¹‹å‰æ‰§è¡Œçš„ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class MapperScannerRegistrar implements ImportBeanDefinitionRegistrar, ResourceLoaderAware {
  private ResourceLoader resourceLoader;
  /**
   * {@inheritDoc}
   */
  @Override
  public void registerBeanDefinitions(AnnotationMetadata importingClassMetadata, BeanDefinitionRegistry registry) {
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;@Autowired&lt;br&gt;
CardDao cardDao;&lt;/p&gt;
&lt;p&gt;å¦‚æœæœ‰ä¸€ä¸ªç±» A extends CardServiceï¼Œä¸ä¼šå°†ç±» A è‡ªåŠ¨æ³¨å…¥ç»™ CardDaoã€‚å¦‚æœæœ‰ä¸€ä¸ªç±» A implements CardDaoï¼Œä¼šå°†ç±» A æ³¨å…¥ç»™ CardDaoã€‚&lt;/p&gt;
&lt;p&gt;æ¨¡æ‹Ÿ Mybatisï¼šåœ¨ç°åœ¨çš„åŸºç¡€ä¸Šå®Œæˆï¼šâ‘  åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼›â‘¡ å¯¹è±¡å®ç° CardDao æ¥å£ï¼› â‘¢è¿™ä¸ªå¯¹è±¡åœ¨ Spring å®¹å™¨ä¸­ã€‚&lt;/p&gt;
&lt;h3 id=&#34;è®©ä¸€ä¸ªæ¥å£å˜æˆå¯¹è±¡ä»£ç†&#34;&gt;è®©ä¸€ä¸ªæ¥å£å˜æˆå¯¹è±¡ï¼šä»£ç†&lt;/h3&gt;
&lt;p&gt;1.æµ‹è¯•ç±»&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) {
        CardDao cardDao = (CardDao) Proxy.newProxyInstance(Test.class.getClassLoader(), new Class[]{CardDao.class}, new MyInvocationHandler());
        cardDao.list(&amp;quot;1&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2.MyInvocationHandler&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class MyInvocationHandler implements InvocationHandler {
    @Override
    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
        System.out.println(&amp;quot;handler...&amp;quot;);
        return null;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3.è¾“å‡ºç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;handler...
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;4.åˆ†æï¼š&lt;br&gt;
é€šè¿‡ JDK åŠ¨æ€ä»£ç†ç”Ÿæˆä¸€ä¸ªå¯¹è±¡ï¼Œæ‰§è¡Œä»£ç†æ–¹æ³•æ—¶æ‰“å°äº† handler...&lt;/p&gt;
&lt;p&gt;ä¸Šè¿°æ­¥éª¤ 1ã€2ã€3ã€4 å·²ç»å®ç°äº†â‘  åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼›â‘¡ å¯¹è±¡å®ç° CardDao æ¥å£ï¼Œæ¥ä¸‹æ¥å®ç°æ­¥éª¤ â‘¢å°†è¿™ä¸ªå¯¹è±¡æ”¾åˆ° Spring å®¹å™¨ä¸­&lt;/p&gt;
&lt;h3 id=&#34;å°†å¯¹è±¡æ”¾åˆ°-spring-å®¹å™¨ä¸­&#34;&gt;å°†å¯¹è±¡æ”¾åˆ° Spring å®¹å™¨ä¸­&lt;/h3&gt;
&lt;h4 id=&#34;æ–¹æ³•ä¸€å®ç°-beanfactorypostprocessor-æ¥å£&#34;&gt;æ–¹æ³•ä¸€ï¼šå®ç° BeanFactoryPostProcessor æ¥å£&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// å¯¹ Bean å·¥å‚è¿›è¡Œæ’æ‰‹ï¼Œåªèƒ½å¯¹ Bean å·¥å‚è¿›è¡Œåˆå§‹åŒ–ï¼Œä¸èƒ½å°†å¯¹è±¡æ”¾å…¥åˆ° map ä¸­ï¼Œæ²¡æœ‰å¯¹åº”API
public class MyBeanFactoryPostProcessor implements BeanFactoryPostProcessor {
    @Override
    public void postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory) throws BeansException {
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;æ–¹æ³•äºŒå®ç°-importselector-æ¥å£&#34;&gt;æ–¹æ³•äºŒï¼šå®ç° ImportSelectorÂ  æ¥å£&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Configuration
@ComponentScan(&amp;quot;com.ssm&amp;quot;)
@MapperScan(&amp;quot;com.ssm&amp;quot;)
// Spring æŠŠ MyImportSelect ç±»ä¸­ invoke æ–¹æ³•è¿”å›çš„å­—ç¬¦ä¸²æ•°ç»„ç±»å new å‡ºå¯¹è±¡æ”¾åˆ° Spring å·¥å‚ä¸­
@Import(MyImportSelect.class) 
public class AppConfig{
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class MyImportSelect implements ImportSelector {
    @Override
    public String[] selectImports(AnnotationMetadata importingClassMetadata) {
        // å› ä¸ºæ˜¯è¦å°†ä»£ç†å¯¹è±¡æ”¾åˆ°Springå·¥å‚ä¸­ï¼Œä½†æ˜¯è¿™é‡Œå¾—ä¸åˆ°ä»£ç†å¯¹è±¡çš„ç±»å
        return new String[]{CardDaoProxy.class.getSimpleName()};
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¿…é¡»å…ˆäº§ç”Ÿä»£ç†å¯¹è±¡å‡ºæ¥ï¼Œç„¶åå†æ¥æ‰§è¡Œï¼šSpring æ‰«æ @Import æ³¨è§£ï¼Œå°† MyImportSelect ç±»ä¸­ invoke æ–¹æ³•è¿”å›çš„å­—ç¬¦ä¸²æ•°ç»„ç±»å new å‡ºå¯¹è±¡æ”¾åˆ° Spring å·¥å‚ä¸­ã€‚&lt;/p&gt;
&lt;h4 id=&#34;æ–¹æ³•ä¸‰å®ç°-importbeandefinitionregistrar-æ¥å£&#34;&gt;æ–¹æ³•ä¸‰ï¼šå®ç° ImportBeanDefinitionRegistrarÂ  æ¥å£&lt;/h4&gt;
&lt;p&gt;1ã€å®ç° ImportBeanDefinitionRegistrarÂ Â æ¥å£ï¼šåˆ›å»ºä»£ç†å¯¹è±¡ï¼Œå¹¶æ·»åŠ åˆ° Spring å®¹å™¨ä¸­&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class MyImportBeanDefinitionRegistrar implements ImportBeanDefinitionRegistrar {
    @Override
    public void registerBeanDefinitions(AnnotationMetadata importingClassMetadata, BeanDefinitionRegistry registry) {
        // 1.å¾—åˆ° BeanDefinition
            // æ‰«ææ‰€æœ‰æ¥å£ï¼šæ‰«æ com.ssm.dao ä¸‹æ‰€æœ‰æ¥å£ã€‚è¿™é‡Œä¸ºäº†æ–¹ä¾¿å†™æ­»ï¼Œä¸æ¨¡æ‹ŸåŠ¨æ€äº†
        // carDaoï¼šä»£ç†å¯¹è±¡
        CardDao cardDao = (CardDao) Proxy.newProxyInstance(Test.class.getClassLoader(), new Class[]{CardDao.class}, new MyInvocationHandler());
        cardDao.list(&amp;quot;2&amp;quot;);
        BeanDefinitionBuilder builder = BeanDefinitionBuilder.genericBeanDefinition(cardDao.getClass());
        GenericBeanDefinition beanDefinition = (GenericBeanDefinition) builder.getBeanDefinition();
        registry.registerBeanDefinition(&amp;quot;cardDao&amp;quot;,beanDefinition);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€é…ç½®ç±»æ‰«æ MyImportBeanDefinitionRegistrar&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Configuration
@ComponentScan(&amp;quot;com.ssm&amp;quot;)
@MapperScan(&amp;quot;com.ssm&amp;quot;)
@Import(MyImportBeanDefinitionRegistrar.class)
public class AppConfig{
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3ã€æµ‹è¯•ç±»ï¼šåˆå§‹åŒ– Spring å®¹å™¨&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) {
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(AppConfig.class);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;5ã€æµ‹è¯•ç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;handler...
Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &#39;cardDao&#39;: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type &#39;java.lang.reflect.InvocationHandler&#39; available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;6ã€åˆ†æ&lt;br&gt;
ä»£ç†å¯¹è±¡çš„ä»£ç†æ–¹æ³•æ‰§è¡Œäº†ï¼ˆè¯æ˜ cardDao.list(&amp;quot;2&amp;quot;) æ‰§è¡Œåˆ°äº†ï¼‰ï¼Œä½†æ˜¯ä»£ç†å¯¹è±¡æ³¨å…¥ä¸è¿›æ¥ï¼Œå› ä¸º Spring æ²¡æœ‰åŠæ³•è¿™æ ·å¤„ç†ä¸€ä¸ªç±»ï¼Œè¿™ä¸ª dao ä¸­çš„æŸäº›å±æ€§ Spring æ²¡æœ‰æ³¨å…¥è¿›æ¥ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class MyInvocationHandler implements InvocationHandler {
    @Override
    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
        System.out.println(&amp;quot;proxy...&amp;quot;);
        return null;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;7ã€æ¥å£ä¸èƒ½å®ä¾‹åŒ–&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class MyImportBeanDefinitionRegistrar implements ImportBeanDefinitionRegistrar {
    @Override
    public void registerBeanDefinitions(AnnotationMetadata importingClassMetadata, BeanDefinitionRegistry registry) {
        // å¾—åˆ° BeanDefinition(æ‰«ææ‰€æœ‰æ¥å£ï¼šæ‰«æ com.ssm.dao ä¸‹æ‰€æœ‰æ¥å£ã€‚è¿™é‡Œä¸ºäº†æ–¹ä¾¿å†™æ­»ï¼Œä¸æ¨¡æ‹ŸåŠ¨æ€äº†)
        BeanDefinitionBuilder builder = BeanDefinitionBuilder.genericBeanDefinition(CardDao.class);
        // å¾—åˆ° BeanDefinitionï¼ŒBeanDefinition æœ‰ä¸€ä¸ªå±æ€§ beanClass è¡¨ç¤ºç±»å‹ CardDao.class
        GenericBeanDefinition beanDefinition = (GenericBeanDefinition) builder.getBeanDefinition();
        registry.registerBeanDefinition(&amp;quot;cardDao&amp;quot;,beanDefinition);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.ssm.dao.CardDao]: Specified class is an interface
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ ¹æ® beanName=&amp;quot;cardDao&amp;quot; å–å‡º BeanDefinitionï¼Œå½“æ‰§è¡Œå®Œä¸Šè¿°ç¬¬ 5 è¡Œä»£ç åï¼Œå–å‡ºçš„ BeanDefinition ç±»å‹ä¸º CardDao æ¥å£ï¼Œæ¥å£ä¸èƒ½å®ä¾‹åŒ–ã€‚&lt;br&gt;
æ‰€ä»¥éœ€è¦å°†ä¸€ä¸ªä»£ç†å¯¹è±¡æ”¾å…¥ map ä¸­ï¼Œ{ beanName=&amp;quot;dao&amp;quot;, BeanDefinition={beanClass=$Proxy01.class; ...} }&lt;/p&gt;
&lt;p&gt;8ã€å¼•å…¥ FactoryBean&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class MyImportBeanDefinitionRegistrar implements ImportBeanDefinitionRegistrar {
    @Override
    public void registerBeanDefinitions(AnnotationMetadata importingClassMetadata, BeanDefinitionRegistry registry) {
        // å¾—åˆ° BeanDefinition(æ‰«ææ‰€æœ‰æ¥å£ï¼šæ‰«æ com.ssm.dao ä¸‹æ‰€æœ‰æ¥å£ã€‚è¿™é‡Œä¸ºäº†æ–¹ä¾¿å†™æ­»ï¼Œä¸æ¨¡æ‹ŸåŠ¨æ€äº†)
        BeanDefinitionBuilder builder = BeanDefinitionBuilder.genericBeanDefinition(CardDao.class);
        // å¾—åˆ° BeanDefinitionï¼ŒBeanDefinition æœ‰ä¸€ä¸ªå±æ€§ beanClass è¡¨ç¤ºç±»å‹ CardDao
        GenericBeanDefinition beanDefinition = (GenericBeanDefinition) builder.getBeanDefinition();
        // ç»™ BeanDefinition æ·»åŠ æ„é€ æ–¹æ³•ï¼Œå› ä¸º public MyFactoryBean(Class clazz) { æ„é€ æ–¹æ³•æœ‰å‚æ•°
        beanDefinition.getConstructorArgumentValues().addGenericArgumentValue(&amp;quot;com.ssm.dao.CardDao&amp;quot;);
        // è®¾ç½® BeanDefinition çš„ beanClass ä¸ºä»£ç†å¯¹è±¡
        beanDefinition.setBeanClass(MyFactoryBean.class);
        registry.registerBeanDefinition(&amp;quot;cardDao&amp;quot;,beanDefinition);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœç±»å®ç°äº† FactoryBeanï¼Œé‚£ä¹ˆ Spring å®¹å™¨å½“ä¸­å­˜åœ¨ä¸¤ä¸ªå¯¹è±¡ï¼Œä¸€ä¸ªæ˜¯ getObject() æ–¹æ³•è¿”å›çš„ä»£ç†å¯¹è±¡ï¼ˆname=&amp;quot;myFactoryBean &amp;quot;ï¼‰ï¼›è¿˜æœ‰ä¸€ä¸ªæ˜¯å½“å‰å¯¹è±¡ MyFactoryBeanï¼ˆname=&amp;amp;myFactoryBean ï¼‰ ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class MyFactoryBean implements FactoryBean, InvocationHandler {
    Class clazz;
    public MyFactoryBean(Class clazz) {
        this.clazz = clazz;
    }
    @Override
    public Object getObject() throws Exception {
        Class[] clazzs = new Class[]{clazz};
        Object proxy = Proxy.newProxyInstance(this.getClass().getClassLoader(),clazzs,this);
        return proxy;
    }
    @Override
    public Class&amp;lt;?&amp;gt; getObjectType() {
        return clazz;
    }
    @Override
    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
        // å¾—åˆ°ä»£ç†å¯¹è±¡çš„æ¥å£ï¼Œé€šè¿‡åå­—å»æ‹¿æ–¹æ³•
        Method method1 = proxy.getClass().getInterfaces()[0].getMethod(method.getName(), String.class);
        // æ‹¿åˆ°è¿™ä¸ªæ–¹æ³•çš„æ³¨è§£
        Select select = method1.getDeclaredAnnotation(Select.class);
        System.out.println(String.valueOf(select.value()[0]));
        System.out.println(&amp;quot;proxy&amp;quot;);
        return null;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è‡ªå®šä¹‰æ³¨è§£ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Retention(RetentionPolicy.RUNTIME)
@Import(MyImportBeanDefinitionRegistrar.class)
public @interface LuBanScan {
    String value();
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é…ç½®ç±»ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Configuration
@ComponentScan(&amp;quot;com.ssm&amp;quot;)
@LuBanScan(&amp;quot;com.ssm&amp;quot;)
@Import(MyImportBeanDefinitionRegistrar.class)
public class AppConfig{
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) {
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(AppConfig.class);
        CardDao cardDao = (CardDao) context.getBean(&amp;quot;cardDao&amp;quot;);
        cardDao.list(&amp;quot;2&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æµ‹è¯•ç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;select * from t1 where a=#{number}
proxy
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;mybatis&#34;&gt;MyBatis&lt;/h1&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;bean id=&amp;quot;userMapper&amp;quot; class=&amp;quot;org.mybatis.spring.mapper.MapperFactoryBean&amp;quot;&amp;gt;
  &amp;lt;property name=&amp;quot;mapperInterface&amp;quot; value=&amp;quot;org.mybatis.spring.sample.mapper.UserMapper&amp;quot; /&amp;gt;
  &amp;lt;property name=&amp;quot;sqlSessionFactory&amp;quot; ref=&amp;quot;sqlSessionFactory&amp;quot; /&amp;gt;
&amp;lt;/bean&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœä¸æƒ³ä½¿ç”¨ @MapperScanï¼Œé‡‡ç”¨ä¸Šè¿°ä»£ç åŒæ ·å¯ä»¥å®Œæˆæ‰«æ mapper çš„åŠŸèƒ½ã€‚ä¸Šè¿°ä»£ç ä¸æ˜¯å°† UserMapper æ³¨å†Œç»™ MapperFactoryBeanã€‚&lt;br&gt;
æ­£ç¡®å«ä¹‰ï¼šMapperFactoryBean å°±æ˜¯å‰é¢æ‰‹åŠ¨æ¨¡æ‹Ÿçš„ MyFactoryBeanï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class MyFactoryBean implements FactoryBean, InvocationHandler {
    Class clazz;
    public MyFactoryBean(Class clazz) {
        this.clazz = clazz;
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°çš„ xml ä»£ç å«ä¹‰ï¼šå°† UserMapper ä½œä¸º Class å‚æ•°ä¼ é€’ç»™ MapperFactoryBeanï¼ŒMapperFactoryBean å¾—åˆ°æ¥å£åï¼Œå†…éƒ¨åŠ¨æ€ç”Ÿæˆä»£ç†å¯¹è±¡ã€‚&lt;br&gt;
Mybatis æºç ï¼šMapperFactoryBean å†…éƒ¨åŒæ ·æœ‰ä¸€ä¸ª Classï¼Œæ„é€ æ–¹æ³• MapperFactoryBean(Class&lt;T&gt; mapperInterface)ï¼Œæ˜¯ä¸æ˜¯ä¸æˆ‘ä»¬æ¨¡æ‹Ÿçš„ MyFactoryBeanÂ å‡ ä¹ä¸€æ ·å‘¢ï¼Ÿ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class MapperFactoryBean&amp;lt;T&amp;gt; extends SqlSessionDaoSupport implements FactoryBean&amp;lt;T&amp;gt; {
  private Class&amp;lt;T&amp;gt; mapperInterface;
  private boolean addToConfig = true;
  public MapperFactoryBean() {
    //intentionally empty 
  }
  
  public MapperFactoryBean(Class&amp;lt;T&amp;gt; mapperInterface) {
    this.mapperInterface = mapperInterface;
  }
&lt;/code&gt;&lt;/pre&gt;
">Springç³»åˆ—ï¼ˆå…«ï¼‰Springæºç è§£æ</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/spring-xi-lie-qi-spring-yuan-ma-jie-xi/"" data-c="
          &lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
   public static void main(String[] args) {
      // æŠŠ Spring æ‰€æœ‰å‰æç¯å¢ƒå‡†å¤‡å¥½
      // 1.å‡†å¤‡å·¥å‚=DefaultListableBeanFactory
      // å®ä¾‹åŒ–ä¸€ä¸ª bdReader å’Œä¸€ä¸ª scanner
      AnnotationConfigApplicationContext context =
            new AnnotationConfigApplicationContext();
      // æŠŠä¸€ä¸ª class è½¬æˆ bdï¼Œæœ€å put åˆ° map
      // map ä½ç½® DefaultListableBeanFactory çš„ beanDefinitionMap
      context.register(AppConfig.class);
      // åˆå§‹åŒ– Spring çš„ç¯å¢ƒ
      context.refresh();
      IndexDao indexDao = context.getBean(IndexDaoImpl.class);
      indexDao.query();
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;1new-annotationconfigapplicationcontext&#34;&gt;1.new AnnotationConfigApplicationContext();&lt;/h1&gt;
&lt;p&gt;ç¬¬ 6 è¡Œä»£ç ï¼Œnew AnnotationConfigApplicationContext(); æ—¶ï¼Œç”±äº AnnotationConfigApplicationContext æœ‰çˆ¶ç±»&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class AnnotationConfigApplicationContext extends GenericApplicationContext implements AnnotationConfigRegistry {
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;11-genericapplicationcontext&#34;&gt;1.1 GenericApplicationContext()&lt;/h2&gt;
&lt;p&gt;æ‰€ä»¥ä¼šå…ˆè°ƒç”¨çˆ¶ç±» GenericApplicationContextÂ  çš„æ„é€ æ–¹æ³•ï¼ˆä¸Šä¸€ç¯‡æ–‡ç« ä¸­æåˆ°è¿‡ï¼‰ï¼Œä»Šå¤©å°±ä»å®ƒçˆ¶ç±»çš„æ„é€ æ–¹æ³•è¯´èµ·ï¼šå®ä¾‹åŒ–äº†ä¸€ä¸ª Bean å·¥å‚ï¼Œ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
 * Create a new GenericApplicationContext.
 * @see #registerBeanDefinition
 * @see #refresh
 */
public GenericApplicationContext() {
   // å®ä¾‹åŒ–ä¸€ä¸ª Bean å·¥å‚
   this.beanFactory = new DefaultListableBeanFactory();
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;111-defaultlistablebeanfactory&#34;&gt;1.1.1 DefaultListableBeanFactory&lt;/h3&gt;
&lt;p&gt;è¿™ä¸ª Bean å·¥å‚å†…åˆ°åº•æœ‰äº›ä»€ä¹ˆå±æ€§å‘¢ï¼Œè¿™é‡Œåˆ—ä¸¾å‡ºå‡ ä¸ªå¸¸ç”¨é‡è¦å±æ€§ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/** ä»åºåˆ—åŒ–IDæ˜ å°„åˆ°å·¥å‚å®ä¾‹ */
private static final Map&amp;lt;String, Reference&amp;lt;DefaultListableBeanFactory&amp;gt;&amp;gt; serializableFactories =
      new ConcurrentHashMap&amp;lt;&amp;gt;(8);
/** è¯¥å·¥å‚çš„å¯é€‰IDï¼Œç”¨äºåºåˆ—åŒ– */
// å¯ä»¥ç†è§£ä¸ºèº«ä»½è¯å·
@Nullable
private String serializationId;
// å·¥å‚ä¸­èƒ½å¤Ÿå¤„ç†ç±»çš„å®ä¾‹åŒ–é¡ºåº
@Nullable
private Comparator&amp;lt;Object&amp;gt; dependencyComparator;
// map&amp;lt;beanName,beanDefinition&amp;gt;
private final Map&amp;lt;String, BeanDefinition&amp;gt; beanDefinitionMap = new ConcurrentHashMap&amp;lt;&amp;gt;(256);
/** List of bean definition names, in registration order */
private volatile List&amp;lt;String&amp;gt; beanDefinitionNames = new ArrayList&amp;lt;&amp;gt;(256);
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/bean%E5%B7%A5%E5%8E%82.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;12-annotationconfigapplicationcontext&#34;&gt;1.2 AnnotationConfigApplicationContext()&lt;/h2&gt;
&lt;p&gt;è°ƒç”¨å®Œçˆ¶ç±»æ„é€ æ–¹æ³•åï¼Œè°ƒç”¨æœ¬ç±»æ„é€ æ–¹æ³•ï¼Œå³&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public AnnotationConfigApplicationContext() {
   /**
    * çˆ¶ç±»çš„æ„é€ æ–¹æ³• super()
    *åˆ›å»ºä¸€ä¸ªè¯»å–æ³¨è§£çš„ Bean å®šä¹‰è¯»å–å™¨ï¼šreader èƒ½è¯»å–è¢«åŠ äº†æ³¨è§£çš„ç±»
    * ä»€ä¹ˆæ˜¯ bean å®šä¹‰ï¼ŸBeanDefinition
    */
   this.reader = new AnnotatedBeanDefinitionReader(this);
   // å®šä¹‰æ‰«æå™¨
   this.scanner = new ClassPathBeanDefinitionScanner(this);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;121-thisreader-new-annotatedbeandefinitionreaderthis&#34;&gt;1.2.1 this.reader = new AnnotatedBeanDefinitionReader(this);&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬æ¥çœ‹ä¸Šè¿°ä»£ç ç¬¬ 7 è¡Œçš„å‚æ•°ä¸º thisï¼ˆAnnotatedBeanDefinitionReaderï¼‰ï¼Œç‚¹è¿›è¿™ä¸ªæ–¹æ³•çœ‹åˆ°å‚æ•°ç±»å‹ä¸º BeanDefinitionRegistryï¼Œä¹Ÿå°±æ˜¯æ„å‘³ç€ AnnotatedBeanDefinitionReader = BeanDefinitionRegistry&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public AnnotatedBeanDefinitionReader(BeanDefinitionRegistry registry) {
   this(registry, getOrCreateEnvironment(registry));
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;1211-annotatedbeandefinitionreaderbeandefinitionregistry-registry-environment-environment&#34;&gt;1.2.1.1 AnnotatedBeanDefinitionReader(BeanDefinitionRegistry registry, Environment environment)&lt;/h4&gt;
&lt;p&gt;è¿™é‡Œè°ƒç”¨äº†ä¸€ä¸ªé‡è½½çš„æ„é€ æ–¹æ³•&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public AnnotatedBeanDefinitionReader(BeanDefinitionRegistry registry, Environment environment) {
   Assert.notNull(registry, &amp;quot;BeanDefinitionRegistry must not be null&amp;quot;);
   Assert.notNull(environment, &amp;quot;Environment must not be null&amp;quot;);
   this.registry = registry;
   this.conditionEvaluator = new ConditionEvaluator(registry, environment, null);
   AnnotationConfigUtils.registerAnnotationConfigProcessors(this.registry);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;çœ‹ç¬¬ 6 è¡Œç‚¹è¿›å»&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public static void registerAnnotationConfigProcessors(BeanDefinitionRegistry registry) {
   registerAnnotationConfigProcessors(registry, null);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åœ¨ç‚¹è¿›å»ç¬¬ 2 è¡Œè¿™ä¸ªæ–¹æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public static Set&amp;lt;BeanDefinitionHolder&amp;gt; registerAnnotationConfigProcessors(
      BeanDefinitionRegistry registry, @Nullable Object source) {
   // é€šè¿‡ registry å¾—åˆ° Bean å·¥å‚
   DefaultListableBeanFactory beanFactory = unwrapDefaultListableBeanFactory(registry);
   if (beanFactory != null) {
      // AnnotationAwareOrderComparator ä¸»è¦èƒ½è§£æ @Order æ³¨è§£å’Œ @Priority
      if (!(beanFactory.getDependencyComparator() instanceof AnnotationAwareOrderComparator)) {
         // ContextAnnotationAutowireCandidateResolver æä¾›å¤„ç†å™¨å»¶è¿ŸåŠ è½½çš„åŠŸèƒ½
         beanFactory.setDependencyComparator(AnnotationAwareOrderComparator.INSTANCE);
      }
      if (!(beanFactory.getAutowireCandidateResolver() instanceof ContextAnnotationAutowireCandidateResolver)) {
         beanFactory.setAutowireCandidateResolver(new ContextAnnotationAutowireCandidateResolver());
      }
   }
   Set&amp;lt;BeanDefinitionHolder&amp;gt; beanDefs = new LinkedHashSet&amp;lt;&amp;gt;(8);
   // BeanDefinitionçš„æ³¨å†Œï¼Œè¿™é‡Œå¾ˆé‡è¦ï¼Œéœ€è¦ç†è§£æ³¨å†Œæ¯ä¸ª bean çš„ç±»å‹
   if (!registry.containsBeanDefinition(CONFIGURATION_ANNOTATION_PROCESSOR_BEAN_NAME)) {
      // éœ€è¦æ³¨æ„çš„æ˜¯ ConfigurationClassPostProcessor çš„ç±»å‹æ˜¯ BeanDefinitionRegistryPostProcessor
      // è€Œ BeanDefinitionRegistryPostProcessor æœ€ç»ˆå®ç° BeanFactoryPostProcess
      RootBeanDefinition def = new RootBeanDefinition(ConfigurationClassPostProcessor.class);
      def.setSource(source);
      beanDefs.add(registerPostProcessor(registry, def, CONFIGURATION_ANNOTATION_PROCESSOR_BEAN_NAME));
   }
   if (!registry.containsBeanDefinition(AUTOWIRED_ANNOTATION_PROCESSOR_BEAN_NAME)) {
      RootBeanDefinition def = new RootBeanDefinition(AutowiredAnnotationBeanPostProcessor.class);
      def.setSource(source);
      beanDefs.add(registerPostProcessor(registry, def, AUTOWIRED_ANNOTATION_PROCESSOR_BEAN_NAME));
   }
   if (!registry.containsBeanDefinition(REQUIRED_ANNOTATION_PROCESSOR_BEAN_NAME)) {
      RootBeanDefinition def = new RootBeanDefinition(RequiredAnnotationBeanPostProcessor.class);
      def.setSource(source);
      beanDefs.add(registerPostProcessor(registry, def, REQUIRED_ANNOTATION_PROCESSOR_BEAN_NAME));
   }
   // Check for JSR-250 support, and if present add the CommonAnnotationBeanPostProcessor.
   if (jsr250Present &amp;amp;&amp;amp; !registry.containsBeanDefinition(COMMON_ANNOTATION_PROCESSOR_BEAN_NAME)) {
      RootBeanDefinition def = new RootBeanDefinition(CommonAnnotationBeanPostProcessor.class);
      def.setSource(source);
      beanDefs.add(registerPostProcessor(registry, def, COMMON_ANNOTATION_PROCESSOR_BEAN_NAME));
   }
   // Check for JPA support, and if present add the PersistenceAnnotationBeanPostProcessor.
   if (jpaPresent &amp;amp;&amp;amp; !registry.containsBeanDefinition(PERSISTENCE_ANNOTATION_PROCESSOR_BEAN_NAME)) {
      RootBeanDefinition def = new RootBeanDefinition();
      try {
         def.setBeanClass(ClassUtils.forName(PERSISTENCE_ANNOTATION_PROCESSOR_CLASS_NAME,
               AnnotationConfigUtils.class.getClassLoader()));
      }
      catch (ClassNotFoundException ex) {
         throw new IllegalStateException(
               &amp;quot;Cannot load optional framework class: &amp;quot; + PERSISTENCE_ANNOTATION_PROCESSOR_CLASS_NAME, ex);
      }
      def.setSource(source);
      beanDefs.add(registerPostProcessor(registry, def, PERSISTENCE_ANNOTATION_PROCESSOR_BEAN_NAME));
   }
   
   if (!registry.containsBeanDefinition(EVENT_LISTENER_PROCESSOR_BEAN_NAME)) {
      RootBeanDefinition def = new RootBeanDefinition(EventListenerMethodProcessor.class);
      def.setSource(source);
      beanDefs.add(registerPostProcessor(registry, def, EVENT_LISTENER_PROCESSOR_BEAN_NAME));
   }
   if (!registry.containsBeanDefinition(EVENT_LISTENER_FACTORY_BEAN_NAME)) {
      RootBeanDefinition def = new RootBeanDefinition(DefaultEventListenerFactory.class);
      def.setSource(source);
      beanDefs.add(registerPostProcessor(registry, def, EVENT_LISTENER_FACTORY_BEAN_NAME));
   }
   return beanDefs;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 24 è¡Œ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;beanDefs.add(registerPostProcessor(registry, def, CONFIGURATION_ANNOTATION_PROCESSOR_BEAN_NAME));
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;private static BeanDefinitionHolder registerPostProcessor(
      BeanDefinitionRegistry registry, RootBeanDefinition definition, String beanName) {
   definition.setRole(BeanDefinition.ROLE_INFRASTRUCTURE);
   registry.registerBeanDefinition(beanName, definition);
   return new BeanDefinitionHolder(definition, beanName);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ç¬¬ 6 è¡Œä»£ç ï¼šé€šè¿‡ registry çš„ registerBeanDefinition æ–¹æ³•å°† &amp;lt;beanName,definition&amp;gt; æ”¾åˆ° map ä¸­ï¼š&lt;/p&gt;
&lt;h3 id=&#34;122-thisscanner-new-classpathbeandefinitionscannerthis&#34;&gt;1.2.2 this.scanner = new ClassPathBeanDefinitionScanner(this);&lt;/h3&gt;
&lt;p&gt;ç»§ç»­çœ‹æœ¬ç±»æ„é€ æ–¹æ³•çš„ç¬¬ 9 è¡Œï¼Œèƒ½å¤Ÿæ‰«æä¸€ä¸ªç±»ï¼Œå¹¶ä¸”è½¬æ¢æˆ BeanDefinition&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public AnnotationConfigApplicationContext() {
   /**
    * çˆ¶ç±»çš„æ„é€ æ–¹æ³• super()
    *åˆ›å»ºä¸€ä¸ªè¯»å–æ³¨è§£çš„ Bean å®šä¹‰è¯»å–å™¨ï¼šreader èƒ½è¯»å–è¢«åŠ äº†æ³¨è§£çš„ç±»
    * ä»€ä¹ˆæ˜¯ bean å®šä¹‰ï¼ŸBeanDefinition
    */
   this.reader = new AnnotatedBeanDefinitionReader(this);
   // å®šä¹‰æ‰«æå™¨
   this.scanner = new ClassPathBeanDefinitionScanner(this);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;2contextregisterappconfigclass&#34;&gt;2.context.register(AppConfig.class);&lt;/h1&gt;
&lt;p&gt;æ¥ä¸‹æ¥çœ‹ Test æµ‹è¯•ç±»çš„ç¬¬ 10 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;context.register(AppConfig.class);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç‚¹è¿› register æ–¹æ³•å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public void register(Class&amp;lt;?&amp;gt;... annotatedClasses) {
   Assert.notEmpty(annotatedClasses, &amp;quot;At least one annotated class must be specified&amp;quot;);
   this.reader.register(annotatedClasses);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç¬¬ 3 è¡Œï¼šè°ƒç”¨ reader çš„ register() æ–¹æ³•ï¼Œå°†  AppConfig.class è¿™ä¸ªæ™®é€šçš„ç±»äº¤ç»™ readerï¼Œç”± reader å°†å®ƒè½¬åŒ–æˆ BeanDefinitionã€‚é‚£ä¹ˆè¿™ä¸ªå…·ä½“çš„ register æ–¹æ³•æ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿç‚¹è¿›å»è¿™ä¸ª register() æ–¹æ³•&lt;/p&gt;
&lt;h2 id=&#34;21-doregisterbean&#34;&gt;2.1 doRegisterBean&lt;/h2&gt;
&lt;p&gt;(ä¸­é—´çœç•¥ä¸¤æ­¥ä»£ç )æœ€ç»ˆä¼šåˆ° doRegisterBean æ–¹æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;&amp;lt;T&amp;gt; void doRegisterBean(Class&amp;lt;T&amp;gt; annotatedClass, @Nullable Supplier&amp;lt;T&amp;gt; instanceSupplier, @Nullable String name,
      @Nullable Class&amp;lt;? extends Annotation&amp;gt;[] qualifiers, BeanDefinitionCustomizer... definitionCustomizers) {
   /**
    *
    * AnnotatedGenericBeanDefinitionï¼šè¢«æ³¨è§£çš„ BeanDefinition(æè¿°Bean)
    * å°† bean æ”¾å…¥ map ä¸­ï¼Œbean çš„ name æ˜¯ map çš„ keyï¼Œ
    * map ä¸­çš„ value ä¸º AnnotatedGenericBeanDefinition å¯¹è±¡
    */
   AnnotatedGenericBeanDefinition abd = new AnnotatedGenericBeanDefinition(annotatedClass);
   /**
    * åˆ¤æ–­è¿™ä¸ªç±»æ˜¯å¦éœ€è¦è·³è¿‡è§£æ
    * é€šè¿‡ä»£ç å¯ä»¥çŸ¥é“ Spring åˆ¤æ–­æ˜¯å¦è·³è¿‡è§£æï¼Œä¸»è¦åˆ¤æ–­æœ‰æ²¡æœ‰åŠ æ³¨è§£
    */
   // è¿™ä¸ªç±»å¦‚æœæ²¡æœ‰åŠ æ³¨è§£ï¼Œå°±ä¸éœ€è¦è§£æã€‚å› ä¸º AnnotatedGenericBeanDefinition æ˜¯ä¸ºäº†æ³¨å†Œè¢«åŠ äº†æ³¨è§£çš„ï¼›
   // å¦‚æœè¿™ä¸ªç±»æ²¡æœ‰è¢«åŠ æ³¨è§£ï¼Œå°±è·³è¿‡ä¸è§£æ
   if (this.conditionEvaluator.shouldSkip(abd.getMetadata())) {
      return;
   }
   abd.setInstanceSupplier(instanceSupplier);
   /**
    * å¾—åˆ°ç±»çš„ä½œç”¨åŸŸ
    *     å¦‚æœæ˜¯ context.register(SpringConfig.class);åˆ™ä½œç”¨åŸŸæ²¡æœ‰ä»€ä¹ˆä½œç”¨
    *     æ³¨å†Œå•ä¸ªç±»æ—¶éœ€è¦ï¼Œæ¯”å¦‚ï¼šcontext.register(IndexService.class);
    */
   ScopeMetadata scopeMetadata = this.scopeMetadataResolver.resolveScopeMetadata(abd);
   /**
    * å°†ç±»çš„ä½œç”¨åŸŸæ·»åŠ åˆ°æ•°æ®ç»“æ„ä¸­
    */
   abd.setScope(scopeMetadata.getScopeName());
   /**
    * ç”Ÿæˆç±»çš„åå­—é€šè¿‡ beanNameGenerator
    */
   String beanName = (name != null ? name : this.beanNameGenerator.generateBeanName(abd, this.registry));
   /**
    * å¤„ç†ç±»å½“ä¸­çš„å…¶ä»–é€šç”¨æ³¨è§£
    * åˆ†ææºç å¯ä»¥çŸ¥é“å®ƒä¸»è¦å¤„ç†ï¼šLazyã€DependsOnã€Primaryã€Role ç­‰æ³¨è§£
    * å¤„ç†å®Œæˆä¹‹å processCommonDefinitionAnnotation ä¸­ä¾ç„¶æ˜¯æŠŠå®ƒæ·»åŠ åˆ°æ•°æ®ç»“æ„ AnnotatedGenericBeanDefinition å½“ä¸­
    */
   AnnotationConfigUtils.processCommonDefinitionAnnotations(abd);
   /**
    * å¦‚æœåœ¨å‘å®¹å™¨æ³¨å†Œæ³¨è§£ @Beanå®šä¹‰æ—¶ï¼Œä½¿ç”¨äº†é¢å¤–çš„é™å®šç¬¦æ³¨è§£åˆ™è§£æ
    * å…³äº Qualifier å’Œ Primary ä¸»è¦æ¶‰åŠåˆ° Spring çš„è‡ªåŠ¨è£…é…
    * è¿™é‡Œéœ€è¦æ³¨æ„çš„
    *     beanName å’Œ qualifier è¿™ä¸ªå˜é‡æ—¶ Annotation ç±»å‹çš„æ•°ç»„ï¼Œé‡Œé¢ä¸ä»…ä»…æ˜¯ Qualifier æ³¨è§£
    *     ç†è®ºä¸Šé‡Œé¢å­˜çš„æ˜¯ä¸€åˆ‡æ³¨è§£ï¼Œæ‰€ä»¥å¯ä»¥çœ‹åˆ°ä¸‹é¢çš„ä»£ç  Spring å»å¾ªç¯äº†è¿™ä¸ªæ•°ç»„
    *     ç„¶åä¾æ¬¡åˆ¤æ–­æ³¨è§£å½“ä¸­æ˜¯å¦åŒ…å«äº† Primaryï¼Œæ˜¯å¦åŒ…å«äº† Lazy
    */
   if (qualifiers != null) {
      for (Class&amp;lt;? extends Annotation&amp;gt; qualifier : qualifiers) {
         if (Primary.class == qualifier) {
            abd.setPrimary(true);
         }
         else if (Lazy.class == qualifier) {
            abd.setLazyInit(true);
         }
         else {
            abd.addQualifier(new AutowireCandidateQualifier(qualifier));
         }
      }
   }
   for (BeanDefinitionCustomizer customizer : definitionCustomizers) {
      customizer.customize(abd);
   }
   /**
    * è¿™ä¸ª BeanDefinitionHolder ä¹Ÿæ˜¯ä¸€ä¸ªæ•°æ®ç»“æ„
    * BeanDefinitionHolder æ˜¯ä¸€ä¸ª mapï¼Œé‡Œé¢æ”¾äº†ä¸€ä¸ª (BeanDefinitionï¼ŒbeanName)
    */
   BeanDefinitionHolder definitionHolder = new BeanDefinitionHolder(abd, beanName);
   definitionHolder = AnnotationConfigUtils.applyScopedProxyMode(scopeMetadata, definitionHolder, this.registry);
   /**
    * æŠŠä¸Šè¿°çš„è¿™ä¸ªæ•°æ®ç»“æ„æ³¨å†Œç»™ registry
    * registry å°±æ˜¯ AnnotationConfigApplicationContext
    * AnnotationConfigApplicationContext åœ¨åˆå§‹åŒ–çš„æ—¶å€™é€šè¿‡è°ƒç”¨çˆ¶ç±»çš„æ„é€ æ–¹æ³•å®ä¾‹åŒ–äº†ä¸€ä¸ª DefaultListableBeanFactory
    * registerBeanDefinition é‡Œé¢å°±æ˜¯æŠŠ definitionHolder è¿™ä¸ªæ•°æ®ç»“æ„åŒ…å«çš„ä¿¡æ¯æ³¨å†Œåˆ° DefaultListableBeanFactory è¿™ä¸ªå·¥å‚
    */
   BeanDefinitionReaderUtils.registerBeanDefinition(definitionHolder, this.registry);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆ deoRegisterBean æ–¹æ³•ä¸­è¦è§£æä½œç”¨åŸŸã€å…¶ä»–é€šç”¨æ³¨è§£ç­‰ä¿¡æ¯ï¼Ÿ&lt;br&gt;
å› ä¸ºå¦‚æœ context.register(IndexServiceImpl.class); å‚æ•°æ˜¯ Bean æ—¶ï¼Œåˆ™éœ€è¦è·å– Bean å…·ä½“ä¿¡æ¯ç„¶åå°è£…æˆ BeanDefinitionï¼Œæ³¨å†Œè¿› map ä¸­ã€‚&lt;/p&gt;
&lt;h3 id=&#34;211-new-annotatedgenericbeandefinitionannotatedclass&#34;&gt;2.1.1 new AnnotatedGenericBeanDefinition(annotatedClass);&lt;/h3&gt;
&lt;p&gt;ä¸Šè¿°ç¬¬ 10 è¡Œä»£ç ï¼Œä½¿ç”¨ new AnnotatedGenericBeanDefinition(annotatedClass); çš„æ–¹å¼å°†ä¸€ä¸ªæ™®é€šçš„ annotatedClass(AppConfig.class) è½¬åŒ–æˆ AnnotatedGenericBeanDefinitionã€‚&lt;/p&gt;
&lt;h3 id=&#34;212-registerbeandefinitiondefinitionholder-thisregistry&#34;&gt;2.1.2 registerBeanDefinition(definitionHolder, this.registry);&lt;/h3&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 80 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;BeanDefinitionReaderUtils.registerBeanDefinition(definitionHolder, this.registry);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç‚¹è¿› registerBeanDefinition æ–¹æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public static void registerBeanDefinition(
      BeanDefinitionHolder definitionHolder, BeanDefinitionRegistry registry)
      throws BeanDefinitionStoreException {
   // Register bean definition under primary name.
   String beanName = definitionHolder.getBeanName();
   registry.registerBeanDefinition(beanName, definitionHolder.getBeanDefinition());
   // Register aliases for bean name, if any.
   String[] aliases = definitionHolder.getAliases();
   if (aliases != null) {
      for (String alias : aliases) {
         registry.registerAlias(beanName, alias);
      }
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 7 è¡Œï¼Œä½¿ç”¨ registry çš„ registerBeanDefinition æ–¹æ³•å°† &amp;lt;beanName,BeanDefinition&amp;gt;æ³¨å†Œåˆ° map ä¸­ã€‚&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/registerBeanDefinition.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/bean%E5%B7%A5%E5%8E%82_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/register_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h1 id=&#34;3contextrefresh&#34;&gt;3.context.refresh()&lt;/h1&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Override
public void refresh() throws BeansException, IllegalStateException {
   synchronized (this.startupShutdownMonitor) {
      // Prepare this context for refreshing.
      // å‡†å¤‡å·¥ä½œåŒ…æ‹¬è®¾ç½®å¯åŠ¨æ—¶é—´ã€æ˜¯å¦æ¿€æ´»æ ‡è¯†ä½ï¼Œåˆå§‹åŒ–å±æ€§æºï¼ˆproperty sourceï¼‰é…ç½®
      prepareRefresh();
      // å‘Šè¯‰å­ç±» refresh Bean å·¥å‚
      ConfigurableListableBeanFactory beanFactory = obtainFreshBeanFactory();
      // ç”¨è¿™ä¸ªä¸Šä¸‹æ–‡å‡†å¤‡ Bean å·¥å‚
      prepareBeanFactory(beanFactory);
      try {
         // Allows post-processing of the bean factory in context subclasses.
         postProcessBeanFactory(beanFactory);
         // Invoke factory processors registered as beans in the context.
         invokeBeanFactoryPostProcessors(beanFactory);
         // Register bean processors that intercept bean creation.
         registerBeanPostProcessors(beanFactory);
         // Initialize message source for this context.
         initMessageSource();
         // Initialize event multicaster for this context.
         initApplicationEventMulticaster();
         // Initialize other special beans in specific context subclasses.
         onRefresh();
         // Check for listener beans and register them.
         registerListeners();
         // Instantiate all remaining (non-lazy-init) singletons.
         finishBeanFactoryInitialization(beanFactory);
         // Last step: publish corresponding event.
         finishRefresh();
      }
      catch (BeansException ex) {
         if (logger.isWarnEnabled()) {
            logger.warn(&amp;quot;Exception encountered during context initialization - &amp;quot; +
                  &amp;quot;cancelling refresh attempt: &amp;quot; + ex);
         }
         // Destroy already created singletons to avoid dangling resources.
         destroyBeans();
         // Reset &#39;active&#39; flag.
         cancelRefresh(ex);
         // Propagate exception to caller.
         throw ex;
      }
      finally {
         // Reset common introspection caches in Spring&#39;s core, since we
         // might not ever need metadata for singleton beans anymore...
         resetCommonCaches();
      }
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;31-preparerefresh&#34;&gt;3.1 prepareRefresh();&lt;/h2&gt;
&lt;p&gt;ä¸Šè¿°ç¬¬6 è¡Œä»£ç ï¼š&lt;strong&gt;å‡†å¤‡å·¥ä½œåŒ…æ‹¬è®¾ç½®å¯åŠ¨æ—¶é—´ã€æ˜¯å¦æ¿€æ´»æ ‡è¯†ä½ï¼Œåˆå§‹åŒ–å±æ€§æºï¼ˆproperty sourceï¼‰é…ç½®&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;32-obtainfreshbeanfactory&#34;&gt;3.2 obtainFreshBeanFactory();&lt;/h2&gt;
&lt;p&gt;ä¸Šè¿°ç¬¬ 9 è¡Œä»£ç ï¼šå¾—åˆ° BeanFactoryï¼Œå› ä¸ºéœ€è¦å¯¹ BeanFactory è¿›è¡Œè®¾ç½®&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;ConfigurableListableBeanFactory beanFactory = obtainFreshBeanFactory();
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;33-preparebeanfactorybeanfactory&#34;&gt;3.3 prepareBeanFactory(beanFactory);&lt;/h2&gt;
&lt;p&gt;ä¸Šè¿°ç¬¬ 12 è¡Œä»£ç ï¼šå‡†å¤‡ Bean å·¥å‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;prepareBeanFactory(beanFactory);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç‚¹è¿›è¿™ä¸ª prepareBeanFactory æ–¹æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;protected void prepareBeanFactory(ConfigurableListableBeanFactory beanFactory) {
   // Tell the internal bean factory to use the context&#39;s class loader etc.
   beanFactory.setBeanClassLoader(getClassLoader());
   // bean è¡¨è¾¾å¼è§£æå™¨
   beanFactory.setBeanExpressionResolver(new StandardBeanExpressionResolver(beanFactory.getBeanClassLoader()));
   // æ³¨å†Œå±æ€§ç¼–è¾‘å™¨
   beanFactory.addPropertyEditorRegistrar(new ResourceEditorRegistrar(this, getEnvironment()));
   // Configure the bean factory with context callbacks.
   // æ·»åŠ ä¸€ä¸ªåç½®ç®¡ç†å™¨ï¼šApplicationContextAwareProcessor å®ç°äº† BeanPostProcessoræ¥å£ï¼šæ’æ‰‹ Bean çš„åˆ›å»ºè¿‡ç¨‹
   beanFactory.addBeanPostProcessor(new ApplicationContextAwareProcessor(this));
   beanFactory.ignoreDependencyInterface(EnvironmentAware.class);
   beanFactory.ignoreDependencyInterface(EmbeddedValueResolverAware.class);
   beanFactory.ignoreDependencyInterface(ResourceLoaderAware.class);
   beanFactory.ignoreDependencyInterface(ApplicationEventPublisherAware.class);
   beanFactory.ignoreDependencyInterface(MessageSourceAware.class);
   beanFactory.ignoreDependencyInterface(ApplicationContextAware.class);
   // BeanFactory interface not registered as resolvable type in a plain factory.
   // MessageSource registered (and found for autowiring) as a bean.
   beanFactory.registerResolvableDependency(BeanFactory.class, beanFactory);
   beanFactory.registerResolvableDependency(ResourceLoader.class, this);
   beanFactory.registerResolvableDependency(ApplicationEventPublisher.class, this);
   beanFactory.registerResolvableDependency(ApplicationContext.class, this);
   // Register early post-processor for detecting inner beans as ApplicationListeners.
   beanFactory.addBeanPostProcessor(new ApplicationListenerDetector(this));
   // Detect a LoadTimeWeaver and prepare for weaving, if found.
   if (beanFactory.containsBean(LOAD_TIME_WEAVER_BEAN_NAME)) {
      beanFactory.addBeanPostProcessor(new LoadTimeWeaverAwareProcessor(beanFactory));
      // Set a temporary ClassLoader for type matching.
      beanFactory.setTempClassLoader(new ContextTypeMatchClassLoader(beanFactory.getBeanClassLoader()));
   }
   // Register default environment beans.
   if (!beanFactory.containsLocalBean(ENVIRONMENT_BEAN_NAME)) {
      beanFactory.registerSingleton(ENVIRONMENT_BEAN_NAME, getEnvironment());
   }
   if (!beanFactory.containsLocalBean(SYSTEM_PROPERTIES_BEAN_NAME)) {
      beanFactory.registerSingleton(SYSTEM_PROPERTIES_BEAN_NAME, getEnvironment().getSystemProperties());
   }
   if (!beanFactory.containsLocalBean(SYSTEM_ENVIRONMENT_BEAN_NAME)) {
      beanFactory.registerSingleton(SYSTEM_ENVIRONMENT_BEAN_NAME, getEnvironment().getSystemEnvironment());
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 3 è¡Œï¼Œæ·»åŠ ä¸€ä¸ªç±»åŠ è½½å™¨ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;beanFactory.setBeanClassLoader(getClassLoader());
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 5 è¡Œï¼Œæ·»åŠ  bean è¡¨è¾¾å¼è§£æå™¨ï¼Œä¸ºäº†èƒ½å¤Ÿè®© BeanFactory å»è§£æ bean è¡¨è¾¾å¼&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;//bean è¡¨è¾¾å¼è§£æå™¨
beanFactory.setBeanExpressionResolver(new StandardBeanExpressionResolver(beanFactory.getBeanClassLoader()));
// æ³¨å†Œå±æ€§ç¼–è¾‘å™¨
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿° 12-17 è¡Œï¼Œæ·»åŠ äº†è‡ªåŠ¨æ³¨å…¥è¢«å¿½ç•¥çš„åˆ—è¡¨ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;  beanFactory.ignoreDependencyInterface(EnvironmentAware.class);
   beanFactory.ignoreDependencyInterface(EmbeddedValueResolverAware.class);
   beanFactory.ignoreDependencyInterface(ResourceLoaderAware.class);
   beanFactory.ignoreDependencyInterface(ApplicationEventPublisherAware.class);
   beanFactory.ignoreDependencyInterface(MessageSourceAware.class);
   beanFactory.ignoreDependencyInterface(ApplicationContextAware.class);   
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 27 è¡Œï¼Œæ·»åŠ äº†ä¸€ä¸ª ApplicationListenerDetector åç½®å¤„ç†å™¨&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;beanFactory.addBeanPostProcessor(new ApplicationListenerDetector(this));
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;331-beanfactoryaddbeanpostprocessornew-applicationcontextawareprocessorthis&#34;&gt;3.3.1 beanFactory.addBeanPostProcessor(new ApplicationContextAwareProcessor(this));&lt;/h3&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 11 è¡Œï¼Œ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// æ·»åŠ ä¸€ä¸ªåç½®ç®¡ç†å™¨ï¼šApplicationContextAwareProcessor å®ç°äº† BeanPostProcessoræ¥å£ï¼šæ’æ‰‹ Bean çš„åˆ›å»ºè¿‡ç¨‹
beanFactory.addBeanPostProcessor(new ApplicationContextAwareProcessor(this));
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç‚¹è¿›å» (new ApplicationContextAwareProcessor(this)ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public ApplicationContextAwareProcessor(ConfigurableApplicationContext applicationContext) {
   this.applicationContext = applicationContext;
   this.embeddedValueResolver = new EmbeddedValueResolver(applicationContext.getBeanFactory());
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åœ¨ç‚¹è¿›å»çœ‹ beanFactory.addBeanPostProcessor(new ApplicationContextAwareProcessor(this));&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Override
public void addBeanPostProcessor(BeanPostProcessor beanPostProcessor) {
   Assert.notNull(beanPostProcessor, &amp;quot;BeanPostProcessor must not be null&amp;quot;);
   // Remove from old position, if any
   this.beanPostProcessors.remove(beanPostProcessor);
   // Track whether it is instantiation/destruction aware
   if (beanPostProcessor instanceof InstantiationAwareBeanPostProcessor) {
      this.hasInstantiationAwareBeanPostProcessors = true;
   }
   if (beanPostProcessor instanceof DestructionAwareBeanPostProcessor) {
      this.hasDestructionAwareBeanPostProcessors = true;
   }
   // Add to end of list
   this.beanPostProcessors.add(beanPostProcessor);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿° 14 è¡Œ æåˆ°çš„ beanPostProcessorsï¼Œæ˜¯ä¸€ä¸ª List&lt;BeanPostProcessor&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/** BeanPostProcessors to apply in createBean */
private final List&amp;lt;BeanPostProcessor&amp;gt; beanPostProcessors = new CopyOnWriteArrayList&amp;lt;&amp;gt;();
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;34-postprocessbeanfactorybeanfactory&#34;&gt;3.4 postProcessBeanFactory(beanFactory);&lt;/h2&gt;
&lt;p&gt;çœ‹ refresh() çœ‹ çš„ç¬¬ 16 è¡Œä»£ç ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// è¿™ä¸ªæ–¹æ³•åœ¨å½“å‰ç‰ˆæœ¬çš„ spring æ˜¯æ²¡æœ‰ä»»ä½•ä»£ç çš„
// å¯èƒ½ Spring æœŸå¾…åœ¨åé¢çš„ç‰ˆæœ¬ä¸­å»æ‰©å±•å§
postProcessBeanFactory(beanFactory);
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;35-invokebeanfactorypostprocessorsbeanfactory&#34;&gt;3.5 invokeBeanFactoryPostProcessors(beanFactory);&lt;/h2&gt;
&lt;p&gt;çœ‹ refresh() çœ‹ çš„ç¬¬ 19 è¡Œä»£ç ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;invokeBeanFactoryPostProcessors(beanFactory);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç‚¹è¿›å»è¿™ä¸ªä»£ç ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;protected void invokeBeanFactoryPostProcessors(ConfigurableListableBeanFactory beanFactory) {
   // è¿™ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ getBeanFactoryPostProcessors() æ˜¯è·å–è‡ªå®šä¹‰çš„
   PostProcessorRegistrationDelegate.invokeBeanFactoryPostProcessors(beanFactory, getBeanFactoryPostProcessors());
   // Detect a LoadTimeWeaver and prepare for weaving, if found in the meantime
   // (e.g. through an @Bean method registered by ConfigurationClassPostProcessor)
   if (beanFactory.getTempClassLoader() == null &amp;amp;&amp;amp; beanFactory.containsBean(LOAD_TIME_WEAVER_BEAN_NAME)) {
      beanFactory.addBeanPostProcessor(new LoadTimeWeaverAwareProcessor(beanFactory));
      beanFactory.setTempClassLoader(new ContextTypeMatchClassLoader(beanFactory.getBeanClassLoader()));
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;351-getbeanfactorypostprocessors&#34;&gt;3.5.1 getBeanFactoryPostProcessors()&lt;/h3&gt;
&lt;p&gt;çœ‹ä¸Šè¿°ç¬¬ 3 è¡Œä»£ç ä¸­çš„ getBeanFactoryPostProcessors()ï¼šæ˜¯è·å–è‡ªå®šä¹‰çš„ï¼ˆç¨‹åºå‘˜è‡ªå·±å†™çš„ï¼Œå¹¶ä¸”æ²¡æœ‰äº¤ç»™ Spring ç®¡ç†çš„ï¼Œå°±æ˜¯æ²¡æœ‰åŠ ä¸Š @Component æ³¨è§£çš„ï¼‰&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶çš„ä»£ç  getBeanFactoryPostProcessors() è¿è¡Œçš„ç»“æœ size=0ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/getBeanFactoryPostProcessors.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹ä»€ä¹ˆå«åšè‡ªå®šä¹‰çš„ï¼Ÿ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
   public static void main(String[] args) {
      // æŠŠ Spring æ‰€æœ‰å‰æç¯å¢ƒå‡†å¤‡å¥½
      // 1.å‡†å¤‡å·¥å‚=DefaultListableBeanFactory
      // å®ä¾‹åŒ–ä¸€ä¸ª bdReader å’Œä¸€ä¸ª scanner
      AnnotationConfigApplicationContext context =
            new AnnotationConfigApplicationContext();
      // æŠŠä¸€ä¸ª class è½¬æˆ bdï¼Œæœ€å put åˆ° map
      // map ä½ç½® DefaultListableBeanFactory çš„ beanDefinitionMap
      context.register(AppConfig.class);
      // åˆå§‹åŒ– Spring çš„ç¯å¢ƒ
      context.refresh();
      IndexDao indexDao = context.getBean(IndexDaoImpl.class);
      indexDao.query();
      System.out.println(indexDao);
      System.out.println(context.getBean(IndexDaoImpl.class));
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å› ä¸º bean é»˜è®¤æ˜¯å•ä¾‹çš„ï¼Œæ‰€ä»¥ä¸¤æ¬¡ context.getBean()è·å–çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;dao...æ¨¡æ‹ŸæŸ¥è¯¢æ•°æ®åº“
com.ssm.dao.impl.IndexDaoImpl@47fd17e3
com.ssm.dao.impl.IndexDaoImpl@47fd17e3
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ’æ‰‹ Bean çš„åˆå§‹åŒ–è¿‡ç¨‹ï¼Œå°†ä½œç”¨åŸŸè®¾ç½®ä¸ºåŸå‹çš„ï¼š&lt;/p&gt;
&lt;p&gt;ä½†ç”±äºä»£ç æœªæ·»åŠ  @Component æ³¨è§£ï¼Œæ‰€ä»¥è¿™ä¸ªç±»ä¸ä¼šç”Ÿæ•ˆ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class MyBeanFactoryProcessor implements BeanFactoryPostProcessor {
   @Override
   public void postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory) throws BeansException {
      AnnotatedBeanDefinition annotatedBeanDefinition = (AnnotatedBeanDefinition) beanFactory.getBeanDefinition(&amp;quot;indexDao&amp;quot;);
      annotatedBeanDefinition.setScope(&amp;quot;prototype&amp;quot;);
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‰“å°æ•ˆæœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;dao...æ¨¡æ‹ŸæŸ¥è¯¢æ•°æ®åº“
com.ssm.dao.impl.IndexDaoImpl@47fd17e3
com.ssm.dao.impl.IndexDaoImpl@47fd17e3
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åœ¨ refresh() å‰ context.addBeanFactoryPostProcessor( new MyBeanFactoryProcessor());&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
   public static void main(String[] args) {
      // æŠŠ Spring æ‰€æœ‰å‰æç¯å¢ƒå‡†å¤‡å¥½
      // 1.å‡†å¤‡å·¥å‚=DefaultListableBeanFactory
      // å®ä¾‹åŒ–ä¸€ä¸ª bdReader å’Œä¸€ä¸ª scanner
      AnnotationConfigApplicationContext context =
            new AnnotationConfigApplicationContext();
      // æŠŠä¸€ä¸ª class è½¬æˆ bdï¼Œæœ€å put åˆ° map
      // map ä½ç½® DefaultListableBeanFactory çš„ beanDefinitionMap
      context.register(AppConfig.class);
      context.addBeanFactoryPostProcessor( new MyBeanFactoryProcessor());
      // åˆå§‹åŒ– Spring çš„ç¯å¢ƒ
      context.refresh();
      IndexDao indexDao = context.getBean(IndexDaoImpl.class);
      indexDao.query();
      System.out.println(indexDao);
      System.out.println(context.getBean(IndexDaoImpl.class));
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å³ä½¿ MyBeanFactoryProcessorÂ ç±»å¹¶æ²¡æœ‰æ·»åŠ æ³¨è§£ï¼Œä½†æ˜¯é€šè¿‡ addBeanFactoryPostProcessor ç»“æœæ˜¾ç¤º IndexDao å¯¹è±¡ä¸ºåŸå‹çš„äº†ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;dao...æ¨¡æ‹ŸæŸ¥è¯¢æ•°æ®åº“
com.ssm.dao.impl.IndexDaoImpl@47fd17e3
com.ssm.dao.impl.IndexDaoImpl@7cdbc5d3
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç»“è®ºï¼š&lt;strong&gt;context.addBeanFactoryPostProcessor( new MyBeanFactoryProcessor()); å°±ç§°ä¹‹ä¸ºè‡ªå®šä¹‰çš„&lt;/strong&gt;ã€‚&lt;br&gt;
æ­¤æ—¶ getBeanFactoryPostProcessors() æ‰§è¡Œåçš„ç»“æœ size ä¸ä¸º 0 äº†ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/getBeanFactoryPostProcessors_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;352-invokebeanfactorypostprocessorsbeanfactory-getbeanfactorypostprocessors&#34;&gt;3.5.2 invokeBeanFactoryPostProcessors(beanFactory, getBeanFactoryPostProcessors());&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public static void invokeBeanFactoryPostProcessors(
      ConfigurableListableBeanFactory beanFactory, List&amp;lt;BeanFactoryPostProcessor&amp;gt; beanFactoryPostProcessors) {
   // Invoke BeanDefinitionRegistryPostProcessors first, if any.
   Set&amp;lt;String&amp;gt; processedBeans = new HashSet&amp;lt;&amp;gt;();
   if (beanFactory instanceof BeanDefinitionRegistry) {
      BeanDefinitionRegistry registry = (BeanDefinitionRegistry) beanFactory;
      // å®šä¹‰ List&amp;lt;BeanFactoryPostProcessor&amp;gt;
      List&amp;lt;BeanFactoryPostProcessor&amp;gt; regularPostProcessors = new ArrayList&amp;lt;&amp;gt;();
       // å®šä¹‰ List&amp;lt;BeanDefinitionRegistryPostProcessor&amp;gt;
      List&amp;lt;BeanDefinitionRegistryPostProcessor&amp;gt; registryProcessors = new ArrayList&amp;lt;&amp;gt;();
      // éå† beanFactoryPostProcessors
      for (BeanFactoryPostProcessor postProcessor : beanFactoryPostProcessors) {
         // åˆ¤æ–­å¦‚æœ postProcessorÂ æ˜¯ BeanDefinitionRegistryPostProcessor ç±»å‹ï¼Œå°±æ·»åŠ åˆ° registryProcessorsÂ ä¸­
         if (postProcessor instanceof BeanDefinitionRegistryPostProcessor) {
            BeanDefinitionRegistryPostProcessor registryProcessor =
                  (BeanDefinitionRegistryPostProcessor) postProcessor;
            registryProcessor.postProcessBeanDefinitionRegistry(registry);
            registryProcessors.add(registryProcessor);
         }
         // å¦åˆ™ï¼Œæ·»åŠ åˆ° regularPostProcessorsä¸­
         else {
            regularPostProcessors.add(postProcessor);
         }
      }
      // Do not initialize FactoryBeans here: We need to leave all regular beans
      // uninitialized to let the bean factory post-processors apply to them!
      // Separate between BeanDefinitionRegistryPostProcessors that implement
      // PriorityOrdered, Ordered, and the rest.
      // è¿™ä¸ª currentRegistryProcessors æ”¾çš„æ˜¯ Spring å†…éƒ¨è‡ªå·±å®ç°äº† BeanDefinitionRegistryPostProcessor æ¥å£çš„å¯¹è±¡
      List&amp;lt;BeanDefinitionRegistryPostProcessor&amp;gt; currentRegistryProcessors = new ArrayList&amp;lt;&amp;gt;();
      // First, invoke the BeanDefinitionRegistryPostProcessors that implement PriorityOrdered.
      String[] postProcessorNames =
            beanFactory.getBeanNamesForType(BeanDefinitionRegistryPostProcessor.class, true, false);
            // è¿™ä¸ªåœ°æ–¹å¯ä»¥å¾—åˆ°ä¸€ä¸ª BeanFactoryPostProcessorï¼Œå› ä¸ºæ˜¯ Spring é»˜è®¤åœ¨æœ€å¼€å§‹è‡ªå·±æ³¨å†Œçš„
            // ä¸ºä»€ä¹ˆè¦åœ¨æœ€å¼€å§‹æ³¨å†Œè¿™ä¸ªå‘¢ï¼Ÿ
            // å› ä¸º Spring çš„å·¥å‚éœ€è¦æ³¨è§£å»æ‰«æç­‰ç­‰åŠŸèƒ½
            // è€Œè¿™äº›åŠŸèƒ½éƒ½æ˜¯éœ€è¦åœ¨ Spring å·¥å‚åˆå§‹åŒ–å®Œæˆä¹‹å‰å°±æ‰§è¡Œ
            // è¦ä¹ˆåœ¨å·¥å‚æœ€å¼€å§‹çš„æ—¶å€™ï¼Œè¦ä¹ˆåœ¨å·¥å‚åˆå§‹åŒ–ä¹‹ä¸­ï¼Œåæ­£ä¸èƒ½åœ¨ä¹‹å
            // å› ä¸ºå¦‚æœåœ¨ä¹‹åå°±æ²¡æœ‰æ„ä¹‰ï¼Œå› ä¸ºé‚£ä¸ªæ—¶å€™å·²ç»éœ€è¦ä½¿ç”¨å·¥å‚äº†
            // æ‰€ä»¥è¿™é‡Œ Spring åœ¨ä¸€å¼€å§‹å°±æ³¨å†Œäº†ä¸€ä¸ª BeanFactoryPostProcessorï¼Œç”¨æ¥æ’æ‰‹ springFactory çš„å®ä¾‹åŒ–è¿‡ç¨‹
            // åœ¨è¿™ä¸ªåœ°æ–¹æ–­ç‚¹å¯ä»¥çŸ¥é“è¿™ä¸ªç±»å«åš ConfigurationClassPostProcessor
            // ConfigurationClassPostProcessor é‚£ä¹ˆè¿™ä¸ªç±»èƒ½å¹²å˜›å‘¢ï¼Ÿå¯ä»¥å‚è€ƒæºç 
            // ä¸‹é¢å¯¹è¿™ä¸ªâ€œæ’æ‰‹ Spirng å·¥å‚å®ä¾‹åŒ–è¿‡ç¨‹â€çš„ç±»é‡ç‚¹è§£é‡Š
      for (String ppName : postProcessorNames) {
         if (beanFactory.isTypeMatch(ppName, PriorityOrdered.class)) {
            currentRegistryProcessors.add(beanFactory.getBean(ppName, BeanDefinitionRegistryPostProcessor.class));
            processedBeans.add(ppName);
         }
      }
      // æ’åºä¸é‡è¦ï¼Œå†µä¸” currentRegistryProcessor è¿™é‡Œä¹Ÿåªæœ‰ä¸€ä¸ªæ•°æ®
      sortPostProcessors(currentRegistryProcessors, beanFactory);
      // åˆå¹¶ Listï¼Œä¸é‡è¦ï¼ˆä¸ºä»€ä¹ˆè¦åˆå¹¶ï¼Œå› ä¸ºæœ‰è‡ªå®šä¹‰çš„Springè‡ªå·±çš„ï¼‰
      registryProcessors.addAll(currentRegistryProcessors);
      // æœ€é‡è¦ã€‚æ³¨æ„è¿™é‡Œæ˜¯æ–¹æ³•è°ƒç”¨
      invokeBeanDefinitionRegistryPostProcessors(currentRegistryProcessors, registry);
      currentRegistryProcessors.clear();
      // Next, invoke the BeanDefinitionRegistryPostProcessors that implement Ordered.
      postProcessorNames = beanFactory.getBeanNamesForType(BeanDefinitionRegistryPostProcessor.class, true, false);
      for (String ppName : postProcessorNames) {
         if (!processedBeans.contains(ppName) &amp;amp;&amp;amp; beanFactory.isTypeMatch(ppName, Ordered.class)) {
            currentRegistryProcessors.add(beanFactory.getBean(ppName, BeanDefinitionRegistryPostProcessor.class));
            processedBeans.add(ppName);
         }
      }
      sortPostProcessors(currentRegistryProcessors, beanFactory);
      registryProcessors.addAll(currentRegistryProcessors);
      invokeBeanDefinitionRegistryPostProcessors(currentRegistryProcessors, registry);
      currentRegistryProcessors.clear();
      // Finally, invoke all other BeanDefinitionRegistryPostProcessors until no further ones appear.
      boolean reiterate = true;
      while (reiterate) {
         reiterate = false;
         postProcessorNames = beanFactory.getBeanNamesForType(BeanDefinitionRegistryPostProcessor.class, true, false);
         for (String ppName : postProcessorNames) {
            if (!processedBeans.contains(ppName)) {
               currentRegistryProcessors.add(beanFactory.getBean(ppName, BeanDefinitionRegistryPostProcessor.class));
               processedBeans.add(ppName);
               reiterate = true;
            }
         }
         sortPostProcessors(currentRegistryProcessors, beanFactory);
         registryProcessors.addAll(currentRegistryProcessors);
         invokeBeanDefinitionRegistryPostProcessors(currentRegistryProcessors, registry);
         currentRegistryProcessors.clear();
      }
      // Now, invoke the postProcessBeanFactory callback of all processors handled so far.
      invokeBeanFactoryPostProcessors(registryProcessors, beanFactory);
      invokeBeanFactoryPostProcessors(regularPostProcessors, beanFactory);
   }
   else {
      // Invoke factory processors registered with the context instance.
      invokeBeanFactoryPostProcessors(beanFactoryPostProcessors, beanFactory);
   }
   // Do not initialize FactoryBeans here: We need to leave all regular beans
   // uninitialized to let the bean factory post-processors apply to them!
   String[] postProcessorNames =
         beanFactory.getBeanNamesForType(BeanFactoryPostProcessor.class, true, false);
   // Separate between BeanFactoryPostProcessors that implement PriorityOrdered,
   // Ordered, and the rest.
   List&amp;lt;BeanFactoryPostProcessor&amp;gt; priorityOrderedPostProcessors = new ArrayList&amp;lt;&amp;gt;();
   List&amp;lt;String&amp;gt; orderedPostProcessorNames = new ArrayList&amp;lt;&amp;gt;();
   List&amp;lt;String&amp;gt; nonOrderedPostProcessorNames = new ArrayList&amp;lt;&amp;gt;();
   for (String ppName : postProcessorNames) {
      if (processedBeans.contains(ppName)) {
         // skip - already processed in first phase above
      }
      else if (beanFactory.isTypeMatch(ppName, PriorityOrdered.class)) {
         priorityOrderedPostProcessors.add(beanFactory.getBean(ppName, BeanFactoryPostProcessor.class));
      }
      else if (beanFactory.isTypeMatch(ppName, Ordered.class)) {
         orderedPostProcessorNames.add(ppName);
      }
      else {
         nonOrderedPostProcessorNames.add(ppName);
      }
   }
   // First, invoke the BeanFactoryPostProcessors that implement PriorityOrdered.
   sortPostProcessors(priorityOrderedPostProcessors, beanFactory);
   invokeBeanFactoryPostProcessors(priorityOrderedPostProcessors, beanFactory);
   // Next, invoke the BeanFactoryPostProcessors that implement Ordered.
   List&amp;lt;BeanFactoryPostProcessor&amp;gt; orderedPostProcessors = new ArrayList&amp;lt;&amp;gt;();
   for (String postProcessorName : orderedPostProcessorNames) {
      orderedPostProcessors.add(beanFactory.getBean(postProcessorName, BeanFactoryPostProcessor.class));
   }
   sortPostProcessors(orderedPostProcessors, beanFactory);
   invokeBeanFactoryPostProcessors(orderedPostProcessors, beanFactory);
   // Finally, invoke all other BeanFactoryPostProcessors.
   List&amp;lt;BeanFactoryPostProcessor&amp;gt; nonOrderedPostProcessors = new ArrayList&amp;lt;&amp;gt;();
   for (String postProcessorName : nonOrderedPostProcessorNames) {
      nonOrderedPostProcessors.add(beanFactory.getBean(postProcessorName, BeanFactoryPostProcessor.class));
   }
   invokeBeanFactoryPostProcessors(nonOrderedPostProcessors, beanFactory);
   // Clear cached merged bean definitions since the post-processors might have
   // modified the original metadata, e.g. replacing placeholders in values...
   beanFactory.clearMetadataCache();
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;3521-listbeanfactorypostprocessor-listbeandefinitionregistrypostprocessor&#34;&gt;3.5.2.1  List&lt;BeanFactoryPostProcessor&gt;ã€List&lt;BeanDefinitionRegistryPostProcessor&gt;&lt;/h4&gt;
&lt;p&gt;çœ‹ä¸€ä¸‹ä¸Šè¿° 10-12 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// å®šä¹‰ List&amp;lt;BeanFactoryPostProcessor&amp;gt;
List&amp;lt;BeanFactoryPostProcessor&amp;gt; regularPostProcessors = new ArrayList&amp;lt;&amp;gt;();
// å®šä¹‰ List&amp;lt;BeanDefinitionRegistryPostProcessor&amp;gt;
List&amp;lt;BeanDefinitionRegistryPostProcessor&amp;gt; registryProcessors = new ArrayList&amp;lt;&amp;gt;();
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆå®šä¹‰ä¸¤ä¸ª Listï¼Ÿ&lt;br&gt;
è‡ªå·±å®šä¹‰çš„Â BeanFactoryProcessorå¯ä»¥æœ‰ä¸¤ç§æ–¹å¼ï¼š&lt;/p&gt;
&lt;p&gt;1.å®ç°Â BeanFactoryPostProcessor æ¥å£&lt;/p&gt;
&lt;p&gt;2.å®ç°BeanDefinitionRegistryPostProcessoræ¥å£&lt;/p&gt;
&lt;p&gt;å› ä¸ºÂ BeanDefinitionRegistryPostProcessor å®ç°äº†Â BeanFactoryPostProcessor æ¥å£&lt;/p&gt;
&lt;p&gt;äºæ˜¯å¯ä»¥çŒœæƒ³å®ç° bdrp å’Œå®ç° bfp æ˜¯èƒ½å¤Ÿå®Œæˆä¸åŒçš„åŠŸèƒ½ï¼Œ&lt;/p&gt;
&lt;p&gt;å› ä¸º bdrp æ˜¯å­ç±»ï¼Œå­ç±»è‚¯å®šæ‰©å±•äº†çˆ¶ç±»ä¸­çš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;çˆ¶ç±» BeanFactoryPostProcessorÂ  ä¸­æœ‰ä¸€ä¸ª postProcessBeanFactory æ–¹æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@FunctionalInterface
public interface BeanFactoryPostProcessor {
   void postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory) throws BeansException;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å­ç±» BeanDefinitionRegistryPostProcessor  æ‰©å±•äº†ä¸€ä¸ª postProcessBeanDefinitionRegistry() æ–¹æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public interface BeanDefinitionRegistryPostProcessor extends BeanFactoryPostProcessor {
   void postProcessBeanDefinitionRegistry(BeanDefinitionRegistry registry) throws BeansException;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;3522-getbeannamesfortype&#34;&gt;3.5.2.2 getBeanNamesForType&lt;/h4&gt;
&lt;p&gt;ä¸Šè¿° invokeBeanFactoryPostProcessors æ–¹æ³•çš„ç¬¬ 37-54 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;String[] postProcessorNames =
      beanFactory.getBeanNamesForType(BeanDefinitionRegistryPostProcessor.class, true, false);
for (String ppName : postProcessorNames) {
   if (beanFactory.isTypeMatch(ppName, PriorityOrdered.class)) {
      currentRegistryProcessors.add(beanFactory.getBean(ppName, BeanDefinitionRegistryPostProcessor.class));
      processedBeans.add(ppName);
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;getBeanNamesForTypeï¼šè¿™ä¸ªæ–¹æ³•æ˜¯ beanFactory ä¸­çš„æ–¹æ³•ï¼Œé¡¾åæ€ä¹‰ï¼Œè¿™ä¸ªæ–¹æ³•èƒ½å¤Ÿå¾—åˆ°é€šè¿‡ç±»å¾—åˆ° beanåå­—ï¼Œè¿™é‡Œçš„ Type æŒ‡çš„æ˜¯ bd å½“ä¸­æè¿°å½“å‰ç±»çš„ Class ç±»å‹ã€‚&lt;br&gt;
beanFactory.getBeanNamesForType(BeanDefinitionRegistryPostProcessor.class, true, false)ï¼šè·å– Type ä¸º BeanDefinitionRegistryPostProcessor å¯¹åº”çš„ bean åå­—ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å…ˆæ¥æŸ¥çœ‹å½“å‰å·¥å‚çš„ map ä¸­æœ‰å“ªäº›&amp;lt;beanName, beanDefinition&amp;gt;ï¼Œä¹‹å‰è¯´è¿‡åœ¨æ‰§è¡Œ register() æ—¶å‘å®¹å™¨å†…æ·»åŠ äº† 7 ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬çœ‹åˆ°æœ‰ä¸€ä¸ª BeanClass ä¸º ConfigurationClassPostProcessor çš„ç±»&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/ConfigurationClassPostProcessor.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;æˆ‘ä»¬å‘ç° ConfigurationClassPostProcessor ç±»å®ç°äº† BeanDefinitionRegistryPostProcessor æ¥å£ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class ConfigurationClassPostProcessor implements BeanDefinitionRegistryPostProcessor,
      PriorityOrdered, ResourceLoaderAware, BeanClassLoaderAware, EnvironmentAware {
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‰€ä»¥ beanFactory.getBeanNamesForType(BeanDefinitionRegistryPostProcessor.class, true, false); å°±æŠŠ ConfigurationClassPostProcessorÂ  ç±»ï¼ˆSpring å†…éƒ¨è‡ªå·±å®šä¹‰çš„ï¼‰æ‹¿å‡ºæ¥äº†ã€‚&lt;/p&gt;
&lt;h4 id=&#34;3523-invokebeandefinitionregistrypostprocessors&#34;&gt;3.5.2.3 invokeBeanDefinitionRegistryPostProcessors&lt;/h4&gt;
&lt;p&gt;ä¸Šè¿° invokeBeanFactoryPostProcessors æ–¹æ³•çš„ç¬¬ 60 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;invokeBeanDefinitionRegistryPostProcessors(currentRegistryProcessors, registry);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ‘ä»¬ç‚¹è¿›è¿™ä¸ª invokeBeanDefinitionRegistryPostProcessors æ–¹æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;private static void invokeBeanDefinitionRegistryPostProcessors(
      Collection&amp;lt;? extends BeanDefinitionRegistryPostProcessor&amp;gt; postProcessors, BeanDefinitionRegistry registry) {
   // å¾ªç¯æ‰€æœ‰çš„ BeanDefinitionRegistryPostProcessor
   for (BeanDefinitionRegistryPostProcessor postProcessor : postProcessors) {
      postProcessor.postProcessBeanDefinitionRegistry(registry);
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 5 è¡Œç‚¹è¿›å»ï¼šè°ƒç”¨ BeanDefinitionRegistryPostProcessor&lt;br&gt;
æ‰©å±•çˆ¶ç±»çš„æ–¹æ³• postProcessBeanDefinitionRegistry()ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Override
public void postProcessBeanDefinitionRegistry(BeanDefinitionRegistry registry) {
   int registryId = System.identityHashCode(registry);
   if (this.registriesPostProcessed.contains(registryId)) {
      throw new IllegalStateException(
            &amp;quot;postProcessBeanDefinitionRegistry already called on this post-processor against &amp;quot; + registry);
   }
   if (this.factoriesPostProcessed.contains(registryId)) {
      throw new IllegalStateException(
            &amp;quot;postProcessBeanFactory already called on this post-processor against &amp;quot; + registry);
   }
   this.registriesPostProcessed.add(registryId);
   processConfigBeanDefinitions(registry);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 14 è¡Œç‚¹è¿›å»ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public void processConfigBeanDefinitions(BeanDefinitionRegistry registry) {
   // app æä¾›çš„ bean
   List&amp;lt;BeanDefinitionHolder&amp;gt; configCandidates = new ArrayList&amp;lt;&amp;gt;();
   // è·å–å®¹å™¨ä¸­æ³¨å†Œçš„æ‰€æœ‰ bean åå­—
   String[] candidateNames = registry.getBeanDefinitionNames();
   // ä¾æ¬¡å–å‡ºæ¯ä¸ª&amp;lt;beanName,beanDefinition&amp;gt;
   for (String beanName : candidateNames) {
      BeanDefinition beanDef = registry.getBeanDefinition(beanName);
      // åˆ¤æ–­å½“å‰ bean æ˜¯å¦è¢«å¤„ç†è¿‡ï¼šä½¿ç”¨ isFullConfigurationClass æ¥æ ‡è¯†
      if (ConfigurationClassUtils.isFullConfigurationClass(beanDef) ||
            ConfigurationClassUtils.isLiteConfigurationClass(beanDef)) {
         // å¦‚æœ BeanDefinition ä¸­çš„ configurationClass å±æ€§ä¸º full æˆ–è€… liteï¼Œåˆ™æ„å‘³ç€å·²ç»å¤„ç†è¿‡äº†ï¼Œç›´æ¥è·³è¿‡
         // è¿™é‡Œéœ€è¦ç»“åˆä¸‹é¢çš„ä»£ç æ‰èƒ½ç†è§£
         if (logger.isDebugEnabled()) {
            logger.debug(&amp;quot;Bean definition has already been processed as a configuration class: &amp;quot; + beanDef);
         }
      }
      // åˆ¤æ–­è¿™ä¸ª BeanDefinition æ˜¯å¦åŒ…å«äº† @Configurationã€@Service æ³¨è§£
      else if (ConfigurationClassUtils.checkConfigurationClassCandidate(beanDef, this.metadataReaderFactory)) {
         configCandidates.add(new BeanDefinitionHolder(beanDef, beanName));
      }
   }
   // Return immediately if no @Configuration classes were found
   if (configCandidates.isEmpty()) {
      return;
   }
    
   // æ’åºï¼Œæ ¹æ® orderï¼Œä¸é‡è¦
   // Sort by previously determined @Order value, if applicable
   configCandidates.sort((bd1, bd2) -&amp;gt; {
      int i1 = ConfigurationClassUtils.getOrder(bd1.getBeanDefinition());
      int i2 = ConfigurationClassUtils.getOrder(bd2.getBeanDefinition());
      return Integer.compare(i1, i2);
   });
   // Detect any custom bean name generation strategy supplied through the enclosing application context
   SingletonBeanRegistry sbr = null;
   // å¦‚æœ BeanDefinitionRegistry æ˜¯ SingletonBeanRegistry å­ç±»çš„è¯
   // ç”±äºä¼šå°† registry å¼ºè½¬ä¸º SingletonBeanRegistry
   if (registry instanceof SingletonBeanRegistry) {
      sbr = (SingletonBeanRegistry) registry;
      if (!this.localBeanNameGeneratorSet) {
         BeanNameGenerator generator = (BeanNameGenerator) sbr.getSingleton(CONFIGURATION_BEAN_NAME_GENERATOR);
         // SingletonBeanRegistry ä¸­æœ‰ id ä¸º org.springframework.context.annotation.internalConfigurationBeanNameGenerator
         // å¦‚æœæœ‰åˆ™åˆ©ç”¨å®ƒçš„ï¼Œå¦åˆ™åˆ™ä½¿ç”¨ Spring é»˜è®¤çš„
         if (generator != null) {
            this.componentScanBeanNameGenerator = generator;
            this.importBeanNameGenerator = generator;
         }
      }
   }
   if (this.environment == null) {
      this.environment = new StandardEnvironment();
   }
   // Parse each @Configuration class
   // å®ä¾‹åŒ– ConfigurationClassParser ä¸ºäº†è§£æå„ä¸ªé…ç½®ç±»
   ConfigurationClassParser parser = new ConfigurationClassParser(
         this.metadataReaderFactory, this.problemReporter, this.environment,
         this.resourceLoader, this.componentScanBeanNameGenerator, registry);
         
   // å®ä¾‹åŒ– 2 ä¸ª setï¼Œcandidates ç”¨äºå°†ä¹‹å‰åŠ å…¥çš„ configCandidates è¿›è¡Œå»é‡
   // å› ä¸ºå¯èƒ½æœ‰å¤šä¸ªé…ç½®ç±»é‡å¤äº†
   // alreadyParsed ç”¨æˆ·åˆ¤æ–­æ˜¯å¦å¤„ç†è¿‡
   Set&amp;lt;BeanDefinitionHolder&amp;gt; candidates = new LinkedHashSet&amp;lt;&amp;gt;(configCandidates);
   Set&amp;lt;ConfigurationClass&amp;gt; alreadyParsed = new HashSet&amp;lt;&amp;gt;(configCandidates.size());
   do {
      parser.parse(candidates);
      parser.validate();
      Set&amp;lt;ConfigurationClass&amp;gt; configClasses = new LinkedHashSet&amp;lt;&amp;gt;(parser.getConfigurationClasses());
      configClasses.removeAll(alreadyParsed);
      // Read the model and create bean definitions based on its content
      if (this.reader == null) {
         this.reader = new ConfigurationClassBeanDefinitionReader(
               registry, this.sourceExtractor, this.resourceLoader, this.environment,
               this.importBeanNameGenerator, parser.getImportRegistry());
      }
      // æŠŠæ‰«æå‡ºæ¥çš„ bean å¯¹åº”çš„ beanDefinitions æ·»åŠ åˆ° factory çš„ map å½“ä¸­
      this.reader.loadBeanDefinitions(configClasses);
      alreadyParsed.addAll(configClasses);
      candidates.clear();
      if (registry.getBeanDefinitionCount() &amp;gt; candidateNames.length) {
         String[] newCandidateNames = registry.getBeanDefinitionNames();
         Set&amp;lt;String&amp;gt; oldCandidateNames = new HashSet&amp;lt;&amp;gt;(Arrays.asList(candidateNames));
         Set&amp;lt;String&amp;gt; alreadyParsedClasses = new HashSet&amp;lt;&amp;gt;();
         for (ConfigurationClass configurationClass : alreadyParsed) {
            alreadyParsedClasses.add(configurationClass.getMetadata().getClassName());
         }
         for (String candidateName : newCandidateNames) {
            if (!oldCandidateNames.contains(candidateName)) {
               BeanDefinition bd = registry.getBeanDefinition(candidateName);
               if (ConfigurationClassUtils.checkConfigurationClassCandidate(bd, this.metadataReaderFactory) &amp;amp;&amp;amp;
                     !alreadyParsedClasses.contains(bd.getBeanClassName())) {
                  candidates.add(new BeanDefinitionHolder(bd, candidateName));
               }
            }
         }
         candidateNames = newCandidateNames;
      }
   }
   while (!candidates.isEmpty());
   // Register the ImportRegistry as a bean in order to support ImportAware @Configuration classes
   if (sbr != null &amp;amp;&amp;amp; !sbr.containsSingleton(IMPORT_REGISTRY_BEAN_NAME)) {
      sbr.registerSingleton(IMPORT_REGISTRY_BEAN_NAME, parser.getImportRegistry());
   }
   if (this.metadataReaderFactory instanceof CachingMetadataReaderFactory) {
      // Clear cache in externally provided MetadataReaderFactory; this is a no-op
      // for a shared cache since it&#39;ll be cleared by the ApplicationContext.
      ((CachingMetadataReaderFactory) this.metadataReaderFactory).clearCache();
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/candidateNames.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ä¸Šè¿° processConfigBeanDefinitions æ–¹æ³•ç¬¬ 18-21 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;      // åˆ¤æ–­è¿™ä¸ª BeanDefinition æ˜¯å¦åŒ…å«äº† @Configurationã€@Service æ³¨è§£
      else if (ConfigurationClassUtils.checkConfigurationClassCandidate(beanDef, this.metadataReaderFactory)) {
         configCandidates.add(new BeanDefinitionHolder(beanDef, beanName));
      }      
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;checkConfigurationClassCandidate&lt;br&gt;
å…ˆæ¥çœ‹ä¸Šè¿°ç¬¬äºŒè¡Œè°ƒç”¨ checkConfigurationClassCandidate æ–¹æ³•åˆ¤æ–­æ˜¯å¦åŠ äº† @Configuration æ³¨è§£ï¼ŒcheckConfigurationClassCandidate æ–¹æ³•å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public static boolean checkConfigurationClassCandidate(BeanDefinition beanDef, MetadataReaderFactory metadataReaderFactory) {
   String className = beanDef.getBeanClassName();
   if (className == null || beanDef.getFactoryMethodName() != null) {
      return false;
   }
   AnnotationMetadata metadata;
   if (beanDef instanceof AnnotatedBeanDefinition &amp;amp;&amp;amp;
         className.equals(((AnnotatedBeanDefinition) beanDef).getMetadata().getClassName())) {
      // Can reuse the pre-parsed metadata from the given BeanDefinition...
      // å¦‚æœ BeanDefinition æ˜¯ AnnotatedBeanDefinition çš„å®ä¾‹ï¼Œå¹¶ä¸” className å’Œ BeanDefinition ä¸­çš„å…ƒæ•°æ®çš„ç±»åç›¸åŒ
      // åˆ™ç›´æ¥ä» BeanDefinition è·å¾—å…ƒæ•°æ®Metadata
      metadata = ((AnnotatedBeanDefinition) beanDef).getMetadata();
   }
   else if (beanDef instanceof AbstractBeanDefinition &amp;amp;&amp;amp; ((AbstractBeanDefinition) beanDef).hasBeanClass()) {
      // Check already loaded Class if present...
      // since we possibly can&#39;t even load the class file for this Class.
      Class&amp;lt;?&amp;gt; beanClass = ((AbstractBeanDefinition) beanDef).getBeanClass();
      metadata = new StandardAnnotationMetadata(beanClass, true);
   }
   else {
      try {
         MetadataReader metadataReader = metadataReaderFactory.getMetadataReader(className);
         metadata = metadataReader.getAnnotationMetadata();
      }
      catch (IOException ex) {
         if (logger.isDebugEnabled()) {
            logger.debug(&amp;quot;Could not find class file for introspecting configuration annotations: &amp;quot; + className, ex);
         }
         return false;
      }
   }
  
   // åˆ¤æ–­å½“å‰è¿™ä¸ª bd ä¸­å­˜åœ¨çš„ç±»æ˜¯ä¸æ˜¯åŠ äº† @Configuration æ³¨è§£
   if (isFullConfigurationCandidate(metadata)) {
      // å¦‚æœå­˜åœ¨ Configuration æ³¨è§£ï¼Œåˆ™ä¸º BeanDefinition è®¾ç½® configurationClass å±æ€§ä¸º FULLï¼Œç»“åˆ processConfigBeanDefinitions æ–¹æ³•çš„ç¬¬ 10 è¡Œï¼Œä½¿ç”¨ isFullConfigurationClass åˆ¤æ–­æ˜¯å¦å¤„ç†è¿‡
      beanDef.setAttribute(CONFIGURATION_CLASS_ATTRIBUTE, CONFIGURATION_CLASS_FULL);
   }
   // åˆ¤æ–­æ˜¯å¦åŠ äº†ä»¥ä¸‹æ³¨è§£ï¼Œæ‘˜å½• isLiteConfigurationCandidate çš„æºç 
   // candidateIndicators.add(Component.class.getName());
   // candidateIndicators.add(ComponentScan.class.getName());
   // candidateIndicators.add(Import.class.getName());
   // candidateIndicators.add(ImportResource.class.getName());
   else if (isLiteConfigurationCandidate(metadata)) {
      beanDef.setAttribute(CONFIGURATION_CLASS_ATTRIBUTE, CONFIGURATION_CLASS_LITE);
   }
   else {
      return false;
   }
   // It&#39;s a full or lite configuration candidate... Let&#39;s determine the order value, if any.
   // å¾—åˆ°æ’åºï¼šå¦‚æœæœ‰å¤šä¸ªåŠ äº† @Configuration çš„ç±»ï¼Œæ ¹æ® @Orderè¿›è¡Œæ’åºå†³å®šè§£æé¡ºåº
   Integer order = getOrder(metadata);
   if (order != null) {
      beanDef.setAttribute(ORDER_ATTRIBUTE, order);
   }
   return true;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 35 è¡Œï¼Œåˆ¤æ–­å½“å‰è¿™ä¸ª bd ä¸­å­˜åœ¨çš„ç±»æ˜¯ä¸æ˜¯åŠ äº† @Configuration æ³¨è§£ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public static boolean isFullConfigurationCandidate(AnnotationMetadata metadata) {
   return metadata.isAnnotated(Configuration.class.getName());
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿° checkConfigurationClassCandidate æ–¹æ³•ç¬¬ 44-46 è¡Œï¼Œåˆ¤æ–­æ˜¯å¦åŠ äº†å…¶ä»–æ³¨è§£&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// åˆ¤æ–­æ˜¯å¦åŠ äº†ä»¥ä¸‹æ³¨è§£ï¼Œæ‘˜å½• isLiteConfigurationCandidate çš„æºç 
// candidateIndicators.add(Component.class.getName());
// candidateIndicators.add(ComponentScan.class.getName());
// candidateIndicators.add(Import.class.getName());
// candidateIndicators.add(ImportResource.class.getName());
  else if (isLiteConfigurationCandidate(metadata)) {
      beanDef.setAttribute(CONFIGURATION_CLASS_ATTRIBUTE, CONFIGURATION_CLASS_LITE);
  }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç‚¹è¿› isLiteConfigurationCandidate æ–¹æ³•å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public static boolean isLiteConfigurationCandidate(AnnotationMetadata metadata) {
   // Do not consider an interface or an annotation...
   if (metadata.isInterface()) {
      return false;
   }
   // Any of the typical annotations found?
   for (String indicator : candidateIndicators) {
      if (metadata.isAnnotated(indicator)) {
         return true;
      }
   }
   // Finally, let&#39;s look for @Bean methods...
   try {
      return metadata.hasAnnotatedMethods(Bean.class.getName());
   }
   catch (Throwable ex) {
      if (logger.isDebugEnabled()) {
         logger.debug(&amp;quot;Failed to introspect @Bean methods on class [&amp;quot; + metadata.getClassName() + &amp;quot;]: &amp;quot; + ex);
      }
      return false;
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/candidateIndicators.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;processConfigBeanDefinitions æ–¹æ³•çš„ç¬¬ 62 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;parser.parse(candidates);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç‚¹è¿›è¿™ä¸ª parse æ–¹æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public void parse(Set&amp;lt;BeanDefinitionHolder&amp;gt; configCandidates) {
   this.deferredImportSelectors = new LinkedList&amp;lt;&amp;gt;();
   // æ ¹æ® BeanDefinition çš„ç±»å‹åšä¸åŒçš„å¤„ç†ï¼Œä¸€èˆ¬éƒ½ä¼šè°ƒç”¨ ConfigurationClassParse#parse è¿›è¡Œè§£æ
   for (BeanDefinitionHolder holder : configCandidates) {
      BeanDefinition bd = holder.getBeanDefinition();
      try {
         // åˆ¤æ–­è¿™ä¸ª bd æ˜¯å¦è¢«åŠ äº†æ³¨è§£
         if (bd instanceof AnnotatedBeanDefinition) {
            parse(((AnnotatedBeanDefinition) bd).getMetadata(), holder.getBeanName());
         }
         else if (bd instanceof AbstractBeanDefinition &amp;amp;&amp;amp; ((AbstractBeanDefinition) bd).hasBeanClass()) {
            parse(((AbstractBeanDefinition) bd).getBeanClass(), holder.getBeanName());
         }
         else {
            parse(bd.getBeanClassName(), holder.getBeanName());
         }
      }
      catch (BeanDefinitionStoreException ex) {
         throw ex;
      }
      catch (Throwable ex) {
         throw new BeanDefinitionStoreException(
               &amp;quot;Failed to parse configuration class [&amp;quot; + bd.getBeanClassName() + &amp;quot;]&amp;quot;, ex);
      }
   }
   processDeferredImportSelectors();
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å†ç‚¹è¿›ä¸Šè¿°ä»£ç ç¬¬ 9 è¡Œçš„ parse æ–¹æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;protected final void parse(AnnotationMetadata metadata, String beanName) throws IOException {
   processConfigurationClass(new ConfigurationClass(metadata, beanName));
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬äºŒè¡Œè°ƒç”¨äº† processConfigurationClass æ–¹æ³•ï¼Œç‚¹è¿›å»ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;protected void processConfigurationClass(ConfigurationClass configClass) throws IOException {
   // åˆ¤æ–­æ˜¯å¦åº”è¯¥è·³è¿‡è§£æ
   if (this.conditionEvaluator.shouldSkip(configClass.getMetadata(), ConfigurationPhase.PARSE_CONFIGURATION)) {
      return;
   }
   // å¤„ç† Imported çš„æƒ…å†µ
   ConfigurationClass existingClass = this.configurationClasses.get(configClass);
   if (existingClass != null) {
      if (configClass.isImported()) {
         if (existingClass.isImported()) {
            existingClass.mergeImportedBy(configClass);
         }
         // Otherwise ignore new imported config class; existing non-imported class overrides it.
         return;
      }
      else {
         // Explicit bean definition found, probably replacing an import.
         // Let&#39;s remove the old one and go with the new one.
         this.configurationClasses.remove(configClass);
         this.knownSuperclasses.values().removeIf(configClass::equals);
      }
   }
   // Recursively process the configuration class and its superclass hierarchy.
   SourceClass sourceClass = asSourceClass(configClass);
   do {
      sourceClass = doProcessConfigurationClass(configClass, sourceClass);
   }
   while (sourceClass != null);
   
   // ä¸€ä¸ª mapï¼Œç”¨æ¥å­˜æ”¾æ‰«æå‡ºæ¥çš„ beanï¼ˆæ³¨æ„è¿™é‡Œçš„ bean ä¸æ˜¯å¯¹è±¡ï¼Œä»…ä»…æ˜¯ bean çš„ä¿¡æ¯ï¼Œå› ä¸ºè¿˜æ²¡åˆ°å®ä¾‹åŒ–ï¼‰
   this.configurationClasses.put(configClass, configClass);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;doProcessConfigurationClass&lt;/p&gt;
&lt;p&gt;çœ‹ä¸Šè¿°ç¬¬ 28 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;sourceClass = doProcessConfigurationClass(configClass, sourceClass);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç‚¹è¿›è¿™ä¸ª doProcessConfigurationClass æ–¹æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Nullable
protected final SourceClass doProcessConfigurationClass(ConfigurationClass configClass, SourceClass sourceClass)
      throws IOException {
   // Recursively process any member (nested) classes first
   // å¤„ç†å†…éƒ¨ç±»
   processMemberClasses(configClass, sourceClass);
   // Process any @PropertySource annotations
   for (AnnotationAttributes propertySource : AnnotationConfigUtils.attributesForRepeatable(
         sourceClass.getMetadata(), PropertySources.class,
         org.springframework.context.annotation.PropertySource.class)) {
      if (this.environment instanceof ConfigurableEnvironment) {
         processPropertySource(propertySource);
      }
      else {
         logger.warn(&amp;quot;Ignoring @PropertySource annotation on [&amp;quot; + sourceClass.getMetadata().getClassName() +
               &amp;quot;]. Reason: Environment must implement ConfigurableEnvironment&amp;quot;);
      }
   }
   // Process any @ComponentScan annotations
   Set&amp;lt;AnnotationAttributes&amp;gt; componentScans = AnnotationConfigUtils.attributesForRepeatable(
         sourceClass.getMetadata(), ComponentScans.class, ComponentScan.class);
   if (!componentScans.isEmpty() &amp;amp;&amp;amp;
         !this.conditionEvaluator.shouldSkip(sourceClass.getMetadata(), ConfigurationPhase.REGISTER_BEAN)) {
      for (AnnotationAttributes componentScan : componentScans) {
         // The config class is annotated with @ComponentScan -&amp;gt; perform the scan immediately
         Set&amp;lt;BeanDefinitionHolder&amp;gt; scannedBeanDefinitions =
               this.componentScanParser.parse(componentScan, sourceClass.getMetadata().getClassName());
         // Check the set of scanned definitions for any further config classes and parse recursively if needed
         for (BeanDefinitionHolder holder : scannedBeanDefinitions) {
            BeanDefinition bdCand = holder.getBeanDefinition().getOriginatingBeanDefinition();
            if (bdCand == null) {
               bdCand = holder.getBeanDefinition();
            }
            if (ConfigurationClassUtils.checkConfigurationClassCandidate(bdCand, this.metadataReaderFactory)) {
               parse(bdCand.getBeanClassName(), holder.getBeanName());
            }
         }
      }
   }
   // Process any @Import annotations
   processImports(configClass, sourceClass, getImports(sourceClass), true);
   // Process any @ImportResource annotations
   AnnotationAttributes importResource =
         AnnotationConfigUtils.attributesFor(sourceClass.getMetadata(), ImportResource.class);
   if (importResource != null) {
      String[] resources = importResource.getStringArray(&amp;quot;locations&amp;quot;);
      Class&amp;lt;? extends BeanDefinitionReader&amp;gt; readerClass = importResource.getClass(&amp;quot;reader&amp;quot;);
      for (String resource : resources) {
         String resolvedResource = this.environment.resolveRequiredPlaceholders(resource);
         configClass.addImportedResource(resolvedResource, readerClass);
      }
   }
   // Process individual @Bean methods
   Set&amp;lt;MethodMetadata&amp;gt; beanMethods = retrieveBeanMethodMetadata(sourceClass);
   for (MethodMetadata methodMetadata : beanMethods) {
      configClass.addBeanMethod(new BeanMethod(methodMetadata, configClass));
   }
   // Process default methods on interfaces
   processInterfaces(configClass, sourceClass);
   // Process superclass, if any
   if (sourceClass.getMetadata().hasSuperClass()) {
      String superclass = sourceClass.getMetadata().getSuperClassName();
      if (superclass != null &amp;amp;&amp;amp; !superclass.startsWith(&amp;quot;java&amp;quot;) &amp;amp;&amp;amp;
            !this.knownSuperclasses.containsKey(superclass)) {
         this.knownSuperclasses.put(superclass, configClass);
         // Superclass found, return its annotation metadata and recurse
         return sourceClass.getSuperClass();
      }
   }
   // No superclass -&amp;gt; processing is complete
   return null;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 23-24 è¡Œï¼Œè·å¾—å¸¦æœ‰ @ComponentScan æ³¨è§£çš„ç±»&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/ComponentScan.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 30 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;this.componentScanParser.parse(componentScan, sourceClass.getMetadata().getClassName());
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å†ç‚¹è¿›å»è¿™ä¸ª parse æ–¹æ³•ï¼šçœŸæ­£è§£ææ‰«æåŒ…çš„&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public Set&amp;lt;BeanDefinitionHolder&amp;gt; parse(AnnotationAttributes componentScan, final String declaringClass) {
   ClassPathBeanDefinitionScanner scanner = new ClassPathBeanDefinitionScanner(this.registry,
         componentScan.getBoolean(&amp;quot;useDefaultFilters&amp;quot;), this.environment, this.resourceLoader);
   
   // çœ‹æœ‰æ²¡æœ‰è‡ªå®šä¹‰å¤–éƒ¨ Bean ç”Ÿå‘½å™¨
   Class&amp;lt;? extends BeanNameGenerator&amp;gt; generatorClass = componentScan.getClass(&amp;quot;nameGenerator&amp;quot;);
   boolean useInheritedGenerator = (BeanNameGenerator.class == generatorClass);
   scanner.setBeanNameGenerator(useInheritedGenerator ? this.beanNameGenerator :
         BeanUtils.instantiateClass(generatorClass));
   // åˆ¤æ–­è¿™ä¸ªç±»æ˜¯ä¸æ˜¯ä»£ç†çš„
   ScopedProxyMode scopedProxyMode = componentScan.getEnum(&amp;quot;scopedProxy&amp;quot;);
   if (scopedProxyMode != ScopedProxyMode.DEFAULT) {
      scanner.setScopedProxyMode(scopedProxyMode);
   }
   else {
      Class&amp;lt;? extends ScopeMetadataResolver&amp;gt; resolverClass = componentScan.getClass(&amp;quot;scopeResolver&amp;quot;);
      scanner.setScopeMetadataResolver(BeanUtils.instantiateClass(resolverClass));
   }
   scanner.setResourcePattern(componentScan.getString(&amp;quot;resourcePattern&amp;quot;));
   for (AnnotationAttributes filter : componentScan.getAnnotationArray(&amp;quot;includeFilters&amp;quot;)) {
      for (TypeFilter typeFilter : typeFiltersFor(filter)) {
         scanner.addIncludeFilter(typeFilter);
      }
   }
   for (AnnotationAttributes filter : componentScan.getAnnotationArray(&amp;quot;excludeFilters&amp;quot;)) {
      for (TypeFilter typeFilter : typeFiltersFor(filter)) {
         scanner.addExcludeFilter(typeFilter);
      }
   }
   boolean lazyInit = componentScan.getBoolean(&amp;quot;lazyInit&amp;quot;);
   if (lazyInit) {
      scanner.getBeanDefinitionDefaults().setLazyInit(true);
   }
   Set&amp;lt;String&amp;gt; basePackages = new LinkedHashSet&amp;lt;&amp;gt;();
   String[] basePackagesArray = componentScan.getStringArray(&amp;quot;basePackages&amp;quot;);
   for (String pkg : basePackagesArray) {
      String[] tokenized = StringUtils.tokenizeToStringArray(this.environment.resolvePlaceholders(pkg),
            ConfigurableApplicationContext.CONFIG_LOCATION_DELIMITERS);
      Collections.addAll(basePackages, tokenized);
   }
   for (Class&amp;lt;?&amp;gt; clazz : componentScan.getClassArray(&amp;quot;basePackageClasses&amp;quot;)) {
      basePackages.add(ClassUtils.getPackageName(clazz));
   }
   if (basePackages.isEmpty()) {
      basePackages.add(ClassUtils.getPackageName(declaringClass));
   }
    
   // å¾—åˆ° excludeFilter è®¾ç½®çš„æ’é™¤æ‰«æçš„åŒ…
   scanner.addExcludeFilter(new AbstractTypeHierarchyTraversingFilter(false, false) {
      @Override
      protected boolean matchClassName(String className) {
         return declaringClass.equals(className);
      }
   });
   return scanner.doScan(StringUtils.toStringArray(basePackages));
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 60 è¡Œçš„ doScan æ–¹æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;protected Set&amp;lt;BeanDefinitionHolder&amp;gt; doScan(String... basePackages) {
   Assert.notEmpty(basePackages, &amp;quot;At least one base package must be specified&amp;quot;);
   Set&amp;lt;BeanDefinitionHolder&amp;gt; beanDefinitions = new LinkedHashSet&amp;lt;&amp;gt;();
   for (String basePackage : basePackages) {
      // æ‰«è¡¨ basePackage è·¯å¾„ä¸‹çš„ java æ–‡ä»¶
      // å¹¶æŠŠå®ƒè½¬æˆ BeanDefinition ç±»å‹
      Set&amp;lt;BeanDefinition&amp;gt; candidates = findCandidateComponents(basePackage);
      for (BeanDefinition candidate : candidates) {
         // è§£æ scope å±æ€§
         ScopeMetadata scopeMetadata = this.scopeMetadataResolver.resolveScopeMetadata(candidate);
         candidate.setScope(scopeMetadata.getScopeName());
         String beanName = this.beanNameGenerator.generateBeanName(candidate, this.registry);
         if (candidate instanceof AbstractBeanDefinition) {
            // å¦‚æœè¿™ä¸ªç±»æ˜¯ AbstractBeanDefinition çš„å­ç±»
            // åˆ™ä¸ºå®ƒè®¾ç½®é»˜è®¤å€¼ï¼Œæ¯”å¦‚ alzyï¼Œinit destroy
            postProcessBeanDefinition((AbstractBeanDefinition) candidate, beanName);
         }
         if (candidate instanceof AnnotatedBeanDefinition) {
            // æ£€æŸ¥å¹¶ä¸”å¤„ç†å¸¸ç”¨çš„æ³¨è§£
            // è¿™é‡Œçš„å¤„ç†ä¸»è¦æ˜¯æŒ‡æŠŠå¸¸ç”¨æ³¨è§£çš„å€¼è®¾ç½®åˆ° AnnotatedBeanDefinition å½“ä¸­
            // å½“å‰å‰ææ˜¯è¿™ä¸ªç±»å¿…é¡»æ˜¯ AnnotatedBeanDefinition ç±»å‹çš„ï¼Œè¯´ç™½äº†å°±æ˜¯åŠ äº†æ³¨è§£çš„ç±»
            AnnotationConfigUtils.processCommonDefinitionAnnotations((AnnotatedBeanDefinition) candidate);
         }
         if (checkCandidate(beanName, candidate)) {
            BeanDefinitionHolder definitionHolder = new BeanDefinitionHolder(candidate, beanName);
            definitionHolder =
                  AnnotationConfigUtils.applyScopedProxyMode(scopeMetadata, definitionHolder, this.registry);
            beanDefinitions.add(definitionHolder);
            // å°±æ˜¯åœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œå°†æ‰«æåŒ…çš„ Bean æ·»åŠ åˆ° map ä¸­
            registerBeanDefinition(definitionHolder, this.registry);
         }
      }
   }
   return beanDefinitions;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 7 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public Set&amp;lt;BeanDefinition&amp;gt; findCandidateComponents(String basePackage) {
   if (this.componentsIndex != null &amp;amp;&amp;amp; indexSupportsIncludeFilters()) {
      return addCandidateComponentsFromIndex(this.componentsIndex, basePackage);
   }
   else {
      return scanCandidateComponents(basePackage);
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç ç¬¬ 6 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;private Set&amp;lt;BeanDefinition&amp;gt; scanCandidateComponents(String basePackage) {
   Set&amp;lt;BeanDefinition&amp;gt; candidates = new LinkedHashSet&amp;lt;&amp;gt;();
   try {
      String packageSearchPath = ResourcePatternResolver.CLASSPATH_ALL_URL_PREFIX +
            resolveBasePackage(basePackage) + &#39;/&#39; + this.resourcePattern;
      Resource[] resources = getResourcePatternResolver().getResources(packageSearchPath);
      boolean traceEnabled = logger.isTraceEnabled();
      boolean debugEnabled = logger.isDebugEnabled();
      for (Resource resource : resources) {
         if (traceEnabled) {
            logger.trace(&amp;quot;Scanning &amp;quot; + resource);
         }
         if (resource.isReadable()) {
            try {
               MetadataReader metadataReader = getMetadataReaderFactory().getMetadataReader(resource);
               if (isCandidateComponent(metadataReader)) {
                  ScannedGenericBeanDefinition sbd = new ScannedGenericBeanDefinition(metadataReader);
                  sbd.setSource(resource);
                  if (isCandidateComponent(sbd)) {
                     if (debugEnabled) {
                        logger.debug(&amp;quot;Identified candidate component class: &amp;quot; + resource);
                     }
                     candidates.add(sbd);
                  }
                  else {
                     if (debugEnabled) {
                        logger.debug(&amp;quot;Ignored because not a concrete top-level class: &amp;quot; + resource);
                     }
                  }
               }
               else {
                  if (traceEnabled) {
                     logger.trace(&amp;quot;Ignored because not matching any filter: &amp;quot; + resource);
                  }
               }
            }
            catch (Throwable ex) {
               throw new BeanDefinitionStoreException(
                     &amp;quot;Failed to read candidate component class: &amp;quot; + resource, ex);
            }
         }
         else {
            if (traceEnabled) {
               logger.trace(&amp;quot;Ignored because not readable: &amp;quot; + resource);
            }
         }
      }
   }
   catch (IOException ex) {
      throw new BeanDefinitionStoreException(&amp;quot;I/O failure during classpath scanning&amp;quot;, ex);
   }
   return candidates;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/parse%E5%89%8D.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/parse%E5%90%8E.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;9&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/bean%E5%B7%A5%E5%8E%82_3.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h1 id=&#34;spring-bean-çš„æ‰©å±•&#34;&gt;Spring Bean çš„æ‰©å±•&lt;/h1&gt;
&lt;h2 id=&#34;beandefinitionregistrypostprocessor&#34;&gt;BeanDefinitionRegistryPostProcessor&lt;/h2&gt;
&lt;h1 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h1&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;//å®ä¾‹åŒ–ä¸€ä¸ªå·¥å‚DefaultListableBeanFactory

org.springframework.context.support.GenericApplicationContext-&amp;gt;GenericApplicationContext()

Â  	1ã€å®ä¾‹åŒ–ä¸€ä¸ªAnnotatedBeanDefinitionReader

	2ã€ClassPathBeanDefinitionScannerï¼Œèƒ½å¤Ÿæ‰«ææˆ‘ä»¬bd,èƒ½å¤Ÿæ‰«æä¸€ä¸ªç±»ï¼Œå¹¶ä¸”è½¬æ¢æˆbd
	
	org.springframework.context.annotation.AnnotationConfigApplicationContext#AnnotationConfigApplicationContext()
	
		å§”æ‰˜AnnotationConfigUtils
	
		org.springframework.context.annotation.AnnotatedBeanDefinitionReader#AnnotatedBeanDefinitionReader()


â€‹			

			org.springframework.context.annotation.AnnotationConfigUtils#registerAnnotationConfigProcessors()


â€‹			

				1ã€æ·»åŠ AnnotationAwareOrderComparatorç±»çš„å¯¹è±¡ï¼Œä¸»è¦å»æ’åº
	
				2ã€ContextAnnotationAutowireCandidateResolver
	
				3ã€å¾€BeanDefinitionMapæ³¨å†Œä¸€ä¸ªConfigurationClassPostProcessor?Â  org.springframework.context.annotation.internalConfigurationAnnotationProcessor
	
					why?å› ä¸ºéœ€è¦åœ¨invokeBeanFactoryPostProcessors
	
					invokeBeanFactoryPostProcessorsä¸»è¦æ˜¯åœ¨springçš„beanFactoryåˆå§‹åŒ–çš„è¿‡ç¨‹ä¸­å»åšä¸€äº›äº‹æƒ…ï¼Œæ€ä¹ˆæ¥åšè¿™äº›äº‹æƒ…å‘¢ï¼Ÿ
	
					å§”æ‰˜äº†å¤šä¸ªå®ç°äº†BeanDefinitionRegistryPostProcessoræˆ–è€…BeanFactoryProcessoræ¥å£çš„ç±»æ¥åšè¿™äº›äº‹æƒ…,æœ‰è‡ªå®šä¹‰çš„ä¹Ÿæœ‰springå†…éƒ¨çš„
	
					å…¶ä¸­ConfigurationClassPostProcessorå°±æ˜¯ä¸€ä¸ªspringå†…éƒ¨çš„BeanDefinitionRegistryPostProcessor
	
					å› ä¸ºå¦‚æœä½ ä¸æ·»åŠ è¿™é‡Œå°±æ²¡æœ‰åŠæ³•å§”æ‰˜ConfigurationClassPostProcessoråšä¸€äº›åŠŸèƒ½
	
					åˆ°åº•å“ªäº›åŠŸèƒ½ï¼Ÿå‚è€ƒä¸‹é¢çš„æ³¨é‡Š
	
				4ã€RequiredAnnotationBeanPostProcessor
	
				.......
	
				org.springframework.context.annotation.AnnotationConfigUtils#registerAnnotationConfigProcessors()
	
					//å¾€BeanDefinitionMapæ³¨å†Œ
	
					org.springframework.context.annotation.AnnotationConfigUtils#registerPostProcessor
	
						//å‡†å¤‡å¥½beanå·¥å‚ï¼Œå®ä¾‹åŒ–å¯¹è±¡
	
						org.springframework.context.support.AbstractApplicationContext#refresh
	
						//å‡†å¤‡å·¥ä½œåŒ…æ‹¬è®¾ç½®å¯åŠ¨æ—¶é—´ï¼Œæ˜¯å¦æ¿€æ´»æ ‡è¯†ä½ï¼Œ åˆå§‹åŒ–å±æ€§æº(property source)é…ç½®
	
							org.springframework.context.support.AbstractApplicationContext#prepareRefresh
	
								//å¾—åˆ°beanFactory?å› ä¸ºéœ€è¦å¯¹beanFactoryè¿›è¡Œè®¾ç½®
	
								org.springframework.context.support.AbstractApplicationContext#obtainFreshBeanFactory
	
									//å‡†å¤‡beanå·¥å‚
	
									1ã€æ·»åŠ ä¸€ä¸ªç±»åŠ è½½å™¨
	
									2ã€æ·»åŠ beanè¡¨è¾¾å¼è§£é‡Šå™¨ï¼Œä¸ºäº†èƒ½å¤Ÿè®©æˆ‘ä»¬çš„beanFactoryå»è§£æbeanè¡¨è¾¾å¼
	
									3ã€æ·»åŠ ä¸€ä¸ªåç½®å¤„ç†å™¨ApplicationContextAwareProcessor
	
									4ã€æ·»åŠ äº†è‡ªåŠ¨æ³¨å…¥åˆ«å¿½ç•¥çš„åˆ—è¡¨
	
									5ã€ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚
	
									6ã€æ·»åŠ äº†ä¸€ä¸ªApplicationListenerDetectoråç½®å¤„ç†å™¨ï¼ˆè‡ªè¡Œç™¾åº¦ï¼‰
	
									org.springframework.context.support.AbstractApplicationContext#prepareBeanFactory
	
										ç›®å‰æ²¡æœ‰ä»»ä½•å®ç°
	
										org.springframework.context.support.AbstractApplicationContext#postProcessBeanFactory
	
											1ã€getBeanFactoryPostProcessors()å¾—åˆ°è‡ªå·±å®šä¹‰çš„ï¼ˆå°±æ˜¯ç¨‹åºå‘˜è‡ªå·±å†™çš„ï¼Œå¹¶ä¸”æ²¡æœ‰äº¤ç»™springç®¡ç†ï¼Œå°±æ˜¯æ²¡æœ‰åŠ ä¸Š@Componentï¼‰
	
											2ã€å¾—åˆ°springå†…éƒ¨è‡ªå·±ç»´æŠ¤çš„BeanDefinitionRegistryPostProcessor
	
											org.springframework.context.support.AbstractApplicationContext#invokeBeanFactoryPostProcessors
	
												//è°ƒç”¨è¿™ä¸ªæ–¹æ³•
	
												//å¾ªç¯æ‰€æœ‰çš„BeanDefinitionRegistryPostProcessor
	
												//è¯¥æ–¹æ³•å†…éƒ¨postProcessor.postProcessBeanDefinitionRegistry
	
												org.springframework.context.support.PostProcessorRegistrationDelegate#invokeBeanDefinitionRegistryPostProcessors
	
													//è°ƒç”¨æ‰©å±•æ–¹æ³•postProcessBeanDefinitionRegistry
	
													org.springframework.beans.factory.support.BeanDefinitionRegistryPostProcessor#postProcessBeanDefinitionRegistry
	
														//æ‹¿å‡ºçš„æ‰€æœ‰bdï¼Œç„¶ååˆ¤æ–­bdæ—¶å€™åŒ…å«äº†@Configurationã€@Importï¼Œ@Compentã€‚ã€‚ã€‚æ³¨è§£
	
														org.springframework.context.annotation.ConfigurationClassPostProcessor#processConfigBeanDefinitions
	
															1ã€çš„åˆ°bdå½“ä¸­æè¿°çš„ç±»çš„å…ƒæ•°æ®ï¼ˆç±»çš„ä¿¡æ¯ï¼‰
	
															2ã€åˆ¤æ–­æ˜¯ä¸æ˜¯åŠ äº†@ConfigurationÂ  Â metadata.isAnnotated(Configuration.class.getName())
	
															3ã€å¦‚æœåŠ äº†@Configurationï¼Œæ·»åŠ åˆ°ä¸€ä¸ªsetå½“ä¸­,æŠŠè¿™ä¸ªsetä¼ ç»™ä¸‹é¢çš„æ–¹æ³•å»è§£æ
	
															org.springframework.context.annotation.ConfigurationClassUtils#checkConfigurationClassCandidate
	
															//æ‰«æåŒ…


â€‹															

															org.springframework.context.annotation.ConfigurationClassParser#parse(java.util.Set&amp;lt;org.springframework.beans.factory.config.BeanDefinitionHolder&amp;gt;)


â€‹																

																org.springframework.context.annotation.ConfigurationClassParser#parse(org.springframework.core.type.AnnotationMetadata, java.lang.String)
	
																	//å°±è¡Œäº†ä¸€ä¸ªç±»å‹å°è£…
	
																	org.springframework.context.annotation.ConfigurationClassParser#processConfigurationClass
	
																	1ã€å¤„ç†å†…éƒ¨ç±» ä¸€èˆ¬ä¸ä¼šå†™å†…éƒ¨ç±»
	
																	org.springframework.context.annotation.ConfigurationClassParser#doProcessConfigurationClass
	
																		//è§£ææ‰«æçš„ä¸€äº›åŸºæœ¬ä¿¡æ¯ï¼Œæ¯”å¦‚æ˜¯å¦è¿‡æ»¤ï¼Œæ¯”å¦‚æ˜¯å¦åŠ å…¥æ–°çš„åŒ…ã€‚ã€‚ã€‚ã€‚ã€‚
	
																		org.springframework.context.annotation.ComponentScanAnnotationParser#parse
	
																			org.springframework.context.annotation.ClassPathBeanDefinitionScanner#doScan
	
																			org.springframework.context.annotation.ClassPathScanningCandidateComponentProvider#findCandidateComponents
	
																				org.springframework.context.annotation.ClassPathScanningCandidateComponentProvider#scanCandidateComponents
&lt;/code&gt;&lt;/pre&gt;
">Springç³»åˆ—ï¼ˆä¸ƒï¼‰Springæºç è§£æ</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/spring-xi-lie-liu-spring-yuan-ma-jie-xi/"" data-c="
          &lt;h1 id=&#34;å…ˆæ¥å†™ä¸€ä¸ªç®€å•çš„-spring-æ¡ˆä¾‹&#34;&gt;å…ˆæ¥å†™ä¸€ä¸ªç®€å•çš„ spring æ¡ˆä¾‹ï¼š&lt;/h1&gt;
&lt;p&gt;1.å‡†å¤‡ä¸€ä¸ªæ¥å£å’Œå®ç°ç±»&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public interface IndexDao {
   void query();
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ¥å£å®ç°ç±»æ·»åŠ  @Reposity è¡¨ç¤ºæŠŠè¿™ä¸ªå¯¹è±¡äº¤ç»™ Spring ç®¡ç†&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Repository(&amp;quot;indexDao&amp;quot;)
public class IndexDaoImpl implements IndexDao {

   @Override
   public void query() {
      System.out.println(&amp;quot;dao...æ¨¡æ‹ŸæŸ¥è¯¢æ•°æ®åº“&amp;quot;);
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2.å‡†å¤‡ä¸€ä¸ªé…ç½®æ–‡ä»¶ç±»&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// è¡¨åè¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»
@Configuration
// æ‰«æåŒ…
@ComponentScan(&amp;quot;com.ssm&amp;quot;)
public class AppConfig {
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3.å‡†å¤‡ä¸€ä¸ªç®€å•çš„æµ‹è¯•ç±»ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¯»å–é…ç½®æ–‡ä»¶&lt;/li&gt;
&lt;li&gt;é€šè¿‡ getBean(&amp;quot;xxx&amp;quot;) è·å¾— Bean å¯¹è±¡&lt;/li&gt;
&lt;li&gt;è°ƒç”¨ Bean å¯¹è±¡çš„æ–¹æ³•&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
   public static void main(String[] args) {
      // æŠŠ Spring æ‰€æœ‰å‰æç¯å¢ƒå‡†å¤‡å¥½
      // 1.è¯»å–é…ç½®æ–‡ä»¶
      AnnotationConfigApplicationContext context =
            new AnnotationConfigApplicationContext(AppConfig.class);
      // 2.è·å¾— Bean å¯¹è±¡ 
      IndexDao indexDao = context.getBean(IndexDao.class);
      // 3.è°ƒç”¨æ–¹æ³•
      indexDao.query();
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;4.æµ‹è¯•ç»“æœ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;dao...æ¨¡æ‹ŸæŸ¥è¯¢æ•°æ®åº“
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;new-annotationconfigapplicationcontextappconfigclass&#34;&gt;new AnnotationConfigApplicationContext(AppConfig.class);&lt;/h1&gt;
&lt;p&gt;ä»æµ‹è¯•ç±» Test å¼€å§‹çœ‹ï¼Œæµ‹è¯•ç±»çš„ç¬¬ 5 è¡Œè¯»å–é…ç½®æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(AppConfig.class);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;äºæ˜¯ç‚¹è¿› AnnotationConfigApplicationContext(AppConfig.class); æ„é€ æ–¹æ³•å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public AnnotationConfigApplicationContext(Class&amp;lt;?&amp;gt;... annotatedClasses) {
   // è¿™é‡Œç”±äºå®ƒæœ‰çˆ¶ç±»ï¼Œæ•…è€Œä¼šå…ˆè°ƒç”¨çˆ¶ç±»çš„æ„é€ æ–¹æ³•ï¼Œç„¶åæ‰ä¼šè°ƒç”¨è‡ªå·±çš„æ„é€ æ–¹æ³•
   // åœ¨è‡ªå·±çš„æ„é€ æ–¹æ³•ä¸­åˆå§‹ä¸€ä¸ªè¯»å–å™¨å’Œæ‰«æå™¨
   this();
   register(annotatedClasses);
   refresh();
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;AnnotationConfigApplicationContext æœ‰çˆ¶ç±»ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class AnnotationConfigApplicationContext extends GenericApplicationContext implements AnnotationConfigRegistry {
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åˆ†æ AnnotationConfigApplicationContext çš„æœ‰å‚ Class&amp;lt;?&amp;gt;... æ„é€ æ–¹æ³•ï¼Œä¸€è¡Œè¡Œçœ‹ï¼Œå…ˆçœ‹ç¬¬ 4 è¡Œä»£ç ï¼šthis()ï¼šè°ƒç”¨æœ¬ç±»çš„æ„é€ æ–¹æ³•ï¼Œä½†æ˜¯ç”±äº AnnotationConfigApplicationContextÂ  æœ‰çˆ¶ç±»ï¼Œäºæ˜¯&lt;strong&gt;å…ˆè°ƒç”¨çˆ¶ç±»çš„æ„é€ æ–¹æ³•&lt;/strong&gt;ï¼Œæˆ‘ä»¬è¿™é‡Œå…ˆçœ‹æœ¬ç±»çš„æ„é€ æ–¹æ³•ã€‚&lt;/p&gt;
&lt;h2 id=&#34;11-annotationconfigapplicationcontext&#34;&gt;1.1 AnnotationConfigApplicationContext()&lt;/h2&gt;
&lt;p&gt;ç¬¬ 7 è¡Œï¼Œåˆ›å»ºäº†ä¸€ä¸ª AnnotatedBeanDefinitionReader å¹¶èµ‹å€¼ç»™ readerï¼Œé‚£è¿™ä¸ª reader æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public AnnotationConfigApplicationContext() {
   /**
    * çˆ¶ç±»çš„æ„é€ æ–¹æ³• super()
    * åˆ›å»ºä¸€ä¸ªè¯»å–æ³¨è§£çš„ Bean å®šä¹‰è¯»å–å™¨ï¼šreader èƒ½è¯»å–è¢«åŠ äº†æ³¨è§£çš„ç±»
    * ä»€ä¹ˆæ˜¯ bean å®šä¹‰ï¼ŸBeanDefinition
    */
   this.reader = new AnnotatedBeanDefinitionReader(this);
   // å®šä¹‰æ‰«æå™¨
   this.scanner = new ClassPathBeanDefinitionScanner(this);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;111-annotatedbeandefinitionreader&#34;&gt;1.1.1 AnnotatedBeanDefinitionReader&lt;/h3&gt;
&lt;p&gt;reader æ˜¯ä¸€ä¸ª AnnotatedBeanDefinitionReaderÂ ç±»å‹çš„å˜é‡ï¼Œé¡¾åæ€ä¹‰ï¼Œreader æ˜¯ä¸€ä¸ªè¯»å–å™¨ï¼Œå¹¶ä¸” AnnotatedBeanDefinitionReaderÂ æ˜¯ä¸€ä¸ªç”¨æ¥è¯»å– â€œè¢«åŠ äº†æ³¨è§£çš„ BeanDefinitionâ€ çš„è¯»å–å™¨ã€‚é‚£ä¹ˆ BeanDefinition åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
 * è¿™ä¸ªç±»é¡¾åæ€ä¹‰æ˜¯ä¸€ä¸ª reader  è¯»å–å™¨
 * è¯»å–ä»€ä¹ˆå‘¢ï¼Ÿé¡¾åæ€ä¹‰è¯»å– AnnotatedBeanDefinitionï¼Œæ„æ€æ˜¯è¯»å–ä¸€ä¸ªè¢«åŠ äº†æ³¨è§£çš„ bean
 * è¿™ä¸ªç±»æ˜¯æ„é€ æ–¹æ³•ä¸­è¢«å®ä¾‹åŒ–çš„
 */
private final AnnotatedBeanDefinitionReader reader;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»ä»£ç ä¸­ä¹Ÿèƒ½çœ‹å‡ºï¼šAnnotatedBeanDefinitionï¼ˆè¢«æ³¨è§£çš„ BeanDefinitionï¼‰ç»§æ‰¿äº† BeanDefinitionï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public interface AnnotatedBeanDefinition extends BeanDefinition {
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;1111-beandefinition&#34;&gt;1.1.1.1 BeanDefinition&lt;/h4&gt;
&lt;p&gt;BeanDefinitionæè¿°äº†ä¸€ä¸ªbeanå®ä¾‹ï¼Œå®ƒå…·æœ‰å±æ€§å€¼ï¼Œæ„é€ å‡½æ•°å‚æ•°å€¼ä»¥åŠå…·ä½“å®ç°æ‰€æä¾›çš„æ›´å¤šä¿¡æ¯ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// Spring å½“ä¸­ç”¨æ¥æè¿° Bean çš„ä¸€ä¸ªæ¥å£
public interface BeanDefinition extends AttributeAccessor, BeanMetadataElement {
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥æƒ³è±¡è¿™æ ·ä¸€ä¸ªéœ€æ±‚ï¼šæœ‰ä¸€ä¸ª Java ç±» User&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;User{
  private String name;
  public void study(){
    
  }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Java ä¸­ä¸€åˆ‡çš†å¯¹è±¡ï¼Œä¸€ä¸ª User ç±»ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®šä¹‰ä¸€ä¸ªä»€ä¹ˆç±»æ¥æè¿° User ç±»å¯¹è±¡å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ç­”æ¡ˆå°±æ˜¯ Class ç±»&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;Class{
  name;        // å…¨é™å®šç±»å
  SimpleName;  // Userç±»å
  Methods[];   // ç±»ä¸­çš„æ‰€æœ‰æ–¹æ³•
  Fields[];    // ç±»ä¸­çš„æ‰€æœ‰å±æ€§
  
  // æ–¹æ³•...
  public Method[] getMethods(){
    
  }
  public String getName(){
    
  }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Java ä¸­çš„ç±»ä½¿ç”¨ Class æ¥æè¿°ï¼›&lt;strong&gt;Spring ä¸­çš„ Bean ä½¿ç”¨ BeanDefinition æ¥æè¿°&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;1112-bean-çš„å››ç§ä½“ç°æ–¹æ³•&#34;&gt;1.1.1.2 Bean çš„å››ç§ä½“ç°æ–¹æ³•ï¼š&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;@Annotation
&lt;ul&gt;
&lt;li&gt;ç»™ä¸€ä¸ªç±»æ·»åŠ  @Componentã€@Serviceã€@Repository æ³¨è§£ï¼Œå°±ä»£è¡¨æŠŠè¯¥ç±»äº¤ç»™ Spring ç®¡ç†ï¼ŒSpring å°±ä¼šåˆ›å»ºä¸€ä¸ª Beanã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Repository
public class IndexDaoImpl implements IndexDao{
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;xml
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ &lt;bean&gt; æ ‡ç­¾åŒæ ·å£°æ˜ä¸€ä¸ª Bean&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;bean id=&amp;quot;dao&amp;quot; class=&amp;quot;com.ssm.dao.impl.IndexDaoImpl&amp;quot; /&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;@Bean
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨@Bean æ³¨è§£ä¹Ÿèƒ½å£°æ˜ä¸€ä¸ª Bean&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Bean
public SqlSessionFactoryBean sqlSessionFactoryBean(DataSource dataSource){
    SqlSessionFactoryBean sqlSessionFactoryBean =  new SqlSessionFactoryBean();
    sqlSessionFactoryBean.setDataSource(dataSource);
    return sqlSessionFactoryBean;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;Spring å†…éƒ¨æä¾›çš„ beanï¼Œå› ä¸ºè‡ªå®šä¹‰çš„ bean æ˜¯ Spring æ‰«æï¼Œç„¶åæŠŠå®ƒæ”¾åˆ°å®¹å™¨ä¸­çš„ï¼ŒSpring ä¹Ÿä¼šå¼€å‘è‡ªå·±çš„ beanï¼Œä¸æ‰«æä¹ŸæŠŠå®ƒæ”¾åˆ°å®¹å™¨å½“ä¸­å»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç»§ç»­æ¥çœ‹ AnnotationConfigApplicationContext çš„è¿™ä¸ªå¸¦å‚ Class&amp;lt;?&amp;gt;... æ„é€ æ–¹æ³•ï¼Œä¸‹é¢æ¥çœ‹ç¬¬ 6 è¡Œï¼Œè°ƒç”¨äº† register æ–¹æ³•ï¼Œå¹¶ä¼ å‚ annotatedClassesï¼Œåœ¨è¿™ä¸ª Test æµ‹è¯•ç±»ä¸­ï¼Œè¿™ä¸ª annotatedClasses å°±æ˜¯ AppConfig.class&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// annotatedClasses åœ¨è¿™é‡Œä»£è¡¨ AppConfig.classï¼šå­˜æ”¾äº†é…ç½®ä¿¡æ¯
register(annotatedClasses);
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;12-registerclass-annotatedclasses&#34;&gt;1.2 register(Class&amp;lt;?&amp;gt;... annotatedClasses)&lt;/h2&gt;
&lt;p&gt;æ¥ä¸‹æ¥ç‚¹è¿›è¿™ä¸ª register(annotatedClasses); æ–¹æ³•ï¼Œè¿™é‡Œçš„ä¸»è¦ä»£ç å°±æ˜¯ç¬¬ 20 è¡Œï¼šthis.reader.register(annotatedClasses); è°ƒç”¨ readerï¼ˆå‰é¢é€šè¿‡ new AnnotatedBeanDefinitionReader(this); åˆå§‹åŒ–è¿‡äº†ï¼‰ çš„ registeræ–¹æ³•&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
 * æ³¨å†Œä¸€ä¸ªæˆ–å¤šä¸ªè¦å¤„ç†çš„å¸¦æ³¨è§£çš„ç±»ã€‚
 *     æ¯”å¦‚æœ‰æ–°åŠ çš„ç±»å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä½†æ˜¯æ³¨å†Œä¹‹åéœ€è¦æ‰‹åŠ¨è°ƒç”¨ refresh() æ–¹æ³•å»è§¦å‘å®¹å™¨è§£ææ³¨è§£ã€‚
 *
 *   æœ‰ä¸¤ä¸ªæ„æ€ï¼š
 *     å®ƒå¯ä»¥æ³¨å†Œä¸€ä¸ªé…ç½®ç±»ï¼šAnnotationConfigApplicationContext context =
 *     new AnnotationConfigApplicationContext(AppConfig.class);
 *     å®ƒè¿˜å¯ä»¥å•ç‹¬æ³¨å†Œä¸€ä¸ª beanï¼šcontext.register(IndexService.class);
 *
 * &amp;lt;p&amp;gt;è¯·æ³¨æ„ï¼Œå¿…é¡»è°ƒç”¨{@link #refreshï¼ˆï¼‰}æ‰èƒ½ä½¿ä¸Šä¸‹æ–‡å®Œå…¨å¤„ç†æ–°ç±»
 * to fully process the new classes.
 * @param annotatedClasses ä¸€ä¸ªæˆ–å¤šä¸ªå¸¦æ³¨è§£çš„ç±»,
 * e.g. {@link Configuration @Configuration} classes
 * @see #scan(String...)
 * @see #refresh()
 */
public void register(Class&amp;lt;?&amp;gt;... annotatedClasses) {
   Assert.notEmpty(annotatedClasses, &amp;quot;At least one annotated class must be specified&amp;quot;);
   // åœ¨this()æ„é€ æ–¹æ³•ä¸­åˆå§‹åŒ–äº† readerï¼Œå°±æ˜¯ä¸ºäº†åœ¨è¿™é‡Œè°ƒç”¨
   this.reader.register(annotatedClasses);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;register(Class&amp;lt;?&amp;gt;... annotatedClasses)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;äºæ˜¯æˆ‘ä»¬ç‚¹è¿›å» reader.register(annotatedClasses); å‘ç°è¿™ä¸ª register å°±æ˜¯ä¸€ä¸ªç©ºå£³æ–¹æ³•ï¼Œå®ƒæœ‰è°ƒç”¨äº† registerBean(annotatedClass); è¿™ä¸ªæ–¹æ³•ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
 * è¿™æ˜¯ä¸€ä¸ªç©ºå£³æ–¹æ³•
 *
 * Register one or more annotated classes to be processed.
 * &amp;lt;p&amp;gt;Calls to {@code register} are idempotent; adding the same
 * annotated class more than once has no additional effect.
 * @param annotatedClasses one or more annotated classes,
 * e.g. {@link Configuration @Configuration} classes
 */
public void register(Class&amp;lt;?&amp;gt;... annotatedClasses) {
   for (Class&amp;lt;?&amp;gt; annotatedClass : annotatedClasses) {
      registerBean(annotatedClass);
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;registerBean&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç»§ç»­ç‚¹è¿›å» registerBean(annotatedClass);æˆ‘ä»¬å‘ç°è¿™ä¸ªæ–¹æ³•åˆè°ƒç”¨äº† doRegisterBean(annotatedClass, null, name, qualifiers); è¿™ä¸ªæ–¹æ³•ï¼Œç»§ç»­ç‚¹è¿›å»&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
 * Register a bean from the given bean class, deriving its metadata from
 * class-declared annotations.
 * @param annotatedClass the class of the bean
 * @param name an explicit name for the bean
 * @param qualifiers specific qualifier annotations to consider,
 * in addition to qualifiers at the bean class level
 */
@SuppressWarnings(&amp;quot;unchecked&amp;quot;)
public void registerBean(Class&amp;lt;?&amp;gt; annotatedClass, String name, Class&amp;lt;? extends Annotation&amp;gt;... qualifiers) {
   doRegisterBean(annotatedClass, null, name, qualifiers);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;121-doregisterbean&#34;&gt;1.2.1 doRegisterBean&lt;/h3&gt;
&lt;p&gt;å½“ä¼ å‚ä¸€ä¸ªå•ç‹¬çš„ Bean æ—¶ï¼šÂ AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(IndexDao.class);&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;&amp;lt;T&amp;gt; void doRegisterBean(Class&amp;lt;T&amp;gt; annotatedClass, @Nullable Supplier&amp;lt;T&amp;gt; instanceSupplier, @Nullable String name,
      @Nullable Class&amp;lt;? extends Annotation&amp;gt;[] qualifiers, BeanDefinitionCustomizer... definitionCustomizers) {

   /**
    *
    * AnnotatedGenericBeanDefinitionï¼šè¢«æ³¨è§£çš„ BeanDefinition(æè¿°Bean)
    * å°† bean æ”¾å…¥ map ä¸­ï¼Œbean çš„ name æ˜¯ map çš„ keyï¼Œ
    * map ä¸­çš„ value ä¸º AnnotatedGenericBeanDefinition å¯¹è±¡
    */
    // å› ä¸º register ä¸­ä¼ é€’è¿‡æ¥çš„å‚æ•°æ˜¯å¸¦æ³¨è§£çš„ Beanï¼Œå³æ­¤ç±»çš„å‚æ•° annotatedClassï¼Œæ‰€ä»¥æ­¤å¤„ä½¿ç”¨ AnnotatedGenericBeanDefinitionï¼ˆè¢«æ³¨è§£çš„BeanDefinitionï¼‰
   AnnotatedGenericBeanDefinition abd = new AnnotatedGenericBeanDefinition(annotatedClass);
   /**
     * åˆ¤æ–­è¿™ä¸ªç±»æ˜¯å¦éœ€è¦è·³è¿‡è§£æ
     * é€šè¿‡ä»£ç å¯ä»¥çŸ¥é“ Spring åˆ¤æ–­æ˜¯å¦è·³è¿‡è§£æï¼Œä¸»è¦åˆ¤æ–­æœ‰æ²¡æœ‰åŠ æ³¨è§£
     */
    // è¿™ä¸ªç±»å¦‚æœæ²¡æœ‰åŠ æ³¨è§£ï¼Œå°±ä¸éœ€è¦è§£æã€‚å› ä¸º AnnotatedGenericBeanDefinition æ˜¯ä¸ºäº†æ³¨å†Œè¢«åŠ äº†æ³¨è§£çš„ï¼›
    // å¦‚æœè¿™ä¸ªç±»æ²¡æœ‰è¢«åŠ æ³¨è§£ï¼Œå°±è·³è¿‡ä¸è§£æ
   if (this.conditionEvaluator.shouldSkip(abd.getMetadata())) {
      return;
   }

   abd.setInstanceSupplier(instanceSupplier);
   /**
    * å¾—åˆ°ç±»çš„ä½œç”¨åŸŸ
    *     å¦‚æœæ˜¯ context.register(SpringConfig.class);åˆ™ä½œç”¨åŸŸæ²¡æœ‰ä»€ä¹ˆä½œç”¨
    *     æ³¨å†Œå•ä¸ªç±»æ—¶éœ€è¦ï¼Œæ¯”å¦‚ï¼šcontext.register(IndexService.class);
    */
   ScopeMetadata scopeMetadata = this.scopeMetadataResolver.resolveScopeMetadata(abd);
   /**
    * å°†ç±»çš„ä½œç”¨åŸŸæ·»åŠ åˆ°æ•°æ®ç»“æ„ä¸­
    * å¦‚æœå‚æ•°ä¸ºä¸€ä¸ªBeanï¼Œè€Œä¸æ˜¯ AppConfig.class å¦‚ new AnnotationConfigApplicationContext(IndexDao.class); å°†Bean å†…å®¹è§£æå‡ºæ¥æ”¾åˆ° AnnotatedGenericBeanDefinition ä¸­
    */
   abd.setScope(scopeMetadata.getScopeName());
   /**
    * ç”Ÿæˆç±»çš„åå­—é€šè¿‡ beanNameGenerator
    */
   String beanName = (name != null ? name : this.beanNameGenerator.generateBeanName(abd, this.registry));

   /**
    * å¤„ç†ç±»å½“ä¸­çš„å…¶ä»–é€šç”¨æ³¨è§£
    * åˆ†ææºç å¯ä»¥çŸ¥é“å®ƒä¸»è¦å¤„ç†ï¼šLazyã€DependsOnã€Primaryã€Role ç­‰æ³¨è§£
    * å¤„ç†å®Œæˆä¹‹å processCommonDefinitionAnnotation ä¸­ä¾ç„¶æ˜¯æŠŠå®ƒæ·»åŠ åˆ°æ•°æ®ç»“æ„ AnnotatedGenericBeanDefinition å½“ä¸­
    */
   AnnotationConfigUtils.processCommonDefinitionAnnotations(abd);
   /**
     * å¦‚æœåœ¨å‘å®¹å™¨æ³¨å†Œæ³¨è§£ @Beanå®šä¹‰æ—¶ï¼Œä½¿ç”¨äº†é¢å¤–çš„é™å®šç¬¦æ³¨è§£åˆ™è§£æ
     * å…³äº Qualifier å’Œ Primary ä¸»è¦æ¶‰åŠåˆ° Spring çš„è‡ªåŠ¨è£…é…
     * è¿™é‡Œéœ€è¦æ³¨æ„çš„
     *     beanName å’Œ qualifier è¿™ä¸ªå˜é‡æ—¶ Annotation ç±»å‹çš„æ•°ç»„ï¼Œé‡Œé¢ä¸ä»…ä»…æ˜¯ Qualifier æ³¨è§£
     *     ç†è®ºä¸Šé‡Œé¢å­˜çš„æ˜¯ä¸€åˆ‡æ³¨è§£ï¼Œæ‰€ä»¥å¯ä»¥çœ‹åˆ°ä¸‹é¢çš„ä»£ç  Spring å»å¾ªç¯äº†è¿™ä¸ªæ•°ç»„
     *     ç„¶åä¾æ¬¡åˆ¤æ–­æ³¨è§£å½“ä¸­æ˜¯å¦åŒ…å«äº† Primaryï¼Œæ˜¯å¦åŒ…å«äº† Lazy
     */
   if (qualifiers != null) {
      for (Class&amp;lt;? extends Annotation&amp;gt; qualifier : qualifiers) {
         if (Primary.class == qualifier) {
            abd.setPrimary(true);
         }
         else if (Lazy.class == qualifier) {
            abd.setLazyInit(true);
         }
         else {
            abd.addQualifier(new AutowireCandidateQualifier(qualifier));
         }
      }
   }
   for (BeanDefinitionCustomizer customizer : definitionCustomizers) {
      customizer.customize(abd);
   }
    /**
     * è¿™ä¸ª BeanDefinitionHolder ä¹Ÿæ˜¯ä¸€ä¸ªæ•°æ®ç»“æ„
     * BeanDefinitionHolder æ˜¯ä¸€ä¸ª mapï¼Œé‡Œé¢æ”¾äº†ä¸€ä¸ª (BeanDefinitionï¼ŒbeanName)
     */
   BeanDefinitionHolder definitionHolder = new BeanDefinitionHolder(abd, beanName);
   definitionHolder = AnnotationConfigUtils.applyScopedProxyMode(scopeMetadata, definitionHolder, this.registry);
   /**
     * æŠŠä¸Šè¿°çš„è¿™ä¸ªæ•°æ®ç»“æ„æ³¨å†Œç»™ registry
     * registry å°±æ˜¯ AnnotationConfigApplicationContext
     * AnnotationConfigApplicationContext åœ¨åˆå§‹åŒ–çš„æ—¶å€™é€šè¿‡è°ƒç”¨çˆ¶ç±»çš„æ„é€ æ–¹æ³•å®ä¾‹åŒ–äº†ä¸€ä¸ª DefaultListableBeanFactory
     * registerBeanDefinition é‡Œé¢å°±æ˜¯æŠŠ definitionHolder è¿™ä¸ªæ•°æ®ç»“æ„åŒ…å«çš„ä¿¡æ¯æ³¨å†Œåˆ° DefaultListableBeanFactory è¿™ä¸ªå·¥å‚
     */
   BeanDefinitionReaderUtils.registerBeanDefinition(definitionHolder, this.registry);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿° deRegisterBean æ–¹æ³•çš„ç¬¬ 28-33 è¡Œï¼Œ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
 * å¾—åˆ°ç±»çš„ä½œç”¨åŸŸ
 *     å¦‚æœæ˜¯ context.register(SpringConfig.class);åˆ™ä½œç”¨åŸŸæ²¡æœ‰ä»€ä¹ˆä½œç”¨
 *     æ³¨å†Œå•ä¸ªç±»æ—¶éœ€è¦ï¼Œæ¯”å¦‚ï¼šcontext.register(IndexService.class);
 */
ScopeMetadata scopeMetadata = this.scopeMetadataResolver.resolveScopeMetadata(abd);
/**
 * å°†ç±»çš„ä½œç”¨åŸŸæ·»åŠ åˆ°æ•°æ®ç»“æ„ä¸­
 */
abd.setScope(scopeMetadata.getScopeName());
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è·å– Bean çš„ä½œç”¨åŸŸå¹¶æ·»åŠ åˆ° adb ä¸­ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%8E%B7%E5%8F%96bean%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%B9%B6%E6%B7%BB%E5%8A%A0%E5%88%B0adb%E4%B8%AD.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h4 id=&#34;1211-processcommondefinitionannotations&#34;&gt;1.2.1.1 processCommonDefinitionAnnotations&lt;/h4&gt;
&lt;p&gt;ä¸Šè¿° deRegisterBean æ–¹æ³•çš„ç¬¬ 44 è¡Œï¼Œè°ƒç”¨äº† processCommonDefinitionAnnotations æ–¹æ³•ï¼Œ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
 * å¤„ç†ç±»å½“ä¸­çš„å…¶ä»–é€šç”¨æ³¨è§£
 * åˆ†ææºç å¯ä»¥çŸ¥é“å®ƒä¸»è¦å¤„ç†ï¼šLazyã€DependsOnã€Primaryã€Role ç­‰æ³¨è§£
 * å¤„ç†å®Œæˆä¹‹å processCommonDefinitionAnnotation ä¸­ä¾ç„¶æ˜¯æŠŠå®ƒæ·»åŠ åˆ°æ•°æ®ç»“æ„ AnnotatedGenericBeanDefinition å½“ä¸­
 */
AnnotationConfigUtils.processCommonDefinitionAnnotations(abd);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç‚¹è¿›å»ï¼Œåˆè°ƒç”¨äº† processCommonDefinitionAnnotations çš„é‡è½½æ–¹æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public static void processCommonDefinitionAnnotations(AnnotatedBeanDefinition abd) {
   // é€šè¿‡ abd.getMetadata() è·å–å…ƒæ•°æ®ï¼š@Scopeã€@DependsOnã€@Qualifierã€@Primary
   processCommonDefinitionAnnotations(abd, abd.getMetadata());
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€šè¿‡ processCommonDefinitionAnnotations æ–¹æ³•è§£æå…ƒæ•°æ®&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;static void processCommonDefinitionAnnotations(AnnotatedBeanDefinition abd, AnnotatedTypeMetadata metadata) {
   AnnotationAttributes lazy = attributesFor(metadata, Lazy.class);
   // å¦‚æœ lazy ä¸ä¸ºç©º
   if (lazy != null) {
      // æŠŠ lazy çš„å€¼æ‹¿å‡ºæ¥ï¼Œæ”¾åˆ° abd(æè¿° Bean å¯¹è±¡çš„) é‡Œé¢å»
      abd.setLazyInit(lazy.getBoolean(&amp;quot;value&amp;quot;));
   }
   else if (abd.getMetadata() != metadata) {
      lazy = attributesFor(abd.getMetadata(), Lazy.class);
      if (lazy != null) {
         abd.setLazyInit(lazy.getBoolean(&amp;quot;value&amp;quot;));
      }
   }
   
   // åˆ¤æ–­æ˜¯å¦æœ‰@Primaryæ³¨è§£ï¼Œå¦‚æœæœ‰ï¼Œæ”¾åˆ° abd(æè¿° Bean å¯¹è±¡çš„) é‡Œé¢å»
   if (metadata.isAnnotated(Primary.class.getName())) {
      abd.setPrimary(true);
   }
   // åˆ¤æ–­æ˜¯å¦æœ‰@DependsOnæ³¨è§£ï¼Œå¦‚æœæœ‰ï¼Œæ”¾åˆ° abd(æè¿° Bean å¯¹è±¡çš„) é‡Œé¢å»
   AnnotationAttributes dependsOn = attributesFor(metadata, DependsOn.class);
   if (dependsOn != null) {
      abd.setDependsOn(dependsOn.getStringArray(&amp;quot;value&amp;quot;));
   }

   if (abd instanceof AbstractBeanDefinition) {
      AbstractBeanDefinition absBd = (AbstractBeanDefinition) abd;
      // åˆ¤æ–­æ˜¯å¦æœ‰@Roleæ³¨è§£ï¼Œå¦‚æœæœ‰ï¼Œæ”¾åˆ° abd(æè¿° Bean å¯¹è±¡çš„) é‡Œé¢å»
      AnnotationAttributes role = attributesFor(metadata, Role.class);
      if (role != null) {
         absBd.setRole(role.getNumber(&amp;quot;value&amp;quot;).intValue());
      }
      // åˆ¤æ–­æ˜¯å¦æœ‰@Descriptionæ³¨è§£ï¼Œå¦‚æœæœ‰ï¼Œæ”¾åˆ° abd(æè¿° Bean å¯¹è±¡çš„) é‡Œé¢å»
      AnnotationAttributes description = attributesFor(metadata, Description.class);
      if (description != null) {
         absBd.setDescription(description.getString(&amp;quot;value&amp;quot;));
      }
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;1212-beandefinitionholder&#34;&gt;1.2.1.2 BeanDefinitionHolder&lt;/h4&gt;
&lt;p&gt;ä¸Šè¿° doRegisterBean æ–¹æ³•çš„73-74 è¡Œï¼Œå®šä¹‰äº†ä¸€ä¸ª BeanDefinitionHolderï¼ŒBeanDefinitionHolder ç±»ä¼¼ä¸€ä¸ª mapï¼Œé‡Œé¢æ”¾äº†ä¸€ä¸ª (BeanDefinitionï¼ŒbeanName)&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
 * è¿™ä¸ª BeanDefinitionHolder ä¹Ÿæ˜¯ä¸€ä¸ªæ•°æ®ç»“æ„
 * BeanDefinitionHolder ç±»ä¼¼ä¸€ä¸ª mapï¼Œé‡Œé¢æ”¾äº†ä¸€ä¸ª (BeanDefinitionï¼ŒbeanName)
 */
BeanDefinitionHolder definitionHolder = new BeanDefinitionHolder(abd, beanName);
definitionHolder = AnnotationConfigUtils.applyScopedProxyMode(scopeMetadata, definitionHolder, this.registry);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é¡¾åæ€ä¹‰ï¼ŒBeanDefinitionRegistry æ˜¯ç”¨æ¥æ³¨å†Œ BeanDefinitionï¼ˆBeançš„å®šä¹‰ï¼‰çš„ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;//ç”¨æ¥æ³¨å†ŒBeançš„å®šä¹‰ BeanDefinition
private final BeanDefinitionRegistry registry;
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/BeanDefinitionRegistry.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;BeanDefinitionRegistryï¼šå°† BeanDifinition æ”¾åˆ° Spring å®¹å™¨ä¸­&lt;/p&gt;
&lt;p&gt;ç‚¹è¿›å» registerBeanDefinition è¿™ä¸ªæ–¹æ³•ï¼Œå‘ç°å°±æ˜¯æ‹¿å‡º BeanDefinitionHolderÂ ä¸­çš„ BeanName å’Œ BeanDefinitionï¼Œå¹¶æŠŠå®ƒæ³¨å†Œåˆ° registry ä¸­ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public static void registerBeanDefinition(
      BeanDefinitionHolder definitionHolder, BeanDefinitionRegistry registry)
      throws BeanDefinitionStoreException {

   // æ‹¿å‡º BeanDefinitionHolder ä¸­çš„ BeanName å’Œ BeanDefinition 
   String beanName = definitionHolder.getBeanName();
   registry.registerBeanDefinition(beanName, definitionHolder.getBeanDefinition());

   // æ³¨å†Œbeanåç§°çš„åˆ«åï¼ˆå¦‚æœæœ‰ï¼‰ã€‚
   String[] aliases = definitionHolder.getAliases();
   if (aliases != null) {
      for (String alias : aliases) {
         registry.registerAlias(beanName, alias);
      }
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ‘ä»¬çœ‹ç¬¬ 7 è¡Œï¼ŒçœŸæ­£çš„å°† BeanName å’Œ BeanDefinition æ³¨å†Œåˆ° registry ä¸­ï¼Œ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;registry.registerBeanDefinition(beanName, definitionHolder.getBeanDefinition());
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç‚¹è¿›å» registerBeanDefinition æ–¹æ³•ï¼š&lt;/p&gt;
&lt;h4 id=&#34;1213-registerbeandefinition&#34;&gt;1.2.1.3 registerBeanDefinition&lt;/h4&gt;
&lt;p&gt;ä¸Šè¿° deRegisterBean æ–¹æ³•çš„ç¬¬ 81 è¡Œï¼ŒæŠŠ &lt;strong&gt;BeanDefinitionHolder&lt;/strong&gt;æ³¨å†Œç»™ registryï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
 * æŠŠä¸Šè¿°çš„è¿™ä¸ªæ•°æ®ç»“æ„æ³¨å†Œç»™ registry
 * registry å°±æ˜¯ AnnotationConfigApplicationContext
 * AnnotationConfigApplicationContext åœ¨åˆå§‹åŒ–çš„æ—¶å€™é€šè¿‡è°ƒç”¨çˆ¶ç±»çš„æ„é€ æ–¹æ³•å®ä¾‹åŒ–äº†ä¸€ä¸ª DefaultListableBeanFactory
 * registerBeanDefinition é‡Œé¢å°±æ˜¯æŠŠ definitionHolder è¿™ä¸ªæ•°æ®ç»“æ„åŒ…å«çš„ä¿¡æ¯æ³¨å†Œåˆ° DefaultListableBeanFactory è¿™ä¸ªå·¥å‚
 */
BeanDefinitionReaderUtils.registerBeanDefinition(definitionHolder, this.registry);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç‚¹è¿› registerBeanDefinition æ–¹æ³•ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public void registerBeanDefinition(String beanName, BeanDefinition beanDefinition)
      throws BeanDefinitionStoreException {

   this.beanFactory.registerBeanDefinition(beanName, beanDefinition);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/beanDefinitionMap_put.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;this.beanDefinitionMap.put(beanName, beanDefinition);&lt;/p&gt;
&lt;p&gt;ç‚¹è¿› registerBeanDefinition æ–¹æ³•å¦‚ä¸‹ï¼Œä¸»è¦æ“ä½œæ˜¯ï¼šå°† (beanName,beanDefiniton)æ”¾åˆ°mapä¸­ï¼Œå°† beanName åŠ å…¥åˆ° list ä¸­ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public void registerBeanDefinition(String beanName, BeanDefinition beanDefinition)
      throws BeanDefinitionStoreException {

   Assert.hasText(beanName, &amp;quot;Bean name must not be empty&amp;quot;);
   Assert.notNull(beanDefinition, &amp;quot;BeanDefinition must not be null&amp;quot;);

   if (beanDefinition instanceof AbstractBeanDefinition) {
      try {
         ((AbstractBeanDefinition) beanDefinition).validate();
      }
      catch (BeanDefinitionValidationException ex) {
         throw new BeanDefinitionStoreException(beanDefinition.getResourceDescription(), beanName,
               &amp;quot;Validation of bean definition failed&amp;quot;, ex);
      }
   }

   BeanDefinition existingDefinition = this.beanDefinitionMap.get(beanName);
   if (existingDefinition != null) {
      if (!isAllowBeanDefinitionOverriding()) {
         throw new BeanDefinitionStoreException(beanDefinition.getResourceDescription(), beanName,
               &amp;quot;Cannot register bean definition [&amp;quot; + beanDefinition + &amp;quot;] for bean &#39;&amp;quot; + beanName +
               &amp;quot;&#39;: There is already [&amp;quot; + existingDefinition + &amp;quot;] bound.&amp;quot;);
      }
      else if (existingDefinition.getRole() &amp;lt; beanDefinition.getRole()) {
         // e.g. was ROLE_APPLICATION, now overriding with ROLE_SUPPORT or ROLE_INFRASTRUCTURE
         if (logger.isWarnEnabled()) {
            logger.warn(&amp;quot;Overriding user-defined bean definition for bean &#39;&amp;quot; + beanName +
                  &amp;quot;&#39; with a framework-generated bean definition: replacing [&amp;quot; +
                  existingDefinition + &amp;quot;] with [&amp;quot; + beanDefinition + &amp;quot;]&amp;quot;);
         }
      }
      else if (!beanDefinition.equals(existingDefinition)) {
         if (logger.isInfoEnabled()) {
            logger.info(&amp;quot;Overriding bean definition for bean &#39;&amp;quot; + beanName +
                  &amp;quot;&#39; with a different definition: replacing [&amp;quot; + existingDefinition +
                  &amp;quot;] with [&amp;quot; + beanDefinition + &amp;quot;]&amp;quot;);
         }
      }
      else {
         if (logger.isDebugEnabled()) {
            logger.debug(&amp;quot;Overriding bean definition for bean &#39;&amp;quot; + beanName +
                  &amp;quot;&#39; with an equivalent definition: replacing [&amp;quot; + existingDefinition +
                  &amp;quot;] with [&amp;quot; + beanDefinition + &amp;quot;]&amp;quot;);
         }
      }
      this.beanDefinitionMap.put(beanName, beanDefinition);
   }
   else {
      if (hasBeanCreationStarted()) {
         // Cannot modify startup-time collection elements anymore (for stable iteration)
         synchronized (this.beanDefinitionMap) {
            // DefaultListableBeanFactory.beanDefinitionMap.put(beanName, beanDefinition)
            this.beanDefinitionMap.put(beanName, beanDefinition);
            List&amp;lt;String&amp;gt; updatedDefinitions = new ArrayList&amp;lt;&amp;gt;(this.beanDefinitionNames.size() + 1);
            updatedDefinitions.addAll(this.beanDefinitionNames);
            updatedDefinitions.add(beanName);
            this.beanDefinitionNames = updatedDefinitions;
            if (this.manualSingletonNames.contains(beanName)) {
               Set&amp;lt;String&amp;gt; updatedSingletons = new LinkedHashSet&amp;lt;&amp;gt;(this.manualSingletonNames);
               updatedSingletons.remove(beanName);
               this.manualSingletonNames = updatedSingletons;
            }
         }
      }
      else {
         // å°† (beanName,beanDefiniton)æ”¾åˆ°mapä¸­
         this.beanDefinitionMap.put(beanName, beanDefinition);
         // å°† beanName åŠ å…¥åˆ° list ä¸­
         this.beanDefinitionNames.add(beanName);
         this.manualSingletonNames.remove(beanName);
      }
      this.frozenBeanDefinitionNames = null;
   }

   if (existingDefinition != null || containsSingleton(beanName)) {
      resetBeanDefinition(beanName);
   }
   else if (isConfigurationFrozen()) {
      clearByTypeCache();
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;beanDefinitionNamesÂ æ˜¯ä¸€ä¸ª List é›†åˆï¼Œå°† Bean å®šä¹‰çš„åå­—æ·»åŠ åˆ°è¿™ä¸ª List é›†åˆä¸­ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/** List of bean definition names, in registration order */
private volatile List&amp;lt;String&amp;gt; beanDefinitionNames = new ArrayList&amp;lt;&amp;gt;(256);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ç¬¬ 67 è¡Œä»£ç æ‰§è¡Œå®Œæ¯•&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;this.beanDefinitionMap.put(beanName, beanDefinition);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;map ä¸­æ·»åŠ äº† 7 ä¸ªå¯¹è±¡ï¼Œä¸€ä¸ªæ˜¯è‡ªå®šä¹‰çš„ indexDaoï¼Œå…¶ä½™ 6 ä¸ªæ˜¯ Spring åœ¨å¯åŠ¨è¿‡ç¨‹ä¸­è‡ªåŠ¨æ·»åŠ çš„&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/map%E6%B7%BB%E5%8A%A07%E4%B8%AA%E5%AF%B9%E8%B1%A1.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;13-refresh&#34;&gt;1.3 refresh()&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;åˆå§‹åŒ– Spring çš„ç¯å¢ƒ&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public void refresh() throws BeansException, IllegalStateException {
   synchronized (this.startupShutdownMonitor) {
      // Prepare this context for refreshing.
      // å‡†å¤‡å·¥ä½œåŒ…æ‹¬è®¾ç½®å¯åŠ¨æ—¶é—´ã€æ˜¯å¦æ¿€æ´»æ ‡è¯†ä½ï¼Œåˆå§‹åŒ–å±æ€§æºï¼ˆproperty sourceï¼‰é…ç½®ï¼ˆè¿™é‡Œä¸å±äº Bean çš„ç”Ÿå‘½å‘¨æœŸå†…ï¼‰
      prepareRefresh();

      // Tell the subclass to refresh the internal bean factory.
      // è·å– DefaultListableBeanFactory
      ConfigurableListableBeanFactory beanFactory = obtainFreshBeanFactory();

      // Prepare the bean factory for use in this context.
      prepareBeanFactory(beanFactory);

      try {
         // Allows post-processing of the bean factory in context subclasses.
         postProcessBeanFactory(beanFactory);

         // Invoke factory processors registered as beans in the context.
         invokeBeanFactoryPostProcessors(beanFactory);

         // Register bean processors that intercept bean creation.
         registerBeanPostProcessors(beanFactory);

         // Initialize message source for this context.
         initMessageSource();

         // Initialize event multicaster for this context.
         initApplicationEventMulticaster();

         // Initialize other special beans in specific context subclasses.
         onRefresh();

         // Check for listener beans and register them.
         registerListeners();

         // Instantiate all remaining (non-lazy-init) singletons.
         finishBeanFactoryInitialization(beanFactory);

         // Last step: publish corresponding event.
         finishRefresh();
      }

      catch (BeansException ex) {
         if (logger.isWarnEnabled()) {
            logger.warn(&amp;quot;Exception encountered during context initialization - &amp;quot; +
                  &amp;quot;cancelling refresh attempt: &amp;quot; + ex);
         }

         // Destroy already created singletons to avoid dangling resources.
         destroyBeans();

         // Reset &#39;active&#39; flag.
         cancelRefresh(ex);

         // Propagate exception to caller.
         throw ex;
      }

      finally {
         // Reset common introspection caches in Spring&#39;s core, since we
         // might not ever need metadata for singleton beans anymore...
         resetCommonCaches();
      }
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å…ˆçœ‹ä¸Šè¿° refresh() çš„ç¬¬ 5 è¡Œï¼Œè°ƒç”¨äº† prepareRefresh() æ–¹æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// å‡†å¤‡å·¥ä½œåŒ…æ‹¬è®¾ç½®å¯åŠ¨æ—¶é—´ã€æ˜¯å¦æ¿€æ´»æ ‡è¯†ä½ï¼Œåˆå§‹åŒ–å±æ€§æºï¼ˆproperty sourceï¼‰é…ç½®ï¼ˆè¿™é‡Œä¸å±äº Bean çš„ç”Ÿå‘½å‘¨æœŸå†…ï¼‰
prepareRefresh();
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;131-preparerefresh&#34;&gt;1.3.1 prepareRefresh()&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;protected void prepareRefresh() {
   // Switch to active.
   this.startupDate = System.currentTimeMillis();
   this.closed.set(false);
   this.active.set(true);

   if (logger.isInfoEnabled()) {
      logger.info(&amp;quot;Refreshing &amp;quot; + this);
   }

   // Initialize any placeholder property sources in the context environment.
   // è¿™ä¸ªæ–¹æ³•ç›®å‰æ²¡æœ‰å­ç±»å»å®ç°
   // ä¼°è®¡ Spring æ˜¯æœŸå¾…åé¢çš„ç‰ˆæœ¬æœ‰å­ç±»å»å®ç°å§
   initPropertySources();

   // Validate that all properties marked as required are resolvable:
   // see ConfigurablePropertyResolver#setRequiredProperties
   // è·å– .properties æ–‡ä»¶æˆ–è€… @Profile ç¯å¢ƒ
   getEnvironment().validateRequiredProperties();

   // Store pre-refresh ApplicationListeners...
   if (this.earlyApplicationListeners == null) {
      this.earlyApplicationListeners = new LinkedHashSet&amp;lt;&amp;gt;(this.applicationListeners);
   }
   else {
      // Reset local application listeners to pre-refresh state.
      this.applicationListeners.clear();
      this.applicationListeners.addAll(this.earlyApplicationListeners);
   }

   // Allow for the collection of early ApplicationEvents,
   // to be published once the multicaster is available...
   this.earlyApplicationEvents = new LinkedHashSet&amp;lt;&amp;gt;();
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;çœ‹ prepareRefresh() æ–¹æ³•çš„ç¬¬ 14 è¡Œï¼Œè°ƒç”¨äº† initPropertySources()ï¼Œè¿™ä¸ªæ–¹æ³•ç›®å‰æ²¡æœ‰å­ç±»å»å®ç°ä¼°è®¡ Spring æ˜¯æœŸå¾…åé¢çš„ç‰ˆæœ¬æœ‰å­ç±»å»å®ç°å§ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;protected void initPropertySources() {
   // For subclasses: do nothing by default.
}```
å†æ¥çœ‹ refresh() çš„ç¬¬ 9 è¡Œ
```java
// å‘Šè¯‰å­ç±» refresh å†…éƒ¨ Beanå·¥å‚
ConfigurableListableBeanFactory beanFactory = obtainFreshBeanFactory();
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;132-obtainfreshbeanfactory&#34;&gt;1.3.2 obtainFreshBeanFactory()&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;protected ConfigurableListableBeanFactory obtainFreshBeanFactory() {
   refreshBeanFactory();
   ConfigurableListableBeanFactory beanFactory = getBeanFactory();
   if (logger.isDebugEnabled()) {
      logger.debug(&amp;quot;Bean factory for &amp;quot; + getDisplayName() + &amp;quot;: &amp;quot; + beanFactory);
   }
   return beanFactory;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;çœ‹ obtainFreshBeanFactory() æ–¹æ³•çš„ç¬¬ 3 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;ConfigurableListableBeanFactory beanFactory = getBeanFactory();
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;1321-getbeanfactory&#34;&gt;1.3.2.1 getBeanFactory()&lt;/h4&gt;
&lt;p&gt;è¿”å› DefaultListableBeanFactory&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public final ConfigurableListableBeanFactory getBeanFactory() {
   return this.beanFactory;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;beanFactory æ˜¯ DefaultListableBeanFactoryÂ  ç±»å‹å˜é‡ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/** Bean factory for this context */
private final DefaultListableBeanFactory beanFactory;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å†çœ‹ refresh() çš„ç¬¬ 19 è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// Invoke factory processors registered as beans in the context.
// è°ƒç”¨åœ¨ä¸Šä¸‹æ–‡ä¸­æ³¨å†Œä¸ºbeançš„å·¥å‚å¤„ç†å™¨ã€‚
invokeBeanFactoryPostProcessors(beanFactory);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ‘ä»¬ç‚¹è¿›è¿™ä¸ª invokeBeanFactoryPostProcessors(beanFactory); æ–¹æ³•çœ‹ï¼š&lt;/p&gt;
&lt;h3 id=&#34;133-invokebeanfactorypostprocessors&#34;&gt;1.3.3 invokeBeanFactoryPostProcessors&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
  * å®ä¾‹åŒ–å¹¶è°ƒç”¨æ‰€æœ‰å·²æ³¨å†Œçš„BeanFactoryPostProcessor Beanï¼Œ
  * éµå¾ªæ˜¾å¼é¡ºåºï¼ˆå¦‚æœç»™å®šçš„è¯ï¼‰ã€‚ 
  * å¿…é¡»åœ¨å•ä¾‹å®ä¾‹åŒ–ä¹‹å‰è°ƒç”¨ã€‚
  */
protected void invokeBeanFactoryPostProcessors(ConfigurableListableBeanFactory beanFactory) {
   PostProcessorRegistrationDelegate.invokeBeanFactoryPostProcessors(beanFactory, getBeanFactoryPostProcessors());

   // Detect a LoadTimeWeaver and prepare for weaving, if found in the meantime
   // (e.g. through an @Bean method registered by ConfigurationClassPostProcessor)
   if (beanFactory.getTempClassLoader() == null &amp;amp;&amp;amp; beanFactory.containsBean(LOAD_TIME_WEAVER_BEAN_NAME)) {
      beanFactory.addBeanPostProcessor(new LoadTimeWeaverAwareProcessor(beanFactory));
      beanFactory.setTempClassLoader(new ContextTypeMatchClassLoader(beanFactory.getBeanClassLoader()));
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ‘ä»¬çœ‹ä¸Šè¿° invokeBeanFactoryPostProcessors æ–¹æ³•ä¸­çš„ç¬¬ 7 è¡Œä»£ç ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;PostProcessorRegistrationDelegate.invokeBeanFactoryPostProcessors(beanFactory, getBeanFactoryPostProcessors());
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™ä¸ª invokeBeanFactoryPostProcessors æ–¹æ³•æ˜¯éå¸¸é‡è¦çš„ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢è¯´çš„äº§ç”Ÿ 7 ä¸ªå¯¹è±¡çš„è¿‡ç¨‹ï¼Œå°±æ˜¯æ­¤æ®µä»£ç å†…å®ç°çš„&lt;/p&gt;
&lt;h1 id=&#34;spring-bean-çš„æ‰©å±•æœ‰å“ªäº›&#34;&gt;Spring Bean çš„æ‰©å±•æœ‰å“ªäº›&lt;/h1&gt;
&lt;h2 id=&#34;aop&#34;&gt;AOP&lt;/h2&gt;
&lt;p&gt;IndexDao é…ç½®äº† AOPï¼ŒAOP ä¸ IndexDao æ²¡æœ‰ä»»ä½•è€¦åˆ&lt;/p&gt;
&lt;p&gt;AOP é€šè¿‡ @AspectJ é…ç½®é€šçŸ¥ã€åˆ‡ç‚¹ï¼Œä¸ IndexDao æ²¡æœ‰ä»»ä½•è€¦åˆï¼Œé‚£ AOP æ˜¯å¦‚ä½•å°† IndexDao å˜æˆä»£ç†çš„å‘¢ï¼Ÿ â€”â€”Spring  Bean çš„æ‰©å±•ï¼ˆæƒ³è®©å®ƒæˆä¸º IndexDaoï¼Œå°±æˆä¸º IndexDaoï¼›æƒ³è®©å®ƒæˆä¸ºä»£ç†ç±»ï¼Œå°±æˆä¸ºä»£ç†ç±»ï¼‰&lt;/p&gt;
&lt;h2 id=&#34;beanpostprocessor&#34;&gt;BeanPostProcessor&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Bean åç½®å¤„ç†å™¨&lt;/li&gt;
&lt;li&gt;BeanPostProcessor æ¥å£ï¼Œèƒ½å¤Ÿæ‰©å±• Spring&lt;/li&gt;
&lt;li&gt;æ‰€æœ‰ BeanPostProcessor æ¥å£çš„å®ç°ç±»ï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯é€šè¿‡ BeanPostProcessor è¿›è¡Œæ‰©å±•ï¼Œå±äºSpring æ‰©å±•çš„ä¸€ç§æ–¹å¼&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Repository(&amp;quot;indexDao&amp;quot;)
public class IndexDaoImpl implements IndexDao {

   public IndexDaoImpl(){
      System.out.println(&amp;quot;indexDao...constructor&amp;quot;);
   }

   @PostConstruct
   public void init(){
      System.out.println(&amp;quot;indexDao...init&amp;quot;);
   }

   @Override
   public void query() {
      System.out.println(&amp;quot;dao...æ¨¡æ‹ŸæŸ¥è¯¢æ•°æ®åº“&amp;quot;);
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ’æ‰‹ Bean çš„æ„å»ºè¿‡ç¨‹ï¼Œå°† Bean å˜ä¸ºä»£ç†å¯¹è±¡å¹¶è¿”å›ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Component
public class TestBeanPostProcessor implements BeanPostProcessor {
   @Override
   public Object postProcessBeforeInitialization(Object bean, String beanName) throws BeansException {
      if(beanName.equals(&amp;quot;indexDao&amp;quot;)){
         System.out.println(&amp;quot;BeforeInitialization...&amp;quot;);
      }
      // è¿”å›ä¸€ä¸ªä»£ç†å¯¹è±¡å‡ºå»
//    Proxy.newProxyInstance()
      return bean;
   }

   @Override
   public Object postProcessAfterInitialization(Object bean, String beanName) throws BeansException {
      if(beanName.equals(&amp;quot;indexDao&amp;quot;)){
         System.out.println(&amp;quot;AfterInitialization...&amp;quot;);
      }
      return bean;
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;indexDao...constructor
BeforeInitialization...
indexDao...init
AfterInitialization...
dao...æ¨¡æ‹ŸæŸ¥è¯¢æ•°æ®åº“
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;å¦‚ä½•æ§åˆ¶å¤šä¸ªåç½®å¤„ç†å™¨çš„é¡ºåº&#34;&gt;å¦‚ä½•æ§åˆ¶å¤šä¸ªåç½®å¤„ç†å™¨çš„é¡ºåºï¼š&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;åç½®å¤„ç†å™¨å®ç° PriorityOrdered æ¥å£ï¼Œé‡å†™ getOrder() æ–¹æ³•ï¼Œå€¼è¶Šå°å°±è¶Šå…ˆæ‰§è¡Œ&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Component
public class TestBeanPostProcessor implements BeanPostProcessor, PriorityOrdered {
   @Override
   public Object postProcessBeforeInitialization(Object bean, String beanName) throws BeansException {
      if(beanName.equals(&amp;quot;indexDao&amp;quot;)){
         System.out.println(&amp;quot;BeforeInitialization...&amp;quot;);
      }
      // è¿”å›ä¸€ä¸ªä»£ç†å¯¹è±¡å‡ºå»
//    Proxy.newProxyInstance()
      return bean;
   }

   @Override
   public Object postProcessAfterInitialization(Object bean, String beanName) throws BeansException {
      if(beanName.equals(&amp;quot;indexDao&amp;quot;)){
         System.out.println(&amp;quot;AfterInitialization...&amp;quot;);
      }
      return bean;
   }

   @Override
   public int getOrder() {
      return 102;
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç¬¬äºŒä¸ªåç½®å¤„ç†å™¨çš„å®šä¹‰ï¼ŒåŒæ ·å®ç° PriorityOrdered æ¥å£ï¼Œé‡å†™ getOrder() æ–¹æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Component
public class TestBeanPostProcessor2 implements BeanPostProcessor, PriorityOrdered {
   @Override
   public Object postProcessBeforeInitialization(Object bean, String beanName) throws BeansException {
      if(beanName.equals(&amp;quot;indexDao&amp;quot;)){
         System.out.println(&amp;quot;BeforeInitialization2...&amp;quot;);
      }
      // è¿”å›ä¸€ä¸ªä»£ç†å¯¹è±¡å‡ºå»
//    Proxy.newProxyInstance()
      return bean;
   }

   @Override
   public Object postProcessAfterInitialization(Object bean, String beanName) throws BeansException {
      if(beanName.equals(&amp;quot;indexDao&amp;quot;)){
         System.out.println(&amp;quot;AfterInitialization2...&amp;quot;);
      }
      return bean;
   }

   @Override
   public int getOrder() {
      return 100;
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‰§è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;indexDao...constructor
BeforeInitialization2...
BeforeInitialization...
indexDao...init
AfterInitialization2...
AfterInitialization...
dao...æ¨¡æ‹ŸæŸ¥è¯¢æ•°æ®åº“
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;beanfactorypostprocessor&#34;&gt;BeanFactoryPostProcessor&lt;/h2&gt;
&lt;p&gt;Spring å·¥å‚åç½®å¤„ç†å™¨&lt;/p&gt;
&lt;h2 id=&#34;beandefinitionregistrypostprocessor&#34;&gt;BeanDefinitionRegistryPostProcessor&lt;/h2&gt;
&lt;h3 id=&#34;134-preparebeanfactorybeanfactory&#34;&gt;1.3.4 prepareBeanFactory(beanFactory)&lt;/h3&gt;
&lt;p&gt;å†æ¥çœ‹ refresh() çš„ç¬¬ 12 è¡Œï¼š prepareBeanFactory(beanFactory);&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;// Prepare the bean factory for use in this context.
prepareBeanFactory(beanFactory);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç‚¹è¿›å» prepareBeanFactory(beanFactory) ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;protected void prepareBeanFactory(ConfigurableListableBeanFactory beanFactory) {
   // Tell the internal bean factory to use the context&#39;s class loader etc.
   beanFactory.setBeanClassLoader(getClassLoader());
   // bean è¡¨è¾¾å¼è§£æå™¨
   beanFactory.setBeanExpressionResolver(new StandardBeanExpressionResolver(beanFactory.getBeanClassLoader()));
   // æ³¨å†Œå±æ€§ç¼–è¾‘å™¨
   beanFactory.addPropertyEditorRegistrar(new ResourceEditorRegistrar(this, getEnvironment()));

   // Configure the bean factory with context callbacks.
   // ä½¿ç”¨ä¸Šä¸‹æ–‡å›è°ƒé…ç½®Beanå·¥å‚ã€‚
   // å‘ List é‡Œé¢æ·»åŠ ä¸€ä¸ªæ•°æ®ï¼šæ·»åŠ ä¸€ä¸ªåç½®ç®¡ç†å™¨ï¼šApplicationContextAwareProcessor å®ç°äº† BeanPostProcessoræ¥å£ï¼šæ’æ‰‹ Bean çš„åˆ›å»ºè¿‡ç¨‹
   beanFactory.addBeanPostProcessor(new ApplicationContextAwareProcessor(this));
   beanFactory.ignoreDependencyInterface(EnvironmentAware.class);
   beanFactory.ignoreDependencyInterface(EmbeddedValueResolverAware.class);
   beanFactory.ignoreDependencyInterface(ResourceLoaderAware.class);
   beanFactory.ignoreDependencyInterface(ApplicationEventPublisherAware.class);
   beanFactory.ignoreDependencyInterface(MessageSourceAware.class);
   beanFactory.ignoreDependencyInterface(ApplicationContextAware.class);

   // BeanFactory interface not registered as resolvable type in a plain factory.
   // MessageSource registered (and found for autowiring) as a bean.
   beanFactory.registerResolvableDependency(BeanFactory.class, beanFactory);
   beanFactory.registerResolvableDependency(ResourceLoader.class, this);
   beanFactory.registerResolvableDependency(ApplicationEventPublisher.class, this);
   beanFactory.registerResolvableDependency(ApplicationContext.class, this);

   // Register early post-processor for detecting inner beans as ApplicationListeners.
   beanFactory.addBeanPostProcessor(new ApplicationListenerDetector(this));

   // Detect a LoadTimeWeaver and prepare for weaving, if found.
   if (beanFactory.containsBean(LOAD_TIME_WEAVER_BEAN_NAME)) {
      beanFactory.addBeanPostProcessor(new LoadTimeWeaverAwareProcessor(beanFactory));
      // Set a temporary ClassLoader for type matching.
      beanFactory.setTempClassLoader(new ContextTypeMatchClassLoader(beanFactory.getBeanClassLoader()));
   }

   // Register default environment beans.
   if (!beanFactory.containsLocalBean(ENVIRONMENT_BEAN_NAME)) {
      beanFactory.registerSingleton(ENVIRONMENT_BEAN_NAME, getEnvironment());
   }
   if (!beanFactory.containsLocalBean(SYSTEM_PROPERTIES_BEAN_NAME)) {
      beanFactory.registerSingleton(SYSTEM_PROPERTIES_BEAN_NAME, getEnvironment().getSystemProperties());
   }
   if (!beanFactory.containsLocalBean(SYSTEM_ENVIRONMENT_BEAN_NAME)) {
      beanFactory.registerSingleton(SYSTEM_ENVIRONMENT_BEAN_NAME, getEnvironment().getSystemEnvironment());
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;çœ‹ prepareBeanFactory(ConfigurableListableBeanFactory beanFactory) çš„ç¬¬ 12 è¡Œå†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// Configure the bean factory with context callbacks.
// ä½¿ç”¨ä¸Šä¸‹æ–‡å›è°ƒé…ç½®Beanå·¥å‚ã€‚
// å‘ List é‡Œé¢æ·»åŠ ä¸€ä¸ªæ•°æ®ï¼šæ·»åŠ ä¸€ä¸ªåç½®ç®¡ç†å™¨ï¼šApplicationContextAwareProcessor å®ç°äº† BeanPostProcessoræ¥å£ï¼šæ’æ‰‹ Bean çš„åˆ›å»ºè¿‡ç¨‹
beanFactory.addBeanPostProcessor(new ApplicationContextAwareProcessor(this));
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å‘ List é‡Œé¢æ·»åŠ ä¸€ä¸ªæ•°æ®ï¼šæ·»åŠ ä¸€ä¸ªåç½®ç®¡ç†å™¨ï¼šApplicationContextAwareProcessor å®ç°äº† BeanPostProcessoræ¥å£ï¼šæ’æ‰‹ Bean çš„åˆ›å»ºè¿‡ç¨‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;class ApplicationContextAwareProcessor implements BeanPostProcessor {
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœæƒ³äº†è§£ ApplicationContextAwareProcessor ç±»ï¼Œå°±å…ˆæ¥çœ‹ä¸€ä¸‹å®ƒå®ç°çš„çˆ¶æ¥å£ BeanPostProcessor ç±»ã€‚&lt;/p&gt;
&lt;h4 id=&#34;1341-beanpostprocessor&#34;&gt;1.3.4.1 BeanPostProcessor&lt;/h4&gt;
&lt;p&gt;å…ˆæ¥çœ‹ä¸€ä¸‹ BeanPostProcessor æ¥å£çš„ç»“æ„ï¼Œä¸€å…±æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/BeanPostProcessor.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
 * BeanPostProcessor æ˜¯ Spring æ¡†æ¶æä¾›çš„ä¸€ä¸ªæ‰©å±•ç±»ç‚¹ï¼ˆSpring æ‰©å±•ä¸æ­¢ä¸€ä¸ªåç½®å¤„ç†å™¨ï¼Œ
 * Spring èƒ½å¤Ÿæ‰©å±•ä¸€ä¸ªç±»ï¼Œå®ƒæä¾›äº†å¾ˆå¤šåç½®å¤„ç†å™¨ï¼Œä½†è¿™ä¸ªåç½®å¤„ç†å™¨éƒ½å±äºä¸€ç§ï¼Œè¿˜æœ‰å…¶ä»–åŠæ³•ï¼‰
 * é€šè¿‡å®ç° BeanPostProcessor æ¥å£ï¼Œç¨‹åºå‘˜å°±å¯æŸ¥æ”¶ bean å®ä¾‹åŒ–çš„è¿‡ç¨‹ï¼Œä»è€Œå‡è½»äº† beanFactory çš„è´Ÿæ‹…
 * å€¼å¾—è¯´æ˜çš„æ˜¯è¿™ä¸ªæ¥å£å¯ä»¥è®¾ç½®å¤šä¸ªï¼Œä¼šå½¢æˆä¸€ä¸ªåˆ—è¡¨ï¼Œ ç„¶åä¾æ¬¡æ‰§è¡Œ
 * ï¼ˆè‡ªå·±å†™çš„åç½®å¤„ç†å™¨åªéœ€æ·»åŠ  @Component å³å¯ï¼ŒSpringå°±ä¼šè‡ªåŠ¨æ‰«ææŠŠå®ƒnewå‡ºæ¥ç„¶åæ·»åŠ åˆ°å®¹å™¨ä¸­ã€‚
 * ä½†æ˜¯ Spring é»˜è®¤çš„æ€ä¹ˆåŠï¼ŸSpring æ‰‹åŠ¨ set æ·»åŠ åˆ°å®¹å™¨ä¸­ï¼‰ 
 * æ¯”å¦‚ AOP å°±æ˜¯åœ¨ bean å®ä¾‹åŒ–åæœŸé—´å°†åˆ‡é¢é€»è¾‘ç»‡å…¥ bean å®ä¾‹ä¸­çš„
 * AOP ä¹Ÿæ­£æ˜¯é€šè¿‡ BeanPostProcessor å’Œ IOC å®¹å™¨å»ºç«‹èµ·äº†è”ç³»
 * ï¼ˆç”± Spring æä¾›çš„é»˜è®¤çš„ PostProcessorï¼ŒSpring æä¾›äº†å¾ˆå¤šé»˜è®¤çš„ PostProcessorï¼Œä¸‹é¢ä¸€ä¸€ä»‹ç»è¿™äº›å®ç°ç±»çš„åŠŸèƒ½ï¼‰
 * å¯ä»¥æ¼”ç¤ºä¸€ä¸‹ BeanPostProcessor çš„ä½¿ç”¨æ–¹å¼ï¼ˆæŠŠåŠ¨æ€ä»£ç†å’Œ IOCã€AOP ç»“åˆèµ·æ¥ä½¿ç”¨ï¼‰
 *
 * åœ¨æ¼”ç¤ºä¹‹å‰å…ˆæ¥ç†Ÿæ‚‰ä¸€ä¸‹è¿™ä¸ªæ¥å£ï¼Œæ˜¯è¿™ä¸ªæ¥å£æœ¬èº«ç‰¹åˆ«ç®€å•ï¼Œä½†æ˜¯å®ƒçš„å®ç°ç±»ç‰¹åˆ«å¤æ‚ã€‚
 * å¯ä»¥çœ‹çœ‹ Spring æä¾›å“ªäº›é»˜è®¤çš„å®ç°
 * æŸ¥çœ‹ç±»çš„å…³ç³»å›¾å°±å¯ä»¥çŸ¥é“ Spring æä¾›äº†ä»¥ä¸‹çš„é»˜è®¤å®ç°ï¼Œç”±äºå®ç°ç±»æ˜¯åœ¨å¤ªå¤šï¼Œæ‰€ä»¥åªæ˜¯è§£é‡Šå‡ ä¸ªå¸¸ç”¨çš„
 * 1.ApplicationContextAwareProcessorï¼ˆsacapï¼‰
 *        acap åç½®å¤„ç†å™¨çš„ä½œç”¨æ˜¯ï¼šå½“åº”ç”¨ç¨‹åºå®šä¹‰çš„ Bean å®ç° ApplicationContextAware æ¥å£æ—¶æ³¨å…¥ ApplicationContext å¯¹è±¡
 *        å½“ç„¶è¿™æ˜¯ä»–çš„ç¬¬ä¸€ä¸ªä½œä¸šï¼Œå®ƒè¿˜æœ‰å…¶ä»–ä½œç”¨ï¼Œè¿™é‡Œå°±ä¸ä¸€ä¸€ä¸¾ä¾‹äº†ï¼Œå¯ä»¥å‚è€ƒæºç 
 *        æˆ‘ä»¬å¯ä»¥é’ˆå¯¹ ApplicationContextAwareProcessor å†™ä¸€ä¸ªä¾‹å­
 * 2.InitDestroyAnnotationBeanPostProcessor
 *     ç”¨æ¥å¤„ç†è‡ªå®šä¹‰çš„åˆå§‹åŒ–æ–¹æ³•å’Œé”€æ¯æ–¹æ³•
 *     Spring ä¸­æä¾›äº†ä¸‰ç§è‡ªå®šä¹‰åˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³•åˆ†åˆ«æ˜¯
 *     â‘  é€šè¿‡ @Bean æŒ‡å®š inti method å’Œ destroy-method å±æ€§
 *     â‘¡ Ban å®ç° InitializingBean æ¥å£å’Œæ˜¾ç° DisposableBean
 *     â‘¢ @PostConstructï¼š@PreDestroy
 *     ä¸ºä»€ä¹ˆ Spring é€šè¿‡è¿™ä¸‰ç§æ–¹å¼éƒ½èƒ½å®Œæˆå¯¹ bean ç”Ÿå‘½å‘¨æœŸçš„å›è°ƒå‘¢ï¼Ÿ
 *     å¯ä»¥é€šè¿‡ InitDestroyAnnotationBeanPostProcessor çš„æºç æ¥è§£é‡Š
 * 3.InstantiationAwareBeanPostProcessor
 * 4.CommonAnnotationBeanPostProcessor
 * 5.AutowiredAnnotationBeanPostProcessor
 * 6.RequiredAnnotationBeanPostProcessor
 * 7.BeanValidationPostProcessor
 * 8.AbstractAutoProxyCreatorï¼šæŠ½è±¡è‡ªåŠ¨ä»£ç†åˆ›å»ºå™¨ï¼šAOP åˆ›å»ºä¸€ä¸ªä»£ç†
 * ......
 *
 *
 * Factory hook that allows for custom modification of new bean instances,
 * e.g. checking for marker interfaces or wrapping them with proxies.
 *
 * &amp;lt;p&amp;gt;ApplicationContexts can autodetect BeanPostProcessor beans in their
 * bean definitions and apply them to any beans subsequently created.
 * Plain bean factories allow for programmatic registration of post-processors,
 * applying to all beans created through this factory.
 *
 * &amp;lt;p&amp;gt;Typically, post-processors that populate beans via marker interfaces
 * or the like will implement {@link #postProcessBeforeInitialization},
 * while post-processors that wrap beans with proxies will normally
 * implement {@link #postProcessAfterInitialization}.
 *
 * @author Juergen Hoeller
 * @since 10.10.2003
 * @see InstantiationAwareBeanPostProcessor
 * @see DestructionAwareBeanPostProcessor
 * @see ConfigurableBeanFactory#addBeanPostProcessor
 * @see BeanFactoryPostProcessor
 */
public interface BeanPostProcessor {

   /**
    *
    * åœ¨ Bean åˆå§‹åŒ–ä¹‹å‰æ‰§è¡Œ
    * Apply this BeanPostProcessor to the given new bean instance &amp;lt;i&amp;gt;before&amp;lt;/i&amp;gt; any bean
    * initialization callbacks (like InitializingBean&#39;s {@code afterPropertiesSet}
    * or a custom init-method). The bean will already be populated with property values.
    * The returned bean instance may be a wrapper around the original.
    * &amp;lt;p&amp;gt;The default implementation returns the given {@code bean} as-is.
    * @param bean the new bean instance
    * @param beanName the name of the bean
    * @return the bean instance to use, either the original or a wrapped one;
    * if {@code null}, no subsequent BeanPostProcessors will be invoked
    * @throws org.springframework.beans.BeansException in case of errors
    * @see org.springframework.beans.factory.InitializingBean#afterPropertiesSet
    */
   @Nullable
   default Object postProcessBeforeInitialization(Object bean, String beanName) throws BeansException {
      return bean;
   }

   /**
    * åœ¨ Bean åˆå§‹åŒ–ä¹‹åæ‰§è¡Œ
    * Apply this BeanPostProcessor to the given new bean instance &amp;lt;i&amp;gt;after&amp;lt;/i&amp;gt; any bean
    * initialization callbacks (like InitializingBean&#39;s {@code afterPropertiesSet}
    * or a custom init-method). The bean will already be populated with property values.
    * The returned bean instance may be a wrapper around the original.
    * &amp;lt;p&amp;gt;In case of a FactoryBean, this callback will be invoked for both the FactoryBean
    * instance and the objects created by the FactoryBean (as of Spring 2.0). The
    * post-processor can decide whether to apply to either the FactoryBean or created
    * objects or both through corresponding {@code bean instanceof FactoryBean} checks.
    * &amp;lt;p&amp;gt;This callback will also be invoked after a short-circuiting triggered by a
    * {@link InstantiationAwareBeanPostProcessor#postProcessBeforeInstantiation} method,
    * in contrast to all other BeanPostProcessor callbacks.
    * &amp;lt;p&amp;gt;The default implementation returns the given {@code bean} as-is.
    * @param bean the new bean instance
    * @param beanName the name of the bean
    * @return the bean instance to use, either the original or a wrapped one;
    * if {@code null}, no subsequent BeanPostProcessors will be invoked
    * @throws org.springframework.beans.BeansException in case of errors
    * @see org.springframework.beans.factory.InitializingBean#afterPropertiesSet
    * @see org.springframework.beans.factory.FactoryBean
    */
   @Nullable
   default Object postProcessAfterInitialization(Object bean, String beanName) throws BeansException {
      return bean;
   }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;AnnotationAwareAspectJAutoProxyCreator å¹¶æ²¡æœ‰æ·»åŠ  @Component æ³¨è§£ï¼Œæ‰€ä»¥ Spring ä¸ä¼šæ‰«æå®ƒ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@SuppressWarnings(&amp;quot;serial&amp;quot;)public class AnnotationAwareAspectJAutoProxyCreator extends AspectJAwareAdvisorAutoProxyCreator {
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ¥ä¸‹æ¥å†å›å›åˆ° prepareBeanFactory(ConfigurableListableBeanFactory beanFactory) çš„ç¬¬ 12 è¡Œå†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;beanFactory.addBeanPostProcessor(new ApplicationContextAwareProcessor(this));
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç°åœ¨æ¥çœ‹ä¸€ä¸‹ addBeanPostProcessor() æ–¹æ³•çš„å®ç°ï¼š&lt;/p&gt;
&lt;h4 id=&#34;1342-addbeanpostprocessorbeanpostprocessor-beanpostprocessor&#34;&gt;1.3.4.2 addBeanPostProcessor(BeanPostProcessor beanPostProcessor)&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Override
public void addBeanPostProcessor(BeanPostProcessor beanPostProcessor) {
   Assert.notNull(beanPostProcessor, &amp;quot;BeanPostProcessor must not be null&amp;quot;);
   // Remove from old position, if any
   this.beanPostProcessors.remove(beanPostProcessor);
   // Track whether it is instantiation/destruction aware
   if (beanPostProcessor instanceof InstantiationAwareBeanPostProcessor) {
      this.hasInstantiationAwareBeanPostProcessors = true;
   }
   if (beanPostProcessor instanceof DestructionAwareBeanPostProcessor) {
      this.hasDestructionAwareBeanPostProcessors = true;
   }
   // Add to end of list
   this.beanPostProcessors.add(beanPostProcessor);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;çœ‹ä¸€ä¸‹ä¸Šè¿° addBeanPostProcessor æ–¹æ³•çš„ç¬¬ 14 è¡Œï¼Œå‘ beanPostProcessors ä¸­æ·»åŠ äº†ä¸€ä¸ª beanPostProcessorï¼Œé‚£ä¹ˆ beanPostProcessorsÂ  æ˜¯ä»€ä¹ˆå‘¢ï¼ŸList&lt;BeanPostProcessor&gt; é›†åˆ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/** BeanPostProcessors to apply in createBean */
private final List&amp;lt;BeanPostProcessor&amp;gt; beanPostProcessors = new CopyOnWriteArrayList&amp;lt;&amp;gt;();
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;postProcessBeforeInitialization&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥çœ‹ ApplicationContextAwareProcessor ç±»æ˜¯å¦‚ä½•å®ç° postProcessBeforeInitialization æ–¹æ³•çš„ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Override
@Nullable
public Object postProcessBeforeInitialization(final Object bean, String beanName) throws BeansException {
   AccessControlContext acc = null;

   if (System.getSecurityManager() != null &amp;amp;&amp;amp;
         (bean instanceof EnvironmentAware || bean instanceof EmbeddedValueResolverAware ||
               bean instanceof ResourceLoaderAware || bean instanceof ApplicationEventPublisherAware ||
               bean instanceof MessageSourceAware || bean instanceof ApplicationContextAware)) {
      acc = this.applicationContext.getBeanFactory().getAccessControlContext();
   }

   if (acc != null) {
      AccessController.doPrivileged((PrivilegedAction&amp;lt;Object&amp;gt;) () -&amp;gt; {
         invokeAwareInterfaces(bean);
         return null;
      }, acc);
   }
   else {
      invokeAwareInterfaces(bean);
   }

   return bean;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;çœ‹ä¸Šè¿° postProcessBeforeInitialization æ–¹æ³•çš„ç¬¬ 20 è¡Œï¼Œè°ƒç”¨äº† invokeAwareInterfaces(bean); æ–¹æ³•ï¼Œå…·ä½“å®ç°å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;private void invokeAwareInterfaces(Object bean) {
   // åˆ¤æ–­è¿™ä¸ª bean æ˜¯ä¸æ˜¯ Aware æ¥å£
   if (bean instanceof Aware) {
      if (bean instanceof EnvironmentAware) {
         ((EnvironmentAware) bean).setEnvironment(this.applicationContext.getEnvironment());
      }
      if (bean instanceof EmbeddedValueResolverAware) {
         ((EmbeddedValueResolverAware) bean).setEmbeddedValueResolver(this.embeddedValueResolver);
      }
      // åˆ¤æ–­è¿™ä¸ª bean æ˜¯ä¸æ˜¯ ResourceLoaderAware æ¥å£
      if (bean instanceof ResourceLoaderAware) {
         ((ResourceLoaderAware) bean).setResourceLoader(this.applicationContext);
      }
      if (bean instanceof ApplicationEventPublisherAware) {
         ((ApplicationEventPublisherAware) bean).setApplicationEventPublisher(this.applicationContext);
      }
      if (bean instanceof MessageSourceAware) {
         ((MessageSourceAware) bean).setMessageSource(this.applicationContext);
      }
      // Spring å¸®åŠ©æˆ‘ä»¬ set äº†ä¸€ä¸ª applicationContext å¯¹è±¡
      // æ‰€ä»¥å½“æˆ‘ä»¬è‡ªå·±çš„ä¸€ä¸ªå¯¹è±¡å®ç°äº† ApplicationContextAware å¯¹è±¡åªéœ€è¦æä¾› setter å°±èƒ½å¾—åˆ° applicationContext
      if (bean instanceof ApplicationContextAware) {
         ((ApplicationContextAware) bean).setApplicationContext(this.applicationContext);
      }
   }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;å•ä¾‹å¯¹è±¡ä¸­æœ‰ä¸€ä¸ª-prototype-å±æ€§ä¼šæœ‰é—®é¢˜å¦‚ä½•è§£å†³&#34;&gt;å•ä¾‹å¯¹è±¡ä¸­æœ‰ä¸€ä¸ª prototype å±æ€§ä¼šæœ‰é—®é¢˜ï¼Œå¦‚ä½•è§£å†³ï¼š&lt;/h1&gt;
&lt;h2 id=&#34;repository&#34;&gt;@Repository&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Repository
@Scope(&amp;quot;prototype&amp;quot;)
public class IndexDaoImpl implements IndexDao {
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;lookup&#34;&gt;@Lookup&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Service
@Scope(&amp;quot;singleton&amp;quot;)
public abstract class IndexService {
    @Lookup
    public abstract IndexDao getIndexDao() ;
    public void service(){
        System.out.println(this);
        System.out.println(getIndexDao());
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;applicationcontextaware&#34;&gt;ApplicationContextAware&lt;/h2&gt;
&lt;p&gt;implements ApplicationContextAwareï¼Œé‡å†™ setApplicationContext æ–¹æ³•&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Service
@Scope(&amp;quot;singleton&amp;quot;)
public class IndexService implements ApplicationContextAware {
    @Autowired
    private IndexDao indexDao;
    private ApplicationContext applicationContext;
    @Override
    public void setApplicationContext(ApplicationContext applicationContext) throws BeansException {
        this.applicationContext = applicationContext;
    }
    public void service(){
        System.out.println(this);
        // å¾—åˆ°åŸå‹å¯¹è±¡
       System.out.println(applicationContext.getBean(&amp;quot;indexDaoImpl&amp;quot;));
    }
}
&lt;/code&gt;&lt;/pre&gt;
">Springç³»åˆ—ï¼ˆå…­ï¼‰Springæºç è§£æ</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/spring-xi-lie-wu-beanfactory-he-factorybean-de-qu-bie/"" data-c="
          &lt;h1 id=&#34;beanfactory-å’Œ-factorybean-çš„åŒºåˆ«&#34;&gt;BeanFactory å’Œ FactoryBean çš„åŒºåˆ«ï¼Ÿ&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;BeanFactory æ˜¯ Spring æä¾›çš„ä¸€ä¸ªå·¥å‚ï¼Œèƒ½å¤Ÿäº§ç”Ÿå¯¹è±¡ã€‚é€šè¿‡ getBean(&amp;quot;xxx&amp;quot;) èƒ½å¤Ÿå¾—åˆ°ä¸€ä¸ª Beanã€‚&lt;/li&gt;
&lt;li&gt;FactoryBean æ˜¯ä¸€ä¸ª Beanï¼šæŠŠä¸€ä¸ªå¯¹è±¡äº¤ç»™ Spring ç®¡ç†ï¼Œå°±å¯ä»¥ç§°ä¹‹ä¸ºä¸€ä¸ª Beanï¼Œå°±æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒFactoryBean å°±æ˜¯ä¸€ä¸ªå— Spring ç®¡ç†çš„å¯¹è±¡ã€‚
&lt;ul&gt;
&lt;li&gt;å½“ä¸€ä¸ªç±»çš„ä¾èµ–å…³ç³»å¾ˆå¤æ‚ï¼Œè€Œæˆ‘ä»¬æƒ³å¯¹å¤–æä¾›ç®€å•çš„å…³ç³»ï¼Œå°±è®©å¤–éƒ¨å¯ä»¥ä½¿ç”¨æ—¶ï¼Œå°±ä½¿ç”¨ FactoryBeanï¼Œç»å…¸åœºæ™¯ï¼šMyBatis ä¸­çš„ SqlSessionFactoryBean å¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœç±»å®ç°äº† FactoryBeanï¼Œé‚£ä¹ˆ Spring å®¹å™¨å½“ä¸­å­˜åœ¨ä¸¤ä¸ªå¯¹è±¡ï¼Œä¸€ä¸ªæ˜¯ getObject() æ–¹æ³•è¿”å›çš„å¯¹è±¡ï¼ˆname=å½“å‰ç±»åï¼‰ï¼›è¿˜æœ‰ä¸€ä¸ªæ˜¯å½“å‰å¯¹è±¡ï¼ˆname=&amp;amp;+å½“å‰ç±»åï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;spring-ä¸­å£°æ˜ä¸€ä¸ª-bean-çš„æ–¹å¼&#34;&gt;Spring ä¸­å£°æ˜ä¸€ä¸ª Bean çš„æ–¹å¼&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;bean&gt;
&lt;/li&gt;
&lt;li&gt;@Service&lt;/li&gt;
&lt;li&gt;@Bean&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;factorybean&#34;&gt;FactoryBean&lt;/h1&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// è¡¨æ˜è¿™æ˜¯ä¸€ä¸ª xml æ–‡ä»¶
@Configuration
// æ³¨è§£æ‰«æåŒ…
@ComponentScan(&amp;quot;com.ssm&amp;quot;)
public class SpringConfig {
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœç±»å®ç°äº† FactoryBeanï¼Œé‚£ä¹ˆ Spring å®¹å™¨å½“ä¸­å­˜åœ¨ä¸¤ä¸ªå¯¹è±¡ï¼Œä¸€ä¸ªæ˜¯ getObject() æ–¹æ³•è¿”å›çš„å¯¹è±¡ TempDaoFactoryBeanï¼›è¿˜æœ‰ä¸€ä¸ªæ˜¯å½“å‰å¯¹è±¡ DaoFactoryBeanã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ Spring å®¹å™¨ä¸­å­˜å‚¨æ—¶ï¼Œå­˜å‚¨çš„ name å€¼æ˜¯ï¼š&lt;/p&gt;
&lt;p&gt;getObject() å¾—åˆ°å¯¹è±¡ï¼šTempDaoFactoryBean å­˜çš„åå­—æ˜¯å½“å‰ç±»æŒ‡å®šçš„åå­—ï¼šdaoFactoryBeanï¼›&lt;/p&gt;
&lt;p&gt;å½“å‰å¯¹è±¡ DaoFactoryBean æ˜¯ &amp;quot;&amp;amp;&amp;quot; + å½“å‰ç±»çš„åå­—ï¼š&amp;amp;daoFactoryBean&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Component(&amp;quot;daoFactoryBean&amp;quot;)
public class DaoFactoryBean implements FactoryBean {

    public void testBean(){
        System.out.println(&amp;quot;testBean...&amp;quot;);
    }

    @Override
    public Object getObject() throws Exception {
        return new TempDaoFactoryBean();
    }

    @Override
    public Class&amp;lt;?&amp;gt; getObjectType() {
        return TempDaoFactoryBean.class;
    }

    @Override
    public boolean isSingleton() {
        return true;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) {
        // AnnotationConfigApplicationContextï¼šæ³¨è§£é…ç½®åº”ç”¨ç¨‹åº
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(SpringConfig.class);
        DaoFactoryBean daoFactoryBean = (DaoFactoryBean) context.getBean(&amp;quot;daoFactoryBean&amp;quot;);
        daoFactoryBean.testBean();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;Exception in thread &amp;quot;main&amp;quot; java.lang.ClassCastException: com.ssm.dao.TempDaoFactoryBean cannot be cast to com.ssm.dao.DaoFactoryBean	at com.ssm.test.Test.main(Test.java:13)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ClassCastExceptionï¼šç±»å‹è½¬æ¢å¼‚å¸¸ã€‚å°†ä¸€ä¸ªå¯¹è±¡é€šè¿‡ @Component(&amp;quot;daoFactoryBean&amp;quot;) æ”¾åˆ° Spring å®¹å™¨ä¸­ï¼Œç„¶åé€šè¿‡context.getBean(&amp;quot;daoFactoryBean&amp;quot;) ç»“æœå´ç±»å‹è½¬æ¢å¼‚å¸¸ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) {
        // AnnotationConfigApplicationContextï¼šæ³¨è§£é…ç½®åº”ç”¨ç¨‹åº
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(SpringConfig.class);
        TempDaoFactoryBean daoFactoryBean = (TempDaoFactoryBean) context.getBean(&amp;quot;daoFactoryBean&amp;quot;);
        daoFactoryBean.test();

    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;FactoryBean...
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) {
        // AnnotationConfigApplicationContextï¼šæ³¨è§£é…ç½®åº”ç”¨ç¨‹åº
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(SpringConfig.class);
        TempDaoFactoryBean daoFactoryBean = (TempDaoFactoryBean) context.getBean(&amp;quot;daoFactoryBean&amp;quot;);
        daoFactoryBean.test();

        DaoFactoryBean bean = (DaoFactoryBean) context.getBean(&amp;quot;&amp;amp;daoFactoryBean&amp;quot;);
        bean.testBean();

    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;FactoryBean...
testBean...
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;final-string-beanname-transformedbeannamename&#34;&gt;final String beanName = transformedBeanName(name);&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ name è·å– beanName&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é€šè¿‡ name è·å– beanNameï¼Œè¿™é‡Œä¸ä½¿ç”¨ name ç›´æ¥ä½œä¸º beanName æœ‰ä¸¤ä¸ªåŸå› ï¼š&lt;/p&gt;
&lt;p&gt;1.name å¯èƒ½ä¼šä»¥ &amp;amp; å­—ç¬¦å¼€å¤´ï¼Œè¡¨åè°ƒç”¨è€…æƒ³è·å– FactoryBean æœ¬èº«ï¼Œè€Œé FactoryBean å®ç°ç±»é”åˆ›å»ºçš„ beanã€‚åœ¨ Spring å·¥å‚ä¸­ï¼ŒFactoryBean çš„å®ç°ç±»å’Œå…¶ä»–çš„æ™®é€š bean å­˜å‚¨æ–¹å¼æ˜¯ä¸€è‡´çš„ï¼Œå³&amp;lt;beanName, bean&amp;gt;ï¼ŒbeanName ä¸­æ˜¯æ²¡æœ‰ &amp;amp; è¿™ä¸ªå­—ç¬¦çš„ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦å°† name çš„é¦–å­—ç¬¦ &amp;amp; ç§»é™¤ï¼Œè¿™æ ·æ‰èƒ½ä»ç¼“å­˜é‡Œå–åˆ° FactoryBean å®ä¾‹ã€‚&lt;/p&gt;
&lt;p&gt;2.è¿˜æ˜¯åˆ«åçš„é—®é¢˜ &lt;alias&gt;.ï¼Œè½¬æ¢éœ€è¦&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/transformedBeanName.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;å¦‚æœæœ‰ä¸€ä¸ªç±»ç›¸å½“å¤æ‚ï¼Œé‡Œé¢æœ‰å¾ˆå¤šä¾èµ–ï¼Œå°±è¦é…ç½®å¾ˆå¤š &lt;property&gt;ï¼Œæœ‰å¯èƒ½æœ‰çš„ä¾èµ–è¿˜å¾—ä¸åˆ°ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;bean id=&amp;quot;temp&amp;quot; class=&amp;quot;com.ssm.dao.TempDaoFactoryBean&amp;quot;&amp;gt;
  &amp;lt;!--å‡è®¾è¿™ä¸ªç±»å†…æœ‰å¾ˆå¤šå±æ€§ï¼Œå°±è¦é…ç½®å¾ˆå¤š &amp;lt;property&amp;gt;--&amp;gt;
&amp;lt;/bean&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class TempDaoFactoryBean{
  Util util;
  Config config;
  String str1;
  String str2;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å‡å¦‚ä¸Šè¿°ç±»æ˜¯ç¬¬ä¸‰æ–¹æ¡†æ¶å†™çš„ï¼Œç”±äºæ˜¯ç¬¬ä¸‰æ–¹æ¡†æ¶ä»£ç ï¼Œä¸å¯èƒ½åˆ°å®ƒçš„æºç ä¸Šå»æ·»åŠ @Componentæ³¨è§£ï¼š&lt;/p&gt;
&lt;p&gt;è§£å†³åŠæ³•1.åœ¨ xml é…ç½®è¿™ä¸ªç±»ï¼›&lt;/p&gt;
&lt;p&gt;è§£å†³åŠæ³•2.é€šè¿‡ JavConfig æŠŠå®ƒ new å‡ºæ¥ï¼Œç„¶åæ·»åŠ ä¸€ä¸ª @Bean æ ‡ç­¾&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// è¡¨æ˜è¿™æ˜¯ä¸€ä¸ª xml æ–‡ä»¶
@Configuration
// æ³¨è§£æ‰«æåŒ…
@ComponentScan(&amp;quot;com.ssm&amp;quot;)
public class SpringConfig {

    @Bean
    public DataSource dataSource(){
        DriverManagerDataSource dataSource = new DriverManagerDataSource();
        dataSource.setDriverClassName(&amp;quot;com.mysql.jdbc.Driver&amp;quot;);
        dataSource.setUsername(&amp;quot;root&amp;quot;);
        dataSource.setPassword(&amp;quot;123456&amp;quot;);
        dataSource.setUrl(&amp;quot;jdbc:mysql://localhost:3306/test&amp;quot;);
        return dataSource;
    }

    @Bean
    public SqlSessionFactoryBean sqlSessionFactoryBean(DataSource dataSource){
        SqlSessionFactoryBean sqlSessionFactoryBean =  new SqlSessionFactoryBean();
        sqlSessionFactoryBean.setDataSource(dataSource);
        return sqlSessionFactoryBean;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;æ¯”å¦‚åœ¨-spring-ä¸­å¼•å…¥ç¬¬ä¸‰æ–¹å·¥å…·-mybatis&#34;&gt;æ¯”å¦‚åœ¨ Spring ä¸­å¼•å…¥ç¬¬ä¸‰æ–¹å·¥å…· Mybatis&lt;/h1&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%BC%95%E5%85%A5%E7%AC%AC%E4%B8%89%E6%96%B9%E5%B7%A5%E5%85%B7.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;1.åœ¨ bean ä¸­é…ç½®ä¸€ä¸ª SqlSessionFactory&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;bean id=&amp;quot;sqlSessionFactory&amp;quot; class=&amp;quot;org.apache.ibatis.session.defaults.DefaultSqlSessionFactory&amp;quot;&amp;gt;&amp;lt;/bean&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2.æˆ‘ä»¬å‘ç° SqlSessionFactory ä¾èµ–äº† Configurationï¼Œäºæ˜¯åœ¨ &lt;bean&gt; é…ç½® Configuration&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/SqlSessionFactory%E4%BE%9D%E8%B5%96Configuration.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;bean id=&amp;quot;configuration&amp;quot; class=&amp;quot;org.apache.ibatis.session.Configuration&amp;quot;&amp;gt;&amp;lt;/bean&amp;gt;
&amp;lt;bean id=&amp;quot;sqlSessionFactory&amp;quot; class=&amp;quot;org.apache.ibatis.session.defaults.DefaultSqlSessionFactory&amp;quot;&amp;gt;
    &amp;lt;constructor-arg ref=&amp;quot;configuration&amp;quot;&amp;gt;&amp;lt;/constructor-arg&amp;gt;
&amp;lt;/bean&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3.Configuration æœ‰è¶…çº§å¤šä¾èµ–ï¼Œå°±éœ€è¦åœ¨ &lt;bean&gt; å†…æ·»åŠ å¾ˆå¤š &lt;property&gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Configuration%E6%9C%89%E5%BE%88%E5%A4%9A%E4%BE%9D%E8%B5%96.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;bean id=&amp;quot;configuration&amp;quot; class=&amp;quot;org.apache.ibatis.session.Configuration&amp;quot;&amp;gt;
  &amp;lt;property&amp;gt;&amp;lt;/property&amp;gt;
  &amp;lt;property&amp;gt;&amp;lt;/property&amp;gt;
  &amp;lt;property&amp;gt;&amp;lt;/property&amp;gt;
  &amp;lt;property&amp;gt;&amp;lt;/property&amp;gt;
  // ......
  &amp;lt;property&amp;gt;&amp;lt;/property&amp;gt;
  &amp;lt;property&amp;gt;&amp;lt;/property&amp;gt;
  &amp;lt;property&amp;gt;&amp;lt;/property&amp;gt;
&amp;lt;/bean&amp;gt;
&amp;lt;bean id=&amp;quot;sqlSessionFactory&amp;quot; class=&amp;quot;org.apache.ibatis.session.defaults.DefaultSqlSessionFactory&amp;quot;&amp;gt;
    &amp;lt;constructor-arg ref=&amp;quot;configuration&amp;quot;&amp;gt;&amp;lt;/constructor-arg&amp;gt;
&amp;lt;/bean&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æ­¤è‡ªå·±é…ç½®ç¬¬ä¸‰æ–¹ä¾èµ–ï¼Œæ“ä½œå¤ªè¿‡å¤æ‚ï¼Œæœ€å¥½çš„åŠæ³•æ˜¯ MyBatis è‡ªå·±æŠŠ Configuration è¿™äº›å¤æ‚ä¾èµ–å…³ç³»éƒ½ç»´æŠ¤å¥½ï¼Œæˆ‘ä»¬ç›´æ¥å¼•å…¥å³å¯ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;bean id=&amp;quot;dao&amp;quot; ref=&amp;quot;sqlSessionFactory&amp;quot;&amp;gt;&amp;lt;/bean&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½†æ˜¯ MyBatis æ— æ³•æ›´æ”¹æˆ‘ä»¬çš„é…ç½®æ–‡ä»¶ï¼Œæ‰€ä»¥å®ƒæ²¡æœ‰åœ°æ–¹å»é…ç½®ï¼Œäºæ˜¯å®ƒæä¾›äº†ä¸€ä¸ª SqlSessionFactoryBean ç±»ï¼Œåœ¨è¿™ä¸ªç±»ä¸­æŠŠè¿™äº›ä¾èµ–å…³ç³»éƒ½ç»´æŠ¤å¥½äº†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;sqlsessionfactorybean&#34;&gt;SqlSessionFactoryBean&lt;/h2&gt;
&lt;p&gt;Mybatisåœ¨ SqlSessionFactoryBean å†…éƒ¨ç»´æŠ¤äº†å„ç§ä¾èµ–å…³ç³»ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/SqlSessionFactoryBean.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;æœ€ç»ˆè¿”å›çš„å¯¹è±¡æ˜¯ SqlSessionFactory&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/SqlSessionFactoryBean%E8%BF%94%E5%9B%9ESqlSessionFactory.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;afterPropertiesSet()&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/afterPropertiesSet.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;buildSqlSessionFactory()&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/buildSqlSessionFactory.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;MyBatis å†…éƒ¨é€šè¿‡ SqlSessionFactoryBean ç»´æŠ¤äº†å„ç§ä¾èµ–å…³ç³»ï¼Œæˆ‘ä»¬åªéœ€ç›´æ¥ä½¿ç”¨ SqlSessionFactoryBean å¯¹è±¡å³å¯è·å¾— SqlSessionFactoryï¼Œæ— éœ€å†æ‰‹åŠ¨ç»´æŠ¤å„ç§ä¾èµ–ã€‚&lt;/p&gt;
&lt;h2 id=&#34;mybatis-é€šè¿‡-sqlsessionfactorybeansetdatasourcedatasource&#34;&gt;MyBatis é€šè¿‡ sqlSessionFactoryBean.setDataSource(dataSource);&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Bean
public DataSource dataSource(){
    DriverManagerDataSource dataSource = new DriverManagerDataSource();
    dataSource.setDriverClassName(&amp;quot;com.mysql.jdbc.Driver&amp;quot;);
    dataSource.setUsername(&amp;quot;root&amp;quot;);
    dataSource.setPassword(&amp;quot;123456&amp;quot;);
    dataSource.setUrl(&amp;quot;jdbc:mysql://localhost:3306/test&amp;quot;);
    return dataSource;
}
@Bean
public SqlSessionFactoryBean sqlSessionFactoryBean(DataSource dataSource){
    SqlSessionFactoryBean sqlSessionFactoryBean =  new SqlSessionFactoryBean();
    sqlSessionFactoryBean.setDataSource(dataSource);
    return sqlSessionFactoryBean;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;è‡ªå®šä¹‰é€šè¿‡-tempdaofactorybeansetmsg1str&#34;&gt;è‡ªå®šä¹‰é€šè¿‡ TempDaoFactoryBean.setMsg1(str);&lt;/h2&gt;
&lt;p&gt;1.JavaConfig é…ç½®æ–‡ä»¶&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// è¡¨æ˜è¿™æ˜¯ä¸€ä¸ª xml æ–‡ä»¶
@Configuration
// æ³¨è§£æ‰«æåŒ…
@ComponentScan(&amp;quot;com.ssm&amp;quot;)
// æ‰«æ xml é…ç½®æ–‡ä»¶
@ImportResource(&amp;quot;classpath:spring.xml&amp;quot;)
public class SpringConfig {
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2.é…ç½®æ–‡ä»¶ xml å†…é…ç½® DaoFactoryBean å¯¹è±¡&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;beans xmlns=&amp;quot;http://www.springframework.org/schema/beans&amp;quot;
       xmlns:xsi=&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;
       xmlns:context=&amp;quot;http://www.springframework.org/schema/context&amp;quot;
       xsi:schemaLocation=&amp;quot;http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context.xsd&amp;quot;&amp;gt;
       
    &amp;lt;bean id=&amp;quot;daoFactory&amp;quot; class=&amp;quot;com.ssm.dao.DaoFactoryBean&amp;quot;&amp;gt;
        &amp;lt;property name=&amp;quot;msg&amp;quot; value=&amp;quot;msg1,msg2,msg3&amp;quot;&amp;gt;&amp;lt;/property&amp;gt;
    &amp;lt;/bean&amp;gt;
&amp;lt;/beans&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3.DaoFactoryBean å†…æœ‰ä¸€å±æ€§ msg&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class DaoFactoryBean implements FactoryBean {
    private String msg;
    public void setMsg(String msg) {
        this.msg = msg;
    }
    @Override
    public Object getObject() throws Exception {
        TempDaoFactoryBean temp = new TempDaoFactoryBean();
        String[] msgArray = msg.split(&amp;quot;,&amp;quot;);
        temp.setMsg1(msgArray[0]);
        temp.setMsg2(msgArray[1]);
        temp.setMsg3(msgArray[2]);
        return temp;
    }
    @Override
    public Class&amp;lt;?&amp;gt; getObjectType() {
        return TempDaoFactoryBean.class;
    }
    @Override
    public boolean isSingleton() {
        return true;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;4.TempDaoFactoryBean å†…æœ‰ä¸‰ä¸ªå±æ€§ï¼šmsg1ã€msg2ã€msg3&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class TempDaoFactoryBean {

    private String msg1;
    private String msg2;
    private String msg3;

    public void test(){
        System.out.println(&amp;quot;FactoryBean...&amp;quot;);
    }

    public void setMsg1(String msg1) {
        this.msg1 = msg1;
    }

    public void setMsg2(String msg2) {
        this.msg2 = msg2;
    }

    public void setMsg3(String msg3) {
        this.msg3 = msg3;
    }

    public String getMsg1() {
        return msg1;
    }

    public String getMsg2() {
        return msg2;
    }

    public String getMsg3() {
        return msg3;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;5.æµ‹è¯•ç±»&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) {
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(SpringConfig.class);
        TempDaoFactoryBean temp = (TempDaoFactoryBean) context.getBean(&amp;quot;daoFactory&amp;quot;);
        System.out.println(temp.getMsg1());

    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;6.æµ‹è¯•ç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;msg1
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@PostConstruct // å½“ bean å®ä¾‹åŒ–æ—¶ï¼Œå›è°ƒè¿™ä¸ªæ³¨è§£ä¿®é¥°çš„æ–¹æ³•ï¼Œè¿›è¡Œåˆå§‹åŒ–æ“ä½œï¼Œæ¯”å¦‚ Redis é¢„çƒ­åœºæ™¯ã€‚
public void init(){
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;spring-å¦‚ä½•å®Œæˆæ‰«æ&#34;&gt;Spring å¦‚ä½•å®Œæˆæ‰«æ&lt;/h1&gt;
&lt;h2 id=&#34;å¦‚ä½•åˆå§‹åŒ–-spring-ç¯å¢ƒ&#34;&gt;å¦‚ä½•åˆå§‹åŒ– Spring ç¯å¢ƒï¼Ÿ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;xmlï¼šClassPathXmlApplicationContextï¼›
&lt;ul&gt;
&lt;li&gt;ç±»çš„æ‰«æ&lt;/li&gt;
&lt;li&gt;å•ç‹¬ bean çš„æ³¨å†Œï¼šåœ¨ xml ä¸­å†™ä¸€ä¸ª&lt;bean&gt;ï¼Œåªè¦è¿™ä¸ª xml è¢«è§£æï¼ŒSpring å°±å¸®åŠ©å®Œæˆäº† bean çš„å£°æ˜ï¼ˆå®šä¹‰&lt;bean&gt;ï¼‰å’Œæ³¨å†Œï¼ˆSpring ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªå¯¹è±¡æ”¾åˆ°å®¹å™¨ä¸­ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ³¨è§£ Annotationï¼šå¿…é¡»å€ŸåŠ© xml:&amp;lt;context:component-scan base-package=&amp;quot;com.ssm&amp;quot;/&amp;gt;æˆ– JavaConfig:@ComponentScan å®Œæˆå¯¹ç±»çš„æ‰«æï¼›&lt;/li&gt;
&lt;li&gt;JavaConfigï¼šAnnotationConfigApplicationContextã€‚
&lt;ul&gt;
&lt;li&gt;ç±»çš„æ‰«æ&lt;/li&gt;
&lt;li&gt;ç±»çš„å®šä¹‰ï¼šå¦‚æœåªæ˜¯å†™äº†ä¸€ä¸ª@Componentï¼Œå¹¶æ²¡æœ‰æ‰«æè¿™ä¸ªç±»ï¼Œç§°ä¸ºåªæ˜¯å®šä¹‰ä¸€ä¸ª beanï¼Œå¹¶æ²¡æœ‰ç±»çš„æ³¨å†Œï¼ˆå› ä¸ºæ²¡æœ‰è¢«æ‰«æ ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆè¦åˆå§‹åŒ– Spring ç¯å¢ƒï¼Ÿ&lt;/p&gt;
&lt;p&gt;æŠŠæˆ‘ä»¬äº¤ç»™ Spring ç®¡ç†çš„ç±»å®ä¾‹åŒ–&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Servicepublic class IndexService {}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// è¡¨æ˜è¿™æ˜¯ä¸€ä¸ª xml æ–‡ä»¶
@Configuration
// æ³¨è§£æ‰«æåŒ…
@ComponentScan(&amp;quot;com.ssm&amp;quot;)
public class SpringConfig {
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;register() å¯ä»¥æ³¨å†Œä¸¤ç§ç±»å‹çš„ beanï¼š1.åŠ äº† @Configuration çš„ beanï¼›2.æ™®é€šçš„ bean&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) {
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext();

        context.register(SpringConfig.class);
        context.refresh();

        // register() å¯ä»¥æ³¨å†Œä¸¤ç§ç±»å‹çš„ beanï¼šåŠ äº† @Configuration çš„ beanï¼›æ™®é€šçš„ bean
//        context.register(TestService.class);
        IndexService indexService = (IndexService) context.getBean(&amp;quot;indexService&amp;quot;);
        System.out.println(indexService);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;com.ssm.service.IndexService@1a451d4d
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(SpringConfig.class);&lt;/p&gt;
&lt;p&gt;![å›¾ç‰‡](https://epitomm.github.io/post-images/é€šè¿‡é…ç½®æ–‡ä»¶new AnnotationConfigApplicationContext.png)&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/register.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;context.register(SpringConfig.class);&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;9&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/register.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;é…ç½®æ–‡ä»¶ä¸æ‰«æåŒ…ï¼Œä½¿ç”¨ register() å•ç‹¬æ³¨å†ŒæŸä¸ªç±»&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// è¡¨æ˜è¿™æ˜¯ä¸€ä¸ª xml æ–‡ä»¶
@Configuration
// æ³¨è§£æ‰«æåŒ…
//@ComponentScan(&amp;quot;com.ssm&amp;quot;)
public class SpringConfig {
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) {
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext();
        // register() æ³¨å†ŒåŠ äº† @Configuration çš„ bean
        context.register(SpringConfig.class);
        // register() æ³¨å†Œæ™®é€šçš„ bean
        context.register(IndexService.class);
        context.refresh();

        IndexService indexService = (IndexService) context.getBean(&amp;quot;indexService&amp;quot;);
        System.out.println(indexService);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;10&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%AF%BB%E5%8F%96JavaConfig%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;11&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/AnnotationConfigApplicationContext%E6%BA%90%E7%A0%81.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;12&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/register%E6%BA%90%E7%A0%81.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;13&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/register%E6%BA%90%E7%A0%81_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;14&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/registerBean%E6%BA%90%E7%A0%81.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;context.scan(&amp;quot;com.ssm&amp;quot;); ä¹Ÿå¯ä»¥å®Œæˆæ‰«æï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) {
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext();

        context.register(SpringConfig.class);
        context.scan(&amp;quot;com.ssm&amp;quot;);
        context.refresh();

        IndexService indexService = (IndexService) context.getBean(&amp;quot;indexService&amp;quot;);
        System.out.println(indexService);

    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/scan%E6%BA%90%E7%A0%81.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/scan%E6%BA%90%E7%A0%81_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/doScan.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/doScan%E6%89%AB%E6%8F%8F%E5%AE%8C%E6%88%90.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;è¿›è¡Œç±»çš„æ‰«ææ—¶ï¼Œæ·»åŠ ä¸€ä¸ªä¾èµ–ï¼Œå°±å¯ä»¥æŒ‰ç´¢å¼•æ‰«æï¼ŒåŠ å¿«æ‰«æé€Ÿåº¦ã€‚&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/findCandidateComponents.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;15&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/scanCandidateComponents.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Retention(RetentionPolicy.RUNTIME)
public @interface Anno {
    public String value();
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Anno(&amp;quot;userServiceImpl&amp;quot;)
public class UserServiceImpl implements UserService {
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class AnnotationConfigApplicationContext {

    public void scan(String basePackage){
        // 1.é€šè¿‡æ–‡ä»¶åå¾—åˆ° .class æ–‡ä»¶ï¼Œç„¶åå»æ‰ .class å°±æ˜¯æœ€ç»ˆçš„ç±»å
        // å¾—åˆ°æ ¹ç›®å½•
        String rootPath = this.getClass().getResource(&amp;quot;/&amp;quot;).getPath();
        // 2. å°† com.ssm å˜ä¸º com/ssm/
        String basePackagePath = basePackage.replaceAll(&amp;quot;\\.&amp;quot;,&amp;quot;\\\\&amp;quot;);

        File file = new File(rootPath + &amp;quot;//&amp;quot; + basePackagePath);
        // å¾—åˆ°æ‰€æœ‰æ–‡ä»¶åçš„æ•°ç»„
        String[] names = file.list();
        for (String name : names) {
            // å»æ‰æ–‡ä»¶çš„ .class å°±å¾—åˆ°äº†ç±»å
            name = name.replaceAll(&amp;quot;.class&amp;quot;,&amp;quot;&amp;quot;);
            // å¾—åˆ°æ‰€æœ‰çš„æ–‡ä»¶å
            try {
                Class&amp;lt;?&amp;gt; clazz = Class.forName(basePackage + &amp;quot;.&amp;quot; + name);
                // åˆ¤æ–­æ˜¯å¦å±äº @Serviceã€@Component...
                // åˆ¤æ–­æ˜¯å¦åŠ äº† @Anno æ³¨è§£
                if(clazz.isAnnotationPresent(Anno.class)){
                    Anno annotation = (Anno)clazz.getAnnotation(Anno.class);
                    System.out.println(annotation.value());
                    System.out.println(clazz.newInstance());
                }
            } catch (ClassNotFoundException e) {
                e.printStackTrace();
            } catch (IllegalAccessException e) {
                e.printStackTrace();
            } catch (InstantiationException e) {
                e.printStackTrace();
            }
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class TestAnno {
    public static void main(String[] args) throws SpringException {
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext();
        context.scan(&amp;quot;com.ssm.service.impl&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;userServiceImpl
com.ssm.service.impl.UserServiceImpl@1d44bcfa
&lt;/code&gt;&lt;/pre&gt;
">Springç³»åˆ—ï¼ˆäº”ï¼‰BeanFactoryå’ŒFactoryBeançš„åŒºåˆ«</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/spring-xi-lie-si-xml-mo-ni-springioc/"" data-c="
          &lt;p&gt;å…ˆæ¥å›é¡¾ä¸€ä¸‹è‡ªå®šä¹‰åŠ¨æ€ä»£ç†ä¸­è·å–å¯¹è±¡çš„æ–¹æ³•ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è·å¾—ä»£ç†å¯¹è±¡ï¼šTestDao proxy = (TestDao) ProxyUtil.newInstance(TestDao.class, new TestCustomHandler(new TestDaoImpl()));&lt;/li&gt;
&lt;li&gt;è·å¾—ç›®æ ‡å¯¹è±¡ï¼šTestDao target = new TestDaoImpl();&lt;br&gt;
ä»¥ä¸Šæ–¹å¼è€¦åˆåº¦è¿‡é«˜&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;spring-ioc-çš„æ€æƒ³&#34;&gt;Spring IOC çš„æ€æƒ³&lt;/h1&gt;
&lt;p&gt;å·¥å‚æ–¹æ³•çš„å¥½å¤„ï¼Œå·¥å‚æ–¹æ³•æ§åˆ¶äº† proxy å¯¹è±¡çš„äº§ç”Ÿè¿‡ç¨‹ï¼Œç°åœ¨è¿™ä¸ªå¯¹è±¡çš„äº§ç”Ÿè¿‡ç¨‹æ˜¯ç”±ç¼–ç æ§åˆ¶çš„ï¼Œé€šè¿‡ newInstance() æ§åˆ¶çš„ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨å·¥å‚çš„è¯ï¼Œå·¥å‚ä¹Ÿå¯ä»¥æ§åˆ¶ç±»çš„äº§ç”Ÿè¿‡ç¨‹ï¼šæ¯”å¦‚é€šè¿‡ç±»åï¼šTestDao proxy = Factory.getBean(&amp;quot;testDao&amp;quot;);ç”±äºå¯ä»¥åšåˆ°è‡ªå·±æ§åˆ¶ï¼Œæå‡ºä¸€ç§æ€æƒ³ï¼šæ³¨å…¥ï¼Œä¾èµ–æŸ¥æ‰¾æŸ¥æ‰¾åä¸º &amp;quot;testDao&amp;quot; çš„ beanï¼Œ&lt;strong&gt;å¯¹è±¡çš„äº§ç”Ÿè¿‡ç¨‹é€šè¿‡å¤–éƒ¨ç¬¬ä¸‰æ–¹å®¹å™¨æ³¨å…¥ç»™æˆ‘&lt;/strong&gt;ï¼Œå¯¹äºç¨‹åºå‘˜æ¥è®²ï¼Œç¼–ç¨‹çš„è¯ï¼Œåªéœ€è¦å†™ TestDao testDao å³å¯ï¼Œè‡³äºè¿™ä¸ªå¯¹è±¡åˆ°åº•æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Œç¨‹åºå‘˜æ— éœ€å…³å¿ƒï¼Œæ˜¯ç”±å¤–éƒ¨å®¹å™¨æ³¨å…¥è¿›æ¥çš„ï¼Œç¨‹åºå‘˜æ­£å¸¸ç¼–ç å³å¯ï¼Œé¢å‘æŠ½è±¡ç¼–ç¨‹è¿™äº›æ–¹æ³•éƒ½æœ‰ï¼Œæ¯”å¦‚ testDao.query();&lt;/p&gt;
&lt;h1 id=&#34;æ¨¡æ‹Ÿ-springaop&#34;&gt;æ¨¡æ‹Ÿ SpringAOP&lt;/h1&gt;
&lt;p&gt;å®ç°å°†å¯¹è±¡äº¤ç»™å®¹å™¨ç®¡ç†&lt;/p&gt;
&lt;h2 id=&#34;userdao&#34;&gt;UserDao&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public interface UserDao {
    void query();
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;userdaoimpl&#34;&gt;UserDaoImpl&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class UserDaoImpl implements UserDao {
    @Override
    public void query() {
        System.out.println(&amp;quot;dao&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;userservice&#34;&gt;UserService&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public interface UserService {
    void find();
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;userserviceimpl&#34;&gt;UserServiceImpl&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class UserServiceImpl implements UserService {

    private UserDao userDao;

    @Override
    public void find() {
        System.out.println(&amp;quot;service...&amp;quot;);
        userDao.query();
    }

    public void setUserDao(UserDao userDao) {
        this.userDao = userDao;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;springxml&#34;&gt;spring.xml&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;!--
    1.å“ªäº›ç±»éœ€è¦æˆ‘ï¼ˆå®¹å™¨ï¼‰æ¥ç®¡ç†
    2.æ€ä¹ˆå‘Šè¯‰æˆ‘è¿™äº›ç±»ï¼š&amp;lt;bean&amp;gt;
    3.æ€ä¹ˆç»´æŠ¤ä¾èµ–å…³ç³»ï¼šsetterã€constructor
    4.æ€ä¹ˆä½“ç° setterï¼š&amp;lt;property&amp;gt; æˆ–è€… constructorï¼š&amp;lt;constructor&amp;gt;
--&amp;gt;
&amp;lt;beans&amp;gt;

    &amp;lt;bean id=&amp;quot;userDao&amp;quot; class = &amp;quot;com.ssm.dao.impl.UserDaoImpl&amp;quot;&amp;gt;&amp;lt;/bean&amp;gt;

    &amp;lt;bean id=&amp;quot;userService&amp;quot; class=&amp;quot;com.ssm.service.impl.UserServiceImpl&amp;quot;&amp;gt;
        &amp;lt;!-- æ³¨å…¥ï¼š1.æ„é€ æ–¹æ³•ï¼›
        2.setæ–¹æ³•ï¼šUserService ä¸­æœ‰ä¸€ä¸ª setUserDao(UserDao userDao)  æ–¹æ³•ï¼Œ
        åªè¦æä¾›äº† UserDaoï¼Œå®¹å™¨è‡ªåŠ¨è°ƒç”¨ setUserDao() æ–¹æ³•ç»™ UserService å†…çš„ UserDao èµ‹å€¼--&amp;gt;
        &amp;lt;property name=&amp;quot;userDao&amp;quot; ref = &amp;quot;userDao&amp;quot;&amp;gt;&amp;lt;/property&amp;gt;
    &amp;lt;/bean&amp;gt;
&amp;lt;/beans&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;è§£æ-xml-çš„æ–¹å¼dom4j&#34;&gt;è§£æ xml çš„æ–¹å¼ï¼šdom4jã€‚&lt;/h2&gt;
&lt;p&gt;dom4j å®˜ç½‘ï¼š&lt;a href=&#34;https://dom4j.github.io/&#34;&gt;https://dom4j.github.io/&lt;/a&gt;&lt;br&gt;
å¯¼å…¥ dom4j ä¾èµ–ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;!-- https://mvnrepository.com/artifact/dom4j/dom4j --&amp;gt;
&amp;lt;dependency&amp;gt;
  &amp;lt;groupId&amp;gt;dom4j&amp;lt;/groupId&amp;gt;
  &amp;lt;artifactId&amp;gt;dom4j&amp;lt;/artifactId&amp;gt;
  &amp;lt;version&amp;gt;1.6.1&amp;lt;/version&amp;gt;
&amp;lt;/dependency&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;å°†å¯¹è±¡äº¤ç»™å®¹å™¨ç®¡ç†setter-æ–¹æ³•æ³¨å…¥&#34;&gt;å°†å¯¹è±¡äº¤ç»™å®¹å™¨ç®¡ç†ï¼ˆsetter æ–¹æ³•æ³¨å…¥ï¼‰&lt;/h2&gt;
&lt;p&gt;è§£æ xml æ–‡ä»¶ï¼Œå°† â€œå¯¹è±¡å-å¯¹è±¡ç±»å‹â€ æ”¾åˆ° map é›†åˆä¸­ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import org.dom4j.Attribute;
import org.dom4j.Document;
import org.dom4j.DocumentException;
import org.dom4j.Element;
import org.dom4j.io.SAXReader;

import java.io.File;
import java.lang.reflect.Field;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.Map;

public class BeanFactory {

    // å¾—åˆ°æ¯ä¸ª bean çš„ idã€class å­˜åˆ° map ä¸­
    Map&amp;lt;String,Object&amp;gt; map = new HashMap&amp;lt;&amp;gt;();

    public BeanFactory(String xml){
        parseXml(xml);
    }

    /**
     * è§£æ XML
     */
    public void parseXml(String xml){
        // è·å–è¦è§£æçš„ xml çš„è·¯å¾„
        File file = new File(this.getClass().getResource(&amp;quot;/&amp;quot;).getPath() + &amp;quot;//&amp;quot; + xml);
        // è§£æ xml
        SAXReader reader = new SAXReader();
        Document document = null;
        try {
            document = reader.read(file);
            // å¾—åˆ°æ ¹ç›®å½•
            Element elementRoot = document.getRootElement();
            // è·å–æ ¹ç›®å½•ä¸‹çš„æ‰€æœ‰å­ç›®å½•
            for (Iterator&amp;lt;Element&amp;gt; itFirst = elementRoot.elementIterator(); itFirst.hasNext();) {
                /**
                 * setup1.å®ä¾‹åŒ–å¯¹è±¡
                 */
                // å¾—åˆ°ç¬¬ä¸€ä¸ªå­å…ƒç´ ï¼šspring.xml ä¸­çš„ &amp;lt;bean&amp;gt;
                Element elementFirstChild = itFirst.next();
                // è·å¾— bean æ ‡ç­¾çš„ id å±æ€§å€¼
                Attribute attributeId = elementFirstChild.attribute(&amp;quot;id&amp;quot;);
                String beanName = attributeId.getValue();
                // è·å¾— bean æ ‡ç­¾çš„ class å±æ€§å€¼
                Attribute attributeClass = elementFirstChild.attribute(&amp;quot;class&amp;quot;);
                String clazzName = attributeClass.getValue();
                Class clazz = Class.forName(clazzName);
                Object object = clazz.newInstance();
                /**
                 * setup2.ç»´æŠ¤ä¾èµ–å…³ç³»
                 *  (1)çœ‹è¿™ä¸ªå¯¹è±¡æœ‰æ²¡æœ‰ä¾èµ–ï¼ˆåˆ¤æ–­ç±»æ˜¯å¦æœ‰å±æ€§ï¼Œç„¶åå†åˆ¤æ–­&amp;lt;bean&amp;gt;ä¸­æ˜¯å¦æœ‰ name=&amp;quot;å±æ€§å€¼&amp;quot;çš„&amp;lt;property&amp;gt;ï¼‰
                 *      å¦‚æœæœ‰ï¼Œåˆ™æ³¨å…¥
                 */
                // å¾—åˆ°&amp;lt;bean&amp;gt;çš„å­æ ‡ç­¾
                for (Iterator&amp;lt;Element&amp;gt; itSecond = elementFirstChild.elementIterator(); itSecond.hasNext();) {
                    // å¾—åˆ° &amp;lt;property name=&amp;quot;userDao&amp;quot; ref = &amp;quot;userDao&amp;quot;&amp;gt;&amp;lt;/property&amp;gt;
                    Element elementSecondChild = itSecond.next();
                    if(&amp;quot;property&amp;quot;.equals(elementSecondChild.getName())){
                        // 1.å¾—åˆ° ref çš„ valueï¼ˆuserDaoï¼‰ï¼Œé€šè¿‡ value å¾—åˆ°å¯¹è±¡ï¼ˆmapä¸­id=&amp;quot;userDao&amp;quot;ï¼‰
                        String refValue = elementSecondChild.attribute(&amp;quot;ref&amp;quot;).getValue();
                        // éœ€è¦æ³¨å…¥çš„å¯¹è±¡ UserDao
                        Object injetObject = map.get(refValue);
                        // 2.å¾—åˆ° name çš„å€¼ï¼ˆuserDaoï¼‰ï¼Œç„¶åæ ¹æ®å®ƒè·å–ä¸€ä¸ª Field çš„å¯¹è±¡ï¼ˆUserServiceImpl ä¸­çš„ UserDao userDaoï¼‰
                        String nameValue = elementSecondChild.attribute(&amp;quot;name&amp;quot;).getValue();
                        // é€šè¿‡åå°„å¾—åˆ° Field å¯¹è±¡ï¼Œå³UserDao
                        Field field = clazz.getDeclaredField(nameValue);
                        field.setAccessible(true);
                        // ç›¸ç­‰äº UserService.setUserDao(userDao)
                        // ä¸¤ä¸ªå‚æ•°ï¼šuserServiceã€UserDao
                        // 3.é€šè¿‡ Field çš„set æ–¹æ³• set è¿™ä¸ªå¯¹è±¡
                        field.set(object,injetObject);
                    }

                }
                // æ”¾åˆ° map ä¸­
                map.put(beanName,object);
            }
        } catch (DocumentException | ClassNotFoundException e) {
            e.printStackTrace();
        } catch (IllegalAccessException e) {
            e.printStackTrace();
        } catch (InstantiationException e) {
            e.printStackTrace();
        } catch (NoSuchFieldException e) {
            e.printStackTrace();
        }
        System.out.println(map);
    }
    public Object getBean(String beanName){
        return map.get(beanName);
    }
}

## æµ‹è¯•ç±»
```java
public class Test {
    public static void main(String[] args) {
        BeanFactory beanFactory = new BeanFactory(&amp;quot;spring.xml&amp;quot;);
        UserService userService = (UserService) beanFactory.getBean(&amp;quot;userService&amp;quot;);
        userService.find();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;##è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{userDao=com.ssm.dao.impl.UserDaoImpl@4dd8dc3, userService=com.ssm.service.impl.UserServiceImpl@6d03e736}
service...
dao
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;æ„é€ æ–¹æ³•æ³¨å…¥&#34;&gt;æ„é€ æ–¹æ³•æ³¨å…¥&lt;/h2&gt;
&lt;h3 id=&#34;userserviceimpluserdao-userdao-æ„é€ æ–¹æ³•&#34;&gt;UserServiceImpl(UserDao userDao) æ„é€ æ–¹æ³•&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class UserServiceImpl implements UserService {
    private UserDao dao;
    public UserServiceImpl(UserDao userDao){
        this.dao = userDao;
    }

    @Override
    public void find() {
        System.out.println(&amp;quot;service...&amp;quot;);
        dao.query();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;###spring.xml&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;    &amp;lt;bean id=&amp;quot;userService&amp;quot; class=&amp;quot;com.ssm.service.impl.UserServiceImpl&amp;quot;&amp;gt;
        &amp;lt;!-- æ³¨å…¥ï¼š1.æ„é€ æ–¹æ³•ï¼›
        2.setæ–¹æ³•ï¼šUserService ä¸­æœ‰ä¸€ä¸ª setUserDao(UserDao userDao)  æ–¹æ³•ï¼Œ
        åªè¦æä¾›äº† UserDaoï¼Œå®¹å™¨è‡ªåŠ¨è°ƒç”¨ setUserDao() æ–¹æ³•ç»™ UserService å†…çš„ UserDao èµ‹å€¼
        name=&amp;quot;dao&amp;quot; :private UserDao dao--&amp;gt;
&amp;lt;!--        &amp;lt;property name=&amp;quot;dao&amp;quot; ref = &amp;quot;userDao&amp;quot;&amp;gt;&amp;lt;/property&amp;gt;--&amp;gt;

        &amp;lt;!-- name=&amp;quot;userDao&amp;quot;ï¼šå±æ€§çš„åå­—ï¼šprivate UserDao dao;
            ref=&amp;quot;userDao&amp;quot;:å¼•å…¥&amp;lt;bean&amp;gt;çš„ id ä¸º userDao çš„å¯¹è±¡--&amp;gt;
        &amp;lt;constructor-arg name=&amp;quot;dao&amp;quot; ref=&amp;quot;userDao&amp;quot;&amp;gt;&amp;lt;/constructor-arg&amp;gt;
    &amp;lt;/bean&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;###è§£æ xml å°†å¯¹è±¡æ”¾åˆ° map ä¸­&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class BeanFactory {

    // å¾—åˆ°æ¯ä¸ª bean çš„ idã€class å­˜åˆ° map ä¸­
    Map&amp;lt;String,Object&amp;gt; map = new HashMap&amp;lt;&amp;gt;();

    public BeanFactory(String xml){
        parseXml(xml);
    }

    /**
     * è§£æ XML
     */
    public void parseXml(String xml){
        // è·å–è¦è§£æçš„ xml çš„è·¯å¾„
        File file = new File(this.getClass().getResource(&amp;quot;/&amp;quot;).getPath() + &amp;quot;//&amp;quot; + xml);
        // è§£æ xml
        SAXReader reader = new SAXReader();
        Document document = null;
        try {
            document = reader.read(file);
            // å¾—åˆ°æ ¹ç›®å½•
            Element elementRoot = document.getRootElement();
            // è·å–æ ¹ç›®å½•ä¸‹çš„æ‰€æœ‰å­ç›®å½•
            for (Iterator&amp;lt;Element&amp;gt; itFirst = elementRoot.elementIterator(); itFirst.hasNext();) {
                /**
                 * setup1.å®ä¾‹åŒ–å¯¹è±¡
                 */
                // å¾—åˆ°ç¬¬ä¸€ä¸ªå­å…ƒç´ ï¼šspring.xml ä¸­çš„ &amp;lt;bean&amp;gt;
                Element elementFirstChild = itFirst.next();
                // è·å¾— bean æ ‡ç­¾çš„ id å±æ€§å€¼
                Attribute attributeId = elementFirstChild.attribute(&amp;quot;id&amp;quot;);
                String beanName = attributeId.getValue();
                // è·å¾— bean æ ‡ç­¾çš„ class å±æ€§å€¼
                Attribute attributeClass = elementFirstChild.attribute(&amp;quot;class&amp;quot;);
                String clazzName = attributeClass.getValue();
                Class clazz = Class.forName(clazzName);
                // å½“ä½¿ç”¨æ„é€ æ–¹æ³•æ³¨å…¥æ—¶ï¼Œå°±ä¸èƒ½åœ¨è¿™é‡Œ newInstance äº†ï¼Œå› ä¸ºæ²¡æœ‰é»˜è®¤æ„é€ æ–¹æ³•äº†
//                Object object = clazz.newInstance();
                Object object = null;
                /**
                 * setup2.ç»´æŠ¤ä¾èµ–å…³ç³»
                 *  (1)çœ‹è¿™ä¸ªå¯¹è±¡æœ‰æ²¡æœ‰ä¾èµ–ï¼ˆåˆ¤æ–­ç±»æ˜¯å¦æœ‰å±æ€§ï¼Œç„¶åå†åˆ¤æ–­&amp;lt;bean&amp;gt;ä¸­æ˜¯å¦æœ‰ name=&amp;quot;å±æ€§å€¼&amp;quot;çš„&amp;lt;property&amp;gt;ï¼‰
                 *      å¦‚æœæœ‰ï¼Œåˆ™æ³¨å…¥
                 */
                // å¾—åˆ°&amp;lt;bean&amp;gt;çš„å­æ ‡ç­¾
                for (Iterator&amp;lt;Element&amp;gt; itSecond = elementFirstChild.elementIterator(); itSecond.hasNext();) {
                    // å¾—åˆ° &amp;lt;property name=&amp;quot;userDao&amp;quot; ref = &amp;quot;userDao&amp;quot;&amp;gt;&amp;lt;/property&amp;gt;
                    Element elementSecondChild = itSecond.next();
                    // å¦‚æœä½¿ç”¨ setter æ–¹æ³•æ³¨å…¥
                    if(&amp;quot;property&amp;quot;.equals(elementSecondChild.getName())){
                        // ç”±äºæ˜¯ setter æ³¨å…¥ï¼Œæœ‰ä¸€ä¸ªé»˜è®¤æ„é€ æ–¹æ³•ï¼Œå¯ä»¥ newInstance()
                        object = clazz.newInstance();
                        // 1.å¾—åˆ° ref çš„ valueï¼ˆuserDaoï¼‰ï¼Œé€šè¿‡ value å¾—åˆ°å¯¹è±¡ï¼ˆmapä¸­id=&amp;quot;userDao&amp;quot;ï¼‰
                        String refValue = elementSecondChild.attribute(&amp;quot;ref&amp;quot;).getValue();
                        // éœ€è¦æ³¨å…¥çš„å¯¹è±¡ UserDao
                        Object injectObject = map.get(refValue);
                        // 2.å¾—åˆ° name çš„å€¼ï¼ˆuserDaoï¼‰ï¼Œç„¶åæ ¹æ®å®ƒè·å–ä¸€ä¸ª Field çš„å¯¹è±¡ï¼ˆUserServiceImpl ä¸­çš„ UserDao userDaoï¼‰
                        String nameValue = elementSecondChild.attribute(&amp;quot;name&amp;quot;).getValue();

                        // 3.é€šè¿‡ Field çš„set æ–¹æ³• set è¿™ä¸ªå¯¹è±¡
                        // é€šè¿‡åå°„å¾—åˆ° Field å¯¹è±¡ï¼Œå³UserDao
                        Field field = clazz.getDeclaredField(nameValue);
                        field.setAccessible(true);
                        // ç›¸ç­‰äº UserService.setUserDao(userDao)
                        // ä¸¤ä¸ªå‚æ•°ï¼šuserServiceã€UserDao
                        field.set(object,injectObject);
                    }else {// é€šè¿‡æ„é€ æ–¹æ³•æ³¨å…¥ UserDao
                        // &amp;lt;constructor-arg name=&amp;quot;userDao&amp;quot; ref=&amp;quot;userDao&amp;quot;&amp;gt;&amp;lt;/constructor-arg&amp;gt;
                        // ç”±äºæ²¡æœ‰é»˜è®¤æ„é€ æ–¹æ³•äº†ï¼Œæ‰€ä»¥ä¸å¯ä»¥ clazz.newInstance() äº†
                        // 1.å¾—åˆ° ref çš„ valueï¼ˆuserDaoï¼‰ï¼Œé€šè¿‡ value å¾—åˆ°å¯¹è±¡ï¼ˆmapä¸­id=&amp;quot;userDao&amp;quot;ï¼‰
                        String refValue = elementSecondChild.attribute(&amp;quot;ref&amp;quot;).getValue();
                        // éœ€è¦æ³¨å…¥çš„å¯¹è±¡ UserDao
                        Object injectObject = map.get(refValue);
                        // å¾—åˆ° UserDao çš„ç±»å‹
                        Class injectObjectClazz = injectObject.getClass();
                        // 2.å¾—åˆ° UserService çš„æ„é€ æ–¹æ³•
                        Constructor constructor = clazz.getConstructor(injectObjectClazz.getInterfaces()[0]);
                        //  public UserServiceImpl(UserDao userDao){
                        object = constructor.newInstance(injectObject);

                    }

                }
                // æ”¾åˆ° map ä¸­
                if(object == null){ //æ²¡æœ‰å­æ ‡ç­¾ï¼Œæ¯”å¦‚  &amp;lt;bean id=&amp;quot;userDao&amp;quot; class = &amp;quot;com.ssm.dao.impl.UserDaoImpl&amp;quot;&amp;gt;&amp;lt;/bean&amp;gt;
                    object = clazz.newInstance();
                }
                map.put(beanName,object);
            }
        } catch (DocumentException | ClassNotFoundException e) {
            e.printStackTrace();
        } catch (IllegalAccessException e) {
            e.printStackTrace();
        } catch (InstantiationException e) {
            e.printStackTrace();
        } catch (NoSuchFieldException e) {
            e.printStackTrace();
        } catch (NoSuchMethodException e) {
            e.printStackTrace();
        } catch (InvocationTargetException e) {
            e.printStackTrace();
        }
        System.out.println(map);
    }
    public Object getBean(String beanName){
        return map.get(beanName);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;è‡ªåŠ¨æ³¨å…¥&#34;&gt;è‡ªåŠ¨æ³¨å…¥&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class UserDaoImpl implements UserDao {
    @Override
    public void query() {
        System.out.println(&amp;quot;dao&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class UserDaoImpl2 implements UserDao {
    @Override
    public void query() {
        System.out.println(&amp;quot;dao2&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;UserServiceImpl ä¾èµ– UserDaoï¼Œä½†æ˜¯æ—¢ä¸æä¾›æ„é€ æ–¹æ³•ï¼Œä¹Ÿä¸æä¾› setterã€‚ä½¿ç”¨ byType è‡ªåŠ¨æ³¨å…¥ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class UserServiceImpl implements UserService {
    private UserDao userDao;
    @Override
    public void find() {
        System.out.println(&amp;quot;service...&amp;quot;);
        userDao.query();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;beans default-autowire=&amp;quot;byType&amp;quot;&amp;gt;
    &amp;lt;bean id=&amp;quot;userDao&amp;quot; class = &amp;quot;com.ssm.dao.impl.UserDaoImpl&amp;quot;&amp;gt;&amp;lt;/bean&amp;gt;
    &amp;lt;bean id=&amp;quot;userDao2&amp;quot; class = &amp;quot;com.ssm.dao.impl.UserDaoImpl2&amp;quot;&amp;gt;&amp;lt;/bean&amp;gt;

    &amp;lt;bean id=&amp;quot;userService&amp;quot; class=&amp;quot;com.ssm.service.impl.UserServiceImpl&amp;quot;&amp;gt;&amp;lt;/bean&amp;gt;
&amp;lt;/beans&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class BeanFactory {

    // å¾—åˆ°æ¯ä¸ª bean çš„ idã€class å­˜åˆ° map ä¸­
    Map&amp;lt;String,Object&amp;gt; map = new HashMap&amp;lt;&amp;gt;();

    public BeanFactory(String xml)throws  SpringException{
        parseXml(xml);
    }

    /**
     * è§£æ XML
     */
    public void parseXml(String xml) throws SpringException{
        // è·å–è¦è§£æçš„ xml çš„è·¯å¾„
        File file = new File(this.getClass().getResource(&amp;quot;/&amp;quot;).getPath() + &amp;quot;//&amp;quot; + xml);
        // è§£æ xml
        SAXReader reader = new SAXReader();
        Document document = null;
        try {
            document = reader.read(file);
            // å¾—åˆ°æ ¹ç›®å½•
            Element elementRoot = document.getRootElement();
            Attribute attribute = elementRoot.attribute(&amp;quot;default-autowire&amp;quot;);
            // è®°å½•æ˜¯å¦æœ‰ default-autowire è‡ªåŠ¨æ³¨å…¥å±æ€§
            boolean flag = false;
            if(attribute != null){
                flag = true;
            }
            // è·å–æ ¹ç›®å½•ä¸‹çš„æ‰€æœ‰å­ç›®å½•
            for (Iterator&amp;lt;Element&amp;gt; itFirst = elementRoot.elementIterator(); itFirst.hasNext();) {
                /**
                 * setup1.å®ä¾‹åŒ–å¯¹è±¡
                 */
                // å¾—åˆ°ç¬¬ä¸€ä¸ªå­å…ƒç´ ï¼šspring.xml ä¸­çš„ &amp;lt;bean&amp;gt;
                Element elementFirstChild = itFirst.next();
                // è·å¾— bean æ ‡ç­¾çš„ id å±æ€§å€¼
                Attribute attributeId = elementFirstChild.attribute(&amp;quot;id&amp;quot;);
                String beanName = attributeId.getValue();
                // è·å¾— bean æ ‡ç­¾çš„ class å±æ€§å€¼
                Attribute attributeClass = elementFirstChild.attribute(&amp;quot;class&amp;quot;);
                String clazzName = attributeClass.getValue();
                Class clazz = Class.forName(clazzName);
                // å½“ä½¿ç”¨æ„é€ æ–¹æ³•æ³¨å…¥æ—¶ï¼Œå°±ä¸èƒ½åœ¨è¿™é‡Œ newInstance äº†ï¼Œå› ä¸ºæ²¡æœ‰é»˜è®¤æ„é€ æ–¹æ³•äº†
//                Object object = clazz.newInstance();
                Object object = null;
                /**
                 * setup2.ç»´æŠ¤ä¾èµ–å…³ç³»
                 *  (1)çœ‹è¿™ä¸ªå¯¹è±¡æœ‰æ²¡æœ‰ä¾èµ–ï¼ˆåˆ¤æ–­ç±»æ˜¯å¦æœ‰å±æ€§ï¼Œç„¶åå†åˆ¤æ–­&amp;lt;bean&amp;gt;ä¸­æ˜¯å¦æœ‰ name=&amp;quot;å±æ€§å€¼&amp;quot;çš„&amp;lt;property&amp;gt;ï¼‰
                 *      å¦‚æœæœ‰ï¼Œåˆ™æ³¨å…¥
                 */
                // å¾—åˆ°&amp;lt;bean&amp;gt;çš„å­æ ‡ç­¾
                for (Iterator&amp;lt;Element&amp;gt; itSecond = elementFirstChild.elementIterator(); itSecond.hasNext();) {
                    // å¾—åˆ° &amp;lt;property name=&amp;quot;userDao&amp;quot; ref = &amp;quot;userDao&amp;quot;&amp;gt;&amp;lt;/property&amp;gt;
                    Element elementSecondChild = itSecond.next();
                    // å¦‚æœä½¿ç”¨ setter æ–¹æ³•æ³¨å…¥
                    if(&amp;quot;property&amp;quot;.equals(elementSecondChild.getName())){
                        // ç”±äºæ˜¯ setter æ³¨å…¥ï¼Œæœ‰ä¸€ä¸ªé»˜è®¤æ„é€ æ–¹æ³•ï¼Œå¯ä»¥ newInstance()
                        object = clazz.newInstance();
                        // 1.å¾—åˆ° ref çš„ valueï¼ˆuserDaoï¼‰ï¼Œé€šè¿‡ value å¾—åˆ°å¯¹è±¡ï¼ˆmapä¸­id=&amp;quot;userDao&amp;quot;ï¼‰
                        String refValue = elementSecondChild.attribute(&amp;quot;ref&amp;quot;).getValue();
                        // éœ€è¦æ³¨å…¥çš„å¯¹è±¡ UserDao
                        Object injectObject = map.get(refValue);
                        // 2.å¾—åˆ° name çš„å€¼ï¼ˆuserDaoï¼‰ï¼Œç„¶åæ ¹æ®å®ƒè·å–ä¸€ä¸ª Field çš„å¯¹è±¡ï¼ˆUserServiceImpl ä¸­çš„ UserDao userDaoï¼‰
                        String nameValue = elementSecondChild.attribute(&amp;quot;name&amp;quot;).getValue();

                        // 3.é€šè¿‡ Field çš„set æ–¹æ³• set è¿™ä¸ªå¯¹è±¡
                        // é€šè¿‡åå°„å¾—åˆ° Field å¯¹è±¡ï¼Œå³UserDao
                        Field field = clazz.getDeclaredField(nameValue);
                        field.setAccessible(true);
                        // ç›¸ç­‰äº UserService.setUserDao(userDao)
                        // ä¸¤ä¸ªå‚æ•°ï¼šuserServiceã€UserDao
                        field.set(object,injectObject);
                    }else {// é€šè¿‡æ„é€ æ–¹æ³•æ³¨å…¥ UserDao
                        // &amp;lt;constructor-arg name=&amp;quot;userDao&amp;quot; ref=&amp;quot;userDao&amp;quot;&amp;gt;&amp;lt;/constructor-arg&amp;gt;
                        // ç”±äºæ²¡æœ‰é»˜è®¤æ„é€ æ–¹æ³•äº†ï¼Œæ‰€ä»¥ä¸å¯ä»¥ clazz.newInstance() äº†
                        // 1.å¾—åˆ° ref çš„ valueï¼ˆuserDaoï¼‰ï¼Œé€šè¿‡ value å¾—åˆ°å¯¹è±¡ï¼ˆmapä¸­id=&amp;quot;userDao&amp;quot;ï¼‰
                        String refValue = elementSecondChild.attribute(&amp;quot;ref&amp;quot;).getValue();
                        // éœ€è¦æ³¨å…¥çš„å¯¹è±¡ UserDao
                        Object injectObject = map.get(refValue);
                        // å¾—åˆ° UserDao çš„ç±»å‹
                        Class injectObjectClazz = injectObject.getClass();
                        // 2.å¾—åˆ° UserService çš„æ„é€ æ–¹æ³•
                        Constructor constructor = clazz.getConstructor(injectObjectClazz.getInterfaces()[0]);
                        //  public UserServiceImpl(UserDao userDao){
                        object = constructor.newInstance(injectObject);

                    }
                }

                // æ‰‹åŠ¨è£…é… &amp;gt; è‡ªåŠ¨è£…é…ã€‚å¦‚æœæ²¡æœ‰æ‰‹åŠ¨è£…é…ï¼Œå°±è‡ªåŠ¨è£…é…
                if(object == null){
                    // å¦‚æœé…ç½®äº†è‡ªåŠ¨è£…é…
                    if(flag){
                        if(&amp;quot;byType&amp;quot;.equals(attribute.getValue())){
                            // 1.åˆ¤æ–­æ˜¯å¦æœ‰ä¾èµ–
                            // å› ä¸ºè‡ªåŠ¨è£…é…ï¼Œæ‰€ä»¥&amp;lt;bean&amp;gt;æ²¡æœ‰&amp;lt;property&amp;gt;å’Œ&amp;lt;constructor&amp;gt;
                            // å°±éœ€è¦åˆ¤æ–­ UserServiceImpl ç±»ä¸­æ˜¯å¦æœ‰å±æ€§ UserDaoï¼Œ
                            // å¦‚æœæ²¡æœ‰ï¼Œå°±è¯æ˜ UserServiceImpl æ²¡æœ‰ä¾èµ–ï¼›å¦‚æœæœ‰ï¼Œå°±è¯æ˜ UserServiceImpl æœ‰ä¾èµ–
                            Field[] fields = clazz.getDeclaredFields();
                            for (Field field : fields) {
                                // 2.å¾—åˆ°å±æ€§çš„ç±»å‹ï¼Œæ¯”å¦‚ private UserDao dao;é‚£ä¹ˆfield.getType()=UserDao.class
                                Class injectObjectClazz = field.getType();
                                /**
                                 * ç”±äºæ˜¯ byTypeï¼Œæ‰€ä»¥éœ€è¦éå† map å½“ä¸­çš„æ‰€æœ‰å¯¹è±¡ï¼Œ
                                 * åˆ¤æ–­å¯¹è±¡çš„ç±»å‹æ˜¯ä¸æ˜¯å’Œè¿™ä¸ª injectObjectClazz ç±»å‹ç›¸åŒ
                                 */
                                // è®°å½• byType æ‰¾åˆ°çš„ä¸ªæ•°ï¼šæ¯”å¦‚æ‰¾åˆ°å¤šå°‘ä¸ª UserDaoImpl
                                int count = 0;
                                Object injectObject = null;
                                for(String key : map.keySet()){
                                    Class&amp;lt;?&amp;gt; temp = map.get(key).getClass().getInterfaces()[0];
                                    if(temp.getName().equals(injectObjectClazz.getName())){
                                        injectObject = map.get(key);
                                        // è®°å½•æ‰¾åˆ°ä¸€ä¸ªï¼Œå› ä¸ºå¯èƒ½æ‰¾åˆ°å¤šä¸ª
                                        count++;
                                    }
                                }
                                // å¦‚æœ byType æ‰¾åˆ°å¤šä¸ª
                                if(count &amp;gt; 1){
                                    throw new SpringException(&amp;quot;éœ€è¦ä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯æ‰¾åˆ°äº†ä¸¤ä¸ªå¯¹è±¡&amp;quot;);
                                }else {
                                    // å¦‚æœåªæ‰¾åˆ°ä¸€ä¸ª typeï¼Œæ³¨å…¥
                                    field.setAccessible(true);
                                    object = clazz.newInstance();
                                    field.set(object, injectObject);
                                }
                            }
                        }
                    }
                }

                // æ”¾åˆ° map ä¸­
                if(object == null){ //æ²¡æœ‰å­æ ‡ç­¾ï¼Œæ¯”å¦‚  &amp;lt;bean id=&amp;quot;userDao&amp;quot; class = &amp;quot;com.ssm.dao.impl.UserDaoImpl&amp;quot;&amp;gt;&amp;lt;/bean&amp;gt;
                    object = clazz.newInstance();
                }
                map.put(beanName,object);
            }
        } catch (DocumentException | ClassNotFoundException e) {
            e.printStackTrace();
        } catch (IllegalAccessException e) {
            e.printStackTrace();
        } catch (InstantiationException e) {
            e.printStackTrace();
        } catch (NoSuchFieldException e) {
            e.printStackTrace();
        } catch (NoSuchMethodException e) {
            e.printStackTrace();
        } catch (InvocationTargetException e) {
            e.printStackTrace();
        }
        System.out.println(map);
    }
    public Object getBean(String beanName){
        return map.get(beanName);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Exception in thread &amp;quot;main&amp;quot; com.ssm.org.spring.util.SpringException: éœ€è¦ä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯æ‰¾åˆ°äº†ä¸¤ä¸ªå¯¹è±¡
	at com.ssm.org.spring.util.BeanFactory.parseXml(BeanFactory.java:137)
	at com.ssm.org.spring.util.BeanFactory.&amp;lt;init&amp;gt;(BeanFactory.java:25)
	at com.ssm.test.Test.main(Test.java:10)
&lt;/code&gt;&lt;/pre&gt;
">Springç³»åˆ—ï¼ˆå››ï¼‰XMLæ¨¡æ‹ŸSpringIOC</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/yi-pian-wen-zhang-xue-hui-jdk-dong-tai-dai-li-bing-shou-dong-mo-ni-yi-ge-dong-tai-dai-li/"" data-c="
          &lt;h1 id=&#34;ä»€ä¹ˆæ˜¯ä»£ç†&#34;&gt;&lt;strong&gt;ä»€ä¹ˆæ˜¯ä»£ç†&lt;/strong&gt;&lt;/h1&gt;
&lt;p&gt;å¢å¼ºä¸€ä¸ªå¯¹è±¡çš„åŠŸèƒ½&lt;/p&gt;
&lt;p&gt;ä¹°ç«è½¦ç¥¨ï¼Œappå°±æ˜¯ä¸€ä¸ªä»£ç†ï¼Œä»–ä»£ç†äº†ç«è½¦ç«™ï¼›å°åŒºå½“ä¸­çš„ä»£å”®çª—å£ä¹Ÿæ˜¯ä¸€ä¸ªä»£ç†ï¼Œä»£ç†äº†ç«è½¦ç«™ã€‚&lt;/p&gt;
&lt;h1 id=&#34;ä»£ç†æ¨¡å¼çš„å¼•å…¥&#34;&gt;ä»£ç†æ¨¡å¼çš„å¼•å…¥&lt;/h1&gt;
&lt;p&gt;1ã€UserDaoImpl æœ‰ä¸€ä¸ªæŸ¥è¯¢æ•°æ®åº“çš„æ–¹æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class UserDaoImpl{
    public void query(){
        System.out.println(&amp;quot;å‡è£…æŸ¥è¯¢æ•°æ®åº“&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€æµ‹è¯•ç±»ä¸­è°ƒç”¨è¿™ä¸ªæ–¹æ³•&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) {
        UserDaoImpl userDao = new UserDaoImpl();
        LogUtil.log();
        userDao.query();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3ã€ç°åœ¨æœ‰ä¸€ä¸ªè¿™æ ·çš„éœ€æ±‚ï¼šæƒ³è¦åœ¨æ¯æ¬¡æ‰§è¡Œ query() æ—¶è®°å½•å½“å‰æ“ä½œå†™åˆ°æ—¥å¿—é‡Œé¢ã€‚å†™ä¸€ä¸ªå…¬å…±çš„æ—¥å¿—æ–¹æ³• log()ï¼Œé‚£ä¹ˆæŠŠ LogUtil.log() ä»£ç å†™åˆ°å“ªé‡Œå‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;3.1 å†™åˆ° query() æ–¹æ³•ä¸­ï¼š&lt;/p&gt;
&lt;p&gt;3.1.1 ç¼ºç‚¹ï¼šå¯èƒ½ UserDoImpl æ˜¯ä¸€ä¸ª jarï¼Œæ ¹æœ¬æ²¡æœ‰å®ƒçš„æºç ï¼Œæ— æ³•è¿›è¡Œä¿®æ”¹ã€‚&lt;/p&gt;
&lt;p&gt;3.1.2 å³ä½¿æœ‰æºç ï¼Œå°† query() æ”¹å†™æˆå¦‚ä¸‹ï¼šç ´åäº†å•ä¸€èŒè´£ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public void query(){
  LogUtil.log();
  // è¿›è¡Œæ•°æ®åº“æŸ¥è¯¢æ“ä½œ...
  System.out.println(&amp;quot;å‡è£…æŸ¥è¯¢æ•°æ®åº“&amp;quot;); 
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å•ä¸€èŒè´£ï¼šåªåšä¸€ä»¶äº‹ã€‚å°†æ—¥å¿—æ“ä½œå†™åˆ° query() é‡Œé¢ç ´åäº†ç±»çš„å°è£…æ€§ï¼ŒèŒè´£å°±ä¸å•ä¸€äº† ã€‚&lt;/p&gt;
&lt;p&gt;3.2 å†™åˆ° Test ç±»ä¸­ï¼š  æ¯æ¬¡è°ƒç”¨æŸ¥è¯¢æ“ä½œå‰è®°å½•å½“å‰æ—¶é—´ã€‚&lt;/p&gt;
&lt;p&gt;ç¼ºç‚¹ï¼šä¼šè°ƒç”¨å¾ˆå¤šæ¬¡ query æ–¹æ³•ï¼Œä¹Ÿå°±è¦å†™å¾ˆå¤šæ¬¡ Logutil.log() å¤§é‡é‡å¤ä»£ç ã€‚&lt;/p&gt;
&lt;p&gt;3.3 å¼•å…¥ä»£ç†æ¨¡å¼&lt;/p&gt;
&lt;h1 id=&#34;javaå®ç°çš„ä»£ç†çš„ä¸¤ç§åŠæ³•&#34;&gt;&lt;strong&gt;javaå®ç°çš„ä»£ç†çš„ä¸¤ç§åŠæ³•&lt;/strong&gt;&lt;/h1&gt;
&lt;h1 id=&#34;ä»£ç†çš„åè¯&#34;&gt;ä»£ç†çš„åè¯&lt;/h1&gt;
&lt;p&gt;ä»£ç†å¯¹è±¡â€”â€”å¢å¼ºåçš„å¯¹è±¡&lt;/p&gt;
&lt;p&gt;ç›®æ ‡å¯¹è±¡â€”â€”è¢«å¢å¼ºçš„å¯¹è±¡&lt;/p&gt;
&lt;p&gt;ä»–ä»¬ä¸æ˜¯ç»å¯¹çš„ï¼Œä¼šæ ¹æ®æƒ…å†µå‘ç”Ÿå˜åŒ–&lt;/p&gt;
&lt;h1 id=&#34;é™æ€ä»£ç†&#34;&gt;é™æ€ä»£ç†&lt;/h1&gt;
&lt;h2 id=&#34;ç»§æ‰¿&#34;&gt;ç»§æ‰¿&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ä»£ç†å¯¹è±¡ç»§æ‰¿ç›®æ ‡å¯¹è±¡ï¼Œé‡å†™éœ€è¦å¢å¼ºçš„æ–¹æ³•&lt;/li&gt;
&lt;li&gt;ç¼ºç‚¹ï¼šä¼šä»£ç†ç±»è¿‡å¤šï¼Œéå¸¸å¤æ‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å›åˆ°ä¸Šè¥¦ä»£ç†æ¨¡å¼å¼•å…¥çš„ä¾‹å­ä¸­ï¼š&lt;/p&gt;
&lt;p&gt;3.3 ç»§æ‰¿ï¼šè‡ªå®šä¹‰ä¸€ä¸ªç±»&lt;strong&gt;ç»§æ‰¿&lt;/strong&gt;åŸæ¥éœ€è¦æ·»åŠ æ—¥å¿—çš„ç±» UserDaoImplï¼Œåœ¨æ‰§è¡Œä¸šåŠ¡æ“ä½œå‰æ·»åŠ æ—¥å¿—æ‰“å°è¯­å¥ã€‚æ—¢è§£å†³äº† jar åŒ…æ— æ³•ä¿®æ”¹æºç çš„é—®é¢˜ï¼Œåˆæ²¡æœ‰ç ´åå•ä¸€èŒè´£åŸåˆ™ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class UserDaoLogImpl extends UserDaoImpl {
    @Override
    public void query() {
        LogUtil.log();
        super.query();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æµ‹è¯•ç±»ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) {
        UserDao userDao = new UserDaoLogImpl();
        userDao.query();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åˆ†æï¼šå¦‚æ­¤å¾—åˆ°äº†è¢«å¢å¼ºåçš„ UserDaoImplï¼Œå¯å®ç°åœ¨ query() å‰è¿›è¡Œæ—¥å¿—æ‰“å°ã€‚&lt;/p&gt;
&lt;p&gt;UserDaoImplï¼šç›®æ ‡å¯¹è±¡&lt;/p&gt;
&lt;p&gt;UserDaoLogImpl ï¼šä»£ç†å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;ä»£ç†å¯¹è±¡å’Œç›®æ ‡å¯¹è±¡æ˜¯ç›¸å¯¹è€Œè¨€çš„ã€‚UserDaoLogImplÂ æ˜¯ä»£ç†å¯¹è±¡ï¼Œä½†æ˜¯æœ‰ä¸€å¤©å®ƒä¹Ÿæœ‰å¯èƒ½æˆä¸ºç›®æ ‡å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;4ã€æœ‰ä¸€ä¸ªæ–°éœ€æ±‚ï¼šåœ¨ query æ–¹æ³•å‰æ·»åŠ ä¸€ä¸ªæƒé™éªŒè¯ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class UserDaoPowerImpl extends UserDaoImpl {
    @Override
    public void query() {
        LogUtil.log(&amp;quot;power...&amp;quot;);
        super.query();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;5ã€æœ‰ä¸€ä¸ªæ–°éœ€æ±‚ï¼šåœ¨ query æ–¹æ³•å‰æ·»åŠ ä¸€ä¸ªæ—¶é—´è®°å½•ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class UserDaoTimerImpl extends UserDaoImpl {
    @Override
    public void query() {
        LogUtil.log(&amp;quot;timer...&amp;quot;);
        super.query();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;6ã€æœ‰ä¸€ä¸ªæ–°éœ€æ±‚ï¼šåœ¨ query() æ–¹æ³•è¢«è°ƒç”¨å‰æ—¢å®ç°æ—¥å¿—æ‰“å°ã€åˆå®ç°è®°å½•å½“å‰æ—¶é—´çš„åŠŸèƒ½&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class UserDaoTimeAndLogImpl extends UserDaoLogImpl {
    @Override
    public void query() {
        // timer
        LogUtil.log(&amp;quot;timer...&amp;quot;);
        // logger &amp;amp; query
        super.query();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;timer...
logger...
å‡è£…æŸ¥è¯¢æ•°æ®åº“
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;7ã€æ–°éœ€æ±‚ï¼šåœ¨ query() å‰å…ˆæ‰“å°æ—¥å¿—ï¼Œç„¶åå†è®°å½•æ—¶é—´&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class UserDaoLogAndTimeImpl extends UserDaoTimerImpl {
    @Override
    public void query() {
        LogUtil.log(&amp;quot;logger...&amp;quot;);
        // logger
        super.query();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;logger...
timer...
å‡è£…æŸ¥è¯¢æ•°æ®åº“
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åªæ˜¯æ”¹å˜äº†ä»¥ä¸€ä¸‹æ—¥å¿—è®°å½•é¡ºåºï¼Œå°±ä¼šå¢åŠ ä¸€ä¸ªæ–°çš„ç±»ï¼Œä¸åŒçš„æ’åˆ—ç»„åˆä¼šé€ æˆä»£ç†ç±»è¿‡å¤šã€‚&lt;/p&gt;
&lt;h2 id=&#34;èšåˆ&#34;&gt;èšåˆ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ç›®æ ‡å¯¹è±¡å’Œä»£ç†å¯¹è±¡å®ç°åŒä¸€ä¸ªæ¥å£ï¼Œä»£ç†å¯¹è±¡å½“ä¸­è¦åŒ…å«ç›®æ ‡å¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;ç¼ºç‚¹ï¼šä¹Ÿä¼šäº§ç”Ÿç±»çˆ†ç‚¸ï¼ˆUserDaoLog implements UserDaoã€OrderDaoLog implements OrderDao......ï¼‰ï¼Œåªä¸è¿‡æ¯”ç»§æ‰¿å°‘ä¸€ç‚¹ç‚¹&lt;/li&gt;
&lt;li&gt;æ€»ç»“:å¦‚æœåœ¨ä¸ç¡®å®šçš„æƒ…å†µä¸‹ï¼Œå°½é‡ä¸è¦å»ä½¿ç”¨é™æ€ä»£ç†ã€‚å› ä¸ºä¸€æ—¦ä½ å†™ä»£ç ï¼Œå°±ä¼šäº§ç”Ÿç±»ï¼Œä¸€æ—¦äº§ç”Ÿç±»å°±çˆ†ç‚¸ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;1ã€å£°æ˜ä¸€ä¸ªæ¥å£ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public interface UserDao {
    void query();
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€ç›®æ ‡å¯¹è±¡ UserDaoImpl å®ç° UserDao æ¥å£&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class UserDaoImpl implements UserDao {
    public void query(){
        System.out.println(&amp;quot;å‡è£…æŸ¥è¯¢æ•°æ®åº“&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3ã€ä»£ç†å¯¹è±¡å®ç° UserDao æ¥å£ï¼Œä»£ç†å¯¹è±¡ UserDaoLog ä¸­åŒ…å«ç›®æ ‡å¯¹è±¡ UserDaoImplï¼ˆæµ‹è¯•ç±»ä¼ å‚ä¸ºç›®æ ‡å¯¹è±¡ç±»ï¼‰&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class UserDaoLog implements UserDao {
    // è£…é¥°è€…æ¨¡å¼ï¼šå†™ä¸€ä¸ªæ„é€ æ–¹æ³•ï¼Œé€šè¿‡ä¼ å…¥ä¸€ä¸ªç›®æ ‡å¯¹è±¡æŒ‡å®šä»£ç†/ è£…é¥°å…·ä½“çš„å¯¹è±¡
    UserDao dao;
    public UserDaoLog(UserDao userDao){
        this.dao = userDao;
    }
    @Override
    public void query() {
        LogUtil.log(&amp;quot;logger...&amp;quot;);
        dao.query();
        // ä»£ç†æ¨¡å¼ï¼šnew UserDaoImpl().query();UserDaoä¸æ˜¯ä¼ é€’è¿›æ¥çš„ï¼Œæ˜¯å†™æ­»çš„ã€‚
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;4ã€æµ‹è¯•ç±»&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) {
        UserDao target = new UserDaoImpl();
        UserDao proxy = new UserDaoLog(target);
        proxy.query();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æµ‹è¯•ç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;logger...
å‡è£…æŸ¥è¯¢æ•°æ®åº“ 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;5ã€æ–°éœ€æ±‚ï¼šè®°å½•æ—¶é—´&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class UserDaoTime implements UserDao {
    UserDao dao;
    public UserDaoTime(UserDao userDao){
        this.dao = userDao;
    }
    @Override
    public void query() {
        LogUtil.log(&amp;quot;timer...&amp;quot;);
        dao.query();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æµ‹è¯•ç±»ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) {
        UserDao target = new UserDaoImpl();
        UserDao proxy = new UserDaoTime(target);
        proxy.query();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;timer...
å‡è£…æŸ¥è¯¢æ•°æ®åº“
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;6ã€æ–°éœ€æ±‚ï¼šå®Œæˆå¯¹æ—¥å¿—å’Œæ—¶é—´çš„ä»£ç†ï¼Œæ— éœ€æ–°å¢ä¸€ä¸ªç±»ã€‚åªéœ€å°†æ—¶é—´çš„ä»£ç†å¯¹è±¡ä½œä¸ºç›®æ ‡å¯¹è±¡ï¼Œä¼ é€’ç»™æ—¥å¿—ä»£ç†å¯¹è±¡å³å¯ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) {
        // time + logic(ä¸šåŠ¡é€»è¾‘)
        UserDao target = new UserDaoTime(new UserDaoImpl());
        // log + time + logic
        UserDao proxy = new UserDaoLog(target);
        proxy.query();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;logger...
timer...
å‡è£…æŸ¥è¯¢æ•°æ®åº“
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;6ã€æ–°éœ€æ±‚ï¼šå®Œæˆå…ˆæ‰“å°æ—¶é—´ï¼Œå†è®°å½•æ—¥å¿—çš„æ“ä½œã€‚æ— éœ€æ–°å¢ç±»ï¼Œåªéœ€ä¿®æ”¹æµ‹è¯•ç±»å³å¯ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) {
        UserDao target = new UserDaoLog(new UserDaoImpl());
        UserDao proxy = new UserDaoTime(target);
        proxy.query();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;timer...
logger...
å‡è£…æŸ¥è¯¢æ•°æ®åº“åŠ¨æ€ä»£ç†
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;è‡ªå·±æ¨¡æ‹Ÿçš„åŠ¨æ€ä»£ç†&#34;&gt;è‡ªå·±æ¨¡æ‹Ÿçš„åŠ¨æ€ä»£ç†&lt;/h2&gt;
&lt;p&gt;å¦‚ä½•æ‹¿åˆ°ä¸€ä¸ªå¯¹è±¡ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä¸éœ€è¦æ‰‹åŠ¨ new åˆ› å»ºç±»æ–‡ä»¶ï¼ˆå› ä¸ºä¸€æ—¦æ‰‹åŠ¨åˆ›å»ºç±»æ–‡ä»¶ï¼Œå°±ä¼šäº§ç”Ÿç±»çˆ†ç‚¸ï¼‰ï¼Œé€šè¿‡æ¥å£åå°„ç”Ÿæˆä¸€ä¸ªç±»æ–‡ä»¶ï¼Œç„¶åè°ƒç”¨ç¬¬ä¸‰æ–¹çš„ç¼–è¯‘æŠ€æœ¯ï¼ŒåŠ¨æ€ç¼–è¯‘è¿™ä¸ªäº§ç”Ÿçš„ç±»æ–‡ä»¶æˆclassæ–‡ä»¶ï¼Œç»§è€Œåˆ©ç”¨UrlclassLoader(å› ä¸ºè¿™ä¸ªåŠ¨æ€äº§ç”Ÿçš„classä¸åœ¨å·¥ç¨‹å½“ä¸­æ‰€ä»¥éœ€è¦ä½¿ç”¨UrlclassLoader)æŠŠè¿™ä¸ªåŠ¨æ€ç¼–è¯‘çš„ç±»åŠ è½½åˆ°jvmå½“ä¸­ï¼Œæœ€åé€šè¿‡åå°„æŠŠè¿™ä¸ªç±»å®ä¾‹åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;ç¼ºç‚¹ï¼šé¦–å…ˆè¦ç”Ÿæˆæ–‡ä»¶&lt;/p&gt;
&lt;p&gt;ç¼ºç‚¹ï¼šåŠ¨æ€ç¼–è¯‘æ–‡ä»¶ class&lt;/p&gt;
&lt;p&gt;ç¼ºç‚¹ï¼šéœ€è¦ä¸€ä¸ªURLclassloader&lt;/p&gt;
&lt;p&gt;è½¯ä»¶æ€§èƒ½çš„æœ€ç»ˆä½“ç°åœ¨IOæ“ä½œ&lt;/p&gt;
&lt;p&gt;file(.java) ---&amp;gt; .class ---&amp;gt; byte[] ---&amp;gt; object(Class ç±»å¯¹è±¡)  ---&amp;gt; object.newInstance()&lt;/p&gt;
&lt;h3 id=&#34;1å‡†å¤‡ä¸€ä¸ªæ¥å£&#34;&gt;1.å‡†å¤‡ä¸€ä¸ªæ¥å£ï¼š&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public interface TestDao {
    String query(String s1, String s2);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;2å‡†å¤‡ä¸€ä¸ªæ¥å£å®ç°ç±»&#34;&gt;2.å‡†å¤‡ä¸€ä¸ªæ¥å£å®ç°ç±»ï¼š&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class TestDaoImpl implements TestDao {
    @Override
    public String query(String s1, String s2) {
        System.out.println(&amp;quot;æŸ¥è¯¢æ•°æ®åº“&amp;quot;);
        System.out.println(&amp;quot;daoImpl...&amp;quot; + s1 + &amp;quot; &amp;quot; + s2);
        return s1 + &amp;quot; &amp;quot; + s2;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;3æ¨¡æ‹ŸåŠ¨æ€ä»£ç†&#34;&gt;3.æ¨¡æ‹ŸåŠ¨æ€ä»£ç†ï¼š&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.ssm.util;

import javax.tools.JavaCompiler;
import javax.tools.StandardJavaFileManager;
import javax.tools.ToolProvider;
import java.io.*;
import java.lang.reflect.Constructor;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;
import java.net.URL;
import java.net.URLClassLoader;
import com.sun.jndi.toolkit.url.UrlUtil;

public class ProxyUtil {

    /**
     * å¦‚ä½•äº§ç”Ÿä¸€ä¸ªå¯¹è±¡ï¼Ÿ
     *  content ---&amp;gt; String
     *  .java
     *  .class
     *  .new
     * @param targetï¼šç›®æ ‡å¯¹è±¡
     * @return
     */
    public static Object newInstance(Object target) throws IOException, IllegalAccessException, InstantiationException, NoSuchMethodException, ClassNotFoundException, InvocationTargetException {
        // targetInterfaceï¼šç›®æ ‡å¯¹è±¡çš„æ¥å£
        Class targetInterface = target.getClass().getInterfaces()[0];

        // å£°æ˜æœ€ç»ˆè¦è¿”å›çš„ä»£ç†å¯¹è±¡
        Object proxy=null;
        /**
         * package com.ssm.proxyInter;
         *
         * import com.ssm.dao.UserDao;
         *
         * public class UserDaoLog implements UserDao {
         *
         *     private UserDao target;
         *     public UserDaoLog(UserDao target){
         *         this.target = target;
         *     }
         *     @Override
         *     public void query(String p0, String p1) {
         *         System.out.println(&amp;quot;log...&amp;quot;);
         *         target.query(p0,p1);
         *     }
         * }
         * å°†ä¸Šè¿°ä»£ç é€è¡Œå˜æˆå­—ç¬¦ä¸²
         */
        // æ¢è¡Œ
        String line = &amp;quot;\n&amp;quot;;
        // ç¼©è¿›
        String tab = &amp;quot;\t&amp;quot;;
        // å¾—åˆ°æ¥å£å UserDao
        String interfaceName = targetInterface.getSimpleName();
        // å¾—åˆ°æ¥å£ä¸­çš„æ‰€æœ‰æ–¹æ³• query()
        Method[] methods = targetInterface.getDeclaredMethods();
        String content = &amp;quot;&amp;quot;;
        String packageContent = &amp;quot;package com.ssm;&amp;quot; + line;
        String importContent = &amp;quot;import &amp;quot; + targetInterface.getName() + &amp;quot;;&amp;quot; + line;
        String classFirstLineContent = &amp;quot;public class $Proxy implements &amp;quot; +interfaceName+ &amp;quot;{&amp;quot; + line;
        String fieldContent = tab + &amp;quot;private &amp;quot; + interfaceName + &amp;quot; target;&amp;quot; + line;
        String constructorContent = tab + &amp;quot;public $Proxy (&amp;quot; + interfaceName + &amp;quot; target){&amp;quot; + line
                + tab + tab + &amp;quot;this.target = target; &amp;quot;+ line
                + tab +&amp;quot;}&amp;quot; + line;

        // å‚æ•°å†…å®¹ï¼štarget.query(p0,p1);
        String paramsContent = &amp;quot;&amp;quot;;
        String methodContent = &amp;quot;&amp;quot;;
        for (Method method : methods){
            // å¾—åˆ°å½“å‰æ–¹æ³•çš„è¿”å›ç±»å‹
            String returnType = method.getReturnType().getSimpleName();
            // å¾—åˆ°å½“å‰æ–¹æ³•çš„æ–¹æ³•å
            String methodName = method.getName();
            // å¾—åˆ°æ–¹æ³•çš„å‚æ•°ç±»å‹ï¼šå¦‚ String.class
            Class[] args = method.getParameterTypes();
            String argsContent = &amp;quot;&amp;quot;;
            for (int i = 0 ; i &amp;lt; args.length ; i++){
                // å¾—åˆ°çš„æ˜¯å‚æ•°ç±»å‹ï¼šå¦‚ String
                String temp = args[i].getSimpleName();
                // æœ€ç»ˆæ„é€ æˆè¿™ä¸ªå½¢å¼ï¼šString p0,String p1
                argsContent += temp + &amp;quot; p&amp;quot; + i + &amp;quot;,&amp;quot;;
                paramsContent += &amp;quot;p&amp;quot; + i + &amp;quot;,&amp;quot;;
            }
            // æˆªå–æ‰æœ€åä¸€ä¸ªå¤šä½™çš„ &#39;,&#39;
            if(argsContent.length() &amp;gt; 0){
                argsContent = argsContent.substring(0,argsContent.lastIndexOf(&amp;quot;,&amp;quot;));
                paramsContent = paramsContent.substring(0,paramsContent.lastIndexOf(&amp;quot;,&amp;quot;));
            }
            methodContent += tab + &amp;quot;public &amp;quot; + returnType + &amp;quot; &amp;quot; + methodName + &amp;quot;(&amp;quot; + argsContent + &amp;quot;) {&amp;quot; + line
                    + tab + tab + &amp;quot;System.out.println(\&amp;quot;log\&amp;quot;);&amp;quot; + line;
            // åˆ¤æ–­æ˜¯å¦æœ‰è¿”å›å€¼
            if(&amp;quot;void&amp;quot;.equals(returnType)){
                methodContent += tab + tab + &amp;quot;target.&amp;quot; + methodName + &amp;quot;(&amp;quot; + paramsContent + &amp;quot;);&amp;quot; + line
                        + tab + &amp;quot;}&amp;quot; + line;
            }else {
                methodContent += tab + tab + &amp;quot; return target.&amp;quot; + methodName + &amp;quot;(&amp;quot; + paramsContent + &amp;quot;);&amp;quot; + line
                        + tab + &amp;quot;}&amp;quot; + line;
            }

        }

        content = packageContent + importContent + classFirstLineContent + fieldContent + constructorContent + methodContent + &amp;quot;}&amp;quot;;

        File file = new File(&amp;quot;C:\\Users\\Only\\com\\ssm\\$Proxy.java&amp;quot;);
        if(!file.exists()){
            file.createNewFile();
        }
        FileWriter fw = new FileWriter(file);
        fw.write(content);
        fw.flush();
        fw.close();

        // .java ---&amp;gt; .class
        JavaCompiler compiler = ToolProvider.getSystemJavaCompiler();
        StandardJavaFileManager fileMgr = compiler.getStandardFileManager(null, null, null);
        Iterable units = fileMgr.getJavaFileObjects(file);
        JavaCompiler.CompilationTask t = compiler.getTask(null, fileMgr, null, null, null, units);
        t.call();
        fileMgr.close();

        // é€šè¿‡åå°„å¾—åˆ°æ„é€ å‡½æ•° new ä¸€ä¸ªå¯¹è±¡å‡ºæ¥
        URL[] urls = new URL[]{new URL(&amp;quot;file:C:\\Users\\Only\\\\&amp;quot;)};
        URLClassLoader urlClassLoader = new URLClassLoader(urls);
        Class clazz = urlClassLoader.loadClass(&amp;quot;com.ssm.$Proxy&amp;quot;);
        Constructor constructor = clazz.getConstructor(targetInterface);
        proxy = constructor.newInstance(target);

        return proxy;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%A8%A1%E6%8B%9F%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;4æµ‹è¯•ç±»&#34;&gt;4.æµ‹è¯•ç±»&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) throws IOException, InvocationTargetException, NoSuchMethodException, ClassNotFoundException, InstantiationException, IllegalAccessException {
        TestDao proxy = (TestDao) ProxyUtil.newInstance(new TestDaoImpl());
        String res = proxy.query(&amp;quot;hello&amp;quot;, &amp;quot;world&amp;quot;);
        System.out.println(&amp;quot;res = &amp;quot; + res);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ€ç»ˆè¿è¡Œæ•ˆæœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;log
æŸ¥è¯¢æ•°æ®åº“
daoImpl...hello world
res = hello world
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;ä»£ç†é€»è¾‘åŠ¨æ€å®ç°è€Œä¸æ˜¯å†™æ­»çš„-sout&#34;&gt;ä»£ç†é€»è¾‘åŠ¨æ€å®ç°ï¼Œè€Œä¸æ˜¯å†™æ­»çš„ sout&lt;/h2&gt;
&lt;h3 id=&#34;1è¦ä»£ç†çš„æ¥å£&#34;&gt;1.è¦ä»£ç†çš„æ¥å£&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public interface TestDao {
    String delete() throws Exception;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;2ç›®æ ‡å¯¹è±¡&#34;&gt;2.ç›®æ ‡å¯¹è±¡&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class TestDaoImpl implements TestDao {
    @Override
    public String delete() {
        System.out.println(&amp;quot;dao...delete&amp;quot;);
        return null;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;3ä»£ç†é€»è¾‘æ¥å£&#34;&gt;3.ä»£ç†é€»è¾‘æ¥å£&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public interface CustomInvocationHandler {
    Object invoke(Method method);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;4ä»£ç†é€»è¾‘å…·ä½“å®ç°&#34;&gt;4.ä»£ç†é€»è¾‘å…·ä½“å®ç°&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.ssm.test;
import com.ssm.dao.CustomInvocationHandler;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;
public class TestCustomHandler implements CustomInvocationHandler {
    private Object target;
    public TestCustomHandler(Object target){
        this.target = target;
    }
    @Override
    public Object invoke(Method method) {
        System.out.println(&amp;quot;TestCustomHandler...&amp;quot;);
        try {
            return method.invoke(target);
        } catch (IllegalAccessException e) {
            e.printStackTrace();
        } catch (InvocationTargetException e) {
            e.printStackTrace();
        }
        return null;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;4.è‡ªå®šä¹‰åŠ¨æ€ä»£ç†&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.ssm.util;

import javax.tools.JavaCompiler;
import javax.tools.StandardJavaFileManager;
import javax.tools.ToolProvider;
import java.io.*;
import java.lang.reflect.Constructor;
import java.lang.reflect.InvocationHandler;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;
import java.net.URL;
import java.net.URLClassLoader;
import com.ssm.dao.CustomInvocationHandler;
import com.sun.jndi.toolkit.url.UrlUtil;
public class ProxyUtil {
    /**
     * å¦‚ä½•äº§ç”Ÿä¸€ä¸ªå¯¹è±¡ï¼Ÿ
     *  content ---&amp;gt; String
     *  .java
     *  .class
     *  .new
     * @return
     */
    public static Object newInstance(Class targetInterface, CustomInvocationHandler h) throws IOException, IllegalAccessException, InstantiationException, NoSuchMethodException, ClassNotFoundException, InvocationTargetException {
        // targetInterfaceï¼šç›®æ ‡å¯¹è±¡çš„æ¥å£
//        Class targetInterface = target.getClass().getInterfaces()[0];

        // å£°æ˜æœ€ç»ˆè¦è¿”å›çš„ä»£ç†å¯¹è±¡
        Object proxy=null;
        /**
         * package com.ssm.proxyInter;
         *
         * import com.ssm.dao.UserDao;
         *
         * public class UserDaoLog implements UserDao {
         *
         *     private UserDao target;
         *     public UserDaoLog(UserDao target){
         *         this.target = target;
         *     }
         *     @Override
         *     public void query(String p0, String p1) {
         *         System.out.println(&amp;quot;log...&amp;quot;);
         *         target.query(p0,p1);
         *     }
         * }
         * å°†ä¸Šè¿°ä»£ç é€è¡Œå˜æˆå­—ç¬¦ä¸²
         */
        // æ¢è¡Œ
        String line = &amp;quot;\n&amp;quot;;
        // ç¼©è¿›
        String tab = &amp;quot;\t&amp;quot;;
        // å¾—åˆ°æ¥å£å UserDao
        String interfaceName = targetInterface.getSimpleName();
        // å¾—åˆ°æ¥å£ä¸­çš„æ‰€æœ‰æ–¹æ³• query()
        Method[] methods = targetInterface.getDeclaredMethods();
        String content = &amp;quot;&amp;quot;;
        String packageContent = &amp;quot;package com.ssm;&amp;quot; + line;
        String importContent = &amp;quot;import &amp;quot; + targetInterface.getName() + &amp;quot;;&amp;quot; + line
                + &amp;quot;import com.ssm.dao.CustomInvocationHandler;&amp;quot; + line
                + &amp;quot;import java.lang.reflect.Method;&amp;quot; + line;
        String classFirstLineContent = &amp;quot;public class $Proxy implements &amp;quot; +interfaceName+ &amp;quot;{&amp;quot; + line;
        String fieldContent = tab + &amp;quot;private  CustomInvocationHandler h;&amp;quot; + line;
        String constructorContent = tab + &amp;quot;public $Proxy (CustomInvocationHandler h){&amp;quot; + line
                + tab + tab + &amp;quot;this.h = h; &amp;quot;+ line
                + tab +&amp;quot;}&amp;quot; + line;
                
        // å‚æ•°å†…å®¹ï¼štarget.query(p0,p1);
        String paramsContent = &amp;quot;&amp;quot;;
        String methodContent = &amp;quot;&amp;quot;;
        for (Method method : methods){
            // å¾—åˆ°å½“å‰æ–¹æ³•çš„è¿”å›ç±»å‹
            String returnType = method.getReturnType().getSimpleName();
            // å¾—åˆ°å½“å‰æ–¹æ³•çš„æ–¹æ³•å
            String methodName = method.getName();
            // å¾—åˆ°æ–¹æ³•çš„å‚æ•°ç±»å‹ï¼šå¦‚ String.class
            Class[] args = method.getParameterTypes();
            String argsContent = &amp;quot;&amp;quot;;
            for (int i = 0 ; i &amp;lt; args.length ; i++){
                // å¾—åˆ°çš„æ˜¯å‚æ•°ç±»å‹ï¼šå¦‚ String
                String temp = args[i].getSimpleName();
                // æœ€ç»ˆæ„é€ æˆè¿™ä¸ªå½¢å¼ï¼šString p0,String p1
                argsContent += temp + &amp;quot; p&amp;quot; + i + &amp;quot;,&amp;quot;;
                paramsContent += &amp;quot;p&amp;quot; + i + &amp;quot;,&amp;quot;;
            }
            // æˆªå–æ‰æœ€åä¸€ä¸ªå¤šä½™çš„ &#39;,&#39;
            if(argsContent.length() &amp;gt; 0){
                argsContent = argsContent.substring(0,argsContent.lastIndexOf(&amp;quot;,&amp;quot;));
                paramsContent = paramsContent.substring(0,paramsContent.lastIndexOf(&amp;quot;,&amp;quot;));
            }
            methodContent += tab + &amp;quot;public &amp;quot; + returnType + &amp;quot; &amp;quot; + methodName + &amp;quot;(&amp;quot; + argsContent + &amp;quot;) throws Exception {&amp;quot; + line
                    + tab + tab + &amp;quot;Method method = Class.forName(\&amp;quot;&amp;quot; + targetInterface.getName() + &amp;quot;\&amp;quot;).getDeclaredMethod(\&amp;quot;&amp;quot; + methodName + &amp;quot;\&amp;quot;);&amp;quot; + line
                    + tab + tab + &amp;quot;return (&amp;quot;+ returnType +&amp;quot;)h.invoke(method);&amp;quot; + line
                    + tab + &amp;quot;}&amp;quot; + line;
        }

        content = packageContent + importContent + classFirstLineContent + fieldContent + constructorContent + methodContent + &amp;quot;}&amp;quot;;

        File file = new File(&amp;quot;C:\\Users\\Only\\com\\ssm\\$Proxy.java&amp;quot;);
        if(!file.exists()){
            file.createNewFile();
        }
        FileWriter fw = new FileWriter(file);
        fw.write(content);
        fw.flush();
        fw.close();

        // .java ---&amp;gt; .class
        JavaCompiler compiler = ToolProvider.getSystemJavaCompiler();
        StandardJavaFileManager fileMgr = compiler.getStandardFileManager(null, null, null);
        Iterable units = fileMgr.getJavaFileObjects(file);
        JavaCompiler.CompilationTask t = compiler.getTask(null, fileMgr, null, null, null, units);
        t.call();
        fileMgr.close();

        // é€šè¿‡åå°„å¾—åˆ°æ„é€ å‡½æ•° new ä¸€ä¸ªå¯¹è±¡å‡ºæ¥
        URL[] urls = new URL[]{new URL(&amp;quot;file:C:\\Users\\Only\\\\&amp;quot;)};
        URLClassLoader urlClassLoader = new URLClassLoader(urls);
        Class clazz = urlClassLoader.loadClass(&amp;quot;com.ssm.$Proxy&amp;quot;);
        Constructor constructor = clazz.getConstructor(CustomInvocationHandler.class);
        proxy = constructor.newInstance(h);

        return proxy;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;5æµ‹è¯•ç±»&#34;&gt;5.æµ‹è¯•ç±»&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) throws Exception {
//         è‡ªå®šä¹‰åŠ¨æ€ä»£ç†
        TestDao proxy = (TestDao) ProxyUtil.newInstance(TestDao.class, new TestCustomHandler(new TestDaoImpl()));
        proxy.delete();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;TestCustomHandler...
dao...delete
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;jdkåŠ¨æ€ä»£ç†&#34;&gt;JDKåŠ¨æ€ä»£ç†&lt;/h2&gt;
&lt;p&gt;é€šè¿‡æ¥å£åå°„å¾—åˆ°å­—èŠ‚ç  byte[] ï¼Œç„¶åæŠŠå­—èŠ‚ç è½¬æˆ classï¼šnativeæ–¹æ³•Â  openJDKÂ  c++&lt;/p&gt;
&lt;h3 id=&#34;1è¦ä»£ç†çš„æ¥å£-2&#34;&gt;1.è¦ä»£ç†çš„æ¥å£&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public interface TestDao {
    String query(String s1, String s2) throws Exception;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;2ç›®æ ‡å¯¹è±¡-2&#34;&gt;2.ç›®æ ‡å¯¹è±¡&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class TestDaoImpl implements TestDao {
    @Override
    public String query(String s1, String s2) {
        System.out.println(&amp;quot;æŸ¥è¯¢æ•°æ®åº“&amp;quot;);
        System.out.println(&amp;quot;daoImpl...&amp;quot; + s1 + &amp;quot; &amp;quot; + s2);
        return s1 + &amp;quot; &amp;quot; + s2;
    } 
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;3ä»£ç†çš„é€»è¾‘&#34;&gt;3.ä»£ç†çš„é€»è¾‘&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.ssm.util;

import java.lang.reflect.InvocationHandler;
import java.lang.reflect.Method;

public class TestInvocationHandler implements InvocationHandler {
    Object target;

    /**
     *
     * @param target ç›®æ ‡å¯¹è±¡
     */
    public TestInvocationHandler(Object target){
        this.target = target;
    }
    /**
     *
     * @param proxy ä»£ç†å¯¹è±¡ $Proxy
     * @param method ç›®æ ‡å¯¹è±¡ TestDao
     * @param args ç›®æ ‡æ–¹æ³•çš„å‚æ•°
     * @return
     * @throws Throwable
     *
     * æ ¹æ®ä»£ç†çš„é€»è¾‘æ‰§è¡Œï¼šå³æ‰“å° TestInvocationHandler...proxy
     * æ‰§è¡Œç›®æ ‡å¯¹è±¡çš„æ–¹æ³• ï¼Œå³ TestDao çš„ query()
     */
    @Override
    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
        System.out.println(&amp;quot;TestInvocationHandler...proxy&amp;quot;);
        return method.invoke(target,args);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;4æµ‹è¯•ç±»-2&#34;&gt;4.æµ‹è¯•ç±»&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) throws Exception {

        /**
         * JDK åŠ¨æ€ä»£ç†
         * å‚æ•°ï¼šè¦ä»£ç†å“ªäº›æ¥å£ï¼›new Class[]{TestDao.class}ï¼šTestDao ä¸‹æ‰€æœ‰æ–¹æ³•çš„ä»£ç†ã€‚
         *       ä»£ç†çš„é€»è¾‘ï¼šnew TestInvocationHandler(new TestDaoImpl())ï¼šåœ¨æ¯ä¸ªæ–¹æ³•å‰æ‰“å° TestInvocationHandler...proxy
         */
        TestDao jdkProxy = (TestDao) Proxy.newProxyInstance(Test.class.getClassLoader(),
                new Class[]{TestDao.class},
                new TestInvocationHandler(new TestDaoImpl()));
        String result = jdkProxy.query(&amp;quot;hello&amp;quot;, &amp;quot;world&amp;quot;);
        System.out.println(&amp;quot;result = &amp;quot; + result);

    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;TestInvocationHandler...proxy
æŸ¥è¯¢æ•°æ®åº“
daoImpl...hello world
result = hello world
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;jdk-åŠ¨æ€ä»£ç†åˆ†æ&#34;&gt;JDK åŠ¨æ€ä»£ç†åˆ†æ&lt;/h3&gt;
&lt;p&gt;JDK åŠ¨æ€ä»£ç†ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/JDK%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86%E4%BB%A3%E7%90%86%E5%AF%B9%E8%B1%A1.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;è‡ªå®šä¹‰åŠ¨æ€ä»£ç†ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86%E4%BB%A3%E7%90%86%E5%AF%B9%E8%B1%A1.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h4 id=&#34;ä»£ç†ç±»&#34;&gt;ä»£ç†ç±»&lt;/h4&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E4%BB%A3%E7%90%86%E7%B1%BB.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h4 id=&#34;å¾—åˆ°ä»£ç†ç±»çš„æ„é€ æ–¹æ³•&#34;&gt;å¾—åˆ°ä»£ç†ç±»çš„æ„é€ æ–¹æ³•&lt;/h4&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%BE%97%E5%88%B0%E4%BB%A3%E7%90%86%E7%B1%BB%E7%9A%84%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h4 id=&#34;ä½¿ç”¨ä»£ç†ç±»çš„æ„é€ æ–¹æ³•-new-ä¸€ä¸ªå¯¹è±¡å‡ºæ¥&#34;&gt;ä½¿ç”¨ä»£ç†ç±»çš„æ„é€ æ–¹æ³• new ä¸€ä¸ªå¯¹è±¡å‡ºæ¥&lt;/h4&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E4%BD%BF%E7%94%A8%E4%BB%A3%E7%90%86%E7%B1%BB%E7%9A%84%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95new%E4%B8%80%E4%B8%AA%E5%AF%B9%E8%B1%A1%E5%87%BA%E6%9D%A5.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h4 id=&#34;class-cl-getproxyclass0loader-intfs&#34;&gt;Class&amp;lt;?&amp;gt; cl = getProxyClass0(loader, intfs);&lt;/h4&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/getProxyClass0.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h4 id=&#34;public-v-getk-key-p-parameter&#34;&gt;public V get(K key, P parameter) {&lt;/h4&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/get.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h4 id=&#34;debugger&#34;&gt;debugger&lt;/h4&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;9&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/debugger.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h4 id=&#34;v-value-supplierget&#34;&gt;V value = supplier.get();&lt;/h4&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;10&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/suppiler.get.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h4 id=&#34;public-synchronized-v-get&#34;&gt;public synchronized V get() {&lt;/h4&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;11&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%BF%94%E5%9B%9Evalue.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h4 id=&#34;value-objectsrequirenonnullvaluefactoryapplykey-parameter&#34;&gt;value = Objects.requireNonNull(valueFactory.apply(key, parameter))&lt;/h4&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;12&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/requireNonNull.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h4 id=&#34;public-class-applyclassloader-loader-class-interfaces&#34;&gt;public Class&lt;?&gt; apply(ClassLoader loader, Class&lt;?&gt;[] interfaces) {&lt;/h4&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;13&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/apply.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h4 id=&#34;ä½¿ç”¨ç±»åŠ è½½å™¨åˆ¤æ–­æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡&#34;&gt;ä½¿ç”¨ç±»åŠ è½½å™¨åˆ¤æ–­æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡&lt;/h4&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;14&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E4%BD%BF%E7%94%A8%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E6%98%AF%E5%90%8C%E4%B8%80%E4%B8%AA%E5%AF%B9%E8%B1%A1.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h4 id=&#34;åˆ¤æ–­æ¥å£çš„æƒé™ä¿®é¥°ç¬¦&#34;&gt;åˆ¤æ–­æ¥å£çš„æƒé™ä¿®é¥°ç¬¦&lt;/h4&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;15&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%88%A4%E6%96%AD%E6%8E%A5%E5%8F%A3%E7%9A%84%E6%9D%83%E9%99%90%E4%BF%AE%E9%A5%B0%E7%AC%A6.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h4 id=&#34;string-proxyname-proxypkg-proxyclassnameprefix-num&#34;&gt;String proxyName = proxyPkg + proxyClassNamePrefix + num;&lt;/h4&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;16&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/proxyName.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ç±»ååŠ ä¸Šæ ‡è¯†0ï¼Œæ˜¯ä¸ºäº†é˜²æ­¢å¹¶å‘æƒ…å†µä¸‹äº§ç”Ÿé—®é¢˜ã€‚&lt;/p&gt;
&lt;h4 id=&#34;byte-proxyclassfile-proxygeneratorgenerateproxyclassproxyname-interfaces-accessflags&#34;&gt;byte[] proxyClassFile = ProxyGenerator.generateProxyClass(proxyName, interfaces, accessFlags);&lt;/h4&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;17&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/generateProxyClass.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;18&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/JDK%E4%BB%A3%E7%90%86%E8%BF%87%E7%A8%8B.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
">Springç³»åˆ—ï¼ˆä¸‰ï¼‰ä¸€ç¯‡æ–‡ç« å­¦ä¼š JDK åŠ¨æ€ä»£ç†å¹¶æ‰‹åŠ¨æ¨¡æ‹Ÿä¸€ä¸ªåŠ¨æ€ä»£ç†</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/springaop-ying-yong/"" data-c="
          &lt;h1 id=&#34;è‡ªå®šä¹‰æ³¨è§£&#34;&gt;è‡ªå®šä¹‰æ³¨è§£&lt;/h1&gt;
&lt;h2 id=&#34;xml-çš„ä½œç”¨&#34;&gt;xml çš„ä½œç”¨ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;ç­”ï¼š&lt;strong&gt;æè¿°æ•°æ®&lt;/strong&gt;ã€‚&lt;br&gt;
ä¸¾ä¾‹ï¼šæ•°æ®åº“ä¸­æœ‰ä¸€å¼  user è¡¨ï¼Œé¡¹ç›®ä¸­æœ‰ä¸€ä¸ª User ç±»ï¼Œå¦‚ä½•å°† User ç±»ä¸ user è¡¨&lt;strong&gt;å…³è”&lt;/strong&gt;ï¼Ÿ&lt;br&gt;
ç­”ï¼šä½¿ç”¨ xml æ¥æè¿°å…ƒæ•°æ®ã€‚&lt;br&gt;
é‚£ä¸ºä»€ä¹ˆè¿˜è¦æœ‰è‡ªå®šä¹‰æ³¨è§£å‘¢ï¼Ÿå› ä¸ºxml å¼€å‘è¿‡ç¨‹è¿‡äºå¤æ‚ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è‡ªå®šä¹‰æ³¨è§£-2&#34;&gt;è‡ªå®šä¹‰æ³¨è§£&lt;/h2&gt;
&lt;h3 id=&#34;ä¸€-å‡†å¤‡é˜¶æ®µ&#34;&gt;ä¸€ã€å‡†å¤‡é˜¶æ®µ&lt;/h3&gt;
&lt;h4 id=&#34;1å®šä¹‰å®ä½“ç±»&#34;&gt;1.å®šä¹‰å®ä½“ç±»&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.ssm.entity;

import com.ssm.anno.Entity;

public class CityEntity {

    private Integer id;
    private String name;

    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;2å®šä¹‰å·¥å…·ç±»&#34;&gt;2.å®šä¹‰å·¥å…·ç±»&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.ssm.util;

public class CommonUtil {
    /**
     * é€šè¿‡ä¸€ä¸ªå¯¹è±¡æ„å»ºä¸€æ¡æŸ¥è¯¢çš„ sql è¯­å¥
     * @param obj
     */
    public static String buildQuerySqlForEntity(Object obj){

        // è¡¨åã€å­—æ®µåº”è¯¥æ ¹æ®ä¼ å…¥çš„å€¼åŠ¨æ€å˜åŒ–ï¼Œä¸åº”è¯¥å†™æ­»
        // åŠæ³•ï¼šåœ¨å®ä½“ç±» CityEntity ä¸­åŠ å…¥æ³¨è§£ @Tableï¼ˆéœ€è¦å¯¼å…¥JPAï¼‰ï¼Œæˆ‘ä»¬ä½¿ç”¨è‡ªå®šä¹‰æ³¨è§£æ¥å®ç°
        String sql = &amp;quot;select * from ? where id=? and name=?&amp;quot;;

        return null;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;3æµ‹è¯•æ–¹æ³•&#34;&gt;3.æµ‹è¯•æ–¹æ³•&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.ssm.util;

public class CommonUtil {
    /**
     * é€šè¿‡ä¸€ä¸ªå¯¹è±¡æ„å»ºä¸€æ¡æŸ¥è¯¢çš„ sql è¯­å¥
     * @param obj
     */
    public static String buildQuerySqlForEntity(Object obj){

        // è¡¨åã€å­—æ®µåº”è¯¥æ ¹æ®ä¼ å…¥çš„å€¼åŠ¨æ€å˜åŒ–ï¼Œä¸åº”è¯¥å†™æ­»
        // åŠæ³•ï¼šåœ¨å®ä½“ç±» CityEntity ä¸­åŠ å…¥æ³¨è§£ @Tableï¼ˆéœ€è¦å¯¼å…¥JPAï¼‰ï¼Œæˆ‘ä»¬ä½¿ç”¨è‡ªå®šä¹‰æ³¨è§£æ¥å®ç°
        String sql = &amp;quot;select * from ? where id=? and name=?&amp;quot;;

        return null;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;äºŒ-è‡ªå®šä¹‰æ³¨è§£åŸºæœ¬åŠŸèƒ½&#34;&gt;äºŒã€è‡ªå®šä¹‰æ³¨è§£â€”â€”åŸºæœ¬åŠŸèƒ½&lt;/h3&gt;
&lt;h4 id=&#34;1è‡ªå®šä¹‰æ³¨è§£&#34;&gt;1.è‡ªå®šä¹‰æ³¨è§£&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public @interface Entity {
    public String value();
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;2å®ä½“ç±»æ·»åŠ æ³¨è§£&#34;&gt;2.å®ä½“ç±»æ·»åŠ æ³¨è§£&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// æ³¨è§£é‡Œé¢çš„ value æ–¹æ³•ï¼Œè¿”å›å€¼æ˜¯ String ç±»å‹
@Entity(value = &amp;quot;city&amp;quot;)
public class CityEntity {
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;ä¸‰-è‡ªå®šä¹‰æ³¨è§£å…ƒæ³¨è§£&#34;&gt;ä¸‰ã€è‡ªå®šä¹‰æ³¨è§£â€”â€”å…ƒæ³¨è§£&lt;/h3&gt;
&lt;h4 id=&#34;1å®ä½“ç±»ä½“ä¼šå…ƒæ³¨è§£&#34;&gt;1.å®ä½“ç±»ä½“ä¼šå…ƒæ³¨è§£&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;//@Override   
// @Override&#39; not applicable to typeï¼š@Override ä¸é€‚ç”¨ä¿®é¥°ç±»
public class CityEntity {

// @Override   
// Method does not override method from its superclassï¼šæ²¡æœ‰çˆ¶ç±»é‡å†™çš„æ–¹æ³•ã€‚è¡¨å @Override æ³¨è§£å¯ç”¨äºä¿®é¥°æ–¹æ³•
    public void setId(Integer id) {
        this.id = id;
    }    
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åˆ†æå¾—çŸ¥ï¼š@Override æ³¨è§£å¯ç”¨äºä¿®é¥°æ–¹æ³•ï¼Œä¸å¯ç”¨äºä¿®é¥°ç±»ã€‚&lt;br&gt;
äºæ˜¯æˆ‘ä»¬æ¥æ”¹åŠ¨ä¸€ä¸‹æˆ‘ä»¬çš„è‡ªå®šä¹‰æ³¨è§£ @Entityï¼Œè®©å®ƒåªèƒ½ç”¨äºä¿®é¥°ç±»ï¼Œä¸èƒ½ç”¨äºä¿®é¥°æ–¹æ³•ã€‚&lt;/p&gt;
&lt;h4 id=&#34;2ä¿®æ”¹è‡ªå®šä¹‰æ³¨è§£ç±»&#34;&gt;2.ä¿®æ”¹è‡ªå®šä¹‰æ³¨è§£ç±»&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// @Entity æ³¨è§£èƒ½å¤Ÿå‡ºç°çš„ç›®æ ‡ä½ç½®ï¼šTYPEï¼šç±»
@Target(ElementType.TYPE)
// @Target({ElementType.TYPE, ElementType.FIELD})ï¼šæŒ‡å®šå¤šä¸ªå¯ä»¥å‡ºç°çš„ä½ç½®ï¼šç±»ã€
public @interface Entity {
    public String value();
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;å››-è·å¾—æ³¨è§£å†…çš„å€¼&#34;&gt;å››ã€è·å¾—æ³¨è§£å†…çš„å€¼&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.ssm.util;

import com.ssm.anno.Entity;

import java.lang.annotation.Annotation;

public class CommonUtil {
    public static String buildQuerySqlForEntity(Object obj){
        // å¾—åˆ°ç±»çš„ç±»å¯¹è±¡
        Class clazz = obj.getClass();
        // setup1 åˆ¤æ–­æ˜¯å¦åŠ äº†è¿™ä¸ªæ³¨è§£
        if(clazz.isAnnotationPresent(Entity.class)){
            // setup2 å¾—åˆ°æ³¨è§£
            Entity entity = (Entity) clazz.getDeclaredAnnotation(Entity.class);
            // setup3 è°ƒç”¨æ–¹æ³•
            String value = entity.value();
            System.out.println(value);  // city
        }

        // è¡¨åã€å­—æ®µåº”è¯¥æ ¹æ®ä¼ å…¥çš„å€¼åŠ¨æ€å˜åŒ–ï¼Œä¸åº”è¯¥å†™æ­»
        // åŠæ³•ï¼šåœ¨å®ä½“ç±» CityEntity ä¸­åŠ å…¥æ³¨è§£ @Tableï¼ˆéœ€è¦å¯¼å…¥JPAï¼‰ï¼Œæˆ‘ä»¬ä½¿ç”¨è‡ªå®šä¹‰æ³¨è§£æ¥å®ç°
        String sql = &amp;quot;select * from ? where id=? and name=?&amp;quot;;

        return null;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;æ³¨è§£ç”Ÿå‘½å‘¨æœŸ&#34;&gt;æ³¨è§£ç”Ÿå‘½å‘¨æœŸ&lt;/h2&gt;
&lt;h3 id=&#34;retentionretentionpolicysource&#34;&gt;@Retention(RetentionPolicy.SOURCE)&lt;/h3&gt;
&lt;p&gt;æ³¨è§£çš„ç”Ÿå‘½å‘¨æœŸï¼šé»˜è®¤æƒ…å†µä¸‹ä»…ä»…å­˜åœ¨äº Java æºç ä¸­ï¼Œå³@Retention(RetentionPolicy.SOURCE)ï¼Œå½“ JVM ä¸€æ—¦æŠŠå®ƒç¼–è¯‘æˆå­—èŠ‚ç ï¼Œæ³¨è§£ä¼šè‡ªåŠ¨ä¸¢å¤±ã€‚&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%B3%A8%E8%A7%A3%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9FSOURCE.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;retentionretentionpolicyclass&#34;&gt;@Retention(RetentionPolicy.CLASS)&lt;/h3&gt;
&lt;p&gt;ä¼šå­˜åœ¨äº .class æ–‡ä»¶ä¸­ï¼Œä½†æ˜¯åœ¨ä»£ç è¢«è¿è¡Œæ—¶è¿˜æ˜¯ä¼šè¢« JVM å¿½ç•¥ã€‚&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%B3%A8%E8%A7%A3%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9FCLASS.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æµ‹è¯•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.ssm.util;

import com.ssm.anno.Entity;

public class CommonUtil {

    public static String buildQuerySqlForEntity(Object obj){
        // å¾—åˆ°ç±»çš„ç±»å¯¹è±¡
        Class clazz = obj.getClass();
        // setup1 åˆ¤æ–­æ˜¯å¦åŠ äº†è¿™ä¸ªæ³¨è§£
        boolean b = clazz.isAnnotationPresent(Entity.class); // false
        System.out.println(b);

        return null;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;retentionretentionpolicyruntime&#34;&gt;@Retention(RetentionPolicy.RUNTIME)&lt;/h3&gt;
&lt;p&gt;åªæœ‰å½“æ³¨è§£çš„ç”Ÿå‘½å‘¨æœŸå£°æ˜ä¸º RUNTIME æ—¶ï¼Œåœ¨æ‰§è¡Œæ—¶æ‰ä¼šè¢« JVM å‘è§‰åˆ°ã€‚&lt;br&gt;
boolean b = clazz.isAnnotationPresent(Entity.class);//true&lt;/p&gt;
&lt;h1 id=&#34;aop-æ˜¯ä»€ä¹ˆ&#34;&gt;AOP æ˜¯ä»€ä¹ˆ&lt;/h1&gt;
&lt;p&gt;ä¸OOPå¯¹æ¯”ï¼Œé¢å‘åˆ‡é¢ï¼Œä¼ ç»Ÿçš„OOPå¼€å‘ä¸­çš„ä»£ç é€»è¾‘æ˜¯è‡ªä¸Šè€Œä¸‹çš„ï¼Œè€Œè¿™äº›è¿‡ç¨‹ä¼šäº§ç”Ÿä¸€äº›æ¨ªåˆ‡æ€§é—®é¢˜ï¼Œè¿™äº›æ¨ªåˆ‡æ€§çš„é—®é¢˜å’Œæˆ‘ä»¬çš„ä¸»ä¸šåŠ¡é€»è¾‘å…³ç³»ä¸å¤§ï¼Œè¿™äº›æ¨ªåˆ‡æ€§é—®é¢˜ä¸ä¼šå½±å“åˆ°ä¸»é€»è¾‘å®ç°çš„ï¼Œä½†æ˜¯ä¼šæ•£è½åˆ°ä»£ç çš„å„ä¸ªéƒ¨åˆ†ï¼Œéš¾ä»¥ç»´æŠ¤ã€‚AOPæ˜¯å¤„ç†ä¸€äº›æ¨ªåˆ‡æ€§é—®é¢˜ï¼ŒAOPçš„ç¼–ç¨‹æ€æƒ³å°±æ˜¯æŠŠè¿™äº›é—®é¢˜å’Œä¸»ä¸šåŠ¡é€»è¾‘åˆ†å¼€ï¼Œè¾¾åˆ°ä¸ä¸»ä¸šåŠ¡é€»è¾‘è§£è€¦çš„ç›®çš„ã€‚ä½¿ä»£ç çš„é‡ç”¨æ€§å’Œå¼€å‘æ•ˆç‡æ›´é«˜ã€‚&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/AOP%E6%98%AF%E4%BB%80%E4%B9%88.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;aop-çš„åº”ç”¨åœºæ™¯&#34;&gt;AOP çš„åº”ç”¨åœºæ™¯&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;æ—¥å¿—è®°å½•&lt;/li&gt;
&lt;li&gt;æƒé™éªŒè¯&lt;/li&gt;
&lt;li&gt;æ•ˆç‡æ£€æŸ¥&lt;/li&gt;
&lt;li&gt;äº‹åŠ¡ç®¡ç†&lt;/li&gt;
&lt;li&gt;exception&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;springaop-çš„åº•å±‚æŠ€æœ¯&#34;&gt;SpringAOP çš„åº•å±‚æŠ€æœ¯&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;JDKåŠ¨æ€ä»£ç†&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;CGLIBä»£ç†&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;ç¼–è¯‘æ—¶æœŸçš„ç»‡å…¥è¿˜æ˜¯è¿è¡Œæ—¶æœŸçš„ç»‡å…¥?&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;è¿è¡Œæ—¶æœŸç»‡å…¥&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;è¿è¡Œæ—¶æœŸç»‡å…¥&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;åˆå§‹åŒ–æ—¶æœŸç»‡å…¥è¿˜æ˜¯è·å–å¯¹è±¡æ—¶æœŸç»‡å…¥ï¼Ÿ&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;åˆå§‹åŒ–æ—¶æœŸç»‡å…¥&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;åˆå§‹åŒ–æ—¶æœŸç»‡å…¥&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;springaop-å’Œ-aspectj-çš„å…³ç³»&#34;&gt;SpringAOP å’Œ AspectJ çš„å…³ç³»&lt;/h2&gt;
&lt;p&gt;AOP æ˜¯ä¸€ç§æ¦‚å¿µ&lt;br&gt;
SpringAOPã€AspectJ éƒ½æ˜¯ AOP çš„å®ç°ï¼ŒSpringAOP æœ‰è‡ªå·±çš„è¯­æ³•ï¼Œä½†æ˜¯è¯­æ³•å¤æ‚ï¼Œæ‰€ä»¥SpringAOP å€ŸåŠ©äº†AspectJ çš„æ³¨è§£ï¼Œä½†æ˜¯åº•å±‚å®ç°è¿˜æ˜¯è‡ªå·±çš„&lt;br&gt;
AspectJ æ˜¯é™æ€æ³¨å…¥ï¼šç¼–è¯‘ï¼ˆ.java -&amp;gt; .classï¼‰æ—¶å°±å®Œæˆäº†æ³¨å…¥ï¼ŒSpringAOPæ˜¯åŠ¨æ€æ³¨å…¥ï¼šè¿è¡Œæ—¶æ‰æ³¨å…¥&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;spring AOPæä¾›ä¸¤ç§ç¼–ç¨‹é£æ ¼
@AspectJ support         ------------&amp;gt;åˆ©ç”¨aspectjçš„æ³¨è§£
Schema-based AOP support -----------&amp;gt;xml aop:config å‘½åç©ºé—´

è¯æ˜:spring,é€šè¿‡æº  ç åˆ†æäº†,æˆ‘ä»¬å¯ä»¥çŸ¥é“springåº•å±‚ä½¿ç”¨çš„æ˜¯JDKæˆ–è€…CGLIBæ¥å®Œæˆçš„ä»£ç†,å¹¶ä¸”åœ¨å®˜ç½‘ä¸Šspringç»™å‡ºäº†aspectjçš„æ–‡æ¡£,å’ŒspringAOPæ˜¯ä¸åŒçš„
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœæ‚¨åªéœ€è¦å»ºè®®åœ¨Spring beanä¸Šæ‰§è¡Œæ“ä½œï¼Œé‚£ä¹ˆSpring AOPæ˜¯æ­£ç¡®çš„é€‰æ‹©ã€‚å¦‚æœéœ€è¦é€šçŸ¥Springå®¹å™¨æ²¡æœ‰ç®¡ç†çš„å¯¹è±¡(é€šå¸¸æ˜¯åŸŸå¯¹è±¡)ï¼Œåˆ™éœ€è¦ä½¿ç”¨AspectJã€‚&lt;br&gt;
Spring AOPçš„æ¦‚å¿µ&lt;br&gt;
å‚è€ƒé“¾æ¥ï¼š&lt;a href=&#34;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#aop-introduction-defn&#34;&gt;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#aop-introduction-defn&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;aspect:ä¸€å®šè¦ç»™springå»ç®¡ç†Â  æŠ½è±¡Â  aspectj-&amp;gt;ç±»&lt;/li&gt;
&lt;li&gt;pointcut:åˆ‡ç‚¹è¡¨ç¤ºè¿æ¥ç‚¹çš„é›†åˆÂ  -----------------&amp;gt;Â  Â è¡¨ ï¼ˆæˆ‘çš„ç†è§£ï¼šPointCutæ˜¯JoinPointçš„è°“è¯­ï¼Œè¿™æ˜¯ä¸€ä¸ªåŠ¨ä½œï¼Œä¸»è¦æ˜¯å‘Šè¯‰é€šçŸ¥è¿æ¥ç‚¹åœ¨å“ªé‡Œï¼Œåˆ‡ç‚¹è¡¨è¾¾å¼å†³å®š JoinPoint çš„æ•°é‡ï¼‰&lt;/li&gt;
&lt;li&gt;Joinpoint:è¿æ¥ç‚¹Â  Â ç›®æ ‡å¯¹è±¡ä¸­çš„æ–¹æ³• ----------------&amp;gt;Â  Â  è®°å½•ï¼ˆæˆ‘çš„ç†è§£ï¼šJoinPointæ˜¯è¦å…³æ³¨å’Œå¢å¼ºçš„æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¦ä½œç”¨çš„ç‚¹ï¼‰&lt;/li&gt;
&lt;li&gt;Weaving :æŠŠä»£ç†é€»è¾‘åŠ å…¥åˆ°ç›®æ ‡å¯¹è±¡ä¸Šçš„è¿‡ç¨‹å«åšç»‡å…¥&lt;/li&gt;
&lt;li&gt;target ç›®æ ‡å¯¹è±¡ åŸå§‹å¯¹è±¡&lt;/li&gt;
&lt;li&gt;aop Proxy ä»£ç†å¯¹è±¡Â  åŒ…å«äº†åŸå§‹å¯¹è±¡çš„ä»£ç å’Œå¢åŠ åçš„ä»£ç çš„é‚£ä¸ªå¯¹è±¡&lt;/li&gt;
&lt;li&gt;advice:é€šçŸ¥Â  Â  (ä½ç½® + logic)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;aspect-åˆ‡é¢&#34;&gt;Aspect åˆ‡é¢&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Aspect: A modularization of a concern that cuts across multiple classes. Transaction management is a good example of a crosscutting concern in enterprise Java applications. In Spring AOP, aspects are implemented by using regular classes (the schema-based approach) or regular classes annotated with the @Aspect annotation (the @AspectJ style).&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åˆ‡é¢æ˜¯ï¼šé€šçŸ¥ã€åˆ‡ç‚¹ã€è¿æ¥ç‚¹çš„è½½ä½“ã€‚é€šçŸ¥ã€è¿æ¥ç‚¹è¦æ”¾åˆ°å“ªé‡Œå»ï¼Œå¥½æ¯” Java ä¸­çš„å±æ€§ã€æ–¹æ³•ã€æ„é€ æ–¹æ³•ï¼Œè¿™äº›ä¸œè¥¿è¦æ”¾åˆ°å“ªé‡Œå»ï¼Ÿæ”¾åˆ°ä¸€ä¸ªç±»é‡Œé¢ï¼Œè¿™ä¸ªç±»å°±æ˜¯æ–¹æ³•ä»¥åŠå‚æ•°å±æ€§çš„è½½ä½“ã€‚åˆ‡é¢å°±æ˜¯è¿æ¥ç‚¹ã€åˆ‡ç‚¹ã€é€šçŸ¥çš„è½½ä½“ï¼ŒæŠŠè¿™äº›è¿æ¥ç‚¹ã€åˆ‡ç‚¹ã€é€šçŸ¥æ‰€åœ¨çš„ä½ç½®ç§°ä¹‹ä¸ºä¸€ä¸ªåˆ‡é¢ã€‚&lt;/p&gt;
&lt;h2 id=&#34;join-point-è¿æ¥ç‚¹&#34;&gt;Join point è¿æ¥ç‚¹&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Join point: A point during the execution of a program, such as the execution of a method or the handling of an exception. In Spring AOP, a join point always represents a method execution.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿æ¥ç‚¹ï¼šç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­çš„ä¸€ä¸ªç‚¹ï¼Œå¦‚æ–¹æ³•çš„æ‰§è¡Œæˆ–å¼‚å¸¸çš„å¤„ç†ã€‚åœ¨Spring AOPä¸­ï¼Œè¿æ¥ç‚¹æ€»æ˜¯è¡¨ç¤ºæ–¹æ³•æ‰§è¡Œã€‚&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/AOP%E8%BF%9E%E6%8E%A5%E7%82%B9.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ProceedingJoinPoint å’Œ JoinPoint çš„åŒºåˆ«:&lt;br&gt;
ProceedingJoinPoint  ç»§æ‰¿äº†JoinPoint ,proceed()è¿™ä¸ªæ˜¯aopä»£ç†é“¾æ‰§è¡Œçš„æ–¹æ³•ã€‚å¹¶æ‰©å……å®ç°äº†proceed()æ–¹æ³•ï¼Œç”¨äºç»§ç»­æ‰§è¡Œè¿æ¥ç‚¹ã€‚JoinPoint ä»…èƒ½è·å–ç›¸å…³å‚æ•°ï¼Œæ— æ³•æ‰§è¡Œè¿æ¥ç‚¹ã€‚&lt;br&gt;
JoinPoint çš„æ–¹æ³•ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;java.lang.Object[] getArgs()ï¼šè·å–è¿æ¥ç‚¹æ–¹æ³•è¿è¡Œæ—¶çš„å…¥å‚åˆ—è¡¨ï¼›&lt;/li&gt;
&lt;li&gt;Signature getSignature() ï¼šè·å–è¿æ¥ç‚¹çš„æ–¹æ³•ç­¾åå¯¹è±¡ï¼›&lt;/li&gt;
&lt;li&gt;java.lang.Object getTarget() ï¼šè·å–è¿æ¥ç‚¹æ‰€åœ¨çš„ç›®æ ‡å¯¹è±¡ï¼›&lt;/li&gt;
&lt;li&gt;java.lang.Object getThis() ï¼šè·å–ä»£ç†å¯¹è±¡æœ¬èº«ï¼›&lt;br&gt;
proceed()æœ‰é‡è½½,æœ‰ä¸ªå¸¦å‚æ•°çš„æ–¹æ³•,å¯ä»¥ä¿®æ”¹ç›®æ ‡æ–¹æ³•çš„çš„å‚æ•°&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Advice é€šçŸ¥&lt;br&gt;
Advice: Action taken by an aspect at a particular join point. Different types of advice include â€œaroundâ€, â€œbeforeâ€ and â€œafterâ€ advice. (Advice types are discussed later.) Many AOP frameworks, including Spring, model an advice as an interceptor and maintain a chain of interceptors around the join point.&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/AOP%E9%80%9A%E7%9F%A5.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;adviceé€šçŸ¥ç±»å‹:&lt;/li&gt;
&lt;li&gt;Before è¿æ¥ç‚¹æ‰§è¡Œä¹‹å‰ï¼Œä½†æ˜¯æ— æ³•é˜»æ­¢è¿æ¥ç‚¹çš„æ­£å¸¸æ‰§è¡Œï¼Œé™¤éè¯¥æ®µæ‰§è¡ŒæŠ›å‡ºå¼‚å¸¸&lt;/li&gt;
&lt;li&gt;AfterÂ  è¿æ¥ç‚¹æ­£å¸¸æ‰§è¡Œä¹‹åï¼Œæ‰§è¡Œè¿‡ç¨‹ä¸­æ­£å¸¸æ‰§è¡Œè¿”å›é€€å‡ºï¼Œéå¼‚å¸¸é€€å‡º&lt;/li&gt;
&lt;li&gt;After throwingÂ  æ‰§è¡ŒæŠ›å‡ºå¼‚å¸¸çš„æ—¶å€™&lt;/li&gt;
&lt;li&gt;After (finally)Â  æ— è®ºè¿æ¥ç‚¹æ˜¯æ­£å¸¸é€€å‡ºè¿˜æ˜¯å¼‚å¸¸é€€å‡ºï¼Œéƒ½ä¼šæ‰§è¡Œ&lt;/li&gt;
&lt;li&gt;Around advice: å›´ç»•è¿æ¥ç‚¹æ‰§è¡Œï¼Œä¾‹å¦‚æ–¹æ³•è°ƒç”¨ã€‚è¿™æ˜¯æœ€æœ‰ç”¨çš„åˆ‡é¢æ–¹å¼ã€‚aroundé€šçŸ¥å¯ä»¥åœ¨æ–¹æ³•è°ƒç”¨ä¹‹å‰å’Œä¹‹åæ‰§è¡Œè‡ªå®šä¹‰è¡Œä¸ºã€‚å®ƒè¿˜è´Ÿè´£é€‰æ‹©æ˜¯ç»§ç»­åŠ å…¥ç‚¹è¿˜æ˜¯é€šè¿‡è¿”å›è‡ªå·±çš„è¿”å›å€¼æˆ–æŠ›å‡ºå¼‚å¸¸æ¥å¿«é€Ÿå»ºè®®çš„æ–¹æ³•æ‰§è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;after&#34;&gt;After&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@After(&amp;quot;pointCutTarget()&amp;quot;)
public void after(){
    System.out.println(&amp;quot;after&amp;quot;);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;before&#34;&gt;Before&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Before(&amp;quot;pointCut()&amp;quot;)
public void before(JoinPoint joinPoint){
    System.out.println(&amp;quot;before&amp;quot;);
    System.out.println(joinPoint.getThis());
    System.out.println(joinPoint.getTarget());
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ–­ç‚¹è°ƒè¯•ï¼š&lt;br&gt;
1ã€joinPoint.getThis()&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%BF%9E%E6%8E%A5%E7%82%B9%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95_1.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%BF%9E%E6%8E%A5%E7%82%B9%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
2ã€joinPoint.getTarget()&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%BF%9E%E6%8E%A5%E7%82%B9%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95_3.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;around&#34;&gt;Around&lt;/h3&gt;
&lt;p&gt;åœ¨é€šçŸ¥ä¸­æ‹¿åˆ°è¿æ¥ç‚¹ï¼Œç„¶åæ‰§è¡Œè¿æ¥ç‚¹ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Around(&amp;quot;pointCut()&amp;quot;)
// ProceedingJoinPointï¼šæ­£åœ¨è¿›è¡Œçš„ JointPointï¼šæ­£åœ¨å¢å¼ºçš„æ–¹æ³•
public void around(ProceedingJoinPoint pjp) throws Throwable {
    System.out.println(&amp;quot;around...before&amp;quot;);
    // æ‹¿åˆ°æ–¹æ³•å¹¶æ‰§è¡Œå®ƒ
    pjp.proceed();
    System.out.println(&amp;quot;around...after&amp;quot;);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æµ‹è¯•ç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;around...before
query
around...after
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;xml-é€šçŸ¥&#34;&gt;XML é€šçŸ¥&lt;/h3&gt;
&lt;p&gt;1ã€ç¼–å†™ xmlï¼Œå®šä¹‰åˆ‡é¢ã€è¿æ¥ç‚¹ã€é€šçŸ¥&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;beans xmlns=&amp;quot;http://www.springframework.org/schema/beans&amp;quot;
       xmlns:xsi=&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;
       xmlns:aop=&amp;quot;http://www.springframework.org/schema/aop&amp;quot;
       xmlns:context=&amp;quot;http://www.springframework.org/schema/context&amp;quot;
       xsi:schemaLocation=&amp;quot;http://www.springframework.org/schema/beans
                         http://www.springframework.org/schema/beans/spring-beans.xsd
                         http://www.springframework.org/schema/aop
                         http://www.springframework.org/schema/aop/spring-aop.xsd
                         http://www.springframework.org/schema/context
                         http://www.springframework.org/schema/context/spring-context.xsd&amp;quot;&amp;gt;

    &amp;lt;context:component-scan base-package=&amp;quot;com.ssm&amp;quot;/&amp;gt;
    &amp;lt;!-- å®šä¹‰ä¸€ä¸ªåˆ‡é¢ --&amp;gt;
    &amp;lt;aop:config&amp;gt;
        &amp;lt;!-- å®šä¹‰ä¸€ä¸ªè¿æ¥ç‚¹ --&amp;gt;
        &amp;lt;aop:pointcut id=&amp;quot;allDao&amp;quot; expression=&amp;quot;execution(* com.ssm.dao.*.*(..))&amp;quot;/&amp;gt;
        &amp;lt;!-- é€šçŸ¥åŒ…å«ä¸¤éƒ¨åˆ†ï¼šä½ç½® pointcut-ref ã€é€»è¾‘ ref --&amp;gt;
        &amp;lt;aop:aspect id=&amp;quot;aspect&amp;quot; ref=&amp;quot;xmlBean&amp;quot;&amp;gt;
            &amp;lt;aop:before pointcut-ref=&amp;quot;allDao&amp;quot;
                    method=&amp;quot;before&amp;quot;/&amp;gt;
        &amp;lt;/aop:aspect&amp;gt;
    &amp;lt;/aop:config&amp;gt;

    &amp;lt;bean id=&amp;quot;xmlBean&amp;quot; class=&amp;quot;com.ssm.app.XMLAopBean&amp;quot;/&amp;gt;
    &amp;lt;bean id=&amp;quot;indexDao&amp;quot; class=&amp;quot;com.ssm.dao.impl.IndexDaoImpl&amp;quot;/&amp;gt;
&amp;lt;/beans&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€ç¼–å†™é€šçŸ¥çš„é€»è¾‘&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class XMLAopBean {
    public void before(){
        System.out.println(&amp;quot;xml before...&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3ã€æµ‹è¯•&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class TestXML {
    public static void main(String[] args) throws IOException {
        ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext(&amp;quot;spring.xml&amp;quot;);
        IndexDao dao = (IndexDao) context.getBean(&amp;quot;indexDao&amp;quot;);
        dao.query(&amp;quot;hello&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;4ã€è¿è¡Œç»“æœ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;xml before...
query
hello
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;ç¯ç»•é€šçŸ¥ä¸­æ”¹å˜å‚æ•°å€¼&#34;&gt;ç¯ç»•é€šçŸ¥ä¸­æ”¹å˜å‚æ•°å€¼&lt;/h4&gt;
&lt;p&gt;1ã€ä¼ é€’è¿›æ¥çš„å‚æ•°ä¸º &amp;quot;hello&amp;quot;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) throws IOException {
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(AppConfig.class);
        IndexDao dao = (IndexDao) context.getBean(&amp;quot;indexDao&amp;quot;);
        dao.query(&amp;quot;hello&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€åœ¨ç¯ç»•é€šçŸ¥å†…å°†å‚æ•°ä¿®æ”¹ä¸º  hello  world&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Around(&amp;quot;pointCut()&amp;quot;)
// ProceedingJoinPointï¼šæ­£åœ¨è¿›è¡Œçš„ JointPointï¼šæ­£åœ¨å¢å¼ºçš„æ–¹æ³• 
public void around(ProceedingJoinPoint pjp) throws Throwable {
    Object[] args = pjp.getArgs();
    if(args != null &amp;amp;&amp;amp; args.length &amp;gt; 0){
        for (int i = 0; i &amp;lt; args.length; i++) {
            args[i] += &amp;quot; world&amp;quot;;
        }
    }
    System.out.println(&amp;quot;around...before&amp;quot;);
    // æ‹¿åˆ°æ–¹æ³•å¹¶æ‰§è¡Œå®ƒ
    pjp.proceed(args);
    System.out.println(&amp;quot;around...after&amp;quot;);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3ã€è¾“å‡ºå‚æ•°å€¼&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Repository(&amp;quot;indexDao&amp;quot;)
public class IndexDaoImpl implements IndexDao {
    @Override
    public void query(String str){
        System.out.println(&amp;quot;query&amp;quot;);
        System.out.println(str);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;4ã€è¾“å‡ºç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;around...before
query
hello world
around...after
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;pointcut-åˆ‡ç‚¹&#34;&gt;Pointcut åˆ‡ç‚¹&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Pointcut: A predicate that matches join points. Advice is associated with a pointcut expression and runs at any join point matched by the pointcut (for example, the execution of a method with a certain name). The concept of join points as matched by pointcut expressions is central to AOP, and Spring uses the AspectJ pointcut expression language by default.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åˆ‡ç‚¹ï¼šè¿æ¥ç‚¹çš„é›†åˆã€‚&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/AOP%E5%88%87%E7%82%B9.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;introduction&#34;&gt;Introduction&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Introduction: Declaring additional methods or fields on behalf of a type. Spring AOP lets you introduce new interfaces (and a corresponding implementation) to any advised object. For example, you could use an introduction to make a bean implement an IsModified interface, to simplify caching. (An introduction is known as an inter-type declaration in the AspectJ community.)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;å®ä¾‹&#34;&gt;å®ä¾‹&lt;/h3&gt;
&lt;p&gt;1ã€å‡†å¤‡ä¸€ä¸ª IndexDao æ¥å£&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public interface IndexDao {
    void query(String str);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€å‡†å¤‡ä¸€ä¸ª IndexDao æ¥å£çš„å®ç°ç±»&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Repository(&amp;quot;indexDao&amp;quot;)
public class IndexDaoImpl implements IndexDao {
    @Override
    public void query(String str){
        System.out.println(&amp;quot;query&amp;quot;);
        System.out.println(str);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3ã€å†å‡†å¤‡ä¸€ä¸ªæ¥å£ OrderDAOï¼Œå¹¶æŠŠå®ƒæ³¨å…¥åˆ° Spring å®¹å™¨ä¸­&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Repository(&amp;quot;orderDao&amp;quot;)
public class OrderDao {
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;4ã€å¼•å…¥&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Component
// åˆ‡é¢
@Aspect
public class NotVeryUsefulAspect {
     // æ‰¾åˆ° com.ssm.dao ä¸‹çš„æ‰€æœ‰ç±»ï¼Œè®©å®ƒå¼•å…¥ IndexDao æ¥å£çš„ IndexDaoImpl å®ç°ï¼Œ
    // å³è®© class OrderDao implements IndexDaoï¼Œå¹¶ä¸”æ–¹æ³•çš„å…·ä½“å®ç°ä¸ IndexDaoImpl ç›¸åŒ
    @DeclareParents(value=&amp;quot;com.ssm.dao.*&amp;quot;, defaultImpl= IndexDaoImpl.class)
    public static IndexDao indexDao;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;5ã€æµ‹è¯•&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) throws IOException {
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(AppConfig.class);
        IndexDao dao = (IndexDao) context.getBean(&amp;quot;orderDao&amp;quot;);
        dao.query(&amp;quot;hello&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;query
hello
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;6ã€åˆ†æï¼šorderDao å†…å¹¶æ²¡æœ‰æ–¹æ³•ï¼Œä½†æ˜¯è·å¾—å®¹å™¨å†…çš„ OrderDao å¯¹è±¡åå´å¯ä»¥æ­£å¸¸è°ƒç”¨  query() æ–¹æ³•ï¼ŒåŸå› å°±æ˜¯ä½¿ç”¨äº† Introductionã€‚&lt;/p&gt;
&lt;h2 id=&#34;aspect-instantiation-models&#34;&gt;Aspect Instantiation Models&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š&lt;br&gt;
@Aspect(&amp;quot;perthis(this(com.chenss.dao.IndexDaoImpl))&amp;quot;)&lt;br&gt;
è¦æ±‚ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;AspectJå¯¹è±¡çš„æ³¨å…¥ç±»å‹ä¸ºprototype&lt;/li&gt;
&lt;li&gt;ç›®æ ‡å¯¹è±¡ä¹Ÿå¿…é¡»æ˜¯prototypeçš„&lt;br&gt;
åŸå› ä¸ºï¼šåªæœ‰ç›®æ ‡å¯¹è±¡æ˜¯åŸå‹æ¨¡å¼çš„ï¼Œæ¯æ¬¡getBeanå¾—åˆ°çš„å¯¹è±¡æ‰æ˜¯ä¸ä¸€æ ·çš„ï¼Œç”±æ­¤é’ˆå¯¹æ¯ä¸ªå¯¹è±¡å°±ä¼šäº§ç”Ÿæ–°çš„åˆ‡é¢å¯¹è±¡ï¼Œæ‰èƒ½äº§ç”Ÿä¸åŒçš„åˆ‡é¢ç»“æœã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;ç¤ºä¾‹&#34;&gt;ç¤ºä¾‹&lt;/h3&gt;
&lt;p&gt;1ã€å¤šä¾‹çš„ IndexDaoImpl&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Repository(&amp;quot;indexDao&amp;quot;)
@Scope(&amp;quot;prototype&amp;quot;)
public class IndexDaoImpl implements IndexDao {
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€å•ä¾‹çš„åˆ‡é¢&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Component
@Aspect
public class NotVeryUsefulAspect {
    // åˆ‡ç‚¹ com.ssm.dao ä¸‹çš„å­åŒ…ä¸‹çš„ä»»æ„ç±»çš„ä»»æ„æ–¹æ³• ä»»æ„è¿”å›å€¼ ä»»æ„ä¿®é¥°ç¬¦
    @Pointcut(&amp;quot;execution(* com.ssm.dao.*.*(..))&amp;quot;)
    public void pointCut(){
    }

    @Around(&amp;quot;pointCut()&amp;quot;)
    // ProceedingJoinPointï¼šæ­£åœ¨è¿›è¡Œçš„ JointPointï¼šæ­£åœ¨å¢å¼ºçš„æ–¹æ³•
    public void around(ProceedingJoinPoint pjp) throws Throwable {
        System.out.println(&amp;quot;this.hashCode = &amp;quot; + this.hashCode());
        Object[] args = pjp.getArgs();
        if(args != null &amp;amp;&amp;amp; args.length &amp;gt; 0){
            for (int i = 0; i &amp;lt; args.length; i++) {
                args[i] += &amp;quot; world&amp;quot;;
            }
        }
        System.out.println(&amp;quot;around...before&amp;quot;);
        // æ‹¿åˆ°æ–¹æ³•å¹¶æ‰§è¡Œå®ƒ
        pjp.proceed(args);
        System.out.println(&amp;quot;around...after&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3ã€æµ‹è¯•ç±»&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) throws IOException {
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(AppConfig.class);
        IndexDao dao = (IndexDao) context.getBean(&amp;quot;indexDao&amp;quot;);
        IndexDao dao1 = (IndexDao) context.getBean(&amp;quot;indexDao&amp;quot;);
        // com.ssm.dao.impl.IndexDaoImpl@24aed80c : com.ssm.dao.impl.IndexDaoImpl@3a52dba3
        System.out.println(dao+&amp;quot; : &amp;quot;+dao1);
        dao.query(&amp;quot;hello&amp;quot;);
        System.out.println(&amp;quot; - - - - - - - - - - - &amp;quot;);
        dao1.query(&amp;quot;hi&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;com.ssm.dao.impl.IndexDaoImpl@24aed80c : com.ssm.dao.impl.IndexDaoImpl@3a52dba3
this.hashCode = 1792550665
around...before
query
hello world
around...after
 - - - - - - - - - - - 
this.hashCode = 1792550665
around...before
query
hi world
around...after
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;4ã€åˆ†æï¼š&lt;br&gt;
å½“ IndexDaoImpl è®¾ç½®ä¸ºåŸå‹æ—¶ï¼Œä¸¤æ¬¡ context.getBean(&amp;quot;indexDaoImpl&amp;quot;) å¾—åˆ°çš„ IndexDaoImpl æ˜¯ä¸åŒçš„å¯¹è±¡ã€‚ä½†æ˜¯ä¸åŒçš„ bean å¯¹è±¡å¾—åˆ°çš„åˆ‡é¢å´æ˜¯å®Œå…¨ç›¸åŒçš„ã€‚&lt;/p&gt;
&lt;p&gt;æ›´æ”¹ï¼šAspectJ å¯¹è±¡çš„æ³¨å…¥ç±»å‹ä¸º prototypeï¼Œä¸ºæ‰€æœ‰ä»£ç†å¯¹è±¡æ˜¯ IndexDaoImpl çš„å•ç‹¬åˆ›å»ºä¸€ä¸ªåˆ‡ç‚¹å‡ºæ¥&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Component
// ä¸ºæ‰€æœ‰ä»£ç†å¯¹è±¡æ˜¯ IndexDaoImpl çš„å•ç‹¬åˆ›å»ºä¸€ä¸ªåˆ‡ç‚¹å‡ºæ¥
@Aspect(&amp;quot;perthis(this(com.ssm.dao.impl.IndexDaoImpl))&amp;quot;)
@Scope(&amp;quot;prototype&amp;quot;)
public class NotVeryUsefulAspect {
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;CJLIB åŠ¨æ€ä»£ç†&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Configuration
@ComponentScan(&amp;quot;com.ssm&amp;quot;)
// å¼€å¯ AspectJ è¯­æ³•æ”¯æŒ
@EnableAspectJAutoProxy(proxyTargetClass=true)
public class AppConfig {
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;com.ssm.dao.impl.IndexDaoImpl@672872e1 : com.ssm.dao.impl.IndexDaoImpl@32910148
this.hashCode = 254801937
around...before
query
hello world
around...after
 - - - - - - - - - - - 
this.hashCode = 90767234
around...before
query
hi world
around...after
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;target-objectç›®æ ‡å¯¹è±¡&#34;&gt;Target objectï¼šç›®æ ‡å¯¹è±¡&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Target object: An object being advised by one or more aspects. Also referred to as the â€œadvised objectâ€. Since Spring AOP is implemented by using runtime proxies, this object is always a proxied object.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/AOP%E7%9B%AE%E6%A0%87%E5%AF%B9%E8%B1%A1.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;aop-proxy-ä»£ç†å¯¹è±¡&#34;&gt;AOP proxy ä»£ç†å¯¹è±¡&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;AOP proxy: An object created by the AOP framework in order to implement the aspect contracts (advise method executions and so on). In the Spring Framework, an AOP proxy is a JDK dynamic proxy or a CGLIB proxy.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;weaving&#34;&gt;Weaving&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Weaving: linking aspects with other application types or objects to create an advised object. This can be done at compile time (using the AspectJ compiler, for example), load time, or at runtime. Spring AOP, like other pure Java AOP frameworks, performs weaving at runtime.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/AOP%E7%BB%87%E5%85%A5.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h1 id=&#34;springaop-æ”¯æŒ-aspectj&#34;&gt;SpringAOP æ”¯æŒ AspectJ&lt;/h1&gt;
&lt;p&gt;AOP å’Œ SpringAOP çš„ å…³ç³»ï¼ŸSpringAOP æ˜¯ AOP çš„ä¸€ç§å®ç°ã€‚&lt;br&gt;
å®ç° AOP çš„æŠ€æœ¯ï¼šAspectJã€SpringAOP&lt;br&gt;
SpringAOP å’Œ AspectJ çš„å…³ç³»ï¼ŸSpring åŸå…ˆç‰ˆæœ¬çš„ AOP è¯­æ³•è¿‡äºç¹çï¼Œäºæ˜¯ Spring å€ŸåŠ©äº† AspectJ çš„è¯­æ³•ï¼Œåº•å±‚æŠ€æœ¯è¿˜æ˜¯ç”¨çš„ Spring åº•å±‚çš„æŠ€æœ¯ã€‚&lt;br&gt;
å‚è€ƒèµ„æ–™ï¼š&lt;a href=&#34;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#aop-ataspectj&#34;&gt;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#aop-ataspectj&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;0-å¯¼å…¥-spring-ä¾èµ–&#34;&gt;0ã€å¯¼å…¥ Spring ä¾èµ–&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;dependency&amp;gt;
  &amp;lt;groupId&amp;gt;org.springframework&amp;lt;/groupId&amp;gt;
  &amp;lt;artifactId&amp;gt;spring-context&amp;lt;/artifactId&amp;gt;
  &amp;lt;version&amp;gt;5.0.9.RELEASE&amp;lt;/version&amp;gt;
&amp;lt;/dependency&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å‡†å¤‡ä¸€ä¸ª IndexDaoï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Repository
public class IndexDao {
    public void query(){
        System.out.println(&amp;quot;query&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;1-å¯ç”¨aspectjæ”¯æŒ&#34;&gt;1ã€å¯ç”¨@AspectJæ”¯æŒ&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨Java Configurationå¯ç”¨@AspectJæ”¯æŒ&lt;br&gt;
è¦ä½¿ç”¨Java @Configurationå¯ç”¨@AspectJæ”¯æŒï¼Œè¯·æ·»åŠ @EnableAspectJAutoProxyæ³¨é‡Š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Configuration
@ComponentScan(&amp;quot;com.ssm&amp;quot;)
@EnableAspectJAutoProxy
public class AppConfig {

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½¿ç”¨XMLé…ç½®å¯ç”¨@AspectJæ”¯æŒ&lt;br&gt;
è¦ä½¿ç”¨åŸºäºxmlçš„é…ç½®å¯ç”¨@AspectJæ”¯æŒï¼Œå¯ä»¥ä½¿ç”¨aop:aspectj-autoproxyå…ƒç´ &lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;aop:aspectj-autoproxy/&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;2-å£°æ˜ä¸€ä¸ªaspect&#34;&gt;2ã€å£°æ˜ä¸€ä¸ªAspect&lt;/h2&gt;
&lt;p&gt;å¼•å…¥ Aspect ä¾èµ–&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;dependency&amp;gt;
  &amp;lt;groupId&amp;gt;org.aspectj&amp;lt;/groupId&amp;gt;
  &amp;lt;artifactId&amp;gt;aspectjweaver&amp;lt;/artifactId&amp;gt;
  &amp;lt;version&amp;gt;1.9.0&amp;lt;/version&amp;gt;
&amp;lt;/dependency&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å£°æ˜ä¸€ä¸ª@Aspectæ³¨é‡Šç±»ï¼Œå¹¶ä¸”å®šä¹‰æˆä¸€ä¸ªbeanäº¤ç»™Springç®¡ç†ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Component
@Aspect
public class UserAspect {
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;3-å£°æ˜ä¸€ä¸ªpointcut&#34;&gt;3ã€å£°æ˜ä¸€ä¸ªPointCut&lt;/h2&gt;
&lt;p&gt;åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ç”±@Pointcutæ³¨é‡Šè¡¨ç¤ºã€‚åˆ‡å…¥ç‚¹å£°æ˜ç”±ä¸¤éƒ¨åˆ†ç»„æˆ:ä¸€ä¸ªç­¾ååŒ…å«åç§°å’Œä»»ä½•å‚æ•°ï¼Œä»¥åŠä¸€ä¸ªåˆ‡å…¥ç‚¹è¡¨è¾¾å¼ï¼Œè¯¥è¡¨è¾¾å¼ç¡®å®šæˆ‘ä»¬å¯¹å“ªä¸ªæ–¹æ³•æ‰§è¡Œæ„Ÿå…´è¶£ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Pointcut(&amp;quot;execution(* transfer(..))&amp;quot;)// åˆ‡å…¥ç‚¹è¡¨è¾¾å¼
private void anyOldTransfer() {}// åˆ‡å…¥ç‚¹ç­¾å
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åˆ‡å…¥ç‚¹ç¡®å®šæ„Ÿå…´è¶£çš„ join pointsï¼ˆè¿æ¥ç‚¹ï¼‰ï¼Œä»è€Œä½¿æˆ‘ä»¬èƒ½å¤Ÿæ§åˆ¶ä½•æ—¶æ‰§è¡Œé€šçŸ¥ã€‚Spring AOPåªæ”¯æŒSpring beançš„æ–¹æ³•æ‰§è¡Œ join pointsï¼ˆè¿æ¥ç‚¹ï¼‰ï¼Œæ‰€ä»¥æ‚¨å¯ä»¥å°†åˆ‡å…¥ç‚¹çœ‹ä½œæ˜¯åŒ¹é…Spring beanä¸Šæ–¹æ³•çš„æ‰§è¡Œã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
 * ç”³æ˜Aspectï¼Œå¹¶ä¸”äº¤ç»™springå®¹å™¨ç®¡ç†
 */
@Component
@Aspect
public class UserAspect {
    /**
     * ç”³æ˜åˆ‡å…¥ç‚¹ï¼ŒåŒ¹é…UserDaoæ‰€æœ‰æ–¹æ³•è°ƒç”¨
     * executionåŒ¹é…æ–¹æ³•æ‰§è¡Œè¿æ¥ç‚¹
     * within:å°†åŒ¹é…é™åˆ¶ä¸ºç‰¹å®šç±»å‹ä¸­çš„è¿æ¥ç‚¹
     * argsï¼šå‚æ•°
     * targetï¼šç›®æ ‡å¯¹è±¡
     * thisï¼šä»£ç†å¯¹è±¡
     */
    @Pointcut(&amp;quot;execution(* com.yao.dao.UserDao.*(..))&amp;quot;)
    public void pintCut(){
        System.out.println(&amp;quot;point cut&amp;quot;);
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;4-å£°æ˜ä¸€ä¸ªadviceé€šçŸ¥&#34;&gt;4ã€å£°æ˜ä¸€ä¸ªAdviceé€šçŸ¥&lt;/h2&gt;
&lt;p&gt;adviceé€šçŸ¥ä¸pointcutåˆ‡å…¥ç‚¹è¡¨è¾¾å¼ç›¸å…³è”ï¼Œå¹¶åœ¨åˆ‡å…¥ç‚¹åŒ¹é…çš„æ–¹æ³•æ‰§è¡Œ@Beforeä¹‹å‰ã€@Afterä¹‹åæˆ–å‰åè¿è¡Œã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
 * ç”³æ˜Aspectï¼Œå¹¶ä¸”äº¤ç»™springå®¹å™¨ç®¡ç†
 */
@Component
@Aspect
public class UserAspect {
    /**
     * ç”³æ˜åˆ‡å…¥ç‚¹ï¼ŒåŒ¹é…UserDaoæ‰€æœ‰æ–¹æ³•è°ƒç”¨
     * executionåŒ¹é…æ–¹æ³•æ‰§è¡Œè¿æ¥ç‚¹
     * within:å°†åŒ¹é…é™åˆ¶ä¸ºç‰¹å®šç±»å‹ä¸­çš„è¿æ¥ç‚¹
     * argsï¼šå‚æ•°
     * targetï¼šç›®æ ‡å¯¹è±¡
     * thisï¼šä»£ç†å¯¹è±¡
     */
    @Pointcut(&amp;quot;execution(* com.yao.dao.UserDao.*(..))&amp;quot;)
    public void pintCut(){
        System.out.println(&amp;quot;point cut&amp;quot;);
    }
    /**
     * ç”³æ˜beforeé€šçŸ¥,åœ¨pintCutåˆ‡å…¥ç‚¹å‰æ‰§è¡Œ
     * é€šçŸ¥ä¸åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ç›¸å…³è”ï¼Œ
     * å¹¶åœ¨åˆ‡å…¥ç‚¹åŒ¹é…çš„æ–¹æ³•æ‰§è¡Œä¹‹å‰ã€ä¹‹åæˆ–å‰åè¿è¡Œã€‚
     * åˆ‡å…¥ç‚¹è¡¨è¾¾å¼å¯ä»¥æ˜¯å¯¹æŒ‡å®šåˆ‡å…¥ç‚¹çš„ç®€å•å¼•ç”¨ï¼Œä¹Ÿå¯ä»¥æ˜¯åœ¨é€‚å½“ä½ç½®å£°æ˜çš„åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ã€‚
     */
    @Before(&amp;quot;com.yao.aop.UserAspect.pintCut()&amp;quot;)
    public void beforeAdvice(){
        System.out.println(&amp;quot;before&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æµ‹è¯•ç±»ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) {
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(AppConfig.class);
        IndexDao dao = context.getBean(IndexDao.class);
        dao.query();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;before
query
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;å„ç§è¿æ¥ç‚¹-joinpoint-çš„æ„ä¹‰&#34;&gt;å„ç§è¿æ¥ç‚¹ JoinPoint çš„æ„ä¹‰:&lt;/h1&gt;
&lt;h2 id=&#34;execution&#34;&gt;execution&lt;/h2&gt;
&lt;p&gt;ç”¨äºåŒ¹é…æ–¹æ³•æ‰§è¡Œè¿æ¥ç‚¹ï¼Œæœ€å°ç²’åº¦æ–¹æ³•ï¼Œåœ¨aopä¸­ä¸»è¦ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;execution(modifiers-pattern? ret-type-pattern declaring-type-pattern? name-pattern(param-pattern)
          throws-pattern?)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™é‡Œé—®å·è¡¨ç¤ºå½“å‰é¡¹å¯ä»¥æœ‰ä¹Ÿå¯ä»¥æ²¡æœ‰ï¼Œå…¶ä¸­å„é¡¹çš„è¯­ä¹‰å¦‚ä¸‹ï¼š&lt;br&gt;
modifiers-patternï¼šæ–¹æ³•çš„å¯è§æ€§ï¼Œå¦‚publicï¼Œprotectedï¼›&lt;br&gt;
ret-type-patternï¼šæ–¹æ³•çš„è¿”å›å€¼ç±»å‹ï¼Œå¦‚intï¼Œvoidç­‰ï¼›&lt;br&gt;
declaring-type-patternï¼šæ–¹æ³•æ‰€åœ¨ç±»çš„å…¨è·¯å¾„åï¼Œå¦‚com.spring.Aspectï¼›&lt;br&gt;
name-patternï¼šæ–¹æ³•åç±»å‹ï¼Œå¦‚ buisinessService()ï¼›&lt;br&gt;
param-patternï¼šæ–¹æ³•çš„å‚æ•°ç±»å‹ï¼Œå¦‚java.lang.Stringï¼›&lt;br&gt;
throws-patternï¼šæ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸ç±»å‹ï¼Œå¦‚java.lang.Exceptionï¼›&lt;/p&gt;
&lt;h3 id=&#34;examples&#34;&gt;Examples&lt;/h3&gt;
&lt;p&gt;@Pointcut(&amp;quot;execution(* com.chenss.dao.&lt;em&gt;.&lt;/em&gt;(..))&amp;quot;)//åŒ¹é…com.chenss.daoåŒ…ä¸‹çš„ä»»æ„æ¥å£å’Œç±»çš„ä»»æ„æ–¹æ³•ã€æ–¹æ³•è¿”å›å€¼ç±»å‹ä»»æ„ï¼Œæ–¹æ³•æ‰€åœ¨ç±»çš„å…¨è·¯å¾„åï¼šcom.chenss.daoï¼Œæ–¹æ³•åç±»å‹ä»»æ„ï¼Œæ–¹æ³•çš„å‚æ•°ç±»å‹ä»»æ„ã€‘&lt;br&gt;
@Pointcut(&amp;quot;execution(public * com.chenss.dao.&lt;em&gt;.&lt;/em&gt;(..))&amp;quot;)//åŒ¹é…com.chenss.daoåŒ…ä¸‹çš„ä»»æ„æ¥å£å’Œç±»çš„publicæ–¹æ³•&lt;br&gt;
@Pointcut(&amp;quot;execution(public * com.chenss.dao.&lt;em&gt;.&lt;/em&gt;())&amp;quot;)//åŒ¹é…com.chenss.daoåŒ…ä¸‹çš„ä»»æ„æ¥å£å’Œç±»çš„public æ— æ–¹æ³•å‚æ•°çš„æ–¹æ³•&lt;br&gt;
@Pointcut(&amp;quot;execution(* com.chenss.dao.&lt;em&gt;.&lt;/em&gt;(java.lang.String, ..))&amp;quot;)//åŒ¹é…com.chenss.daoåŒ…ä¸‹çš„ä»»æ„æ¥å£å’Œç±»çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºStringç±»å‹çš„æ–¹æ³•&lt;br&gt;
@Pointcut(&amp;quot;execution(* com.chenss.dao.&lt;em&gt;.&lt;/em&gt;(java.lang.String))&amp;quot;)//åŒ¹é…com.chenss.daoåŒ…ä¸‹çš„ä»»æ„æ¥å£å’Œç±»çš„åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œä¸”å‚æ•°ä¸ºStringç±»å‹çš„æ–¹æ³•&lt;br&gt;
@Pointcut(&amp;quot;execution(* com.chenss.dao.&lt;em&gt;.&lt;/em&gt;(java.lang.String))&amp;quot;)//åŒ¹é…com.chenss.daoåŒ…ä¸‹çš„ä»»æ„æ¥å£å’Œç±»çš„åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œä¸”å‚æ•°ä¸ºStringç±»å‹çš„æ–¹æ³•&lt;br&gt;
@Pointcut(&amp;quot;execution(public * &lt;em&gt;(..))&amp;quot;)//åŒ¹é…ä»»æ„çš„publicæ–¹æ³•&lt;br&gt;
@Pointcut(&amp;quot;execution(&lt;/em&gt; te*(..))&amp;quot;)//åŒ¹é…ä»»æ„çš„ä»¥teå¼€å¤´çš„æ–¹æ³•&lt;br&gt;
@Pointcut(&amp;quot;execution(* com.chenss.dao.IndexDao.&lt;em&gt;(..))&amp;quot;)//åŒ¹é…com.chenss.dao.IndexDaoæ¥å£ä¸­ä»»æ„çš„æ–¹æ³•&lt;br&gt;
@Pointcut(&amp;quot;execution(&lt;/em&gt; com.chenss.dao..&lt;em&gt;.&lt;/em&gt;(..))&amp;quot;)//åŒ¹é…com.chenss.daoåŒ…åŠå…¶å­åŒ…ä¸­ä»»æ„çš„æ–¹æ³•&lt;/p&gt;
&lt;p&gt;å…³äºè¿™ä¸ªè¡¨è¾¾å¼çš„è¯¦ç»†å†™æ³•,å¯ä»¥è„‘è¡¥ä¹Ÿå¯ä»¥å‚è€ƒå®˜ç½‘å¾ˆå®¹æ˜“çš„,å¯ä»¥ä½œä¸ºä¸€ä¸ªçœ‹springå®˜ç½‘æ–‡æ¡£çš„å…¥é—¨,æ‰“ç ´ä½ å®³æ€•çœ‹å®˜æ–¹æ–‡æ¡£çš„å¿ƒç†,å…¶å®ä½ ä¼šå‘è§‰å®˜æ–¹æ–‡æ¡£ä¹Ÿæ˜¯å¾ˆå®¹æ˜“çš„&lt;br&gt;
&lt;a href=&#34;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#aop-pointcuts-examples&#34;&gt;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#aop-pointcuts-examples&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç”±äºSpringåˆ‡é¢ç²’åº¦æœ€å°æ˜¯è¾¾åˆ°æ–¹æ³•çº§åˆ«ï¼Œè€Œexecutionè¡¨è¾¾å¼å¯ä»¥ç”¨äºæ˜ç¡®æŒ‡å®šæ–¹æ³•è¿”å›ç±»å‹ï¼Œç±»åï¼Œæ–¹æ³•åå’Œå‚æ•°åç­‰ä¸æ–¹æ³•ç›¸å…³çš„ä¿¡æ¯ï¼Œå¹¶ä¸”åœ¨Springä¸­ï¼Œå¤§éƒ¨åˆ†éœ€è¦ä½¿ç”¨AOPçš„ä¸šåŠ¡åœºæ™¯ä¹Ÿåªéœ€è¦è¾¾åˆ°æ–¹æ³•çº§åˆ«å³å¯ï¼Œå› è€Œexecutionè¡¨è¾¾å¼çš„ä½¿ç”¨æ˜¯æœ€ä¸ºå¹¿æ³›çš„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;within&#34;&gt;within&lt;/h2&gt;
&lt;p&gt;è¡¨è¾¾å¼çš„æœ€å°ç²’åº¦ä¸ºç±»&lt;br&gt;
withinä¸executionç›¸æ¯”ï¼Œç²’åº¦æ›´å¤§ï¼Œä»…èƒ½å®ç°åˆ°åŒ…å’Œæ¥å£ã€ç±»çº§åˆ«ã€‚è€Œexecutionå¯ä»¥ç²¾ç¡®åˆ°æ–¹æ³•çš„è¿”å›å€¼ï¼Œå‚æ•°ä¸ªæ•°ã€ä¿®é¥°ç¬¦ã€å‚æ•°ç±»å‹ç­‰&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Pointcut(&amp;quot;within(com.chenss.dao.*)&amp;quot;)//åŒ¹é…com.chenss.daoåŒ…ä¸­çš„ä»»æ„æ–¹æ³•
@Pointcut(&amp;quot;within(com.chenss.dao..*)&amp;quot;)//åŒ¹é…com.chenss.daoåŒ…åŠå…¶å­åŒ…ä¸­çš„ä»»æ„æ–¹æ³•
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;args&#34;&gt;args&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;args: Limits matching to join points (the execution of methods when using Spring AOP) where the arguments are instances of the given types.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é™åˆ¶è¿æ¥ç‚¹çš„åŒ¹é…(ä½¿ç”¨Spring AOPæ—¶æ–¹æ³•çš„æ‰§è¡Œ)ï¼Œå…¶ä¸­çš„å‚æ•°æ˜¯ç»™å®šç±»å‹çš„å®ä¾‹ã€‚&lt;br&gt;
argsè¡¨è¾¾å¼çš„ä½œç”¨æ˜¯åŒ¹é…æŒ‡å®šå‚æ•°ç±»å‹å’ŒæŒ‡å®šå‚æ•°æ•°é‡çš„æ–¹æ³•,ä¸åŒ…åå’Œç±»åæ— å…³&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
 * argsåŒexecutionä¸åŒçš„åœ°æ–¹åœ¨äºï¼š
 * argsåŒ¹é…çš„æ˜¯è¿è¡Œæ—¶ä¼ é€’ç»™æ–¹æ³•çš„å‚æ•°ç±»å‹
 * execution(* *(java.io.Serializable))åŒ¹é…çš„æ˜¯æ–¹æ³•åœ¨å£°æ˜æ—¶æŒ‡å®šçš„æ–¹æ³•å‚æ•°ç±»å‹ã€‚
 */
@Pointcut(&amp;quot;args(java.io.Serializable)&amp;quot;)//åŒ¹é…è¿è¡Œæ—¶ä¼ é€’çš„å‚æ•°ç±»å‹ä¸ºæŒ‡å®šç±»å‹çš„ã€ä¸”å‚æ•°ä¸ªæ•°å’Œé¡ºåºåŒ¹é…
@Pointcut(&amp;quot;@args(com.chenss.anno.Chenss)&amp;quot;)//æ¥å—ä¸€ä¸ªå‚æ•°ï¼Œå¹¶ä¸”ä¼ é€’çš„å‚æ•°çš„è¿è¡Œæ—¶ç±»å‹å…·æœ‰@Classified
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;this&#34;&gt;this&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;this: Limits matching to join points (the execution of methods when using Spring AOP) where the bean reference (Spring AOP proxy) is an instance of the given type.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é™åˆ¶è¿æ¥ç‚¹(ä½¿ç”¨Spring AOPæ—¶æ–¹æ³•çš„æ‰§è¡Œ)çš„åŒ¹é…ï¼Œå…¶ä¸­beanå¼•ç”¨(Spring AOPä»£ç†)æ˜¯ç»™å®šç±»å‹çš„å®ä¾‹ã€‚&lt;br&gt;
&lt;strong&gt;this JDKä»£ç†æ—¶ï¼ŒæŒ‡å‘æ¥å£å’Œä»£ç†ç±»proxyï¼Œcglibä»£ç†æ—¶ æŒ‡å‘æ¥å£å’Œå­ç±»(ä¸ä½¿ç”¨proxy)&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;target&#34;&gt;target&lt;/h2&gt;
&lt;p&gt;target: Limits matching to join points (the execution of methods when using Spring AOP) where the target object (application object being proxied) is an instance of the given type.&lt;br&gt;
é™åˆ¶å¯¹è¿æ¥ç‚¹(ä½¿ç”¨Spring AOPæ—¶æ–¹æ³•çš„æ‰§è¡Œ)çš„åŒ¹é…ï¼Œå…¶ä¸­ç›®æ ‡å¯¹è±¡(ä»£ç†çš„åº”ç”¨ç¨‹åºå¯¹è±¡)æ˜¯ç»™å®šç±»å‹çš„å®ä¾‹ã€‚&lt;br&gt;
&lt;strong&gt;target  æŒ‡å‘æ¥å£å’Œå­ç±»&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;/**
 * æ­¤å¤„éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœé…ç½®è®¾ç½®proxyTargetClass=falseï¼Œæˆ–é»˜è®¤ä¸ºfalseï¼Œåˆ™æ˜¯ç”¨JDKä»£ç†ï¼Œå¦åˆ™ä½¿ç”¨çš„æ˜¯CGLIBä»£ç†
 * JDKä»£ç†çš„å®ç°æ–¹å¼æ˜¯åŸºäºæ¥å£å®ç°ï¼Œä»£ç†ç±»ç»§æ‰¿Proxyï¼Œå®ç°æ¥å£ã€‚
 * è€ŒCGLIBç»§æ‰¿è¢«ä»£ç†çš„ç±»æ¥å®ç°ã€‚
 * æ‰€ä»¥ä½¿ç”¨targetä¼šä¿è¯ç›®æ ‡ä¸å˜ï¼Œå…³è”å¯¹è±¡ä¸ä¼šå—åˆ°è¿™ä¸ªè®¾ç½®çš„å½±å“ã€‚
 * ä½†æ˜¯ä½¿ç”¨thiså¯¹è±¡æ—¶ï¼Œä¼šæ ¹æ®è¯¥é€‰é¡¹çš„è®¾ç½®ï¼Œåˆ¤æ–­æ˜¯å¦èƒ½æ‰¾åˆ°å¯¹è±¡ã€‚
 */
@Pointcut(&amp;quot;target(com.chenss.dao.IndexDaoImpl)&amp;quot;)//ç›®æ ‡å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¢«ä»£ç†çš„å¯¹è±¡ã€‚é™åˆ¶ç›®æ ‡å¯¹è±¡ä¸ºcom.chenss.dao.IndexDaoImplç±»
@Pointcut(&amp;quot;this(com.chenss.dao.IndexDaoImpl)&amp;quot;)//å½“å‰å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ä»£ç†å¯¹è±¡ï¼Œä»£ç†å¯¹è±¡æ—¶é€šè¿‡ä»£ç†ç›®æ ‡å¯¹è±¡çš„æ–¹å¼è·å–æ–°çš„å¯¹è±¡ï¼Œä¸åŸå€¼å¹¶éä¸€ä¸ª
@Pointcut(&amp;quot;@target(com.chenss.anno.Chenss)&amp;quot;)//å…·æœ‰@Chenssçš„ç›®æ ‡å¯¹è±¡ä¸­çš„ä»»æ„æ–¹æ³•
@Pointcut(&amp;quot;@within(com.chenss.anno.Chenss)&amp;quot;)//ç­‰åŒäº@targ
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™ä¸ªæ¯”è¾ƒéš¾.......&lt;br&gt;
proxyæ¨¡å¼é‡Œé¢æœ‰ä¸¤ä¸ªé‡è¦çš„æœ¯è¯­&lt;br&gt;
proxy Class&lt;br&gt;
target Class&lt;br&gt;
CGLIBå’ŒJDKæœ‰åŒºåˆ«    JDKæ˜¯åŸºäºæ¥å£   cglibæ˜¯åŸºäºç»§æ‰¿ï¼Œæ‰€æœ‰thiså¯ä»¥åœ¨cglibä½œç”¨&lt;/p&gt;
&lt;h2 id=&#34;annotation&#34;&gt;@annotation&lt;/h2&gt;
&lt;p&gt;è¿™ä¸ªå¾ˆç®€å•........&lt;br&gt;
ä½œç”¨&lt;strong&gt;æ–¹æ³•&lt;/strong&gt;çº§åˆ«&lt;br&gt;
ä¸Šè¿°æ‰€æœ‰è¡¨è¾¾å¼éƒ½æœ‰@ æ¯”å¦‚@Target(é‡Œé¢æ˜¯ä¸€ä¸ªæ³¨è§£ç±»xx,è¡¨ç¤ºæ‰€æœ‰åŠ äº†xxæ³¨è§£çš„ç±»,å’ŒåŒ…åæ— å…³)&lt;br&gt;
æ³¨æ„:ä¸Šè¿°æ‰€æœ‰çš„è¡¨è¾¾å¼å¯ä»¥æ··åˆä½¿ç”¨,|| &amp;amp;&amp;amp; !&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Before(&amp;quot;pointCutWithin()&amp;amp;&amp;amp;!pointCutArgs()&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Pointcut(&amp;quot;@annotation(com.chenss.anno.Chenss)&amp;quot;)//åŒ¹é…å¸¦æœ‰com.chenss.anno.Chenssæ³¨è§£çš„æ–¹æ³•
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚ä¸‹é¢è¿™ä¸ªæ–¹æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Chenss
public void query(String str){
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;bean&#34;&gt;bean&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Pointcut(&amp;quot;bean(dao1)&amp;quot;)//åç§°ä¸ºdao1çš„beanä¸Šçš„ä»»æ„æ–¹æ³•
@Pointcut(&amp;quot;bean(dao*)&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;aop-proxies&#34;&gt;AOP Proxies&lt;/h1&gt;
&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;a href=&#34;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#aop-introduction-proxies&#34;&gt;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#aop-introduction-proxies&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Spring AOP defaults to using standard JDK dynamic proxies for AOP proxies. This enables any interface (or set of interfaces) to be proxied.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Spring AOP é»˜è®¤ä½¿ç”¨æ ‡å‡† JDK åŠ¨æ€ä»£ç†æ¥å®Œæˆ AOP ä»£ç†ã€‚è¿™å…è®¸ä»£ç†ä»»ä½•æ¥å£(æˆ–ä¸€ç»„æ¥å£)ã€‚&lt;/p&gt;
&lt;h2 id=&#34;é—®é¢˜å¼•å…¥&#34;&gt;é—®é¢˜å¼•å…¥&lt;/h2&gt;
&lt;p&gt;1ã€å®šä¹‰ä¸€ä¸ªæ¥å£&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public interface IndexDao {
    void query(String str);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€è‡ªå®šä¹‰ä¸€ä¸ªæ³¨è§£&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Retention(RetentionPolicy.RUNTIME)
public @interface Luban {
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3ã€å®šä¹‰åˆ‡é¢ï¼Œ@annotation è¿æ¥ç‚¹&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Component
// åˆ‡é¢
@Aspect
public class NotVeryUsefulAspect {
    @Pointcut(&amp;quot;@annotation(com.ssm.anno.Luban)&amp;quot;)
    public void pointCutAnno(){
    }
    /**
     * é€šçŸ¥
     *  é€šçŸ¥ä½ç½®ï¼špointCut() çš„å‰é¢
     *  é€šçŸ¥å†…å®¹
     */
    @Before(&amp;quot;pointCutAnno()&amp;quot;)
    public void before(){
        System.out.println(&amp;quot;before&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;4ã€æ¥å£å®ç°ç±»ï¼Œä½¿ç”¨æ³¨è§£å¢å¼º query æ–¹æ³•&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Repository(&amp;quot;indexDao&amp;quot;)
public class IndexDaoImpl implements IndexDao {
    @Override
    @Luban
    public void query(String str){
        System.out.println(&amp;quot;query&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;5ã€é…ç½®æ–‡ä»¶ç±»&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Configuration
@ComponentScan(&amp;quot;com.ssm&amp;quot;)
// å¼€å¯ AspectJ è¯­æ³•æ”¯æŒ
@EnableAspectJAutoProxy
public class AppConfig {
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;6ã€æµ‹è¯•ç±»&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) {
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(AppConfig.class);
        IndexDao dao = (IndexDao) context.getBean(&amp;quot;indexDao&amp;quot;);
        System.out.println(dao instanceof IndexDaoImpl);
        dao.query(&amp;quot;111&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;7ã€è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;false
before
query
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;8ã€åˆ†æï¼šä¸ºä»€ä¹ˆæˆ‘ä»¬å°†ä¸€ä¸ª IndexDaoImpl æ”¾å…¥ Spring å®¹å™¨ï¼ˆ@Repositoryï¼‰ï¼Œç„¶åå†ä» Spring å®¹å™¨å†…å–å‡ºæ¥ï¼ˆcontext.getBean(&amp;quot;indexDao&amp;quot;)ï¼‰ç±»å‹å´ä¸æ˜¯ IndexDaoImpl äº†å‘¢ï¼Ÿ&lt;br&gt;
9ã€åœ¨é…ç½®ç±»ä¸­åŠ ä¸Šï¼š@EnableAspectJAutoProxy(proxyTargetClass = true) åï¼Œè®¾ç½®ä»£ç†æ–¹å¼ä¸º cglib ä»£ç†ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Configuration
@ComponentScan(&amp;quot;com.ssm&amp;quot;)
// å¼€å¯ AspectJ è¯­æ³•æ”¯æŒ
@EnableAspectJAutoProxy(proxyTargetClass = true)
public class AppConfig {
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;System.out.println(dao instanceof IndexDaoImpl); è¿”å› true äº†ã€‚&lt;br&gt;
æ³¨ï¼šproxyTargetClass é»˜è®¤æ˜¯ falseï¼Œæ‰€ä»¥ dao instanceof IndexDaoImpl è¿”å› falseã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;boolean proxyTargetClass() default false;
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;spring-aop-é»˜è®¤ä½¿ç”¨æ ‡å‡†-jdk-åŠ¨æ€ä»£ç†æ¥å®Œæˆ-aop-ä»£ç†&#34;&gt;Spring AOP é»˜è®¤ä½¿ç”¨æ ‡å‡† JDK åŠ¨æ€ä»£ç†æ¥å®Œæˆ AOP ä»£ç†&lt;/h2&gt;
&lt;p&gt;å½“æˆ‘ä»¬ä½¿ç”¨ JDK åŠ¨æ€ä»£ç†æ—¶ï¼Œå³ @EnableAspectJAutoProxy(proxyTargetClass = false)ï¼Œä» Spring å®¹å™¨ä¸­å–å‡ºæ¥çš„å¯¹è±¡ä¸æ”¾è¿›å»çš„å¯¹è±¡ä¸ä¸€è‡´ï¼šcontext.getBean(&amp;quot;indexDao&amp;quot;) instanceof IndexDaoImpl è¿”å› falseã€‚&lt;br&gt;
ä½†æ˜¯ context.getBean(&amp;quot;indexDao&amp;quot;) instanceof indexDao è¿”å› trueï¼Œå› ä¸º JDK åŠ¨æ€ä»£ç†åº•å±‚ç”¨çš„æ˜¯æ¥å£ã€‚&lt;br&gt;
context.getBean(&amp;quot;indexDao&amp;quot;) instanceof Proxy ä¹Ÿè¿”å› trueã€‚&lt;br&gt;
å®ç°ä»£ç†çš„åŠæ³•&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç»§æ‰¿&lt;/li&gt;
&lt;li&gt;èšåˆæ¥å£ï¼ˆJDK åŠ¨æ€ä»£ç†åŸºäºèšåˆï¼‰&lt;/li&gt;
&lt;li&gt;åŠ¨æ€ä»£ç†&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;jdk-åŠ¨æ€ä»£ç†ä¸ºä»€ä¹ˆåªèƒ½æ˜¯åŸºäºæ¥å£ä¸èƒ½ç”¨ç»§æ‰¿&#34;&gt;JDK åŠ¨æ€ä»£ç†ä¸ºä»€ä¹ˆåªèƒ½æ˜¯åŸºäºæ¥å£ï¼Œä¸èƒ½ç”¨ç»§æ‰¿ï¼Ÿ&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) throws IOException {
        Class&amp;lt;?&amp;gt;[] interfaces = new Class[]{IndexDao.class};
        byte[] bytes = ProxyGenerator.generateProxyClass(&amp;quot;SSM&amp;quot;,interfaces);
        File file = new File(&amp;quot;C:\\Users\\Only\\Test.class&amp;quot;);
        FileOutputStream fw = new FileOutputStream(file);
        fw.write(bytes);
        fw.flush();
        fw.close();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ³¨æ„ï¼šProxyGenerator çš„ä½¿ç”¨æ˜¯åŸºäº JDK8 çš„ï¼Œå¦‚æœä½¿ç”¨ JDK10 ä¼šæŠ¥ â€œæ‰¾ä¸åˆ°ç¬¦å·â€ é”™è¯¯ï¼Œå‚è€ƒï¼š&lt;a href=&#34;https://blog.csdn.net/weixin_46034990/article/details/105892718&#34;&gt;https://blog.csdn.net/weixin_46034990/article/details/105892718&lt;/a&gt;&lt;br&gt;
JDK åº•å±‚æºç å·²ç»å¸®è¿™ä¸ªå¯¹è±¡è‡ªåŠ¨ç»§æ‰¿äº†ä¸€ä¸ª Proxy å¯¹è±¡äº†ï¼Œç”±äº Java æ˜¯å•ç»§æ‰¿ï¼Œæ‰€ä»¥ä¸å¯èƒ½å†å»ç»§æ‰¿ç›®æ ‡å¯¹è±¡ï¼Œæ‰€ä»¥åªèƒ½å®ç°ç›®æ ‡å¯¹è±¡çš„æ¥å£ã€‚&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/JDK%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
åŸºäºä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸ªä»£ç†å¯¹è±¡ç­‰äº IndexDaoã€ä¹Ÿç­‰äº Proxyï¼Œä½†æ˜¯ä¸ç­‰äº IndexDaoImplï¼Œè¿™ä¹Ÿå°±è§£é‡Šäº†ä¸Šè¿° ã€context.getBean(&amp;quot;indexDao&amp;quot;) instanceof IndexDaoImpl è¿”å› falseã€‚context.getBean(&amp;quot;indexDao&amp;quot;) instanceof indexDao è¿”å› trueã€context.getBean(&amp;quot;indexDao&amp;quot;) instanceof Proxy ä¹Ÿè¿”å› trueã€‚ã€‘çš„åŸå› ã€‚&lt;/p&gt;
&lt;h2 id=&#34;this-åˆ‡ç‚¹&#34;&gt;this åˆ‡ç‚¹&lt;/h2&gt;
&lt;p&gt;this è¡¨ç¤º&lt;strong&gt;ä»£ç†å¯¹è±¡&lt;/strong&gt;çš„åŒ¹é…ç±»å‹&lt;br&gt;
å‰æï¼šä½¿ç”¨ JDK åŠ¨æ€ä»£ç†ï¼Œå³ @EnableAspectJAutoProxy(proxyTargetClass = false)&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Component
// åˆ‡é¢
@Aspect
public class NotVeryUsefulAspect {
    // this è¡¨ç¤ºä»£ç†å¯¹è±¡çš„åŒ¹é…ç±»å‹ï¼Œä½¿ç”¨ JDK åŠ¨æ€ä»£ç†åï¼Œä»£ç†å¯¹è±¡çš„ç±»å‹æ˜¯ï¼šProxyã€IndexDaoï¼Œä½†ä¸æ˜¯ IndexDaoImpl
    @Pointcut(&amp;quot;this(com.ssm.dao.IndexDao)&amp;quot;)
    public void pointCutThis(){
        System.out.println(&amp;quot;point cut&amp;quot;);
    }
    /**
     * é€šçŸ¥
     *  é€šçŸ¥ä½ç½®ï¼špointCut() çš„å‰é¢
     *  é€šçŸ¥å†…å®¹
     */
    @Before(&amp;quot;pointCutThis()&amp;quot;)
    public void before(){
        System.out.println(&amp;quot;before&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¢å¼ºæˆåŠŸï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;before
query
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// this è¡¨ç¤ºä»£ç†å¯¹è±¡çš„åŒ¹é…ç±»å‹ï¼Œä½¿ç”¨ JDK åŠ¨æ€ä»£ç†åï¼Œä»£ç†å¯¹è±¡çš„ç±»å‹æ˜¯ï¼šProxyã€IndexDaoï¼Œä½†ä¸æ˜¯ IndexDaoImpl
@Pointcut(&amp;quot;this(com.ssm.dao.impl.IndexDaoImpl)&amp;quot;)
public void pointCutThis(){
    System.out.println(&amp;quot;point cut&amp;quot;);
}

@Before(&amp;quot;pointCutThis()&amp;quot;)
public void before(){
    System.out.println(&amp;quot;before&amp;quot;);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¢å¼ºå¤±è´¥ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;query
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;spring-aop-xmlå®ç°æ–¹å¼çš„æ³¨æ„äº‹é¡¹&#34;&gt;Spring AOP XMLå®ç°æ–¹å¼çš„æ³¨æ„äº‹é¡¹:&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨aop:configä¸­å®šä¹‰åˆ‡é¢é€»è¾‘ï¼Œå…è®¸é‡å¤å‡ºç°ï¼Œé‡å¤å¤šæ¬¡ï¼Œä»¥æœ€åå‡ºç°çš„é€»è¾‘ä¸ºå‡†ï¼Œä½†æ˜¯æ¬¡æ•°ä»¥å‡ºç°çš„æ¬¡æ•°ä¸ºå‡†&lt;/li&gt;
&lt;li&gt;aop:aspect IDé‡å¤ä¸å½±å“æ­£å¸¸è¿è¡Œï¼Œä¾ç„¶èƒ½å¤Ÿæœ‰æ­£ç¡®ç»“æœ&lt;/li&gt;
&lt;li&gt;aop:pointcut IDé‡å¤ä¼šå‡ºç°è¦†ç›–ï¼Œä»¥æœ€åå‡ºç°çš„ä¸ºå‡†ã€‚ä¸åŒaop:aspectå†…å‡ºç°çš„pointcuté…ç½®ï¼Œå¯ä»¥ç›¸äº’å¼•ç”¨&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;beans xmlns=&amp;quot;http://www.springframework.org/schema/beans&amp;quot;
       xmlns:xsi=&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;
       xmlns:aop=&amp;quot;http://www.springframework.org/schema/aop&amp;quot;
       xmlns:context=&amp;quot;http://www.springframework.org/schema/context&amp;quot;
       xsi:schemaLocation=&amp;quot;http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans.xsd
                           http://www.springframework.org/schema/aop
                           http://www.springframework.org/schema/aop/spring-aop.xsd
                           http://www.springframework.org/schema/context
                           http://www.springframework.org/schema/context/spring-context.xsd&amp;quot;&amp;gt;
    &amp;lt;!-- å®šä¹‰å¼€å§‹è¿›è¡Œæ³¨è§£æ‰«æ --&amp;gt;
    &amp;lt;context:component-scan base-package=&amp;quot;com.chenss&amp;quot;&amp;gt;&amp;lt;/context:component-scan&amp;gt;

    &amp;lt;!-- å®šä¹‰AspectJå¯¹è±¡ä½¿ç”¨çš„é€»è¾‘ç±»ï¼Œç±»ä¸­æä¾›åˆ‡é¢ä¹‹åæ‰§è¡Œçš„é€»è¾‘æ–¹æ³• --&amp;gt;
    &amp;lt;bean id=&amp;quot;aspectAop&amp;quot; class=&amp;quot;com.chenss.aspectj.Aspect&amp;quot;&amp;gt;&amp;lt;/bean&amp;gt;
    &amp;lt;bean id=&amp;quot;aspectAop2&amp;quot; class=&amp;quot;com.chenss.aspectj.Aspect2&amp;quot;&amp;gt;&amp;lt;/bean&amp;gt;

    &amp;lt;bean id=&amp;quot;indexDao&amp;quot; class=&amp;quot;com.chenss.entity.IndexDao&amp;quot;&amp;gt;&amp;lt;/bean&amp;gt;

    &amp;lt;!--åœ¨Configä¸­å®šä¹‰åˆ‡é¢é€»è¾‘ï¼Œå…è®¸é‡å¤å‡ºç°ï¼Œé‡å¤å¤šæ¬¡ï¼Œä»¥æœ€åå‡ºç°çš„é€»è¾‘ä¸ºå‡†ï¼Œä½†æ˜¯æ¬¡æ•°ä»¥å‡ºç°çš„æ¬¡æ•°ä¸ºå‡†--&amp;gt;
    &amp;lt;aop:config&amp;gt;
        &amp;lt;!-- aop:aspect IDé‡å¤ä¸å½±å“æ­£å¸¸è¿è¡Œï¼Œä¾ç„¶èƒ½å¤Ÿæœ‰æ­£ç¡®ç»“æœ --&amp;gt;
        &amp;lt;!-- aop:pointcut IDé‡å¤ä¼šå‡ºç°è¦†ç›–ï¼Œä»¥æœ€åå‡ºç°çš„ä¸ºå‡†ã€‚ä¸åŒaop:aspectå†…å‡ºç°çš„pointcuté…ç½®ï¼Œå¯ä»¥ç›¸äº’å¼•ç”¨ --&amp;gt;
        &amp;lt;aop:aspect id=&amp;quot;aspect&amp;quot; ref=&amp;quot;aspectAop&amp;quot;&amp;gt;
            &amp;lt;aop:pointcut id=&amp;quot;aspectCut&amp;quot; expression=&amp;quot;execution(* com.chenss.entity.*.*())&amp;quot;/&amp;gt;
            &amp;lt;aop:before method=&amp;quot;before&amp;quot; pointcut-ref=&amp;quot;aspectCut&amp;quot;&amp;gt;&amp;lt;/aop:before&amp;gt;
      
            &amp;lt;aop:pointcut id=&amp;quot;aspectNameCut&amp;quot; expression=&amp;quot;execution(* com.chenss.entity.*.*(java.lang.String, ..))&amp;quot;/&amp;gt;
            &amp;lt;aop:before method=&amp;quot;before2&amp;quot; pointcut-ref=&amp;quot;aspectNameCut&amp;quot;&amp;gt;&amp;lt;/aop:before&amp;gt;
        &amp;lt;/aop:aspect&amp;gt;
    &amp;lt;/aop:config&amp;gt;
&amp;lt;/beans&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
">Springç³»åˆ—ï¼ˆäºŒï¼‰SpringAOP åº”ç”¨</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/spring-ioc/"" data-c="
          &lt;h1 id=&#34;what-is-ioc&#34;&gt;what is IOC&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;æ§åˆ¶åè½¬&lt;/strong&gt;ï¼ˆInversion of Controlï¼Œç¼©å†™ä¸º&lt;strong&gt;IOC&lt;/strong&gt;ï¼‰ï¼Œæ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­çš„ä¸€ç§&lt;strong&gt;è®¾è®¡åŸåˆ™&lt;/strong&gt;ï¼Œå¯ä»¥ç”¨æ¥å‡ä½è®¡ç®—æœºä»£ç ä¹‹é—´çš„è€¦åˆåº¦ã€‚å…¶ä¸­æœ€å¸¸è§çš„æ–¹å¼å«åšä¾èµ–æ³¨å…¥ï¼ˆDependency Injectionï¼Œç®€ç§°&lt;strong&gt;DI&lt;/strong&gt;ï¼‰ï¼Œè¿˜æœ‰ä¸€ç§æ–¹å¼å«â€œä¾èµ–æŸ¥æ‰¾â€ï¼ˆDependency Lookupï¼‰&lt;/p&gt;
&lt;h2 id=&#34;ioc-å’Œ-di-çš„å…³ç³»&#34;&gt;IOC å’Œ DI çš„å…³ç³»&lt;/h2&gt;
&lt;p&gt;IOC æ˜¯ä¸€ç§&lt;strong&gt;ç›®æ ‡&lt;/strong&gt;ï¼ŒDI æ˜¯å®ç° IOC çš„&lt;strong&gt;æŠ€æœ¯æ‰‹æ®µ&lt;/strong&gt;ã€‚IOC ä¸ DI çš„å…³ç³»å¥½ä¼¼ ORMï¼ˆå¯¹è±¡å…³ç³»æ˜ å°„ï¼‰ å’Œ Mybatis çš„å…³ç³»ä¸€æ ·ã€‚&lt;/p&gt;
&lt;h2 id=&#34;dependency-injection&#34;&gt;Dependency Injection&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ä¾èµ–æ³¨å…¥&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;å…³äºä»€ä¹ˆæ˜¯ä¾èµ–&#34;&gt;å…³äºä»€ä¹ˆæ˜¯ä¾èµ–&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// IndexService ä¾èµ–äº† IndexDao å¯¹è±¡
public class IndexServiceImpl implements IndexService{
  private IndexDao indexDao;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;å½“ä¸€ä¸ªç±»ä¸­æ‹¥æœ‰ä¸€ä¸ªç±»çš„å±æ€§ï¼Œæˆ–è€…æ„é€ æ–¹æ³•ä¸­ä¼ äº†ä¸€ä¸ªå€¼ï¼Œå°±å¯ä»¥è¯´ï¼šå½“å‰è¿™ä¸ªç±»ä¾èµ–äºè¿™ä¸ªå±æ€§ï¼Œæˆ–è€…ä¾èµ–äºæ„é€ æ–¹æ³•é‡Œä¼ å…¥çš„å¯¹è±¡&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;Student ç±»ä¸­æœ‰ä¸€ä¸ª Address ç±»çš„å±æ€§ï¼ŒStudent ç±»ä¾èµ–äº Address å±æ€§ã€‚&lt;/p&gt;
&lt;p&gt;Student ç±»çš„æ„é€ æ–¹æ³•çš„å‚æ•°ä¸­æœ‰ä¸€ä¸ª Address ç±»ï¼ŒStudent ç±»ä¾èµ–äºæ„é€ æ–¹æ³•é‡Œä¼ å…¥çš„ Address å¯¹è±¡ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Student{
  private String name;
  private Integer age;
  private Address address;
  publci Student(String name,Integer age,Address address){
    this.name = name;
    this.age = age;
    this.address = address;
  }
}

public class Address{
  private String province;
  private String city;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;ä¸ºä»€ä¹ˆè¦ä½¿ç”¨-spring-ioc&#34;&gt;ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ Spring IOC&lt;/h1&gt;
&lt;h2 id=&#34;é¢å‘æŠ½è±¡ç¼–ç¨‹&#34;&gt;é¢å‘æŠ½è±¡ç¼–ç¨‹&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class IndexServiceImpl implements IndexService{
  public void test(){
     // è¿™æ ·çš„å†™æ³•ä¼šé€ æˆé«˜è€¦åˆ
     IndexDao indexDao = new IndexDaoImpl();
  }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å‡è®¾æœ‰ä¸€å¤©è¦å¯¹è¿™ä¸ª IndexDao è¿›è¡Œä¸€ä¸ªä»£ç†ï¼Œå°±ä¸èƒ½é€šè¿‡ new äº†ï¼Œè€Œæ˜¯é€šè¿‡ Proxy.newXXX(); å°±éœ€è¦&lt;strong&gt;æ›´æ”¹ä»£ç &lt;/strong&gt;ä¸ºï¼šIndexDao indexDao = Proxy.newXXX(); &lt;strong&gt;ä¸€ä¸ªç±»çš„äº§ç”Ÿä¸åº”è¯¥ç”±ç¨‹åºå‘˜è‡ªå·± new å‡ºæ¥&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é¢å‘æŠ½è±¡ç¼–ç¨‹æ­£ç¡®å†™æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class IndexServiceImpl implements IndexService{
  private IndexDao indexDao;
    public void test(){
     indexDao.call();
  }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ— è®º IndexDao æ˜¯ä»£ç†è¿˜æ˜¯æœ¬èº«å®ç°ï¼Œå®ƒéƒ½å«åš IndexDaoï¼Œå¦‚æœæœ‰ä¸€å¤©éœ€è¦ä¸€ä¸ªä»£ç†ç±»çš„è¯ï¼Œåªéœ€è¦äº§ç”Ÿä¸€ä¸ªä»£ç†ç±»ï¼Œå¹¶ä¸”æŠŠè¿™ä¸ªä»£ç†ç±»çš„ä»£ç†å¯¹è±¡&lt;strong&gt;ä¼ é€’è¿‡æ¥å°±å¯ä»¥äº†&lt;/strong&gt;ã€‚å¦‚æœæœ‰ä¸€å¤©ä¸éœ€è¦è¿™ä¸ªä»£ç†å¯¹è±¡äº†ï¼Œåªéœ€è¦æŠŠè¿™ä¸ªå¯¹è±¡ new å‡ºæ¥ä¼ è¿‡æ¥å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¦‚ä½•ä¼ é€’è¿‡æ¥å‘¢&#34;&gt;å¦‚ä½•ä¼ é€’è¿‡æ¥å‘¢ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;æä¾›ä¸€ä¸ª &lt;strong&gt;setter&lt;/strong&gt; æˆ–&lt;strong&gt;æ„é€ æ–¹æ³•&lt;/strong&gt;æŠŠè¿™ä¸ªç±»ä¼ é€’è¿‡æ¥ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class IndexServiceImpl implements IndexService{
  // 1.setter æ–¹æ³•
  // 2.æ„é€ æ–¹æ³•ï¼Œåˆ«äººåœ¨ new è¿™ä¸ªServiceImpl æ—¶å°±éœ€è¦æŠŠå…·ä½“çš„å®ç°ä¼ è¿›æ¥
    public IndexServiceImpl(IndexDao dao){
  }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;springä½“ç³»ç»“æ„-iocçš„ä½ç½®&#34;&gt;springä½“ç³»ç»“æ„----IOCçš„ä½ç½®&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&#34;https://spring.io/projects&#34;&gt;https://spring.io/projects&lt;/a&gt;&lt;br&gt;
Spring Framework&lt;br&gt;
Provides core support for dependency injection, transaction management, web apps, data access, messaging and more.&lt;br&gt;
æä¾›äº† DIã€äº‹åŠ¡ç®¡ç†ã€web å¼€å‘å’Œæ›´å¤šçš„æ ¸å¿ƒæ”¯æŒ&lt;br&gt;
&lt;a href=&#34;https://spring.io/projects/spring-framework&#34;&gt;https://spring.io/projects/spring-framework&lt;/a&gt;&lt;br&gt;
Featuresï¼ˆç‰¹ç‚¹ï¼‰&lt;br&gt;
Core technologiesï¼ˆæ ¸å¿ƒæŠ€æœ¯ï¼‰: dependency injectionï¼ˆDIï¼‰, events, resources, i18n, validation, data binding, type conversion, SpEL, AOP.&lt;br&gt;
Testing: mock objects, TestContext framework, Spring MVC Test, WebTestClient.&lt;br&gt;
Data Access: transactions, DAO support, JDBC, ORM, Marshalling XML.&lt;br&gt;
Spring MVC and Spring WebFlux web frameworks.&lt;br&gt;
Integration: remoting, JMS, JCA, JMX, email, tasks, scheduling, cache.&lt;br&gt;
Languages: Kotlin, Groovy, dynamic languages.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;å®¹å™¨&#34;&gt;å®¹å™¨&lt;/h2&gt;
&lt;p&gt;åœ¨æ—¥å¸¸ç¨‹åºå¼€å‘è¿‡ç¨‹å½“ä¸­ï¼Œæˆ‘ä»¬æ¨è&lt;strong&gt;é¢å‘æŠ½è±¡&lt;/strong&gt;ç¼–ç¨‹ï¼Œé¢å‘æŠ½è±¡ç¼–ç¨‹ä¼šäº§ç”Ÿ&lt;strong&gt;ç±»çš„ä¾èµ–&lt;/strong&gt;ï¼Œå½“ç„¶å¦‚æœä½ å¤Ÿå¼ºå¤§å¯ä»¥è‡ªå·±å†™ä¸€ä¸ª&lt;strong&gt;ç®¡ç†çš„å®¹å™¨&lt;/strong&gt;ï¼Œä½†æ˜¯æ—¢ç„¶springä»¥åŠå®ç°äº†ï¼Œå¹¶ä¸”springå¦‚æ­¤ä¼˜ç§€ï¼Œæˆ‘ä»¬ä»…ä»…éœ€è¦å­¦ä¹ springæ¡†æ¶ä¾¿å¯ã€‚&lt;/p&gt;
&lt;p&gt;å½“æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªç®¡ç†å¯¹è±¡çš„å®¹å™¨ä¹‹åï¼Œ&lt;strong&gt;ç±»çš„äº§ç”Ÿè¿‡ç¨‹äº¤ç»™äº†å®¹å™¨&lt;/strong&gt;ï¼Œè‡³äºæˆ‘ä»¬è‡ªå·±çš„appåˆ™å¯ä»¥ä¸éœ€è¦å»å…³ç³»è¿™äº›å¯¹è±¡çš„äº§ç”Ÿäº†ã€‚&lt;/p&gt;
&lt;h1 id=&#34;spring-å®ç°-ioc-çš„æ€è·¯å’Œæ–¹æ³•&#34;&gt;Spring å®ç° IOC çš„æ€è·¯å’Œæ–¹æ³•&lt;/h1&gt;
&lt;p&gt;Spring å®ç° IOC çš„æ€è·¯æ˜¯&lt;strong&gt;æä¾›ä¸€äº›é…ç½®ä¿¡æ¯ç”¨æ¥æè¿°ç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œç„¶åç”±å®¹å™¨å»è§£æè¿™äº›é…ç½®ä¿¡æ¯ï¼Œç»§è€Œç»´æŠ¤å¥½å¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»&lt;/strong&gt;ï¼Œå‰ææ˜¯å¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»å¿…é¡»åœ¨ç±»ä¸­å®šä¹‰å¥½ï¼Œæ¯”å¦‚ A.class ä¸­æœ‰ä¸€ä¸ª B.class çš„å±æ€§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç†è§£ä¸º A ä¾èµ–äº† Bã€‚æ—¢ç„¶æˆ‘ä»¬åœ¨ç±»ä¸­å·²ç»å®šä¹‰äº†ä»–ä»¬ä¹‹é—´çš„ä¾èµ–å…³ç³»é‚£ä¹ˆä¸ºä»€ä¹ˆè¿˜éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­å»æè¿°å’Œå®šä¹‰å‘¢ï¼Ÿ&lt;/p&gt;
&lt;h2 id=&#34;spring-å®ç°-ioc-çš„æ€è·¯å¤§è‡´å¯ä»¥æ‹†åˆ†æˆ-3-ç‚¹&#34;&gt;Spring å®ç° IOC çš„æ€è·¯å¤§è‡´å¯ä»¥æ‹†åˆ†æˆ 3 ç‚¹&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;åº”ç”¨ç¨‹åºä¸­æä¾›ç±»ï¼Œæä¾›ä¾èµ–å…³ç³»ï¼ˆå±æ€§æˆ–è€…æ„é€ æ–¹æ³•ï¼‰&lt;/li&gt;
&lt;li&gt;æŠŠéœ€è¦äº¤ç»™å®¹å™¨ç®¡ç†çš„&lt;strong&gt;å¯¹è±¡&lt;/strong&gt;é€šè¿‡é…ç½®ä¿¡æ¯å‘Šè¯‰å®¹å™¨ï¼ˆxmlã€Annotationï¼ŒJavaConfigï¼‰&lt;/li&gt;
&lt;li&gt;æŠŠå„ä¸ªç±»ä¹‹é—´çš„&lt;strong&gt;ä¾èµ–å…³ç³»&lt;/strong&gt;é€šè¿‡é…ç½®ä¿¡æ¯å‘Šè¯‰å®¹å™¨&lt;/li&gt;
&lt;/ol&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/springIOC.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;1ã€å®šä¹‰ä¸€ä¸ªç±» Aï¼ŒæŠŠç±» A å’Œ ç±» B çš„å…³ç³»é€šè¿‡åº”ç”¨ç¨‹åºæè¿°å‡ºæ¥ï¼šç±» A ä¸­æœ‰ä¸€ä¸ªç±» B çš„å±æ€§&lt;br&gt;
2ã€å°†ç±» Aã€ç±» B äº¤ç»™ Spring å®¹å™¨è¿›è¡Œç®¡ç†ï¼šä½¿ç”¨ &lt;bean&gt;&lt;br&gt;
3ã€åœ¨ xml å®šä¹‰ä¸­æè¿°ç±» Aã€ç±» B ä¹‹é—´çš„ä¾èµ–å…³ç³»&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;æ—¢ç„¶æˆ‘ä»¬åœ¨ç±»ä¸­å·²ç»å®šä¹‰äº†ä»–ä»¬ä¹‹é—´çš„ä¾èµ–å…³ç³»é‚£ä¹ˆä¸ºä»€ä¹ˆè¿˜éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­å»æè¿°å’Œå®šä¹‰å‘¢&#34;&gt;æ—¢ç„¶æˆ‘ä»¬åœ¨ç±»ä¸­å·²ç»å®šä¹‰äº†ä»–ä»¬ä¹‹é—´çš„ä¾èµ–å…³ç³»é‚£ä¹ˆä¸ºä»€ä¹ˆè¿˜éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­å»æè¿°å’Œå®šä¹‰å‘¢ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;ç±»ä¸­å®šä¹‰äº†ä½†æ˜¯ Spring æ„ŸçŸ¥ä¸åˆ°ä½ æ˜¯å¦éœ€è¦ä¾èµ–æ³¨å…¥&lt;/p&gt;
&lt;p&gt;é…ç½®è¿™äº›ä¿¡æ¯çš„æ–¹æ³•æœ‰ä¸‰ç§åˆ†åˆ«æ˜¯ xmlï¼ŒAnnotation å’Œ JavaConfig&lt;/p&gt;
&lt;p&gt;ç»´æŠ¤çš„è¿‡ç¨‹ç§°ä¸º&lt;strong&gt;è‡ªåŠ¨æ³¨å…¥&lt;/strong&gt;ï¼Œè‡ªåŠ¨æ³¨å…¥çš„æ–¹æ³•æœ‰ä¸¤ç§ï¼š&lt;strong&gt;æ„é€ æ–¹æ³•&lt;/strong&gt; å’Œ &lt;strong&gt;setter&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è‡ªåŠ¨æ³¨å…¥çš„å€¼å¯ä»¥æ˜¯å¯¹è±¡ï¼Œæ•°ç»„ï¼Œmapï¼Œlistå’Œå¸¸é‡æ¯”å¦‚å­—ç¬¦ä¸²æ•´å½¢ç­‰&lt;/p&gt;
&lt;h1 id=&#34;springç¼–ç¨‹çš„é£æ ¼&#34;&gt;springç¼–ç¨‹çš„é£æ ¼&lt;/h1&gt;
&lt;h2 id=&#34;schemal-based-xml&#34;&gt;schemal-based-------xml&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#aop-schema-declaring-an-aspect&#34;&gt;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#aop-schema-declaring-an-aspect&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;aop:config&amp;gt;
    &amp;lt;aop:aspect id=&amp;quot;myAspect&amp;quot; ref=&amp;quot;aBean&amp;quot;&amp;gt;
        ...
    &amp;lt;/aop:aspect&amp;gt;
&amp;lt;/aop:config&amp;gt;

&amp;lt;bean id=&amp;quot;aBean&amp;quot; class=&amp;quot;...&amp;quot;&amp;gt;
    ...
&amp;lt;/bean&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;annotation-based-annotation&#34;&gt;annotation-based-----annotation&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#aop-advice-before&#34;&gt;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#aop-advice-before&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Before;

@Aspect
public class BeforeExample {

    @Before(&amp;quot;com.xyz.myapp.SystemArchitecture.dataAccessOperation()&amp;quot;)
    public void doAccessCheck() {
        // ...
    }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-required-annotation&#34;&gt;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-required-annotation&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class SimpleMovieLister {

    private MovieFinder movieFinder;

    @Required
    public void setMovieFinder(MovieFinder movieFinder) {
        this.movieFinder = movieFinder;
    }

    // ...
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;java-based-java-configuration&#34;&gt;java-based----java Configuration&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-java-basic-concepts&#34;&gt;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-java-basic-concepts&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Configuration
public class AppConfig {

    @Bean
    public MyService myService() {
        return new MyServiceImpl();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;æ³¨å…¥&#34;&gt;æ³¨å…¥&lt;/h1&gt;
&lt;p&gt;æƒ³çœ‹ä¸€éƒ¨ç”µå½±ï¼Œå¯ä»¥æœ‰å¦‚ä¸‹ä¸¤ç§æ–¹æ³•ï¼š&lt;/p&gt;
&lt;p&gt;â‘  è¾“å…¥ url åˆ°è¿…é›·ï¼Œç„¶åä¸‹è½½ä¸‹æ¥ï¼š&lt;strong&gt;ä¾èµ–æŸ¥æ‰¾&lt;/strong&gt;ï¼šè¾“å…¥ä¸€ä¸ª url æ‰¾åˆ°ä¸€ä¸ªèµ„æºã€‚&lt;/p&gt;
&lt;p&gt;â‘¡ ä¸‹è½½ä¸€ä¸ªæ’­æ”¾å™¨ï¼Œè¾“å…¥æˆ‘æƒ³è¦çœ‹çš„ç±»å‹ï¼Œå°±ä¼šè‡ªåŠ¨æ¨é€è¿™ä¸ªç±»å‹çš„ç”µå½±åˆ—è¡¨ã€‚&lt;/p&gt;
&lt;p&gt;IOC ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œä»…ä»…éœ€è¦åœ¨ä»£ç ä¸­æä¾›ä¾èµ–å…³ç³»ï¼Œç”±å®¹å™¨ç»´æŠ¤å¥½ï¼Œè‡ªåŠ¨æŠŠå¯¹è±¡æä¾›ç»™æˆ‘ä»¬ä½¿ç”¨ï¼Œç»™çš„è¿‡ç¨‹ç§°ä¹‹ä¸º&lt;strong&gt;æ³¨å…¥&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨å…¥ï¼šæä¾›ä¸€ä¸ª setter æ–¹æ³•æˆ–æ„é€ æ–¹æ³•ï¼ŒSpring å°±ä¼šæŠŠå¯¹è±¡ç»™æˆ‘ä»¬ã€‚ç»™æˆ‘ä»¬çš„è¿‡ç¨‹ç§°ä¸ºæ³¨å…¥ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Spring3 æœ‰æ¥å£æ³¨å…¥ï¼Œä½†æ˜¯ä» Spring4 å¼€å§‹å°±å·²ç»å–æ¶ˆäº†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;springæ³¨å…¥è¯¦ç»†é…ç½®å­—ç¬¦ä¸²-æ•°ç»„ç­‰&#34;&gt;springæ³¨å…¥è¯¦ç»†é…ç½®ï¼ˆå­—ç¬¦ä¸²ã€æ•°ç»„ç­‰ï¼‰&lt;/h2&gt;
&lt;p&gt;å‚è€ƒæ–‡æ¡£ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-factory-properties-detailed&#34;&gt;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-factory-properties-detailed&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;å­—ç¬¦ä¸²å±æ€§æ³¨å…¥&#34;&gt;&lt;strong&gt;å­—ç¬¦ä¸²å±æ€§æ³¨å…¥&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨ valueï¼š&lt;property name=&#34;str&#34; value=&#34;&#34;/&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.ssm.dao.impl;
import com.ssm.dao.IndexDao;
public class IndexDaoImpl implements IndexDao {
    private String str=&amp;quot;&amp;quot;;
    public void setStr(String str) {
        this.str = str;
    }
    public String getStr() {
        return str;
    }
    @Override
    public void test() {
        System.out.println(&amp;quot;IndexDaoImpl...&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;bean id=&amp;quot;dao&amp;quot; class=&amp;quot;com.ssm.dao.impl.IndexDaoImpl&amp;quot;&amp;gt;
    &amp;lt;property name=&amp;quot;str&amp;quot; value=&amp;quot;Hello world&amp;quot;&amp;gt;&amp;lt;/property&amp;gt;
&amp;lt;/bean&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;bean id=&amp;quot;myDataSource&amp;quot; class=&amp;quot;org.apache.commons.dbcp.BasicDataSource&amp;quot; destroy-method=&amp;quot;close&amp;quot;&amp;gt;
    &amp;lt;!-- results in a setDriverClassName (String) call --&amp;gt;
    &amp;lt;property name=&amp;quot;driverClassName&amp;quot; value=&amp;quot;com.mysql.jdbc.Driver&amp;quot;/&amp;gt;
    &amp;lt;property name=&amp;quot;url&amp;quot; value=&amp;quot;jdbc:mysql://localhost:3306/mydb&amp;quot;/&amp;gt;
    &amp;lt;property name=&amp;quot;username&amp;quot; value=&amp;quot;root&amp;quot;/&amp;gt;
    &amp;lt;property name=&amp;quot;password&amp;quot; value=&amp;quot;masterkaoli&amp;quot;/&amp;gt;
&amp;lt;/bean&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;å†…éƒ¨-bean&#34;&gt;å†…éƒ¨ bean&lt;/h3&gt;
&lt;p&gt;åŸæ¥æ˜¯é€šè¿‡åœ¨ &lt;property ref=&#34;xxx&#34;/&gt;ï¼Œref å¼•å…¥å¤–éƒ¨ bean&lt;/p&gt;
&lt;p&gt;å†…éƒ¨ bean æ˜¯ &lt;property&gt;&lt;bean&gt;  ... &lt;/bean&gt;&lt;/property&gt;ï¼Œåœ¨ property æ ‡ç­¾å†…éƒ¨æ³¨å…¥ bean&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;bean id=&amp;quot;outer&amp;quot; class=&amp;quot;...&amp;quot;&amp;gt;
    &amp;lt;!-- instead of using a reference to a target bean, simply define the target bean inline --&amp;gt;
    &amp;lt;property name=&amp;quot;target&amp;quot;&amp;gt;
        &amp;lt;bean class=&amp;quot;com.example.Person&amp;quot;&amp;gt; &amp;lt;!-- this is the inner bean --&amp;gt;
            &amp;lt;property name=&amp;quot;name&amp;quot; value=&amp;quot;Fiona Apple&amp;quot;/&amp;gt;
            &amp;lt;property name=&amp;quot;age&amp;quot; value=&amp;quot;25&amp;quot;/&amp;gt;
        &amp;lt;/bean&amp;gt;
    &amp;lt;/property&amp;gt;
&amp;lt;/bean&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;collections&#34;&gt;Collections&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;bean id=&amp;quot;moreComplexObject&amp;quot; class=&amp;quot;example.ComplexObject&amp;quot;&amp;gt;
    &amp;lt;!-- results in a setAdminEmails(java.util.Properties) call --&amp;gt;
    &amp;lt;property name=&amp;quot;adminEmails&amp;quot;&amp;gt;
        &amp;lt;props&amp;gt;
            &amp;lt;prop key=&amp;quot;administrator&amp;quot;&amp;gt;administrator@example.org&amp;lt;/prop&amp;gt;
            &amp;lt;prop key=&amp;quot;support&amp;quot;&amp;gt;support@example.org&amp;lt;/prop&amp;gt;
            &amp;lt;prop key=&amp;quot;development&amp;quot;&amp;gt;development@example.org&amp;lt;/prop&amp;gt;
        &amp;lt;/props&amp;gt;
    &amp;lt;/property&amp;gt;
    &amp;lt;!-- results in a setSomeList(java.util.List) call --&amp;gt;
    &amp;lt;property name=&amp;quot;someList&amp;quot;&amp;gt;
        &amp;lt;list&amp;gt;
            &amp;lt;value&amp;gt;a list element followed by a reference&amp;lt;/value&amp;gt;
            &amp;lt;ref bean=&amp;quot;myDataSource&amp;quot; /&amp;gt;
        &amp;lt;/list&amp;gt;
    &amp;lt;/property&amp;gt;
    &amp;lt;!-- results in a setSomeMap(java.util.Map) call --&amp;gt;
    &amp;lt;property name=&amp;quot;someMap&amp;quot;&amp;gt;
        &amp;lt;map&amp;gt;
            &amp;lt;entry key=&amp;quot;an entry&amp;quot; value=&amp;quot;just some string&amp;quot;/&amp;gt;
            &amp;lt;entry key =&amp;quot;a ref&amp;quot; value-ref=&amp;quot;myDataSource&amp;quot;/&amp;gt;
        &amp;lt;/map&amp;gt;
    &amp;lt;/property&amp;gt;
    &amp;lt;!-- results in a setSomeSet(java.util.Set) call --&amp;gt;
    &amp;lt;property name=&amp;quot;someSet&amp;quot;&amp;gt;
        &amp;lt;set&amp;gt;
            &amp;lt;value&amp;gt;just some string&amp;lt;/value&amp;gt;
            &amp;lt;ref bean=&amp;quot;myDataSource&amp;quot; /&amp;gt;
        &amp;lt;/set&amp;gt;
    &amp;lt;/property&amp;gt;
&amp;lt;/bean&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;xml-shortcut-with-the-p-namespace&#34;&gt;XML Shortcut with the p-namespace&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;Spring supports extensible configuration formats with namespaces, which are based on an XML Schema definition. The beans configuration format discussed in this chapter is defined in an XML Schema document. However, the p-namespace is not defined in an XSD file and exists only in the core of Spring.&lt;/p&gt;
&lt;p&gt;Spring æ”¯æŒå¸¦æœ‰åç§°ç©ºé—´çš„å¯æ‰©å±•é…ç½®æ ¼å¼ï¼Œè¿™äº›åç§°ç©ºé—´åŸºäºXMLæ¨¡å¼å®šä¹‰ã€‚æœ¬ç« è®¨è®ºçš„ bean é…ç½®æ ¼å¼æ˜¯åœ¨ XML æ¨¡å¼æ–‡æ¡£ä¸­å®šä¹‰çš„ã€‚ä½†æ˜¯ï¼Œp-namespace å¹¶æ²¡æœ‰åœ¨ XSD æ–‡ä»¶ä¸­å®šä¹‰ï¼Œå®ƒåªå­˜åœ¨äºSpring çš„æ ¸å¿ƒä¸­ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;1ã€åœ¨åŸæœ‰çš„åŸºç¡€ä¸Šæ·»åŠ  xmlns:p=&amp;quot;http://www.springframework.org/schema/p&amp;quot; å‘½åç©ºé—´&lt;/p&gt;
&lt;p&gt;2ã€&lt;bean id=&#34;dao&#34; class=&#34;com.ssm.dao.impl.IndexDaoImpl&#34; p:str=&#34;Hello world&#34;&gt; æ³¨å…¥ ç­‰ä»·äº åŸæœ‰çš„ &lt;property name=&#34;str&#34; value=&#34;Hello world&#34;/&gt;  æ³¨å…¥ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;beans xmlns=&amp;quot;http://www.springframework.org/schema/beans&amp;quot;
       xmlns:xsi=&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;
       xmlns:p=&amp;quot;http://www.springframework.org/schema/p&amp;quot;
       xsi:schemaLocation=&amp;quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&amp;quot;&amp;gt;

    &amp;lt;bean id=&amp;quot;dao&amp;quot; class=&amp;quot;com.ssm.dao.impl.IndexDaoImpl&amp;quot; p:str=&amp;quot;Hello world&amp;quot;&amp;gt;
&amp;lt;!--        &amp;lt;property name=&amp;quot;str&amp;quot; value=&amp;quot;Hello world&amp;quot;&amp;gt;&amp;lt;/property&amp;gt;--&amp;gt;
    &amp;lt;/bean&amp;gt;
&amp;lt;/beans&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;xml-shortcut-with-the-c-namespace&#34;&gt;XML Shortcut with the c-namespace&lt;/h3&gt;
&lt;p&gt;å¦‚æœç±»ä¸­å®šä¹‰äº†æ„é€ å‡½æ•°æ³¨å…¥ï¼Œä½† bean æ ‡ç­¾å†…æ²¡æœ‰å£°æ˜ &lt;constructor-arg&gt; å°±ä¼šäº§ç”Ÿ Caused by: java.lang.NoSuchMethodException: com.ssm.service.IndexService.&lt;init&gt;() å¼‚å¸¸&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;bean id=&amp;quot;service&amp;quot; class=&amp;quot;com.ssm.service.IndexService&amp;quot;&amp;gt;&amp;lt;!--        &amp;lt;constructor-arg ref=&amp;quot;dao&amp;quot;&amp;gt;&amp;lt;/constructor-arg&amp;gt;--&amp;gt;&amp;lt;/bean&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½¿ç”¨ c-namespace æ³¨å…¥ï¼š&lt;br&gt;
1ã€æ·»åŠ  xmlns:c=&amp;quot;http://www.springframework.org/schema/c&amp;quot; å‘½åç©ºé—´&lt;/p&gt;
&lt;p&gt;2ã€&lt;bean id=&#34;service&#34; class=&#34;com.ssm.service.IndexService&#34; c:indexDao-ref=&#34;dao&#34;&gt; æ³¨å…¥ ç­‰ä»·äº åŸæ¥çš„ Â  Â  &lt;bean id=&#34;service&#34; class=&#34;com.ssm.service.IndexService&#34;&gt;  &lt;constructor-arg ref=&#34;dao&#34;&gt;&lt;/constructor-arg&gt;  &lt;/bean&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;beans xmlns=&amp;quot;http://www.springframework.org/schema/beans&amp;quot;
       xmlns:xsi=&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;
       xmlns:p=&amp;quot;http://www.springframework.org/schema/p&amp;quot;
       xmlns:c=&amp;quot;http://www.springframework.org/schema/c&amp;quot;
       xsi:schemaLocation=&amp;quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&amp;quot;&amp;gt;

    &amp;lt;bean id=&amp;quot;dao&amp;quot; class=&amp;quot;com.ssm.dao.impl.IndexDaoImpl&amp;quot; p:str=&amp;quot;Hello world&amp;quot;&amp;gt; 
&amp;lt;!--        &amp;lt;property name=&amp;quot;str&amp;quot; value=&amp;quot;Hello world&amp;quot;&amp;gt;&amp;lt;/property&amp;gt;--&amp;gt;
    &amp;lt;/bean&amp;gt;

    &amp;lt;bean id=&amp;quot;service&amp;quot; class=&amp;quot;com.ssm.service.IndexService&amp;quot; c:indexDao-ref=&amp;quot;dao&amp;quot;&amp;gt;
&amp;lt;!--        &amp;lt;constructor-arg ref=&amp;quot;dao&amp;quot;&amp;gt;&amp;lt;/constructor-arg&amp;gt;--&amp;gt;
    &amp;lt;/bean&amp;gt;

&amp;lt;/beans&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;spring-é€šè¿‡-setter-æ³¨å…¥çš„åº”ç”¨å®ä¾‹&#34;&gt;Spring é€šè¿‡ setter æ³¨å…¥çš„åº”ç”¨å®ä¾‹&lt;/h2&gt;
&lt;p&gt;1ã€pom.xml å¯¼å…¥ spring ä¾èµ–&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;!-- ioc 90% ä»¥ä¸Šçš„å†…å®¹ --&amp;gt;
&amp;lt;dependency&amp;gt;
  &amp;lt;groupId&amp;gt;org.springframework&amp;lt;/groupId&amp;gt;
  &amp;lt;artifactId&amp;gt;spring-context&amp;lt;/artifactId&amp;gt;
  &amp;lt;version&amp;gt;5.0.9.RELEASE&amp;lt;/version&amp;gt;
&amp;lt;/dependency&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€åº”ç”¨ç¨‹åºä¸­æä¾›ç±»ï¼Œæä¾›ä¾èµ–å…³ç³»ï¼ˆå±æ€§æˆ–è€…æ„é€ æ–¹æ³•ï¼‰&lt;/p&gt;
&lt;p&gt;IndexDao ç±»ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.ssm.dao;

public interface IndexDao {
    void test();
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;IndexDaoImpl ç±»ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.ssm.dao.impl;

import com.ssm.dao.IndexDao;

public class IndexDaoImpl implements IndexDao {

    @Override
    public void test() {
        System.out.println(&amp;quot;IndexDaoImpl...&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;IndexService ä¾èµ– Indexï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æä¾› setter æ–¹æ³•ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.ssm.service;

import com.ssm.dao.IndexDao;

public class IndexService {

    private IndexDao indexDao;

    public void service(){
        indexDao.test();
    }

    // æä¾› setter æ–¹æ³•
    public void setIndexDao(IndexDao indexDao) {
        this.indexDao = indexDao;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3ã€æŠŠéœ€è¦äº¤ç»™å®¹å™¨ç®¡ç†çš„å¯¹è±¡é€šè¿‡é…ç½®ä¿¡æ¯å‘Šè¯‰å®¹å™¨ï¼ˆxmlã€Annotationï¼ŒJavaConfigï¼‰&lt;/p&gt;
&lt;p&gt;4ã€æŠŠå„ä¸ªç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»é€šè¿‡é…ç½®ä¿¡æ¯å‘Šè¯‰å®¹å™¨&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;beans xmlns=&amp;quot;http://www.springframework.org/schema/beans&amp;quot;
       xmlns:xsi=&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;
       xsi:schemaLocation=&amp;quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&amp;quot;&amp;gt;

    &amp;lt;bean id=&amp;quot;dao&amp;quot; class=&amp;quot;com.ssm.dao.impl.IndexDaoImpl&amp;quot;&amp;gt;&amp;lt;/bean&amp;gt;

    &amp;lt;bean id=&amp;quot;service&amp;quot; class=&amp;quot;com.ssm.service.IndexService&amp;quot;&amp;gt;
        &amp;lt;property name=&amp;quot;indexDao&amp;quot; ref=&amp;quot;dao&amp;quot;/&amp;gt;
    &amp;lt;/bean&amp;gt;

&amp;lt;/beans&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;5ã€æµ‹è¯•&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.ssm.test;

import com.ssm.service.IndexService;
import org.springframework.context.support.ClassPathXmlApplicationContext;

public class Test {
    public static void main(String[] args) {
        // ClassPathXmlApplicationContextï¼šé€šè¿‡ ClassPath ä¸‹çš„ xml åˆå§‹åŒ– Spring åº”ç”¨ç¯å¢ƒ
        ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext(&amp;quot;spring.xml&amp;quot;);
        IndexService service = (IndexService) context.getBean(&amp;quot;service&amp;quot;);
        service.service();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;6ã€è¿è¡Œç»“æœ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;IndexDaoImpl...æ³¨å…¥çš„ä¸¤ç§æ–¹æ³•
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;constructor-based-dependency-injection&#34;&gt;Constructor-based Dependency Injection&lt;/h3&gt;
&lt;p&gt;æ„é€ æ–¹æ³•æ³¨å…¥å‚è€ƒæ–‡æ¡£ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-constructor-injection&#34;&gt;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-constructor-injection&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&#34;æ„é€ æ–¹æ³•æ³¨å…¥å®ä¾‹&#34;&gt;æ„é€ æ–¹æ³•æ³¨å…¥å®ä¾‹&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class IndexService {
    private IndexDao indexDao;
    public IndexService(IndexDao indexDao){
        this.indexDao = indexDao;
    }
    public void service(){
        indexDao.test();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;xml æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;bean id=&amp;quot;dao&amp;quot; class=&amp;quot;com.ssm.dao.impl.IndexDaoImpl&amp;quot;&amp;gt;&amp;lt;/bean&amp;gt;
&amp;lt;bean id=&amp;quot;service&amp;quot; class=&amp;quot;com.ssm.service.IndexService&amp;quot;&amp;gt;
  &amp;lt;constructor-arg ref=&amp;quot;dao&amp;quot;&amp;gt;&amp;lt;/constructor-arg&amp;gt;
&amp;lt;/bean&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95%E6%B3%A8%E5%85%A5.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;setter-based-dependency-injection&#34;&gt;Setter-based Dependency Injection&lt;/h3&gt;
&lt;p&gt;setterå‚è€ƒæ–‡æ¡£ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-setter-injection&#34;&gt;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-setter-injection&lt;/a&gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/setter%E6%B3%A8%E5%85%A5.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;æ³¨è§£-xml-æ··åˆä½¿ç”¨&#34;&gt;æ³¨è§£ + xml æ··åˆä½¿ç”¨&lt;/h2&gt;
&lt;p&gt;1ã€xml å†… çš„ref å¼•ç”¨ dao&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;beans xmlns=&amp;quot;http://www.springframework.org/schema/beans&amp;quot;
       xmlns:xsi=&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;
       xmlns:p=&amp;quot;http://www.springframework.org/schema/p&amp;quot;
       xmlns:c=&amp;quot;http://www.springframework.org/schema/c&amp;quot;
       xsi:schemaLocation=&amp;quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&amp;quot;&amp;gt;
    &amp;lt;bean id=&amp;quot;service&amp;quot; class=&amp;quot;com.ssm.service.IndexService&amp;quot; c:indexDao-ref=&amp;quot;dao&amp;quot;&amp;gt;
    &amp;lt;/bean&amp;gt;
&amp;lt;/beans&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€ä½¿ç”¨æ³¨è§£å£°æ˜ daoï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Component(&amp;quot;dao&amp;quot;)
public class IndexDaoImpl implements IndexDao {
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3ã€æŠ¥é”™ï¼šæ‰¾ä¸åˆ° dao&lt;/p&gt;
&lt;p&gt;Caused by: org.springframework.beans.factory.NoSuchBeanDefinitionException: No bean named &#39;dao&#39; available&lt;/p&gt;
&lt;p&gt;4ã€åˆ†æï¼šæ²¡æœ‰å¼€å¯æ³¨è§£ã€æ²¡æœ‰æ³¨è§£æ‰«æ&lt;/p&gt;
&lt;h3 id=&#34;å¼€å¯æ³¨è§£&#34;&gt;å¼€å¯æ³¨è§£ï¼š&lt;/h3&gt;
&lt;p&gt;1ã€xml ä¸­æ·»åŠ  context ç›¸å…³å†…å®¹&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;xmlns:context=&amp;quot;http://www.springframework.org/schema/context&amp;quot;
 xsi:schemaLocation=&amp;quot;http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context.xsd&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€å¼€å¯æ³¨è§£ï¼ˆç°åœ¨ Spring ç‰ˆæœ¬ä¸å†™å¼€å¯æ³¨è§£ã€åªå†™æ³¨è§£æ‰«æï¼Œä¹Ÿèƒ½å®ç°åŠŸèƒ½ï¼‰&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;context:annotation-config /&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3ã€å¼€å¯æ³¨è§£æ‰«æ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;context:component-scan base-package=&amp;quot;com.ssm&amp;quot;/&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å°† service çš„ bean å£°æ˜ä¹Ÿä½¿ç”¨æ³¨è§£ï¼Œäºæ˜¯å°±å¯ä»¥åˆ é™¤ xml ä¸­çš„ id ä¸º service çš„ bean æ ‡ç­¾äº†ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Service(value = &amp;quot;service&amp;quot;)
public class IndexService {
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å®Œæ•´ä»£ç ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;beans xmlns=&amp;quot;http://www.springframework.org/schema/beans&amp;quot;
       xmlns:xsi=&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;
       xmlns:p=&amp;quot;http://www.springframework.org/schema/p&amp;quot;
       xmlns:context=&amp;quot;http://www.springframework.org/schema/context&amp;quot;
       xmlns:c=&amp;quot;http://www.springframework.org/schema/c&amp;quot;
       xsi:schemaLocation=&amp;quot;http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context.xsd&amp;quot;&amp;gt;
    &amp;lt;!-- å¼€å¯æ³¨è§£ --&amp;gt;
    &amp;lt;context:annotation-config&amp;gt;&amp;lt;/context:annotation-config&amp;gt;
    &amp;lt;!-- å¼€å¯æ³¨è§£æ‰«æ --&amp;gt;
    &amp;lt;context:component-scan base-package=&amp;quot;com.ssm&amp;quot;&amp;gt;&amp;lt;/context:component-scan&amp;gt;
&amp;lt;/beans&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;4ã€æµ‹è¯•ï¼Œè¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;IndexDaoImpl...
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ€»ç»“ï¼šä»¥ä¸Šè¿™ç§æ³¨è§£æ–¹å¼ä¸€å®šéœ€è¦ xmlï¼Œå› ä¸ºéœ€è¦åœ¨ xml å†…&lt;strong&gt;å¼€å¯æ³¨è§£æ‰«æ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰æ²¡æœ‰åŠæ³•åˆ æ‰ xml å‘¢ï¼Ÿç­”ï¼šJavaConfig é…ç½®æ–¹å¼&lt;/p&gt;
&lt;h2 id=&#34;javaconfig-é…ç½®æ–¹å¼&#34;&gt;JavaConfig é…ç½®æ–¹å¼&lt;/h2&gt;
&lt;p&gt;1ã€ç¼–å†™é…ç½®ç±»&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.ssm.config;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.stereotype.Component;
// è¡¨æ˜è¿™æ˜¯ä¸€ä¸ª xml æ–‡ä»¶
@Configuration
// æ‰«æåŒ…
@ComponentScan(&amp;quot;com.ssm&amp;quot;)      
public class SpringConfig {
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€ä¿®æ”¹æµ‹è¯•ç±» Test&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.ssm.test;
import com.ssm.config.SpringConfig;
import com.ssm.service.IndexService;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
public class Test {
    public static void main(String[] args) {
        // AnnotationConfigApplicationContextï¼šæ³¨è§£é…ç½®åº”ç”¨ç¨‹åº
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(SpringConfig.class);
        IndexService service = (IndexService) context.getBean(&amp;quot;service&amp;quot;);
        service.service();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3ã€æµ‹è¯•ï¼Œè¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;IndexDaoImpl...
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;javaconfig-xml-æ³¨è§£é…ç½®&#34;&gt;JavaConfig + xml +æ³¨è§£é…ç½®&lt;/h2&gt;
&lt;p&gt;1ã€Sservice çš„æ³¨å…¥ä½¿ç”¨æ³¨è§£æ–¹å¼&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;@Service(&amp;quot;service&amp;quot;)
public class IndexService {
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€Dao çš„æ³¨å…¥ä½¿ç”¨ xml æ–¹å¼&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class IndexDaoImpl implements IndexDao {
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;beans xmlns=&amp;quot;http://www.springframework.org/schema/beans&amp;quot;
       xmlns:xsi=&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;
       xmlns:p=&amp;quot;http://www.springframework.org/schema/p&amp;quot;
       xmlns:context=&amp;quot;http://www.springframework.org/schema/context&amp;quot;
       xsi:schemaLocation=&amp;quot;http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context.xsd&amp;quot;&amp;gt;
    &amp;lt;!-- å¼€å¯æ³¨è§£ --&amp;gt;
    &amp;lt;context:annotation-config/&amp;gt;
    &amp;lt;!-- å¼€å¯æ³¨è§£æ‰«æ --&amp;gt;
    &amp;lt;context:component-scan base-package=&amp;quot;com.ssm&amp;quot;/&amp;gt;
    &amp;lt;bean id=&amp;quot;dao&amp;quot; class=&amp;quot;com.ssm.dao.impl.IndexDaoImpl&amp;quot; p:str=&amp;quot;Hello world&amp;quot;&amp;gt;
    &amp;lt;/bean&amp;gt;
&amp;lt;/beans&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3ã€JavaConfig é…ç½®ç±»å¼•å…¥ xml æ–‡ä»¶&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// è¡¨æ˜è¿™æ˜¯ä¸€ä¸ª xml æ–‡ä»¶
@Configuration
// æ‰«æåŒ…
@ComponentScan(&amp;quot;com.ssm&amp;quot;)
// å¼•å…¥ xml é…ç½®æ–‡ä»¶
@ImportResource(&amp;quot;classpath:spring.xml&amp;quot;)
public class SpringConfig {
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;4ã€æµ‹è¯•ç±»&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) {
        // AnnotationConfigApplicationContextï¼šæ³¨è§£é…ç½®åº”ç”¨ç¨‹åº
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(SpringConfig.class);
        IndexService service = (IndexService) context.getBean(&amp;quot;service&amp;quot;);
        service.service();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;IndexDaoImpl...
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;è‡ªåŠ¨è£…é…&#34;&gt;è‡ªåŠ¨è£…é…&lt;/h1&gt;
&lt;p&gt;ä¸Šé¢è¯´è¿‡ï¼ŒIOC çš„æ³¨å…¥æœ‰ä¸¤ä¸ªåœ°æ–¹éœ€è¦æä¾›ä¾èµ–å…³ç³»ï¼Œä¸€æ˜¯ç±»çš„å®šä¹‰ä¸­ï¼ŒäºŒæ˜¯åœ¨springçš„é…ç½®ä¸­éœ€è¦å»æè¿°ã€‚è‡ªåŠ¨è£…é…åˆ™æŠŠç¬¬äºŒä¸ªå–æ¶ˆäº†ï¼Œå³æˆ‘ä»¬ä»…ä»…éœ€è¦åœ¨ç±»ä¸­æä¾›ä¾èµ–ï¼Œç»§è€ŒæŠŠå¯¹è±¡äº¤ç»™å®¹å™¨ç®¡ç†å³å¯å®Œæˆæ³¨å…¥ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨å®é™…å¼€å‘ä¸­ï¼Œæè¿°ç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»é€šå¸¸æ˜¯å¤§ç¯‡å¹…çš„ï¼Œå¦‚æœä½¿ç”¨è‡ªåŠ¨è£…é…åˆ™çœå»äº†å¾ˆå¤šé…ç½®ï¼Œå¹¶ä¸”å¦‚æœå¯¹è±¡çš„ä¾èµ–å‘ç”Ÿæ›´æ–°æˆ‘ä»¬å¯ä»¥ä¸éœ€è¦å»æ›´æ–°é…ç½®ï¼Œä½†æ˜¯ä¹Ÿå¸¦æ¥äº†ä¸€å®šçš„ç¼ºç‚¹&lt;/p&gt;
&lt;h2 id=&#34;è‡ªåŠ¨è£…é…çš„ä¼˜ç‚¹&#34;&gt;è‡ªåŠ¨è£…é…çš„ä¼˜ç‚¹&lt;/h2&gt;
&lt;p&gt;å‚è€ƒæ–‡æ¡£ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-factory-autowire&#34;&gt;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-factory-autowire&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The Spring container can autowire relationships between collaborating beans. You can let Spring resolve collaborators (other beans) automatically for your bean by inspecting the contents of the ApplicationContext. Autowiring has the following advantages:&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Springå®¹å™¨å¯ä»¥è‡ªåŠ¨åˆ›å»ºåä½œ bean ä¹‹é—´çš„å…³ç³»ã€‚é€šè¿‡æ£€æŸ¥ ApplicationContext çš„å†…å®¹ï¼Œæ‚¨å¯ä»¥è®© Spring ä¸ºæ‚¨çš„ bean è‡ªåŠ¨è§£æåä½œè€…(å…¶ä»–bean)ã€‚è‡ªåŠ¨è£…é…æœ‰ä»¥ä¸‹ä¼˜ç‚¹:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Autowiring can significantly reduce the need to specify properties or constructor arguments. (Other mechanisms such as a bean template discussed elsewhere in this chapter are also valuable in this regard.)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è‡ªåŠ¨è£…é…å¯ä»¥å¤§å¤§å‡å°‘æŒ‡å®šå±æ€§æˆ–æ„é€ å‡½æ•°å‚æ•°çš„éœ€è¦ã€‚(æœ¬ç« å…¶ä»–åœ°æ–¹è®¨è®ºçš„å…¶ä»–æœºåˆ¶ï¼Œå¦‚beanæ¨¡æ¿ï¼Œåœ¨è¿™æ–¹é¢ä¹Ÿå¾ˆæœ‰ä»·å€¼ã€‚)&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Autowiring can update a configuration as your objects evolve. For example, if you need to add a dependency to a class, that dependency can be satisfied automatically without you needing to modify the configuration. Thus autowiring can be especially useful during development, without negating the option of switching to explicit wiring when the code base becomes more stable.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è‡ªåŠ¨è£…é…å¯ä»¥éšç€å¯¹è±¡çš„æ¼”åŒ–æ›´æ–°é…ç½®ã€‚ä¾‹å¦‚ï¼Œå¦‚æœéœ€è¦å‘ç±»æ·»åŠ ä¾èµ–ï¼Œåˆ™å¯ä»¥è‡ªåŠ¨æ›´æ–°è¯¥ä¾èµ–ï¼Œè€Œä¸éœ€è¦ä¿®æ”¹é…ç½®ã€‚å› æ­¤ï¼Œè‡ªåŠ¨è£…é…åœ¨å¼€å‘è¿‡ç¨‹ä¸­ç‰¹åˆ«æœ‰ç”¨ï¼Œå½“ä»£ç åº“å˜å¾—æ›´åŠ ç¨³å®šæ—¶ï¼Œè‡ªåŠ¨è£…é…å¯ä»¥é¿å…åˆ‡æ¢åˆ°æ˜¾å¼è¿æ¥çš„é€‰é¡¹ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;bean id=&amp;quot;indexService&amp;quot; class=&amp;quot;com.ssm.service.IndexService&amp;quot;&amp;gt;
    &amp;lt;property name=&amp;quot;indexDao&amp;quot; ref=&amp;quot;dao&amp;quot;/&amp;gt;
&amp;lt;/bean&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åˆ†æï¼šä¸Šè¿°é…ç½®éœ€è¦æ‰‹åŠ¨æ·»åŠ ä¾èµ–ï¼Œæ¯”å¦‚ç°åœ¨ IndexService æ–°å¢äº†ä¾èµ– helloDaoï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class IndexService{
  private IndexDao indexDao;
  private HelloDao helloDao;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å°±éœ€è¦åœ¨ xml çš„ &lt;bean&gt; å†…å¢åŠ  &lt;property name=&#34;hello&#34; ref=&#34;hello&#34;/&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;bean id=&amp;quot;indexService&amp;quot; class=&amp;quot;com.ssm.service.IndexService&amp;quot;&amp;gt;
    &amp;lt;property name=&amp;quot;indexDao&amp;quot; ref=&amp;quot;dao&amp;quot;/&amp;gt;
     &amp;lt;property name=&amp;quot;hello&amp;quot; ref=&amp;quot;hello&amp;quot;/&amp;gt;
&amp;lt;/bean&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½¿ç”¨äº†è‡ªåŠ¨è£…é…åï¼Œå°±æ— é¡»æ‰‹åŠ¨åœ¨ xml ä¸­å¢åŠ ä¾èµ–è¿›è¡Œç»´æŠ¤äº†ï¼Œ&lt;strong&gt;è‡ªåŠ¨è£…é…å¯ä»¥è‡ªåŠ¨æ›´æ–°è¯¥ä¾èµ–ï¼Œè€Œä¸éœ€è¦ä¿®æ”¹é…ç½®&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è‡ªåŠ¨è£…é…çš„ç¼ºç‚¹&#34;&gt;è‡ªåŠ¨è£…é…çš„ç¼ºç‚¹&lt;/h2&gt;
&lt;p&gt;å‚è€ƒæ–‡æ¡£ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-autowired-exceptions&#34;&gt;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-autowired-exceptions&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä½œä¸ºæˆ‘æ¥è®²ï¼Œæˆ‘è§‰å¾—ä»¥ä¸Šç¼ºç‚¹éƒ½ä¸æ˜¯ç¼ºç‚¹&lt;/p&gt;
&lt;h2 id=&#34;è‡ªåŠ¨è£…é…çš„æ–¹æ³•&#34;&gt;è‡ªåŠ¨è£…é…çš„æ–¹æ³•&lt;/h2&gt;
&lt;p&gt;è‡ªåŠ¨è£…é…çš„æ–¹å¼å‚è€ƒæ–‡æ¡£ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-factory-autowire&#34;&gt;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-factory-autowire&lt;/a&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;&lt;strong&gt;Mode&lt;/strong&gt;&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;&lt;strong&gt;Explanation&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;no ( ä¸ä½¿ç”¨è‡ªåŠ¨è£…é… )&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;(é»˜è®¤)æ²¡æœ‰è‡ªåŠ¨è£…é…ã€‚Bean å¼•ç”¨å¿…é¡»ç”± ref å…ƒç´ å®šä¹‰ã€‚å¯¹äºè¾ƒå¤§çš„éƒ¨ç½²ï¼Œä¸å»ºè®®æ›´æ”¹é»˜è®¤è®¾ç½®ï¼Œå› ä¸ºæ˜¾å¼åœ°æŒ‡å®šåä½œè€…å¯ä»¥æä¾›æ›´å¥½çš„æ§åˆ¶å’Œæ¸…æ™°åº¦ã€‚åœ¨æŸç§ç¨‹åº¦ä¸Šï¼Œå®ƒè®°å½•äº†ä¸€ä¸ªç³»ç»Ÿçš„ç»“æ„ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;byName&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;é€šè¿‡å±æ€§åè‡ªåŠ¨è£…é…ã€‚Spring å¯»æ‰¾ä¸éœ€è¦è‡ªåŠ¨è£…é…çš„å±æ€§åŒåçš„ beanã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ª bean å®šä¹‰è¢«æŒ‰åç§°è®¾ç½®ä¸ºè‡ªåŠ¨è£…é…ï¼Œå¹¶ä¸”å®ƒåŒ…å«ä¸€ä¸ªä¸»å±æ€§(ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒæœ‰ä¸€ä¸ªsetMaster(..)æ–¹æ³•)ï¼ŒSpring ä¼šæŸ¥æ‰¾ä¸€ä¸ªåä¸ºmaster çš„ bean å®šä¹‰å¹¶ä½¿ç”¨å®ƒæ¥è®¾ç½®å±æ€§ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;byType&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å¦‚æœå®¹å™¨ä¸­æ°å¥½å­˜åœ¨è¯¥å±æ€§ç±»å‹çš„ä¸€ä¸ª beanï¼Œåˆ™å…è®¸è‡ªåŠ¨è·å–è¯¥å±æ€§ã€‚å¦‚æœå­˜åœ¨å¤šä¸ªå¼‚å¸¸ï¼Œåˆ™æŠ›å‡ºä¸€ä¸ªè‡´å‘½å¼‚å¸¸ï¼Œè¿™è¡¨æ˜æ‚¨ä¸èƒ½ä¸ºè¯¥ bean ä½¿ç”¨byType è‡ªåŠ¨è£…é…ã€‚å¦‚æœæ²¡æœ‰åŒ¹é…çš„ beanï¼Œåˆ™ä»€ä¹ˆä¹Ÿä¸ä¼šå‘ç”Ÿ(å±æ€§æ²¡æœ‰è®¾ç½®)ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;constructor&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ç±»ä¼¼äº byTypeï¼Œä½†é€‚ç”¨äºæ„é€ å‡½æ•°å‚æ•°ã€‚å¦‚æœå®¹å™¨ä¸­æ²¡æœ‰ä¸€ä¸ªæ„é€ å‡½æ•°å‚æ•°ç±»å‹çš„ beanï¼Œåˆ™ä¼šå¼•å‘è‡´å‘½é”™è¯¯ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;bytype-è‡ªåŠ¨è£…é…å®ä¾‹&#34;&gt;byType è‡ªåŠ¨è£…é…å®ä¾‹&lt;/h3&gt;
&lt;p&gt;1ã€IndexService ä¾èµ– IndexDao&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class IndexService {
    private IndexDao indexDao;
    public void service(){
        indexDao.test();
    }
    public void setIndexDao(IndexDao indexDao) {
        this.indexDao = indexDao;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€ä½¿ç”¨è‡ªåŠ¨è£…é…ï¼šbeans æ ‡ç­¾å†…å¯¼å…¥ default-autowire=&amp;quot;byType&amp;quot;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;beans xmlns=&amp;quot;http://www.springframework.org/schema/beans&amp;quot;
       xmlns:xsi=&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;
       xmlns:context=&amp;quot;http://www.springframework.org/schema/context&amp;quot;
       xsi:schemaLocation=&amp;quot;http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context.xsd&amp;quot;
        default-autowire=&amp;quot;byType&amp;quot;&amp;gt;

    &amp;lt;!-- å¼€å¯æ³¨è§£ --&amp;gt;
    &amp;lt;context:annotation-config/&amp;gt;
    &amp;lt;!-- å¼€å¯æ³¨è§£æ‰«æ --&amp;gt;
    &amp;lt;context:component-scan base-package=&amp;quot;com.ssm&amp;quot;/&amp;gt;

    &amp;lt;bean id=&amp;quot;dao&amp;quot; class=&amp;quot;com.ssm.dao.impl.IndexDaoImpl&amp;quot;&amp;gt;
    &amp;lt;/bean&amp;gt;

    &amp;lt;!-- IndexService å†…åº”è¯¥æ³¨å…¥ IndexDaoï¼Œä½†å› ä¸ºæŒ‡å®šäº†è‡ªåŠ¨è£…é…ï¼Œæ‰€ä»¥å¯ä»¥ä¸æ˜¾å¼é€šè¿‡ property æ ‡ç­¾æ³¨å…¥ IndexDao --&amp;gt;
    &amp;lt;bean id=&amp;quot;indexService&amp;quot; class=&amp;quot;com.ssm.service.IndexService&amp;quot;&amp;gt;
&amp;lt;!--        &amp;lt;property name=&amp;quot;indexDao&amp;quot; ref=&amp;quot;dao&amp;quot;/&amp;gt;--&amp;gt;
    &amp;lt;/bean&amp;gt;
&amp;lt;/beans&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åˆ†æï¼šIndexService å†…åº”è¯¥æ³¨å…¥ IndexDaoï¼Œä½†å› ä¸ºé€šè¿‡ default-autowire=&amp;quot;byType&amp;quot; æŒ‡å®šäº†è‡ªåŠ¨è£…é…ï¼Œæ‰€ä»¥å¯ä»¥ä¸æ˜¾å¼é€šè¿‡ property æ ‡ç­¾æ³¨å…¥ IndexDaoã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ‰«æåˆ° IndexService ç±»æ—¶ï¼Œå‘ç°è¯¥ç±»ä¾èµ–äº† IndexDaoï¼Œå‘ç°å®ƒçš„ç±»å‹æ˜¯ IndexDaoï¼Œåˆ° Spring å®¹å™¨ä¸­æ‰¾ç±»å‹æˆ–çˆ¶ç±»ç±»å‹ä¸º IndexDao çš„ï¼Œå¦‚æœæœ‰ï¼Œå°±æŠŠè¿™ä¸ªå¯¹è±¡ç›´æ¥èµ‹ç»™ IndexService ä¸­çš„ IndexDaoã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è‡ªåŠ¨è£…é…å¹¶ä¸æ˜¯å®Œå…¨ä¸éœ€è¦é…ç½®äº†ï¼Œè‡ªåŠ¨è£…é…ä»éœ€è¦é…ç½® beanï¼Œå°†ç±»äº¤ç»™ Spring å®¹å™¨ç®¡ç†ï¼Œè‡ªåŠ¨è£…é…çœç•¥äº†ç±»ä¸ç±»ä¹‹é—´ä¾èµ–çš„ç®¡ç†ï¼Œæ¯”å¦‚ç±» A ä¾èµ–ç±» Bï¼Œæ— éœ€é…ç½®ä¾èµ–å…³ç³»äº†ï¼ŒSpring ä¼šè‡ªåŠ¨åˆ°å®¹å™¨ä¸­æ‰¾åˆ°ç±» B ç„¶åæŠŠå®ƒèµ‹ç»™ç±» A çš„æˆå‘˜å˜é‡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h4 id=&#34;bytype-è‡ªåŠ¨è£…é…å¤šä¸ªç›¸åŒç±»å‹çš„é—®é¢˜&#34;&gt;byType è‡ªåŠ¨è£…é…å¤šä¸ªç›¸åŒç±»å‹çš„é—®é¢˜&lt;/h4&gt;
&lt;p&gt;å½“æœ‰å¤šä¸ªç›¸åŒç±»å‹æ—¶ï¼Œä¼šæŠ¥é”™&lt;/p&gt;
&lt;p&gt;1ã€æ·»åŠ ä¸€ä¸ª IndexDaoImpl2 ç±»&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class IndexDaoImpl2 implements IndexDao {
    @Override
    public void test() {
        System.out.println(&amp;quot;IndexDaoImpl...2&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€æŠŠ IndexDaoImpl2 äº¤ç»™ Spring å®¹å™¨ç®¡ç†ï¼Œç°åœ¨ Spring å®¹å™¨å†…æœ‰ä¸¤ä¸ª type = IndexDao çš„ç±»ï¼šIndexDaoImpã€IndexDaoImpl2&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;bean id=&amp;quot;dao2&amp;quot; class=&amp;quot;com.ssm.dao.impl.IndexDaoImpl2&amp;quot;/&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3ã€æµ‹è¯•ç»“æœï¼š&lt;/p&gt;
&lt;p&gt;Caused by: org.springframework.beans.factory.NoUniqueBeanDefinitionException: No qualifying bean of type &#39;com.ssm.dao.IndexDao&#39; available: expected single matching bean but found 2: dao,dao2&lt;/p&gt;
&lt;p&gt;éœ€è¦å•ä¸ªåŒ¹é…ï¼Œä½†æ˜¯å‘ç°äº†ä¸¤ä¸ªï¼šdaoã€dao2&lt;/p&gt;
&lt;h3 id=&#34;byname-è‡ªåŠ¨è£…é…å®ä¾‹&#34;&gt;byName è‡ªåŠ¨è£…é…å®ä¾‹&lt;/h3&gt;
&lt;p&gt;1ã€beans æ ‡ç­¾å†…æŒ‡å®š byName è‡ªåŠ¨è£…é…ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;default-autowire=&amp;quot;byName&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€å¦‚æœæ²¡æœ‰æŒ‡å®š &lt;bean&gt; æ ‡ç­¾çš„ name å±æ€§ï¼Œname é»˜è®¤ä¸ºå°† setIndexDao çš„ set å»æ‰ã€ç¬¬ä¸€ä¸ªå­—æ¯å°å†™ï¼Œå³ name=indexDao&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class IndexService {
    private IndexDao indexDao;
    public void service(){
        indexDao.test();
    }
    public void setIndexDao(IndexDao indexDao) {
        this.indexDao = indexDao;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3ã€äºæ˜¯åˆ° Spring å®¹å™¨å†…æ‰¾ name=indexDao çš„ï¼Œæ²¡æœ‰æ‰¾åˆ°ï¼ŒæŠ¥é”™ Exception in thread &amp;quot;main&amp;quot; java.lang.NullPointerException&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;bean id=&amp;quot;dao&amp;quot; class=&amp;quot;com.ssm.dao.impl.IndexDaoImpl&amp;quot;/&amp;gt;
&amp;lt;bean id=&amp;quot;dao2&amp;quot; class=&amp;quot;com.ssm.dao.impl.IndexDaoImpl2&amp;quot;/&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è§£å†³åŠæ³•ä¸€ï¼š&lt;/p&gt;
&lt;p&gt;1ã€æ”¹å˜ set æ–¹æ³•çš„æ–¹æ³•åï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public void setDao(IndexDao indexDao) {
    this.indexDao = indexDao;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€æµ‹è¯•æˆåŠŸï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;IndexDaoImpl...
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è§£å†³æ–¹æ³•äºŒï¼š&lt;/p&gt;
&lt;p&gt;1ã€set æ–¹æ³•ä¸å˜&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public void setIndexDao(IndexDao indexDao) {
    this.indexDao = indexDao;
 }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€ç»™ bean æ ‡ç­¾æ·»åŠ  name å±æ€§&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;bean id=&amp;quot;dao2&amp;quot; class=&amp;quot;com.ssm.dao.impl.IndexDaoImpl2&amp;quot; name=&amp;quot;indexDao&amp;quot;&amp;gt;&amp;lt;/bean&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3ã€æµ‹è¯•æˆåŠŸ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;IndexDaoImpl...2
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;default-no-ä¸ä½¿ç”¨è‡ªåŠ¨è£…é…&#34;&gt;default = no ä¸ä½¿ç”¨è‡ªåŠ¨è£…é…&lt;/h3&gt;
&lt;p&gt;beans æ ‡ç­¾å†…éƒ¨å¢åŠ å¦‚ä¸‹è¯´æ˜ï¼š&lt;/p&gt;
&lt;p&gt;default-autowire=&amp;quot;default&amp;quot;&lt;/p&gt;
&lt;p&gt;default=autowire=&amp;quot;no&amp;quot;&lt;/p&gt;
&lt;p&gt;å¼‚å¸¸ä¿¡æ¯ï¼šException in thread &amp;quot;main&amp;quot; java.lang.NullPointerException&lt;/p&gt;
&lt;p&gt;å…¶ä»–éƒ½æƒ³æ‰‹åŠ¨è£…é…ï¼Œå”¯ç‹¬ IndexService æƒ³è‡ªåŠ¨è£…é…ï¼Œå°±ä¸èƒ½åœ¨ beans æ ‡ç­¾å†…æ·»åŠ  default-autowire äº†ï¼Œå¯ä»¥&lt;strong&gt;ä¸ºæ¯ä¸€ä¸ªå±æ€§å•ç‹¬æŒ‡å®šä¸€ä¸ª autowire&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;bean id=&amp;quot;indexService&amp;quot; class=&amp;quot;com.ssm.service.IndexService&amp;quot; autowire=&amp;quot;byType&amp;quot;/&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å‚è€ƒèµ„æ–™ï¼š&lt;a href=&#34;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-stereotype-annotations&#34;&gt;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-stereotype-annotations&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Spring provides further stereotype annotations:Â @Component,Â @Service, andÂ @Controller.Â @ComponentÂ is a generic stereotype for any Spring-managed component.Â @Repository,Â @Service, andÂ @ControllerÂ are specializations ofÂ @ComponentÂ for more specific use cases (in the persistence, service, and presentation layers, respectively). Therefore, you can annotate your component classes withÂ @Component, but, by annotating them withÂ @Repository,Â @Service, orÂ @ControllerÂ instead, your classes are more properly suited for processing by tools or associating with aspects. For example, these stereotype annotations make ideal targets for pointcuts.Â @Repository,Â @Service, andÂ @ControllerÂ can also carry additional semantics in future releases of the Spring Framework. Thus, if you are choosing between usingÂ @ComponentÂ orÂ @ServiceÂ for your service layer,Â @ServiceÂ is clearly the better choice. Similarly, as stated earlier,Â @RepositoryÂ is already supported as a marker for automatic exception translation in your persistence layer.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Springæä¾›äº†æ›´å¤šçš„çš„æ„é€ å‹æ³¨è§£:@Componentï¼Œ @Serviceï¼Œå’Œ@Controllerã€‚@Component æ˜¯ä»»ä½•springç®¡ç†ç»„ä»¶çš„é€šç”¨æ³¨è§£ã€‚@Repositoryã€@Serviceå’Œ@Controlleræ˜¯@Componentå¯¹æ›´å…·ä½“ç”¨ä¾‹(åˆ†åˆ«åœ¨æŒä¹…æ€§ã€æœåŠ¡å’Œè¡¨ç¤ºå±‚)çš„ä¸“é—¨åŒ–ã€‚å› æ­¤ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨@Componentæ¥æ³¨é‡Šæ‚¨çš„ç»„ä»¶ç±»ï¼Œä½†æ˜¯ï¼Œé€šè¿‡ä½¿ç”¨@Repositoryã€@Serviceæˆ–@Controlleræ¥æ³¨é‡Šå®ƒä»¬ï¼Œæ‚¨çš„ç±»æ›´é€‚åˆé€šè¿‡å·¥å…·è¿›è¡Œå¤„ç†æˆ–ä¸æ–¹é¢ç›¸å…³è”ã€‚ä¾‹å¦‚ï¼Œè¿™äº›æ„é€ å‹æ³¨é‡Šæ˜¯åˆ‡å…¥ç‚¹çš„ç†æƒ³ç›®æ ‡ã€‚åœ¨Springæ¡†æ¶çš„æœªæ¥ç‰ˆæœ¬ä¸­ï¼Œ@Repositoryã€@Serviceå’Œ @Controller ä¹Ÿå¯ä»¥åŒ…å«é¢å¤–çš„è¯­ä¹‰ã€‚å› æ­¤ï¼Œå¦‚æœæ‚¨åœ¨ä½¿ç”¨@Componentæˆ–@Serviceä½œä¸ºæœåŠ¡å±‚ä¹‹é—´è¿›è¡Œé€‰æ‹©ï¼Œé‚£ä¹ˆ@Serviceæ˜¾ç„¶æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚ç±»ä¼¼åœ°ï¼Œå¦‚å‰æ‰€è¿°ï¼Œ@Repositoryå·²ç»è¢«æ”¯æŒä½œä¸ºæŒä¹…å±‚ä¸­è‡ªåŠ¨å¼‚å¸¸è½¬æ¢çš„æ ‡è®°ã€‚&lt;/p&gt;
&lt;h2 id=&#34;autowired-é»˜è®¤é‡‡ç”¨-bytype-æ³¨å…¥&#34;&gt;@Autowired é»˜è®¤é‡‡ç”¨ byType æ³¨å…¥&lt;/h2&gt;
&lt;p&gt;1ã€JavaConfig é…ç½®ç±»&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å£°æ˜è¿™æ˜¯ä¸€ä¸ªæ³¨è§£ç±»&lt;/li&gt;
&lt;li&gt;æ‰«æåŒ…&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// è¡¨æ˜è¿™æ˜¯ä¸€ä¸ª xml æ–‡ä»¶
@Configuration
// æ³¨è§£æ‰«æåŒ…
@ComponentScan(&amp;quot;com.ssm&amp;quot;)
public class SpringConfig {
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€@Service æ³¨è§£&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;@Autowiredæ³¨å…¥ IndexDao&lt;/li&gt;
&lt;li&gt;setIndexDao æ–¹æ³•&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Service
public class IndexService {
    @Autowired
    private IndexDao indexDao;
    public void service(){
        indexDao.test();
    }
    public void setIndexDao(IndexDao indexDao) {
        this.indexDao = indexDao;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3ã€IndexDao ç±»å‹çš„ IndexDaoImplÂ ç±»&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Repository
public class IndexDaoImpl implements IndexDao {
    @Override
    public void test() {
        System.out.println(&amp;quot;IndexDaoImpl...&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;4ã€ç›¸åŒ IndexDao ç±»å‹çš„ IndexDaoImpl2&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Repository
public class IndexDaoImpl2 implements IndexDao {
    @Override
    public void test() {
        System.out.println(&amp;quot;IndexDaoImpl...2&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;5ã€æµ‹è¯•ç±»&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) {
        // AnnotationConfigApplicationContextï¼šæ³¨è§£é…ç½®åº”ç”¨ç¨‹åº
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(SpringConfig.class);
        IndexService service = (IndexService) context.getBean(&amp;quot;indexService&amp;quot;);
        service.service();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;6ã€è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;p&gt;Caused by: org.springframework.beans.factory.NoUniqueBeanDefinitionException: No qualifying bean of type &#39;com.ssm.dao.IndexDao&#39; available: expected single matching bean but found 2: indexDaoImpl,indexDaoImpl2&lt;/p&gt;
&lt;p&gt;æœŸæœ›ä¸€ä¸ªåŒ¹é…çš„ IndexDao ç±»å‹çš„ beanï¼Œå´å‘ç°äº†ä¸¤ä¸ªï¼šindexDaoImplã€indexDaoImpl2&lt;/p&gt;
&lt;p&gt;7ã€åˆ†æ&lt;/p&gt;
&lt;p&gt;@Autowired æ³¨è§£é»˜è®¤ä½¿ç”¨çš„æ˜¯ byType è‡ªåŠ¨è£…é…æ–¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;å½“æ‰§è¡Œ @Autowired æ³¨å…¥æ—¶ï¼Œåˆ° Spring å®¹å™¨ä¸­æ‰¾ IndexDao ç±»å‹æˆ–çˆ¶ç±»ä¸º IndexDao ç±»å‹çš„ï¼Œç»“æœæ‰¾åˆ°äº† IndexDaoImplã€IndexDaoImpl2ï¼Œæ³¨å…¥å¤±è´¥ã€‚æ­¤æ—¶æ ¹æ® byType æ‰¾åˆ°å¤šä¸ªç±»ï¼Œåˆ™æ ¹æ® byName æ³¨å…¥ï¼ˆprivate IndexDao indexDao;ï¼‰å› ä¸ºæ²¡æœ‰åä¸º indexDao çš„ç»„ä»¶ï¼Œæ‰€ä»¥æ³¨å…¥å¤±è´¥ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;@Autowired é»˜è®¤é‡‡ç”¨ byType æ³¨å…¥ï¼Œå¦‚æœ byType æ‰¾åˆ°å¤šä¸ªï¼Œåˆ™æ ¹æ® byName æ³¨å…¥&lt;/strong&gt;ï¼Œname ä¸ºå±æ€§å indexDaoImpl2ï¼ˆprivate IndexDao indexDaoImpl2ï¼‰ã€‚å½“æ ¹æ® name å€¼æ³¨å…¥æ—¶ï¼Œä»…ä¸å±æ€§å€¼æœ‰å…³ï¼Œä¸ set æ–¹æ³•çš„æ–¹æ³•åæ— å…³ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Service
public class IndexService {
    @Autowired
    private IndexDao indexDaoImpl2;
    public void service(){
        indexDaoImpl2.test();
    }
    public void setIndexDao(IndexDao indexDao) {
        this.indexDaoImpl2 = indexDao;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Spring å®¹å™¨ä¸­æ‰¾åˆ° name ä¸º indexDaoImpl2 çš„ç»„ä»¶ï¼Œæ³¨å…¥æˆåŠŸ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Repositorypublic class IndexDaoImpl2 implements IndexDao {
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;IndexDaoImpl...2
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;resource-é»˜è®¤é‡‡ç”¨-byname-æ³¨å…¥&#34;&gt;@Resource é»˜è®¤é‡‡ç”¨ byName æ³¨å…¥&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Resource
private IndexDao indexDaoImpl2;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;@Resource æ¨¡å¼é‡‡ç”¨ byName æ³¨å…¥ï¼Œå¹¶ä¸” name çš„å€¼ä¸ºå±æ€§å€¼ indexDaoImpl2ï¼Œä¸ set æ–¹æ³•çš„åå­—æ— å…³ã€‚&lt;/p&gt;
&lt;h2 id=&#34;spring-é»˜è®¤-bean-åç§°çš„ç”Ÿæˆç­–ç•¥&#34;&gt;Spring é»˜è®¤ bean åç§°çš„ç”Ÿæˆç­–ç•¥&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Repository
public class IndexDaoImpl implements IndexDao {
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Spring ä¸­å¦‚æœä¸æ˜¾å¼æŒ‡å®š bean çš„åå­—ï¼Œé»˜è®¤ bean çš„åç§°ä¸ºç±»åé¦–å­—æ¯å˜å°å†™ï¼Œå³ï¼šindexDaoImpl&lt;/p&gt;
&lt;p&gt;å‚è€ƒèµ„æ–™ï¼š&lt;a href=&#34;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-scanning-name-generator&#34;&gt;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-scanning-name-generator&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;When a component is autodetected as part of the scanning process, its bean name is generated by theÂ BeanNameGeneratorÂ strategy known to that scanner. By default, any Spring stereotype annotation (@Component,Â @Repository,Â @Service, andÂ @Controller) that contains a nameÂ valueÂ thereby provides that name to the corresponding bean definition.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å½“ä¸€ä¸ªç»„ä»¶ä½œä¸ºæ‰«æè¿‡ç¨‹çš„ä¸€éƒ¨åˆ†è¢«è‡ªåŠ¨æ£€æµ‹æ—¶ï¼Œå®ƒçš„beanåç§°ç”±è¯¥æ‰«æç¨‹åºæ‰€çŸ¥é“çš„BeanNameGeneratorç­–ç•¥ç”Ÿæˆã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œä»»ä½•åŒ…å«åç§°å€¼çš„Springæ„é€ å‹æ³¨é‡Š(@Componentã€@Repositoryã€@Serviceå’Œ@Controller)éƒ½å°†è¯¥åç§°æä¾›ç»™ç›¸åº”çš„beanå®šä¹‰ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;If such an annotation contains no nameÂ valueÂ or for any other detected component (such as those discovered by custom filters), the default bean name generator returns the uncapitalized non-qualified class name. For example, if the following component classes were detected, the names would beÂ myMovieListerÂ andÂ movieFinderImpl:&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¦‚æœè¿™æ ·çš„æ³¨é‡Šä¸åŒ…å«åç§°å€¼æˆ–ä»»ä½•å…¶ä»–æ£€æµ‹åˆ°çš„ç»„ä»¶(ä¾‹å¦‚ç”±è‡ªå®šä¹‰è¿‡æ»¤å™¨å‘ç°çš„ç»„ä»¶)ï¼Œåˆ™é»˜è®¤beanåç§°ç”Ÿæˆå™¨å°†è¿”å›æœªå¤§å†™çš„éé™å®šç±»åã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ£€æµ‹åˆ°ä»¥ä¸‹ç»„ä»¶ç±»ï¼Œå…¶åç§°å°†æ˜¯myMovieListerå’ŒmovieFinderImpl:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Service(&amp;quot;myMovieLister&amp;quot;)
public class SimpleMovieLister {
    // ...
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;@Repository
public class MovieFinderImpl implements MovieFinder {
    // ...
}
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;If you do not want to rely on the default bean-naming strategy, you can provide a custom bean-naming strategy. First, implement the BeanNameGenerator interface, and be sure to include a default no-arg constructor. Then, provide the fully qualified class name when configuring the scanner, as the following example annotation and bean definition show.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¦‚æœä¸å¸Œæœ›ä¾èµ–é»˜è®¤çš„ bean å‘½åç­–ç•¥ï¼Œå¯ä»¥æä¾›è‡ªå®šä¹‰ bean å‘½åç­–ç•¥ã€‚é¦–å…ˆï¼Œå®ç°BeanNameGenerator æ¥å£ï¼Œå¹¶ç¡®ä¿åŒ…å«ä¸€ä¸ªé»˜è®¤çš„æ— å‚æ•°æ„é€ å‡½æ•°ã€‚ç„¶åï¼Œåœ¨é…ç½®æ‰«æç¨‹åºæ—¶æä¾›å®Œå…¨é™å®šçš„ç±»åï¼Œå¦‚ä¸‹é¢çš„æ³¨é‡Šå’Œ bean å®šä¹‰ç¤ºä¾‹æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœç”±äºå¤šä¸ªè‡ªåŠ¨æ£€æµ‹åˆ°çš„ç»„ä»¶å…·æœ‰ç›¸åŒçš„éé™å®šç±»å(å³æ‚¨å¯èƒ½éœ€è¦é…ç½®ä¸€ä¸ªBeanNameGeneratorï¼Œè¯¥ç”Ÿæˆå™¨é»˜è®¤ä¸ºç”Ÿæˆçš„beanåç§°çš„å®Œå…¨é™å®šç±»åã€‚ä»Spring Framework 5.2.3å¼€å§‹ï¼ŒFullyQualifiedAnnotationBeanNameGeneratorä½äºåŒ…org.springframework.contextä¸­ã€‚æ³¨é‡Šå¯ä»¥ç”¨äºè¿™äº›ç›®çš„ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Configuration
@ComponentScan(basePackages = &amp;quot;org.example&amp;quot;, nameGenerator = MyNameGenerator.class)
public class AppConfig {
    // ...
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;beans&amp;gt;
    &amp;lt;context:component-scan base-package=&amp;quot;org.example&amp;quot;
        name-generator=&amp;quot;org.example.MyNameGenerator&amp;quot; /&amp;gt;
&amp;lt;/beans&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;springæ‡’åŠ è½½&#34;&gt;springæ‡’åŠ è½½&lt;/h1&gt;
&lt;p&gt;å®˜ç½‘å·²ç»è§£é‡Šçš„éå¸¸æ¸…æ¥šäº†ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-factory-lazy-init&#34;&gt;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-factory-lazy-init&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;By default, ApplicationContext implementations eagerly create and configure all singleton beans as part of the initialization process. Generally, this pre-instantiation is desirable, because errors in the configuration or surrounding environment are discovered immediately, as opposed to hours or even days later. When this behavior is not desirable, you can prevent pre-instantiation of a singleton bean by marking the bean definition as being lazy-initialized. A lazy-initialized bean tells the IoC container to create a bean instance when it is first requested, rather than at startup.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é»˜è®¤æƒ…å†µä¸‹ï¼ŒApplicationContextå®ç°å°†åˆ›å»ºå’Œé…ç½®æ‰€æœ‰çš„å•ä¾‹ bean ä½œä¸ºåˆå§‹åŒ–è¿‡ç¨‹çš„ä¸€éƒ¨åˆ†ã€‚é€šå¸¸ï¼Œè¿™ç§é¢„å®ä¾‹åŒ–æ˜¯å¯å–çš„ï¼Œå› ä¸ºé…ç½®æˆ–å‘¨å›´ç¯å¢ƒä¸­çš„é”™è¯¯ä¼šç«‹å³è¢«å‘ç°ï¼Œè€Œä¸æ˜¯å‡ å°æ—¶ç”šè‡³å‡ å¤©ä¹‹åã€‚å½“æ­¤è¡Œä¸ºä¸å¯å–æ—¶ï¼Œæ‚¨å¯ä»¥é€šè¿‡å°† bean å®šä¹‰æ ‡è®°ä¸ºå»¶è¿Ÿåˆå§‹åŒ–æ¥é˜²æ­¢å•ä¾‹ bean çš„é¢„å®ä¾‹åŒ–ã€‚å»¶è¿Ÿåˆå§‹åŒ–çš„bean å‘Šè¯‰ IoC å®¹å™¨åœ¨ç¬¬ä¸€æ¬¡è¯·æ±‚æ—¶åˆ›å»º bean å®ä¾‹ï¼Œè€Œä¸æ˜¯åœ¨å¯åŠ¨æ—¶ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;bean id=&amp;quot;lazy&amp;quot; class=&amp;quot;com.something.ExpensiveToCreateBean&amp;quot; lazy-init=&amp;quot;true&amp;quot;/&amp;gt;
&amp;lt;bean name=&amp;quot;not.lazy&amp;quot; class=&amp;quot;com.something.AnotherBean&amp;quot;/&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ &lt;beans/&gt; å…ƒç´ ä¸Šçš„ default-lazy-init å±æ€§æ¥æ§åˆ¶å®¹å™¨çº§åˆ«çš„å»¶è¿Ÿåˆå§‹åŒ–ï¼Œå¦‚ä¸‹é¢çš„ç¤ºä¾‹æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://images-cdn.shimo.im/AL7NwUqEre0woKxB/image.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h1 id=&#34;springbeançš„ä½œç”¨åŸŸ&#34;&gt;springbeançš„ä½œç”¨åŸŸ&lt;/h1&gt;
&lt;p&gt;æ–‡æ¡£å‚è€ƒï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-factory-scopes&#34;&gt;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-factory-scopes&lt;/a&gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/SpringBean%E4%BD%9C%E7%94%A8%E5%9F%9F.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;singleton&#34;&gt;singleton&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Service@Scope(&amp;quot;singleton&amp;quot;)
public class IndexService {
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æµ‹è¯•ç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;com.ssm.service.IndexService@5884a914
IndexDaoImpl...2
com.ssm.service.IndexService@5884a914
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸¤æ¬¡è·å¾—åˆ°çš„ Service å¯¹è±¡æ˜¯åŒä¸€ä¸ªå®ä¾‹ï¼šå•ä¾‹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;prototype&#34;&gt;prototype&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Service
@Scope(&amp;quot;prototype&amp;quot;)
public class IndexService {
    @Autowired
    private IndexDao indexDaoImpl2;
    public void service(){
        indexDaoImpl2.test();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æµ‹è¯•&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) {
        // AnnotationConfigApplicationContextï¼šæ³¨è§£é…ç½®åº”ç”¨ç¨‹åº
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(SpringConfig.class);
        IndexService service = (IndexService) context.getBean(&amp;quot;indexService&amp;quot;);
        System.out.println(service);
        service.service();
        service = (IndexService) context.getBean(&amp;quot;indexService&amp;quot;);
        System.out.println(service);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;com.ssm.service.IndexService@5884a914
IndexDaoImpl...2
com.ssm.service.IndexService@50378a4
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸¤æ¬¡å¾—åˆ°çš„ Service å¯¹è±¡æ˜¯ä¸¤ä¸ªå¯¹è±¡ï¼šå¤šä¾‹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;xmlå®šä¹‰æ–¹å¼&#34;&gt;xmlå®šä¹‰æ–¹å¼&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;bean id=&amp;quot;accountService&amp;quot; class=&amp;quot;com.something.DefaultAccountService&amp;quot; scope=&amp;quot;singleton&amp;quot;/&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;annotationçš„å®šä¹‰æ–¹å¼&#34;&gt;annotationçš„å®šä¹‰æ–¹å¼&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Service
@Scope(&amp;quot;prototype&amp;quot;)
public class IndexService {
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;singleton-beans-with-prototype-bean-dependencies&#34;&gt;Singleton Beans with Prototype-bean Dependencies&lt;/h2&gt;
&lt;p&gt;æ„æ€æ˜¯åœ¨ Singleton å½“ä¸­å¼•ç”¨äº†ä¸€ä¸ª Prototype çš„ bean çš„æ—¶å€™å¼•å‘çš„é—®é¢˜ï¼š&lt;/p&gt;
&lt;p&gt;åœ¨å•ä¾‹å¯¹è±¡ä¸­å¼•ç”¨å¤šä¾‹ beanï¼Œè¿™ä¸ªå¤šä¾‹ bean å°±å¤±å»äº†æ„ä¹‰ã€‚&lt;/p&gt;
&lt;p&gt;1ã€IndexService å•ä¾‹&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Service
@Scope(&amp;quot;singleton&amp;quot;)
public class IndexService {
    @Autowired
    private IndexDao indexDao;
    public void service(){
        System.out.println(this);
        System.out.println(indexDao);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€IndexDao å¤šä¾‹&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Repository
@Scope(&amp;quot;prototype&amp;quot;)
public class IndexDaoImpl implements IndexDao {
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3ã€æµ‹è¯•&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) {
        // AnnotationConfigApplicationContextï¼šæ³¨è§£é…ç½®åº”ç”¨ç¨‹åº
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(SpringConfig.class);
        IndexService service = (IndexService) context.getBean(&amp;quot;indexService&amp;quot;);
        service.service();
        System.out.println(&amp;quot; - - - - - - - - - &amp;quot;);
        service = (IndexService) context.getBean(&amp;quot;indexService&amp;quot;);
        service.service();
        System.out.println(&amp;quot; - - - - - - - - - &amp;quot;);
        service = (IndexService) context.getBean(&amp;quot;indexService&amp;quot;);
        service.service();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;4ã€ç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;com.ssm.service.IndexService@4d14b6c2
com.ssm.dao.impl.IndexDaoImpl@7e990ed7
 - - - - - - - - - 
com.ssm.service.IndexService@4d14b6c2
com.ssm.dao.impl.IndexDaoImpl@7e990ed7
 - - - - - - - - - 
com.ssm.service.IndexService@4d14b6c2
com.ssm.dao.impl.IndexDaoImpl@7e990ed7
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;5ã€åˆ†æï¼š&lt;/p&gt;
&lt;p&gt;è™½ç„¶ IndexDaoImpl æ˜¯å¤šä¾‹çš„ï¼Œä½†æ˜¯ IndexDaoImpl æ˜¯ IndexService çš„ä¸€ä¸ªå±æ€§ï¼Œè€Œ IndexService æ˜¯å•ä¾‹çš„ï¼Œå°±é€ æˆäº†æ¯æ¬¡æ‰“å°çš„ IndexDaoImpl éƒ½æ˜¯ä¸€æ ·çš„ã€‚&lt;/p&gt;
&lt;p&gt;è§£å†³æ–¹æ¡ˆä¸€ï¼š&lt;/p&gt;
&lt;p&gt;1ã€é€šè¿‡å®ç° applicationcontext - ware æ¥å£ï¼Œå¹¶åœ¨æ¯æ¬¡ bean A éœ€è¦æ—¶è°ƒç”¨å®¹å™¨çš„ getBean(â€œBâ€) æ¥è¯·æ±‚(é€šå¸¸æ˜¯ä¸€ä¸ªæ–°çš„)bean Bå®ä¾‹ï¼Œä»è€Œä½¿ bean A çŸ¥é“å®¹å™¨ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Service
@Scope(&amp;quot;singleton&amp;quot;)
public class IndexService implements ApplicationContextAware {
    @Autowired
    private IndexDao indexDao;
    private ApplicationContext applicationContext;
    @Override
    public void setApplicationContext(ApplicationContext applicationContext) throws BeansException {
        this.applicationContext = applicationContext;
    }
    public void service(){
        System.out.println(this);
       System.out.println(applicationContext.getBean(&amp;quot;indexDaoImpl&amp;quot;));
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€æµ‹è¯•ç»“æœ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;com.ssm.service.IndexService@50378a4
com.ssm.dao.impl.IndexDaoImpl@60f00693
 - - - - - - - - - 
com.ssm.service.IndexService@50378a4
com.ssm.dao.impl.IndexDaoImpl@79207381
 - - - - - - - - - 
com.ssm.service.IndexService@50378a4
com.ssm.dao.impl.IndexDaoImpl@491b9b8
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3ã€åˆ†æï¼šå•ä¾‹ IndexService å†…å¼•ç”¨å¤šä¾‹çš„ IndexDaoImplï¼Œå¤šæ¬¡è·å– IndexDaoImplï¼Œæ‰“å°çš„æ˜¯ä¸åŒå€¼ã€‚&lt;/p&gt;
&lt;p&gt;è§£å†³æ–¹æ¡ˆäºŒï¼šLookup Method Injection&lt;/p&gt;
&lt;p&gt;1ã€ä½¿ç”¨ @Lookup æ³¨è§£&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Service
@Scope(&amp;quot;singleton&amp;quot;)
public abstract class IndexService {
    @Lookup
    public abstract IndexDao getIndexDao() ;
    public void service(){
        System.out.println(this);
        System.out.println(getIndexDao());
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€æµ‹è¯•ç»“æœ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;com.ssm.service.IndexService$$EnhancerBySpringCGLIB$$8432b830@6b09fb41
com.ssm.dao.impl.IndexDaoImpl@6f43c82
 - - - - - - - - - 
com.ssm.service.IndexService$$EnhancerBySpringCGLIB$$8432b830@6b09fb41
com.ssm.dao.impl.IndexDaoImpl@5db6b9cd
 - - - - - - - - - 
com.ssm.service.IndexService$$EnhancerBySpringCGLIB$$8432b830@6b09fb41
com.ssm.dao.impl.IndexDaoImpl@210ab13f
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3ã€åˆ†æï¼šå•ä¾‹ IndexService å†…å¼•ç”¨å¤šä¾‹çš„ IndexDaoImplï¼Œå¤šæ¬¡è·å– IndexDaoImplï¼Œæ‰“å°çš„æ˜¯ä¸åŒå€¼ã€‚&lt;/p&gt;
&lt;p&gt;å®˜ç½‘å¼•å¯¼æˆ‘ä»¬å‚è€ƒ&lt;a href=&#34;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-factory-method-injection&#34;&gt;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-factory-method-injection&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;In most application scenarios, most beans in the container areÂ singletons. When a singleton bean needs to collaborate with another singleton bean or a non-singleton bean needs to collaborate with another non-singleton bean, you typically handle the dependency by defining one bean as a property of the other. A problem arises when the bean lifecycles are different. Suppose singleton bean A needs to use non-singleton (prototype) bean B, perhaps on each method invocation on A. The container creates the singleton bean A only once, and thus only gets one opportunity to set the properties. The container cannot provide bean A with a new instance of bean B every time one is needed.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åœ¨å¤§å¤šæ•°åº”ç”¨ç¨‹åºåœºæ™¯ä¸­ï¼Œå®¹å™¨ä¸­çš„å¤§å¤šæ•° bean éƒ½æ˜¯å•ä¾‹çš„ã€‚å½“ä¸€ä¸ªå•ä¾‹ bean éœ€è¦ä¸å¦ä¸€ä¸ªå•ä¾‹ bean åä½œï¼Œæˆ–è€… ä¸€ä¸ªéå•ä¾‹ bean éœ€è¦ä¸å¦ä¸€ä¸ªéå•ä¾‹ bean åä½œæ—¶ï¼Œé€šå¸¸é€šè¿‡å°†ä¸€ä¸ªbean å®šä¹‰ä¸ºå¦ä¸€ä¸ª bean çš„å±æ€§æ¥å¤„ç†ä¾èµ–æ€§ã€‚å½“ bean çš„ç”Ÿå‘½å‘¨æœŸä¸åŒæ—¶ï¼Œå°±ä¼šå‡ºç°é—®é¢˜ã€‚å‡è®¾å•ä¾‹ bean A éœ€è¦ä½¿ç”¨éå•ä¾‹(åŸå‹) bean Bï¼Œå¯èƒ½æ˜¯åœ¨ A çš„æ¯ä¸ªæ–¹æ³•è°ƒç”¨ä¸Šã€‚&lt;strong&gt;å®¹å™¨åªåˆ›å»ºä¸€æ¬¡å•ä¾‹bean A&lt;/strong&gt;ï¼Œå› æ­¤åªæœ‰ä¸€æ¬¡æœºä¼šæ¥è®¾ç½®å±æ€§ã€‚å®¹å™¨ä¸èƒ½æ¯æ¬¡éœ€è¦ bean B çš„æ–°å®ä¾‹æ—¶éƒ½å‘ bean A æä¾›ä¸€ä¸ªã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;A solution is to forego some inversion of control. You canÂ make bean A aware of the containerÂ by implementing theÂ ApplicationContextAwareÂ interface, and byÂ making aÂ getBean(&amp;quot;B&amp;quot;)Â call to the containerÂ ask for (a typically new) bean B instance every time bean A needs it. The following example shows this approach:&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è§£å†³çš„åŠæ³•æ˜¯æ”¾å¼ƒä¸€äº›æ§åˆ¶åè½¬ã€‚æ‚¨å¯ä»¥é€šè¿‡å®ç° applicationcontext - ware æ¥å£ï¼Œå¹¶åœ¨æ¯æ¬¡ bean A éœ€è¦æ—¶è°ƒç”¨å®¹å™¨çš„ getBean(â€œBâ€) æ¥è¯·æ±‚(é€šå¸¸æ˜¯ä¸€ä¸ªæ–°çš„)bean Bå®ä¾‹ï¼Œä»è€Œä½¿ bean A çŸ¥é“å®¹å™¨ã€‚ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†è¿™ç§æ–¹æ³•:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// a class that uses a stateful Command-style class to perform some processing
package fiona.apple;

// Spring-API imports
import org.springframework.beans.BeansException;
import org.springframework.context.ApplicationContext;
import org.springframework.context.ApplicationContextAware;

public class CommandManager implements ApplicationContextAware {

    private ApplicationContext applicationContext;

    public Object process(Map commandState) {
        // grab a new instance of the appropriate Command
        Command command = createCommand();
        // set the state on the (hopefully brand new) Command instance
        command.setState(commandState);
        return command.execute();
    }

    protected Command createCommand() {
        // notice the Spring API dependency!
        return this.applicationContext.getBean(&amp;quot;command&amp;quot;, Command.class);
    }

    public void setApplicationContext(
            ApplicationContext applicationContext) throws BeansException {
        this.applicationContext = applicationContext;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;spring-ç”Ÿå‘½å‘¨æœŸçš„å›è°ƒ&#34;&gt;Spring ç”Ÿå‘½å‘¨æœŸçš„å›è°ƒ&lt;/h1&gt;
&lt;h2 id=&#34;spring-ç”Ÿå‘½å‘¨æœŸçš„å›è°ƒçš„å®ç°æ–¹æ³•&#34;&gt;Spring ç”Ÿå‘½å‘¨æœŸçš„å›è°ƒçš„å®ç°æ–¹æ³•ï¼š&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Initialization Callbacks AND Destruction Callbacks&lt;br&gt;
The org.springframework.beans.factory.InitializingBean interface lets a bean perform initialization work after the container has set all necessary properties on the bean. The InitializingBean interface specifies a single method:&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;org.springframework.beans.factory.InitializingBean æ¥å£å…è®¸ bean åœ¨å®¹å™¨è®¾ç½®äº† bean ä¸Šæ‰€æœ‰å¿…éœ€çš„å±æ€§ä¹‹åæ‰§è¡Œåˆå§‹åŒ–å·¥ä½œã€‚InitializingBean æ¥å£æŒ‡å®šäº†ä¸€ä¸ªæ–¹æ³•:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;void afterPropertiesSet() throws Exception;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;1ã€åˆ›å»ºä¸€ä¸ª Dao æ¥å£&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public interface IndexDao {
    void test();
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€æ¥å£å®ç°ç±»ï¼Œå®ç° InitializingBean æ¥å£ï¼Œåœ¨è°ƒç”¨æ„é€ æ–¹æ³•åå›è°ƒ afterPropertiesSet&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Repository
public class IndexDaoImpl implements IndexDao, InitializingBean {
    public IndexDaoImpl(){
        System.out.println(&amp;quot;IndexDaoImpl...Constructor&amp;quot;);
    }
    @Override
    public void afterPropertiesSet() throws Exception {
        System.out.println(&amp;quot;IndexDaoImpl...init&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3ã€æµ‹è¯•&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) {
        // AnnotationConfigApplicationContextï¼šæ³¨è§£é…ç½®åº”ç”¨ç¨‹åº
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(SpringConfig.class);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;4ã€æµ‹è¯•ç»“æœ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;IndexDaoImpl...Constructor
IndexDaoImpl...init
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;5ã€åˆ†æ&lt;br&gt;
åœ¨è°ƒç”¨æ„é€ æ–¹æ³•åˆå§‹åŒ–æ—¶å›è°ƒ afterPropertiesSet æ–¹æ³•ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Implementing the org.springframework.beans.factory.DisposableBean interface lets a bean get a callback when the container that contains it is destroyed. The DisposableBean interface specifies a single method:&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å®ç° org.springframework.beans.factory.DisposableBean æ¥å£ï¼Œå½“åŒ…å«å®ƒçš„å®¹å™¨è¢«é”€æ¯æ—¶ï¼Œå¯å¤„ç½®bean æ¥å£è®© bean è·å¾—ä¸€ä¸ªå›è°ƒã€‚å¯å¤„ç½® bean æ¥å£æŒ‡å®šäº†ä¸€ä¸ªæ–¹æ³•:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;void destroy() throws Exception;
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Repository
public class IndexDaoImpl implements IndexDao, DisposableBean {
    @Override
    public void destroy() throws Exception {
        System.out.println(&amp;quot;IndexDaoImpl...destory&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;default-initialization-and-destroy-methods&#34;&gt;Default Initialization and Destroy Methods&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;When you write initialization and destroy method callbacks that do not use the Spring-specific InitializingBean and DisposableBean callback interfaces, you typically write methods with names such as init(), initialize(), dispose(), and so on. Ideally, the names of such lifecycle callback methods are standardized across a project so that all developers use the same method names and ensure consistency.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å½“æ‚¨ç¼–å†™ä¸ä½¿ç”¨ç‰¹å®šäº spring çš„ InitializingBean å’Œ DisposableBean å›è°ƒæ¥å£çš„åˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³•å›è°ƒæ—¶ï¼Œæ‚¨é€šå¸¸ä¼šç¼–å†™å…·æœ‰ init()ã€initialize()ã€dispose() ç­‰åç§°çš„æ–¹æ³•ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œè¿™æ ·çš„ç”Ÿå‘½å‘¨æœŸå›è°ƒæ–¹æ³•çš„åç§°åœ¨æ•´ä¸ªé¡¹ç›®ä¸­æ˜¯æ ‡å‡†åŒ–çš„ï¼Œè¿™æ ·æ‰€æœ‰å¼€å‘äººå‘˜éƒ½å¯ä»¥ä½¿ç”¨ç›¸åŒçš„æ–¹æ³•åç§°å¹¶ç¡®ä¿ä¸€è‡´æ€§ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;You can configure the Spring container to â€œlookâ€ for named initialization and destroy callback method names on every bean. This means that you, as an application developer, can write your application classes and use an initialization callback called init(), without having to configure an init-method=&amp;quot;init&amp;quot; attribute with each bean definition. The Spring IoC container calls that method when the bean is created (and in accordance with the standard lifecycle callback contract described previously). This feature also enforces a consistent naming convention for initialization and destroy method callbacks.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ‚¨å¯ä»¥å°† Spring å®¹å™¨é…ç½®ä¸ºåœ¨æ¯ä¸ªbeanä¸Šâ€œæŸ¥æ‰¾â€åä¸º initialization å’Œ destroy çš„å›è°ƒæ–¹æ³•åã€‚è¿™æ„å‘³ç€ï¼Œä½œä¸ºåº”ç”¨ç¨‹åºå¼€å‘äººå‘˜ï¼Œæ‚¨å¯ä»¥ç¼–å†™åº”ç”¨ç¨‹åºç±»å¹¶ä½¿ç”¨åä¸º init() çš„åˆå§‹åŒ–å›è°ƒï¼Œè€Œä¸å¿…ä¸ºæ¯ä¸ªbean å®šä¹‰é…ç½® init-method=&amp;quot;init&amp;quot; å±æ€§ã€‚åœ¨åˆ›å»ºbeanæ—¶ï¼ŒSpring IoC å®¹å™¨è°ƒç”¨è¯¥æ–¹æ³•(å¹¶æ ¹æ®å‰é¢æè¿°çš„æ ‡å‡†ç”Ÿå‘½å‘¨æœŸå›è°ƒå¥‘çº¦)ã€‚è¯¥ç‰¹æ€§è¿˜å¼ºåˆ¶å¯¹åˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³•å›è°ƒä½¿ç”¨ä¸€è‡´çš„å‘½åçº¦å®šã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Suppose that your initialization callback methods are named init() and your destroy callback methods are named destroy(). Your class then resembles the class in the following example:&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å‡è®¾æ‚¨çš„åˆå§‹åŒ–å›è°ƒæ–¹æ³•å‘½åä¸ºinit()ï¼Œè€Œé”€æ¯å›è°ƒæ–¹æ³•å‘½åä¸ºdestroy()ã€‚ä½ çš„ç±»ç±»ä¼¼äºä¸‹é¢ä¾‹å­ä¸­çš„ç±»:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class DefaultBlogService implements BlogService {

    private BlogDao blogDao;

    public void setBlogDao(BlogDao blogDao) {
        this.blogDao = blogDao;
    }

    // this is (unsurprisingly) the initialization callback method
    public void init() {
        if (this.blogDao == null) {
            throw new IllegalStateException(&amp;quot;The [blogDao] property must be set.&amp;quot;);
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç„¶åä½ å¯ä»¥åœ¨ä¸€ä¸ªç±»ä¼¼å¦‚ä¸‹çš„beanä¸­ä½¿ç”¨è¿™ä¸ªç±»:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;beans default-init-method=&amp;quot;init&amp;quot;&amp;gt;

    &amp;lt;bean id=&amp;quot;blogService&amp;quot; class=&amp;quot;com.something.DefaultBlogService&amp;quot;&amp;gt;
        &amp;lt;property name=&amp;quot;blogDao&amp;quot; ref=&amp;quot;blogDao&amp;quot; /&amp;gt;
    &amp;lt;/bean&amp;gt;
&amp;lt;/beans&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;combining-lifecycle-mechanisms&#34;&gt;Combining Lifecycle Mechanisms&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;As of Spring 2.5, you have three options for controlling bean lifecycle behavior:&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä»spring2.5å¼€å§‹ï¼Œä½ æœ‰ä¸‰ä¸ªæ§åˆ¶beanç”Ÿå‘½å‘¨æœŸè¡Œä¸ºçš„é€‰é¡¹:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The InitializingBean and DisposableBean callback interfaces&lt;/li&gt;
&lt;li&gt;Custom init() and destroy() methods&lt;/li&gt;
&lt;li&gt;The @PostConstruct and @PreDestroy annotations. You can combine these mechanisms to control a given bean.&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@PostConstruct
public void init(){
    System.out.println(&amp;quot;IndexDaoImpl...init&amp;quot;);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½¿ç”¨ä¸åŒçš„åˆå§‹åŒ–æ–¹æ³•ä¸ºåŒä¸€ä¸ªbeané…ç½®å¤šä¸ªç”Ÿå‘½å‘¨æœŸæœºåˆ¶ï¼Œè°ƒç”¨æ–¹æ³•å¦‚ä¸‹:&lt;br&gt;
1ã€Methods annotated with @PostConstruct&lt;br&gt;
2ã€afterPropertiesSet() as defined by the InitializingBean callback interface&lt;br&gt;
3ã€A custom configured init() method&lt;/p&gt;
&lt;h1 id=&#34;å…¶ä»–&#34;&gt;å…¶ä»–&lt;/h1&gt;
&lt;h2 id=&#34;using-filters-to-customize-scanning&#34;&gt;Using Filters to Customize Scanning&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-scanning-filters&#34;&gt;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-scanning-filters&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// è¡¨æ˜è¿™æ˜¯ä¸€ä¸ª xml æ–‡ä»¶
@Configuration
// æ³¨è§£æ‰«æåŒ…
@ComponentScan(value = &amp;quot;com.ssm&amp;quot;,excludeFilters = {@ComponentScan.Filter(type = FilterType.REGEX, pattern = &amp;quot;com.ssm.service.*&amp;quot;)})
public class SpringConfig {
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æµ‹è¯•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class Test {
    public static void main(String[] args) {
        // AnnotationConfigApplicationContextï¼šæ³¨è§£é…ç½®åº”ç”¨ç¨‹åº
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(SpringConfig.class);
        IndexService indexService = (IndexService) context.getBean(&amp;quot;indexService&amp;quot;);
        indexService.service();

    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Exception in thread &amp;quot;main&amp;quot; org.springframework.beans.factory.NoSuchBeanDefinitionException: No bean named &#39;indexService&#39; available&lt;br&gt;
åˆ†æï¼šè‡ªå®šä¹‰æ‰«æè¿‡æ»¤ com.ssm.service.* ï¼Œäºæ˜¯æ— æ³•æ‰«æåˆ° IndexServiceï¼Œå› æ­¤æŠ¥é”™æ²¡æœ‰åä¸º indexService çš„ beanã€‚&lt;/p&gt;
&lt;h2 id=&#34;providing-qualifier-metadata-with-annotations&#34;&gt;Providing Qualifier Metadata with Annotations&lt;/h2&gt;
&lt;p&gt;1ã€å½“æœ‰ä¸¤ä¸ª IndexDao çš„å®ç°ç±»æ—¶ï¼Œ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Repository
public class IndexDaoImpl implements IndexDao{
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Repository
public class IndexDaoImpl2 implements IndexDao {
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€Service ç±»ä½¿ç”¨ @Autowired æ³¨å…¥ IndexDao&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Service
public class IndexService {
    @Autowired
    IndexDao indexDao;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3ã€è¿è¡ŒæŠ¥é”™&lt;br&gt;
Caused by: org.springframework.beans.factory.NoUniqueBeanDefinitionException: No qualifying bean of type &#39;com.ssm.dao.IndexDao&#39; available: expected single matching bean but found 2: indexDaoImpl,indexDaoImpl2&lt;br&gt;
4ã€åˆ†æ&lt;br&gt;
@Autowired é»˜è®¤ä½¿ç”¨ byType æ³¨å…¥ï¼Œç»“æœå‘ç°äº†ä¸¤ä¸ª IndexDaoï¼šIndexDaoImplã€IndexDaoImpl2ï¼Œæ³¨å…¥å¤±è´¥ï¼›äºæ˜¯é‡‡ç”¨ byName æ³¨å…¥ï¼ˆIndexDao indexDao;ï¼‰ï¼Œåœ¨ Spring å®¹å™¨ä¸­å¯»æ‰¾ name = indexDao çš„ï¼Œæ²¡æœ‰æ‰¾åˆ°ï¼ˆæœ‰åä¸º indexDaoImpl å’Œåä¸º indexDaoImpl2ï¼‰ï¼Œæ³¨å…¥å¤±è´¥ã€‚&lt;/p&gt;
&lt;h3 id=&#34;è§£å†³æ–¹æ¡ˆä¸€primary&#34;&gt;è§£å†³æ–¹æ¡ˆä¸€ï¼š@Primary&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Repository
@Primary
public class IndexDaoImpl implements IndexDao{
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å½“å‘ IndexDaoImpl ç±»åŠ å…¥ @Primary æ³¨è§£æ—¶ï¼Œé€šè¿‡ byType æ‰¾åˆ°ä¸¤ä¸ªï¼Œäºæ˜¯æ³¨å…¥ @Primary æ³¨è§£ä¿®é¥°çš„ç±» IndexDaoImplã€‚&lt;/p&gt;
&lt;h3 id=&#34;è§£å†³æ–¹æ¡ˆäºŒqualifier&#34;&gt;è§£å†³æ–¹æ¡ˆäºŒï¼š@Qualifier&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-scanning-qualifiers&#34;&gt;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-scanning-qualifiers&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;@Service
public class IndexService {

    @Autowired
    @Qualifier(&amp;quot;indexDaoImpl2&amp;quot;)
    IndexDao indexDao;
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;using-the-bean-annotation&#34;&gt;Using the @Bean Annotation&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-java-bean-annotation&#34;&gt;https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-java-bean-annotation&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;@Bean is a method-level annotation and a direct analog of the XML &lt;bean/&gt; element. The annotation supports some of the attributes offered by &lt;bean/&gt;, such as: * init-method * destroy-method * autowiring * name.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;@Beanæ˜¯æ–¹æ³•çº§åˆ«çš„æ³¨é‡Šï¼Œæ˜¯XML &lt;bean/&gt;å…ƒç´ çš„ç›´æ¥æ¨¡æ‹Ÿã€‚æ³¨é‡Šæ”¯æŒ&lt;bean/&gt;æä¾›çš„ä¸€äº›å±æ€§ï¼Œæ¯”å¦‚:* init-method * destroy-method * autowiring * nameã€‚&lt;br&gt;
1ã€pom.xml&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;dependencies&amp;gt;
  &amp;lt;!-- spring-ioc --&amp;gt;
  &amp;lt;dependency&amp;gt;
    &amp;lt;groupId&amp;gt;org.springframework&amp;lt;/groupId&amp;gt;
    &amp;lt;artifactId&amp;gt;spring-context&amp;lt;/artifactId&amp;gt;
    &amp;lt;version&amp;gt;5.0.9.RELEASE&amp;lt;/version&amp;gt;
  &amp;lt;/dependency&amp;gt;

  &amp;lt;!-- mybatis --&amp;gt;
  &amp;lt;dependency&amp;gt;
    &amp;lt;groupId&amp;gt;org.mybatis&amp;lt;/groupId&amp;gt;
    &amp;lt;artifactId&amp;gt;mybatis&amp;lt;/artifactId&amp;gt;
    &amp;lt;version&amp;gt;3.4.6&amp;lt;/version&amp;gt;
  &amp;lt;/dependency&amp;gt;

  &amp;lt;!-- spring-mybatis --&amp;gt;
  &amp;lt;dependency&amp;gt;
    &amp;lt;groupId&amp;gt;org.mybatis&amp;lt;/groupId&amp;gt;
    &amp;lt;artifactId&amp;gt;mybatis-spring&amp;lt;/artifactId&amp;gt;
    &amp;lt;version&amp;gt;1.3.2&amp;lt;/version&amp;gt;
  &amp;lt;/dependency&amp;gt;

  &amp;lt;!-- Spring æ•°æ®æº --&amp;gt;
  &amp;lt;dependency&amp;gt;
    &amp;lt;groupId&amp;gt;org.springframework&amp;lt;/groupId&amp;gt;
    &amp;lt;artifactId&amp;gt;spring-jdbc&amp;lt;/artifactId&amp;gt;
    &amp;lt;version&amp;gt;5.0.8.RELEASE&amp;lt;/version&amp;gt;
  &amp;lt;/dependency&amp;gt;

  &amp;lt;!-- mysql --&amp;gt;
  &amp;lt;dependency&amp;gt;
    &amp;lt;groupId&amp;gt;mysql&amp;lt;/groupId&amp;gt;
    &amp;lt;artifactId&amp;gt;mysql-connector-java&amp;lt;/artifactId&amp;gt;
    &amp;lt;version&amp;gt;5.1.6&amp;lt;/version&amp;gt;
  &amp;lt;/dependency&amp;gt;

&amp;lt;/dependencies&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€@Bean æ³¨è§£çš„ä½¿ç”¨&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;// è¡¨æ˜è¿™æ˜¯ä¸€ä¸ª xml æ–‡ä»¶
@Configuration
// æ³¨è§£æ‰«æåŒ…
@ComponentScan(&amp;quot;com.ssm&amp;quot;)
public class SpringConfig {

    @Bean
    public DataSource dataSource(){
        DriverManagerDataSource dataSource = new DriverManagerDataSource();
        dataSource.setDriverClassName(&amp;quot;com.mysql.jdbc.Driver&amp;quot;);
        dataSource.setUsername(&amp;quot;root&amp;quot;);
        dataSource.setPassword(&amp;quot;123456&amp;quot;);
        dataSource.setUrl(&amp;quot;jdbc:mysql://localhost:3306/test&amp;quot;);
        return dataSource;
    }

    @Bean
    public SqlSessionFactoryBean sqlSessionFactoryBean(DataSource dataSource){
        SqlSessionFactoryBean sqlSessionFactoryBean =  new SqlSessionFactoryBean();
        sqlSessionFactoryBean.setDataSource(dataSource);
        return sqlSessionFactoryBean;
    }
}
&lt;/code&gt;&lt;/pre&gt;
">Springç³»åˆ—ï¼ˆä¸€ï¼‰Spring IoC åº”ç”¨</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/java-bing-fa-cas-he-aqs/"" data-c="
          &lt;ul&gt;
&lt;li&gt;å¤šçº¿ç¨‹
&lt;ul&gt;
&lt;li&gt;Synchronized Volatileå•ä¾‹&lt;/li&gt;
&lt;li&gt;é”ï¼šå°é”ã€‚
&lt;ul&gt;
&lt;li&gt;æ‚²è§‚é”ã€å†™ï¼ˆå¢åˆ æ”¹ï¼‰å¤šï¼Œè¯»ï¼ˆæŸ¥ï¼‰å°‘Lock&lt;/li&gt;
&lt;li&gt;ä¹è§‚é”ï¼šè¯»ï¼ˆæŸ¥ï¼‰å¤šã€å†™å°‘ç‰ˆæœ¬&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;1.5 JUC&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;ä¸€-cas&#34;&gt;ä¸€ã€CAS&lt;/h1&gt;
&lt;h2 id=&#34;1-æ¦‚å¿µ&#34;&gt;1. æ¦‚å¿µ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;CompareAndSetï¼šæ¯”è¾ƒå’Œè®¾ç½®&lt;/li&gt;
&lt;li&gt;CompareAndSwapï¼šæ¯”è¾ƒå’Œäº¤æ¢ã€‚ä¸€ç§æ— é”çš„åŸå­ç®—æ³•ï¼Œä¹è§‚é”ã€‚&lt;/li&gt;
&lt;li&gt;æ€æƒ³ï¼š
&lt;ul&gt;
&lt;li&gt;ç»™ä½ ä¸€ä¸ªæœŸæœ›å€¼ï¼Œä¸ç°æœ‰çš„å€¼æ¯”è¾ƒï¼Œå¦‚æœç›¸ç­‰åˆ™ä¿®æ”¹ï¼›å¦‚æœä¸ç›¸ç­‰ä»€ä¹ˆäº‹æƒ…éƒ½ä¸åšã€‚&lt;/li&gt;
&lt;li&gt;CAS(V,E,N)
&lt;ul&gt;
&lt;li&gt;Vï¼šç›®å‰æ‹¿åˆ°çš„å€¼&lt;/li&gt;
&lt;li&gt;Eï¼šæœŸæœ›å€¼&lt;/li&gt;
&lt;li&gt;Nï¼šæ–°å€¼&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;2-ä½œç”¨åŠä¼˜ç‚¹&#34;&gt;2. ä½œç”¨åŠä¼˜ç‚¹&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;CAS å®ç°ç¨å¾®å¤æ‚ï¼Œæ— é”ï¼Œä¸å­˜åœ¨é˜»å¡ï¼Œæé«˜äº†æ•ˆç‡ï¼ŒCPUçš„ååé‡é«˜ï¼Œæ€§èƒ½å¥½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;3-å®ä¾‹&#34;&gt;3. å®ä¾‹&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package luban;

public class CASDemo1 {

    private static volatile int m = 0;

    public static void increase(){
        m ++;
    }
    public static void main(String[] args){
        for (int i = 0; i &amp;lt; 20; i++) {
            new Thread(() -&amp;gt; {
                CASDemo1.increase();
            }).start();
        }
        System.out.println(m);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;16
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åˆ†æï¼š&lt;br&gt;
m++ ä¸å…·æœ‰åŸå­æ€§ã€‚&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹åï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package luban;

/**
 * volatile å˜é‡
 * join()
 */
public class CASDemo3 {

    private static volatile int m = 0;
    public static void increase(){
        m ++;
    }
    public static void main(String[] args) throws InterruptedException {
        Thread[] threads = new Thread[20];
        for (int i = 0; i &amp;lt; threads.length; i++) {
            threads[i] = new Thread(() -&amp;gt; {
                CASDemo3.increase();
            });
            threads[i].start();
            threads[i].join();
        }
        System.out.println(m);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/join.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;join()&lt;/p&gt;
&lt;p&gt;åæ±‡ç¼–ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;javap -c CASDemo3
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/i++.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;i++ ä¸‰æ­¥æ“ä½œ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package luban;

/**
 * AtomicInteger å˜é‡
 * join()
 */

import java.util.concurrent.atomic.AtomicInteger;

public class CASDemo2 {

    private static AtomicInteger atomicI = new AtomicInteger(0);

    public static void increastAtomic(){
        atomicI.incrementAndGet();
    }
    public static void main(String[] args) throws InterruptedException {
        Thread[] threads = new Thread[20];
        for (int i = 0; i &amp;lt; threads.length; i++) {
            threads[i] = new Thread(() -&amp;gt; {
                CASDemo2.increastAtomic();
            });
            threads[i].start();
            threads[i].join();// join()ï¼šåŠ å…¥ã€‚å½“å‰ threads[i] çº¿ç¨‹åŠ å…¥åˆ°çº¿ç¨‹ç»„ä¸­ï¼Œå½“å‰çº¿ç¨‹ç­‰å¾… threads[i]çº¿ç¨‹æ‰§è¡Œå®Œäº†ä¹‹åå†æ‰§è¡Œ
        }
        System.out.println(atomicI.get());
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åæ±‡ç¼–ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;javap -c CASDemo2
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/atomicI.incrementAndGet.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;atomicI.incrementAndGet() å®ç° i++ åªéœ€ä¸€æ­¥æ“ä½œ&lt;/p&gt;
&lt;h2 id=&#34;4-æ–¹æ³•æ‘˜è¦&#34;&gt;4. æ–¹æ³•æ‘˜è¦&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/atomic%E6%96%B9%E6%B3%95.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;java.util.concurrent.atomic&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/AtomicInteger%E6%96%B9%E6%B3%95.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;AtomicInteger æ–¹æ³•æ‘˜è¦&lt;/p&gt;
&lt;h2 id=&#34;5-åŸç†&#34;&gt;5. åŸç†&lt;/h2&gt;
&lt;p&gt;JUCä¸‹çš„atomicç±»éƒ½æ˜¯é€šè¿‡CASæ¥å®ç°çš„ï¼Œä¸‹é¢å°±ä»¥AtomicIntegerä¸ºä¾‹æ¥é˜è¿°CASçš„å®ç°ã€‚å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/AtomicInteger%E7%B1%BB.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;AtomicInteger ç±»&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/getUnsafe.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;JVM è°ƒç”¨åº•å±‚æŒ‡ä»¤å®ç° getUnsafe()&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/incrementAndGet.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;incrementAndGet() æ–¹æ³•&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;9&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/getAndAddInt.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;getAndAddInt() æ–¹æ³•&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public final native boolean compareAndSwapInt(Object var1, long var2, int var4, int var5);
// var1ï¼šç°åœ¨æ‹¿åˆ°çš„å€¼
// var2ï¼šæœŸæœ›çš„å€¼
// var4:æœ€ç»ˆæ”¹å˜çš„å€¼
// var5ï¼šæœ€åæ”¹å˜äº†çš„å€¼  
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ€»ç»“ï¼šCASçš„åŸå­æ€§æµç¨‹&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/Unsafe.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;Unsafe çš„è¿”å›å€¼æ˜¯ Atomic::cmpchg(x, addr, e)&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;10&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Unsafe_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;Atomic::cmpchg(jint exchange_value, volatile jint* dest, jint com)&lt;/p&gt;
&lt;p&gt;incrementAndGet -&amp;gt; unsafe.java -&amp;gt; unsafe.cpp -&amp;gt; æ±‡ç¼– cmpxchg&lt;/p&gt;
&lt;p&gt;éœ€è¦&lt;strong&gt;ç¡¬ä»¶æ”¯æŒ&lt;/strong&gt;æ±‡ç¼–æŒ‡ä»¤ cmpxchg&lt;/p&gt;
&lt;p&gt;Unsafeæ˜¯CASçš„æ ¸å¿ƒç±»ï¼ŒJavaæ— æ³•ç›´æ¥è®¿é—®åº•å±‚æ“ä½œç³»ç»Ÿï¼Œè€Œæ˜¯é€šè¿‡æœ¬åœ°ï¼ˆnativeï¼‰æ–¹æ³•æ¥è®¿é—®ã€‚ä¸è¿‡å°½ç®¡å¦‚æ­¤ï¼ŒJVMè¿˜æ˜¯å¼€äº†ä¸€ä¸ªåé—¨ï¼šUnsafeï¼Œå®ƒæä¾›äº†ç¡¬ä»¶çº§åˆ«çš„åŸå­æ“ä½œã€‚&lt;/p&gt;
&lt;h2 id=&#34;6-ç¼ºç‚¹&#34;&gt;6. ç¼ºç‚¹&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;æ— æ³•æ£€æµ‹åˆ°ä¸­é—´å€¼çš„å˜åŒ–ï¼šA(100) -&amp;gt; B(110) -&amp;gt; A(100)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;CASéœ€è¦æ£€æŸ¥æ“ä½œå€¼æœ‰æ²¡æœ‰å‘ç”Ÿæ”¹å˜ï¼Œå¦‚æœæ²¡æœ‰å‘ç”Ÿæ”¹å˜åˆ™æ›´æ–°ã€‚ä½†æ˜¯å­˜åœ¨è¿™æ ·ä¸€ç§æƒ…å†µï¼šå¦‚æœä¸€ä¸ªå€¼åŸæ¥æ˜¯Aï¼Œå˜æˆäº†Bï¼Œç„¶ååˆå˜æˆäº†Aï¼Œé‚£ä¹ˆåœ¨CASæ£€æŸ¥çš„æ—¶å€™ä¼šå‘ç°æ²¡æœ‰æ”¹å˜ï¼Œä½†æ˜¯å®è´¨ä¸Šå®ƒå·²ç»å‘ç”Ÿäº†æ”¹å˜ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„ABAé—®é¢˜ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package luban;
/**
 * æ— æ³•æ£€æµ‹åˆ°ä¸­é—´å€¼çš„å˜åŒ–
 */
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;
import java.util.concurrent.atomic.AtomicInteger;

public class CASDemo4 {

    private static AtomicInteger atomicI = new AtomicInteger(100);

    public static void main(String[] args){
        ExecutorService service = Executors.newCachedThreadPool();
        service.execute(() -&amp;gt; {
            System.out.println(&amp;quot;(1) 100 å˜ä¸º 110ï¼š&amp;quot; + atomicI.compareAndSet(100,110));
        });

        service.execute(() -&amp;gt; {
            try {
                TimeUnit.SECONDS.sleep(2);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            System.out.println(&amp;quot;(2) 110 å˜ä¸º 100ï¼š&amp;quot; + atomicI.compareAndSet(110,100));
        });

        service.execute(() -&amp;gt; {
            try {
                TimeUnit.SECONDS.sleep(3);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            System.out.println(&amp;quot;(3) 110 å˜ä¸º 100ï¼š&amp;quot; + atomicI.compareAndSet(100,120));
        });

        service.shutdown();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;(1) 100 å˜ä¸º 110ï¼štrue
(2) 110 å˜ä¸º 100ï¼štrue
(3) 110 å˜ä¸º 100ï¼štrue
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;7-æ”¹è¿›&#34;&gt;7. æ”¹è¿›&lt;/h2&gt;
&lt;p&gt;ç±» AtomicStampedReference&lt;V&gt;&lt;/p&gt;
&lt;p&gt;å¢åŠ ç‰ˆæœ¬å·å£°æ˜ï¼šA1(100) -&amp;gt; B2(110) -&amp;gt; A3(100)&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package luban;

import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;
import java.util.concurrent.atomic.AtomicInteger;
import java.util.concurrent.atomic.AtomicStampedReference;

public class CASDemo5 {

    // è®¾ç½®åˆå€¼æ—¶ï¼Œç»™å®šç‰ˆæœ¬å·
    private static AtomicStampedReference asr = new AtomicStampedReference(100, 1);
    public static void main(String[] args){
        ExecutorService service = Executors.newCachedThreadPool();
        service.execute(() -&amp;gt; {
            try {
                TimeUnit.SECONDS.sleep(1);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            System.out.println(&amp;quot;100 å˜ä¸º 110ï¼š&amp;quot; + asr.compareAndSet(100,110,asr.getStamp(), asr.getStamp() + 1));
            System.out.println(&amp;quot;110 å˜æˆ 100ï¼š&amp;quot; +asr.compareAndSet(110,100,asr.getStamp(), asr.getStamp() + 1));
        });
        service.execute(() -&amp;gt; {
            // å¾—åˆ°ç‰ˆæœ¬å·
            int stamp = asr.getStamp();
            try {
                TimeUnit.SECONDS.sleep(2);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            System.out.println(asr.getStamp());
            System.out.println(stamp);
            System.out.println(&amp;quot;100 å˜æˆ 120ï¼š&amp;quot; +asr.compareAndSet( 100,120,stamp, stamp  + 1));
//            System.out.println(&amp;quot;100 å˜æˆ 120ï¼š&amp;quot; +asr.compareAndSet( 100,120,asr.getStamp(), asr.getStamp()  + 1));
        });
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;100 å˜ä¸º 110ï¼štrue
110 å˜æˆ 100ï¼štrue
3
1
100 å˜æˆ 120ï¼šfalse
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åˆ†æï¼šç¬¬ä¸€ä¸ªçº¿ç¨‹ sleep 2 ç§’åæ‰§è¡Œ setï¼Œæ‰€ä»¥ç¬¬äºŒä¸ªçº¿ç¨‹å…ˆ getStamp() åˆ°çš„stamp æ˜¯åˆå§‹åŒ–çš„ï¼Œè¿˜æœªä¿®æ”¹è¿‡çš„ stamp = 1ï¼›è€Œç¬¬äºŒä¸ªçº¿ç¨‹ sleep åçš„ asr å¾—åˆ°çš„ stamp = 3ï¼Œç°æœ‰å€¼ä¸æœŸæœ›å€¼ä¸åŒï¼Œæ‰€ä»¥ä¿®æ”¹å¤±è´¥ã€‚&lt;br&gt;
CAS çš„åº”ç”¨åœºæ™¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åº”ç”¨äºç®€å•çš„æ•°æ®è®¡ç®—ã€‚&lt;/li&gt;
&lt;li&gt;é€‚åˆçº¿ç¨‹å†²çªå°‘çš„åœºæ™¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;äºŒ-aqs&#34;&gt;äºŒã€AQS&lt;/h1&gt;
&lt;h2 id=&#34;1-æ¦‚å¿µ-2&#34;&gt;1. æ¦‚å¿µ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;AbstractQueuedSynchronizer&lt;/li&gt;
&lt;li&gt;åŒæ­¥å‘ç”Ÿå™¨&lt;/li&gt;
&lt;li&gt;æ„å»º LOCK&lt;/li&gt;
&lt;li&gt;JUCï¼šjava.util.current&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;2-åŸºæœ¬æ€æƒ³&#34;&gt;2. åŸºæœ¬æ€æƒ³&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡å†…ç½®å¾—åˆ° FIFO åŒæ­¥é˜Ÿåˆ—æ¥å®Œæˆçº¿ç¨‹äº‰å¤ºèµ„æºçš„ç®¡ç†å·¥ä½œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;3-clhåŒæ­¥é˜Ÿåˆ—&#34;&gt;3. CLHåŒæ­¥é˜Ÿåˆ—&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;11&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/CLH%E5%90%8C%E6%AD%A5%E9%98%9F%E5%88%97.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;CLH åŒæ­¥é˜Ÿåˆ—&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;static final class Node {
    /** Marker to indicate a node is waiting in shared mode */
    static final Node SHARED = new Node(); // å…±äº«
    /** Marker to indicate a node is waiting in exclusive mode */
    static final Node EXCLUSIVE = null; // æ’ä»–

    /** waitStatus value to indicate thread has cancelled */
    static final int CANCELLED =  1; // å› ä¸­æ–­ã€å®Œæˆ é€€å‡ºé˜Ÿåˆ—
    /** waitStatus value to indicate successor&#39;s thread needs unparking */
    static final int SIGNAL    = -1; // èŠ‚ç‚¹çš„åç»§ç»“ç‚¹è¢«é˜»å¡
    /** waitStatus value to indicate thread is waiting on condition */
    static final int CONDITION = -2; // æ¡ä»¶é˜»å¡
    /**
     * waitStatus value to indicate the next acquireShared should
     * unconditionally propagate
     */
    static final int PROPAGATE = -3; // å…±äº«æ¨¡å¼ä¸‹ï¼Œå¤´ç»“ç‚¹çš„çŠ¶æ€
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;ä¸‰-è‡ªå®šä¹‰é”&#34;&gt;ä¸‰ã€è‡ªå®šä¹‰é”&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;AQS å†™ä¸€ä¸ªé”ï¼ˆLockï¼‰
&lt;ul&gt;
&lt;li&gt;å­ç±»å®šä¹‰ä¸ºéå…¬å…±å†…éƒ¨å¸®åŠ©å™¨ç±»ï¼ˆç§æœ‰çš„å†…éƒ¨ç±»ç»§æ‰¿AQSï¼‰ï¼Œå†™é”çš„æ—¶å€™çš„ä¸€ä¸ªå¸®åŠ©å™¨ï¼Œæä¾›è·å–æˆ–å’Œé‡Šæ”¾é”çš„åŠŸèƒ½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ–¹æ³•
&lt;ul&gt;
&lt;li&gt;acquire(intÂ arg)ï¼šä»¥&lt;strong&gt;ç‹¬å &lt;/strong&gt;æ¨¡å¼è·å–ï¼Œå¿½ç•¥ä¸­æ–­ã€‚&lt;/li&gt;
&lt;li&gt;acquireShared(intÂ arg)ï¼šä»¥&lt;strong&gt;å…±äº«&lt;/strong&gt;æ¨¡å¼è·å–ï¼Œå¿½ç•¥ä¸­æ–­ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public final void acquire(int arg) {
    if (!tryAcquire(arg) &amp;amp;&amp;amp;
        acquireQueued(addWaiter(Node.EXCLUSIVE), arg))
        selfInterrupt();
}
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;tryAcquire(int arg)Â ï¼šå°è¯•ä»¥ç‹¬å æ¨¡å¼è·å–å¯¹è±¡çŠ¶æ€ã€‚&lt;/li&gt;
&lt;li&gt;tryAcquireShared(intÂ arg)ï¼šå°è¯•ä»¥å…±äº«æ¨¡å¼è·å–å¯¹è±¡çŠ¶æ€Â ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;private Node addWaiter(Node mode) {
    Node node = new Node(Thread.currentThread(), mode);
    // Try the fast path of enq; backup to full enq on failure
    Node pred = tail;
    if (pred != null) {
        node.prev = pred;
        if (compareAndSetTail(pred, node)) {
            pred.next = node;
            return node;
        }
    }
    enq(node);
    return node;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;release(intÂ arg)ï¼šä»¥ç‹¬å æ¨¡å¼é‡Šæ”¾å¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;releaseShared(intÂ arg)ï¼šä»¥å…±äº«æ¨¡å¼é‡Šæ”¾å¯¹è±¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å®ä¾‹&#34;&gt;å®ä¾‹&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;12&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Lock%E7%B1%BB%E6%96%B9%E6%B3%95.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;Lock ç±»çš„æ–¹æ³•&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package luban;

import java.util.concurrent.TimeUnit;
import java.util.concurrent.locks.AbstractQueuedSynchronizer;
import java.util.concurrent.locks.Condition;
import java.util.concurrent.locks.Lock;

public class MyLock implements Lock {

    private Helper helper = new Helper();

    private class Helper extends AbstractQueuedSynchronizer{
        // è·å–é”
        @Override
        protected boolean tryAcquire(int arg) {
            int state = getState();
            if(state == 0){
                // åˆ©ç”¨ CAS åŸç†ä¿®æ”¹ state
                if(compareAndSetState(0, arg)){
                    // è®¾ç½®å½“å‰çº¿ç¨‹å æœ‰èµ„æº
                    setExclusiveOwnerThread(Thread.currentThread());
                    return true;
                }
            }
            return false;
        }

        // é‡Šæ”¾é”
        @Override
        protected boolean tryRelease(int arg) {// arg:ä¿¡å·é‡
            int state = getState() - arg;
            boolean flag = false;
            // åˆ¤æ–­é‡Šæ”¾åæ˜¯å¦ä¸º 0
            if(state == 0){
                setExclusiveOwnerThread(null);
                setState(state);
                return true;
            }
            setState(state);//ä¸å­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚é‡å…¥æ€§çš„é—®é¢˜ï¼Œå·²ç»ç‹¬å äº†èµ„æºstateï¼Œå…¶ä»–çº¿ç¨‹ä¸ä¼šå¹²æ‰°
            return false;
        }
        public Condition newConditionObject(){
            return new ConditionObject();
        }
    }
    @Override
    public void lock() {
        helper.acquire(1);
    }

    @Override
    public void lockInterruptibly() throws InterruptedException {
        helper.acquireInterruptibly(1);
    }

    @Override
    public boolean tryLock() {
        return helper.tryAcquire(1);
    }

    @Override
    public boolean tryLock(long time, TimeUnit unit) throws InterruptedException {
        return helper.tryAcquireNanos(1, unit.toNanos(time));
    }

    @Override
    public void unlock() {
        helper.release(1);
    }

    @Override
    public Condition newCondition() {
        return helper.newConditionObject();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;ä¸åŠ é”çš„å®ç°æœ‰é—®é¢˜&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package luban;
import java.util.concurrent.TimeUnit;

public class Demo {
    private int m = 0;
    private int next(){
        try {
            TimeUnit.SECONDS.sleep(1);
            return m++;
        } catch (InterruptedException e) {
            throw new RuntimeException(&amp;quot;ERROR&amp;quot;);
        }
    }

    public static void main(String[] args){
        Demo demo = new Demo();
        Thread[] th = new Thread[10];
        for(int i = 0 ; i &amp;lt; 10 ; i ++){
            th[i] = new Thread(() -&amp;gt; {
                System.out.println(demo.next());
            });
            th[i].start();
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;1
7
8
6
5
0
4
3
2
0
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;ä½¿ç”¨è‡ªå®šä¹‰é”çš„å®ç°æ­£ç¡®&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package luban;

public class Demo01 {

    private MyLock lock = new MyLock();

    private int m = 0;

    public int next(){
        lock.lock();
        try {
            return m++;
        } finally{
            lock.unlock();
        }
    }

    public static void main(String[] args){
        Demo01 demo = new Demo01();
        Thread[] th = new Thread[10];
        for(int i = 0 ; i &amp;lt; 10 ; i ++){
            th[i] = new Thread(() -&amp;gt; {
                System.out.println(demo.next());
            });
            th[i].start();
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;0
4
3
2
1
5
6
7
8
9
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šé¢å®ç°çš„ MyLock ä¸å…·æœ‰å¯é‡å…¥æ€§ã€‚æµ‹è¯•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package luban;

import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

public class Demo02 {

    private MyLock lock = new MyLock();

    private int m = 0;

    public void a(){
        lock.lock();
        System.out.println(&amp;quot;a&amp;quot;);
        b();
        lock.unlock();
    }
    public void b(){
        lock.lock();
        System.out.println(&amp;quot;b&amp;quot;);
        lock.unlock();
    }

    public int next(){
        lock.lock();
        try {
            return m++;
        } finally{
            lock.unlock();
        }
    }

    public static void main(String[] args) throws InterruptedException {
        Demo02 demo = new Demo02();
        ExecutorService service = Executors.newCachedThreadPool();
        service.execute(() -&amp;gt; {
            demo.a();
        });
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;a
ï¼ˆé˜»å¡Â·Â·Â·ï¼‰
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;å¯é‡å…¥æ€§&#34;&gt;å¯é‡å…¥æ€§&lt;/h2&gt;
&lt;p&gt;åŒä¸€ä¸ªé”å¯¹åŒä¸€èµ„æºè¿›è¡Œå æœ‰çš„æ—¶å€™ï¼Œç›´æ¥åˆ†é…ç»™è¿™ä¸ªçº¿ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;ã€å æœ‰é”çš„çº¿ç¨‹å†æ¬¡ç”³è¯·é”æ—¶ä»å¯è·å–ã€‚è·å–ä¸€æ¬¡ï¼Œé”è¿™ä¸ªå˜é‡å€¼(é»˜è®¤ä¸ºÂ 0)Â åŠ ä¸€ã€‚é‡Šæ”¾ä¸€æ¬¡ï¼Œé”è¿™ä¸ªå˜é‡å€¼å‡ä¸€ã€‚é”è¿™ä¸ªå˜é‡å€¼ä¸ºÂ 0Â æ—¶ï¼Œè¯´æ˜è¯¥é”æ²¡æœ‰è¢«çº¿ç¨‹å ç”¨ã€‚ã€‘&lt;/p&gt;
&lt;p&gt;å¯¹ MyLock ä»£ç è¿›è¡Œä¿®æ”¹ï¼Œä½¿å…¶å…·æœ‰å¯é‡å…¥æ€§ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package luban;

import java.util.concurrent.TimeUnit;
import java.util.concurrent.locks.AbstractQueuedSynchronizer;
import java.util.concurrent.locks.Condition;
import java.util.concurrent.locks.Lock;

public class MyLock implements Lock {

    private Helper helper = new Helper();

    private class Helper extends AbstractQueuedSynchronizer{
        // è·å–é”
        @Override
        protected boolean tryAcquire(int arg) {
            int state = getState();
            if(state == 0){
                // åˆ©ç”¨ CAS åŸç†ä¿®æ”¹ state
                if(compareAndSetState(0, arg)){
                    // è®¾ç½®å½“å‰çº¿ç¨‹å æœ‰èµ„æº
                    setExclusiveOwnerThread(Thread.currentThread());
                    return true;
                }
            }else if(getExclusiveOwnerThread() == Thread.currentThread()){//å¯é‡å…¥
                setState(getState() + arg);
                return true;
            }
            return false;
        }

        // é‡Šæ”¾é”
        @Override
        protected boolean tryRelease(int arg) {// arg:ä¿¡å·é‡
            int state = getState() - arg;
            boolean flag = false;
            // åˆ¤æ–­é‡Šæ”¾åæ˜¯å¦ä¸º 0
            if(state == 0){
                setExclusiveOwnerThread(null);
                setState(state);
                return true;
            }
            setState(state);//ä¸å­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚é‡å…¥æ€§çš„é—®é¢˜ï¼Œå·²ç»ç‹¬å äº†èµ„æºstateï¼Œå…¶ä»–çº¿ç¨‹ä¸ä¼šå¹²æ‰°
            return false;
        }

        public Condition newConditionObject(){
            return new ConditionObject();
        }
    }
    @Override
    public void lock() {
        helper.acquire(1);
    }

    @Override
    public void lockInterruptibly() throws InterruptedException {
        helper.acquireInterruptibly(1);
    }

    @Override
    public boolean tryLock() {
        return helper.tryAcquire(1);
    }

    @Override
    public boolean tryLock(long time, TimeUnit unit) throws InterruptedException {
        return helper.tryAcquireNanos(1, unit.toNanos(time));
    }

    @Override
    public void unlock() {
        helper.release(1);
    }

    @Override
    public Condition newCondition() {
        return helper.newConditionObject();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æµ‹è¯•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package luban;


import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

public class Demo02 {

    private MyLock lock = new MyLock();

    private int m = 0;

    public void a(){
        lock.lock();
        System.out.println(&amp;quot;a&amp;quot;);
        b();
        lock.unlock();
    }
    public void b(){
        lock.lock();
        System.out.println(&amp;quot;b&amp;quot;);
        lock.unlock();
    }

    public int next(){
        lock.lock();
        try {
            return m++;
        } finally{
            lock.unlock();
        }
    }

    public static void main(String[] args) throws InterruptedException {
        Demo02 demo = new Demo02();
        ExecutorService service = Executors.newCachedThreadPool();
        service.execute(() -&amp;gt; {
            demo.a();
        });
        service.shutdown();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;a
b
&lt;/code&gt;&lt;/pre&gt;
">Java å¹¶å‘â€”â€”CAS å’Œ AQS</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/java-bing-fa-bing-fa-suo-he-bing-fa-gong-ju/"" data-c="
          &lt;h1 id=&#34;ä¸€-å¹¶å‘é”&#34;&gt;ä¸€ã€å¹¶å‘é”&lt;/h1&gt;
&lt;h2 id=&#34;reentrantlock&#34;&gt;ReentrantLock&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€ä¸ª&lt;strong&gt;å¯é‡å…¥äº’æ–¥Lock&lt;/strong&gt;ï¼Œå…·æœ‰ä¸ä½¿ç”¨synchronizedæ–¹æ³•å’Œè¯­å¥è®¿é—®çš„éšå¼ç›‘è§†é”ç›¸åŒçš„åŸºæœ¬è¡Œä¸ºå’Œè¯­ä¹‰ï¼Œä½†å…·æœ‰&lt;strong&gt;æ‰©å±•åŠŸèƒ½&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt; class X { 
   
   private final ReentrantLock lock = new ReentrantLock(); 
   // ... 
   
   public void m() { 
     lock.lock(); // block until condition holds 
     try { 
       // ... method body 
     } finally { 
       lock.unlock() 
     } 
  } 
  
} 
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;æ„é€ æ–¹æ³•ï¼š
&lt;ul&gt;
&lt;li&gt;ReentrantLock()ï¼šåˆ›å»ºä¸€ä¸ª ReentrantLockçš„å®ä¾‹ã€‚&lt;/li&gt;
&lt;li&gt;ReentrantLock(booleanÂ fair)ï¼šæ ¹æ®ç»™å®šçš„&lt;strong&gt;å…¬å¹³&lt;/strong&gt;æ”¿ç­–åˆ›å»ºä¸€ä¸ª ReentrantLockçš„å®ä¾‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;reentrantreadwritelock&#34;&gt;ReentrantReadWriteLock&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ReadWriteLock&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/ReentrantReadWriteLock.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;ReadWriteLock ç±»çš„æ–¹æ³•&lt;/center&gt;
&lt;ul&gt;
&lt;li&gt;write.unlock()å†™é”é‡Šæ”¾ä¹‹å‰è¦åŠ è¯»é”read.lock()ï¼šé”é™çº§ï¼šä»å†™é”é™çº§åˆ°è¯»é”&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;äºŒ-å¹¶å‘å·¥å…·&#34;&gt;äºŒã€å¹¶å‘å·¥å…·&lt;/h1&gt;
&lt;p&gt;èˆªç­æŸ¥è¯¢ï¼šAPP ---&amp;gt;å¤šä¸ªçº¿ç¨‹åˆ°ä¸åŒçš„å…¬å¸æŸ¥è¯¢ ---&amp;gt; å…¨éƒ¨çº¿ç¨‹éƒ½æŸ¥è¯¢å®Œæ¯•åï¼Œæ•´ç†ç»“æœ result è¿”å›ç»™å‰å°ç”¨æˆ·ã€‚&lt;/p&gt;
&lt;h2 id=&#34;1-countdownlatch&#34;&gt;1. CountDownLatch&lt;/h2&gt;
&lt;h3 id=&#34;countdownlatch-ç”¨æ³•&#34;&gt;CountDownLatch ç”¨æ³•&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;CountDownLatch ç±»ä½äºjava.util.concurrentåŒ…ä¸‹ï¼Œåˆ©ç”¨å®ƒå¯ä»¥å®ç°ç±»ä¼¼&lt;strong&gt;è®¡æ•°å™¨&lt;/strong&gt;çš„åŠŸèƒ½ã€‚&lt;/li&gt;
&lt;li&gt;æ¯”å¦‚æœ‰ä¸€ä¸ªä»»åŠ¡Aï¼Œå®ƒè¦ç­‰å¾…å…¶ä»–4ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæ¯•ä¹‹åæ‰èƒ½æ‰§è¡Œï¼Œæ­¤æ—¶å°±å¯ä»¥åˆ©ç”¨CountDownLatch æ¥å®ç°è¿™ç§åŠŸèƒ½äº†ã€‚&lt;/li&gt;
&lt;li&gt;CountDownLatchæ˜¯é€šè¿‡ä¸€ä¸ªè®¡æ•°å™¨æ¥å®ç°çš„ï¼Œè®¡æ•°å™¨çš„åˆå§‹å€¼ä¸ºçº¿ç¨‹çš„æ•°é‡ã€‚æ¯å½“ä¸€ä¸ªçº¿ç¨‹å®Œæˆäº†è‡ªå·±çš„ä»»åŠ¡åï¼Œè®¡æ•°å™¨çš„å€¼å°±ä¼šå‡1ã€‚å½“è®¡æ•°å™¨å€¼åˆ°è¾¾0æ—¶ï¼Œå®ƒè¡¨ç¤ºæ‰€æœ‰çš„çº¿ç¨‹å·²ç»å®Œæˆäº†ä»»åŠ¡ï¼Œç„¶ååœ¨é—­é”ä¸Šç­‰å¾…çš„çº¿ç¨‹å°±å¯ä»¥æ¢å¤æ‰§è¡Œä»»åŠ¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;countdownlatch-å¦‚ä½•å·¥ä½œ&#34;&gt;CountDownLatch å¦‚ä½•å·¥ä½œ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æ„é€ æ–¹æ³•
&lt;ul&gt;
&lt;li&gt;CountDownLatch(intÂ count)ï¼šæ„é€ ä¸€ä¸ªä»¥ç»™å®šè®¡æ•°åˆå§‹åŒ–çš„CountDownLatchã€‚&lt;/li&gt;
&lt;li&gt;æ„é€ å™¨çš„è®¡æ•°å€¼ï¼ˆcountï¼‰å®é™…ä¸Šå°±æ˜¯é—­é”éœ€è¦ç­‰å¾…çš„çº¿ç¨‹æ•°é‡ã€‚è¿™ä¸ªå€¼åªèƒ½è¢«è®¾ç½®ä¸€æ¬¡ï¼Œè€Œä¸”CountDownLatch æ²¡æœ‰æä¾›ä»»ä½•æœºåˆ¶å»é‡æ–°è®¾ç½®è¿™ä¸ªè®¡æ•°å€¼ã€‚&lt;/li&gt;
&lt;li&gt;ä¸CountDownLatchçš„ç¬¬ä¸€æ¬¡äº¤äº’æ˜¯ä¸»çº¿ç¨‹ç­‰å¾…å…¶ä»–çº¿ç¨‹ã€‚ä¸»çº¿ç¨‹å¿…é¡»åœ¨å¯åŠ¨å…¶ä»–çº¿ç¨‹åç«‹å³è°ƒç”¨CountDownLatch.await() æ–¹æ³•ã€‚è¿™æ ·ä¸»çº¿ç¨‹çš„æ“ä½œå°±ä¼šåœ¨è¿™ä¸ªæ–¹æ³•ä¸Šé˜»å¡ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹å®Œæˆå„è‡ªçš„ä»»åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;å…¶ä»–Nä¸ªçº¿ç¨‹å¿…é¡»å¼•ç”¨é—­é”å¯¹è±¡ï¼Œå› ä¸ºä»–ä»¬éœ€è¦é€šçŸ¥CountDownLatchå¯¹è±¡ï¼Œä»–ä»¬å·²ç»å®Œæˆäº†å„è‡ªçš„ä»»åŠ¡ã€‚è¿™ç§é€šçŸ¥æœºåˆ¶æ˜¯é€šè¿‡CountDownLatch.countDown() æ–¹æ³•æ¥å®Œæˆçš„ï¼›æ¯è°ƒç”¨ä¸€æ¬¡è¿™ä¸ªæ–¹æ³•ï¼Œåœ¨æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–çš„countå€¼å°±å‡1ã€‚æ‰€ä»¥å½“Nä¸ªçº¿ç¨‹éƒ½è°ƒç”¨äº†è¿™ä¸ªæ–¹æ³•ï¼Œcountçš„å€¼ç­‰äº0ï¼Œç„¶åä¸»çº¿ç¨‹å°±èƒ½é€šè¿‡await() æ–¹æ³•ï¼Œæ¢å¤æ‰§è¡Œè‡ªå·±çš„ä»»åŠ¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;await()
&lt;ul&gt;
&lt;li&gt;ä½¿å½“å‰çº¿ç¨‹åœ¨é”å­˜å™¨å€’è®¡æ—¶è‡³é›¶å‰ä¸€ç›´ç­‰å¾…ï¼Œé™¤éçº¿ç¨‹è¢«ä¸­æ–­ã€‚&lt;/li&gt;
&lt;li&gt;å½“ count å‡å°‘åˆ°é›¶æ—¶ï¼Œå”¤é†’å½“å‰çº¿ç¨‹&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;countDown()
&lt;ul&gt;
&lt;li&gt;é€’å‡é”å­˜å™¨çš„è®¡æ•°ï¼Œå¦‚æœè®¡æ•°è¾¾åˆ°é›¶ï¼Œåˆ™é‡Šæ”¾æ‰€æœ‰ç­‰å¾…ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/CountDownLatch.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;CountDownLatch èˆªç­æŸ¥è¯¢æµç¨‹å›¾&lt;/center&gt;
&lt;h3 id=&#34;ç¤ºä¾‹&#34;&gt;ç¤ºä¾‹&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package luban;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.Random;
import java.util.concurrent.CountDownLatch;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.TimeUnit;
public class FightQueryDemo {
    private static List&amp;lt;String&amp;gt; company = Arrays.asList(&amp;quot;ä¸œæ–¹èˆªç©º&amp;quot;,&amp;quot;å—æ–¹èˆªç©º&amp;quot;,&amp;quot;æµ·å—èˆªç©º&amp;quot;);
    // ç»“æœåˆ—è¡¨
    private static List&amp;lt;String&amp;gt; fightList = new ArrayList&amp;lt;&amp;gt;();
    public static void main(String[] args) throws InterruptedException {
        // å‡ºå‘åœ°
        String origin = &amp;quot;BJ&amp;quot;;
        // ç›®çš„åœ°
        String dest = &amp;quot;SH&amp;quot;;
        // å®šä¹‰é—¨é—©
        CountDownLatch latch = new CountDownLatch(company.size());
        // åˆ›å»ºçº¿ç¨‹æ± 
        ExecutorService service = Executors.newCachedThreadPool();
        // åˆ›å»ºçº¿ç¨‹
        for (int i = 0; i &amp;lt; company.size(); i++) {
            String name = company.get(i);
            service.execute(() -&amp;gt; {
                // è·å–å…¬å¸åç§°
                System.out.println(name + &amp;quot;æŸ¥è¯¢ä»&amp;quot; + origin + &amp;quot;åˆ°&amp;quot; + dest + &amp;quot;çš„æœºç¥¨&amp;quot;);
                // ç”Ÿæˆéšæœºæ•°è¡¨ç¤ºæ­¤å…¬å¸æœºç¥¨æ•°é‡
                int val = new Random().nextInt(10);
                try {
                    TimeUnit.SECONDS.sleep(val);
                    fightList.add(name + &amp;quot;:&amp;quot; + val);
                    System.out.println(name + &amp;quot;æŸ¥è¯¢æˆåŠŸï¼&amp;quot;);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                // è¿™ä¸ªå…¬å¸æŸ¥è¯¢å®Œæ¯•ï¼Œé—¨é—© - 1
                latch.countDown();
            });
        }
        service.shutdown();
        // ç­‰å¾…æ‰€æœ‰çº¿ç¨‹ç»“æŸ
        latch.await();
        System.out.println(&amp;quot;==== æŸ¥è¯¢ç»“æœå¦‚ä¸‹ ====&amp;quot;);
        System.out.println(fightList);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ä¸œæ–¹èˆªç©ºæŸ¥è¯¢ä»BJåˆ°SHçš„æœºç¥¨
æµ·å—èˆªç©ºæŸ¥è¯¢ä»BJåˆ°SHçš„æœºç¥¨
å—æ–¹èˆªç©ºæŸ¥è¯¢ä»BJåˆ°SHçš„æœºç¥¨
æµ·å—èˆªç©ºæŸ¥è¯¢æˆåŠŸï¼
å—æ–¹èˆªç©ºæŸ¥è¯¢æˆåŠŸï¼
ä¸œæ–¹èˆªç©ºæŸ¥è¯¢æˆåŠŸï¼
==== æŸ¥è¯¢ç»“æœå¦‚ä¸‹ ====
[æµ·å—èˆªç©º:6, å—æ–¹èˆªç©º:7, ä¸œæ–¹èˆªç©º:7]
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;2-cyclicbarries&#34;&gt;2. CyclicBarries&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/CyclicBarries.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;CyclieBarries æ¨¡æ‹Ÿè¿åŠ¨å‘˜è·‘æ­¥æ¯”èµ›&lt;/center&gt;
&lt;h3 id=&#34;cyclicbarrierç”¨æ³•&#34;&gt;CyclicBarrierç”¨æ³•&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å­—é¢æ„æ€&lt;strong&gt;å›ç¯æ …æ &lt;/strong&gt;ï¼Œé€šè¿‡å®ƒå¯ä»¥å®ç°è®©ä¸€ç»„çº¿ç¨‹ç­‰å¾…è‡³æŸä¸ªçŠ¶æ€ä¹‹åå†&lt;strong&gt;å…¨éƒ¨åŒæ—¶æ‰§è¡Œ&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å«åšå›ç¯æ˜¯å› ä¸º&lt;strong&gt;å½“æ‰€æœ‰ç­‰å¾…çº¿ç¨‹éƒ½è¢«é‡Šæ”¾ä»¥å&lt;/strong&gt;ï¼ŒCyclicBarrierå¯ä»¥è¢«é‡ç”¨ã€‚æˆ‘ä»¬æš‚ä¸”æŠŠè¿™ä¸ªçŠ¶æ€å°±å«åšbarrierï¼Œå½“è°ƒç”¨awai() æ–¹æ³•ä¹‹åï¼Œçº¿ç¨‹å°±å¤„äºbarrieräº†ã€‚&lt;/li&gt;
&lt;li&gt;èµ›è·‘ï¼š
&lt;ul&gt;
&lt;li&gt;éœ€è¦æ‰€æœ‰çš„å­ä»»åŠ¡éƒ½å®Œæˆæ—¶ï¼Œæ‰æ‰§è¡Œä¸»ä»»åŠ¡ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥é€‰æ‹©ä½¿ç”¨CyclicBarrierã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;åŸºæœ¬åŸç†&#34;&gt;åŸºæœ¬åŸç†ï¼š&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æ¯ä¸ªçº¿ç¨‹æ‰§è¡Œæ—¶ï¼Œéƒ½ä¼šç¢°åˆ°ä¸€ä¸ªå±éšœï¼Œç›´åˆ°æ‰€æœ‰çº¿ç¨‹æ‰§è¡Œç»“æŸï¼Œç„¶åå±éšœä¾¿ä¼šæ‰“å¼€ï¼Œä½¿æ‰€æœ‰çº¿ç¨‹ç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚&lt;/li&gt;
&lt;li&gt;åœ¨ CyclicBarrier çš„å†…éƒ¨å®šä¹‰äº†ä¸€ä¸ª Lock å¯¹è±¡ï¼Œæ¯å½“ä¸€ä¸ªçº¿è°ƒç”¨ await æ–¹æ³•æ—¶ï¼Œå°†æ‹¦æˆªçš„çº¿ç¨‹æ•°åŠ å‡ 1ï¼Œç„¶ååˆ¤æ–­è®¡æ•°å™¨å½“å‰æ˜¯å¦ç­‰äº 0 ï¼Œå¦‚æœä¸æ˜¯ï¼Œè¿›å…¥Lockå¯¹è±¡çš„æ¡ä»¶é˜Ÿåˆ—ç­‰å¾…ã€‚å¦‚æœæ˜¯ï¼Œæ‰§è¡Œ barrierAction å¯¹è±¡çš„ Runnable æ–¹æ³•ï¼Œç„¶åå°†é”çš„æ¡ä»¶é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰çº¿ç¨‹æ”¾å…¥é”ç­‰å¾…é˜Ÿåˆ—ä¸­ï¼Œè¿™äº›çº¿ç¨‹ä¼šä¾æ¬¡çš„è·å–é”ã€é‡Šæ”¾é”ã€‚&lt;/li&gt;
&lt;li&gt;CyclicBarrierçš„ä¸¤ä¸ª&lt;strong&gt;æ„é€ å‡½æ•°&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;CyclicBarrierï¼ˆint partiesï¼‰ï¼šå£°æ˜éœ€è¦æ‹¦æˆªçš„çº¿ç¨‹æ•°&lt;/li&gt;
&lt;li&gt;CyclicBarrierï¼ˆint partiesï¼ŒRunnable barierActionï¼‰ï¼šå£°æ˜éœ€è¦æ‹¦æˆªçš„çº¿ç¨‹æ•°ï¼Œå®šä¹‰ä¸€ä¸ªç­‰å¾…æ‰€æœ‰çº¿ç¨‹åˆ°è¾¾å±éšœä¼˜å…ˆæ‰§è¡Œçš„Runnableå¯¹è±¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package luban;
import java.util.Random;
import java.util.concurrent.*;
public class RaceDemo {
    public static void main(String[] args) {
        CyclicBarrier barrier = new CyclicBarrier(8);
        ExecutorService service = Executors.newCachedThreadPool();
        for(int i = 0 ; i &amp;lt; 8 ; i++){
            service.execute(() -&amp;gt; {
                try {
                    TimeUnit.SECONDS.sleep(new Random().nextInt(10));
                    System.out.println(Thread.currentThread().getName() + &amp;quot;å‡†å¤‡å¥½äº†&amp;quot;);
                    // æ­¤çº¿ç¨‹å·²ç»å‡†å¤‡å¥½ï¼Œå”¤é†’å…¶ä»–çº¿ç¨‹
                    barrier.await();
                } catch (InterruptedException e) {
                    e.printStackTrace();
                } catch (BrokenBarrierException e) {
                    e.printStackTrace();
                }
                System.out.println(&amp;quot;é€‰æ‰‹&amp;quot; + Thread.currentThread().getName() + &amp;quot;èµ·è·‘&amp;quot;);
            });
        }
        service.shutdown();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;pool-1-thread-8å‡†å¤‡å¥½äº†
pool-1-thread-4å‡†å¤‡å¥½äº†
pool-1-thread-5å‡†å¤‡å¥½äº†
pool-1-thread-2å‡†å¤‡å¥½äº†
pool-1-thread-1å‡†å¤‡å¥½äº†
pool-1-thread-7å‡†å¤‡å¥½äº†
pool-1-thread-3å‡†å¤‡å¥½äº†
pool-1-thread-6å‡†å¤‡å¥½äº†
é€‰æ‰‹pool-1-thread-6èµ·è·‘
é€‰æ‰‹pool-1-thread-8èµ·è·‘
é€‰æ‰‹pool-1-thread-5èµ·è·‘
é€‰æ‰‹pool-1-thread-4èµ·è·‘
é€‰æ‰‹pool-1-thread-3èµ·è·‘
é€‰æ‰‹pool-1-thread-7èµ·è·‘
é€‰æ‰‹pool-1-thread-1èµ·è·‘
é€‰æ‰‹pool-1-thread-2èµ·è·‘
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€èˆ¬æƒ…å†µä¸‹å¯¹äºä¸¤ä¸ªéå¸¸ç›¸ä¼¼çš„ç±»ï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½ä¼šæƒ³å½“ç„¶åœ°å»æŠŠä»–ä»¬è¿›è¡Œç±»æ¯”ã€‚å¯¹äºCountDownLatch å’ŒCyclicBarrier ä¸¤ä¸ªç±»ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°CountDownLatch ç±»éƒ½æ˜¯ä¸€ä¸ªç±»ä¼¼äºé›†ç»“ç‚¹çš„æ¦‚å¿µï¼Œå¾ˆå¤šä¸ªçº¿ç¨‹åšå®Œäº‹æƒ…ä¹‹åç­‰å¾…å…¶ä»–çº¿ç¨‹å®Œæˆï¼Œå…¨éƒ¨çº¿ç¨‹å®Œæˆä¹‹åå†æ¢å¤è¿è¡Œã€‚ä¸åŒçš„æ˜¯CountDownLatch ç±»éœ€è¦ä½ è‡ªå·±è°ƒç”¨countDown() æ–¹æ³•å‡å°‘ä¸€ä¸ªè®¡æ•°ï¼Œç„¶åè°ƒç”¨await() æ–¹æ³•å³å¯ã€‚è€ŒCyclicBarrier åˆ™ç›´æ¥è°ƒç”¨await() æ–¹æ³•å³å¯ã€‚&lt;/li&gt;
&lt;li&gt;æ‰€ä»¥ä»ä¸Šé¢æ¥çœ‹ï¼ŒCountDownLatchæ›´å€¾å‘äºå¤šä¸ªçº¿ç¨‹åˆä½œçš„æƒ…å†µï¼Œç­‰ä½ æ‰€æœ‰ä¸œè¥¿éƒ½å‡†å¤‡å¥½äº†ï¼Œæˆ‘è¿™è¾¹å°±è‡ªåŠ¨æ‰§è¡Œäº†ã€‚è€ŒCyclicBarrieråˆ™æ˜¯æˆ‘ä»¬éƒ½åœ¨ä¸€ä¸ªåœ°æ–¹ç­‰ä½ ï¼Œå¤§å®¶åˆ°é½äº†ï¼Œå¤§å®¶å†ä¸€èµ·æ‰§è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;3-semaphore&#34;&gt;3. Semaphore&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;èµ„æºæœ‰é™å…±äº«&lt;/li&gt;
&lt;li&gt;åœè½¦åœºä¸ºä¾‹ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Semaphore.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.ssm;

import java.util.Random;
import java.util.concurrent.Semaphore;
import java.util.concurrent.TimeUnit;

public class CarDemo {
    public static void main(String[] args) throws InterruptedException {
        // åˆ›å»º Semaphore
        Semaphore semaphore = new Semaphore(3);
        Thread [] cars = new Thread[10];
        for (int i = 0; i &amp;lt; 10; i++) {
            cars[i] = new Thread(()-&amp;gt;{
                try {
                    // è¯·æ±‚è®¸å¯
                    semaphore.acquire();
                    System.out.println(Thread.currentThread().getName() + &amp;quot;å¯ä»¥è¿›å…¥åœè½¦åœº&amp;quot;);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }

                // ä½¿ç”¨èµ„æº
                try {
                    int val = new Random().nextInt(5);
                    TimeUnit.SECONDS.sleep(val);
                    System.out.println(Thread.currentThread().getName()+&amp;quot;åœç•™äº†&amp;quot;+val+&amp;quot;ç§’&amp;quot;);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                // ç¦»å¼€ï¼ˆé‡Šæ”¾èµ„æºï¼‰
                semaphore.release();
                System.out.println(Thread.currentThread().getName() + &amp;quot;ç¦»å¼€äº†åœè½¦åœº&amp;quot;);
            },&amp;quot;car[&amp;quot;+i+&amp;quot;]&amp;quot;);
            cars[i].start();
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;car[0]å¯ä»¥è¿›å…¥åœè½¦åœº
car[2]å¯ä»¥è¿›å…¥åœè½¦åœº
car[7]å¯ä»¥è¿›å…¥åœè½¦åœº
car[0]åœç•™äº†0ç§’
car[0]ç¦»å¼€äº†åœè½¦åœº
car[4]å¯ä»¥è¿›å…¥åœè½¦åœº
car[7]åœç•™äº†2ç§’
car[7]ç¦»å¼€äº†åœè½¦åœº
car[8]å¯ä»¥è¿›å…¥åœè½¦åœº
car[2]åœç•™äº†3ç§’
car[8]åœç•™äº†1ç§’
car[3]å¯ä»¥è¿›å…¥åœè½¦åœº
car[2]ç¦»å¼€äº†åœè½¦åœº
car[5]å¯ä»¥è¿›å…¥åœè½¦åœº
car[8]ç¦»å¼€äº†åœè½¦åœº
car[4]åœç•™äº†4ç§’
car[4]ç¦»å¼€äº†åœè½¦åœº
car[1]å¯ä»¥è¿›å…¥åœè½¦åœº
car[3]åœç•™äº†2ç§’
car[3]ç¦»å¼€äº†åœè½¦åœº
car[9]å¯ä»¥è¿›å…¥åœè½¦åœº
car[9]åœç•™äº†0ç§’
car[9]ç¦»å¼€äº†åœè½¦åœº
car[6]å¯ä»¥è¿›å…¥åœè½¦åœº
car[6]åœç•™äº†0ç§’
car[6]ç¦»å¼€äº†åœè½¦åœº
car[1]åœç•™äº†1ç§’
car[1]ç¦»å¼€äº†åœè½¦åœº
car[5]åœç•™äº†3ç§’
car[5]ç¦»å¼€äº†åœè½¦åœº
&lt;/code&gt;&lt;/pre&gt;
">Java å¹¶å‘â€”â€”å¹¶å‘é”å’Œå¹¶å‘å·¥å…·</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/http-xi-lie-si-an-quan-de-https/"" data-c="
          &lt;h1 id=&#34;ä¸€-http-ä¸-https&#34;&gt;ä¸€ã€HTTP ä¸ HTTPS&lt;/h1&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/HTTPS_1.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/HTTPS_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;HTTP åè®®ï¼šè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œåº”ç”¨å±‚åè®®ï¼ŒHTTP åè®®é€šè¿‡ è¯·æ±‚-å“åº”çš„æ–¹å¼ï¼Œåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´è¿›è¡Œé€šä¿¡ã€‚HTTP åè®®ä¼ è¾“&lt;strong&gt;æ˜æ–‡&lt;/strong&gt;ï¼Œä¸å®‰å…¨ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ˜æ–‡ä¿¡æ¯ä¼ è¾“&#34;&gt;æ˜æ–‡ä¿¡æ¯ä¼ è¾“&lt;/h2&gt;
&lt;p&gt;å°é£å‘å‘å°èŒå‘å‡ºä¸€ä¸ªè¯·æ±‚ â€œå°èŒï¼Œæˆ‘å–œæ¬¢ä½ ï¼â€ æ¥è¡¨ç™½ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%98%8E%E6%96%87%E4%BF%A1%E6%81%AF%E4%BC%A0%E8%BE%93.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;ä¸­é—´äººæ”»å‡»&#34;&gt;ä¸­é—´äººæ”»å‡»&lt;/h3&gt;
&lt;p&gt;ä½†æ˜¯ç”±äºä¼ è¾“ä¿¡æ¯æ˜¯æ˜æ–‡ï¼Œè¿™ä¸ªä¿¡æ¯å¯èƒ½è¢«æŸä¸ªä¸­é—´äººæ¶æ„æ‹¦æˆªç”šè‡³ç¯¡æ”¹ï¼š&lt;strong&gt;ä¸­é—´äººæ”»å‡»&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%98%8E%E6%96%87%E4%BF%A1%E6%81%AF%E4%BC%A0%E8%BE%93_%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;åŠ å¯†ä¿¡æ¯ä¼ è¾“&#34;&gt;åŠ å¯†ä¿¡æ¯ä¼ è¾“&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%8A%A0%E5%AF%86%E4%BF%A1%E6%81%AF%E4%BC%A0%E8%BE%93.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;åŠ å¯†ç®—æ³•&#34;&gt;åŠ å¯†ç®—æ³•&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹ç§°åŠ å¯†ï¼šåŠ å¯†ã€è§£å¯†ä½¿ç”¨åŒä¸€ä¸ªç§˜é’¥&lt;/li&gt;
&lt;li&gt;éå¯¹ç§°åŠ å¯†ï¼šåŠ å¯†ã€è§£å¯†ä½¿ç”¨ä¸åŒçš„ç§˜é’¥ï¼Œå…¬é’¥åŠ å¯†ç§é’¥è§£å¯†&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;å¯¹ç§°åŠ å¯†ä¼ è¾“&#34;&gt;å¯¹ç§°åŠ å¯†ä¼ è¾“&lt;/h3&gt;
&lt;p&gt;å°é£å’Œå°èŒäº‹å…ˆçº¦å®šå¥½ä¸€ç§åŠ å¯†æ–¹å¼ï¼Œå¹¶ä¸”çº¦å®šä¸€ä¸ªéšæœºç”Ÿæˆçš„ç§˜é’¥ï¼Œåç»­é€šä¿¡ä¿¡æ¯çš„å‘é€æ–¹ä½¿ç”¨ç§˜é’¥å¯¹ä¿¡æ¯è¿›è¡ŒåŠ å¯†ï¼Œä¿¡æ¯çš„æ¥æ”¶æ–¹ä½¿ç”¨åŒä¸€ä¸ªç§˜é’¥å¯¹æ¥æ”¶åˆ°çš„å¯†æ–‡è¿›è¡Œè§£å¯†ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E4%BF%A1%E6%81%AF%E4%BC%A0%E8%BE%93.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;å°é£å‘é€èŠå¤©è¯·æ±‚ï¼Œå°èŒå›å¤ç»™å°é£ä¸€ä¸ªç§˜é’¥ï¼Œå°é£åé¢å‘é€çš„ä¿¡æ¯éƒ½å…ˆä½¿ç”¨ç§˜é’¥åŠ å¯†åå†å‘é€ã€‚åç»­å‘é€ä¿¡æ¯éƒ½æ˜¯ä¸å¯è¯»çš„å¯†æ–‡äº†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E4%BF%A1%E6%81%AF%E4%BC%A0%E8%BE%93_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;å¦‚æœä¸çŸ¥é“ç§˜é’¥ï¼Œå³ä½¿æ‹¦æˆªåˆ°äº†ä¿¡æ¯ï¼Œä¹Ÿæ²¡æœ‰åŠæ³•è§£æå’Œç¯¡æ”¹ã€‚&lt;br&gt;
ä½†æ˜¯è¿™æ ·åšå¹¶ä¸æ˜¯ç»å¯¹å®‰å…¨çš„ï¼Œè™½ç„¶åœ¨åç»­çš„é€šä¿¡ä¸­å¯¹æ˜æ–‡è¿›è¡Œäº†åŠ å¯†ï¼Œä½†æ˜¯&lt;strong&gt;ç¬¬ä¸€æ¬¡çº¦å®šåŠ å¯†æ–¹å¼ã€çº¦å®šåŠ å¯†æ–¹å¼ä¹‹åçš„ç§˜é’¥çš„ä¼ è¾“&lt;/strong&gt;è¿˜æ˜¯ç”¨æ˜æ–‡ã€‚å¦‚æœç¬¬ä¸€æ¬¡é€šä¿¡å°±å·²ç»è¢«æ‹¦æˆªäº†ï¼Œé‚£ä¹ˆç§˜é’¥å°±ä¼šæ³„éœ²ç»™ä¸­é—´äººï¼Œ ä¸­é—´äººä»å¯ä»¥è§£å¯†åç»­æ‰€æœ‰é€šä¿¡å†…å®¹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E4%BF%A1%E6%81%AF%E4%BC%A0%E8%BE%93_%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;éå¯¹ç§°åŠ å¯†ä¼ è¾“&#34;&gt;éå¯¹ç§°åŠ å¯†ä¼ è¾“&lt;/h2&gt;
&lt;p&gt;éå¯¹ç§°åŠ å¯†çš„ä¸€ç»„ç§˜é’¥ä¸­åŒ…å«ä¸€ä¸ªå…¬é’¥å’Œä¸€ä¸ªç§é’¥ï¼Œæ—¢å¯ä»¥å…¬é’¥åŠ å¯†ç§é’¥è§£å¯†ï¼Œä¹Ÿå¯ä»¥ç§é’¥åŠ å¯†å…¬é’¥è§£å¯†ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;9&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E4%BC%A0%E8%BE%93_1.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;åœ¨å°é£å’Œå°èŒå»ºç«‹é€šä¿¡æ—¶ï¼Œå°èŒé¦–å…ˆæŠŠè‡ªå·±çš„å…¬é’¥ KEY1 å‘é€ç»™å°é£ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;10&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E4%BC%A0%E8%BE%93_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;æ”¶åˆ°å°èŒçš„å…¬é’¥åï¼Œå°é£è‡ªå·±ç”Ÿæˆä¸€ä¸ªç”¨äºå¯¹ç§°åŠ å¯†çš„å…¬é’¥ KEY2ï¼Œè¿™ä¸ªç§˜é’¥æ˜¯ä¸ºäº†åç»­èŠå¤©åŠ å¯†æ¥ç”¨çš„ï¼Œå°±æ˜¯ä¸Šæ¬¡è¢«ä¸­é—´äººå‘ç°çš„é‚£ä¸ªç§˜é’¥ï¼Œä¸ºäº†å®‰å…¨ä¸å†æ˜æ–‡çº¦å®šå‘é€ï¼Œè€Œæ˜¯ç”¨åˆšæ‰æ¥æ”¶åˆ°çš„å…¬é’¥ KEY1 å¯¹ KEY2 è¿›è¡ŒåŠ å¯†ï¼Œå¾—åˆ° VA3=KEY1(KEY2)ï¼ŒæŠŠ VA3 å‘é€ç»™å°èŒã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;11&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E4%BC%A0%E8%BE%93_3.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;å°èŒå¯ä»¥ç”¨è‡ªå·±çš„éå¯¹ç§°åŠ å¯†çš„ç§é’¥ï¼Œè§£å¼€å…¬é’¥ KEY1 çš„åŠ å¯†ï¼Œè·å¾—äº† KEY2 çš„å†…å®¹ï¼Œä»æ­¤ä»¥åç”¨ KEY2 è¿›è¡ŒåŠ å¯†é€šä¿¡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åœ¨è¿™ä¸ªé€šä¿¡è¿‡ç¨‹ä¸­ï¼Œå³ä½¿ä¸­é—´äººä¸€å¼€å§‹å°±æˆªè·äº†å…¬é’¥ KEY1ï¼Œç”±äºä¸çŸ¥é“ç§é’¥æ˜¯ä»€ä¹ˆï¼Œä¹Ÿæ²¡æœ‰åŠæ³•å»è§£å¯†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;12&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E4%BC%A0%E8%BE%93_%E6%80%BB%E7%BB%93.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;å‘é€æ–¹å’Œæ¥æ”¶æ–¹éƒ½æœ‰ä¸€å¥—è‡ªå·±çš„å…¬é’¥å’Œç§é’¥ï¼Œå…¬é’¥æ˜¯æ‰€æœ‰äººéƒ½çŸ¥é“çš„ï¼Œç§é’¥åªæœ‰è‡ªå·±çŸ¥é“ã€‚&lt;br&gt;
&lt;strong&gt;å‘é€æ–¹ä½¿ç”¨æ¥æ”¶æ–¹çš„å…¬é’¥è¿›è¡ŒåŠ å¯†ï¼Œæ¥æ”¶æ–¹ä½¿ç”¨è‡ªå·±çš„ç§é’¥å¯¹æ¥æ”¶çš„å¯†æ–‡è¿›è¡Œè§£å¯†ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;ä¸­é—´äººæ”»å‡»-2&#34;&gt;ä¸­é—´äººæ”»å‡»&lt;/h3&gt;
&lt;p&gt;ä¸­é—´äººä¸çŸ¥é“å°èŒçš„ç§é’¥æ˜¯ä»€ä¹ˆï¼Œä½†æ˜¯å®ƒæˆªè·äº†å°èŒçš„å…¬é’¥ KEY1 åï¼Œå¯ä»¥è‡ªå·±å¦å¤–ç”Ÿæˆä¸€å¯¹å…¬é’¥å’Œç§é’¥ï¼ŒæŠŠè‡ªå·±çš„å…¬é’¥ KEY3 å‘é€ç»™å°é£ï¼Œ&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;13&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E4%BC%A0%E8%BE%93_%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB_1.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;å°é£ä»¥ä¸º KEY3 å°±æ˜¯å°èŒçš„å…¬é’¥ï¼Œç”¨ KEY3 åŠ å¯†è‡ªå·±ç”Ÿæˆçš„å¯¹ç§°åŠ å¯†çš„å…¬é’¥ KEY2 å¾—åˆ° VA4=KEY3(KEY2)ï¼Œå‘é€ç»™å°èŒï¼Œä¸­é—´äººç”¨è‡ªå·±çš„ç§é’¥è§£å¼€ KEY3 åŠ å¯†ï¼Œè·å¾—äº† KEY2ï¼Œç„¶åç”¨å°èŒå‘æ¥çš„ KEY1 é‡æ–°åŠ å¯†ï¼Œå¾—åˆ° VAL5ï¼Œå‘ç»™å°èŒã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;14&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E4%BC%A0%E8%BE%93_%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸¤ä¸ªäººçš„åç»­é€šä¿¡å°½ç®¡ä¸€ç›´åœ¨ç”¨ KEY2 åšå¯¹ç§°åŠ å¯†ï¼Œä½†æ˜¯ä¸­é—´äººå·²ç»æŒæ¡äº† KEY2ï¼Œå°±å¯ä»¥è½»æ¾åœ°è§£å¯†è·å–å†…å®¹äº†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;è¯ä¹¦æœºæ„&#34;&gt;è¯ä¹¦æœºæ„&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%AF%81%E4%B9%A6%E6%9C%BA%E6%9E%84.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%AF%81%E4%B9%A6%E6%9C%BA%E6%9E%84_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å°èŒæŠŠè‡ªå·±çš„å…¬é’¥ KEY1 å‘ç»™è¯ä¹¦é¢å‘æœºæ„å»ç”³è¯·è¯ä¹¦ï¼Œè¯ä¹¦é¢å‘æœºæ„è‡ªå·±æœ‰ä¸€å¯¹å…¬é’¥å’Œç§é’¥ï¼Œæœºæ„åˆ©ç”¨è‡ªå·±çš„ç§é’¥æ¥åŠ å¯† KEY1ï¼Œå¹¶ä¸”é€šè¿‡æœåŠ¡ç«¯ç½‘å€ç­‰ä¿¡æ¯ç”Ÿæˆä¸€ä¸ªè¯ä¹¦ç­¾åï¼Œè¯ä¹¦ç­¾ååŒæ ·ç»è¿‡äº†æœºæ„çš„ç§é’¥åŠ å¯†ï¼Œè¿™æ ·åˆ¶ä½œå®Œæˆä¸€ä¸ªè¯ä¹¦ï¼Œæœºæ„æŠŠè¿™ä¸ªè¯ä¹¦å‘ç»™æœåŠ¡ç«¯å°èŒã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;15&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%AF%81%E4%B9%A6%E6%9C%BA%E6%9E%84_3.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;å½“åç»­å°é£å‘å°èŒè¯·æ±‚é€šä¿¡æ—¶ï¼Œå°èŒä¸å†è¿”å›è‡ªå·±çš„å…¬é’¥ï¼Œè€Œæ˜¯ç›´æ¥æŠŠè‡ªå·±ç”³è¯·çš„è¯ä¹¦è¿”å›ç»™å°é£ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;16&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%AF%81%E4%B9%A6%E6%9C%BA%E6%9E%84_4.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;å°é£æ”¶åˆ°è¯ä¹¦åï¼ŒÂ éªŒè¯è¯ä¹¦çš„çœŸä¼ªï¼Œå„å¤§æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿå·²ç»ç»´æŠ¤äº†æ‰€æœ‰æƒå¨è¯ä¹¦æœºæ„çš„åç§°å’Œå…¬é’¥ï¼Œæ‰€ä»¥ï¼Œå°é£åªéœ€è¦çŸ¥é“æ˜¯å“ªä¸ªæœºæ„é¢å¸ƒçš„è¯ä¹¦ï¼Œå°±å¯ä»¥ä»æœ¬åœ°æ‰¾åˆ°å¯¹åº”çš„æœºæ„å…¬é’¥ï¼Œè§£å¯†å‡ºè¯ä¹¦çš„ç­¾åã€‚æ¥ä¸‹æ¥å°é£æŒ‰ç…§åŒæ ·çš„ç­¾åè§„åˆ™ï¼Œè‡ªå·±ç”Ÿæˆä¸€ä¸ªè¯ä¹¦ç­¾åï¼Œå¦‚æœä¸¤ä¸ªç­¾åä¸€è‡´ï¼Œè¯´æ˜è¯ä¹¦æœ‰æ•ˆï¼ŒéªŒè¯æˆåŠŸåï¼Œå°é£å°±å¯ä»¥æ”¾å¿ƒåœ°å†æ¬¡åˆ©ç”¨æœºæ„çš„å…¬é’¥è§£å¯†å‡ºæœåŠ¡ç«¯å°èŒçš„å…¬é’¥ KEY1ï¼Œå°é£ç”Ÿæˆè‡ªå·±å¯¹åº”çš„å¯¹ç§°åŠ å¯†çš„ç§˜é’¥ KEY2ï¼Œå¹¶ä¸”ç”¨æœåŠ¡ç«¯å…¬é’¥ KEY1 åŠ å¯† KEY2 ç”Ÿæˆ VA3ï¼Œå‘é€ç»™å°èŒã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;17&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%AF%81%E4%B9%A6%E6%9C%BA%E6%9E%84_5.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;å°èŒç”¨è‡ªå·±çš„ç§é’¥è§£å¼€åŠ å¯†å¾—åˆ°å¯¹ç§°åŠ å¯†çš„ç§˜é’¥ KEY2ï¼Œäºæ˜¯ä¸¤ä¸ªäººå¯ä»¥å¼€å§‹ç”¨ KEY2 è¿›è¡Œå¯¹ç§°åŠ å¯†é€šä¿¡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&#34;äºŒ-https-åè®®æ¦‚è¿°&#34;&gt;äºŒã€HTTPS åè®®æ¦‚è¿°&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;HTTPSå¯ä»¥è®¤ä¸ºæ˜¯HTTP+TLSã€‚&lt;/li&gt;
&lt;li&gt;TLSæ˜¯ä¼ è¾“å±‚åŠ å¯†åè®®ï¼Œå®ƒçš„å‰èº«æ˜¯SSLåè®®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;æˆ‘ä»¬é»˜è®¤ TLS å’Œ SSL æŒ‡çš„æ˜¯ä¸€ä¸ªä¸œè¥¿ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;18&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/SSL.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;TLS å»ºç«‹åœ¨ ä¼ è¾“å±‚å’Œåº”ç”¨å±‚ä¹‹é—´ï¼ŒTLS å®é™…ä¸Šæ˜¯ TCP ä¹‹ä¸Šå»ºç«‹äº†ä¸€ä¸ªåŠ å¯†é€šé“ï¼ŒTLS åè®®ä¸»è¦æœ‰äº”ä¸ªéƒ¨åˆ†ï¼šåº”ç”¨æ•°æ®å±‚åè®®ã€æ¡æ‰‹åè®®ã€æŠ¥è­¦åè®®ã€åŠ å¯†æ¶ˆæ¯ç¡®è®¤åè®®ã€å¿ƒè·³åè®®ã€‚&lt;br&gt;
ç›®å‰å¸¸ç”¨çš„ HTTP åè®®æ˜¯ HTTP1.1ï¼Œå¸¸ç”¨çš„ TLS åè®®ç‰ˆæœ¬æœ‰ï¼šTLS1.2ã€TLS1.1ã€TLS1.0 å’Œ SSL3.0 è¿™æ ·å‡ ä¸ªç‰ˆæœ¬ã€‚å…¶ä¸­ SSL3.0 ç”±äºæŸç§æ”»å‡»ï¼Œè®¤ä¸º SSL3.0 åè®®æ˜¯ä¸å®‰å…¨çš„ã€‚TLS1.0 ä¹Ÿå­˜åœ¨éƒ¨åˆ†å®‰å…¨æ¼æ´ï¼ŒTLS1.1 å’Œ TLS1.2 æš‚æ—¶æ²¡æœ‰å·²çŸ¥çš„å®‰å…¨æ¼æ´ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;https-åŠŸèƒ½ä»‹ç»&#34;&gt;HTTPS åŠŸèƒ½ä»‹ç»&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;HTTP æœ¬èº«æ˜¯æ˜æ–‡ä¼ è¾“ï¼Œæ²¡æœ‰ç»è¿‡ä»»ä½•å®‰å…¨å¤„ç†ï¼Œæ¯”å¦‚åœ¨ç™¾åº¦æœç´¢ä¸€ä¸ªå…³é”®å­—ï¼šå°ç±³æ‰‹æœºï¼Œä¸­é—´äººèƒ½å¤ŸæŸ¥çœ‹è¿™ä¸ªæ¶ˆæ¯å¹¶ä¸”æœ‰å¯èƒ½æ‰“ç”µè¯æ¨é”€ï¼›åœ¨ä½¿ç”¨ç™¾åº¦çš„è¿‡ç¨‹ä¸­ï¼Œæœç´¢è¿”å›çš„ç»“æœé¡µé¢æœ‰å¹¿å‘Šã€‚è¿™é‡Œçš„ä¸­é—´è€…ä¸»è¦æŒ‡ç½‘ç»œèŠ‚ç‚¹ï¼Œç”¨æˆ·æ•°æ®åœ¨æµè§ˆå™¨å’Œç™¾åº¦æœåŠ¡å™¨ä¸­é—´ä¼ è¾“å¿…é¡»è¦ç»è¿‡çš„é‚£äº›èŠ‚ç‚¹ã€‚æ¯”å¦‚ wifi çƒ­ç‚¹ã€è·¯ç”±å™¨ã€é˜²ç«å¢™ã€åå‘ä»£ç†ã€ç¼“å­˜æœåŠ¡å™¨ç­‰ï¼Œåœ¨ HTTP åè®®ä¸‹ï¼Œä¸­é—´äººå¯éšæ„çªƒå¬ç”¨æˆ·çš„æœç´¢å†…å®¹ï¼Œçªƒå–å®¢æˆ·éšç§ç”šè‡³ç¯¡æ”¹ç½‘é¡µï¼ŒHTTPS åè®®å°±æ˜¯è¿™äº›æ”»å‡»çš„å…‹æ˜Ÿã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;å†…å®¹åŠ å¯†&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;æµè§ˆå™¨åˆ°æœåŠ¡å™¨çš„å†…å®¹æ˜¯ä»¥åŠ å¯†çš„å½¢å¼ä¼ è¾“çš„ï¼Œä¸­é—´è€…æ— æ³•æŸ¥çœ‹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;éå¯¹ç§°ç§˜é’¥äº¤æ¢&lt;/li&gt;
&lt;li&gt;å¯¹ç§°å†…å®¹åŠ å¯†&lt;br&gt;
å¯¹ç§°åŠ å¯†çš„ç¬¬ä¸€æ­¥ï¼šåå•†åŠ å¯†ç®—æ³•å’Œç§˜é’¥ï¼Œä¸­é—´äººä¾ç„¶å¯ä»¥åœ¨ç¬¬ä¸€æ¬¡é€šä¿¡æ—¶ï¼Œæˆªè·åŠ å¯†æ–¹å¼å’Œç§˜é’¥ï¼Œè¿™æ ·æœ‰å¯¹ç§°å†…å®¹åŠ å¯†å°±å®‰å…¨äº†ä¸€äº›ã€‚&lt;br&gt;
éå¯¹ç§°åŠ å¯†ç”¨å…¬é’¥å’Œç§é’¥çš„æ–¹å¼æŠŠæ­£å¸¸é€šä¿¡çš„ç§˜é’¥ KEY2 åå•†å¥½ï¼Œä½†æ˜¯åœ¨åå•†è¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸€æ­¥éª¤æ˜¯æœåŠ¡å™¨æŠŠè‡ªå·±çš„å…¬é’¥ KEY1 ç”¨æ˜æ–‡ä¼ ç»™å®¢æˆ·ç«¯ï¼Œ&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;èº«ä»½è®¤è¯&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;è¯ä¹¦çš„å­˜åœ¨ä¿è¯ç”¨æˆ·è®¿é—®çš„æ˜¯ä½ æƒ³è®¿é—®çš„æœåŠ¡ï¼Œåœ¨ä½¿ç”¨æ…•è¯¾çœ‹è§†é¢‘ï¼ŒHTTPS è¯ä¹¦ä¿è¯äº†æ­¤æ—¶è®¿é—®çš„ä¸€å®šæ˜¯æ…•è¯¾ç½‘ï¼Œå³ä½¿è¢« DNS åŠ«æŒåˆ°äº†ç¬¬ä¸‰æ–¹ç«™ç‚¹ï¼Œä¹Ÿä¼šæé†’ç”¨æˆ·æ²¡æœ‰è®¿é—®æ…•è¯¾æœåŠ¡ï¼Œæœ‰å¯èƒ½è¢«åŠ«æŒã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;æ•°æ®å®Œæ•´æ€§&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;é˜²æ­¢å†…å®¹è¢«ç¬¬ä¸‰æ–¹å†’å……æˆ–ç¯¡æ”¹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;https-åŸç†ä»‹ç»&#34;&gt;HTTPS åŸç†ä»‹ç»&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å†…å®¹åŠ å¯†&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;éå¯¹ç§°å¯†é’¥äº¤æ¢&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;éå¯¹ç§°åŠ å¯†ï¼šå…¬é’¥å’Œç§é’¥çš„æ–¹å¼æŠŠæ­£å¸¸é€šä¿¡çš„ KEY2 åå•†å¥½ï¼Œåå•†çš„è¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡å™¨æŠŠè‡ªå·±çš„å…¬é’¥ KEY1 ç”¨æ˜æ–‡ä¼ é€’ç»™å®¢æˆ·ç«¯ï¼Œè¿™é‡Œé¢æ¶‰åŠå¾ˆå¤šé«˜çº§ç®—æ³•ï¼šå¯¹ç§°åŠ å¯†çš„ä¸¤ç§æ¨¡å¼ï¼šæµå¼åŠ å¯†ã€åˆ†ç»„åŠ å¯†ã€‚åœ¨ç§˜é’¥äº¤æ¢çš„è¿‡ç¨‹ä¸­ï¼Œä¸­é—´äººå¯ä»¥æˆªè· KEY1ï¼Œæ¢æˆè‡ªå·±çš„å…¬é’¥ KEY3ï¼Œè¿™æ ·ä¸€æ¥ä¸­é—´äººä¾ç„¶å¯ä»¥è·å–æ­£å¸¸é€šä¿¡æ—¶çš„ç§˜é’¥ï¼Œäºæ˜¯å¼•å…¥äº†æ•°å­—è¯ä¹¦ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¯¹ç§°å†…å®¹åŠ å¯†&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å¯¹ç§°åŠ å¯†ï¼šåå•†åŠ å¯†ç®—æ³•å’Œç§˜é’¥ï¼Œä¸­é—´äººå¯ä»¥åœ¨ç¬¬ä¸€æ¬¡é€šä¿¡æ—¶æ‹¦æˆªåŠ å¯†æ–¹å¼å’Œç§˜é’¥ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;èº«ä»½è®¤è¯&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ•°å­—è¯ä¹¦&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æœåŠ¡ç«¯å‘æƒå¨æœºæ„ç”³è¯·è¯ä¹¦ã€‚&lt;br&gt;
å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯é€šä¿¡æ—¶ï¼ŒæœåŠ¡ç«¯å…ˆæŠŠè¯ä¹¦ä¼ é€’ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°è¯ä¹¦åï¼Œç”¨è¯ä¹¦æœºæ„çš„å…¬é’¥è§£å¯†è¯ä¹¦ç­¾åï¼Œç„¶åç”¨ç­¾åç”Ÿæˆçš„è§„åˆ™å†ç”Ÿæˆä¸€ä¸ªç­¾åï¼Œå¯¹æ¯”ä¸€è‡´å°±æ˜¯çœŸæ•´æ•°ï¼Œä¸ä¸€è‡´å°±æ˜¯å‡è¯ä¹¦ã€‚&lt;br&gt;
å¦‚æœç¡®è®¤æ˜¯çœŸè¯ä¹¦ï¼Œè§£å¯†æœåŠ¡å™¨å…¬é’¥ KEY1ï¼Œå†ç”Ÿæˆé€šä¿¡ç”¨çš„ç§˜é’¥ KEY2ï¼Œç”¨æœåŠ¡å™¨ç«¯çš„å…¬é’¥ KEY1 åŠ å¯†ï¼Œå‘ç»™æœåŠ¡ç«¯ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&#34;ä¸‰-https-ä½¿ç”¨æˆæœ¬&#34;&gt;ä¸‰ã€HTTPS ä½¿ç”¨æˆæœ¬&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;è¯ä¹¦è´¹ç”¨ä»¥åŠæ›´æ–°ç»´æŠ¤&lt;/li&gt;
&lt;li&gt;HTTPS é™ä½ç”¨æˆ·è®¿é—®é€Ÿåº¦&lt;/li&gt;
&lt;li&gt;æ¶ˆè€—CPUèµ„æºï¼Œéœ€è¦å¢åŠ å¤§é‡æœºå™¨&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;å››-https-å¯¹æ€§èƒ½çš„å½±å“&#34;&gt;å››ã€HTTPS å¯¹æ€§èƒ½çš„å½±å“&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;åè®®äº¤äº’æ‰€å¢åŠ çš„ç½‘ç»œRTT&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;RTTï¼šå¾€è¿”æ—¶å»¶ã€‚ä»å‘é€ç«¯å‘é€æ•°æ®å¼€å§‹ï¼Œåˆ°å‘é€ç«¯æ”¶åˆ°æ¥è‡ªæ¥æ”¶ç«¯çš„ç¡®è®¤æ€»å…±ç»è¿‡çš„æ—¶å»¶ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;åŠ è§£å¯†ç›¸å…³çš„è®¡ç®—è€—æ—¶&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;ç½‘ç»œè€—æ—¶&#34;&gt;ç½‘ç»œè€—æ—¶&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;19&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/HTTP%E7%BD%91%E7%BB%9C%E8%80%97%E6%97%B6.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;HTTP åè®®è®¿é—®ç½‘ç«™ï¼Œäº¤äº’å»¶è¿Ÿå¦‚ä¸Šå›¾ï¼Œç”¨æˆ·åªéœ€è¦å®Œæˆ TCP ä¸‰æ¬¡æ¡æ‰‹ï¼Œå»ºç«‹ TCP è¿æ¥å°±èƒ½ç›´æ¥å‘é€ HTTP è¯·æ±‚è·å–åº”ç”¨å±‚æ•°æ®äº†ã€‚é™¤æ­¤ä¹‹å¤–åœ¨è®¿é—®ç½‘ç»œçš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿæ²¡æœ‰éœ€è¦æ¶ˆè€—è®¡ç®—èµ„æºçš„åœ°æ–¹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;20&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/HTTPS%E7%BD%91%E7%BB%9C%E8%80%97%E6%97%B6.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;HTTPS è®¿é—®æµç¨‹å¦‚ä¸Šå›¾ã€‚&lt;br&gt;
â‘  TCP ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥ï¼Œä¸€ä¸ª RTT&lt;br&gt;
â‘¡ HTTP GET è¯·æ±‚æœåŠ¡ç«¯è¿”å› 302è·³è½¬åˆ° HTTPSï¼Œä¸€ä¸ª RTT å’Œ 302 è·³è½¬æ—¶å»¶ã€‚å› ä¸ºç”¨æˆ·ä¸ä¼šæ‰‹åŠ¨è¾“å…¥ https è®¿é—®ç½‘ç«™ï¼Œæ¯”å¦‚è¯´ç™¾åº¦ï¼Œç”¨æˆ·ä¸€èˆ¬è¾“å…¥ baidu.comï¼Œè€Œä¸ä¼šç›´æ¥è¾“å…¥ï¼šhttps://www.baidu.comï¼Œæ‰€ä»¥æœåŠ¡ç«¯åªèƒ½è¿”å› 302 å¼ºåˆ¶æµè§ˆå™¨è·³è½¬åˆ° HTTPSã€‚&lt;br&gt;
â‘¢ è€Œæµè§ˆå™¨å¤„ç† 302 è·³è½¬æœ¬èº«ä¹Ÿéœ€è¦è€—æ—¶ï¼Œè¿™ä¸ªè€—æ—¶æš‚ä¸”ä¸ç®—ï¼Œ302 è·³è½¬åˆ° https æœåŠ¡å™¨ä¹‹åï¼Œç”±äºç«¯å£å’ŒæœåŠ¡å™¨ä¸ä¸€æ ·ï¼Œæ‰€ä»¥éœ€è¦é‡æ–°å®Œæˆä¸‰æ¬¡æ¡æ‰‹ï¼Œå»ºç«‹ TCP è¿æ¥ã€‚è€—æ—¶ä¸€ä¸ª RTTã€‚&lt;br&gt;
â‘£ TLS å®Œå…¨æ¡æ‰‹é˜¶æ®µ1ï¼Œè€—æ—¶ä¸€ä¸ª RTTï¼Œè¿™ä¸ªé˜¶æ®µä¸»è¦å®ŒæˆåŠ å¯†å¥—ä»¶çš„åå•†å’Œè¯ä¹¦çš„èº«ä»½ç¡®è®¤ã€‚è¿™ä¸ªé˜¶æ®µä¸‹ï¼ŒæœåŠ¡ç«¯å’Œæµè§ˆå™¨ä¼šåå•†å‡ºæ¥ç›¸åŒçš„ç§˜é’¥äº¤æ¢ç®—æ³•ã€å¯¹ç§°åŠ å¯†ç®—æ³•ã€å†…å®¹ä¸€è‡´æ€§æ ¡éªŒç®—æ³•ã€è¯ä¹¦ç­¾åç®—æ³•ç­‰ã€‚&lt;br&gt;
æµè§ˆå™¨è·å–åˆ°è¯ä¹¦åï¼Œæ ¡éªŒè¯ä¹¦çš„æœ‰æ•ˆæ€§ï¼Œæ¯”å¦‚è¯ä¹¦æ˜¯å¦è¿‡æœŸï¼Œæ˜¯å¦æ’¤é”€ç­‰ï¼Œæµè§ˆå™¨é¦–å…ˆè·å–è¯ä¹¦é‡Œçš„ CA åŸŸåï¼Œå¦‚æœ CA åŸŸåæ²¡æœ‰å‘½ä¸­ç¼“å­˜çš„è¯ï¼Œæµè§ˆå™¨éœ€è¦è§£æ CA åŸŸåçš„ DNSï¼Œè¿™ä¸ª DNS è§£æè‡³å°‘è€—è´¹ä¸€ä¸ª RTTã€‚DNS è§£æåˆ° ip åï¼Œä¸‰æ¬¡æ¡æ‰‹ï¼Œå»ºç«‹ CA ç«™ç‚¹çš„ TCP è¿æ¥ï¼Œè€—æ—¶ä¸€ä¸ª RTTï¼Œæ¥ç€æµè§ˆå™¨å‘é€ Ocsp è¯·æ±‚è·å–å“åº”ï¼Œè€—æ—¶ä¸€ä¸ª RTT,&lt;br&gt;
Ocspï¼šåœ¨çº¿è¯ä¹¦çŠ¶æ€åè®®ï¼Œç»´æŠ¤æœåŠ¡å™¨å’Œå…¶ä»–ç½‘ç»œèµ„æºå®‰å…¨æ€§çš„ä¸¤ç§æ™®éæ¨¡å¼ä¹‹ä¸€ã€‚å¦å¤–ä¸€ä¸ªå«åš CRL è¯ä¹¦æ³¨é”€åˆ—è¡¨ã€‚å½“ç”¨æˆ·è¯•å›¾è®¿é—®ä¸€ä¸ªæœåŠ¡å™¨æ—¶ï¼Œåœ¨çº¿è¯ä¹¦çŠ¶æ€åè®®å‘é€ä¸€ä¸ªå¯¹äºè¯ä¹¦çŠ¶æ€ä¿¡æ¯çš„è¯·æ±‚ï¼ŒæœåŠ¡å™¨ä¼šå›å¤ä¸€ä¸ªæœ‰æ•ˆã€è¿‡æœŸæˆ–è€…æœªçŸ¥çš„å“åº”ã€‚åè®®è§„å®šäº†æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºçš„é€šä¿¡è¯­æ³•ï¼Œåœ¨çº¿è¯ä¹¦çŠ¶æ€åè®®ç»™ç”¨æˆ·åˆ°æœŸçš„è¯ä¹¦ä¸€ä¸ªå®½é™æœŸï¼Œè¿™æ ·ä»–ä»¬å°±å¯ä»¥åœ¨æ›´æ–°ä»¥å‰çš„ä¸€æ®µæ—¶é—´ç»§ç»­è®¿é—®åˆ°è¿™ä¸ªæœåŠ¡å™¨ã€‚è¿™é‡Œå°±éœ€è¦å‘èµ·å¯¹äºè¯ä¹¦çŠ¶æ€ä¿¡æ¯çš„è¯·æ±‚ï¼Œä¹Ÿéœ€è¦æ¶ˆè€—ä¸€ä¸ª RTTã€‚&lt;br&gt;
â‘¤ TLS å®Œå…¨æ¡æ‰‹é˜¶æ®µ2ï¼šç§˜é’¥åå•†ï¼Œè€—æ—¶ä¸€ä¸ª RTT å’Œè®¡ç®—æ—¶é—´ï¼Œè¿™ä¸ªå®Œå…¨æ¡æ‰‹ç»“æŸåï¼Œæµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´è¿›è¡Œåº”ç”¨å±‚ä¹Ÿå°±æ˜¯ HTTP çš„æ•°æ®ä¼ è¾“ã€‚è¿™å’Œ HTTP çš„æ–¹å¼å‡ ä¹æ˜¯ç›¸åŒçš„ã€‚&lt;br&gt;
ä¸€å…±è€—æ—¶ 7 ä¸ª RTTã€‚&lt;br&gt;
å¦‚æœä¸æ˜¯ç¬¬ä¸€æ¬¡è¯·æ±‚ï¼Œæ¯”å¦‚ CA åŸŸåè§£æï¼Œå¦‚æœæœ‰ç¼“å­˜çš„è¯ï¼Œå°±æ— éœ€è¿›è¡Œ DNS è§£æï¼Œå°±å¯ä»¥å‡å°‘ä¸€ä¸ª RTTã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;è®¡ç®—è€—æ—¶&#34;&gt;è®¡ç®—è€—æ—¶&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;æµè§ˆå™¨è®¡ç®—è€—æ—¶&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;æµè§ˆå™¨è§£æè¯ä¹¦ç­¾åï¼Œç§˜é’¥äº¤æ¢ï¼Œåº”ç”¨å±‚æ•°æ®åŠ å¯†ã€è§£å¯†ï¼Œä¸€è‡´æ€§çš„äº¤æ¢&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;æœåŠ¡ç«¯è®¡ç®—è€—æ—¶&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ç§˜é’¥äº¤æ¢ï¼Œåº”ç”¨å±‚æ•°æ®åŠ å¯†ã€è§£å¯†è€—æ—¶ã€‚&lt;br&gt;
ç”±äºå®¢æˆ·ç«¯ CPU å’Œæ“ä½œç³»ç»Ÿç§ç±»æ¯”è¾ƒå¤šï¼Œæ‰€ä»¥è®¡ç®—è€—æ—¶ä¸èƒ½ä¸€æ¦‚è€Œè®ºã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&#34;äº”-https-å¸¸è§é—®é¢˜&#34;&gt;äº”ã€HTTPS å¸¸è§é—®é¢˜&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;httpsåŠ å¯†æ˜¯ä¸æ˜¯éœ€è¦æˆ‘åœ¨ç”µè„‘ä¸Šå®‰è£…è¯ä¹¦/ä¿å­˜å¯†ç ï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸éœ€è¦ï¼Œæ“ä½œç³»ç»Ÿã€æµè§ˆå™¨æŠŠè¿™äº›æ“ä½œéƒ½åšå¥½äº†&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;https ä¸å°±æ˜¯åœ¨httpåé¢åŠ ä¸ªsï¼Œå¾ˆéš¾ä¹ˆï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;HTTPS åŒ…å«è¯ä¹¦ã€æµé‡è½¬å‘ã€è´Ÿè½½å‡è¡¡......&lt;br&gt;
å°å‹ç½‘ç«™ä¸éš¾ï¼Œå¤§å‹ç½‘ç«™å¾ˆéš¾&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;https è§£å†³äº†æ‰€æœ‰åŠ«æŒé—®é¢˜å—ï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;https æ˜¯ä¸ºäº†è§£å†³ä¸­é—´äººæ”»å‡»ï¼Œå‡è®¾åœ¨ https é¡µé¢ä¸­åŠ è½½äº† http èµ„æºï¼Œhttp èµ„æºè¿˜æ˜¯æœ‰åŠ«æŒçš„é£é™©ï¼Œå®¢æˆ·ç«¯ã€å±€åŸŸç½‘çš„é£é™©ä¹Ÿå¾ˆå¤§ï¼Œæ¶æ„æ’ä»¶ã€æœ¨é©¬ã€è·¯ç”±å™¨ã€DNS ä¹Ÿéƒ½éå¸¸è„†å¼±ã€‚HTTPS èƒ½å¤Ÿåœ¨ç»å¤§éƒ¨åˆ†ä¸‹ä¿è¯äº’è”ç½‘è®¿é—®æ•°æ®ä¼ è¾“çš„å®‰å…¨æ€§ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
">HTTPç³»åˆ—ï¼ˆå››ï¼‰å®‰å…¨çš„HTTPS</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/http-xi-lie-san-shou-xi-http-xie-yi-jie-gou-he-tong-xun-yuan-li/"" data-c="
          &lt;h1 id=&#34;http-åè®®ä¹‹èº«ä»½è®¤è¯&#34;&gt;HTTP åè®®ä¹‹èº«ä»½è®¤è¯&lt;/h1&gt;
&lt;h2 id=&#34;èº«ä»½è®¤è¯ä¿¡æ¯&#34;&gt;èº«ä»½è®¤è¯ä¿¡æ¯&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å¯†ç &lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;åªæœ‰æœ¬äººæ‰çŸ¥é“çš„å­—ç¬¦ä¸²ä¿¡æ¯&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;åŠ¨æ€ä»¤ç‰Œ&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ä»…é™æœ¬äººæŒæœ‰çš„è®¾å¤‡å†…æ˜¾ç¤ºçš„ä¸€æ¬¡æ€§å¯†ç &lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;æ•°å­—è¯ä¹¦&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;åªæœ‰æœ¬äººç»ˆç«¯æŒæœ‰çš„ä¿¡æ¯&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;ç”Ÿç‰©è®¤è¯&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;æŒ‡çº¹ã€è™¹è†œ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;IC å¡ç­‰&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ä»…é™æœ¬äººæŒæœ‰çš„&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;èº«ä»½è®¤è¯ä¿¡æ¯æ—¶ç”¨æ¥æ ¸å¯¹åªæœ‰ç™»é™†è€…æœ¬äººæ‰çŸ¥é“ã€æ‹¥æœ‰çš„ä¿¡æ¯å†…å®¹ï¼Œä½†æ˜¯å³ä¾¿å¯¹æ–¹æ˜¯å‡å†’ç”¨æˆ·ï¼Œåªè¦èƒ½å¤Ÿé€šè¿‡ç”¨æˆ·è®¤è¯ï¼ŒHTTP æœåŠ¡å™¨å°±ä¼šé»˜è®¤è¿™æ˜¯å‡ºè‡ªäºæœ¬äººçš„è¡Œä¸ºã€‚å› æ­¤æŒæ§æœºå¯†æ€§çš„å¯†ç ä¸èƒ½è®©å…¶ä»–äººå¾—åˆ°ï¼Œæ›´ä¸èƒ½è½»æ˜“è¢«ç ´è§£ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;å¸¸è§è®¤è¯æ–¹å¼&#34;&gt;å¸¸è§è®¤è¯æ–¹å¼&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;BASIC è®¤è¯ï¼ˆåŸºæœ¬è®¤è¯ï¼‰&lt;/li&gt;
&lt;li&gt;DIGEST è®¤è¯ï¼ˆæ‘˜è¦è®¤è¯ï¼‰&lt;/li&gt;
&lt;li&gt;SSL å®¢æˆ·ç«¯è®¤è¯&lt;/li&gt;
&lt;li&gt;FormBase è®¤è¯ï¼ˆåŸºäºè¡¨å•è®¤è¯ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;basic-è®¤è¯&#34;&gt;BASIC è®¤è¯&lt;/h2&gt;
&lt;h3 id=&#34;ä»€ä¹ˆæ˜¯-basic-è®¤è¯&#34;&gt;ä»€ä¹ˆæ˜¯ BASIC è®¤è¯&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ä» HTTP1.0 å°±å®šä¹‰çš„ä¸€ç§è®¤è¯æ–¹å¼ï¼Œç°åœ¨ä»æœ‰ä¸€éƒ¨åˆ†ç½‘ç«™åœ¨ä½¿ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/BASIC%E8%AE%A4%E8%AF%81.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;WEB æœåŠ¡å™¨ä¸é€šä¿¡å®¢æˆ·ç«¯ä¹‹é—´è¿›è¡Œçš„ç»Ÿä¸€è®¤è¯æ–¹å¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;basic-è®¤è¯è¿‡ç¨‹&#34;&gt;BASIC è®¤è¯è¿‡ç¨‹&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/BASIC%E8%AE%A4%E8%AF%81%E8%BF%87%E7%A8%8B.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;å®¢æˆ·ç«¯å‘é€éœ€è¦ BASIC è®¤è¯çš„è¯·æ±‚èµ„æº&lt;/li&gt;
&lt;li&gt;å½“è¯·æ±‚çš„èµ„æºéœ€è¦ BASIC è®¤è¯æ—¶ï¼ŒæœåŠ¡å™¨ä¼šéšçŠ¶æ€ç  401 è¿”å›ä¸€ä¸ª Authorization Requiredï¼Œå‘Šè¯‰å®¢æˆ·ç«¯éœ€è¦èº«ä»½è®¤è¯&lt;/li&gt;
&lt;li&gt;æ¥æ”¶åˆ°çŠ¶æ€ç  401 çš„å®¢æˆ·ç«¯ä¸ºäº†é€šè¿‡ BASIC è®¤è¯ï¼Œéœ€è¦å°†ç”¨æˆ·åã€å¯†ç å‘é€ç»™æœåŠ¡å™¨ï¼Œå‘é€çš„å­—ç¬¦å’Œå†…å®¹å½¢å¼ä¸ºæ˜¯ç”¨æˆ·åå’Œå¯†ç ï¼Œä¸­é—´ç”¨ â€œï¼šâ€ æ‹¼æ¥ï¼Œå°†å…¶ç»è¿‡ Base64 çš„ç¼–ç åå†™å…¥åˆ°é¦–éƒ¨å­—æ®µ Authorizationï¼Œå¹¶åœ¨å‰é¢åŠ ä¸Šâ€œBasic â€ï¼Œè¡¨æ˜è¦æ‰§è¡Œçš„æ˜¯ Basic è®¤è¯ï¼Œå‘é€ç»™æœåŠ¡å™¨ã€‚&lt;/li&gt;
&lt;li&gt;æœåŠ¡å™¨ç«¯æ¥æ”¶åˆ°åŒ…å«é¦–éƒ¨å­—æ®µ Authorization çš„è¯·æ±‚åï¼Œä¼šå»è®¤è¯ä¿¡æ¯çš„æ­£ç¡®æ€§ï¼Œå¦‚æœéªŒè¯é€šè¿‡ï¼Œè¿”å›åŒ…å« Request URI çš„èµ„æºå“åº”ï¼Œè¿”å›çš„æ˜¯ 200ï¼›å¦‚æœè®¤è¯å¤±è´¥ï¼Œç»§ç»­è¿”å› 401ï¼Œè¡¨ç¤ºè®¤è¯æœªé€šè¿‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;BASIC è®¤è¯è™½ç„¶é‡‡ç”¨ Base64 çš„ç¼–ç æ–¹å¼ï¼Œä½†æ˜¯è¿™ä¸æ˜¯åŠ å¯†å¤„ç†ï¼Œä¸éœ€è¦ä»»ä½•é™„åŠ ä¿¡æ¯å°±å¯ä»¥å¯¹ Base64 è¿›è¡Œè§£ç ï¼Œç”±äºæ˜æ–‡è§£ç åå°±æ˜¯ç”¨æˆ·åå’Œå¯†ç ï¼Œåœ¨ HTTP è¿™æ ·éåŠ å¯†é€šä¿¡çš„çº¿è·¯ä¸Šï¼Œè¿›è¡Œ BASIC è®¤è¯çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœä¸å°å¿ƒè¢«åˆ«äººçªƒå¬äº†ï¼Œè¢«ç›—çš„å¯èƒ½æ€§å°±ä¼šéå¸¸å¤§ã€‚&lt;br&gt;
BASIC è®¤è¯åœ¨ä½¿ç”¨ä¸Šä¸å¤Ÿä¾¿æ·çµæ´»ï¼Œè€Œä¸”ä¸å®‰å…¨ï¼Œæ‰€ä»¥å¹¶ä¸å¸¸ç”¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;digest-è®¤è¯&#34;&gt;DIGEST è®¤è¯&lt;/h2&gt;
&lt;h3 id=&#34;ä»€ä¹ˆæ˜¯digestè®¤è¯&#34;&gt;ä»€ä¹ˆæ˜¯DIGESTè®¤è¯ï¼Ÿ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ä¸ºå¼¥è¡¥BASICè®¤è¯å­˜åœ¨çš„å¼±ç‚¹ï¼Œä»HTTP/1.1èµ·å°±æœ‰äº†DIGESTè®¤è¯ã€‚&lt;/li&gt;
&lt;li&gt;DIGEST è®¤è¯åŒæ ·ä½¿ç”¨è´¨è¯¢/å“åº”çš„æ–¹å¼ï¼Œä½†ä¸ä¼šåƒBASICè®¤è¯é‚£æ ·ç›´æ¥å‘é€æ˜æ–‡å¯†ç ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;è´¨è¯¢-å“åº”æ–¹å¼ï¼šä¸€æ–¹å…ˆå‘é€è®¤è¯è¦æ±‚ç»™å¦ä¸€æ–¹ï¼Œä½¿ç”¨ä»å¦ä¸€æ–¹æ¥æ”¶åˆ°çš„è´¨è¯¢ç ï¼Œè®¡ç®—ç”Ÿæˆå“åº”ç ï¼Œæœ€åå°†å“åº”ç è¿”å›ç»™å¯¹æ–¹è¿›è¡Œè®¤è¯ã€‚&lt;br&gt;
å› ä¸ºå‘é€ç»™å¯¹æ–¹çš„åªæ˜¯å“åº”æ‘˜è¦ï¼Œä»¥åŠç”±è´¨è¯¢ç äº§ç”Ÿçš„è®¡ç®—ç»“æœï¼Œæ‰€ä»¥æ¯” BASIC è®¤è¯å¤šäº†ä¸€å±‚ä¿æŠ¤ï¼Œå¯†ç æ³„éœ²çš„å¯èƒ½æ€§ä¹Ÿå°±é™ä½äº†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;digest-è®¤è¯è¿‡ç¨‹&#34;&gt;DIGEST è®¤è¯è¿‡ç¨‹&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/DIGEST%E8%AE%A4%E8%AF%81%E8%BF%87%E7%A8%8B.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;å®¢æˆ·ç«¯å‘é€éœ€è¦ DIGEST è®¤è¯çš„è¯·æ±‚&lt;/li&gt;
&lt;li&gt;æœåŠ¡ç«¯è¿”å›çŠ¶æ€ç  401ï¼ŒåŒæ—¶é‡Œé¢åŒ…å«ä¸€ä¸ªå¤´éƒ¨å­—æ®µï¼ŒåŒ…å«è´¨è¯¢-å“åº”è®¤è¯æ–¹å¼æ‰€éœ€è¦çš„ä¸´æ—¶è´¨è¯¢ç ï¼Œè´¨è¯¢ç æ˜¯ä¸€ä¸ªéšæœºæ•° nonceï¼Œä¸€æ¬¡è¿”å›éƒ½æ˜¯ 401 å“åº”ç”Ÿæˆçš„ä»»æ„éšæœºçš„ Base64 ç¼–ç çš„å­—ç¬¦ä¸²ï¼Œå¤šæ•°æƒ…å†µä¸‹ï¼Œç”±ä¸€ä¸²æ•°å­—ã€æˆ–ä¸€ä¸²å­—ç¬¦æˆ–ä¸€ä¸²å…¶ä»–çš„ç»„æˆ&lt;/li&gt;
&lt;li&gt;æ¥æ”¶åˆ° 401 çŠ¶æ€ç çš„å®¢æˆ·ç«¯è¿”å›çš„å“åº”ä¸­åŒ…å« DIGEST è®¤è¯å¿…é¡»è¦çš„å¤´éƒ¨å­—æ®µ Authorizationï¼ŒåŒ…å«è¿™äº›ä¿¡æ¯ï¼šDigest username=&amp;quot;xxx&amp;quot;, realm=&amp;quot;DIGEST&amp;quot;, nonce=&amp;quot;xxxxx&amp;quot;, url=&amp;quot;&amp;quot;, response=&amp;quot;&amp;quot; ï¼Œå…¶ä¸­ realm å’Œ nonce å°±æ˜¯ä»æœåŠ¡å™¨ç«¯æ¥æ”¶å’Œå“åº”çš„å­—æ®µã€‚username æ˜¯ realm é™å®šèŒƒå›´å†…å¯è¿›è¡Œè®¤è¯çš„å†…å®¹ï¼Œresponse å­˜æ”¾ç»è¿‡ MD5 ç®—æ³•è¿ç®—ç”Ÿæˆçš„å¯†ç å­—ç¬¦ä¸²ã€‚&lt;/li&gt;
&lt;li&gt;æœåŠ¡å™¨æ¥æ”¶åˆ°åŒ…å«é¦–éƒ¨å­—æ®µçš„ Authorizationï¼ŒæœåŠ¡å™¨ç«¯æ¥æ”¶åˆ°è¿™ä¸ªè¯·æ±‚ä¼šç¡®è®¤è®¤è¯ä¿¡æ¯çš„æ­£ç¡®æ€§&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;DIGEST è®¤è¯æä¾›äº†é«˜äº BASIC è®¤è¯çš„å®‰å…¨ç­‰çº§ï¼Œä½†æ˜¯å’Œ HTTPS å®¢æˆ·ç«¯è®¤è¯ç›¸æ¯”è¿˜æ˜¯å¾ˆå¼±ã€‚DIGEST è®¤è¯æä¾›äº† &lt;strong&gt;â€œé˜²æ­¢å¯†ç è¢«çªƒå¬&lt;/strong&gt;â€ çš„ä¿æŠ¤æœºåˆ¶ï¼Œä½†æ˜¯å¹¶ä¸å­˜åœ¨ â€œ&lt;strong&gt;é˜²æ­¢ç”¨æˆ·ä¼ªè£…&lt;/strong&gt;â€ çš„ä¿æŠ¤æœºåˆ¶ã€‚DIGEST è®¤è¯å’Œ BASIC è®¤è¯ä¸€æ ·ï¼Œä½¿ç”¨ä¸Šä¸é‚£ä¹ˆä¾¿æ·çµæ´»ï¼Œå®‰å…¨æ€§ä¸å¤Ÿï¼Œé€‚ç”¨èŒƒå›´æœ‰é™ã€‚&lt;br&gt;
ä½¿ç”¨ç”¨æˆ·åã€å¯†ç çš„è®¤è¯æ–¹å¼ï¼Œåªè¦äºŒè€…çš„å†…å®¹æ­£ç¡®å°±å¯ä»¥è®¤ä¸ºæ˜¯æœ¬äººçš„è¡Œä¸ºï¼Œä½†æ˜¯å¦‚æœç”¨æˆ·åå’Œå¯†ç è¢«ç›—ï¼Œå°±å¾ˆæœ‰å¯èƒ½&lt;strong&gt;è¢«ç¬¬ä¸‰æ–¹å†’å……&lt;/strong&gt;ã€‚æ‰€ä»¥åˆ©ç”¨ SSL å®¢æˆ·ç«¯è®¤è¯ï¼Œå°±å¯ä»¥é¿å…è¿™ç§æƒ…å†µçš„å‘ç”Ÿã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;sslå®¢æˆ·ç«¯è®¤è¯&#34;&gt;SSLå®¢æˆ·ç«¯è®¤è¯&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;SSL å®¢æˆ·ç«¯è®¤è¯æ˜¯å€Ÿç”±HTTPSçš„å®¢æˆ·ç«¯&lt;strong&gt;è¯ä¹¦&lt;/strong&gt;å®Œæˆè®¤è¯çš„æ–¹å¼ã€‚å‡­å€Ÿå®¢æˆ·ç«¯è¯ä¹¦è®¤è¯ï¼ŒæœåŠ¡å™¨å¯ç¡®è®¤è®¿é—®æ˜¯å¦æ¥è‡ªå·²ç™»å½•çš„å®¢æˆ·ç«¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;é“¶è¡Œç½‘é“¶ï¼šå…ˆè¾“å…¥ç”¨æˆ·åã€å¯†ç ï¼Œè¾“å…¥æ­£ç¡®åä¸‹è½½å®ƒä»¬çš„è¯ä¹¦ï¼Œä¸‹è½½å¥½ä¹‹åï¼Œä»¥åæ¯æ¬¡ç™»å½•ä¼šæŠŠè¯ä¹¦ä¹Ÿé€šè¿‡ HTTP æŠ¥æ–‡çš„æ–¹å¼å‘ç»™æœåŠ¡å™¨ï¼Œå¼€å§‹é€šä¿¡ã€‚&lt;br&gt;
ç»†èŠ‚è¿‡ç¨‹ï¼šâ‘ å½“æœåŠ¡å™¨æ¥æ”¶åˆ°éœ€è¦è®¤è¯èµ„æºçš„è¯·æ±‚ï¼ŒæœåŠ¡å™¨ç»™å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªæŠ¥æ–‡è¦æ±‚å®¢æˆ·ç«¯æä¾›å®¢æˆ·ç«¯è¯ä¹¦ï¼Œâ‘¡ç”¨æˆ·é€‰æ‹©å°†å‘é€çš„å®¢æˆ·ç«¯è¯ä¹¦åï¼Œå®¢æˆ·ç«¯ä¼šæŠŠå®¢æˆ·ç«¯è¯ä¹¦ä¿¡æ¯ä»¥æŠ¥æ–‡æ–¹å¼å‘é€ç»™æœåŠ¡å™¨ï¼Œâ‘¢æœåŠ¡å™¨éªŒè¯å®¢æˆ·ç«¯è¯ä¹¦ï¼ŒéªŒè¯é€šè¿‡åï¼Œå°±å¯ä»¥é¢†å–è¯ä¹¦å†…å®¢æˆ·ç«¯çš„å…¬å¼€ç§˜é’¥ï¼Œç„¶åå¼€å§‹ HTTPS çš„åŠ å¯†é€šä¿¡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;åŸºäºè¡¨å•çš„è®¤è¯&#34;&gt;åŸºäºè¡¨å•çš„è®¤è¯&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;åŸºäºè¡¨å•çš„è®¤è¯æ–¹æ³•å¹¶ä¸æ˜¯åœ¨HTTPåè®®ä¸­å®šä¹‰çš„ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ç”±Webåº”ç”¨ç¨‹åºå„è‡ªå®ç°åŸºäºè¡¨å•çš„è®¤è¯æ–¹å¼ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡Cookieå’ŒSessionçš„æ–¹å¼æ¥ä¿æŒç”¨æˆ·çš„çŠ¶æ€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;http-çš„é•¿è¿æ¥ä¸çŸ­è¿æ¥&#34;&gt;HTTP çš„é•¿è¿æ¥ä¸çŸ­è¿æ¥&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;èµ„æºæ¶ˆè€—çš„ä¼˜åŒ–ï¼šé•¿è¿æ¥ã€‚&lt;br&gt;
è¿æ¥å¥½æ¯”ä» A åœ°åˆ° B åœ°çš„äº¤é€šæ–¹å¼ï¼Œæƒ³ä» A åœ°åˆ° B åœ°ï¼Œæ‰“è½¦è¿‡å»ï¼Œè¿™æ ·æ˜¯ä¸€ä¸ªçŸ­è¿æ¥ï¼Œå°±è¿é€šäº†ä¸€ä¸‹ï¼Œæ²¡åŠæ³•è®©æ›´å¤šçš„äººä¸Šè½¦ï¼›åæ¥å‘ç°ä» A å» B çš„äººå¾ˆå¤šï¼Œäºæ˜¯å¼€é€šäº†ä¸€æ¡åœ°é“çº¿ï¼Œå»ºç«‹äº†ä¸€æ¡é•¿è¿æ¥ï¼Œå¾ˆå¤šäººéƒ½å¯ä»¥å¤ç”¨è¿™ä¸ªè¿æ¥ã€‚&lt;br&gt;
èƒ½ä¸€æ¬¡æ€§èŠ‚çº¦å¾ˆå¤šèµ„æºçš„ã€æœåŠ¡å¾ˆå¤šæ¬¡çš„æ˜¯é•¿è¿æ¥ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;HTTPåè®®æ˜¯åŸºäºè¯·æ±‚/å“åº”æ¨¡å¼çš„ï¼Œå› æ­¤åªè¦æœåŠ¡ç«¯ç»™äº†å“åº”ï¼Œæœ¬æ¬¡HTTPè¯·æ±‚å°±ç»“æŸäº†ã€‚&lt;/li&gt;
&lt;li&gt;HTTPçš„é•¿è¿æ¥å’ŒçŸ­è¿æ¥æœ¬è´¨ä¸Šæ˜¯&lt;strong&gt;TCPé•¿è¿æ¥å’ŒçŸ­è¿æ¥&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;HTTP åè®®æ˜¯åº”ç”¨å±‚åè®®ï¼Œä¼ è¾“å±‚ä½¿ç”¨çš„æ˜¯ TCP åè®®ï¼Œç½‘ç»œå±‚ä½¿ç”¨çš„æ˜¯IP åè®®ï¼ŒIP åè®®ä¸»è¦è§£å†³ç½‘ç»œè·¯ç”±ã€å¯»å€çš„é—®é¢˜ï¼Œ TCP åè®®è§£å†³çš„æ˜¯å¦‚ä½•åœ¨ IP å±‚ä¹‹ä¸Šå¯é çš„ä¼ é€’æ•°æ®åŒ…ï¼Œä½¿å¾—åœ¨æ¥æ”¶ç«¯èƒ½æ”¶åˆ°å‘é€æ–¹å‘é€çš„æ‰€æœ‰åŒ…ï¼Œå¹¶ä¸”é¡ºåºä¸å‘å‡ºé¡ºåºä¸€è‡´ã€‚&lt;br&gt;
HTTP åˆ†æˆé•¿è¿æ¥å’ŒçŸ­è¿æ¥ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ TCP è¿æ¥ã€‚TCP è¿æ¥æ˜¯ä¸€ä¸ªåŒå‘é€šé“ï¼Œå¯ä»¥ä¿æŒä¸€æ®µæ—¶é—´ä¸å…³é—­ï¼Œå› æ­¤ TCP è¿æ¥æ‰æœ‰çœŸæ­£çš„é•¿è¿æ¥å’ŒçŸ­è¿æ¥ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;HTTP/1.0ä¸­ï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯&lt;strong&gt;çŸ­è¿æ¥&lt;/strong&gt;ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæµè§ˆå™¨å’ŒæœåŠ¡å™¨æ¯è¿›è¡Œä¸€æ¬¡HTTPæ“ä½œï¼Œå°±å»ºç«‹ä¸€æ¬¡è¿æ¥ï¼Œç»“æŸå°±ä¸­æ–­ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;å¦‚æœå®¢æˆ·ç«¯æµè§ˆå™¨è®¿é—®æŸä¸ª htmlï¼Œè¯¥ html å†…åŒ…å«å…¶ä»– jsã€cssã€img èµ„æºï¼Œå½“æµè§ˆå™¨æ¯é‡åˆ°ä¸€ä¸ª web èµ„æºï¼Œå°±ä¼šå»ºç«‹ä¸€ä¸ª HTTP ä¼šè¯ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;HTTP/1.1èµ·ï¼Œé»˜è®¤ä½¿ç”¨&lt;strong&gt;é•¿è¿æ¥&lt;/strong&gt;ï¼Œç”¨ä»¥ä¿æŒè¿æ¥ç‰¹æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/HTTP%E9%95%BF%E8%BF%9E%E6%8E%A5.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;ä½¿ç”¨é•¿è¿æ¥çš„æƒ…å†µæ—¶ï¼Œå½“ä¸€ä¸ªç½‘é¡µæ‰“å¼€å®Œæˆåï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ç”¨äºä¼ è¾“ HTTP æ•°æ®çš„ TCP è¿æ¥ä¸ä¼šå…³é—­ï¼Œå¦‚æœå®¢æˆ·ç«¯å†æ¬¡è®¿é—®è¿™ä¸ªæœåŠ¡å™¨ä¸Šçš„ç½‘é¡µï¼Œä¼šç»§ç»­ä½¿ç”¨è¿™ä¸€æ¡å·²ç»å»ºç«‹çš„è¿æ¥ï¼Œè¿™ä¸ª keep-alive ä¸ä¼šæ°¸ä¹…ä¿æŒè¿æ¥ï¼Œæœ‰ä¸€ä¸ªä¿æŒæ—¶é—´ï¼Œåœ¨ä¸åŒçš„æœåŠ¡å™¨è½¯ä»¶å¯ä»¥è®¾ç½®ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;çŸ­è¿æ¥ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å»ºç«‹è¿æ¥ä¸€æ•°æ®ä¼ è¾“ä¸€å…³é—­è¿æ¥..å»ºç«‹è¿æ¥ä¸€æ•°æ®ä¼ è¾“ä¸€å…³é—­è¿æ¥&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€è¿æ¥è¯·æ±‚ï¼ŒServer æ¥åˆ°è¯·æ±‚ï¼ŒåŒæ–¹å»ºç«‹è¿æ¥ï¼Œå®¢æˆ·ç«¯å‘ Server å‘é€æ¶ˆæ¯ï¼ŒServer å›åº” Clientï¼Œä¸€æ¬¡è¯»å†™å°±å®Œæˆäº†ï¼Œè¿™æ—¶å€™åŒæ–¹ä»»ä½•ä¸€ä¸ªéƒ½å¯ä»¥å‘èµ· close å…³é—­çš„æ“ä½œï¼Œä¸€èˆ¬éƒ½æ˜¯ Client å…ˆå‘èµ· closeã€‚çŸ­è¿æ¥ä¸€èˆ¬åªä¼šåœ¨ Client-Server é—´ä¼ é€’ä¸€æ¬¡è¯»å†™æ“ä½œã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;é•¿è¿æ¥ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å»ºç«‹è¿æ¥â€”æ•°æ®ä¼ è¾“â€¦ï¼ˆä¿æŒè¿æ¥ï¼‰.â€¦æ•°æ®ä¼ è¾“â€”â€”å…³é—­è¿æ¥&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Client å‘ Server å‘èµ·è¿æ¥è¯·æ±‚ï¼ŒServer æ¥å— Client çš„è¯·æ±‚ï¼ŒåŒæ–¹å»ºç«‹è¿æ¥ï¼ŒClient ä¸ Server å®Œæˆä¸€æ¬¡è¯»å†™ä¹‹åï¼Œå®ƒä»¬ä¹‹é—´çš„è¿æ¥ä¸ä¼šä¸»åŠ¨å…³é—­ï¼Œåç»­çš„è¯»å†™æ“ä½œä¼šç»§ç»­ä½¿ç”¨è¿™ä¸ªè¿æ¥ã€‚&lt;br&gt;
çŸ­è¿æ¥å¯¹äºæœåŠ¡å™¨æ¥è¯´ï¼Œå®ƒçš„ç®¡ç†è¾ƒä¸ºç®€å•ï¼Œå­˜åœ¨çš„è¿æ¥éƒ½æ˜¯æœ‰ç”¨çš„è¿æ¥ï¼Œä¸éœ€è¦é¢å¤–çš„æ§åˆ¶æ‰‹æ®µï¼Œä½†å¦‚æœå®¢æˆ·è¯·æ±‚é¢‘ç¹ï¼Œå°†åœ¨ TCP å»ºç«‹å’Œå…³é—­çš„æ“ä½œä¸Šæµªè´¹æ—¶é—´ä¹Ÿæµªè´¹å¸¦å®½ï¼Œå“åº”çš„ååº”é€Ÿåº¦å°±ä¼šå˜æ…¢ï¼Œå®¢æˆ·ä½“éªŒæ„Ÿä¸å¥½ã€‚&lt;br&gt;
é•¿è¿æ¥å¯ä»¥çœå»è¾ƒå¤šçš„ TCP è¿æ¥å’Œå…³é—­çš„æ—¶é—´ï¼Œå‡å°‘æµªè´¹ã€èŠ‚çº¦æ—¶é—´ï¼Œå¯¹äºé¢‘ç¹è¯·æ±‚èµ„æºçš„å®¢æˆ·æ¥è¯´ï¼Œæ¯”è¾ƒé€‚åˆä½¿ç”¨é•¿è¿æ¥ã€‚åœ¨é•¿è¿æ¥çš„åº”ç”¨åœºæ™¯ä¸‹ï¼Œ Client ç«¯ä¸€èˆ¬ä¸ä¼šä¸»åŠ¨å…³é—­è¿æ¥ï¼Œä¸çŸ­è¿æ¥ä¸åŒï¼ŒClient ä¸ Server ä¹‹é—´çš„è¿æ¥å¦‚æœä¸€ç›´ä¸å…³é—­çš„è¯ï¼Œå°±ä¼šå­˜åœ¨é—®é¢˜ï¼šéšç€å®¢æˆ·ç«¯è¿æ¥è¶Šæ¥è¶Šå¤šï¼ŒServer æ‰¿å—ä¸ä½ï¼Œè¿™æ—¶ Server ç«¯éœ€è¦é‡‡å–ä¸€äº›ç­–ç•¥ï¼Œæ¯”å¦‚è¯´ï¼Œå…³é—­ä¸€äº›é•¿æ—¶é—´æ²¡æœ‰è¯»å†™äº‹ä»¶å‘ç”Ÿçš„è¿æ¥ï¼Œå¯ä»¥é¿å…ä¸€äº›æ¶æ„è¿æ¥å¯¼è‡´ Server ç«¯æœåŠ¡å—æŸã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&#34;http-ä¸­ä»‹ä¹‹ä»£ç†&#34;&gt;HTTP ä¸­ä»‹ä¹‹ä»£ç†&lt;/h1&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/HTTP%E4%B8%AD%E4%BB%8B%E4%B9%8B%E4%BB%A3%E7%90%86.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸€èˆ¬æƒ…å†µä¸‹æ˜¯å®¢æˆ·ç«¯ç›´æ¥ä¸æœåŠ¡å™¨è¿æ¥ï¼Œä½†æ˜¯å‡ºäºä¸æ–¹ä¾¿æˆ–æ˜¯å…¶ä»–çš„ç‰¹æ®ŠåŸå› ï¼Œå¯èƒ½ä¼šé€šè¿‡ä¸€ä¸ªä¸­é—´äººä¸æœåŠ¡å™¨è¿æ¥ã€‚è¿™ä¸ªä¸­é—´äººå°±å«åš &lt;strong&gt;web ä»£ç†&lt;/strong&gt;ï¼Œè¿™ä¸ªä¸­é—´äºº&lt;strong&gt;æ—¢æ˜¯å®¢æˆ·ç«¯ã€åˆæ˜¯æœåŠ¡ç«¯&lt;/strong&gt;ï¼Œå¯¹äºæœåŠ¡å™¨æ¥è¯´ï¼Œç”±äºè¯·æ±‚æ˜¯ä»ä»£ç†è®¿é—®è¿‡æ¥çš„ï¼Œæ‰€ä»¥åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä»£ç†èµ·åˆ°äº†å®¢æˆ·ç«¯çš„ä½œç”¨ï¼›è€Œå¯¹äºçœŸæ­£çš„å®¢æˆ·ç«¯æ¥è¯´ï¼Œè¯·æ±‚æ˜¯å‘ç»™ä»£ç†çš„ï¼Œæ‰€ä»¥ä»£ç†èµ·åˆ°äº†æœåŠ¡å™¨çš„ä½œç”¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;ä»£ç†çš„ä½œç”¨&#34;&gt;ä»£ç†çš„ä½œç”¨&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;æŠ“åŒ…&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸ºäº†èƒ½å¤Ÿæ›´å¥½çš„åˆ†æ HTTP è¯·æ±‚ï¼Œæˆ–è€…è¾¾åˆ°å®‰å…¨æªæ–½çš„ç›®çš„ï¼Œåªæœ‰ä½¿ç”¨ä»£ç†æ‰å¯ä»¥æ›´å¥½çš„å¯¹å®¢æˆ·ç«¯çš„æ•°æ®åŒ…è¿›è¡Œæ‹¦æˆªï¼Œåœ¨è¿™é‡Œä»£ç†çš„åå­—æœ‰å¦å¤–ä¸€ç§å«æ³•ï¼šæ‹¦æˆªæœåŠ¡å™¨&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;FQ&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;å¦‚æœæƒ³é€šè¿‡è®¡ç®—æœºè®¿é—® facebookï¼Œç”±äºé•¿åŸé˜²ç«å¢™å±è”½äº† facebookã€YouTube è¿™äº›ç½‘ç«™ï¼Œä¸å¯ç›´æ¥è®¿é—®ï¼Œå°±è¦é€šè¿‡ä»£ç†ç¿»å¢™ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/FQ.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;åŒ¿åè®¿é—®&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;HTTP åè®®æœ¬èº«å…·æœ‰åŒ¿åæ€§ï¼ŒHTTP ä»£ç†æœåŠ¡å™¨é€šè¿‡åˆ é™¤ HTTP æŠ¥æ–‡ä¸­çš„èº«ä»½ç‰¹æ€§ï¼Œæ¯”å¦‚å®¢æˆ·ç«¯çš„ IP åœ°å€ã€Cookieã€ä¼šè¯ ID ç­‰ï¼Œä»è€Œå¯¹è¿œç«¯çš„æœåŠ¡å™¨éšè—åŸå§‹ç”¨æˆ·çš„ IP åœ°å€ä»¥åŠå…¶ä»–ç»†èŠ‚ï¼ŒåŒæ—¶ HTTP ä»£ç†æœåŠ¡å™¨ä¸Šä¹Ÿä¸ä¼šè®°å½•åŸå§‹ç”¨æˆ·è®¿é—®è®°å½•ï¼Œå°±ä½¿å¾—ä»£ç†ä¸Šç½‘çš„å®¢æˆ·å¯ä»¥åœ¨æ›´åŠ å®‰å…¨éšç§˜çš„ç¯å¢ƒä¸­è®¿é—®ç½‘ç»œã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;è¿‡æ»¤å™¨&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%BF%87%E6%BB%A4%E5%99%A8.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;HTTP åè®®å¹¶ä¸çŸ¥é“åœ¨è®¿é—®ç½‘ç»œçš„æ˜¯è°ï¼Œå³ä¾¿æ˜¯ä¸ªå°æœ‹å‹ç™»ä¸Šçˆ¶æ¯çš„è´¦å·è¿›è¡Œè®¿é—®ï¼Œè®¤è¯èµ·æ¥æˆ‘ä»¬ä¹Ÿè®¤ä¸ºä»–å°±æ˜¯ä»–çš„çˆ¶æ¯ã€‚é€šè¿‡ä»£ç†æœåŠ¡å™¨è¿›è¡Œåˆ†æå’Œéƒ¨åˆ†è¯·æ±‚çš„æ‹¦æˆªï¼Œè¿›ä¸€æ­¥åŠ å¼ºå¯¹ç½‘ç»œçš„æ§åˆ¶ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&#34;http-ä¸­ä»‹ä¹‹ç½‘å…³&#34;&gt;HTTP ä¸­ä»‹ä¹‹ç½‘å…³&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;ç½‘å…³å¯ä»¥ä½œä¸ºæŸç§ç¿»è¯‘å™¨ä½¿ç”¨ï¼Œå®ƒæŠ½è±¡å‡ºäº†ä¸€ç§èƒ½å¤Ÿåˆ°è¾¾èµ„æºçš„æ–¹æ³•ã€‚ç½‘å…³æ˜¯èµ„æºå’Œåº”ç”¨ç¨‹åºä¹‹é—´çš„ç²˜åˆå‰‚ã€‚&lt;/li&gt;
&lt;li&gt;ç½‘å…³æ‰®æ¼”çš„æ˜¯â€œåè®®è½¬æ¢å™¨â€çš„è§’è‰²ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/HTTP%E4%B8%AD%E4%BB%8B%E4%B9%8B%E7%BD%91%E5%85%B3.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;ä»£ç†è¿æ¥çš„æ˜¯ä¸¤ä¸ªæˆ–å¤šä¸ªä½¿ç”¨ç›¸åŒåè®®çš„åº”ç”¨ç¨‹åºã€‚&lt;br&gt;
ç½‘å…³è¿æ¥çš„æ˜¯ä¸¤ä¸ªæˆ–å¤šä¸ªä½¿ç”¨ä¸åŒåè®®çš„ç«¯ç‚¹ï¼Œç½‘å…³æ‰®æ¼”çš„æ˜¯ â€œ&lt;strong&gt;åè®®è½¬æ¢å™¨&lt;/strong&gt;â€ çš„è§’è‰²ï¼Œç½‘å…³å¯ä»¥å‘æ•°æ®åº“å‘é€æŸ¥è¯¢æ•°æ®ã€å‘é‚®ä»¶ã€ç”ŸæˆåŠ¨æ€å†…å®¹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;web-ç½‘å…³&#34;&gt;WEB ç½‘å…³&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Webç½‘å…³åœ¨ä¸€ä¾§ä½¿ç”¨HTTPåè®®ï¼Œåœ¨å¦ä¸€ä¾§ä½¿ç”¨å¦ä¸€ç§åè®®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&amp;lt;å®¢æˆ·ç«¯åè®®&amp;gt;/&amp;lt;æœåŠ¡å™¨ç«¯åè®®&amp;gt;&lt;/p&gt;
&lt;p&gt;â‘ ï¼ˆHTTP/ï¼‰æœåŠ¡å™¨ç«¯ç½‘å…³ï¼šé€šè¿‡HTTPåè®®ä¸å®¢æˆ·ç«¯å¯¹è¯ï¼Œé€šè¿‡å…¶ä»–åè®®ä¸æœåŠ¡å™¨é€šä¿¡ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å‘é‚®ä»¶å°±æ˜¯æœåŠ¡å™¨ç«¯ç½‘å…³ï¼Œå®¢æˆ·ç«¯æ˜¯ HTTP åè®®ï¼Œé‚®ä»¶æœåŠ¡å™¨æ˜¯ SMTP åè®®&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;â‘¡ï¼ˆ/HTTPï¼‰å®¢æˆ·ç«¯ç½‘å…³ï¼šé€šè¿‡å…¶ä»–åè®®ä¸å®¢æˆ·ç«¯å¯¹è¯ï¼Œé€šè¿‡HTTPåè®®ä¸æœåŠ¡å™¨é€šä¿¡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¸¸è§çš„ç½‘å…³ç±»å‹&#34;&gt;å¸¸è§çš„ç½‘å…³ç±»å‹&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ï¼ˆHTTP/*ï¼‰æœåŠ¡å™¨ç«¯Webç½‘å…³&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;å®¢æˆ·ç«¯å‘é€ HTTP è¯·æ±‚ï¼ŒæœåŠ¡å™¨ç«¯ webç½‘å…³ä¼šæŠŠè¿™ä¸ªè¯·æ±‚è½¬æ¢ä¸ºå…¶ä»–åè®®ä¸æœåŠ¡å™¨è¿›è¡Œè¿æ¥ï¼Œå®Œæˆè·å–èµ„æºåï¼Œä¼šå°†å¯¹è±¡æ”¾åœ¨ä¸€æ¡ HTTP å“åº”ä¸­ï¼Œå‘é€ç»™å®¢æˆ·ç«¯ï¼šå‘é‚®ä»¶ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;ï¼ˆHTTP/HTTPSï¼‰æœåŠ¡å™¨ç«¯å®‰å…¨ç½‘å…³&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;å®¢æˆ·ç«¯å‘é€ HTTP è¯·æ±‚ï¼Œç½‘å…³è‡ªåŠ¨è¿›è¡ŒåŠ å¯†ï¼ŒåŠ å¯†æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œç„¶åå†å‘é€ç»™æœåŠ¡å™¨ï¼Œä¸ºäº†å®‰å…¨é—®é¢˜ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;ï¼ˆHTTPS/HTTPï¼‰å®¢æˆ·ç«¯å®‰å…¨åŠ é€Ÿå™¨ç½‘å…³&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚æ˜¯ç»è¿‡åŠ å¯†çš„å®‰å…¨çš„ HTTPS ï¼Œé€šè¿‡ç½‘å…³è¿›è¡Œè§£å¯†åå†å‘ web æœåŠ¡å™¨å‘é€æ™®é€šçš„ HTTP è¯·æ±‚ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;èµ„æºç½‘å…³&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;å®¢æˆ·ç«¯é€šè¿‡ HTTP è¿æ¥åˆ°åº”ç”¨ç¨‹åºçš„æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å¹¶ä¸å›é€æ–‡ä»¶ï¼Œè€Œæ˜¯å°†è¯·æ±‚é€šè¿‡ç½‘å…³ API å‘é€ç»™è¿è¡Œåœ¨æœåŠ¡å™¨ä¸Šçš„åº”ç”¨ç¨‹åºï¼Œåº”ç”¨ç¨‹åºå°†è¯·æ±‚èµ„æºå›é€ç»™å®¢æˆ·ç«¯ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&#34;http-ç¼“å­˜&#34;&gt;HTTP ç¼“å­˜&lt;/h1&gt;
&lt;h2 id=&#34;ä¸ºä»€ä¹ˆè¦ä½¿ç”¨httpç¼“å­˜&#34;&gt;ä¸ºä»€ä¹ˆè¦ä½¿ç”¨HTTPç¼“å­˜ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;è¯·æ±‚ä¸€æ¬¡æœåŠ¡å™¨ï¼Œè¯·æ±‚å¤´å¤§å° 1KBï¼Œå“åº”å¤´å¤§å° 1KBï¼Œè¯·æ±‚çš„æ–‡ä»¶å¤§å° 10KBï¼Œä¸€æ¬¡è¯·æ±‚çš„æµé‡å°±æ˜¯ 12KBï¼Œ10 æ¬¡å°±æ˜¯ 120KBï¼Œn æ¬¡è¯·æ±‚å°±æ˜¯ 12*n KBã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®¢æˆ·ç«¯&lt;/strong&gt;æ¯æ¬¡éƒ½è¦è¯·æ±‚æœåŠ¡å™¨ï¼Œæµªè´¹&lt;strong&gt;æµé‡&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœåŠ¡å™¨&lt;/strong&gt;æ¯æ¬¡éƒ½æä¾›æŸ¥æ‰¾ã€ä¸‹è½½ï¼Œè¯·æ±‚ç”¨æˆ·åŸºæ•°å¦‚æœå¤ªå¤§ï¼ŒæœåŠ¡å™¨å°±ä¼šå­˜åœ¨å¾ˆå¤§&lt;strong&gt;å‹åŠ›&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¢æˆ·ç«¯&lt;/strong&gt;æ¯æ¬¡è¯·æ±‚å®Œéƒ½è¦è¿›è¡Œé¡µé¢æ¸²æŸ“ï¼Œ&lt;strong&gt;ç”¨æˆ·ä½“éªŒå·®&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ˜¯å¦å¯ä»¥å°†è¯·æ±‚çš„æ–‡ä»¶å­˜æ”¾èµ·æ¥ä½¿ç”¨ï¼šHTTP ç¼“å­˜ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç¼“å­˜çš„å†…å®¹åˆæ˜¯ä»€ä¹ˆ&#34;&gt;ç¼“å­˜çš„å†…å®¹åˆæ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h2&gt;
&lt;p&gt;ä¸»è¦é’ˆå¯¹æ ·å¼ï¼šCSSã€JSã€å›¾ç‰‡è¿™ä¸€ç³»åˆ—æ›´æ–°é¢‘ç‡ä¸å¤§çš„&lt;strong&gt;é™æ€æ–‡ä»¶&lt;/strong&gt;è¿›è¡Œç¼“å­˜ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç¼“å­˜æ˜¯é€šè¿‡ä»€ä¹ˆå®ç°çš„ï¼Ÿè¯·æ±‚å¤´-å“åº”å¤´&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;httpç¼“å­˜å¤´éƒ¨å­—æ®µ&#34;&gt;HTTPç¼“å­˜å¤´éƒ¨å­—æ®µ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Cache-Controlè¯·æ±‚/å“åº”å¤´ï¼Œç¼“å­˜æ§åˆ¶å­—æ®µ&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;æ§åˆ¶ HTTP ç¼“å­˜çš„æœ€é«˜æŒ‡ä»¤ï¼Œè¦ä¸è¦ç¼“å­˜ä¹Ÿæ˜¯ Cache-Control è¯´äº†ç®—ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;no-storeï¼šæ‰€æœ‰å†…å®¹éƒ½ä¸ç¼“å­˜ã€‚&lt;/p&gt;
&lt;p&gt;no-cacheï¼šç¼“å­˜ï¼Œä½†æ˜¯æµè§ˆå™¨ä½¿ç”¨ç¼“å­˜å‰ï¼Œéƒ½ä¼šè¯·æ±‚æœåŠ¡å™¨åˆ¤æ–­ç¼“å­˜èµ„æºæ˜¯å¦æ˜¯æœ€æ–°ã€‚&lt;/p&gt;
&lt;p&gt;max-age=Xï¼ˆå•ä½ç§’ï¼‰è¯·æ±‚ç¼“å­˜åçš„Xç§’ä¸å†å‘èµ·è¯·æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;s-maxage=Xï¼ˆå•ä½ç§’ï¼‰ä»£ç†æœåŠ¡å™¨è¯·æ±‚æºç«™ç¼“å­˜åçš„Xç§’ä¸å†å‘èµ·è¯·æ±‚ï¼Œåªå¯¹CDNç¼“å­˜æœ‰æ•ˆã€‚&lt;/p&gt;
&lt;p&gt;publicï¼šå®¢æˆ·ç«¯å’Œä»£ç†æœåŠ¡å™¨ï¼ˆCDNï¼‰éƒ½å¯ç¼“å­˜ã€‚&lt;/p&gt;
&lt;p&gt;privateï¼šåªæœ‰å®¢æˆ·ç«¯å¯ä»¥ç¼“å­˜ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Expires&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å“åº”å¤´ï¼Œä»£è¡¨èµ„æºè¿‡æœŸæ—¶é—´ï¼Œç”±æœåŠ¡å™¨è¿”å›æä¾›ï¼Œæ˜¯http1.0çš„å±æ€§ï¼Œåœ¨ä¸max-ageå…±å­˜çš„æƒ…å†µä¸‹ï¼Œä¼˜å…ˆçº§è¦ä½ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Last-Modified&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å“åº”å¤´ï¼Œèµ„æºæœ€æ–°ä¿®æ”¹æ—¶é—´ï¼Œç”±æœåŠ¡å™¨å‘Šè¯‰æµè§ˆå™¨ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;if-Modified-Since&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¯·æ±‚å¤´ï¼Œèµ„æºæœ€æ–°ä¿®æ”¹æ—¶é—´ï¼Œç”±æµè§ˆå™¨å‘Šè¯‰æœåŠ¡å™¨ï¼Œå’ŒLast-Modifiedæ˜¯ä¸€å¯¹ï¼Œå®ƒä¸¤ä¼šè¿›è¡Œå¯¹æ¯”ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Etag&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å“åº”å¤´ï¼Œèµ„æºæ ‡è¯†ï¼Œç”±æœåŠ¡å™¨å‘Šè¯‰æµè§ˆå™¨ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;if-None-Match&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¯·æ±‚å¤´ï¼Œç¼“å­˜èµ„æºæ ‡è¯†ï¼Œç”±æµè§ˆå™¨å‘Šè¯‰æœåŠ¡å™¨ï¼ˆå…¶å®å°±æ˜¯ä¸Šæ¬¡æœåŠ¡å™¨ç»™çš„Etagï¼‰ï¼Œå’ŒEtagæ˜¯ä¸€å¯¹ï¼Œå®ƒä¸¤ä¼šè¿›è¡Œå¯¹æ¯”ã€‚&lt;/p&gt;
&lt;h2 id=&#34;httpç¼“å­˜å·¥ä½œæ–¹å¼&#34;&gt;HTTPç¼“å­˜å·¥ä½œæ–¹å¼&lt;/h2&gt;
&lt;h3 id=&#34;expires&#34;&gt;Expires&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;åœºæ™¯ä¸€ï¼šè®©æœåŠ¡å™¨ä¸æµè§ˆå™¨çº¦å®šä¸€ä¸ªæ–‡ä»¶è¿‡æœŸæ—¶é—´ä¸€Expires&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;9&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Expires.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;â‘  ç¬¬ä¸€æ¬¡è¯·æ±‚æ—¶ï¼Œæµè§ˆå™¨å‘æœåŠ¡å™¨è¯·æ±‚ä¸€ä¸ª f.js æ–‡ä»¶&lt;br&gt;
â‘¡ æœåŠ¡å™¨è¯´æ–‡ä»¶ç»™ä½ ï¼Œæˆ‘ä»¬çº¦å®šä¸€ä¸ªæ—¶é—´ï¼Œé€šè¿‡å“åº”å¤´è¿”å›ä¸€ä¸ª Expires è¿‡æœŸçº¦å®šæ—¶é—´ï¼ŒåŒæ—¶è¿”å›äº† f.js&lt;br&gt;
â‘¢ åç»­è¯·æ±‚æµè§ˆå™¨å…ˆå¯¹æ¯”å½“å‰æ—¶é—´æ˜¯å¦å·²ç»å¤§äº Expiresï¼Œåˆ¤æ–­ç¼“å­˜çš„æ–‡ä»¶æ˜¯å¦è¶…è¿‡äº†çº¦å®šçš„è¿‡æœŸæ—¶é—´ï¼Œæ—¶é—´æ²¡è¿‡çš„è¯ï¼Œä¸å‘èµ·è¯·æ±‚ï¼Œç›´æ¥ä½¿ç”¨æœ¬åœ°ç¼“å­˜ï¼›æ—¶é—´è¿‡æœŸäº†ï¼Œå°±å‘èµ·è¯·æ±‚ï¼Œå†è¿”å›åˆ°æ­¥éª¤ â‘ ã€‚&lt;br&gt;
å‡è®¾ Expires å·²ç»è¿‡æœŸï¼Œæµè§ˆå™¨è¯·æ±‚æœåŠ¡å™¨ï¼Œä½†æ˜¯ f.js å¹¶æœªæ”¹å˜ï¼Œå¦‚ä½•é¿å…è¿™æ—¶å‘èµ·è¯·æ±‚å‘¢ï¼Ÿ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;last-modified-ä¸-if-modified-since&#34;&gt;Last-Modified ä¸ if-Modified-Since&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;åœºæ™¯äºŒï¼šè®©æœåŠ¡å™¨ä¸æµè§ˆå™¨åœ¨çº¦å®šæ–‡ä»¶è¿‡æœŸæ—¶é—´çš„åŸºç¡€ä¸Šï¼Œå†åŠ ä¸€ä¸ªæ–‡ä»¶æœ€æ–°ä¿®æ”¹æ—¶é—´çš„å¯¹æ¯”â€”â€”Last-Modified ä¸ if-Modified-Since&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;10&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Last-Modified.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;â‘  æµè§ˆå™¨å‘æœåŠ¡å™¨è¯·æ±‚ f.jsï¼Œå¹¶è¦ä¸€ä¸ªè¿‡æœŸæ—¶é—´&lt;br&gt;
â‘¡ æœåŠ¡å™¨è¿”å›ç»™æµè§ˆå™¨ f.js å’Œ ä¸€ä¸ªè¿‡æœŸæ—¶é—´ï¼Œå†ç»™ä¸€ä¸ªæ–‡ä»¶æœ€æ–°ä¿®æ”¹æ—¶é—´ Last-Modifiedï¼Œé€šè¿‡è®¾ç½®å“åº”å¤´è¿”å›ç»™æµè§ˆå™¨ï¼Œæ–‡ä»¶è¿‡æœŸåï¼ŒåŒæ–¹æ ¸å¯¹æ–‡ä»¶ä¿®æ”¹æ—¶é—´&lt;br&gt;
åç»­æµè§ˆå™¨å¯èƒ½æœ‰å¦‚ä¸‹ä¸‰ç§æƒ…å†µï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Expires è¿˜æœªè¿‡æœŸï¼Œæµè§ˆå™¨ä½¿ç”¨æœ¬åœ°ç¼“å­˜&lt;/li&gt;
&lt;li&gt;Expires è¿‡æœŸï¼Œæµè§ˆå™¨è¯·æ±‚æœåŠ¡å™¨æ—¶å¸¦ä¸Šæ–‡ä»¶æœ€æ–°ä¿®æ”¹æ—¶é—´ï¼Œåœ¨è¯·æ±‚å¤´é‡Œé¢åŠ ä¸Š if-Modified-Sinceï¼Œä¹Ÿå°±æ˜¯ä¸Šæ¬¡è¯·æ±‚æœåŠ¡å™¨è¿”å›çš„ Last-Modifiedï¼ŒæŠŠè¿™ä¸ªå€¼åˆå¸¦å›å»ã€‚æœåŠ¡å™¨æŠŠè¿™ä¸ª if-Modified-Sinceï¼ˆè¯·æ±‚å¤´é‡Œçš„æ–‡ä»¶æœ€è¿‘ä¿®æ”¹æ—¶é—´ï¼‰ å’Œ æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶æœ€æ–°ä¿®æ”¹æ—¶é—´ Last-Modified ä½œå¯¹æ¯”ï¼Œå¦‚æœä¸¤ä¸ªå€¼ä¸ç›¸ç­‰ï¼ŒæœåŠ¡å™¨æŸ¥æ‰¾æœ€æ–°çš„ f.js + Expires + Last-Modified è¿”å›ç»™æµè§ˆå™¨ï¼›å¦‚æœç›¸ç­‰ï¼ŒæœåŠ¡å™¨è¿”å›çŠ¶æ€ç  304ï¼šæ–‡ä»¶æœªä¿®æ”¹è¿‡ï¼Œä½ è¿˜æ˜¯ç”¨ä½ çš„æœ¬åœ°ç¼“å­˜å§ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;11&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Last-Modified_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;æµè§ˆå™¨ç«¯å¯ä»¥éšæ„ä¿®æ”¹ Expiresï¼Œå¾ˆæç«¯çš„æƒ…å†µä¸‹ï¼ŒLast-Modified åªèƒ½ç²¾ç¡®åˆ°ç§’ï¼Œå‡è®¾æ–‡ä»¶åœ¨ 1ç§’ å†…å‘ç”Ÿå˜åŒ–ï¼ŒLast-Modified æ— æ³•æ„ŸçŸ¥è¿™ä¸ªæ–‡ä»¶çš„å˜åŒ–ï¼Œè¿™æ ·æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨æ°¸è¿œæ— æ³•æ‹¿åˆ°æœ€æ–°æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;etagä¸lf-none-match&#34;&gt;Etagä¸lf-None-Match&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;åœºæ™¯ä¸‰ï¼šè®©æœåŠ¡å™¨ä¸æµè§ˆå™¨åœ¨è¿‡æœŸæ—¶é—´Expires+Last-Modifiedçš„åŸºç¡€ä¸Šï¼Œå¢åŠ ä¸€ä¸ªæ–‡ä»¶å†…å®¹å”¯ä¸€å¯¹æ¯”æ ‡è®°â€”â€”Etagä¸lf-None-Matchã€‚Expiresä¸ç¨³å®šï¼Œå†åŠ å…¥ä¸€ä¸ªmax-ageæ¥åŠ ä»¥ä»£æ›¿ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;12&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Etag.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;â‘  æµè§ˆå™¨è¯·æ±‚ f.js&lt;br&gt;
â‘¡ æœåŠ¡å™¨å°† f.js + max-age(è¿‡æœŸæ—¶é—´) + Last-Modified + Etagï¼ˆæ–‡ä»¶å†…å®¹çš„å”¯ä¸€æ ‡è¯†ï¼‰&lt;br&gt;
â‘¢ æµè§ˆå™¨ 60s å†…ä¸å‘èµ·è¯·æ±‚ï¼Œç›´æ¥ä½¿ç”¨æœ¬åœ°ç¼“å­˜ï¼Œ&lt;br&gt;
max-age=60ä»£è¡¨æˆåŠŸç¼“å­˜åçš„ 60s å†…ä¸å†å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œä¸ Expires ç›¸ä¼¼ï¼Œä½† max-age ä¼˜å…ˆçº§æ¯” Expires é«˜ï¼Œmax-age å­˜åœ¨æ—¶ Expires å°±æ²¡ç”¨äº†ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;â‘£ 60s åï¼Œæµè§ˆå™¨å¸¦ä¸Š If-Modified-Since å’Œ If-None-Match å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼ŒæœåŠ¡å™¨å¯¹æ¯” If-None-Match ä¸æœåŠ¡å™¨ç«¯çš„ Etagï¼Œè¿™æ—¶å€™å°½ç®¡ç»™å‡ºäº† If-Modified-Sinceï¼Œä½†æ˜¯ä¸ä¼šå†å¯¹æ¯” If-Modified-SinceÂ å’Œ Last-Modified äº†ï¼Œå› ä¸º Etag ä¼˜å…ˆçº§æ¯” Last-Modified é«˜ï¼ŒEtag å°±æ˜¯ä¸ºäº†è§£å†³ 1s å†…æ–‡ä»¶å‘ç”Ÿæ”¹å˜çš„é—®é¢˜ã€‚å¦‚æœÂ If-None-Match ä¸ Etag ä¸ç›¸ç­‰ï¼Œè¯´æ˜ f.js è¿™ä¸ªå†…å®¹è¢«ä¿®æ”¹è¿‡ï¼ŒæœåŠ¡å™¨è¿”å›ç»™æµè§ˆå™¨æœ€æ–°çš„ f.js + å…¨æ–°çš„ Etag + max-age +Last-Modifiedï¼ˆæ²¡ä»€ä¹ˆç”¨äº†ï¼Œä¼˜å…ˆçº§ &amp;lt; Etagï¼‰ + Expiresï¼ˆæ²¡ä»€ä¹ˆç”¨äº†ï¼Œä¼˜å…ˆçº§&amp;lt;max-ageï¼‰ï¼›å¦‚æœ Etag ä¸ If-None-Match ç›¸ç­‰ï¼Œè¿”å› 304 å‘Šè¯‰æµè§ˆå™¨ç»§ç»­ä½¿ç”¨ä¹‹å‰çš„æœ¬åœ°ç¼“å­˜ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;13&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Etag_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;max-age æˆ– Expires ä¸è¿‡æœŸçš„æ—¶å€™ï¼Œæµè§ˆå™¨æ²¡æœ‰åŠæ³•ä¸»åŠ¨æ„ŸçŸ¥æœåŠ¡å™¨çš„æ–‡ä»¶å˜åŒ–ã€‚&lt;br&gt;
å¦‚æœæœåŠ¡ç«¯æ”¹å˜äº†æ–‡ä»¶ï¼Œæ€æ ·è®©å®¢æˆ·ç«¯çŸ¥é“å‘¢ï¼Ÿ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;ç¼“å­˜æ”¹è¿›æ–¹æ¡ˆ&#34;&gt;ç¼“å­˜æ”¹è¿›æ–¹æ¡ˆ&lt;/h2&gt;
&lt;h3 id=&#34;md5hashç¼“å­˜&#34;&gt;md5/hashç¼“å­˜&lt;/h3&gt;
&lt;p&gt;é€šè¿‡ä¸ç¼“å­˜htmlï¼Œä¸ºé™æ€æ–‡ä»¶æ·»åŠ MD5æˆ–è€…hashæ ‡è¯†ï¼Œè§£å†³æµè§ˆå™¨æ— æ³•è·³è¿‡ç¼“å­˜è¿‡æœŸæ—¶é—´ä¸»åŠ¨æ„ŸçŸ¥æ–‡ä»¶å˜åŒ–çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;HTTP ç¼“å­˜æ–¹æ¡ˆï¼šæœåŠ¡å™¨ä¸æµè§ˆå™¨çš„æ–‡ä»¶ä¿®æ”¹æ—¶é—´å¯¹æ¯”ï¼Œæ–‡ä»¶å†…å®¹æ ‡è¯†å¯¹æ¯”ï¼Œå‰æçš„åŸºç¡€éƒ½æ˜¯å»ºç«‹åœ¨ä¸¤è€…æ–‡ä»¶è·¯å¾„å®Œå…¨ç›¸åŒçš„åŸºç¡€ä¸Šï¼Œè¯·æ±‚çš„éƒ½æ˜¯ f.jsï¼Œè¿™æ‰èƒ½å¤Ÿè§£è¯»è¿™æ ·çš„ç¼“å­˜ï¼Œä½†æ˜¯å¦‚æœç¬¬ä¸€æ¬¡è¦è·å–çš„åå­—æ˜¯ f-hash1.jsï¼Œä¸‹ä¸€æ¬¡æ–‡ä»¶ä¿®æ”¹äº†å°±å˜æˆäº† f-hash2.jsï¼Œè¿™æ˜¯ä¸¤ä¸ªå®Œå…¨ä¸åŒçš„æ–‡ä»¶ã€‚&lt;br&gt;
æµè§ˆå™¨ç¬¬ä¸€æ¬¡åŠ è½½é¡µé¢ï¼Œè¯·æ±‚å¹¶ç¼“å­˜äº† f-hash1,jsï¼Œç¬¬äºŒæ¬¡åŠ è½½åŒæ ·ä¸€ä¸ªåœ°æ–¹æ–‡ä»¶æŒ‡å‘ f-hash2.jsï¼Œæµè§ˆå™¨ä¸ä¼šè¯¢é—®ç¼“å­˜äº†ï¼Œå› ä¸ºæœ¬åœ°æ²¡æœ‰è¿™ä¸ªç¼“å­˜ï¼Œæµè§ˆå™¨ä¼šç›´æ¥é‡æ–°è¯·æ±‚ f-hash2.jsï¼Œå› ä¸ºè¿™å°±æ˜¯ä¸¤ä¸ªä¸åŒçš„æ–‡ä»¶ã€‚&lt;br&gt;
é€šè¿‡è¿™ç§æ–¹å¼å°±å¯ä»¥è§£å†³è¿‡æœŸæ—¶é—´æ²¡åˆ°ï¼Œæµè§ˆå™¨æ— æ³•ä¸»åŠ¨è¯·æ±‚æœåŠ¡å™¨çš„é—®é¢˜ï¼Œåªéœ€è¦åœ¨åœ¨é¡¹ç›®æ¯æ¬¡å‘å¸ƒè¿­ä»£çš„æ—¶å€™ï¼Œå°†ä¿®æ”¹è¿‡çš„é™æ€æ–‡ä»¶æ·»åŠ ä¸åŒçš„ MD5 æˆ–è€… hash æ ‡è¯†å³å¯ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;cdnç¼“å­˜&#34;&gt;CDNç¼“å­˜&lt;/h3&gt;
&lt;p&gt;CDNæ˜¯æ„å»ºåœ¨ç½‘ç»œä¹‹ä¸Šçš„å†…å®¹åˆ†å‘ç½‘ç»œï¼Œä¾é éƒ¨ç½²åœ¨å„åœ°çš„è¾¹ç¼˜æœåŠ¡å™¨ï¼Œé€šè¿‡ä¸­å¿ƒå¹³å°çš„è´Ÿè½½å‡è¡¡ã€å†…å®¹åˆ†å‘ã€è°ƒåº¦ç­‰åŠŸèƒ½æ¨¡å—ï¼Œä½¿ç”¨æˆ·å°±è¿‘è·å–æ‰€éœ€å†…å®¹ï¼Œé™ä½ç½‘ç»œæ‹¥å¡ï¼Œæé«˜ç”¨æˆ·è®¿é—®å“åº”é€Ÿåº¦å’Œå‘½ä¸­ç‡ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å‡è®¾å¤šå¹´å‰ï¼Œæˆ‘ä»¬æ‰€åœ¨çš„åŸå¸‚åªæœ‰ä¸€ä¸ªç«è½¦ç«™ï¼Œæ¯æ¬¡æ˜¥è¿æ•´ä¸ªåŸå¸‚çš„äººéƒ½å¾—å»è¿™ä¸ªç«è½¦ç«™ä¹°ç¥¨ï¼Œ äººæµé‡åŠè´­ç¥¨éœ€æ±‚æ¿€å¢ï¼Œä¸ºäº†ç¼“è§£è¿™ä¸ªé—®é¢˜ï¼ŒåŸå¸‚çš„ä¸åŒåŒºéƒ½å‡ºç°äº†ç«è½¦ç¥¨çš„ä»£å”®ç‚¹ï¼Œè¿™æ ·æ¯ä¸ªåŒºçš„äººéƒ½å¯ä»¥å°±è¿‘ä¹°ç¥¨ï¼Œç«è½¦ç«™æ€»ç«™çš„å‹åŠ›å¤§å¤§å‡è½»ã€‚&lt;br&gt;
å¯ä»¥æŠŠæ¯ä¸ªåŒºçš„å”®ç¥¨ç‚¹ç§°ä¹‹ä¸º CDN èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯å‰é¢æ‰€è¯´çš„ ä»£ç†æœåŠ¡å™¨ï¼Œç®€è€Œè¨€ä¹‹ï¼Œå¯ä»¥æŠŠ CDN ç†è§£æˆæµè§ˆå™¨ä¸æœåŠ¡å™¨ä¹‹é—´çš„ä¸´æ—¶ç«™ç‚¹ï¼Œå®ƒä¼šæ›¿æœåŠ¡å™¨å¤„ç†éƒ¨åˆ†æµè§ˆå™¨è¯·æ±‚ï¼Œä»è€Œå‡è½»æ€»æœåŠ¡å™¨ä¸Šçš„å‹åŠ›ã€‚é™æ€èµ„æºä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œå¯ä»¥åˆ†æˆå¤šä¸ªä¸´æ—¶ç«™ç‚¹æ¥å­˜å‚¨ã€‚&lt;br&gt;
æŠŠ CDN çš„ä»·å€¼å½’çº³ä¸ºï¼š&lt;br&gt;
â‘ é€šè¿‡åˆ†æµå¤§å¤§å‡è½»äº†åŸç«™ï¼ˆæœåŠ¡å™¨ç«¯ï¼‰çš„å‹åŠ›ã€‚&lt;br&gt;
â‘¡è§£å†³äº†è·¨åœ°åŒºè®¿é—®é—®é¢˜ï¼ˆå°±è¿‘ç«™ç‚¹è®¿é—®ï¼‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;cdn-ç¼“å­˜å·¥ä½œæ–¹å¼&#34;&gt;CDN ç¼“å­˜å·¥ä½œæ–¹å¼&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ç¬¬ä¸€æ¬¡è¯·æ±‚&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;14&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/CDN%E7%BC%93%E5%AD%98%E7%AC%AC%E4%B8%80%E6%AC%A1%E8%AF%B7%E6%B1%82.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;åç»­è¯·æ±‚&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;15&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/CDN%E7%BC%93%E5%AD%98%E5%90%8E%E7%BB%AD%E8%AF%B7%E6%B1%82.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;å¯èƒ½å‡ºç°ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š&lt;/p&gt;
&lt;p&gt;â‘  CDN èŠ‚ç‚¹è‡ªå·±ç¼“å­˜çš„æ–‡ä»¶è¿˜æ²¡è¿‡æœŸï¼Œäºæ˜¯è¿”å› 304 ç»™æµè§ˆå™¨ï¼Œæ‰“å›äº†è¿™æ¬¡è¯·æ±‚&lt;/p&gt;
&lt;p&gt;â‘¡ CND èŠ‚ç‚¹å‘ç°è‡ªå·±ç¼“å­˜çš„æ–‡ä»¶è¿‡æœŸäº†ï¼Œä¸ºäº†ä¿é™©èµ·è§ï¼Œè‡ªå·±å‘é€è¯·æ±‚ç»™æœåŠ¡å™¨ï¼ŒæˆåŠŸæ‹¿å›æœ€æ–°æ•°æ®ï¼Œç„¶åäº¤è¿˜ç»™æµè§ˆå™¨ã€‚&lt;/p&gt;
&lt;p&gt;CND ç¼“å­˜çš„é—®é¢˜å’Œ HTTP ç¼“å­˜çš„é—®é¢˜ä¸€æ ·ï¼ŒCDN ç¼“å­˜æ—¶é—´ä¸è¿‡æœŸï¼Œæµè§ˆå™¨å§‹ç»ˆè¢«æ‹¦æˆªï¼Œæ— æ³•æ‹¿åˆ°æœ€æ–°çš„æ–‡ä»¶ã€‚å›å½’ HTTP ç¼“å­˜æœ¬èº«ï¼Œç¼“å­˜æœ¬èº«é’ˆå¯¹äºæ›´æ–°é¢‘ç‡ä¸é«˜çš„é™æ€æ–‡ä»¶ï¼ŒCDN ç¼“å­˜æä¾›äº†åˆ†æµã€è®¿é—®åŠ é€Ÿç­‰ã€‚&lt;/p&gt;
&lt;p&gt;CDN ä¸ HTTP ç¼“å­˜ä¸ä¸€æ ·çš„æ˜¯ï¼šCDN ç±»ä¼¼äºä¸€ä¸ªå¹³å°ï¼Œå¯ä»¥é€šè¿‡ç™»å½•æ‰‹åŠ¨æ›´æ–° CDN ç¼“å­˜ï¼Œå˜ç›¸è§£å†³äº†æµè§ˆå™¨ç¼“å­˜æ— æ³•æ‰‹åŠ¨æ§åˆ¶çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æµè§ˆå™¨æ“ä½œå¯¹httpç¼“å­˜çš„å½±å“&#34;&gt;æµè§ˆå™¨æ“ä½œå¯¹HTTPç¼“å­˜çš„å½±å“&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;&lt;strong&gt;ç”¨æˆ·æ“ä½œ&lt;/strong&gt;&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;&lt;strong&gt;Expires/Cache-Control&lt;/strong&gt;&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;&lt;strong&gt;Last-Modihed/Etag&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;åœ°å€æ å›è½¦&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æœ‰æ•ˆ&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æœ‰æ•ˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;é¡µé¢é“¾æ¥è·³è½¬&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æœ‰æ•ˆ&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æœ‰æ•ˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ–°å¼€çª—å£&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æœ‰æ•ˆ&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æœ‰æ•ˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å‰è¿›ã€åé€€&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æœ‰æ•ˆ&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æœ‰æ•ˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;F5åˆ·æ–°&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ— æ•ˆ&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æœ‰æ•ˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Ctrl+F5åˆ·æ–°&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ— æ•ˆ&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ— æ•ˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;å†…å®¹åå•†æœºåˆ¶&#34;&gt;å†…å®¹åå•†æœºåˆ¶&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;è®¿é—®è°·æ­Œï¼ŒåŒä¸€ä¸ª URLï¼Œåœ¨å›½å†…æ‰“å¼€è°·æ­Œæ˜¯ä¸­æ–‡ï¼Œåœ¨å›½å¤–æ‰“å¼€æ˜¯è‹±æ–‡çš„ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;æŒ‡å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯å°±å“åº”çš„èµ„æºå†…å®¹è¿›è¡Œäº¤æ¶‰ï¼Œç„¶åæä¾›ç»™å®¢æˆ·ç«¯æœ€ä¸ºé€‚åˆçš„èµ„æºã€‚å†…å®¹åå•†ä¼šä»¥å“åº”èµ„æºçš„è¯­è¨€ï¼Œå­—ç¬¦é›†ï¼Œç¼–ç æ–¹å¼ç­‰ä½œä¸ºåˆ¤æ–­çš„åŸºå‡†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å†…å®¹åå•†æ–¹å¼&#34;&gt;å†…å®¹åå•†æ–¹å¼&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å®¢æˆ·ç«¯é©±åŠ¨&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚ï¼ŒæœåŠ¡å™¨å‘é€å¯é€‰é¡¹åˆ—è¡¨ï¼Œå®¢æˆ·ç«¯ä½œå‡ºé€‰æ‹©ååœ¨å‘é€ç¬¬äºŒæ¬¡è¯·æ±‚ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æœåŠ¡å™¨é©±åŠ¨&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœåŠ¡å™¨æ£€æŸ¥å®¢æˆ·ç«¯çš„è¯·æ±‚å¤´éƒ¨é›†å¹¶å†³å®šæä¾›å“ªä¸ªç‰ˆæœ¬çš„é¡µé¢ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€æ˜åå•†&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æŸä¸ªä¸­é—´è®¾å¤‡ï¼ˆé€šå¸¸æ˜¯ç¼“å­˜ä»£ç†ï¼‰ä»£è¡¨å®¢æˆ·ç«¯è¿›è¡Œåå•†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœåŠ¡å™¨é©±åŠ¨å†…å®¹åå•†-è¯·æ±‚é¦–éƒ¨é›†&#34;&gt;æœåŠ¡å™¨é©±åŠ¨å†…å®¹åå•†-è¯·æ±‚é¦–éƒ¨é›†&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Acceptï¼šå‘ŠçŸ¥æœåŠ¡å™¨å‘é€ä½•ç§åª’ä½“ç±»å‹&lt;/li&gt;
&lt;li&gt;Accept-Languageï¼šå‘ŠçŸ¥æœåŠ¡å™¨å‘é€ä½•ç§è¯­è¨€&lt;/li&gt;
&lt;li&gt;Accept-Charsetï¼šå‘ŠçŸ¥æœåŠ¡å™¨å‘é€ä½•ç§å­—ç¬¦é›†&lt;/li&gt;
&lt;li&gt;Accept-Encodingï¼šå‘ŠçŸ¥æœåŠ¡å™¨é‡‡ç”¨ä½•ç§ç¼–ç &lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æœåŠ¡å™¨é©±åŠ¨å†…å®¹åå•†-è¯·æ±‚é¦–éƒ¨é›†-2&#34;&gt;æœåŠ¡å™¨é©±åŠ¨å†…å®¹åå•†-è¯·æ±‚é¦–éƒ¨é›†&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Content-Type&lt;/li&gt;
&lt;li&gt;Content-Language&lt;/li&gt;
&lt;li&gt;Content-Type&lt;/li&gt;
&lt;li&gt;Content-Encoding&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æœåŠ¡å™¨é©±åŠ¨å†…å®¹åå•†-è¿‘ä¼¼åŒ¹é…&#34;&gt;æœåŠ¡å™¨é©±åŠ¨å†…å®¹åå•†-è¿‘ä¼¼åŒ¹é…&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;å®¢æˆ·ç«¯çš„ Accept-Language æŒ‡çš„æ˜¯è¥¿ç­ç‰™è¯­ï¼ŒæœåŠ¡å™¨ç«¯åªæœ‰è‹±è¯­å’Œæ³•è¯­ï¼Œè¿™ä¸ªå®¢æˆ·ç«¯å¸Œæœ›åœ¨æ²¡æœ‰è¥¿ç­ç‰™è¯­çš„æ—¶å€™ä¼˜å…ˆè¿”å›è‹±è¯­ã€‚è¿™å°±æ„å‘³ç€éœ€è¦ä¸€ç§ HTTP æœºåˆ¶æ›´è¯¦ç»†çš„æè¿°åå¥½ï¼šè¿‘ä¼¼åŒ¹é…æ–¹å¼ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Accept-Language:en; q=0.5, fr; q=0.0, nl; q=1.0, tr; q=0.0&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸Šè¿°é¦–éƒ¨è¡¨ç¤ºç”¨æˆ·æœ€æ„¿æ„æ¥å— nlï¼šè·å…°è¯­(nl; q=1.0)ï¼›å…¶æ¬¡ï¼Œå¦‚æœæ²¡æœ‰è·å…°è¯­çš„è¯ï¼Œè‹±æ–‡ä¹Ÿè¡Œï¼šen;q=0.5ï¼›ä¸æ¥å—æ³•è¯­ï¼šfr;q=0.0 ï¼Œä¸æ¥å—åœŸè€³å…¶è¯­ï¼štr;q=0.0&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;q å€¼çš„èŒƒå›´æ˜¯ 0-1ï¼Œä¸ä»£è¡¨æ‰€æœ‰æƒé‡å’Œä¸º 1ï¼Œä¸æ˜¯æƒé‡çš„æ¦‚å¿µï¼Œåªæ˜¯ä¼˜å…ˆçº§çš„æ¦‚å¿µã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å¦‚æœæœåŠ¡ç«¯æ—¢æ²¡æœ‰ nl ä¹Ÿæ²¡æœ‰ enï¼ŒæœåŠ¡å™¨ç«¯çŒœæµ‹ï¼ŒæœåŠ¡å™¨ç«¯è®¾ç½®é»˜è®¤å€¼ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;æ–­ç‚¹ç»­ä¼ å’Œå¤šçº¿ç¨‹ä¸‹è½½&#34;&gt;æ–­ç‚¹ç»­ä¼ å’Œå¤šçº¿ç¨‹ä¸‹è½½&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;æ–­ç‚¹ç»­ä¼ ï¼Ÿå¤šçº¿ç¨‹ä¸‹è½½ï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸‹è½½æ–‡ä»¶æ—¶ï¼Œä¸‹è½½åˆ°ä¸€åŠï¼Œçªç„¶ç½‘ç»œä¸å¤ªå¥½ï¼Œä¸‹è½½ä¸­æ–­äº†ï¼›&lt;br&gt;
æˆ–è€…ä¸»åŠ¨æš‚åœä¸‹è½½ï¼›&lt;br&gt;
ç”¨è¿…é›·ä¸‹è½½ä¸€ä¸ªå¤§æ–‡ä»¶ï¼Œä¼šåˆ†æˆå¥½å¤šå—åˆ†å¼€ä¸‹è½½ã€‚&lt;br&gt;
ä¸Šè¿°å«æ–­ç‚¹ç»­ä¼ ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;HTTPæ˜¯é€šè¿‡åœ¨Headeré‡Œä¸¤ä¸ªå‚æ•°å®ç°çš„ï¼Œå®¢æˆ·ç«¯å‘è¯·æ±‚æ—¶å¯¹åº”çš„æ˜¯Rangeï¼ŒæœåŠ¡å™¨ç«¯å“åº”æ—¶å¯¹åº”çš„æ˜¯Content-Rangeã€‚&lt;br&gt;
ä¸è®ºæ˜¯æ–­ç‚¹ç»­ä¼ è¿˜æ˜¯è¿…é›·çš„å¤šçº¿ç¨‹åˆ†å—ä¸‹è½½ï¼Œå¦‚æœç»­ä¼ æˆåŠŸï¼Œè¿”å› 206ï¼Œå¦‚æœæ–‡ä»¶æœ‰å˜åŠ¨ï¼Œè¿”å› 200 å’Œæ–°æ–‡ä»¶çš„å†…å®¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;Range&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç”¨äºè¯·æ±‚å¤´ä¸­ï¼ŒæŒ‡å®šç¬¬ä¸€ä¸ªå­—èŠ‚çš„ä½ç½®å’Œæœ€åä¸€ä¸ªå­—èŠ‚çš„ä½ç½®ï¼Œä¸€èˆ¬æ ¼å¼ï¼š&lt;/li&gt;
&lt;li&gt;Range:ï¼ˆunit=first byte posï¼‰-[last byte pos] å·¦å¼€å³é—­åŒºé—´
&lt;ul&gt;
&lt;li&gt;Range:bytes=0-499&lt;/li&gt;
&lt;li&gt;Range:bytes=500-999&lt;/li&gt;
&lt;li&gt;Range:bytes=-500  å 500 ä¸ªå­—èŠ‚çš„å†…å®¹&lt;/li&gt;
&lt;li&gt;imooc Range:bytes=500-   ä»ç¬¬ 500 å­—èŠ‚å¼€å§‹ï¼Œåˆ°æ–‡ä»¶ç»“æŸéƒ¨åˆ†&lt;/li&gt;
&lt;li&gt;Range:bytes=500-600,601-999&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Content-Range&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç”¨äºå“åº”å¤´ä¸­ï¼Œåœ¨å‘å‡ºå¸¦ Rangeçš„è¯·æ±‚åï¼ŒæœåŠ¡å™¨ä¼šåœ¨Content-Range å¤´éƒ¨è¿”å›å½“å‰æ¥å—çš„èŒƒå›´å’Œæ–‡ä»¶æ€»å¤§å°ã€‚ä¸€èˆ¬æ ¼å¼ï¼š
&lt;ul&gt;
&lt;li&gt;Content-Range:bytesï¼ˆunit first byte posï¼‰-[last byte pos]/[entity legth]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è€Œåœ¨å“åº”å®Œæˆåï¼Œè¿”å›çš„å“åº”å¤´å†…å®¹ä¹Ÿä¸åŒï¼š
&lt;ul&gt;
&lt;li&gt;HTTP/1.1200 Okï¼ˆä¸ä½¿ç”¨æ–­ç‚¹ç»­ä¼ æ–¹å¼ï¼‰&lt;/li&gt;
&lt;li&gt;HTTP/1.1 206 Partial Contentï¼ˆä½¿ç”¨æ–­ç‚¹ç»­ä¼ æ–¹å¼ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æ–­ç‚¹ç»­ä¼ è¿‡ç¨‹&#34;&gt;æ–­ç‚¹ç»­ä¼ è¿‡ç¨‹&lt;/h2&gt;
&lt;p&gt;1.å®¢æˆ·ç«¯ä¸‹è½½ä¸€ä¸ª1024Kçš„æ–‡ä»¶ï¼Œå·²ç»ä¸‹è½½äº†å…¶ä¸­512Kã€‚&lt;/p&gt;
&lt;p&gt;2.ç½‘ç»œä¸­æ–­ï¼Œå®¢æˆ·ç«¯è¯·æ±‚ç»­ä¼ ï¼Œå› æ­¤éœ€è¦åœ¨HTTPå¤´ä¸­ç”³æ˜æœ¬æ¬¡éœ€è¦ç»­ä¼ çš„ç‰‡æ®µï¼šRange:bytes=512000-&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªå¤´é€šçŸ¥æœåŠ¡ç«¯ä»æ–‡ä»¶çš„512Kä½ç½®å¼€å§‹ä¼ è¾“æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;3.æœåŠ¡ç«¯æ”¶åˆ°æ–­ç‚¹ç»­ä¼ è¯·æ±‚ï¼Œä»æ–‡ä»¶çš„512Kä½ç½®å¼€å§‹ä¼ è¾“ï¼Œå¹¶ä¸”åœ¨HTTPå¤´ä¸­å¢åŠ ï¼š&lt;/p&gt;
&lt;p&gt;Content-Range:bytes 512000-/1024000å¹¶ä¸”æ­¤æ—¶æœåŠ¡ç«¯è¿”å›çš„HTTPçŠ¶æ€ç åº”è¯¥æ˜¯206ï¼Œè€Œä¸æ˜¯200ã€‚&lt;/p&gt;
">HTTP ç³»åˆ—ï¼ˆä¸‰ï¼‰ç†Ÿæ‚‰ HTTP åè®®ç»“æ„å’Œé€šè®¯åŸç†</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/jvm-la-ji-hui-shou/"" data-c="
          &lt;h1 id=&#34;ä¸€-å¦‚ä½•åˆ¤æ–­å¯¹è±¡å¯ä»¥å›æ”¶&#34;&gt;ä¸€ã€å¦‚ä½•åˆ¤æ–­å¯¹è±¡å¯ä»¥å›æ”¶&lt;/h1&gt;
&lt;h2 id=&#34;11-å¼•ç”¨è®¡æ•°æ³•&#34;&gt;1.1 å¼•ç”¨è®¡æ•°æ³•&lt;/h2&gt;
&lt;p&gt;å¦‚æœä¸€ä¸ªå¯¹è±¡è¢«å…¶ä»–å˜é‡å¼•ç”¨ï¼Œè®¡æ•°å™¨ +1ï¼Œå¦‚æœæŸä¸ªå˜é‡ä¸å†å¼•ç”¨ï¼Œè®¡æ•°å™¨ -1ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡çš„&lt;strong&gt;å¼•ç”¨æ¬¡æ•°ä¸º 0&lt;/strong&gt;ï¼Œå°±å¯ä»¥è¢«å›æ”¶ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¾ªç¯å¼•ç”¨é—®é¢˜&#34;&gt;å¾ªç¯å¼•ç”¨é—®é¢˜&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%BE%AA%E7%8E%AF%E5%BC%95%E7%94%A8.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;A å¯¹è±¡å¼•ç”¨ B å¯¹è±¡ï¼ŒB å¯¹è±¡çš„å¼•ç”¨è®¡æ•° = 1ï¼›B å¯¹è±¡å¼•ç”¨äº† A å¯¹è±¡ï¼ŒA å¯¹è±¡çš„å¼•ç”¨è®¡æ•° = 1ï¼Œä½†æ˜¯æ²¡æœ‰å…¶ä»–å¯¹è±¡åœ¨å¼•ç”¨å®ƒä»¬ä¸¤ä¸ªï¼Œå®ƒä»¬æœ¬åº”è¢«å›æ”¶ï¼Œå´å› å½¼æ­¤å¾ªç¯å¼•ç”¨ï¼Œè®¡æ•°å™¨ä¸ä¸º 0 ï¼Œä¸èƒ½è¢«å›æ”¶ï¼Œé€ æˆå†…å­˜æ³„éœ²ã€‚&lt;/p&gt;
&lt;h2 id=&#34;12-å¯è¾¾æ€§åˆ†æç®—æ³•&#34;&gt;1.2 å¯è¾¾æ€§åˆ†æç®—æ³•&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Java è™šæ‹Ÿæœºä¸­çš„åƒåœ¾å›æ”¶å™¨é‡‡ç”¨&lt;strong&gt;å¯è¾¾æ€§åˆ†æ&lt;/strong&gt;æ¥æ¢ç´¢æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡&lt;/li&gt;
&lt;li&gt;æ‰«æ&lt;strong&gt;å †&lt;/strong&gt;ä¸­çš„å¯¹è±¡ï¼Œçœ‹æ˜¯å¦èƒ½å¤Ÿæ²¿ç€ &lt;strong&gt;GC Rootå¯¹è±¡ä¸ºèµ·ç‚¹çš„å¼•ç”¨é“¾æ‰¾åˆ°è¯¥å¯¹è±¡&lt;/strong&gt;ï¼Œæ‰¾ä¸åˆ°ï¼Œè¡¨ç¤ºå¯ä»¥å›æ”¶&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;å“ªäº›å¯¹è±¡å¯ä»¥ä½œä¸º-gc-root&#34;&gt;å“ªäº›å¯¹è±¡å¯ä»¥ä½œä¸º GC Root ?&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;è™šæ‹Ÿæœºæ ˆä¸­å±€éƒ¨å˜é‡å¼•ç”¨çš„å¯¹è±¡&lt;/li&gt;
&lt;li&gt;æœ¬åœ°æ–¹æ³•æ ˆä¸­ JNI ä¸­å¼•ç”¨çš„å¯¹è±¡&lt;/li&gt;
&lt;li&gt;æ–¹æ³•å»åŒºé™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡&lt;/li&gt;
&lt;li&gt;æ–¹æ³•åŒºä¸­çš„å¸¸é‡å¼•ç”¨çš„å¯¹è±¡&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;13-å››ç§å¼•ç”¨&#34;&gt;1.3 å››ç§å¼•ç”¨&lt;/h2&gt;
&lt;h3 id=&#34;131-å¼ºå¼•ç”¨&#34;&gt;1.3.1. å¼ºå¼•ç”¨&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸€ä¸ªå¯¹è±¡é€šè¿‡ç­‰å·èµ‹å€¼è¿ç®—ç¬¦èµ‹å€¼ç»™å˜é‡ï¼Œå¦‚ï¼šList&lt;String&gt; list = new ArrayList&amp;lt;&amp;gt;();&lt;br&gt;
å˜é‡ list å¼ºå¼•ç”¨äº†å¯¹è±¡ ArrayListã€‚åªè¦æ²¿ç€ GC Root èƒ½å¤Ÿæ‰¾åˆ°è¿™ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å°±ä¸ä¼šè¢«åƒåœ¾å›æ”¶ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;åªæœ‰æ‰€æœ‰ GC Roots å¯¹è±¡éƒ½ä¸é€šè¿‡ã€å¼ºå¼•ç”¨ã€‘å¼•ç”¨è¯¥å¯¹è±¡ï¼Œè¯¥å¯¹è±¡æ‰èƒ½è¢«åƒåœ¾å›æ”¶&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%BC%BA%E5%BC%95%E7%94%A8.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%BC%BA%E5%BC%95%E7%94%A82.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;package cn.itcast.jvm.t2;

import java.io.IOException;
import java.lang.ref.SoftReference;
import java.util.ArrayList;
import java.util.List;

/**
 * æ¼”ç¤ºå¼ºå¼•ç”¨
 * -Xmx20m -XX:+PrintGCDetails -verbose:gc
 */
public class Demo2_3 {
    private static final int _4MB = 4 * 1024 * 1024;
    public static void main(String[] args) throws IOException {
      List&amp;lt;byte[]&amp;gt; list = new ArrayList&amp;lt;&amp;gt;();
      for (int i = 0; i &amp;lt; 5; i++) {
          list.add(new byte[_4MB]);// è¯»å–å›¾ç‰‡æ”¾åˆ° list é›†åˆä¸­è¿›è¡Œæ˜¾ç¤ºï¼Œä½†æ˜¯å›¾ç‰‡èµ„æºå¹¶ä¸å±äºæ ¸å¿ƒä¸šåŠ¡èµ„æºï¼Œå¦‚æœå›¾ç‰‡è¿‡å¤šï¼Œç”¨å¼ºå¼•ç”¨å°±ä¼šå¯¼è‡´æº¢å‡ºã€‚ä¸å¤ªé‡è¦çš„èµ„æºèƒ½ä¸èƒ½åœ¨å†…å­˜ç´§å¼ æ—¶æŠŠå®ƒå ç”¨çš„å†…å­˜é‡Šæ”¾æ‰ï¼Œä»¥åå¦‚æœå†ç”¨åˆ°çš„è¯å†è¯»å–ä¸€éå‘¢ï¼Ÿé‡‡ç”¨è½¯å¼•ç”¨ã€‚
      } 
      System.in.read();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€šè¿‡ &lt;code&gt;-Xmx20m -XX:+PrintGCDetails -verbose:gc&lt;/code&gt; è®¾ç½®å †ç©ºé—´å¤§å°ä¸º 20M å¹¶ä¸”æ‰“å° GC ä¿¡æ¯ï¼Œåˆ›å»º list å˜é‡å¼ºå¼•ç”¨ ArrayLsit å¯¹è±¡ï¼Œå‘ ArrayList å†…æ”¾å…¥ 20M å¯¹è±¡ï¼Œç”±äºç¨‹åºä¸€ç›´æœªè¢«ç»ˆæ­¢ï¼Œæ‰€ä»¥ list ä¸èƒ½è¢«å›æ”¶ï¼Œå¯¼è‡´ å †å†…å­˜æº¢å‡ºå¼‚å¸¸ &lt;code&gt;OutOfMemoryError: Java heap space&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Exception in thread &amp;quot;main&amp;quot; java.lang.OutOfMemoryError: Java heap space
	at cn.itcast.jvm.t2.Demo2_3.main(Demo2_3.java:21)
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;132-è½¯å¼•ç”¨softreference&#34;&gt;1.3.2. è½¯å¼•ç”¨ï¼ˆSoftReferenceï¼‰&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ä»…æœ‰è½¯å¼•ç”¨å¼•ç”¨è¯¥å¯¹è±¡æ—¶ï¼Œåœ¨&lt;strong&gt;åƒåœ¾å›æ”¶åï¼Œå†…å­˜ä»ä¸è¶³&lt;/strong&gt;æ—¶ä¼šå†æ¬¡è§¦å‘åƒåœ¾å›æ”¶ï¼Œå›æ”¶è½¯å¼•ç”¨å¯¹è±¡&lt;/li&gt;
&lt;li&gt;å¯ä»¥é…åˆ&lt;strong&gt;å¼•ç”¨é˜Ÿåˆ—&lt;/strong&gt;æ¥é‡Šæ”¾è½¯å¼•ç”¨è‡ªèº«&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%BD%AF%E5%BC%95%E7%94%A8.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;package cn.itcast.jvm.t2;

import java.io.IOException;
import java.lang.ref.SoftReference;
import java.util.ArrayList;
import java.util.List;

/**
 * æ¼”ç¤ºè½¯å¼•ç”¨
 * -Xmx20m -XX:+PrintGCDetails -verbose:gc
 */
public class Demo2_3 {

    private static final int _4MB = 4 * 1024 * 1024;

    public static void main(String[] args) throws IOException {
        soft();
    }

    public static void soft() {
        // list --&amp;gt; SoftReference --&amp;gt; byte[]
        // list å’Œ SoftReference ä¹‹é—´æ˜¯å¼ºå¼•ç”¨ï¼ŒSoftReference å’Œ byte[] ä¹‹é—´æ˜¯è½¯å¼•ç”¨
        List&amp;lt;SoftReference&amp;lt;byte[]&amp;gt;&amp;gt; list = new ArrayList&amp;lt;&amp;gt;();
        for (int i = 0; i &amp;lt; 5; i++) {
            SoftReference&amp;lt;byte[]&amp;gt; ref = new SoftReference&amp;lt;&amp;gt;(new byte[_4MB]);
            System.out.println(ref.get());
            list.add(ref);
            System.out.println(list.size());

        }
        System.out.println(&amp;quot;å¾ªç¯ç»“æŸï¼š&amp;quot; + list.size());
        for (SoftReference&amp;lt;byte[]&amp;gt; ref : list) {
            System.out.println(ref.get());
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%BD%AF%E5%BC%95%E7%94%A8GC.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;æ¸…ç†æ— ç”¨çš„è½¯å¼•ç”¨ï¼šå¼•ç”¨é˜Ÿåˆ—&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è½¯å¼•ç”¨å¯¹è±¡è¢«é‡Šæ”¾åï¼Œæ²¡å¿…è¦å†ä¿å­˜åœ¨ list ä¸­äº†ï¼Œå¸Œæœ›æŠŠ&lt;strong&gt;è½¯å¼•ç”¨æœ¬èº«åšä¸€ä¸ªæ¸…ç†&lt;/strong&gt;ï¼Œä» list é›†åˆä¸­æ¸…ç†æ‰ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;package cn.itcast.jvm.t2;

import java.lang.ref.Reference;
import java.lang.ref.ReferenceQueue;
import java.lang.ref.SoftReference;
import java.util.ArrayList;
import java.util.List;

/**
 * æ¼”ç¤ºè½¯å¼•ç”¨, é…åˆå¼•ç”¨é˜Ÿåˆ—
 */
public class Demo2_4 {
    private static final int _4MB = 4 * 1024 * 1024;

    public static void main(String[] args) {
        List&amp;lt;SoftReference&amp;lt;byte[]&amp;gt;&amp;gt; list = new ArrayList&amp;lt;&amp;gt;();

        // å¼•ç”¨é˜Ÿåˆ—
        ReferenceQueue&amp;lt;byte[]&amp;gt; queue = new ReferenceQueue&amp;lt;&amp;gt;();
        for (int i = 0; i &amp;lt; 5; i++) {
            // å…³è”äº†å¼•ç”¨é˜Ÿåˆ—ï¼Œ å½“è½¯å¼•ç”¨æ‰€å…³è”çš„ byte[]è¢«å›æ”¶æ—¶ï¼Œè½¯å¼•ç”¨è‡ªå·±ä¼šåŠ å…¥åˆ° queue ä¸­å»
            SoftReference&amp;lt;byte[]&amp;gt; ref = new SoftReference&amp;lt;&amp;gt;(new byte[_4MB], queue);
            System.out.println(ref.get());
            list.add(ref);
            System.out.println(list.size());
        }

        // ä»é˜Ÿåˆ—ä¸­è·å–æ— ç”¨çš„ è½¯å¼•ç”¨å¯¹è±¡ï¼Œå¹¶ç§»é™¤
        Reference&amp;lt;? extends byte[]&amp;gt; poll = queue.poll();
        while( poll != null) {
            list.remove(poll);
            poll = queue.poll();
        }

        System.out.println(&amp;quot;===========================&amp;quot;);
        for (SoftReference&amp;lt;byte[]&amp;gt; reference : list) {
            System.out.println(reference.get());
        }

    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼šå€¼ä¸ºç©ºçš„è½¯å¼•ç”¨éƒ½è¢«ä» list é›†åˆä¸­æ¸…é™¤äº†&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[B@6d6f6e28
1
[B@135fbaa4
2
[B@45ee12a7
3
[B@330bedb4
4
[B@2503dbd3
5
===========================
[B@2503dbd3
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;133-å¼±å¼•ç”¨weakreference&#34;&gt;1.3.3. å¼±å¼•ç”¨ï¼ˆWeakReferenceï¼‰&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ä»…æœ‰å¼±å¼•ç”¨å¼•ç”¨è¯¥å¯¹è±¡æ—¶ï¼Œåœ¨åƒåœ¾å›æ”¶æ—¶ï¼Œæ— è®ºå†…å­˜æ˜¯å¦å……è¶³ï¼Œéƒ½ä¼šå›æ”¶å¼±å¼•ç”¨å¯¹è±¡&lt;/li&gt;
&lt;li&gt;å¯ä»¥é…åˆå¼•ç”¨é˜Ÿåˆ—æ¥é‡Šæ”¾å¼±å¼•ç”¨è‡ªèº«&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%BC%B1%E5%BC%95%E7%94%A8.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;å¼•ç”¨é˜Ÿåˆ—ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%BC%B1%E5%BC%95%E7%94%A8%E5%BC%95%E7%94%A8%E9%98%9F%E5%88%97.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;å½“è½¯å¼•ç”¨çš„å¯¹è±¡è¢«å›æ”¶åï¼Œè½¯å¼•ç”¨è‡ªèº«ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚æœåœ¨åˆ›å»ºæ—¶ç»™ä»–åˆ†é…äº†ä¸€ä¸ªå¼•ç”¨é˜Ÿåˆ—ï¼Œé‚£åœ¨å®ƒ&lt;strong&gt;å¼•ç”¨çš„å¯¹è±¡è¢«å›æ”¶&lt;/strong&gt;æ—¶ï¼Œè½¯å¼•ç”¨å°±ä¼šè¿›å…¥è¿™ä¸ª&lt;strong&gt;å¼•ç”¨é˜Ÿåˆ—&lt;/strong&gt;ã€‚å½“å¼±å¼•ç”¨çš„å¯¹è±¡è¢«åƒåœ¾å›æ”¶åï¼Œå¼±å¼•ç”¨å¦‚æœè¢«åˆ†é…äº†å¼•ç”¨é˜Ÿåˆ—çš„è¯ï¼Œ å¼±å¼•ç”¨ä¹Ÿä¼šè¿›å…¥å¼•ç”¨é˜Ÿåˆ—ã€‚å› ä¸ºè½¯å¼•ç”¨ã€å¼±å¼•ç”¨è‡ªèº«ä¹Ÿè¦å ç”¨ä¸€å®šå†…å­˜ï¼Œå¦‚æœè¦å¯¹å®ƒä¿©å ç”¨çš„å†…å­˜è¿›ä¸€æ­¥é‡Šæ”¾ï¼Œéœ€è¦ä½¿ç”¨å¼•ç”¨é˜Ÿåˆ—æ¥æ‰¾åˆ°å®ƒä»¬ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;package cn.itcast.jvm.t2;

import java.lang.ref.Reference;
import java.lang.ref.ReferenceQueue;
import java.lang.ref.SoftReference;
import java.lang.ref.WeakReference;
import java.util.ArrayList;
import java.util.List;

/**
 * æ¼”ç¤ºå¼±å¼•ç”¨
 * -Xmx20m -XX:+PrintGCDetails -verbose:gc
 */
public class Demo2_5 {
    private static final int _4MB = 4 * 1024 * 1024;

    public static void main(String[] args) {
        //  list --&amp;gt; WeakReference --&amp;gt; byte[]
        List&amp;lt;WeakReference&amp;lt;byte[]&amp;gt;&amp;gt; list = new ArrayList&amp;lt;&amp;gt;();
        for (int i = 0; i &amp;lt; 10; i++) {
            WeakReference&amp;lt;byte[]&amp;gt; ref = new WeakReference&amp;lt;&amp;gt;(new byte[_4MB]);
            list.add(ref);
            for (WeakReference&amp;lt;byte[]&amp;gt; w : list) {
                System.out.print(w.get()+&amp;quot; &amp;quot;);
            }
            System.out.println();

        }
        System.out.println(&amp;quot;å¾ªç¯ç»“æŸï¼š&amp;quot; + list.size());
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%BC%B1%E5%BC%95%E7%94%A8GC.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;åœ¨&lt;strong&gt;åƒåœ¾å›æ”¶æ—¶ï¼Œä¼šæŠŠå¼±å¼•ç”¨æ‰€å ç”¨çš„å†…å­˜é‡Šæ”¾æ‰&lt;/strong&gt;ï¼Œå¼±å¼•ç”¨è‡ªèº«å ç”¨çš„å†…å­˜è¦é‡Šæ”¾çš„è¯ï¼Œè¦ç»“åˆå¼•ç”¨é˜Ÿåˆ—æ¥å®ç°ã€‚&lt;/p&gt;
&lt;h3 id=&#34;134-è™šå¼•ç”¨phantomreference&#34;&gt;1.3.4. è™šå¼•ç”¨ï¼ˆPhantomReferenceï¼‰&lt;/h3&gt;
&lt;p&gt;è™šå¼•ç”¨å’Œç»ˆç»“å™¨å¼•ç”¨å¿…é¡»é…åˆå¼•ç”¨é˜Ÿåˆ—ä½¿ç”¨ã€‚&lt;strong&gt;å½“åˆ›å»ºè™šå¼•ç”¨å’Œç»ˆç»“å™¨å¼•ç”¨æ—¶ï¼Œéƒ½ä¼šå…³è”ä¸€ä¸ªå¼•ç”¨é˜Ÿåˆ—ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¿…é¡»é…åˆå¼•ç”¨é˜Ÿåˆ—ä½¿ç”¨ï¼Œä¸»è¦é…åˆ ByteBuffer ä½¿ç”¨ï¼Œè¢«å¼•ç”¨å¯¹è±¡å›æ”¶æ—¶ï¼Œä¼šå°†è™šå¼•ç”¨å…¥é˜Ÿï¼Œ ç”± Reference Handler çº¿ç¨‹è°ƒç”¨è™šå¼•ç”¨ç›¸å…³æ–¹æ³•&lt;strong&gt;é‡Šæ”¾ç›´æ¥å†…å­˜&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;9&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%99%9A%E5%BC%95%E7%94%A8.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;åˆ›å»º ByteBuffer çš„å®ç°å¯¹è±¡æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªåä¸º Cleaner çš„&lt;strong&gt;è™šå¼•ç”¨å¯¹è±¡&lt;/strong&gt;ï¼ŒByteBuffer ä¼šåˆ†é…ä¸€å—ç›´æ¥å†…å­˜ï¼Œå¹¶ä¸”ä¼šæŠŠç›´æ¥å†…å­˜çš„åœ°å€ä¼ é€’ç»™è™šå¼•ç”¨å¯¹è±¡ã€‚å°†æ¥ ByteBuffer æ²¡æœ‰è¢«å¼ºå¼•ç”¨å¼•ç”¨æ—¶ï¼ŒByteBuffer å°±ä¼šè¢«åƒåœ¾å›æ”¶ï¼Œä½†æ˜¯ç»™ä»–åˆ†é…çš„&lt;strong&gt;ç›´æ¥å†…å­˜å¹¶ä¸èƒ½è¢« Java åƒåœ¾å›æ”¶&lt;/strong&gt;ç®¡ç†ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;10&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%99%9A%E5%BC%95%E7%94%A82.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;æ‰€ä»¥åœ¨ ByteBuffer è¢«å›æ”¶æ—¶ï¼Œè®©è™šå¼•ç”¨å¯¹è±¡è¿›å…¥å¼•ç”¨é˜Ÿåˆ—ï¼Œè™šå¼•ç”¨æ‰€åœ¨çš„å¼•ç”¨é˜Ÿåˆ—ä¼šç”± ReferenceHandler çº¿ç¨‹å®šæ—¶åˆ°è¿™ä¸ªå¼•ç”¨é˜Ÿåˆ—ä¸­æ‰¾çœ‹æœ‰æ²¡æœ‰æ–°å…¥é˜Ÿçš„ Cleanerï¼Œå¦‚æœæœ‰ï¼Œå°±ä¼šè°ƒç”¨ Cleaner ä¸­çš„ clean() æ–¹æ³•ï¼Œæ ¹æ®å‰é¢è®°å½•çš„ç›´æ¥å†…å­˜çš„åœ°å€è°ƒç”¨ Unsafe.freeMemory()ï¼Œ&lt;strong&gt;é‡Šæ”¾ç›´æ¥å†…å­˜&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;135-ç»ˆç»“å™¨å¼•ç”¨finalreference&#34;&gt;1.3.5. ç»ˆç»“å™¨å¼•ç”¨ï¼ˆFinalReferenceï¼‰&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æ— éœ€æ‰‹åŠ¨ç¼–ç ï¼Œä½†å…¶å†…éƒ¨&lt;strong&gt;é…åˆå¼•ç”¨é˜Ÿåˆ—ä½¿ç”¨&lt;/strong&gt;ï¼Œåœ¨&lt;strong&gt;åƒåœ¾å›æ”¶&lt;/strong&gt;æ—¶ï¼Œ&lt;strong&gt;ç»ˆç»“å™¨å¼•ç”¨å…¥é˜Ÿ&lt;/strong&gt;ï¼ˆè¢«å¼•ç”¨å¯¹è±¡æš‚æ—¶æ²¡æœ‰è¢«å›æ”¶ï¼‰ï¼Œå†ç”± Finalizer çº¿ç¨‹é€šè¿‡ç»ˆç»“å™¨å¼•ç”¨æ‰¾åˆ°è¢«å¼•ç”¨å¯¹è±¡å¹¶&lt;strong&gt;è°ƒç”¨å®ƒçš„ finalize æ–¹æ³•&lt;/strong&gt;ï¼Œ&lt;strong&gt;ç¬¬äºŒæ¬¡ GC æ—¶æ‰èƒ½å›æ”¶è¢«å¼•ç”¨å¯¹è±¡&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;11&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E7%BB%88%E7%BB%93%E5%99%A8%E5%BC%95%E7%94%A8.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;æ‰€æœ‰çš„ Java å¯¹è±¡éƒ½ä¼šç»§æ‰¿åœ¨ Object çˆ¶ç±»ï¼ŒObject ç±»ä¸­æœ‰ä¸€ä¸ª finalize() ç»ˆç»“æ–¹æ³•ã€‚æŸä¸ªå¯¹è±¡&lt;strong&gt;é‡å†™äº† finalize() æ–¹æ³•&lt;/strong&gt;ï¼Œå½“æ²¡æœ‰å¼ºå¼•ç”¨å¼•ç”¨å®ƒæ—¶ï¼Œå°±ç”±è™šæ‹Ÿæœºåˆ›å»ºå®ƒå¯¹åº”çš„ç»ˆç»“å™¨å¼•ç”¨ï¼Œå½“è¿™ä¸ªå¯¹è±¡è¦è¢«åƒåœ¾å›æ”¶æ—¶ï¼Œå°±ä¼šæŠŠè¿™ä¸ª&lt;strong&gt;ç»ˆç»“å™¨å¼•ç”¨åŠ å…¥å¼•ç”¨é˜Ÿåˆ—&lt;/strong&gt;ï¼Œå†ç”±ä¸€ä¸ª&lt;strong&gt;ä¼˜å…ˆçº§å¾ˆä½çš„çº¿ç¨‹ &lt;strong&gt;ï¼ˆfinalize() è¿Ÿè¿Ÿæœªèƒ½è¢«è°ƒç”¨ï¼Œå¯¼è‡´å¯¹è±¡å¾ˆä¹…ä¸èƒ½è¢«çœŸæ­£å›æ”¶ï¼Œæ‰€ä»¥ä¸æ¨èä½¿ç”¨ finalize() é‡Šæ”¾èµ„æºï¼‰finalizeHandler çº¿ç¨‹æŸ¥çœ‹å¼•ç”¨é˜Ÿåˆ—ä¸­æ˜¯å¦æœ‰ç»ˆç»“å™¨å¼•ç”¨ï¼Œå¦‚æœæœ‰ï¼Œå°±ä¼šæ ¹æ®ç»ˆç»“å™¨å¼•ç”¨æ‰¾åˆ°é‚£ä¸ª&lt;/strong&gt;è¦è¢«åƒåœ¾å›æ”¶çš„å¯¹è±¡&lt;/strong&gt;ï¼Œå¹¶ä¸”&lt;strong&gt;è°ƒç”¨å®ƒçš„ finalize()æ–¹æ³•&lt;/strong&gt;ï¼Œè°ƒç”¨å®Œäº†ï¼Œ&lt;strong&gt;ä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶æ—¶å°±å¯ä»¥æŠŠè¿™ä¸ªå¯¹è±¡å ç”¨çš„å†…å­˜çœŸæ­£å›æ”¶äº†&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h1 id=&#34;äºŒ-åƒåœ¾å›æ”¶ç®—æ³•&#34;&gt;äºŒã€åƒåœ¾å›æ”¶ç®—æ³•&lt;/h1&gt;
&lt;h2 id=&#34;21-æ ‡è®°æ¸…é™¤&#34;&gt;2.1 æ ‡è®°æ¸…é™¤&lt;/h2&gt;
&lt;p&gt;å®šä¹‰ï¼š Mark Sweep&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€Ÿåº¦å¿«&lt;/li&gt;
&lt;li&gt;ä¼šé€ æˆå†…å­˜ç¢ç‰‡&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ ‡è®°æ¸…é™¤æµç¨‹&#34;&gt;æ ‡è®°æ¸…é™¤æµç¨‹&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;12&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%A0%87%E8%AE%B0%E6%B8%85%E9%99%A4.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;æ ‡è®°&lt;/strong&gt;ï¼šæ²¿ç€ GC Root çš„å¼•ç”¨é“¾å»æ‰¾ï¼Œæ‰«ææ•´ä¸ªå †å¯¹è±¡çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå‘ç°æŸä¸ªå †å¯¹è±¡ç¡®å®è¢«å¼•ç”¨äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªå †å¯¹è±¡æ˜¯éåƒåœ¾å¯¹è±¡ï¼Œå¦‚æœæŸä¸ªå¯¹&lt;strong&gt;è±¡æ²¡æœ‰ä»»ä½•ä¸€ä¸ª GC Root ç›´æ¥æˆ–é—´æ¥å¼•ç”¨&lt;/strong&gt;å®ƒï¼Œé‚£ä¹ˆæŠŠå®ƒ&lt;strong&gt;æ ‡è®°ä¸ºåƒåœ¾å¯¹è±¡&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ¸…é™¤&lt;/strong&gt;ï¼šå°†è¢«æ ‡è®°ä¸ºåƒåœ¾å¯¹è±¡æ‰€å ç”¨çš„ç©ºé—´é‡Šæ”¾æ‰ã€‚è¿™é‡Œè¯´çš„é‡Šæ”¾ä¸æ˜¯æŠŠè¿™ä¸ªå¯¹è±¡æ‰€å ç”¨çš„å†…å­˜çš„æ¯ä¸ªå­—èŠ‚æ¸…é›¶ï¼Œåªéœ€è¦æŠŠåƒ&lt;strong&gt;åœ¾å¯¹è±¡å ç”¨å†…å­˜çš„èµ·å§‹ã€ç»“æŸåœ°å€è®°å½•ä¸‹æ¥ï¼Œæ”¾åœ¨ä¸€ä¸ªç©ºé—²åœ°å€åˆ—è¡¨&lt;/strong&gt;ï¼Œä¸‹æ¬¡åˆ†é…æ–°å¯¹è±¡æ—¶ï¼Œåˆ°ç©ºé—²åœ°å€åˆ—è¡¨ä¸­æ‰¾æ˜¯å¦æœ‰ä¸€å—è¶³å¤Ÿçš„ç©ºé—´èƒ½å®¹çº³æ–°å¯¹è±¡ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä¼˜ç‚¹&#34;&gt;ä¼˜ç‚¹&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;é€Ÿåº¦å¿«&lt;/strong&gt;ï¼Œåªéœ€æŠŠåƒåœ¾å¯¹è±¡çš„èµ·å§‹ã€ç»“æŸåœ°å€è®°å½•ä¸‹æ¥ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç¼ºç‚¹&#34;&gt;ç¼ºç‚¹&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;13&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%A0%87%E8%AE%B0%E6%B8%85%E9%99%A4%E5%86%85%E7%A2%8E%E7%89%87.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;æ˜“äº§ç”Ÿ&lt;strong&gt;å†…å­˜ç¢ç‰‡&lt;/strong&gt;ã€‚æ¸…é™¤åƒåœ¾å¯¹è±¡åä¸ä¼šå¯¹å†…å­˜ç©ºé—´è¿›è¡Œæ•´ç†ï¼Œå¦‚æœåˆ†é…äº†ä¸€ä¸ªè¾ƒå¤§çš„å¯¹è±¡ï¼Œæ¯”å¦‚æ•°ç»„ï¼Œæ•°ç»„éœ€è¦ä¸€æ®µè¿ç»­çš„å†…å­˜ã€‚æ¯ä¸ªå°çš„ç©ºé—²ç©ºé—´éƒ½ä¸è¶³ä»¥å®¹çº³ä¸‹è¿™ä¸ªè¾ƒå¤§çš„æ–°å¯¹è±¡ï¼Œè™½ç„¶æ€»çš„ç©ºé—²ç©ºé—´è¶³å¤Ÿï¼Œä½†ç”±äº&lt;strong&gt;ä¸è¿ç»­&lt;/strong&gt;ï¼Œé€ æˆæ–°å¯¹è±¡ä¸èƒ½è¢«ä¿å­˜ã€‚&lt;/p&gt;
&lt;h2 id=&#34;22-æ ‡è®°æ•´ç†&#34;&gt;2.2 æ ‡è®°æ•´ç†&lt;/h2&gt;
&lt;p&gt;å®šä¹‰ï¼šMark Compact&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€Ÿåº¦æ…¢&lt;/li&gt;
&lt;li&gt;æ²¡æœ‰å†…å­˜ç¢ç‰‡&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ ‡è®°æ•´ç†æµç¨‹&#34;&gt;æ ‡è®°æ•´ç†æµç¨‹&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;14&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%A0%87%E8%AE%B0%E6%95%B4%E7%90%86.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;æ ‡è®°&lt;/strong&gt;ï¼šæ²¡æœ‰ä»»ä½• GC Root ç›´æ¥æˆ–é—´æ¥æŒ‡å‘çš„å †å¯¹è±¡è¢«æ ‡è®°ä¸ºåƒåœ¾å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ•´ç†&lt;/strong&gt;ï¼šé¿å…æ ‡è®°æ¸…é™¤æ—¶çš„å†…å­˜ç¢ç‰‡é—®é¢˜ï¼Œåœ¨æ¸…ç†åƒåœ¾çš„è¿‡ç¨‹ä¸­ï¼Œä¼šæŠŠå¯ç”¨çš„å¯¹è±¡å‘å‰ç§»åŠ¨ï¼Œè®©å†…å­˜æ›´ä¸º&lt;strong&gt;ç´§å‡‘&lt;/strong&gt;ï¼Œè¿ç»­çš„å†…å­˜ç©ºé—´å°±æ›´å¤§äº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä¼˜ç‚¹-2&#34;&gt;ä¼˜ç‚¹&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;æ²¡æœ‰å†…ç¢ç‰‡&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç¼ºç‚¹-2&#34;&gt;ç¼ºç‚¹&lt;/h3&gt;
&lt;p&gt;ç”±äºæ•´ç†ç‰µæ‰¯åˆ°å¯¹è±¡çš„ç§»åŠ¨ï¼Œ&lt;strong&gt;æ•ˆç‡é™ä½&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹è±¡åœ¨æ•´ç†è¿‡ç¨‹ä¸­å‘ç”Ÿç§»åŠ¨ï¼Œå¦‚æœæœ‰å…¶ä»–å±€éƒ¨å˜é‡å¼•ç”¨äº†è¿™ä¸ªè¢«ç§»åŠ¨çš„å¯¹è±¡ï¼Œå°±éœ€è¦æ”¹å˜è¿™äº›å¼•ç”¨çš„åœ°å€ã€‚&lt;/p&gt;
&lt;h2 id=&#34;23-å¤åˆ¶&#34;&gt;2.3 å¤åˆ¶&lt;/h2&gt;
&lt;p&gt;å®šä¹‰ï¼šCopy&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸ä¼šæœ‰å†…å­˜ç¢ç‰‡&lt;/li&gt;
&lt;li&gt;éœ€è¦å ç”¨åŒå€å†…å­˜ç©ºé—´&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;å¤åˆ¶æµç¨‹&#34;&gt;å¤åˆ¶æµç¨‹&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;15&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%A4%8D%E5%88%B61.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;æ ‡è®°åƒåœ¾å¯¹è±¡&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;16&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%A4%8D%E5%88%B62.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;å¤åˆ¶ FROM åŒºåŸŸçš„éåƒåœ¾å¯¹è±¡åˆ° TO åŒºåŸŸ&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;17&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%A4%8D%E5%88%B63.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;æ¸…ç©º FROM åŒºåŸŸå‰©ä½™çš„åƒåœ¾å¯¹è±¡åäº¤æ¢ FROM å’Œ TO åŒºåŸŸ&lt;/p&gt;
&lt;p&gt;å°†å†…å­˜åŒºåŸŸåˆ’åˆ†æˆä¸¤å—å¤§å°ç›¸ç­‰çš„åŒºåŸŸï¼ŒFROM å’Œ TOï¼ˆç©ºé—²ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ ‡è®°&lt;/strong&gt;ï¼šæ‰¾åˆ°é‚£äº›ä¸è¢«å¼•ç”¨çš„å¯¹è±¡æ ‡è®°ä¸ºåƒåœ¾å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¤åˆ¶&lt;/strong&gt;ï¼šæŠŠ &lt;strong&gt;FROM åŒºåŸŸä¸Šçš„éåƒåœ¾å¯¹è±¡å¤åˆ¶åˆ° TO åŒºåŸŸ&lt;/strong&gt;ä¸­ï¼Œå¤åˆ¶çš„è¿‡ç¨‹ä¸­å®Œæˆç¢ç‰‡æ•´ç†ã€‚å¤åˆ¶å®Œæˆåï¼Œ&lt;strong&gt;FROM åŒºåŸŸ&lt;/strong&gt;éƒ½æ˜¯åƒåœ¾å¯¹è±¡ï¼Œ&lt;strong&gt;å…¨éƒ¨æ¸…é™¤&lt;/strong&gt;ï¼Œå¹¶ä¸”&lt;strong&gt;äº¤æ¢ FROM å’Œ TO åŒºåŸŸ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä¼˜ç‚¹-3&#34;&gt;ä¼˜ç‚¹&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;ä¸ä¼šäº§ç”Ÿç¢ç‰‡ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&#34;ç¼ºç‚¹-3&#34;&gt;ç¼ºç‚¹&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;å ç”¨åŒå€å†…å­˜ç©ºé—´ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&#34;ä¸‰-åˆ†ä»£åƒåœ¾å›æ”¶&#34;&gt;ä¸‰ã€åˆ†ä»£åƒåœ¾å›æ”¶&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;å †å†…å­˜åˆ’åˆ†&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ–°ç”Ÿä»£ï¼šç”¨å®Œäº†å°±ä¸¢å¼ƒã€‚&lt;strong&gt;æœç”Ÿå¤•æ­»&lt;/strong&gt;çš„å¯¹è±¡
&lt;ul&gt;
&lt;li&gt;ä¼Šç”¸å›­ Eden&lt;/li&gt;
&lt;li&gt;å¹¸å­˜åŒº FROM&lt;/li&gt;
&lt;li&gt;å¹¸å­˜åŒº TO&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è€å¹´ä»£ï¼šé•¿æ—¶é—´ä½¿ç”¨çš„å¯¹è±¡ã€‚&lt;strong&gt;é•¿æœŸå­˜æ´»&lt;/strong&gt;çš„å¯¹è±¡&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ‰ä¸€æ ‹å±…æ°‘æ¥¼ï¼Œç±»ä¼¼ Java è™šæ‹Ÿæœºä¸­çš„å †å†…å­˜ï¼Œå±…æ°‘æ¥¼ä¸­æ¯å®¶æ¯æˆ·æ¯å¤©è¦äº§ç”Ÿä¸€äº›åƒåœ¾ï¼Œéœ€è¦ä¿æ´å·¥äººæ¥å¤„ç†ï¼Œå¦‚æœä¿æ´å·¥äººæŒ¨å®¶æŒ¨æˆ·å»æ”¶åƒåœ¾ï¼Œæ•ˆç‡ä½ï¼Œæ‰€ä»¥è®¾ç«‹ä¸€ä¸ªåƒåœ¾åœºï¼ˆæ–°ç”Ÿä»£ï¼‰ï¼Œå­˜æ”¾ç”Ÿå‘½å‘¨æœŸçŸ­çš„åƒåœ¾ï¼Œæ¯”å¦‚ç›’é¥­ã€åŒ…è£…è¢‹ç­‰ï¼Œéƒ½æ˜¯å›æ”¶æ›´ä¸ºé¢‘ç¹çš„åƒåœ¾ï¼Œä¿æ´å·¥äººéœ€è¦æ¯å¤©æ‰“æ‰«äº†ä¸€æ¬¡ã€‚ æ¯å®¶æ¯æˆ·é‡Œå­˜å‚¨çš„åƒåœ¾ï¼ˆè€å¹´ä»£ï¼‰ï¼Œæ¯”å¦‚ç”¨æ—§çš„æ¤…å­ï¼Œæš‚å­˜åœ¨å®¶é‡Œï¼Œå°†æ¥ç©ºé—´ç´§å¼ åˆ°æ”¾ä¸ä¸‹æ—¶ï¼Œæ‰¾ä¿æ´å‘˜æ¸…ç†è¿™äº›åƒåœ¾ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;18&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%A0%86%E5%86%85%E5%AD%98%E5%88%92%E5%88%86.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¯¹è±¡é¦–å…ˆåˆ†é…åœ¨ä¼Šç”¸å›­åŒºåŸŸ&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–°ç”Ÿä»£ç©ºé—´ä¸è¶³æ—¶ï¼Œè§¦å‘ minor gcï¼Œä¼Šç”¸å›­å’Œ from å­˜æ´»çš„å¯¹è±¡ä½¿ç”¨ copy å¤åˆ¶åˆ° to ä¸­ï¼Œå­˜æ´»çš„å¯¹è±¡å¹´é¾„åŠ  1å¹¶ä¸”äº¤æ¢ fromã€to&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;minor gc ä¼šå¼•å‘ stop the worldï¼Œæš‚åœå…¶å®ƒç”¨æˆ·çš„çº¿ç¨‹ï¼Œç­‰åƒåœ¾å›æ”¶ç»“æŸï¼Œç”¨æˆ·çº¿ç¨‹æ‰æ¢å¤è¿è¡Œ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹è±¡çš„å¤åˆ¶ä¼šæ›´æ”¹å¯¹è±¡åœ°å€ï¼Œå¦‚æœç”¨æˆ·çº¿ç¨‹ä»åœ¨è¿è¡Œï¼Œå°±ä¼šé€ æˆè®¿é—®åŸæ¥å¯¹è±¡çš„åœ°å€æ‰¾ä¸åˆ°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å½“å¯¹è±¡å¯¿å‘½è¶…è¿‡é˜ˆå€¼æ—¶ï¼Œä¼šæ™‹å‡è‡³è€å¹´ä»£ï¼Œæœ€å¤§å¯¿å‘½æ˜¯15&lt;/strong&gt;ï¼ˆå¯¹è±¡å¤´ä¸­å ç”¨ 4bitï¼š1111Bï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å½“è€å¹´ä»£ç©ºé—´ä¸è¶³ï¼Œä¼šå…ˆå°è¯•è§¦å‘ minor gcï¼Œå¦‚æœä¹‹åç©ºé—´ä»ä¸è¶³ï¼Œé‚£ä¹ˆè§¦å‘ full gcï¼ŒSTWçš„æ—¶é—´æ›´é•¿ï¼Œå¦‚æœä¹‹åç©ºé—´ä»ä¸è¶³ï¼Œå°±ä¼šå†…å­˜æº¢å‡ºã€‚&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;31-åˆ†ä»£åƒåœ¾å›æ”¶æœºåˆ¶åŸç†&#34;&gt;3.1 åˆ†ä»£åƒåœ¾å›æ”¶æœºåˆ¶åŸç†&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;19&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%88%86%E4%BB%A3%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6_1.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;å½“ä¼Šç”¸å›­è¢«å æ»¡æ—¶è¦æ·»åŠ æ–°å¯¹è±¡ï¼Œè§¦å‘ minor gc&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;20&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%88%86%E4%BB%A3%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;å°†ä¼Šç”¸å›­åŒºçš„å¯¹è±¡è¿›è¡Œæ ‡è®°åï¼Œéåƒåœ¾å¯¹è±¡å¤åˆ¶åˆ°å¹¸å­˜åŒº TOï¼Œå¹¶ä¸”å°†è¿™äº›éåƒåœ¾å¯¹è±¡çš„å¯¿å‘½ +1ï¼Œæ¸…ç©ºä¼Šç”¸å›­å†…å‰©ä½™çš„åƒåœ¾å¯¹è±¡&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;21&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%88%86%E4%BB%A3%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6_3.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;äº¤æ¢ FROM å’Œ TO&lt;/p&gt;
&lt;p&gt;åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå­˜æ”¾åˆ°&lt;strong&gt;ä¼Šç”¸å›­&lt;/strong&gt;ï¼Œå½“ä¼Šç”¸å›­è¢«å æ»¡æ—¶ï¼Œè§¦å‘ &lt;strong&gt;minor gc&lt;/strong&gt;ï¼Œå…ˆå¯¹ä¼Šç”¸å›­åŒºåŸŸå†…çš„å¯¹è±¡è¿›è¡Œ&lt;strong&gt;æ ‡è®°&lt;/strong&gt;ï¼Œæ ‡è®°ç»“æŸåï¼Œé‡‡ç”¨&lt;strong&gt;å¤åˆ¶ç®—æ³•&lt;/strong&gt;ï¼Œå°†éåƒåœ¾å¯¹è±¡&lt;strong&gt;å¤åˆ¶&lt;/strong&gt;åˆ°å¹¸å­˜åŒº TOï¼Œå¹¶è®©è¿™äº›å¯¹è±¡çš„å¯¿å‘½+1ï¼Œä¼Šç”¸å›­å‰©ä½™çš„åƒåœ¾å¯¹è±¡å›æ”¶æ‰ï¼Œ&lt;strong&gt;äº¤æ¢&lt;/strong&gt; FROM å’Œ TOï¼Œç¬¬ä¸€æ¬¡ minor gc ç»“æŸã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;22&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%88%86%E4%BB%A3%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6_4.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;å°†ä¼Šç”¸å›­å’Œå¹¸å­˜åŒº FROM ä¸­çš„éåƒåœ¾å¯¹è±¡å¤åˆ¶åˆ°å¹¸å­˜åŒº TOï¼Œå¹¶å°†è¿™äº›å¯¹è±¡çš„å¯¿å‘½ +1ï¼Œæ¸…ç©ºä¼Šç”¸å›­å’Œå¹¸å­˜åŒº FROM ä¸­çš„éåƒåœ¾å¯¹è±¡ï¼Œäº¤æ¢ FROM å’Œ TOã€‚å°†æ–°å¯¹è±¡æ”¾å…¥ä¼Šç”¸å›­ã€‚&lt;/p&gt;
&lt;p&gt;ç»§ç»­åˆ›å»ºå¯¹è±¡å‘ä¼Šç”¸å›­æ·»åŠ ï¼Œä¼Šç”¸å›­å†æ¬¡è¢«å¡«æ»¡ï¼Œå†æ¬¡è§¦å‘ minor gcï¼Œé™¤äº†è¦å°†ä¼Šç”¸å›­ä¸­çš„éåƒåœ¾å¯¹è±¡æ‰¾åˆ°ä»¥å¤–ï¼Œè¿˜è¦æŠŠ&lt;strong&gt;å¹¸å­˜åŒº FROM&lt;/strong&gt; ä¸­çš„éåƒåœ¾å¯¹è±¡æ‰¾åˆ°ï¼Œå°†éåƒåœ¾å¯¹è±¡å¤åˆ¶åˆ°å¹¸å­˜åŒº TOï¼Œå¹¶è®©è¿™äº›å¯¹è±¡çš„å¯¿å‘½ +1ï¼Œä¼Šç”¸å›­å’Œå¹¸å­˜åŒº FROM çš„åƒåœ¾å¯¹è±¡æ¸…é™¤ï¼Œäº¤æ¢ FROM å’Œ TOï¼Œç¬¬äºŒæ¬¡ minor gc ç»“æŸã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;23&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%88%86%E4%BB%A3%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6_5.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;å½“å¹¸å­˜åŒºå¯¹è±¡çš„å¯¿å‘½ = 15æ—¶ï¼Œå°†æ­¤å¯¹å¯¹è±¡ç§»åŠ¨åˆ°è€å¹´ä»£ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;24&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%88%86%E4%BB%A3%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6_6.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;å½“è€å¹´ä»£ç©ºé—´ä¸è¶³ï¼Œè§¦å‘ FULL GCï¼Œå¯¹æ•´ä¸ªå †è¿›è¡Œæ¸…ç†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;32-ç›¸å…³-vm-å‚æ•°&#34;&gt;3.2 ç›¸å…³ VM å‚æ•°&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;&lt;strong&gt;å«ä¹‰&lt;/strong&gt;&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;&lt;strong&gt;å‚æ•°&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å †åˆå§‹å¤§å°&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;-Xms&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å †æœ€å¤§å¤§å°&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;-Xmx æˆ– -XX:MaxHeapSize=size&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ–°ç”Ÿä»£å¤§å°&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;-Xmn æˆ– (-XX:NewSize=size + -XX:MaxNewSize=size )&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å¹¸å­˜åŒºæ¯”ä¾‹ï¼ˆåŠ¨æ€ï¼‰&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;-XX:InitialSurvivorRatio=ratio å’Œ -XX:+UseAdaptiveSizePolicy&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å¹¸å­˜åŒºæ¯”ä¾‹&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;-XX:SurvivorRatio=ratio&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ™‹å‡é˜ˆå€¼&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;-XX:MaxTenuringThreshold=threshold&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ™‹å‡è¯¦æƒ…&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;-XX:+PrintTenuringDistribution&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;GCè¯¦æƒ…&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;-XX:+PrintGCDetails -verbose:gc&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;FullGC å‰ MinorGC&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;-XX:+ScavengeBeforeFullGC&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol&gt;
&lt;li&gt;æ²¡æœ‰è¿è¡Œä»»ä½•ä»£ç æ—¶ï¼Œè™šæ‹Ÿæœºå‚æ•° &lt;code&gt;-Xms20M -Xmx20M -Xmn10M -XX:+UseSerialGC -XX:+PrintGCDetails -verbose:gc&lt;/code&gt; çš„å †å†…å­˜å ç”¨æƒ…å†µ&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;public class Demo2_1 {
    // -Xms20M -Xmx20M -Xmn10M -XX:+UseSerialGC -XX:+PrintGCDetails -verbose:gc
    // -Xms20Mï¼šåˆå§‹å †ç©ºé—´20Mï¼›
    // -Xmx20Mï¼šæœ€å¤§å †ç©ºé—´20Mï¼›
    // -Xmn10Mï¼šæ–°ç”Ÿä»£10Mï¼›
    // -XX:+UseSerialGCï¼šåƒåœ¾å›æ”¶å™¨ï¼Œå¹¸å­˜åŒºæ¯”ä¾‹ä¸ä¼šåŠ¨æ€è°ƒæ•´
    // -XX:+PrintGCDetails -verbose:gcï¼šæ‰“å° gc è¯¦æƒ…
    public static void main(String[] args) throws InterruptedException {


    }
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;25&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/VM%E5%8F%82%E6%95%B0.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;2.Eden åŒºåŸŸä¸è¶³æ—¶ï¼Œè§¦å‘ minor gc æ—¶çš„å †å†…å­˜å ç”¨&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;package cn.itcast.vm.t2;
import java.util.ArrayList;
public class Demo2_1 {
    private static final int _7MB = 7 * 1024 * 1024;

    // -Xms20M -Xmx20M -Xmn10M -XX:+UseSerialGC -XX:+PrintGCDetails -verbose:gc -XX:-ScavengeBeforeFullGC
    public static void main(String[] args) throws InterruptedException {
        ArrayList&amp;lt;byte[]&amp;gt; list = new ArrayList&amp;lt;&amp;gt;();
        list.add(new byte[_7MB]);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å› ä¸º Eden å…± 8Mï¼Œç±»åŠ è½½æ—¶åˆ›å»ºä¸€äº›å¯¹è±¡å ç”¨äº† 29% çš„ç©ºé—´ï¼Œå¤§æ¦‚å‰©ä½™ 6M ç©ºé—´ï¼Œåˆ›å»ºä¸€ä¸ª 7M çš„å¯¹è±¡ï¼ŒåŠ å…¥ Edenï¼ŒEden å†…å­˜ä¸è¶³ï¼Œä¼šè§¦å‘åƒåœ¾å›æ”¶ã€‚&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/VM%E5%8F%82%E6%95%B02.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;package cn.itcast.jvm.t2;

import java.util.ArrayList;

/**
 *  æ¼”ç¤ºå†…å­˜çš„åˆ†é…ç­–ç•¥
 */
public class Demo2_1 {
    private static final int _512KB = 512 * 1024;
    private static final int _1MB = 1024 * 1024;
    private static final int _6MB = 6 * 1024 * 1024;
    private static final int _7MB = 7 * 1024 * 1024;
    private static final int _8MB = 8 * 1024 * 1024;

    // -Xms20M -Xmx20M -Xmn10M -XX:+UseSerialGC -XX:+PrintGCDetails -verbose:gc -XX:-ScavengeBeforeFullGC
    public static void main(String[] args) throws InterruptedException {
        ArrayList&amp;lt;byte[]&amp;gt; list = new ArrayList&amp;lt;&amp;gt;();
        list.add(new byte[_7MB]);
        list.add(new byte[_512KB]);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;26&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/VM%E5%8F%82%E6%95%B03.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;æ–°ç”Ÿä»£åŒºåŸŸå†…å­˜ä¸è¶³åˆ›å»ºå¯¹è±¡ï¼Œæ”¾å…¥è€å¹´ä»£&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;package cn.itcast.jvm.t2;

import java.util.ArrayList;

/**
 *  æ¼”ç¤ºå†…å­˜çš„åˆ†é…ç­–ç•¥
 */
public class Demo2_1 {
    private static final int _512KB = 512 * 1024;
    private static final int _1MB = 1024 * 1024;
    private static final int _6MB = 6 * 1024 * 1024;
    private static final int _7MB = 7 * 1024 * 1024;
    private static final int _8MB = 8 * 1024 * 1024;

    // -Xms20M -Xmx20M -Xmn10M -XX:+UseSerialGC -XX:+PrintGCDetails -verbose:gc -XX:-ScavengeBeforeFullGC
    public static void main(String[] args) throws InterruptedException {
        ArrayList&amp;lt;byte[]&amp;gt; list = new ArrayList&amp;lt;&amp;gt;();
        list.add(new byte[_7MB]);
        list.add(new byte[_512KB]);
        list.add(new byte[_512KB]);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;27&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/VM%E5%8F%82%E6%95%B04.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;æ·»åŠ çš„å¯¹è±¡æ¯”æ–°ç”Ÿä»£æ€»å†…å­˜å¤§ï¼Œç›´æ¥æ”¾å…¥è€å¹´ä»£ä¸”ä¸è§¦å‘ GCã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;package cn.itcast.jvm.t2;
import java.util.ArrayList;
public class Demo2_1 {
    private static final int _8MB = 8 * 1024 * 1024;
    // -Xms20M -Xmx20M -Xmn10M -XX:+UseSerialGC -XX:+PrintGCDetails -verbose:gc -XX:-ScavengeBeforeFullGC
    public static void main(String[] args) throws InterruptedException {
        ArrayList&amp;lt;byte[]&amp;gt; list = new ArrayList&amp;lt;&amp;gt;();
        list.add(new byte[_8MB]);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;28&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/VM%E5%8F%82%E6%95%B05.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;å†…å­˜æº¢å‡º&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;package cn.itcast.jvm.t2;

import java.util.ArrayList;

/**
 *  æ¼”ç¤ºå†…å­˜çš„åˆ†é…ç­–ç•¥
 */
public class Demo2_1 {
    private static final int _512KB = 512 * 1024;
    private static final int _1MB = 1024 * 1024;
    private static final int _6MB = 6 * 1024 * 1024;
    private static final int _7MB = 7 * 1024 * 1024;
    private static final int _8MB = 8 * 1024 * 1024;

    // -Xms20M -Xmx20M -Xmn10M -XX:+UseSerialGC -XX:+PrintGCDetails -verbose:gc -XX:-ScavengeBeforeFullGC
    public static void main(String[] args) throws InterruptedException {
        ArrayList&amp;lt;byte[]&amp;gt; list = new ArrayList&amp;lt;&amp;gt;();
        list.add(new byte[_8MB]);
        list.add(new byte[_8MB]);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;29&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/VM%E5%8F%82%E6%95%B06.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ol start=&#34;6&#34;&gt;
&lt;li&gt;å½“å†…å­˜æº¢å‡ºå‘ç”Ÿåœ¨å­çº¿ç¨‹ä¸­ï¼Œæ˜¯å¦ä¼šå¯¼è‡´ java è¿›ç¨‹ç»“æŸï¼Ÿ&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;package cn.itcast.jvm.t2;

import java.util.ArrayList;

/**
 *  æ¼”ç¤ºå†…å­˜çš„åˆ†é…ç­–ç•¥
 */
public class Demo2_1 {
    private static final int _512KB = 512 * 1024;
    private static final int _1MB = 1024 * 1024;
    private static final int _6MB = 6 * 1024 * 1024;
    private static final int _7MB = 7 * 1024 * 1024;
    private static final int _8MB = 8 * 1024 * 1024;

    // -Xms20M -Xmx20M -Xmn10M -XX:+UseSerialGC -XX:+PrintGCDetails 
    public static void main(String[] args) throws InterruptedException {
        new Thread(() -&amp;gt; {
            ArrayList&amp;lt;byte[]&amp;gt; list = new ArrayList&amp;lt;&amp;gt;();
            list.add(new byte[_8MB]);
            list.add(new byte[_8MB]);

        }).start();

        System.out.println(&amp;quot;sleep....&amp;quot;);
        Thread.sleep(1000L);  
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;30&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/VM%E5%8F%82%E6%95%B07.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h1 id=&#34;å››-åƒåœ¾å›æ”¶å™¨&#34;&gt;å››ã€åƒåœ¾å›æ”¶å™¨&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;ä¸²è¡Œ&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å•çº¿ç¨‹&lt;/li&gt;
&lt;li&gt;å †å†…å­˜è¾ƒå°ï¼Œé€‚åˆä¸ªäººç”µè„‘&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;ååé‡ä¼˜å…ˆ&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å¤šçº¿ç¨‹&lt;/li&gt;
&lt;li&gt;å †å†…å­˜è¾ƒå¤§ï¼Œå¤šæ ¸ cpu&lt;/li&gt;
&lt;li&gt;è®©å•ä½æ—¶é—´å†…ï¼ŒSTW çš„æ—¶é—´æœ€çŸ­ã€‚ä¸¤æ¬¡åƒåœ¾å›æ”¶ï¼š0.2+0.2 = 0.4ï¼Œ&lt;strong&gt;åƒåœ¾å›æ”¶æ—¶é—´å æ¯”æœ€ä½ï¼Œè¿™æ ·å°±ç§°ååé‡é«˜&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;å“åº”æ—¶é—´ä¼˜å…ˆ&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å¤šçº¿ç¨‹&lt;/li&gt;
&lt;li&gt;å †å†…å­˜è¾ƒå¤§ï¼Œå¤šæ ¸ cpu&lt;/li&gt;
&lt;li&gt;å°½å¯èƒ½è®©&lt;strong&gt;å•æ¬¡ STW çš„æ—¶é—´æœ€çŸ­&lt;/strong&gt;ã€‚äº”æ¬¡åƒåœ¾å›æ”¶ï¼š0.1+0.1+0.1+0.1+0.1 = 0.5&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;41-ä¸²è¡Œ&#34;&gt;4.1 ä¸²è¡Œ&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;-XX:+UseSerialGC = Serial + SerialOld
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Serialï¼šå·¥ä½œåœ¨&lt;strong&gt;æ–°ç”Ÿä»£&lt;/strong&gt;ã€‚&lt;strong&gt;å¤åˆ¶&lt;/strong&gt;ç®—æ³•&lt;br&gt;
SerialOldï¼šå·¥ä½œåœ¨&lt;strong&gt;è€å¹´ä»£&lt;/strong&gt;ã€‚&lt;strong&gt;æ ‡è®°æ•´ç†&lt;/strong&gt;ç®—æ³•&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;31&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E4%B8%B2%E8%A1%8C%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E5%99%A8.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;å››ä¸ª CPU åœ¨è¿è¡Œï¼ŒæŸæ—¶åˆ»å †å†…å­˜ä¸è¶³ï¼Œè§¦å‘åƒåœ¾å›æ”¶ã€‚è§¦å‘åƒåœ¾å›æ”¶æ—¶ï¼Œéœ€è¦è®©è¿™äº›çº¿ç¨‹åˆ°è¾¾ä¸€ä¸ª&lt;strong&gt;å®‰å…¨ç‚¹&lt;/strong&gt;å†åœä¸‹ï¼Œå› ä¸ºåœ¨åƒåœ¾å›æ”¶çš„è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½å¯¹è±¡çš„åœ°å€å‘ç”Ÿæ”¹å˜ï¼Œä¸ºäº†ä¿è¯å®‰å…¨åœ°ä½¿ç”¨è¿™äº›å¯¹è±¡åœ°å€ï¼Œéœ€è¦æ‰€æœ‰æ­£åœ¨å·¥ä½œçš„ç”¨æˆ·çº¿ç¨‹åˆ°è¾¾è¿™ä¸ªå®‰å…¨ç‚¹åœ¨åœä¸‹ã€‚å› ä¸º Serialã€SerialOld éƒ½æ˜¯&lt;strong&gt;å•çº¿ç¨‹&lt;/strong&gt;çš„åƒåœ¾å›æ”¶å™¨ï¼Œå› æ­¤åœ¨ä¸€ä¸ªåƒåœ¾å›æ”¶çº¿ç¨‹è¿è¡Œæ—¶ï¼Œå…¶ä»–çš„ç”¨æˆ·çº¿ç¨‹éƒ½è¦&lt;strong&gt;é˜»å¡&lt;/strong&gt;ï¼Œç­‰åˆ°åƒåœ¾å›æ”¶çº¿ç¨‹ç»“æŸåï¼Œå…¶ä»–çš„ç”¨æˆ·çº¿ç¨‹å†æ¢å¤è¿è¡Œã€‚&lt;/p&gt;
&lt;h2 id=&#34;42-ååé‡ä¼˜å…ˆ&#34;&gt;4.2 ååé‡ä¼˜å…ˆ&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;ååé‡&lt;/strong&gt;ï¼šCPU ç”¨äºè¿è¡Œç”¨æˆ·ç¨‹åºçš„æ—¶é—´ä¸æ€»æ—¶é—´çš„æ¯”å€¼ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;-XX:+UseParallelGC ~ -XX:+UseParallelOldGC
-XX:+UseAdaptiveSizePolicy
-XX:GCTimeRatio=ratio 
-XX:MaxGCPauseMillis=ms 
-XX:ParallelGCThreads=nÂ 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;-XX:+UseParallelGC ~ -XX:+UseParallelOldGC&lt;/code&gt;ï¼šJDK 1.8 é»˜è®¤ä½¿ç”¨ ParallelGC &lt;strong&gt;å¹¶è¡Œ&lt;/strong&gt;çš„åƒåœ¾å›æ”¶å™¨ã€‚&lt;br&gt;
UseParallelGC å¹¶è¡Œçš„æ–°ç”Ÿä»£åƒåœ¾å›æ”¶å™¨ï¼Œé‡‡ç”¨&lt;strong&gt;å¤åˆ¶&lt;/strong&gt;ç®—æ³•ï¼›UseParallelOldGC å¹¶è¡Œçš„è€å¹´ä»£åƒåœ¾å›æ”¶å™¨ï¼Œé‡‡ç”¨&lt;strong&gt;æ ‡è®°æ•´ç†&lt;/strong&gt;ç®—æ³•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;-XX:+UseAdaptiveSizePolicy&lt;/code&gt;ï¼šè‡ªé€‚åº”å¤§å°è°ƒæ•´ï¼ˆæ–°ç”Ÿä»£ï¼šEden å’Œ Survivalï¼‰ç­–ç•¥&lt;/p&gt;
&lt;p&gt;&lt;code&gt;-XX:GCTimeRatio=ratio&lt;/code&gt;ï¼šæ ¹æ®è®¾ç½®ç›®æ ‡è°ƒæ•´å †çš„å¤§å°ä»¥è¾¾åˆ°æœŸæœ›çš„ç›®æ ‡ã€‚ååé‡ï¼šåƒåœ¾å›æ”¶æ—¶é—´å’Œæ€»æ—¶é—´å æ¯”ã€‚1/(1+ratio)ã€‚ä¸€èˆ¬å †è°ƒå¤§ï¼Œå‡å°‘åƒåœ¾å›æ”¶æ¬¡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;-XX:MaxGCPauseMillis=ms&lt;/code&gt;ï¼šæœ€å¤§æš‚åœæ¯«ç§’æ•°ï¼ˆæ¯ä¸€æ¬¡åƒåœ¾å›æ”¶è€—æ—¶ï¼‰&lt;/p&gt;
&lt;p&gt;&lt;code&gt;-XX:ParallelGCThreads=n&lt;/code&gt;Â ï¼šæ§åˆ¶ ParallelGC è¿è¡Œæ—¶çš„&lt;strong&gt;çº¿ç¨‹æ•°&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;32&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%90%9E%E5%90%90%E9%87%8F%E4%BC%98%E5%85%88%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E5%99%A8.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;å››ä¸ª CPU åœ¨è¿è¡Œï¼ŒæŸä¸€æ—¶åˆ»å†…å­˜ä¸è¶³è§¦å‘åƒåœ¾å›æ”¶ï¼Œç”¨æˆ·çº¿ç¨‹å°±ä¼šåˆ°è¾¾å®‰å…¨ç‚¹ç„¶ååœä¸‹æ¥ï¼Œåƒåœ¾å›æ”¶å™¨&lt;strong&gt;å¼€å¯å¤šä¸ªçº¿ç¨‹è¿›è¡Œåƒåœ¾å›æ”¶&lt;/strong&gt;ã€‚åƒåœ¾å›æ”¶çº¿ç¨‹ä¸ªæ•°é»˜è®¤å’Œ CPU æ ¸æ•°ç›¸å…³ã€‚å›æ”¶ç»“æŸåå†æ¢å¤å…¶ä»–çš„çº¿ç¨‹è¿è¡Œã€‚åœ¨åƒåœ¾å›æ”¶æ—¶ï¼Œå››æ ¸ CPU éƒ½å»è¿›è¡Œåƒåœ¾å›æ”¶äº†ï¼Œ&lt;strong&gt;CPU å ç”¨ç‡&lt;/strong&gt;ä¼šä¸€ä¸‹è¾¾åˆ° 100%ã€‚&lt;/p&gt;
&lt;h2 id=&#34;43-å“åº”æ—¶é—´ä¼˜å…ˆ&#34;&gt;4.3 å“åº”æ—¶é—´ä¼˜å…ˆ&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;-XX:+UseConcMarkSweepGC ~ -XX:+UseParNewGC ~ SerialOld 
-XX:ParallelGCThreads=n ~ -XX:ConcGCThreads=threads 
-XX:CMSInitiatingOccupancyFraction=percent 
-XX:+CMSScavengeBeforeRemark
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;-XX:+UseConcMarkSweepGC&lt;/code&gt;Â ï¼š&lt;strong&gt;å¹¶å‘æ ‡è®°æ¸…é™¤&lt;/strong&gt;ã€‚åƒåœ¾å›æ”¶å™¨å·¥ä½œçš„åŒæ—¶ï¼Œå…¶ä»–ç”¨æˆ·çº¿ç¨‹ä¹Ÿèƒ½åŒæ—¶è¿›è¡Œã€‚åƒåœ¾å›æ”¶çº¿ç¨‹å’Œç”¨æˆ·çº¿ç¨‹å¹¶å‘æ‰§è¡Œï¼Œéƒ½è¦å»æŠ¢å  CPUã€‚&lt;br&gt;
&lt;code&gt;-XX:+UseParNewGC&lt;/code&gt;ï¼šå·¥ä½œåœ¨æ–°ç”Ÿä»£ï¼Œå¤åˆ¶ç®—æ³•ã€‚ &lt;strong&gt;SerialOld&lt;/strong&gt;ï¼šè€å¹´ä»£åƒåœ¾å›æ”¶å™¨ç”±å¹¶å‘é€€åŒ–ä¸ºå•çº¿ç¨‹ ï¼ˆåŸºäºæ ‡è®°æ•´ç†çš„è€å¹´åƒåœ¾å›æ”¶å™¨ï¼‰ã€‚&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%93%8D%E5%BA%94%E6%97%B6%E9%97%B4%E4%BC%98%E5%85%88%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E5%99%A8.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¤šä¸ª CPU å¹¶è¡Œæ‰§è¡Œï¼Œè€å¹´ä»£å†…å­˜ä¸è¶³ï¼Œæ‰€æœ‰è¿›ç¨‹åˆ°è¾¾å®‰å…¨ç‚¹ï¼Œæ‰§è¡Œ&lt;strong&gt;åˆå§‹æ ‡è®°&lt;/strong&gt;ï¼Œç”¨æˆ·çº¿ç¨‹é˜»å¡ï¼ŒSTWï¼›åˆå§‹æ ‡è®°ç»“æŸåï¼Œç”¨æˆ·çº¿ç¨‹å¼€å§‹è¿è¡Œï¼Œåœæ­¢ STWï¼Œä¸æ­¤åŒæ—¶åƒåœ¾å›æ”¶çº¿ç¨‹&lt;strong&gt;å¹¶å‘æ ‡è®°&lt;/strong&gt;ï¼ŒæŠŠå‰©ä½™çš„åƒåœ¾æ‰¾å‡ºæ¥ï¼›å¹¶å‘æ ‡è®°ç»“æŸåï¼Œè¿›è¡Œ&lt;strong&gt;é‡æ–°æ ‡è®°&lt;/strong&gt;ï¼Œè¿™ä¸ªè¿‡ç¨‹ STWï¼Œå› ä¸ºå¹¶å‘æ ‡è®°çš„è¿‡ç¨‹ç”¨æˆ·çº¿ç¨‹å¯èƒ½å¯¹åƒåœ¾å›æ”¶åšäº†å¹²æ‰°ï¼Œæ‰€ä»¥å¹¶å‘æ ‡è®°ç»“æŸåè¿˜è¦å†åšä¸€æ¬¡é‡æ–°æ ‡è®°ï¼›é‡æ–°æ ‡è®°ç»“æŸåï¼Œç”¨æˆ·çº¿ç¨‹ç»§ç»­è¿è¡Œï¼Œåƒåœ¾å›æ”¶çº¿ç¨‹&lt;strong&gt;å¹¶å‘æ¸…ç†&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;44-g1&#34;&gt;4.4 G1&lt;/h2&gt;
&lt;p&gt;å®šä¹‰ï¼šGarbage First&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;2004 è®ºæ–‡å‘å¸ƒ&lt;/li&gt;
&lt;li&gt;2009 JDK 6u14 ä½“éªŒ&lt;/li&gt;
&lt;li&gt;2012 JDK 7u4 å®˜æ–¹æ”¯æŒ&lt;/li&gt;
&lt;li&gt;2017 JDK 9 é»˜è®¤ã€‚G1 å–ä»£äº† CMS&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é€‚ç”¨åœºæ™¯&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åŒæ—¶æ³¨é‡&lt;strong&gt;ååé‡&lt;/strong&gt;ï¼ˆThroughputï¼‰å’Œ&lt;strong&gt;ä½å»¶è¿Ÿ&lt;/strong&gt;ï¼ˆLow latencyï¼‰ï¼Œé»˜è®¤çš„æš‚åœç›®æ ‡æ˜¯ 200 ms&lt;/li&gt;
&lt;li&gt;å¹¶å‘çš„åƒåœ¾å›æ”¶å™¨ï¼Œå’Œ CMS ä¸€æ ·è¿½æ±‚ä½å»¶è¿Ÿï¼Œå¯ä»¥åœ¨ç”¨æˆ·çº¿ç¨‹å·¥ä½œçš„åŒæ—¶åƒåœ¾å›æ”¶çº¿ç¨‹ä¹Ÿå¹¶å‘æ‰§è¡Œã€‚å¦å¤–è¿˜å€Ÿé‰´äº† Parallelï¼šæ³¨é‡ååé‡åƒåœ¾å›æ”¶å™¨çš„æ€æƒ³ï¼Œå¯ä»¥è¿›è¡Œè°ƒæ•´ï¼Œè®¾ç½®é»˜è®¤æš‚åœç›®æ ‡ï¼ˆ&lt;code&gt;-XX:MaxGCPauseMillis&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¶…å¤§å †å†…å­˜&lt;/strong&gt;ï¼Œä¼š&lt;strong&gt;å°†å †åˆ’åˆ†ä¸ºå¤šä¸ªå¤§å°ç›¸ç­‰çš„ Region&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;éšç€å †å†…å­˜å®¹é‡çš„å¢å¤§ï¼ŒG1 ä¸ CMS ç›¸æ¯”ä¼˜åŠ¿æ›´åŠ æ˜æ˜¾ã€‚&lt;/p&gt;
&lt;p&gt;å°†å †åˆ’åˆ†ä¸ºå¤šä¸ªå¤§å°ç›¸ç­‰çš„ Regionï¼šæ¯ä¸ªåŒºåŸŸéƒ½å¯ä»¥ç‹¬ç«‹åœ°ä½œä¸º Edenã€surviveã€è€å¹´ä»£ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;-XX:G1HeapRegionSize&lt;/code&gt;ï¼šè®¾ç½®åŒºåŸŸçš„å¤§å°ï¼Œå¿…é¡»æ˜¯2çš„å¹‚ã€‚å¦‚æœå †å†…å­˜è¿‡å¤§ï¼Œå›æ”¶é€Ÿåº¦ä¼šå˜æ…¢ï¼Œå› ä¸ºä¼šæ¶‰åŠå¯¹è±¡çš„å¤åˆ¶æ ‡è®°ï¼Œè€Œåˆ†æˆå°çš„åŒºåŸŸè¿›è¡Œç®¡ç†ï¼Œå¯ä»¥åŒ–æ•´ä¸ºé›¶ï¼Œè¿›è¡Œä¸€äº›ä¼˜åŒ–åŠ å¿«æ ‡è®°æ‹·è´çš„é€Ÿåº¦ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ•´ä½“ä¸Šæ˜¯ &lt;strong&gt;æ ‡è®°+æ•´ç†&lt;/strong&gt; ç®—æ³•ï¼ˆé¿å…æ ‡è®°æ¸…é™¤ç®—æ³•äº§ç”Ÿçš„å†…ç¢ç‰‡ï¼‰ï¼Œä¸¤ä¸ªåŒºåŸŸä¹‹é—´æ˜¯å¤åˆ¶ç®—æ³•&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç›¸å…³ JVM å‚æ•°&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;-XX:+UseG1GC 
-XX:G1HeapRegionSize=size 
-XX:MaxGCPauseMillis=time
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;33&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/G1_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;1-g1-åƒåœ¾å›æ”¶é˜¶æ®µ&#34;&gt;1) G1 åƒåœ¾å›æ”¶é˜¶æ®µ&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;34&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/G1%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E9%98%B6%E6%AE%B5.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;åˆšå¼€å§‹æ–°ç”Ÿä»£åƒåœ¾æ”¶é›†ï¼Œå¦‚æœæŸæ—¶åˆ»è€å¹´ä»£å†…å­˜è¶…è¿‡é˜ˆå€¼äº†ï¼Œåœ¨æ–°ç”Ÿä»£åƒåœ¾æ”¶é›†çš„åŒæ—¶è¿›è¡Œå¹¶å‘æ ‡è®°ï¼Œè¿™ä¸ªé˜¶æ®µç»“æŸåä¼šè¿›è¡Œæ··åˆæ”¶é›†ï¼šä¼šå¯¹æ–°ç”Ÿä»£ã€å¹¸å­˜åŒºã€è€å¹´ä»£éƒ½è¿›è¡Œæ”¶é›†ã€‚æ··åˆæ”¶é›†ç»“æŸï¼ŒEden å†…å­˜é‡Šæ”¾æ‰ï¼Œä¼šå†è¿›å…¥æ–°ç”Ÿä»£åƒåœ¾æ”¶é›†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;2-young-collection&#34;&gt;2) Young Collection&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ä¼š STW&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;35&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/G1%E5%88%86%E5%8C%BA.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;G1 åƒåœ¾å›æ”¶å™¨æŠŠ&lt;strong&gt;å †å†…å­˜åˆ’åˆ†æˆå¤§å°ç›¸ç­‰çš„ä¸€ä¸ªä¸ªåŒºåŸŸ&lt;/strong&gt;ï¼Œæ¯ä¸ªåŒºåŸŸéƒ½å¯ç‹¬ç«‹ä½œä¸ºä¼Šç”¸å›­ã€å¹¸å­˜åŒºã€è€å¹´ä»£ã€‚åˆšå¼€å§‹ç™½è‰²çš„åŒºåŸŸè¡¨ç¤ºæ˜¯ç©ºé—²çš„åŒºåŸŸï¼Œç±»åŠ è½½æ—¶æ–°åˆ›å»ºçš„å¯¹è±¡åˆšå¼€å§‹ä¼šåˆ†é…åˆ°ä¼Šç”¸å›­åŒºï¼Œç»¿è‰²çš„ E å°±ä»£è¡¨ Eden åŒºï¼Œå½“ Eden åŒºåŸŸé€æ¸è¢«å æ»¡ï¼Œå°±ä¼šè§¦å‘æ–°ç”Ÿä»£çš„åƒåœ¾å›æ”¶ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;36&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/G1%E6%96%B0%E7%94%9F%E4%BB%A3%E5%A4%8D%E5%88%B6%E7%AE%97%E6%B3%95.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;æ–°ç”Ÿä»£åƒåœ¾å›æ”¶ä¼šæŠŠéåƒåœ¾å¯¹è±¡ä»¥å¤åˆ¶ç®—æ³•æ”¾å…¥å¹¸å­˜åŒºã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;37&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/G1%E8%80%81%E5%B9%B4%E4%BB%A3.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;å½“å¹¸å­˜åŒºå¯¹è±¡æ”¾ä¸ä¸‹ï¼Œæˆ–å¹¸å­˜åŒºå¯¹è±¡å¯¿å‘½è¾¾åˆ°ä¸€å®šå€¼ï¼Œä¼šè§¦å‘åƒåœ¾å›æ”¶ï¼Œå¹¸å­˜åŒºä¸€éƒ¨åˆ†å¯¹è±¡ä¼šæ™‹å‡åˆ°è€å¹´ä»£ï¼Œè€Œå¯¿å‘½æœªè¾¾åˆ°é˜ˆå€¼çš„ä¼šæ‹·è´åˆ°å¦ä¸€ä¸ªå¹¸å­˜åŒºï¼Œæ–°ç”Ÿä»£çš„éåƒåœ¾å¯¹è±¡ä¹Ÿä¼šå¤åˆ¶åˆ°è¿™ä¸ªå¹¸å­˜åŒºã€‚&lt;/p&gt;
&lt;h3 id=&#34;3-young-collection-cm&#34;&gt;3) Young Collection + CM&lt;/h3&gt;
&lt;p&gt;CMï¼šConcurrent markï¼šå¹¶å‘æ ‡è®°&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åˆå§‹æ ‡è®°&lt;/strong&gt;ï¼šæ‰¾åˆ°é‚£äº›æ ¹å¯¹è±¡ï¼Œæ ‡è®°æ ¹å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¹¶å‘æ ‡è®°&lt;/strong&gt;ï¼šä»æ ¹å¯¹è±¡å‡ºå‘ï¼Œé¡ºç€å¼•ç”¨é“¾æ‰¾åˆ°å…¶ä»–éåƒåœ¾å¯¹è±¡ï¼Œæ ‡è®°é‚£äº›å…¶ä»–éåƒåœ¾å¯¹è±¡ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨ Young GC æ—¶ä¼šè¿›è¡Œ GC Root çš„&lt;strong&gt;åˆå§‹æ ‡è®°&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;è€å¹´ä»£å ç”¨å †ç©ºé—´æ¯”ä¾‹è¾¾åˆ°é˜ˆå€¼æ—¶ï¼Œè¿›è¡Œ&lt;strong&gt;å¹¶å‘æ ‡è®°&lt;/strong&gt;ï¼ˆä¸ä¼š STWï¼‰ï¼Œç”±ä¸‹é¢çš„ JVM å‚æ•°å†³å®š&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;-XX:InitialtingHeapOccupancyPercent=percentï¼ˆé»˜è®¤45%ï¼‰
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è€å¹´ä»£å ç”¨å †ç©ºé—´å†…å­˜è¾¾åˆ° 45% æ—¶ï¼Œä¼šè¿›è¡Œå¹¶å‘æ ‡è®°ã€‚&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/G1%E8%80%81%E5%B9%B4%E4%BB%A3%E8%BF%87%E5%A4%9A%E5%B9%B6%E5%8F%91%E6%A0%87%E8%AE%B0.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;Eï¼šEden&lt;/p&gt;
&lt;p&gt;Sï¼šSurvive&lt;/p&gt;
&lt;p&gt;Oï¼šOld&lt;/p&gt;
&lt;h3 id=&#34;4-mixed-collection&#34;&gt;4) Mixed Collection&lt;/h3&gt;
&lt;p&gt;ä¼šå¯¹ Eã€Sã€O è¿›è¡Œ&lt;strong&gt;å…¨é¢åƒåœ¾å›æ”¶&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æœ€ç»ˆæ ‡è®°ï¼ˆRemarkï¼‰ä¼š STW&lt;/li&gt;
&lt;li&gt;æ‹·è´å­˜æ´»ï¼ˆEvacuationï¼‰ä¼š STW&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;-XX:MaxGCPauseMillis=ms&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;38&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/G1%E5%85%A8%E9%9D%A2%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;Eden åŒºåŸŸçš„éåƒåœ¾å¯¹è±¡è¢«å¤åˆ¶åˆ° Survive åŒºåŸŸï¼ŒSurvive åŒºåŸŸå¯¿å‘½æœªè¾¾åˆ°é˜ˆå€¼çš„éåƒåœ¾å¯¹è±¡è¢«å¤åˆ¶åˆ°å¦ä¸€ä¸ª Survive åŒºåŸŸï¼Œå¯¿å‘½è¾¾åˆ°é˜ˆå€¼çš„æ™‹å‡åˆ°è€å¹´ä»£åŒºåŸŸã€‚ä¸€éƒ¨åˆ†è€å¹´ä»£åŒºåŸŸçš„å¹¸å­˜å¯¹è±¡é€šè¿‡å¤åˆ¶ç®—æ³•å¤åˆ¶åˆ°æ–°çš„çš„è€å¹´ä»£åŒºåŸŸï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰æŠŠæ‰€æœ‰è€å¹´ä»£éƒ½é€šè¿‡ç®­å¤´æŒ‡å‘æ–°çš„è€å¹´ä»£å‘¢ï¼Ÿå› ä¸º G1 ä¼šæ ¹æ®æœ€å¤§æš‚åœæ—¶é—´æœ‰é€‰æ‹©åœ°è¿›è¡Œå›æ”¶ï¼Œæœ‰æ—¶å€™å †å†…å­˜ç©ºé—´å¤ªå¤§äº†ï¼Œè€å¹´ä»£çš„åƒåœ¾å›æ”¶å¯èƒ½æ—¶é—´æ¯”è¾ƒé•¿ï¼ˆå¤åˆ¶ç®—æ³•å¤§é‡å¯¹è±¡çš„å¤åˆ¶ï¼‰ï¼Œå°±è¾¾ä¸åˆ°&lt;strong&gt;æœ€å¤§æš‚åœæ—¶é—´&lt;/strong&gt;çš„ç›®æ ‡äº†ï¼Œä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®æ ‡ï¼ŒG1 ä¼šä»è€å¹´ä»£ä¸­æŒ‘å‡º&lt;strong&gt;å›æ”¶ä»·å€¼æœ€é«˜&lt;/strong&gt;çš„åŒºåŸŸï¼ˆåƒåœ¾å›æ”¶åèƒ½é‡Šæ”¾ç©ºé—´å¤šçš„åŒºåŸŸï¼‰ï¼Œåªä»è€å¹´ä»£ä¸­æŒ‘é€‰ä¸€éƒ¨åˆ†åŒºåŸŸå¤åˆ¶ï¼Œå¤åˆ¶çš„åŒºåŸŸå°‘äº†ï¼Œå°±å¯ä»¥è¾¾åˆ°æš‚åœæ—¶é—´çš„ç›®æ ‡äº†ã€‚å¦‚æœè€å¹´ä»£æ²¡æœ‰é‚£ä¹ˆå¤šï¼Œå¯ä»¥è¾¾åˆ°æœ€å¤§æš‚åœæ—¶é—´çš„è¯ï¼Œ å°±ä¼šæŠŠæ‰€æœ‰åŒºåŸŸéƒ½è¿›è¡Œå¤åˆ¶ã€‚&lt;/p&gt;
&lt;h3 id=&#34;5-full-gc&#34;&gt;5) Full GC&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;SerialGCï¼šä¸²è¡Œ
&lt;ul&gt;
&lt;li&gt;æ–°ç”Ÿä»£å†…å­˜ä¸è¶³å‘ç”Ÿçš„åƒåœ¾æ”¶é›† - minor gc&lt;/li&gt;
&lt;li&gt;è€å¹´ä»£å†…å­˜ä¸è¶³å‘ç”Ÿçš„åƒåœ¾æ”¶é›† - full gc&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ParallelGCï¼šå¹¶è¡Œ
&lt;ul&gt;
&lt;li&gt;æ–°ç”Ÿä»£å†…å­˜ä¸è¶³å‘ç”Ÿçš„åƒåœ¾æ”¶é›† - minor gc&lt;/li&gt;
&lt;li&gt;è€å¹´ä»£å†…å­˜ä¸è¶³å‘ç”Ÿçš„åƒåœ¾æ”¶é›† - full gc&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;CMS
&lt;ul&gt;
&lt;li&gt;æ–°ç”Ÿä»£å†…å­˜ä¸è¶³å‘ç”Ÿçš„åƒåœ¾æ”¶é›† - minor gc&lt;/li&gt;
&lt;li&gt;è€å¹´ä»£å†…å­˜ä¸è¶³
&lt;ul&gt;
&lt;li&gt;å¹¶å‘æ”¶é›†å¤±è´¥å Full GC&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;G1
&lt;ul&gt;
&lt;li&gt;æ–°ç”Ÿä»£å†…å­˜ä¸è¶³å‘ç”Ÿçš„åƒåœ¾æ”¶é›† - minor gc&lt;/li&gt;
&lt;li&gt;è€å¹´ä»£å†…å­˜ä¸è¶³
&lt;ul&gt;
&lt;li&gt;æœ‰ä¸€ä¸ªé˜ˆå€¼ï¼Œå½“è€å¹´ä»£å†…å­˜è¾¾åˆ°é˜ˆå€¼ï¼Œå°±ä¼šè§¦å‘å¹¶å‘æ ‡è®°ã€æ··åˆæ”¶é›†é˜¶æ®µã€‚å¦‚æœåƒåœ¾å›æ”¶çš„é€Ÿåº¦é«˜äºæ–°çš„ç”¨æˆ·çº¿ç¨‹äº§ç”Ÿåƒåœ¾çš„é€Ÿåº¦ï¼Œå°±å¤„äºå¹¶å‘åƒåœ¾æ”¶é›†é˜¶æ®µï¼Œè¿™é˜¶æ®µè¿˜ä¸ç®— Full GCã€‚&lt;/li&gt;
&lt;li&gt;å½“åƒåœ¾å›æ”¶çš„é€Ÿåº¦è·Ÿä¸ä¸Šåƒåœ¾äº§ç”Ÿçš„é€Ÿåº¦ï¼Œå¹¶å‘æ”¶é›†å¤±è´¥ï¼Œå°±ä¼šè§¦å‘ä¸²è¡Œæ”¶é›†ï¼Œè¿™é˜¶æ®µå«åš Full GCã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;6-young-collection-è·¨ä»£å¼•ç”¨&#34;&gt;6) Young Collection è·¨ä»£å¼•ç”¨&lt;/h3&gt;
&lt;p&gt;æ–°ç”Ÿä»£å›æ”¶çš„è·¨ä»£å¼•ç”¨ï¼ˆè€å¹´ä»£å¼•ç”¨æ–°ç”Ÿä»£ï¼‰é—®é¢˜&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;39&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Card.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;æ–°ç”Ÿä»£åƒåœ¾å›æ”¶ï¼šæ‰¾åˆ°æ ¹å¯¹è±¡ï¼Œæ²¿ç€å¼•ç”¨é“¾æ‰¾åˆ°å­˜æ´»å¯¹è±¡ï¼Œå­˜æ´»å¯¹è±¡è¿›è¡Œå¤åˆ¶åˆ°å¹¸å­˜åŒºã€‚è¦æ‰¾æ–°ç”Ÿä»£å¯¹è±¡çš„æ ¹å¯¹è±¡ï¼Œ&lt;strong&gt;æ ¹å¯¹è±¡æœ‰ä¸€éƒ¨åˆ†æ¥è‡ªäºè€å¹´ä»£&lt;/strong&gt;ï¼Œè€å¹´ä»£çš„å­˜æ´»å¯¹è±¡éå¸¸å¤šï¼Œå¦‚æœéå†è€å¹´ä»£æ‰¾æ ¹å¯¹è±¡æ•ˆç‡ä½ï¼Œå› æ­¤æŠŠ&lt;strong&gt;è€å¹´ä»£åŒºåŸŸå†è¿›è¡Œç»†åˆ†&lt;/strong&gt;ï¼Œåˆ†æˆä¸€ä¸ªä¸ª Cardï¼Œæ¯ä¸ª Card æ˜¯512KBï¼Œå¦‚æœè€å¹´ä»£å…¶ä¸­æœ‰ä¸€ä¸ª &lt;strong&gt;Card ä¸­çš„å¯¹è±¡å¼•ç”¨äº†æ–°ç”Ÿä»£çš„æŸä¸€ä¸ªå¯¹è±¡&lt;/strong&gt;ï¼Œå°±æŠŠè¿™ä¸ª &lt;strong&gt;Card æ ‡è®°ä¸ºè„&lt;/strong&gt;ï¼Œè¿™æ ·ä»¥åï¼Œåš GC Root éå†çš„æ—¶å€™å°±ä¸ç”¨å»æ‰¾æ•´ä¸ªè€å¹´ä»£äº†ï¼Œåªéœ€è¦å…³æ³¨é‚£äº›è„ Card å³å¯ï¼Œå‡å°‘æœç´¢èŒƒå›´ï¼Œ&lt;strong&gt;æé«˜æ‰«ææ ¹å¯¹è±¡çš„æ•ˆç‡&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¡è¡¨ä¸ Remembered Set&lt;/li&gt;
&lt;li&gt;åœ¨å¼•ç”¨å˜æ›´æ—¶é€šè¿‡ post-write barrier + dirty card queue&lt;/li&gt;
&lt;li&gt;concurrent refinement threads æ›´æ–° Remembered Set&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;40&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Card2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ç²‰è‰²çš„ Card éƒ½æ˜¯&lt;strong&gt;è„å¡åŒº&lt;/strong&gt;ï¼ŒCard å†…æœ‰å¯¹è±¡æŒ‡å‘æ–°ç”Ÿä»£åŒºåŸŸçš„å¯¹è±¡ï¼Œæ–°ç”Ÿä»£ä¼šè®°å½• &lt;strong&gt;Remembered Setï¼šä»å¤–éƒ¨å¯¹æˆ‘çš„å¼•ç”¨&lt;/strong&gt;ï¼Œå°†æ¥å¯¹æ–°ç”Ÿä»£ Eden è¿›è¡Œåƒåœ¾å›æ”¶æ—¶ï¼Œå°±å¯ä»¥å…ˆé€šè¿‡ Remembered Set çŸ¥é“å®ƒå¯¹åº”çš„å“ªäº›è„ Cardï¼Œç„¶ååœ¨åˆ°è¿™äº›è„å¡åŒºéå†å¯¹è±¡æ‰¾åˆ° GC Rootã€‚é€šè¿‡ &lt;strong&gt;post-write barrier&lt;/strong&gt;ï¼šå†™å±éšœåœ¨æ¯æ¬¡&lt;strong&gt;å¯¹è±¡çš„å¼•ç”¨å‘ç”Ÿå˜æ›´æ—¶ï¼Œå»æ›´æ–°è„ Card&lt;/strong&gt;ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯&lt;strong&gt;å¼‚æ­¥&lt;/strong&gt;æ“ä½œï¼Œä¸ä¼šç«‹åˆ»å®Œæˆè„å¡çš„æ›´æ–°ï¼Œä¼šæŠŠæ›´æ–°æŒ‡ä»¤æ”¾åœ¨ &lt;strong&gt;dirty card queue è„å¡é˜Ÿåˆ—&lt;/strong&gt;ä¸­ï¼Œå°†æ¥ç”±ä¸€ä¸ªçº¿ç¨‹å®Œæˆè„å¡æ›´æ–°çš„æ“ä½œã€‚&lt;/p&gt;
&lt;h3 id=&#34;7-remark-é‡æ ‡è®°é˜¶æ®µ&#34;&gt;7) Remark é‡æ ‡è®°é˜¶æ®µ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;pre-write barrier + satb_mark_queue&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code&gt;pre-write barrier&lt;/code&gt;ï¼šå†™å±éšœï¼šåœ¨å¯¹è±¡å¼•ç”¨æ”¹å˜å‰ï¼Œå°†å¯¹è±¡åŠ å…¥åˆ° &lt;code&gt;satb_mark_queue&lt;/code&gt; é˜Ÿåˆ—ï¼Œå°†æ¥ remark ä»é˜Ÿåˆ—ä¸­å–å‡ºå¯¹è±¡è¿›ä¸€æ­¥åˆ¤æ–­ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;41&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E9%87%8D%E6%A0%87%E8%AE%B0_1.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;å¹¶å‘æ ‡è®°é˜¶æ®µå¯¹è±¡çš„ true å’Œ falseï¼Œå…¶ä¸­å›¾ä¸­&lt;strong&gt;é»‘è‰²&lt;/strong&gt;è¡¨ç¤ºå·²ç»å¤„ç†å®Œæˆï¼Œå¹¶ä¸”æœ‰å¼•ç”¨åœ¨å¼•ç”¨å®ƒä»¬ï¼Œåœ¨åƒåœ¾å›æ”¶åä¼šè¢«&lt;strong&gt;ä¿ç•™&lt;/strong&gt;ä¸‹æ¥ã€‚&lt;strong&gt;ç°è‰²&lt;/strong&gt;çš„æ˜¯æ­£åœ¨&lt;strong&gt;è§¦å‘ä¸­&lt;/strong&gt;ï¼Œç°è‰²çš„å› ä¸ºæœ‰å¼ºå¼•ç”¨é»‘è‰²çš„åœ¨æŒ‡å‘å®ƒï¼Œæ‰€ä»¥æœ€ç»ˆä¼šå˜æˆé»‘è‰²ï¼Œ&lt;strong&gt;ç™½è‰²&lt;/strong&gt;çš„æ˜¯&lt;strong&gt;å°šæœªå¤„ç†&lt;/strong&gt;ï¼Œå¦‚æœæœ‰å¼ºå¼•ç”¨æŒ‡å‘å®ƒæœ€åä¼šå˜æˆé»‘è‰²ï¼Œå¦‚æœæ²¡æœ‰å¼•ç”¨æŒ‡å‘å®ƒæœ€ç»ˆè¿˜æ˜¯ç™½è‰²ï¼Œä¼šè¢«å½“æˆåƒåœ¾å›æ”¶ã€‚åƒåœ¾å›æ”¶ç»“æŸåï¼Œä¼šæ ¹æ®å¯¹è±¡çš„é»‘ç™½çŠ¶æ€åŒºåˆ†å®ƒåˆ°åº•åº”è¯¥å­˜æ´»è¿˜æ˜¯è¢«å›æ”¶ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E9%87%8D%E6%A0%87%E8%AE%B0_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E9%87%8D%E6%A0%87%E8%AE%B0_3.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Remark æµç¨‹ï¼š&lt;/strong&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E9%87%8D%E6%A0%87%E8%AE%B0_4.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;8-jdk-8u20-å­—ç¬¦ä¸²å»é‡&#34;&gt;8) JDK 8u20 å­—ç¬¦ä¸²å»é‡&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ä¼˜ç‚¹ï¼šèŠ‚çœå¤§é‡å†…å­˜&lt;/li&gt;
&lt;li&gt;ç¼ºç‚¹ï¼šç•¥å¾®å¤šå ç”¨äº† cpu æ—¶é—´ï¼Œæ–°ç”Ÿä»£å›æ”¶æ—¶é—´ç•¥å¾®å¢åŠ &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code&gt;-XX:+UseStringDeduplication&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;String s1 = new String(&amp;quot;hello&amp;quot;); // char[]{&#39;h&#39;,&#39;e&#39;,&#39;l&#39;,&#39;l&#39;,&#39;o&#39;} 
String s2 = new String(&amp;quot;hello&amp;quot;); // char[]{&#39;h&#39;,&#39;e&#39;,&#39;l&#39;,&#39;l&#39;,&#39;o&#39;}
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;å°†æ‰€æœ‰æ–°åˆ†é…çš„å­—ç¬¦ä¸²æ”¾å…¥ä¸€ä¸ª&lt;strong&gt;é˜Ÿåˆ—&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;å½“æ–°ç”Ÿä»£å›æ”¶æ—¶ï¼ŒG1å¹¶å‘æ£€æŸ¥é˜Ÿåˆ—ä¸­æ˜¯å¦æœ‰å­—ç¬¦ä¸²é‡å¤&lt;/li&gt;
&lt;li&gt;å¦‚æœå®ƒä»¬å€¼ä¸€æ ·ï¼Œè®©å®ƒä»¬&lt;strong&gt;å¼•ç”¨åŒä¸€ä¸ª char[]&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;æ³¨æ„ï¼Œä¸ String.intern() ä¸ä¸€æ ·
&lt;ul&gt;
&lt;li&gt;String.intern() å…³æ³¨çš„æ˜¯&lt;strong&gt;å­—ç¬¦ä¸²å¯¹è±¡&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;è€Œå­—ç¬¦ä¸²å»é‡å…³æ³¨çš„æ˜¯ &lt;strong&gt;char[]&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;åœ¨ JVM å†…éƒ¨ï¼Œä½¿ç”¨äº†ä¸åŒçš„å­—ç¬¦ä¸²è¡¨&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;9-jdk-8u40-å¹¶å‘æ ‡è®°ç±»å¸è½½&#34;&gt;9) JDK 8u40 å¹¶å‘æ ‡è®°ç±»å¸è½½&lt;/h3&gt;
&lt;p&gt;æ‰€æœ‰å¯¹è±¡éƒ½ç»è¿‡å¹¶å‘æ ‡è®°åï¼Œå°±èƒ½çŸ¥é“&lt;strong&gt;å“ªäº›ç±»ä¸å†è¢«ä½¿ç”¨&lt;/strong&gt;ï¼Œå½“ä¸€ä¸ªç±»åŠ è½½å™¨çš„æ‰€æœ‰ç±»éƒ½ä¸å†ä½¿ç”¨ï¼Œåˆ™&lt;strong&gt;å¸è½½å®ƒæ‰€åŠ è½½çš„æ‰€æœ‰ç±»&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;-XX:+ClassUnloadingWithConcurrentMark&lt;/code&gt; é»˜è®¤å¯ç”¨&lt;/p&gt;
&lt;h3 id=&#34;10-jdk-8u60-å›æ”¶å·¨å‹å¯¹è±¡&#34;&gt;10) JDK 8u60 å›æ”¶å·¨å‹å¯¹è±¡&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;42&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%9B%9E%E6%94%B6%E5%B7%A8%E5%9E%8B%E5%AF%B9%E8%B1%A1.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;Region åŒºåŸŸå†…ç²‰è‰²çš„ H å°±æ˜¯å·¨å‹å¯¹è±¡ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€ä¸ªå¯¹è±¡&lt;strong&gt;å¤§äº region çš„ä¸€åŠ&lt;/strong&gt;æ—¶ï¼Œç§°ä¹‹ä¸ºå·¨å‹å¯¹è±¡&lt;/li&gt;
&lt;li&gt;G1 &lt;strong&gt;ä¸ä¼šå¯¹å·¨å‹å¯¹è±¡è¿›è¡Œæ‹·è´&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å›æ”¶æ—¶è¢«ä¼˜å…ˆè€ƒè™‘&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;G1 ä¼šè·Ÿè¸ªè€å¹´ä»£æ‰€æœ‰ incoming å¼•ç”¨ï¼Œè¿™æ ·è€å¹´ä»£ incoming å¼•ç”¨ä¸º0 çš„å·¨å‹å¯¹è±¡å°±å¯ä»¥åœ¨æ–°ç”Ÿä»£åƒåœ¾å›æ”¶æ—¶å¤„ç†æ‰&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;43&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%9B%9E%E6%94%B6%E5%B7%A8%E5%9E%8B%E5%AF%B9%E8%B1%A1_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;11-jdk-9-å¹¶å‘æ ‡è®°èµ·å§‹æ—¶é—´çš„è°ƒæ•´&#34;&gt;11) JDK 9 å¹¶å‘æ ‡è®°èµ·å§‹æ—¶é—´çš„è°ƒæ•´&lt;/h3&gt;
&lt;p&gt;å¦‚æœåƒåœ¾å›æ”¶çš„é€Ÿåº¦è·Ÿä¸ä¸Šåƒåœ¾äº§ç”Ÿçš„é€Ÿåº¦ï¼Œæœ€ç»ˆä¼šé€€åŒ–ä¸º Full GCã€‚G1 çš„ Full GC æ˜¯å¤šçº¿ç¨‹çš„ï¼ŒFull GC çš„ STW è¿‡ç¨‹å¾ˆé•¿ï¼Œå› æ­¤è¦å°½å¯èƒ½é¿å… Full GC çš„å‘ç”Ÿã€‚å¦‚ä½•å‡å°‘ Full GC å‘¢ï¼Ÿæå‰è®©åƒåœ¾å›æ”¶å¼€å§‹ï¼Œå¹¶å‘æ ‡è®°ã€æ··åˆæ”¶é›†æå‰å¼€å§‹ï¼Œå°±èƒ½å‡å°‘ Full GC å‘ç”Ÿçš„å‡ ç‡ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¹¶å‘æ ‡è®°å¿…é¡»åœ¨å †ç©ºé—´å æ»¡å‰å®Œæˆï¼Œå¦åˆ™é€€åŒ–ä¸º FullGC&lt;/li&gt;
&lt;li&gt;JDK 9 ä¹‹å‰éœ€è¦ä½¿ç”¨ &lt;code&gt;-XX:InitiatingHeapOccupancyPercent&lt;/code&gt;ï¼šè€å¹´ä»£åœ¨å †å†…å­˜çš„å æ¯”ï¼Œå½“è¶…è¿‡è®¾ç½®çš„è¿™ä¸ªé˜ˆå€¼æ—¶ï¼Œå°±ä¼šè§¦å‘å¹¶å‘åƒåœ¾å›æ”¶ã€‚&lt;/li&gt;
&lt;li&gt;JDK 9 å¯ä»¥åŠ¨æ€è°ƒæ•´
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-XX:InitiatingHeapOccupancyPercent&lt;/code&gt; ç”¨æ¥è®¾ç½®&lt;strong&gt;åˆå§‹å€¼&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;è¿›è¡Œ&lt;strong&gt;æ•°æ®é‡‡æ ·&lt;/strong&gt;å¹¶&lt;strong&gt;åŠ¨æ€è°ƒæ•´&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;æ€»ä¼šæ·»åŠ ä¸€ä¸ªå®‰å…¨çš„ç©ºæ¡£ç©ºé—´&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;12-jdk-9-æ›´é«˜æ•ˆçš„å›æ”¶&#34;&gt;12) JDK 9 æ›´é«˜æ•ˆçš„å›æ”¶&lt;/h3&gt;
&lt;p&gt;250+å¢å¼º&lt;/p&gt;
&lt;p&gt;180+bugä¿®å¤&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.oracle.com/en/java/javase/12/gctuning&#34;&gt;https://docs.oracle.com/en/java/javase/12/gctuning&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&#34;äº”-åƒåœ¾å›æ”¶è°ƒä¼˜&#34;&gt;äº”ã€åƒåœ¾å›æ”¶è°ƒä¼˜&lt;/h1&gt;
&lt;p&gt;é¢„å¤‡çŸ¥è¯†&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æŒæ¡ GC ç›¸å…³çš„ VM å‚æ•°ï¼Œä¼šåŸºæœ¬çš„ç©ºé—´è°ƒæ•´&lt;/li&gt;
&lt;li&gt;æŒæ¡ç›¸å…³å·¥å…·&lt;/li&gt;
&lt;li&gt;æ˜ç™½ä¸€ç‚¹ï¼šè°ƒä¼˜è·Ÿåº”ç”¨ã€ç¯å¢ƒæœ‰å…³ï¼Œæ²¡æœ‰æ”¾ä¹‹å››æµ·è€Œçš†å‡†çš„æ³•åˆ™&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æŸ¥çœ‹è™šæ‹Ÿæœºè¿è¡Œå‚æ•°ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;quot;C:\Program Files\Java\jdk1.8.0_172\bin\java&amp;quot; -XX:+PrintFlagsFinal -version | findstr &amp;quot;GC&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;44&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E8%B0%83%E4%BC%98.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;51-è°ƒä¼˜é¢†åŸŸ&#34;&gt;5.1 è°ƒä¼˜é¢†åŸŸ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å†…å­˜&lt;/li&gt;
&lt;li&gt;é”ç«äº‰&lt;/li&gt;
&lt;li&gt;cpu å ç”¨&lt;/li&gt;
&lt;li&gt;io&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;52-ç¡®å®šç›®æ ‡&#34;&gt;5.2 ç¡®å®šç›®æ ‡&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ã€ä½å»¶è¿Ÿã€‘è¿˜æ˜¯ã€é«˜ååé‡ã€‘ï¼Œé€‰æ‹©åˆé€‚çš„å›æ”¶å™¨&lt;/li&gt;
&lt;li&gt;CMSï¼ŒG1ï¼ŒZGCï¼šä½å»¶è¿Ÿ&lt;/li&gt;
&lt;li&gt;ParallelGCï¼šé«˜ååé‡&lt;/li&gt;
&lt;li&gt;Zing&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;53-æœ€å¿«çš„-gc-æ˜¯ä¸å‘ç”Ÿ-gc&#34;&gt;5.3 æœ€å¿«çš„ GC æ˜¯ä¸å‘ç”Ÿ GC&lt;/h2&gt;
&lt;p&gt;ç­”æ¡ˆæ˜¯ä¸å‘ç”Ÿ GC&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æŸ¥çœ‹ FullGC å‰åçš„å†…å­˜å ç”¨ï¼Œè€ƒè™‘ä¸‹é¢å‡ ä¸ªé—®é¢˜
&lt;ul&gt;
&lt;li&gt;æ•°æ®æ˜¯ä¸æ˜¯å¤ªå¤šï¼Ÿ
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;resultSet = statement.executeQuery(&amp;quot;select * from å¤§è¡¨ limit n&amp;quot;)&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ•°æ®è¡¨ç¤ºæ˜¯å¦å¤ªè‡ƒè‚¿ï¼Ÿ
&lt;ul&gt;
&lt;li&gt;å¯¹è±¡å›¾&lt;/li&gt;
&lt;li&gt;å¯¹è±¡å¤§å° 16 Integer 24 int 4&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ˜¯å¦å­˜åœ¨å†…å­˜æ³„æ¼ï¼Ÿ
&lt;ul&gt;
&lt;li&gt;static Map map ä¸æ–­å‘é‡Œé¢æ”¾æ•°æ®&lt;/li&gt;
&lt;li&gt;è½¯&lt;/li&gt;
&lt;li&gt;å¼±&lt;/li&gt;
&lt;li&gt;ç¬¬ä¸‰æ–¹ç¼“å­˜å®ç°&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;54-æ–°ç”Ÿä»£è°ƒä¼˜&#34;&gt;5.4 æ–°ç”Ÿä»£è°ƒä¼˜&lt;/h2&gt;
&lt;h3 id=&#34;æ–°ç”Ÿä»£çš„ç‰¹ç‚¹&#34;&gt;æ–°ç”Ÿä»£çš„ç‰¹ç‚¹&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æ‰€æœ‰çš„ new æ“ä½œçš„å†…å­˜åˆ†é…éå¸¸å»‰ä»·
&lt;ul&gt;
&lt;li&gt;TLAB thread-local allocation buffer
&lt;ul&gt;
&lt;li&gt;åœ¨ Eden ä¸­ç»™&lt;strong&gt;æ¯ä¸ªçº¿ç¨‹åˆ†é…ä¸€å—ç§æœ‰ç¼“å†²åŒº TLAB&lt;/strong&gt;ï¼Œnew å¯¹è±¡æ—¶ä¼šé¦–å…ˆæ£€æŸ¥ TLAB ç¼“å†²åŒºå†…æ˜¯å¦æœ‰ç©ºç™½åŒºåŸŸï¼Œå¦‚æœæœ‰å°±ä¼˜å…ˆåœ¨ TLAB è¿™å—å†…å­˜åˆ†é…ã€‚å› ä¸ºçº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œæ¯”å¦‚çº¿ç¨‹ 1 è¦ç”¨è¿™å—å†…å­˜ï¼Œåˆ†é…è¿˜æ²¡ç»“æŸæ—¶ï¼Œçº¿ç¨‹ 2 ä¸èƒ½ä¹Ÿè¦ç”¨è¿™å—å†…å­˜ï¼Œé€ æˆå†…å­˜åˆ†é…æ··ä¹±ï¼Œ  å› æ­¤åœ¨å¯¹è±¡çš„å†…å­˜åˆ†é…æ—¶ï¼Œè¦åšçº¿ç¨‹å®‰å…¨çš„ä¿æŠ¤ï¼Œ&lt;strong&gt;å‡å°‘çº¿ç¨‹ä¹‹é—´å¯¹åˆ†é…æ—¶çš„å¹¶å‘å†²çª&lt;/strong&gt;ï¼šTLAB  ï¼šçº¿ç¨‹å±€éƒ¨åˆ†é…ç¼“å†²åŒºã€‚æ¯ä¸ªçº¿ç¨‹ç”¨è‡ªå·±ç§æœ‰çš„ Eden å†…å­˜æ¥è¿›è¡Œå†…å­˜åˆ†é…ï¼Œå¤šä¸ªçº¿ç¨‹å³ä½¿åŒæ—¶åˆ›å»ºå¯¹è±¡ï¼Œä¹Ÿä¸ä¼šäº§ç”Ÿå¯¹å†…å­˜å ç”¨çš„å¹²æ‰°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ­»äº¡å¯¹è±¡çš„å›æ”¶ä»£ä»·æ˜¯é›¶
&lt;ul&gt;
&lt;li&gt;æ–°ç”Ÿä»£å‘ç”Ÿåƒåœ¾å›æ”¶æ—¶ï¼Œåƒåœ¾å›æ”¶å™¨å¤åˆ¶ç®—æ³•ï¼šæŠŠ Edenã€å¹¸å­˜åŒº FROM ä¸­çš„å¹¸å­˜å¯¹è±¡éƒ½å¤åˆ¶åˆ°å¹¸å­˜åŒº TOï¼ŒEdenã€FROM ä¸­çš„å†…å­˜å°±è¢«é‡Šæ”¾äº†ï¼Œå› æ­¤æ­»äº¡å¯¹è±¡çš„å›æ”¶ä»£ä»·æ˜¯é›¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ–°ç”Ÿä»£å¤§éƒ¨åˆ†å¯¹è±¡ç”¨è¿‡å³æ­»&lt;/li&gt;
&lt;li&gt;Minor GC çš„æ—¶é—´è¿œè¿œä½äº Full GC&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ–°ç”Ÿä»£è¶Šå¤§è¶Šå¥½å—&#34;&gt;æ–°ç”Ÿä»£è¶Šå¤§è¶Šå¥½å—ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;-Xmn&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Sets the initial and maximum size (in bytes) of the heap for the young generation (nursery).&lt;br&gt;
GC is performed in this region more often than in other regions. If the size for the young&lt;br&gt;
generation is too small, then a lot of minor garbage collections are performed. If the size is too  large, then only full garbage collections are performed, which can take a long time to complete.&lt;br&gt;
Oracle recommends that you keep the size for the young generation greater than 25% and less than 50% of the overall heap size.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;-Xmnï¼šè®¾ç½®å †ä¸­æ–°ç”Ÿä»£çš„åˆå§‹å’Œæœ€å¤§å€¼ã€‚&lt;strong&gt;æ–°ç”Ÿä»£è®¾ç½®å°&lt;/strong&gt;äº†ï¼Œ&lt;strong&gt;å¯ç”¨ç©ºé—´å°‘&lt;/strong&gt;ï¼Œåˆ›å»ºå¯¹è±¡æ—¶ä¸€æ—¦å‘ç°æ–°ç”Ÿä»£çš„ç©ºé—´ä¸è¶³å°±ä¼šè§¦å‘æ–°ç”Ÿä»£çš„ &lt;strong&gt;minor gc&lt;/strong&gt;ã€‚å¦‚æœæ–°&lt;strong&gt;ç”Ÿä»£å†…å­˜å¤ªå¤§&lt;/strong&gt;äº†ï¼Œ&lt;strong&gt;è€å¹´ä»£çš„å¯ç”¨ç©ºé—´ç›¸å¯¹å°‘äº†&lt;/strong&gt;ï¼Œè€å¹´ä»£çš„ç©ºé—´å°‘äº†ï¼Œå°†æ¥æ–°ç”Ÿä»£è§‰å¾—æˆ‘ç©ºé—²ç©ºé—´å¾ˆå¤šï¼Œæ–°åˆ›å»ºçš„å¯¹è±¡éƒ½è¿˜ä¸ä¼šè§¦å‘åƒåœ¾å›æ”¶ï¼Œä½†æ˜¯è€å¹´ä»£çš„ç©ºé—´ç´§å¼ ï¼Œå†è§¦å‘åƒåœ¾å›æ”¶ï¼Œå°±æ˜¯ full gcï¼Œ&lt;strong&gt;full gc çš„æš‚åœæ—¶é—´æ¯” minor gc æ—¶é—´æ›´é•¿&lt;/strong&gt;ã€‚&lt;strong&gt;æ–°ç”Ÿä»£å¤§äºå †å†…å­˜çš„ 1/4 ,å°äº 1/2 å³å¯&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;45&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%96%B0%E7%94%9F%E4%BB%A3-%E5%90%9E%E5%90%90%E9%87%8F.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;ååé‡&lt;/strong&gt;ï¼šå•ä½æ—¶é—´èƒ½å“åº”çš„è¯·æ±‚æ•°é‡ã€‚&lt;/p&gt;
&lt;p&gt;éšç€æ–°ç”Ÿä»£ç©ºé—´è¶Šæ¥è¶Šå¤§ï¼Œååé‡è¶Šæ¥è¶Šé«˜ï¼Œåƒåœ¾å›æ”¶å ç”¨æ•´ä¸ª CPU è®¡ç®—çš„æ—¶é—´æ¯”ä¾‹å°‘äº†ï¼ŒCPUæ—¶é—´æ›´å¤šç”¨æ¥å¤„ç†è¯·æ±‚äº†ï¼Œååé‡å°±å˜é«˜äº†ï¼Œä½†æ˜¯åˆ°äº†ä¸€å®šçš„å¤§å°åï¼Œä¼šæœ‰ä¸€ä¸ªä¸‹é™ï¼š&lt;strong&gt;æ–°ç”Ÿä»£ç©ºé—´å¤§äº†ï¼Œæ„å‘³ç€å›æ”¶çš„æ—¶é—´è¾ƒé•¿&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ–°ç”Ÿä»£è°ƒæ•´å°½å¯èƒ½å¤§&lt;/strong&gt;ï¼Œæ–°ç”Ÿä»£çš„åƒåœ¾å›æ”¶éƒ½æ˜¯å¤åˆ¶ç®—æ³•ï¼Œå¤åˆ¶ç®—æ³•åˆ†æˆï¼šæ ‡è®°ã€å¤åˆ¶ä¸¤ä¸ªé˜¶æ®µï¼Œå¤åˆ¶é˜¶æ®µèŠ±è´¹çš„æ—¶é—´æ›´å¤šï¼Œè€Œ&lt;strong&gt;æ–°ç”Ÿä»£çš„å¯¹è±¡ï¼Œç»å¤§éƒ¨åˆ†éƒ½æ˜¯æœç”Ÿå¤•æ­»çš„ï¼Œæœ€ç»ˆåªæœ‰å°‘é‡çš„å¯¹è±¡ä¼šå­˜æ´»ä¸‹æ¥ï¼Œå¤åˆ¶æ‰€å ç”¨çš„æ—¶é—´ä¹Ÿæ˜¯ç›¸å¯¹è¾ƒçŸ­çš„&lt;/strong&gt;ï¼Œè€Œæ ‡è®°æ—¶é—´ç›¸å¯¹äºå¤åˆ¶æ—¶é—´æ¥è®²ï¼Œå°±æ˜¾å¾—ä¸æ˜¯å¾ˆé‡è¦äº†ï¼Œæ‰€ä»¥&lt;strong&gt;æ–°ç”Ÿä»£è°ƒå¤§çš„æƒ…å†µä¸‹ï¼Œä¸»è¦æ—¶é—´è¿˜æ˜¯è€—è´¹åœ¨å¤åˆ¶ä¸Šï¼Œå³ä½¿å¢å¾—å¾ˆå¤§ï¼Œæ•ˆç‡ä¹Ÿä¸ä¼šæœ‰å¾ˆæ˜æ˜¾çš„ä¸‹é™&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ–°ç”Ÿä»£çš„å¤§å°è®¾ç½®&#34;&gt;æ–°ç”Ÿä»£çš„å¤§å°è®¾ç½®&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ–°ç”Ÿä»£èƒ½å®¹çº³å¹¶å‘é‡ *  (ä¸€æ¬¡è¯·æ±‚-å“åº”è¿‡ç¨‹äº§ç”Ÿçš„å¯¹è±¡)çš„æ•°æ®&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¹¶å‘é‡ * è¯·æ±‚ - å“åº”è¿‡ç¨‹ä¸­æ‰€äº§ç”Ÿçš„çš„å¯¹è±¡&lt;/li&gt;
&lt;li&gt;å¦‚æœä¸€æ¬¡ è¯·æ±‚-å“åº” è¿‡ç¨‹ä¸­äº§ç”Ÿçš„å¯¹è±¡æ˜¯ 512KBï¼Œå¹¶å‘é‡æ˜¯ 1000ï¼Œé‚£ä¹ˆæ–°ç”Ÿä»£ç†æƒ³çš„å†…å­˜å°±æ˜¯ 1000* 512KB = 521Mã€‚å› ä¸ºä¸€æ¬¡ è¯·æ±‚-å“åº”çš„è¿‡ç¨‹ï¼Œåœ¨è¿™æ¬¡ è¯·æ±‚-å“åº” ç»“æŸåï¼Œå¤§å¤šæ•°å¯¹è±¡éƒ½ä¼šè¢«å›æ”¶ï¼Œåªè¦è¿™ä¸€æ¬¡ è¯·æ±‚-å“åº” å ç”¨çš„å†…å­˜ä¸è¶…è¿‡æ–°ç”Ÿä»£çš„å†…å­˜ï¼Œå°±ä¸ä¼šè§¦å‘æ–°ç”Ÿä»£çš„åƒåœ¾å›æ”¶&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹¸å­˜åŒºå¤§åˆ°èƒ½ä¿ç•™å½“å‰æ´»è·ƒå¯¹è±¡+éœ€è¦æ™‹å‡å¯¹è±¡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¹¸å­˜åŒºä¸­æœ‰ä¸¤ç±»å¯¹è±¡ï¼š&lt;strong&gt;â‘ ç”Ÿå‘½å‘¨æœŸè¾ƒçŸ­ï¼Œä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶å°±æŠŠå®ƒå›æ”¶æ‰äº†&lt;/strong&gt;ï¼Œä½†ç”±äºç°åœ¨è¿˜åœ¨ä½¿ç”¨ï¼Œæš‚æ—¶ä¸èƒ½å›æ”¶ï¼›&lt;strong&gt;â‘¡å°†æ¥ä¼šè¢«æ™‹å‡åˆ°è€å¹´ä»£&lt;/strong&gt;ï¼Œä½†æ˜¯ç”±äºå¹´é¾„ä¸å¤Ÿï¼Œæ‰€ä»¥æš‚æ—¶å­˜æ”¾åœ¨å¹¸å­˜åŒºä¸­ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¦‚æœå¹¸å­˜åŒºè¾ƒå°ï¼Œå°±ä¼šç”± JVM åŠ¨æ€è°ƒæ•´æ™‹å‡é˜ˆå€¼&lt;/strong&gt;ï¼Œä¹Ÿè®¸æœ¬æ¥æœ‰äº›å¯¹è±¡ä¸åº”è¯¥æ™‹å‡çš„ï¼Œä½†æ˜¯ç”±äºå¹¸å­˜åŒºå†…å­˜ä¸å¤Ÿï¼Œå¯¼è‡´ä¼šæå‰&lt;strong&gt;æŠŠæœ¬åº”å›æ”¶çš„å¯¹è±¡æ™‹å‡åˆ°è€å¹´ä»£&lt;/strong&gt;ã€‚å¦‚æœå­˜æ´»æ—¶é—´çŸ­çš„å¯¹è±¡è¢«æ™‹å‡åˆ°äº†è€å¹´ä»£ï¼Œéœ€è¦ç­‰åˆ°è€å¹´ä»£å†…å­˜ä¸è¶³ï¼Œè§¦å‘ Full GC æ—¶æ‰èƒ½æŠŠå®ƒå½“åšåƒåœ¾è¿›è¡Œå›æ”¶ï¼Œå»¶é•¿äº†å¯¹è±¡çš„ç”Ÿå­˜æ—¶é—´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ™‹å‡é˜ˆå€¼é…ç½®å¾—å½“ï¼Œè®©é•¿æ—¶é—´å­˜æ´»å¯¹è±¡å°½å¿«æ™‹å‡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœæ˜¯ä¸€ä¸ª&lt;strong&gt;é•¿æœŸå­˜æ´»çš„å¯¹è±¡&lt;/strong&gt;ï¼ŒæŠŠå®ƒ&lt;strong&gt;ç•™åˆ°å¹¸å­˜åŒºé‡Œ&lt;/strong&gt;ï¼Œåªä¼š&lt;strong&gt;è€—è´¹å¹¸å­˜åŒºçš„å†…å­˜&lt;/strong&gt;ï¼Œå¹¶ä¸”æ–°ç”Ÿä»£åƒåœ¾å›æ”¶éƒ½æ˜¯å¤åˆ¶ç®—æ³•ï¼Œè¦æŠŠå¹¸å­˜åŒºçš„å­˜æ´»å¯¹è±¡ä» FROM å¤åˆ¶åˆ° TOï¼Œå¦‚æœå¤§é‡é•¿æ—¶é—´å­˜æ´»çš„å¯¹è±¡ä¸èƒ½åŠæ—©æ™‹å‡ï¼Œé‚£ä¹ˆå°±è¦ç•™åœ¨å¹¸å­˜åŒºè¢«&lt;strong&gt;å¤åˆ¶æ¥å¤åˆ¶å»&lt;/strong&gt;ã€‚è°ƒæ•´æ™‹å‡é˜ˆå€¼ï¼Œè®©&lt;strong&gt;é•¿æ—¶é—´å­˜æ´»çš„å¯¹è±¡å°½å¿«æ™‹å‡åˆ°è€å¹´ä»£&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è°ƒæ•´æœ€å¤§æ™‹å‡é˜ˆå€¼ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;-XX:MaxTenuringThreshold=threshold 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ˜¾ç¤ºå¹¸å­˜åŒºå¯¹è±¡è¯¦æƒ…ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;-XX:+PrintTenuringDistribution 
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;Desired survivor size 48286924 bytes, new threshold 10 (max 10) 
- age 1: 28992024 bytes, 28992024 total 
- age 2: 1366864 bytes, 30358888 total 
- age 3: 1425912 bytes, 31784800 total 
...
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;55-è€å¹´ä»£è°ƒä¼˜&#34;&gt;5.5 è€å¹´ä»£è°ƒä¼˜&lt;/h2&gt;
&lt;h3 id=&#34;ä»¥-cms-ä¸ºä¾‹&#34;&gt;ä»¥ CMS ä¸ºä¾‹&lt;/h3&gt;
&lt;p&gt;CMS åƒåœ¾å›æ”¶å™¨ï¼š&lt;strong&gt;ä½å“åº”æ—¶é—´ã€å¹¶å‘çš„&lt;/strong&gt;ï¼ˆåƒåœ¾å›æ”¶çº¿ç¨‹åœ¨å·¥ä½œçš„åŒæ—¶å…¶ä»–ç”¨æˆ·çº¿ç¨‹ä¹Ÿèƒ½åœ¨å¹¶å‘çš„æ‰§è¡Œï¼šåƒåœ¾å›æ”¶çš„åŒæ—¶å…¶ä»–ç”¨æˆ·çº¿ç¨‹ä¹Ÿåœ¨è¿è¡Œï¼Œå°±ä¼šäº§ç”Ÿæ–°çš„æµ®åŠ¨åƒåœ¾ï¼Œå¦‚æœæµ®åŠ¨åƒåœ¾äº§ç”Ÿå¯¼è‡´å†…å­˜ä¸è¶³ï¼Œå°±ä¼šé€ æˆ CMS å¹¶å‘å¤±è´¥ï¼ŒCMS åƒåœ¾å›æ”¶å™¨é€€åŒ–ä¸º ä¸²è¡Œè€å¹´ä»£åƒåœ¾å›æ”¶å™¨ï¼šSTWï¼‰&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;CMS çš„&lt;strong&gt;è€å¹´ä»£å†…å­˜è¶Šå¤§è¶Šå¥½&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é¢„ç•™æ›´å¤šç©ºé—´ï¼Œé¿å…æµ®åŠ¨åƒåœ¾å¼•èµ·çš„å¹¶å‘å¤±è´¥&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…ˆå°è¯•ä¸åšè°ƒä¼˜&lt;/strong&gt;ï¼Œå¦‚æœæ²¡æœ‰ Full GC é‚£ä¹ˆå·²ç»å¯ä»¥äº†ï¼Œå¦åˆ™å…ˆå°è¯•è°ƒä¼˜æ–°ç”Ÿä»£&lt;/li&gt;
&lt;li&gt;è§‚å¯Ÿ&lt;strong&gt;å‘ç”Ÿ Full GC æ—¶è€å¹´ä»£å†…å­˜å ç”¨&lt;/strong&gt;ï¼Œå°†è€å¹´ä»£å†…å­˜é¢„è®¾è°ƒå¤§ 1/4 ~ 1/3&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;-XX:CMSInitiatingOccupancyFraction=percent
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è€å¹´ä»£çš„ç©ºé—´å ç”¨è¾¾åˆ°è€å¹´ä»£çš„ percent% æ—¶ï¼Œè§¦å‘åƒåœ¾å›æ”¶ percent è¶Šå°ï¼Œè€å¹´ä»£åƒåœ¾å›æ”¶è§¦å‘æ—¶é—´è¶Šæ—©ã€‚&lt;/p&gt;
&lt;h2 id=&#34;56-æ¡ˆä¾‹&#34;&gt;5.6 æ¡ˆä¾‹&lt;/h2&gt;
&lt;h3 id=&#34;æ¡ˆä¾‹1-full-gc-å’Œ-minor-gcé¢‘ç¹ç©ºé—´ç´§å¼ &#34;&gt;æ¡ˆä¾‹1 Full GC å’Œ Minor GCé¢‘ç¹ï¼šç©ºé—´ç´§å¼ &lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;é—®é¢˜åˆ†æï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ–°ç”Ÿä»£ç©ºé—´ç´§å¼ ï¼šå½“ä¸šåŠ¡é«˜å³°æœŸæ¥äº†ï¼Œå¤§é‡å¯¹è±¡è¢«åˆ›å»ºï¼Œ&lt;strong&gt;æ–°ç”Ÿä»£è¢«å¡«æ»¡&lt;/strong&gt;ï¼Œ&lt;strong&gt;å¹¸å­˜åŒºç©ºé—´ç´§å¼ &lt;/strong&gt;äº†ï¼Œ&lt;strong&gt;æ™‹å‡å¯¹è±¡çš„é˜ˆå€¼å°±ä¼šé™ä½&lt;/strong&gt;ï¼Œå¯¼è‡´å¾ˆå¤šåŸæ¥&lt;strong&gt;ç”Ÿå­˜å‘¨æœŸå¾ˆçŸ­çš„å¯¹è±¡è¢«æ™‹å‡åˆ°è€å¹´ä»£&lt;/strong&gt;äº†ï¼Œè€å¹´ä»£å­˜äº†å¤§é‡ç”Ÿå­˜å‘¨æœŸå¾ˆçŸ­çš„å¯¹è±¡ï¼Œè¿›ä¸€æ­¥è§¦å‘è€å¹´ä»£ &lt;strong&gt;Full GC&lt;/strong&gt; å‘ç”Ÿã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é—®é¢˜è§£å†³ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;å¢å¤§æ–°ç”Ÿä»£å†…å­˜&lt;/strong&gt;ï¼Œæ–°ç”Ÿä»£å†…å­˜å¢å¤§äº†ï¼Œå†…å­˜å……è£•ï¼Œæ–°ç”Ÿä»£çš„åƒåœ¾å›æ”¶ä¸é‚£ä¹ˆé¢‘ç¹äº†ï¼Œå¢å¤§äº†å¹¸å­˜åŒºçš„ç©ºé—´ä»¥åŠæ™‹å‡é˜ˆå€¼ï¼Œç”Ÿå‘½å‘¨æœŸè¾ƒçŸ­çš„å¯¹è±¡å°½å¯èƒ½åœ¨å¹¸å­˜åŒºè¢«å›æ”¶ï¼Œè€Œä¸è¦æ™‹å‡åˆ°è€å¹´ä»£ï¼Œå‡å°‘è€å¹´ä»£ Full GCã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ¡ˆä¾‹2-è¯·æ±‚é«˜å³°æœŸå‘ç”Ÿ-full-gcå•æ¬¡æš‚åœæ—¶é—´ç‰¹åˆ«é•¿-cms&#34;&gt;æ¡ˆä¾‹2 è¯·æ±‚é«˜å³°æœŸå‘ç”Ÿ Full GCï¼Œå•æ¬¡æš‚åœæ—¶é—´ç‰¹åˆ«é•¿ ï¼ˆCMSï¼‰&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;é—®é¢˜åˆ†æï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æŸ¥çœ‹æ—¥å¿—ï¼Œçœ‹ CMS å“ªä¸ªé˜¶æ®µè€—è´¹æ—¶é—´é•¿&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;46&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%90%9E%E5%90%90%E9%87%8F%E4%BC%98%E5%85%88%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E5%99%A8.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;åˆå§‹æ ‡è®°å’Œå¹¶å‘æ ‡è®°éƒ½æ˜¯æ¯”è¾ƒå¿«çš„ï¼Œ&lt;strong&gt;é‡æ–°æ ‡è®°æ¯”è¾ƒæ…¢&lt;/strong&gt;ï¼Œ æŸ¥çœ‹ GC æ—¥å¿—ä¼šæŠŠæ¯ä¸€é˜¶æ®µè€—è´¹çš„æ—¶é—´æ˜¾ç¤ºã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é—®é¢˜è§£å†³ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é‡æ–°æ ‡è®°ä¼šæ‰«ææ•´ä¸ªå†…å­˜ï¼Œä¸å…‰æ˜¯è¦æ‰«æè€å¹´ä»£å¯¹è±¡ï¼Œä¹Ÿè¦åŒæ—¶æ‰«ææ–°ç”Ÿä»£å¯¹è±¡ï¼Œå¦‚æœæ˜¯ä¸šåŠ¡é«˜å³°æœŸï¼Œæ–°ç”Ÿä»£å¯¹è±¡æ¯”è¾ƒå¤šï¼Œæ‰«ææ ‡è®°æ—¶é—´å°±ä¼šå¾ˆé•¿ï¼Œå› ä¸ºè¦æ ¹æ®å¯¹è±¡æ‰¾å®ƒçš„å¼•ç”¨ï¼Œèƒ½ä¸èƒ½&lt;strong&gt;åœ¨é‡æ–°æ ‡è®°å‰æŠŠæ–°ç”Ÿä»£çš„å¯¹è±¡åšä¸€æ¬¡åƒåœ¾å›æ”¶&lt;/strong&gt;ï¼Œå‡å°‘æ–°ç”Ÿä»£å¯¹è±¡çš„æ•°é‡ï¼Œå‡å°‘é‡æ–°æ ‡è®°é˜¶æ®µè€—è´¹çš„æ—¶é—´ã€‚é€šè¿‡è®¾ç½®ï¼š&lt;code&gt;-XX:+CMSScavengeBeforeRemark&lt;/code&gt;ï¼šåœ¨é‡æ–°æ ‡è®°å‘ç”Ÿä¹‹å‰ï¼Œå…ˆå¯¹æ–°ç”Ÿä»£è¿›è¡Œä¸€æ¬¡åƒåœ¾æ¸…ç†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ¡ˆä¾‹3-è€å¹´ä»£å……è£•æƒ…å†µä¸‹å‘ç”Ÿ-full-gc-cms-jdk17&#34;&gt;æ¡ˆä¾‹3 è€å¹´ä»£å……è£•æƒ…å†µä¸‹ï¼Œå‘ç”Ÿ Full GC ï¼ˆCMS jdk1.7ï¼‰&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;é—®é¢˜åˆ†æï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;CMS å¯èƒ½ç”±äºç©ºé—´ä¸è¶³å¯¼è‡´å¹¶å‘å¤±è´¥ï¼Œæˆ–è€…ç”±äºç©ºé—´ç¢ç‰‡å¤šéƒ½ä¼šäº§ç”Ÿ Full GCã€‚ä½†æ˜¯ç»è¿‡æ’æŸ¥ï¼Œåœ¨ GC æ—¥å¿—æ²¡æœ‰å¹¶å‘å¤±è´¥æˆ–è€…ç¢ç‰‡è¿‡å¤šçš„æç¤ºã€‚è¯´æ˜è€å¹´ä»£ç©ºé—´å……è£•ï¼Œä¸æ˜¯ç”±äºè€å¹´ä»£ç©ºé—´ä¸è¶³äº§ç”Ÿçš„ Full GCã€‚&lt;strong&gt;JDK1.7 åŠä»¥å‰é‡‡ç”¨æ°¸ä¹…ä»£ä½œä¸ºæ–¹æ³•åŒºçš„å®ç°ï¼Œæ°¸ä¹…ä»£ç©ºé—´ä¸è¶³ä¹Ÿä¼šå¯¼è‡´ Full GC å‘ç”Ÿ&lt;/strong&gt;ï¼Œ1.8 ä»¥åä½¿ç”¨å…ƒç©ºé—´å°±ä¸æ˜¯ç”± Java æ§åˆ¶äº†ï¼Œæ‰€ä»¥å…ƒç©ºé—´ä½¿ç”¨æ“ä½œç³»ç»Ÿçš„ç©ºé—´ä¸€èˆ¬æƒ…å†µæ˜¯æ¯”è¾ƒå……è£•çš„ã€‚1.7 ä»¥å‰æ°¸ä¹…ä»£ç©ºé—´è®¾ç½®å°äº†å°±ä¼šè§¦å‘æ•´ä¸ªå †çš„ Full GCã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é—®é¢˜è§£å†³ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¢å¤§æ°¸ä¹…ä»£çš„åˆå§‹å€¼å’Œæœ€å¤§å€¼&lt;/p&gt;
">JVM åƒåœ¾å›æ”¶</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/http-xi-lie-er-shou-xi-http-xie-yi-jie-gou-he-tong-xun-yuan-li/"" data-c="
          &lt;h1 id=&#34;http-ç‰¹ç‚¹&#34;&gt;HTTP ç‰¹ç‚¹&lt;/h1&gt;
&lt;h2 id=&#34;æ”¯æŒ-å®¢æˆ·æœåŠ¡å™¨-æ¨¡å¼&#34;&gt;æ”¯æŒ å®¢æˆ·/æœåŠ¡å™¨ æ¨¡å¼&lt;/h2&gt;
&lt;p&gt;å®¢æˆ·/æœåŠ¡å™¨æ¨¡å¼å·¥ä½œçš„æ–¹å¼æ˜¯ç”±å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼ŒæœåŠ¡å™¨ç«¯å“åº”è¯·æ±‚ï¼Œå¹¶è¿›è¡Œç›¸åº”æœåŠ¡ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/client-server.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;ç®€å•å¿«é€Ÿ&#34;&gt;ç®€å•å¿«é€Ÿ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å®¢æˆ·å‘æœåŠ¡å™¨è¯·æ±‚æœåŠ¡æ—¶ï¼Œåªéœ€ä¼ é€&lt;strong&gt;è¯·æ±‚æ–¹æ³•å’Œè·¯å¾„&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;è¯·æ±‚æ–¹æ³•å¸¸ç”¨çš„æœ‰&lt;strong&gt;GETã€HEADã€POST&lt;/strong&gt;ã€‚æ¯ç§æ–¹æ³•è§„å®šäº†å®¢æˆ·ä¸æœåŠ¡å™¨è”ç³»çš„ç±»å‹ä¸åŒ&lt;/li&gt;
&lt;li&gt;ç”±äºHTTPåè®®ç®€å•ï¼Œä½¿å¾—HTTPæœåŠ¡å™¨çš„ç¨‹åºè§„æ¨¡å°ï¼Œå› è€Œ&lt;strong&gt;é€šä¿¡é€Ÿåº¦å¾ˆå¿«&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;çµæ´»&#34;&gt;çµæ´»&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;HTTPå…è®¸ä¼ è¾“ä»»æ„ç±»å‹çš„æ•°æ®å¯¹è±¡&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;æ­£åœ¨ä¼ è¾“çš„ç±»å‹ç”±Content-Typeï¼ˆContent-Typeæ˜¯HTTPåŒ…ä¸­ç”¨æ¥è¡¨ç¤ºå†…å®¹ç±»å‹çš„æ ‡è¯†ï¼‰åŠ ä»¥æ ‡è®°&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æ— è¿æ¥&#34;&gt;æ— è¿æ¥&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;æ— è¿æ¥çš„å«ä¹‰æ˜¯é™åˆ¶&lt;strong&gt;æ¯æ¬¡è¿æ¥åªå¤„ç†ä¸€ä¸ªè¯·æ±‚&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;æœåŠ¡å™¨å¤„ç†å®Œå®¢æˆ·çš„è¯·æ±‚ï¼Œå¹¶æ”¶åˆ°å®¢æˆ·çš„åº”ç­”åï¼Œå³æ–­å¼€è¿æ¥&lt;/li&gt;
&lt;li&gt;é‡‡ç”¨è¿™ç§æ–¹å¼å¯ä»¥&lt;strong&gt;èŠ‚çœä¼ è¾“æ—¶é—´&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æ— çŠ¶æ€&#34;&gt;æ— çŠ¶æ€&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;HTTPåè®®æ˜¯æ— çŠ¶æ€åè®®&lt;/li&gt;
&lt;li&gt;æ— çŠ¶æ€æ˜¯æŒ‡åè®®å¯¹äºäº‹åŠ¡å¤„ç†æ²¡æœ‰è®°å¿†èƒ½åŠ›ã€‚ç¼ºå°‘çŠ¶æ€æ„å‘³ç€å¦‚æœåç»­å¤„ç†éœ€è¦å‰é¢çš„ä¿¡æ¯ï¼Œåˆ™å®ƒå¿…é¡»é‡ä¼ ï¼Œè¿™æ ·å¯èƒ½å¯¼è‡´æ¯æ¬¡è¿æ¥ä¼ é€çš„æ•°æ®é‡å¢å¤§&lt;/li&gt;
&lt;li&gt;å¦ä¸€æ–¹é¢ï¼Œåœ¨æœåŠ¡å™¨ä¸éœ€è¦å…ˆå‰ä¿¡æ¯æ—¶å®ƒçš„åº”ç­”å°±è¾ƒå¿«&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;uri-ä¸-url&#34;&gt;URI ä¸ URL&lt;/h1&gt;
&lt;p&gt;Qï¼šæˆ‘ä»¬è¾“å…¥åœ¨æµè§ˆå™¨é‡Œçš„Webåœ°å€åº”è¯¥å«URLè¿˜æ˜¯URIï¼Ÿ&lt;/p&gt;
&lt;p&gt;å°Aï¼šæˆ‘ä»¬è®¿é—®çš„å°±æ˜¯&lt;strong&gt;URL&lt;/strong&gt;ï¼&lt;/p&gt;
&lt;p&gt;å°Bï¼šä¸ï¼å…¶å®é‚£æ—¶&lt;strong&gt;URI&lt;/strong&gt;å¥½ä¸å¥½ï¼&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/URI.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;URIï¼šä¸€ä¸ªç´§å‡‘çš„å­—ç¬¦ä¸²ç”¨æ¥æ ‡ç¤ºæŠ½è±¡æˆ–ç‰©ç†èµ„æº&lt;/li&gt;
&lt;li&gt;A URI å¯ä»¥è¿›ä¸€æ­¥è¢«åˆ†ä¸ºå®šä½ç¬¦ã€åå­—æˆ–ä¸¤è€…éƒ½æ˜¯&lt;/li&gt;
&lt;li&gt;æœ¯è¯­&amp;quot;Uniform Resource Locator&amp;quot;ï¼ˆURLï¼‰æ˜¯URIçš„å­é›†ï¼Œé™¤äº†ç¡®å®šä¸€ä¸ªèµ„æºï¼Œè¿˜æä¾›ä¸€ç§å®šä½è¯¥èµ„æºçš„ä¸»è¦è®¿é—®æœºåˆ¶ï¼ˆå¦‚å…¶ç½‘ç»œâ€œä½ç½®â€ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;ç»´åŸºç™¾ç§‘è§£é‡Š&#34;&gt;ç»´åŸºç™¾ç§‘è§£é‡Š&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;URIå¯ä»¥åˆ†ä¸ºURLï¼ŒURNæˆ–åŒæ—¶å…·å¤‡locators å’Œnamesç‰¹æ€§çš„ä¸€ä¸ªä¸œè¥¿&lt;/li&gt;
&lt;li&gt;URNä½œç”¨å°±å¥½åƒä¸€ä¸ªäººçš„&lt;strong&gt;åå­—&lt;/strong&gt;ï¼ŒURLå°±åƒä¸€ä¸ªäººçš„&lt;strong&gt;åœ°å€&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;æ¢å¥è¯è¯´ï¼šURNç¡®å®šäº†ä¸œè¥¿çš„èº«ä»½ï¼ŒURLæä¾›äº†æ‰¾åˆ°å®ƒçš„æ–¹å¼&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸€å®¶å…¬å¸çš„æ€»ç»ç†æœ‰ä¸€å¼ åç‰‡ï¼Œä¸Šé¢å†™äº† â€œåŒ—äº¬ xxx å…¬å¸æ€»ç»ç†å¼ ä¸‰â€ã€åŠå…¬å®¤åœ°å€ â€œåŒ—äº¬å¸‚æµ·æ·€åŒºé•¿å®‰è¡—35å· xx æ¥¼ xxx åŠå…¬å®¤â€ã€‚&lt;br&gt;
å¤´è¡”ï¼šåŒ—äº¬ xxx å…¬å¸æ€»ç»ç† â€”â€” å¼ ä¸‰ï¼Œå»ºç«‹ä¸€ä¸ªæ˜ å°„ï¼Œè¿™ä¸ªå¤´è¡”å°±æ˜¯ URIï¼Œ&lt;strong&gt;åªè¦çœ‹åˆ°ä¸€ä¸ª URI å°±çŸ¥é“å®ƒä»£è¡¨ä»€ä¹ˆ&lt;/strong&gt;ã€‚&lt;br&gt;
&lt;a href=&#34;http://www.baidu.cn&#34;&gt;www.baidu.cn&lt;/a&gt; â€”â€” ç™¾åº¦ç½‘ï¼Œ&lt;a href=&#34;http://www.baidu.com&#34;&gt;www.baidu.com&lt;/a&gt; å°±æ˜¯ä¸€ä¸ª URI&lt;br&gt;
admin@qq.com â€”â€” ä»£è¡¨æŸä¸ªäººçš„ QQ é‚®ç®±ï¼Œadmin@qq.com ä¹Ÿæ˜¯ä¸€ä¸ª URI&lt;br&gt;
&lt;strong&gt;URI æ˜¯ä¸€ä¸ªç½‘ç»œèµ„æºçš„å¤´è¡”&lt;/strong&gt;ï¼Œæ˜¯ä¸€ä¸ªç»Ÿç§°ï¼Œé€šè¿‡ URI å¯ä»¥æŠŠç½‘ç»œä¸–ç•Œé‡Œçš„æ¯ä¸€ä¸ªäº‹åŠ¡éƒ½åŠ ä»¥æ ‡è®°å¹¶ä¸”åŒºåˆ†å¼€æ¥ã€‚&lt;br&gt;
â€œåŒ—äº¬ xxx å…¬å¸æ€»ç»ç†â€ æ˜¯ä¸€ä¸ª URIï¼Œæˆ‘ä»¬çŸ¥é“è¿™ä¸ªå¤´è¡”å¯¹åº”çš„æ˜¯å¼ ä¸‰ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸èƒ½å»æ‰¾åˆ°è¿™ä¸ªäººï¼Œå› ä¸ºä¸çŸ¥é“ä»–çš„åœ°å€ï¼Œè¦å®šä½åˆ°ä»–å°±å¿…é¡»è¦çŸ¥é“ä»–çš„åŠå…¬å®¤åœ°å€ã€‚åæ˜ åˆ°ç½‘ç»œä¸–ç•Œï¼Œç½‘ç»œä¸–ç•Œä¸­çš„æ¯ä¸ªèµ„æºä¸åªæœ‰å¤´è¡”ï¼Œè¿˜è¦èƒ½å¤Ÿè¢«äººè®¿é—®ï¼Œæ‰€ä»¥ç½‘ç»œåœ°å€ä¹Ÿæ˜¯å¿…é¡»çš„ï¼Œå¦åˆ™è¿™ä¸ªç½‘ç»œèµ„æºçš„å­˜åœ¨å°±æ²¡æœ‰ä»»ä½•æ„ä¹‰äº†ï¼Œè¿™ä¸ª&lt;strong&gt;ç½‘ç»œåœ°å€å°±å«åš URL&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;URLæ˜¯URIçš„ä¸€ç§ï¼Œä½†ä¸æ˜¯æ‰€æœ‰çš„URIéƒ½æ˜¯URL&lt;/li&gt;
&lt;li&gt;URIå’ŒURLæœ€å¤§çš„å·®åˆ«æ˜¯â€œè®¿é—®æœºåˆ¶ï¼ˆHTTP è¿˜æ˜¯ FTPï¼‰&amp;quot;&lt;/li&gt;
&lt;li&gt;URN æ˜¯å”¯ä¸€æ ‡è¯†çš„ä¸€éƒ¨åˆ†ï¼Œæ˜¯èº«ä»½ä¿¡æ¯&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å®‰èƒ½è¾¨æˆ‘æ˜¯é›Œé›„&#34;&gt;å®‰èƒ½è¾¨æˆ‘æ˜¯é›Œé›„&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ftp://ftp.is.co.za/rfc/rfc1808.txt
&lt;ul&gt;
&lt;li&gt;URLï¼Œæä¾›äº†è®¿é—®æœºåˆ¶æ˜¯ FTP&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;http://www.ietf.org/rfc/rfc2396.txt
&lt;ul&gt;
&lt;li&gt;URLï¼Œæä¾›äº†è®¿é—®æœºåˆ¶æ˜¯ HTTP&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Idap://[2001:db8::7]/c=GB?objectClass?one
&lt;ul&gt;
&lt;li&gt;URLï¼Œæä¾›äº†è®¿é—®æœºåˆ¶ LDAP&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;mailto:John.Doe@example.com
&lt;ul&gt;
&lt;li&gt;URLï¼Œé€šè¿‡é‚®ä»¶è¿›è¡Œè®¿é—®&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;news:comp.infosystems.www.servers.unix
&lt;ul&gt;
&lt;li&gt;URL&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;tel:+1-816-555-1212
&lt;ul&gt;
&lt;li&gt;URIï¼šç”µè¯å·ç å¯ä»¥æ ‡è¯†æŸä¸€ä¸ªäººï¼Œä½†æ˜¯æ²¡æœ‰è®¿é—®æœºåˆ¶&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;telnet://192.0.2.16:80/
&lt;ul&gt;
&lt;li&gt;URLï¼Œè®¿é—®æœºåˆ¶ telnet&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;urn:oasis:names:specification:docbook:dtd:xml:4.1.2
&lt;ul&gt;
&lt;li&gt;URLï¼Œåœ°å€ä¸­å·²ç»æ˜¾ç¤ºäº† urnï¼Œæ²¡æœ‰è‡ªå·±çš„è®¿é—®æ–¹å¼&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;http-æŠ¥æ–‡ç»“æ„åˆ†æ-è¯·æ±‚æŠ¥æ–‡&#34;&gt;HTTP æŠ¥æ–‡ç»“æ„åˆ†æ - è¯·æ±‚æŠ¥æ–‡&lt;/h1&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%AF%B7%E6%B1%82%E6%8A%A5%E6%96%87.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;æŠ¥æ–‡å¤´å’ŒæŠ¥æ–‡ä½“ä¸­é—´æœ‰ä¸€è¡Œç©ºè¡Œ&lt;br&gt;
æŠ¥æ–‡ä½“å†…æ˜¯è¡¨å•çš„æ•°æ®ï¼Œä¸åŒå‚æ•°ä¹‹é—´ä½¿ç”¨ &amp;amp; è¿›è¡Œæ‹¼æ¥&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;http-æŠ¥æ–‡å¤´&#34;&gt;HTTP æŠ¥æ–‡å¤´&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;HTTPçš„æŠ¥æ–‡å¤´å¤§ä½“å¯ä»¥åˆ†ä¸ºå››ç±»ï¼Œåˆ†åˆ«æ˜¯ï¼šé€šç”¨æŠ¥æ–‡å¤´ã€è¯·æ±‚æŠ¥æ–‡å¤´ã€å“åº”æŠ¥æ–‡å¤´å’Œå®ä½“æŠ¥æ–‡å¤´&lt;/li&gt;
&lt;li&gt;åœ¨HTTP/1.1é‡Œä¸€å…±è§„èŒƒäº†47ç§æŠ¥æ–‡å¤´å­—æ®µ&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;é€šç”¨æŠ¥æ–‡å¤´&#34;&gt;é€šç”¨æŠ¥æ–‡å¤´&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;é¦–éƒ¨å­—æ®µå&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Cache-Control&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ§åˆ¶ç¼“å­˜çš„è¡Œä¸º&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Connection&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;é€è·³é¦–éƒ¨ã€è¿æ¥çš„ç®¡ç†&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Date&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;åˆ›å»ºæŠ¥æ–‡çš„æ—¥æœŸæ—¶é—´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Pragma&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æŠ¥æ–‡æŒ‡ä»¤&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Trailer&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æŠ¥æ–‡æœ«ç«¯çš„é¦–éƒ¨ä¸€è§ˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Transfer-Encoding&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æŒ‡å®šæŠ¥æ–‡ä¸»ä½“çš„ä¼ è¾“ç¼–ç æ–¹å¼&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Upgrade&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å‡çº§ä¸ºå…¶ä»–åè®®&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Via&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ä»£ç†æœåŠ¡å™¨çš„ç›¸å…³ä¿¡æ¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Warning&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;é”™è¯¯é€šçŸ¥&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;è¯·æ±‚æŠ¥æ–‡å¤´&#34;&gt;è¯·æ±‚æŠ¥æ–‡å¤´&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;é¦–éƒ¨å­—æ®µå&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Accept&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ç”¨æˆ·ä»£ç†å¯å¤„ç†çš„åª’ä½“ç±»å‹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Accept-Charset&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ä¼˜å…ˆçš„å­—ç¬¦é›†&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Accept-Encoding&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ä¼˜å…ˆçš„å†…å®¹ç¼–ç &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Accept-Language&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ä¼˜å…ˆçš„è¯­è¨€ï¼ˆè‡ªç„¶è¯­è¨€ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Authorization&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Web è®¤è¯ä¿¡æ¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Expect&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æœŸå¾…æœåŠ¡å™¨çš„ç‰¹å®šè¡Œä¸º&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;From&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ç”¨æˆ·çš„ç”µå­é‚®ç®±åœ°å€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Host&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è¯·æ±‚èµ„æºæ‰€åœ¨æœåŠ¡å™¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;If-Match&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ¯”è¾ƒå®ä½“æ ‡è®°ï¼ˆETagï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;If-Modified-Since&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ¯”è¾ƒèµ„æºçš„æ›´æ–°æ—¶é—´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;If-None-Match&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ¯”è¾ƒå®ä½“æ ‡è®°ï¼ˆä¸ If-Match ç›¸åï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;If-Range&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;èµ„æºæœªæ›´æ–°æ—¶å‘é€å®ä½“ Byte çš„èŒƒå›´è¯·æ±‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;If-Unmodified-Since&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ¯”è¾ƒèµ„æºçš„æ›´æ–°æ—¶é—´ï¼ˆä¸ If-Modified-Sinceç›¸åï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Max-Forwards&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æœ€å¤§ä¼ è¾“é€è·³æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Proxy-Authorization&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ä»£ç†æœåŠ¡å™¨è¦æ±‚å®¢æˆ·ç«¯çš„è®¤è¯ä¿¡æ¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Range&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å®ä½“çš„å­—èŠ‚èŒƒå›´è¯·æ±‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Referrer&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å¯¹è¯·æ±‚ä¸­ URI çš„åŸå§‹è·å–æ–¹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;TE&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ä¼ è¾“ç¼–ç çš„ä¼˜å…ˆçº§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;User-Agent&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;HTTP å®¢æˆ·ç«¯ç¨‹åºçš„ä¿¡æ¯&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;å“åº”æŠ¥æ–‡å¤´&#34;&gt;å“åº”æŠ¥æ–‡å¤´&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;é¦–éƒ¨å­—æ®µå&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Accept-Ranges&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ˜¯å¦æ¥å—å­—èŠ‚èŒƒå›´è¯·æ±‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Age&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ¨ç®—èµ„æºåˆ›å»ºç»è¿‡æ—¶é—´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ETag&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;èµ„æºçš„åŒ¹é…ä¿¡æ¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Location&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ä»¤å®¢æˆ·ç«¯é‡å®šå‘è‡³æŒ‡å®š URI&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Proxy-Authenticate&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ä»£ç†æœåŠ¡å™¨å¯¹å®¢æˆ·ç«¯çš„è®¤è¯ä¿¡æ¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Retry-After&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å¯¹å†æ¬¡å‘èµ·è¯·æ±‚çš„æ—¶æœºè¦æ±‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Server&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;HTTPæœåŠ¡å™¨çš„å®‰è£…ä¿¡æ¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Vary&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ä»£ç†æœåŠ¡å™¨ç¼“å­˜çš„ç®¡ç†ä¿¡æ¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;WWW-Authenticate&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æœåŠ¡å™¨å¯¹å®¢æˆ·ç«¯çš„è®¤è¯ä¿¡æ¯&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;å®ä½“æŠ¥æ–‡å¤´&#34;&gt;å®ä½“æŠ¥æ–‡å¤´&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;é¦–éƒ¨å­—æ®µå&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Allow&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;èµ„æºå¯æ”¯æŒçš„ HTTP æ–¹æ³•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Content-Encoding&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å®ä½“ä¸»ä½“ä½¿ç”¨çš„ç¼–ç æ–¹å¼&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Content-Language&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å®ä½“ä¸»ä½“çš„è‡ªç„¶è¯­è¨€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Content-Length&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å®ä½“ä¸»ä½“çš„å¤§å°ï¼ˆå•ä½ï¼šå­—èŠ‚ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Content-Location&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ›¿ä»£å¯¹åº”èµ„æºçš„ URI&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Content-MD5&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å®ä½“ä¸»ä½“çš„æŠ¥æ–‡æ‘˜è¦&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Content-Range&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å®ä½“ä¸»ä½“çš„ä½ç½®èŒƒå›´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Content-Type&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å®ä½“ä¸»ä½“çš„åª’ä½“ç±»å‹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Expires&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å®ä½“ä¸»ä½“è¿‡æœŸçš„æ—¥æœŸæ—¶é—´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Last-Modified&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;èµ„æºçš„æœ€åä¿®æ”¹æ—¥æœŸæ—¶é—´&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;accept&#34;&gt;ACCEPT&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ä½œç”¨ï¼š&lt;strong&gt;æµè§ˆå™¨ç«¯å¯ä»¥æ¥å—çš„åª’ä½“ç±»å‹&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Accept:&lt;strong&gt;text/html&lt;/strong&gt; ä»£è¡¨æµè§ˆå™¨å¯ä»¥æ¥å—æœåŠ¡å™¨å›å‘çš„ç±»å‹ä¸º text/html ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„ html æ–‡æ¡£ï¼Œå¦‚æœæœåŠ¡å™¨æ— æ³•è¿”å› text/html ç±»å‹çš„æ•°æ®ï¼ŒæœåŠ¡å™¨åº”è¯¥è¿”å›ä¸€ä¸ª406é”™è¯¯ï¼ˆNon Acceptableï¼‰&lt;/p&gt;
&lt;p&gt;å¦‚æœæƒ³è¦ç»™æ˜¾ç¤ºçš„åª’ä½“ç±»å‹å¢åŠ ä¼˜å…ˆçº§ï¼Œåˆ™ä½¿ç”¨q=æ¥é¢å¤–è¡¨ç¤ºæƒé‡å€¼ï¼‰ï¼›é‡å€¼ q çš„èŒƒå›´æ˜¯0~1ï¼ˆå¯ç²¾ç¡®åˆ°å°æ•°ç‚¹å 3 ä½ï¼‰ï¼Œä¸” 1 ä¸ºæœ€å¤§å€¼ã€‚ä¸æŒ‡å®šæƒé‡ q å€¼æ—¶ï¼Œé»˜è®¤æƒé‡ä¸º q=1.0ã€‚å½“æœåŠ¡å™¨æä¾›å¤šç§å†…å®¹æ—¶ï¼Œå°†ä¼šé¦–å…ˆè¿”å›æƒé‡å€¼æœ€é«˜çš„åª’ä½“ç±»å‹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;accept-encoding&#34;&gt;Accept-Encoding&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ä½œç”¨ï¼šæµè§ˆå™¨ç”³æ˜è‡ªå·±æ¥æ”¶çš„&lt;strong&gt;ç¼–ç æ–¹æ³•&lt;/strong&gt;ï¼Œé€šå¸¸æŒ‡å®š&lt;strong&gt;å‹ç¼©&lt;/strong&gt;æ–¹æ³•ï¼Œæ˜¯å¦æ”¯æŒå‹ç¼©ï¼Œæ”¯æŒä»€ä¹ˆå‹ç¼©æ–¹æ³•ï¼ˆgzipï¼Œdeflateï¼‰
&lt;ul&gt;
&lt;li&gt;Accept-Encoding:gzipï¼Œdeflate&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä½œç”¨ï¼šæµè§ˆå™¨ç”³æ˜è‡ªå·±æ¥æ”¶çš„è¯­è¨€
&lt;ul&gt;
&lt;li&gt;Accept-Language:zh-cn, zh; q=0.7, en-us, en; q=0.3&lt;/li&gt;
&lt;li&gt;å®¢æˆ·ç«¯åœ¨æœåŠ¡å™¨æœ‰ä¸­æ–‡ç‰ˆèµ„æºçš„æƒ…å†µä¸‹ï¼Œä¼šè¯·æ±‚å…¶è¿”å›ä¸­æ–‡ç‰ˆå¯¹åº”çš„å“åº”ï¼Œæ²¡æœ‰ä¸­æ–‡ç‰ˆæ—¶ï¼Œåˆ™è¯·æ±‚è¿”å›è‹±æ–‡ç‰ˆå“åº”&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Connection:keep-alive&lt;/strong&gt; ï¼šå½“ä¸€ä¸ªç½‘é¡µæ‰“å¼€å®Œæˆåï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´&lt;strong&gt;ç”¨äºä¼ è¾“HTTPæ•°æ®çš„TCPè¿æ¥ä¸ä¼šå…³é—­&lt;/strong&gt;ï¼Œå¦‚æœå®¢æˆ·ç«¯å†æ¬¡è®¿é—®è¿™ä¸ªæœåŠ¡å™¨ä¸Šçš„ç½‘é¡µï¼Œä¼šç»§ç»­ä½¿ç”¨è¿™ä¸€æ¡å·²ç»å»ºç«‹çš„è¿æ¥ã€‚&lt;/li&gt;
&lt;li&gt;Connection:close ä»£è¡¨&lt;strong&gt;ä¸€ä¸ªRequest&lt;/strong&gt;å®Œæˆåï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ç”¨äºä¼ è¾“HTTPæ•°æ®çš„TCPè¿æ¥ä¼šå…³é—­ï¼Œå½“å®¢æˆ·ç«¯å†æ¬¡å‘é€Requestï¼Œéœ€è¦é‡æ–°å»ºç«‹TCPè¿æ¥&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;host&#34;&gt;Host&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ä½œç”¨ï¼šè¯·æ±‚æŠ¥å¤´åŸŸä¸»è¦ç”¨äºæŒ‡å®šè¢«è¯·æ±‚èµ„æºçš„ &lt;strong&gt;Internetä¸»æœºå’Œç«¯å£å·&lt;/strong&gt;ï¼Œå®ƒé€šå¸¸ä»HTTP URLä¸­æå–å‡ºæ¥çš„&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ï¼šhttp://www.fljf.com:8080 åˆ˜è§ˆå™¨å‘é€çš„è¯·æ±‚æ¶ˆæ¯ä¸­ï¼Œå°±ä¼šåŒ…å«Hostè¯·æ±‚æŠ¥å¤´åŸŸï¼Œå¦‚ä¸‹ï¼šHostï¼šwww.fljf.com:8080&lt;/p&gt;
&lt;h2 id=&#34;referer&#34;&gt;Referer&lt;/h2&gt;
&lt;p&gt;å½“æµè§ˆå™¨å‘webæœåŠ¡å™¨å‘é€è¯·æ±‚çš„æ—¶å€™ï¼Œä¸€èˆ¬ä¼šå¸¦ä¸ŠRefererï¼Œå‘Šè¯‰æœåŠ¡å™¨æˆ‘æ˜¯ä»å“ªä¸ªé¡µé¢é“¾æ¥è¿‡æ¥çš„ï¼ŒæœåŠ¡å™¨ç±æ­¤å¯ä»¥è·å¾—ä¸€äº›ä¿¡æ¯ç”¨äºå¤„ç†&lt;/p&gt;
&lt;h2 id=&#34;user-agent&#34;&gt;User-Agent&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ä½œç”¨ï¼šå‘Šè¯‰HTTPæœåŠ¡å™¨ï¼Œå®¢æˆ·ç«¯ä½¿ç”¨çš„æ“ä½œç³»ç»Ÿå’Œæµè§ˆå™¨çš„åç§°å’Œç‰ˆæœ¬&lt;/li&gt;
&lt;li&gt;å¾ˆå¤šæƒ…å†µä¸‹æˆ‘ä»¬ä¼šé€šè¿‡User-Agnetæ¥åˆ¤æ–­æµè§ˆå™¨ç±»å‹ï¼Œä»è€Œè¿›è¡Œä¸åŒçš„å…¼å®¹è®¾è®¡&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;content-type&#34;&gt;Content-Type&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ä½œç”¨ï¼šè¯´æ˜äº†æŠ¥æ–‡ä½“å†…å¯¹è±¡çš„åª’ä½“ç±»å‹&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;text/htmlï¼šHTMLæ ¼å¼&lt;/p&gt;
&lt;p&gt;text/plainï¼šçº¯æ–‡æœ¬æ ¼å¼&lt;/p&gt;
&lt;p&gt;text/xmlï¼šXMLæ ¼å¼&lt;/p&gt;
&lt;p&gt;image/gifï¼šgifå›¾ç‰‡æ ¼å¼&lt;/p&gt;
&lt;p&gt;image/jpegï¼šjpgå›¾ç‰‡æ ¼å¼&lt;/p&gt;
&lt;p&gt;image/pngï¼špngå›¾ç‰‡æ ¼å¼&lt;/p&gt;
&lt;p&gt;application/xhtml+xmlï¼šXHTMLæ ¼å¼&lt;/p&gt;
&lt;p&gt;application/xmlï¼šXMLæ•°æ®æ ¼å¼&lt;/p&gt;
&lt;p&gt;application/atom+xmlï¼šAtom XMLèšåˆæ ¼å¼&lt;/p&gt;
&lt;p&gt;application/jsonï¼šJSONæ•°æ®æ ¼å¼&lt;/p&gt;
&lt;p&gt;application/pdfï¼špdfæ ¼å¼&lt;/p&gt;
&lt;p&gt;application/mswordï¼šWordæ–‡æ¡£æ ¼å¼&lt;/p&gt;
&lt;p&gt;application/octet-streamï¼šäºŒè¿›åˆ¶æµæ•°æ®ï¼ˆå¦‚å¸¸è§çš„æ–‡ä»¶ä¸‹è½½ï¼‰&lt;/p&gt;
&lt;p&gt;application/x-www-form-urlencodedï¼šè¡¨å•æäº¤&lt;/p&gt;
&lt;h1 id=&#34;http-æŠ¥æ–‡ç»“æ„åˆ†æ-å“åº”æŠ¥æ–‡&#34;&gt;HTTP æŠ¥æ–‡ç»“æ„åˆ†æ - å“åº”æŠ¥æ–‡&lt;/h1&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%93%8D%E5%BA%94%E6%8A%A5%E6%96%87.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h1 id=&#34;http-è¯·æ±‚æ–¹æ³•å‰–æ&#34;&gt;HTTP è¯·æ±‚æ–¹æ³•å‰–æ&lt;/h1&gt;
&lt;p&gt;HTTP/1.1å¸¸ç”¨æ–¹æ³•&lt;/p&gt;
&lt;p&gt;â‘ GET&lt;/p&gt;
&lt;p&gt;â‘¡ POST&lt;/p&gt;
&lt;p&gt;â‘¢ PUT&lt;/p&gt;
&lt;p&gt;â‘£HEAD&lt;/p&gt;
&lt;p&gt;â‘¤ DELETE&lt;/p&gt;
&lt;p&gt;â‘¥OPTIONS&lt;/p&gt;
&lt;p&gt;â‘¦TRACE&lt;/p&gt;
&lt;p&gt;â‘¢ CONNECT&lt;/p&gt;
&lt;h2 id=&#34;get-è·å–èµ„æº&#34;&gt;GET è·å–èµ„æº&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;GETæ–¹æ³•ç”¨æ¥è¯·æ±‚è®¿é—®å·²è¢«URIè¯†åˆ«çš„èµ„æº&lt;/li&gt;
&lt;li&gt;æŒ‡å®šçš„èµ„æºç»æœåŠ¡å™¨ç«¯è§£æåè¿”å›å“åº”å†…å®¹&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/GET%E8%AF%B7%E6%B1%82.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;GETæ–¹æ³•ä¹Ÿå¯ä»¥ç”¨æ¥æäº¤è¡¨å•å’Œå…¶ä»–æ•°æ®&lt;/li&gt;
&lt;li&gt;http://localhost/login.php?username=aa&amp;amp;password=1234 ä»ä¸Šé¢çš„ URL è¯·æ±‚ä¸­ï¼Œå¾ˆå®¹æ˜“å°±å¯ä»¥è¾©è®¤å‡ºè¡¨å•æäº¤çš„å†…å®¹&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;post&#34;&gt;POST&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;POST æ–¹æ³•ä¸ GET åŠŸèƒ½ç±»ä¼¼ï¼Œä¸€èˆ¬ç”¨æ¥&lt;strong&gt;ä¼ è¾“å®ä½“çš„ä¸»ä½“&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;POST æ–¹æ³•çš„ä¸»è¦ç›®çš„ä¸æ˜¯è·å–å“åº”ä¸»ä½“çš„å†…å®¹&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/POST%E8%AF%B7%E6%B1%82.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;è¯´ä¸‹-get-å’Œ-post-çš„åŒºåˆ«&#34;&gt;è¯´ä¸‹ GET å’Œ POST çš„åŒºåˆ«ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;GET å’Œ POST æœ¬è´¨éƒ½æ˜¯ HTTP è¯·æ±‚ï¼Œåªä¸è¿‡å¯¹å®ƒä»¬çš„ä½œç”¨åšäº†ç•Œå®šå’Œé€‚é…ï¼Œå¹¶ä¸”è®©ä»–ä»¬é€‚åº”å„è‡ªçš„åœºæ™¯ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æœ¬è´¨åŒºåˆ«ï¼šGET åªæ˜¯ä¸€æ¬¡ HTTPè¯·æ±‚ï¼ŒPOST å…ˆå‘è¯·æ±‚å¤´å†å‘è¯·æ±‚ä½“ï¼Œå®é™…ä¸Šæ˜¯ä¸¤æ¬¡è¯·æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;ä»åŠŸèƒ½ä¸Šè®²ï¼ŒGET ä¸€èˆ¬ç”¨æ¥&lt;strong&gt;ä»æœåŠ¡å™¨ä¸Šè·å–èµ„æº&lt;/strong&gt;ï¼ŒPOST ä¸€èˆ¬ç”¨æ¥&lt;strong&gt;æ›´æ–°æœåŠ¡å™¨ä¸Šçš„èµ„æº&lt;/strong&gt;ï¼›&lt;/li&gt;
&lt;li&gt;ä» REST æœåŠ¡è§’åº¦ä¸Šè¯´ï¼Œ&lt;strong&gt;GET æ˜¯å¹‚ç­‰&lt;/strong&gt;çš„ï¼Œå³è¯»å–åŒä¸€ä¸ªèµ„æºï¼Œæ€»æ˜¯å¾—åˆ°ç›¸åŒçš„æ•°æ®ï¼Œè€Œ &lt;strong&gt;POST ä¸æ˜¯å¹‚ç­‰&lt;/strong&gt;çš„ï¼Œå› ä¸ºæ¯æ¬¡è¯·æ±‚å¯¹èµ„æºçš„æ”¹å˜å¹¶ä¸æ˜¯ç›¸åŒçš„ï¼›è¿›ä¸€æ­¥åœ°ï¼ŒGET ä¸ä¼šæ”¹å˜æœåŠ¡å™¨ä¸Šçš„èµ„æºï¼Œè€Œ POST ä¼šå¯¹æœåŠ¡å™¨èµ„æºè¿›è¡Œæ”¹å˜ï¼›&lt;/li&gt;
&lt;li&gt;ä»è¯·æ±‚å‚æ•°å½¢å¼ä¸Šçœ‹ï¼Œ&lt;strong&gt;GET è¯·æ±‚çš„æ•°æ®ä¼šé™„åœ¨ URL ä¹‹å&lt;/strong&gt;ï¼Œå³å°†è¯·æ±‚æ•°æ®æ”¾ç½®åœ¨ HTTP æŠ¥æ–‡çš„ è¯·æ±‚å¤´ ä¸­ï¼Œä»¥ ? åˆ†å‰² URL å’Œä¼ è¾“æ•°æ®ï¼Œå‚æ•°ä¹‹é—´ä»¥ &amp;amp; ç›¸è¿ã€‚ç‰¹åˆ«åœ°ï¼Œå¦‚æœæ•°æ®æ˜¯è‹±æ–‡å­—æ¯/æ•°å­—ï¼ŒåŸæ ·å‘é€ï¼›å¦åˆ™ï¼Œä¼šå°†å…¶ç¼–ç ä¸º application/x-www-form-urlencoded MIME å­—ç¬¦ä¸²(å¦‚æœæ˜¯ç©ºæ ¼ï¼Œè½¬æ¢ä¸º+ï¼Œå¦‚æœæ˜¯ä¸­æ–‡/å…¶ä»–å­—ç¬¦ï¼Œåˆ™ç›´æ¥æŠŠå­—ç¬¦ä¸²ç”¨ BASE64 åŠ å¯†ï¼Œå¾—å‡ºå¦‚ï¼š%E4%BD%A0%E5%A5%BDï¼Œå…¶ä¸­ ï¼…XX ä¸­çš„ XX ä¸ºè¯¥ç¬¦å·ä»¥ 16 è¿›åˆ¶è¡¨ç¤ºçš„ ASCII)ï¼›è€Œ **POST è¯·æ±‚ä¼šæŠŠæäº¤çš„æ•°æ®åˆ™æ”¾ç½®åœ¨æ˜¯ HTTP è¯·æ±‚æŠ¥æ–‡çš„ **&lt;strong&gt;è¯·æ±‚ä½“&lt;/strong&gt; ä¸­ï¼›&lt;/li&gt;
&lt;li&gt;å°±å®‰å…¨æ€§è€Œè¨€ï¼Œ&lt;strong&gt;POST çš„å®‰å…¨æ€§è¦æ¯” GET çš„å®‰å…¨æ€§é«˜&lt;/strong&gt;ï¼Œå› ä¸º GET è¯·æ±‚æäº¤çš„æ•°æ®å°†æ˜æ–‡å‡ºç°åœ¨ URL ä¸Šï¼Œè€Œä¸” POST è¯·æ±‚å‚æ•°åˆ™è¢«åŒ…è£…åˆ°è¯·æ±‚ä½“ä¸­ï¼Œç›¸å¯¹æ›´å®‰å…¨ï¼›&lt;/li&gt;
&lt;li&gt;ä»è¯·æ±‚çš„å¤§å°çœ‹ï¼ŒGET è¯·æ±‚çš„é•¿åº¦å—é™äºæµè§ˆå™¨æˆ–æœåŠ¡å™¨å¯¹ URL é•¿åº¦çš„é™åˆ¶ï¼Œå…è®¸å‘é€çš„æ•°æ®é‡æ¯”è¾ƒå°ï¼Œè€Œ POST è¯·æ±‚åˆ™æ˜¯æ²¡æœ‰å¤§å°é™åˆ¶çš„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;put&#34;&gt;PUT&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ä»å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ä¼ é€çš„æ•°æ®&lt;strong&gt;å–ä»£æŒ‡å®šçš„æ–‡æ¡£çš„å†…å®¹&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;PUTæ–¹æ³•ä¸POSTæ–¹æ³•æœ€å¤§çš„ä¸åŒæ˜¯ï¼šPUTæ˜¯å¹‚ç­‰çš„ï¼Œè€ŒPOSTæ˜¯ä¸å¹‚ç­‰çš„&lt;/li&gt;
&lt;li&gt;å› æ­¤ï¼Œæˆ‘ä»¬æ›´å¤šæ—¶å€™å°†PUTæ–¹æ³•ç”¨ä½œä¼ è¾“èµ„æº&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;åˆ›å»ºå¯¹è±¡ç”¨ POSTï¼Œæ›´æ–°å¯¹è±¡ç”¨ PUTã€‚&lt;br&gt;
ä½†æ˜¯ï¼ŒHTTP1.1 çš„ PUT æ–¹æ³•ä¸å¸¦æœ‰éªŒè¯æœºåˆ¶ï¼Œå­˜åœ¨ä¸€å®šçš„å®‰å…¨é—®é¢˜ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸ä½¿ç”¨ PUTï¼Œæ›´æ–°å¯¹è±¡å¯ä»¥ä½¿ç”¨ POST è¯·æ±‚ï¼Œç„¶ååœ¨åç«¯ä»£ç é€»è¾‘å¤„ç†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;headdelete&#34;&gt;HEAD/DELETE&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;HEADç±»ä¼¼äºGETè¯·æ±‚ï¼Œåªä¸è¿‡è¿”å›çš„å“åº”ä¸­æ²¡æœ‰å…·ä½“çš„å†…å®¹ï¼Œç”¨äº&lt;strong&gt;è·å–æŠ¥å¤´&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;DELETEè¯·æ±‚æœåŠ¡å™¨åˆ é™¤æŒ‡å®šçš„èµ„æºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;DELETE æ–¹æ³•æ²¡æœ‰éªŒè¯æœºåˆ¶ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;options&#34;&gt;OPTIONS&lt;/h2&gt;
&lt;p&gt;ç”¨æ¥æŸ¥è¯¢é’ˆå¯¹è¯·æ±‚URIæŒ‡å®šçš„èµ„æºæ”¯æŒçš„æ–¹æ³•&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸çŸ¥é“å¯¹æ–¹æ”¯æŒä»€ä¹ˆæ–¹æ³•ï¼Œè¯¢é—®ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/OPTIONS%E8%AF%B7%E6%B1%82.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;traceconnect&#34;&gt;TRACE/CONNECT&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;TRACEï¼šå›æ˜¾æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ï¼Œä¸»è¦ç”¨äºæµ‹è¯•æˆ–è¯Šæ–­&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;å®¹æ˜“å¼•å‘ XSP æ”»å‡»ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸ä½¿ç”¨ TRACE è¯·æ±‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;CONNECTï¼šå¼€å¯ä¸€ä¸ªå®¢æˆ·ç«¯ä¸æ‰€è¯·æ±‚èµ„æºä¹‹é—´çš„åŒå‘æ²Ÿé€šçš„é€šé“ï¼Œå®ƒå¯ä»¥ç”¨æ¥åˆ›å»ºéš§é“&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ä»£ç†æœåŠ¡å™¨è®¿é—®äº’è”ç½‘æ—¶ï¼Œå°±æ˜¯ç”¨ CONNECT æ–¹æ³•ã€‚&lt;br&gt;
æµè§ˆå™¨å‘ä»£ç†æœåŠ¡å™¨å‘é€ CONNECT è¯·æ±‚ï¼Œä»£ç†æœåŠ¡å™¨è¿”å›çŠ¶æ€ç  200ï¼Œæµè§ˆå™¨å°±å’ŒæœåŠ¡å™¨ä¸‰æ¬¡æ¡æ‰‹äº¤æ¢æ•°æ®ï¼Œä»£ç†æœåŠ¡å™¨åªè´Ÿè´£ä¼ è¾“å½¼æ­¤çš„æ•°æ®åŒ…ï¼Œå¹¶ä¸èƒ½è¯»å–æ•°æ®å†…å®¹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&#34;çŠ¶æ€ç &#34;&gt;çŠ¶æ€ç &lt;/h1&gt;
&lt;p&gt;æ˜¯ç”¨ä»¥è¡¨ç¤ºç½‘é¡µæœåŠ¡å™¨è¶…æ–‡æœ¬ä¼ è¾“åè®®å“åº”çŠ¶æ€çš„3ä½æ•°å­—ä»£ç ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E7%8A%B6%E6%80%81%E7%A0%81.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;http-çŠ¶æ€ç è¯¦è§£&#34;&gt;HTTP çŠ¶æ€ç è¯¦è§£&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;åˆ†ç±»&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;å«ä¹‰&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;1XX&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è¡¨ç¤ºæ¶ˆæ¯ã€‚è¿™ä¸€ç±»å‹çš„çŠ¶æ€ç ï¼Œä»£è¡¨è¯·æ±‚å·²è¢«æ¥å—ï¼Œéœ€è¦ç»§ç»­å¤„ç†ã€‚è¿™ç±»å“åº”æ˜¯ä¸´æ—¶å“åº”ï¼ŒåªåŒ…å«çŠ¶æ€è¡Œå’ŒæŸäº›å¯é€‰çš„å“åº”å¤´ä¿¡æ¯ï¼Œå¹¶ä»¥ç©ºè¡Œç»“æŸã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;2XX&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è¡¨ç¤º&lt;strong&gt;æˆåŠŸ&lt;/strong&gt;ã€‚è¿™ä¸€ç±»å‹çš„çŠ¶æ€ç ï¼Œä»£è¡¨è¯·æ±‚å·²æˆåŠŸè¢«æœåŠ¡å™¨æ¥æ”¶ã€ç†è§£ã€å¹¶æ¥å—ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;3XX&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è¡¨ç¤º&lt;strong&gt;é‡å®šå‘&lt;/strong&gt;ã€‚è¿™ç±»çŠ¶æ€ç ä»£è¡¨éœ€è¦å®¢æˆ·ç«¯é‡‡å–è¿›ä¸€æ­¥çš„æ“ä½œæ‰èƒ½å®Œæˆè¯·æ±‚ã€‚é€šå¸¸ï¼Œè¿™äº›çŠ¶æ€ç ç”¨æ¥é‡å®šå‘ï¼Œåç»­çš„è¯·æ±‚åœ°å€ï¼ˆé‡å®šå‘ç›®æ ‡ï¼‰åœ¨æœ¬æ¬¡å“åº”çš„LocationåŸŸä¸­æŒ‡æ˜ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;4XX&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è¡¨ç¤º&lt;strong&gt;è¯·æ±‚é”™è¯¯&lt;/strong&gt;ã€‚è¿™ç±»çš„çŠ¶æ€ç ä»£è¡¨äº†å®¢æˆ·ç«¯çœ‹èµ·æ¥å¯èƒ½å‘ç”Ÿäº†é”™è¯¯ï¼Œå¦¨ç¢äº†æœåŠ¡å™¨çš„å¤„ç†ã€‚é™¤éå“åº”çš„æ˜¯ä¸€ä¸ªHEADè¯·æ±‚ï¼Œå¦åˆ™æœåŠ¡å™¨å°±åº”è¯¥è¿”å›ä¸€ä¸ªè§£é‡Šå½“å‰é”™è¯¯çŠ¶å†µçš„å®ä½“ï¼Œä»¥åŠè¿™æ˜¯ä¸´æ—¶çš„è¿˜æ˜¯æ°¸ä¹…æ€§çš„çŠ¶å†µã€‚è¿™äº›çŠ¶æ€ç é€‚ç”¨äºä»»ä½•è¯·æ±‚æ–¹æ³•ã€‚æµè§ˆå™¨åº”å½“å‘ç”¨æˆ·æ˜¾ç¤ºä»»ä½•åŒ…å«åœ¨æ­¤ç±»é”™è¯¯å“åº”ä¸­çš„å®ä½“å†…å®¹ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;5XX&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è¡¨ç¤º&lt;strong&gt;æœåŠ¡å™¨é”™è¯¯&lt;/strong&gt;ã€‚è¿™ç±»çŠ¶æ€ç ä»£è¡¨äº†æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚çš„è¿‡ç¨‹ä¸­æœ‰é”™è¯¯æˆ–è€…å¼‚å¸¸çŠ¶æ€å‘ç”Ÿï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯æœåŠ¡å™¨æ„è¯†åˆ°ä»¥å½“å‰çš„è½¯ç¡¬ä»¶èµ„æºæ— æ³•å®Œæˆå¯¹è¯·æ±‚çš„å¤„ç†ã€‚é™¤éè¿™æ˜¯ä¸€ä¸ªHEADè¯·æ±‚ï¼Œå¦åˆ™æœåŠ¡å™¨åº”å½“åŒ…å«ä¸€ä¸ªè§£é‡Šå½“å‰é”™è¯¯çŠ¶æ€ä»¥åŠè¿™ä¸ªçŠ¶å†µæ˜¯ä¸´æ—¶çš„è¿˜æ˜¯æ°¸ä¹…çš„è§£é‡Šä¿¡æ¯å®ä½“ã€‚æµè§ˆå™¨åº”å½“å‘ç”¨æˆ·å±•ç¤ºä»»ä½•åœ¨å½“å‰å“åº”ä¸­è¢«åŒ…å«çš„å®ä½“ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;å¸¸ç”¨httpçŠ¶æ€ç &#34;&gt;å¸¸ç”¨HTTPçŠ¶æ€ç &lt;/h3&gt;
&lt;p&gt;2XX çŠ¶æ€ç ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;çŠ¶æ€ç &lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;çŠ¶æ€ç è‹±æ–‡åç§°&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;æè¿°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;200&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;OK&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è¯·æ±‚å·²æˆåŠŸï¼Œè¯·æ±‚æ‰€å¸Œæœ›çš„å“åº”å¤´æˆ–æ•°æ®ä½“å°†éšæ­¤å“åº”è¿”å›&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;202&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Accepted&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å·²æ¥å—ï¼Œå·²ç»æ¥å—è¯·æ±‚ï¼Œä½†æœªå¤„ç†å®Œæˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;206&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Partial Content&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;éƒ¨åˆ†å†…å®¹ï¼ŒæœåŠ¡å™¨æˆåŠŸå¤„ç†äº†éƒ¨åˆ†GETè¯·æ±‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;3XX çŠ¶æ€ç ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;çŠ¶æ€ç &lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;çŠ¶æ€ç è‹±æ–‡åç§°&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;æè¿°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;301&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Moved Permanently&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;&lt;strong&gt;æ°¸ä¹…ç§»åŠ¨&lt;/strong&gt;ï¼Œè¯·æ±‚çš„èµ„æºå·²è¢«æ°¸ä¹…çš„ç§»åŠ¨åˆ°æ–°URIï¼Œè¿”å›ä¿¡æ¯ä¼šåŒ…æ‹¬æ–°çš„URIï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å®šå‘åˆ°æ–°URIã€‚ä»Šåä»»ä½•æ–°çš„è¯·æ±‚éƒ½åº”ä½¿ç”¨æ–°çš„URIä»£æ›¿ï¼ˆ&lt;strong&gt;æ›´æ¢åŸŸå&lt;/strong&gt;ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;302&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Found&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ä¸´æ—¶ç§»åŠ¨ï¼Œä¸301ç±»ä¼¼ã€‚ä½†èµ„æºåªæ˜¯ä¸´æ—¶è¢«ç§»åŠ¨ã€‚å®¢æˆ·ç«¯åº”ç»§ç»­ä½¿ç”¨åŸæœ‰URI&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;4XX çŠ¶æ€ç ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;çŠ¶æ€ç &lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;çŠ¶æ€ç è‹±æ–‡åç§°&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;æè¿°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;400&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Bad Request&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å®¢æˆ·ç«¯è¯·æ±‚çš„è¯­æ³•é”™è¯¯ï¼ŒæœåŠ¡å™¨æ— æ³•ç†è§£&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;401&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Unauthorized&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è¯·æ±‚è¦æ±‚ç”¨æˆ·çš„èº«ä»½è®¤è¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;403&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Forbidden&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æœåŠ¡å™¨ç†è§£è¯·æ±‚å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æ‰§è¡Œæ­¤è¯·æ±‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;404&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Not Found&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æœåŠ¡å™¨æ— æ³•æ ¹æ®å®¢æˆ·ç«¯çš„è¯·æ±‚æ‰¾åˆ°èµ„æºï¼ˆç½‘é¡µï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;5XX çŠ¶æ€ç ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;çŠ¶æ€ç &lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;çŠ¶æ€ç è‹±æ–‡åç§°&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;æè¿°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;500&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Internal Server Error&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼Œæ— æ³•å®Œæˆè¯·æ±‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;502&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Bad Gateway&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å……å½“ç½‘å…³æˆ–ä»£ç†çš„æœåŠ¡å™¨ï¼Œä»è¿œç«¯æœåŠ¡å™¨æ¥æ”¶åˆ°äº†ä¸€ä¸ªæ— æ•ˆçš„è¯·æ±‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;httpçŠ¶æ€ç®¡ç†cookieä¸session&#34;&gt;HTTPçŠ¶æ€ç®¡ç†ï¼šCookieä¸Session&lt;/h1&gt;
&lt;p&gt;HTTP æ˜¯æ— çŠ¶æ€åè®®ï¼Œæ¯ä¸ªè¯·æ±‚éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œå¦‚æœåç»­å¤„ç†éœ€è¦å‰é¢çš„ä¿¡æ¯ï¼Œå¿…é¡»é‡ä¼ ï¼Œå°±ä¼šå¯¼è‡´è¿æ¥ä¼ é€çš„æ•°æ®é‡å¢å¤§ï¼Œäºæ˜¯å¼•å…¥ Cookie å’Œ Session ä¿å­˜ HTTP è¿æ¥çŠ¶æ€ã€‚&lt;/p&gt;
&lt;h2 id=&#34;cookie&#34;&gt;Cookie&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Cookieå®é™…ä¸Šæ˜¯ä¸€å°æ®µçš„æ–‡æœ¬ä¿¡æ¯ã€‚å®¢æˆ·ç«¯è¯·æ±‚æœåŠ¡å™¨ï¼Œå¦‚æœæœåŠ¡å™¨éœ€è¦è®°å½•è¯¥ç”¨æˆ·çŠ¶æ€ï¼Œå°±å‘å®¢æˆ·ç«¯æµè§ˆå™¨é¢å‘ä¸€ä¸ªCookieã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¢æˆ·ç«¯æµè§ˆå™¨&lt;/strong&gt;ä¼šæŠŠCookieä¿å­˜èµ·æ¥ã€‚å½“æµè§ˆå™¨å†è¯·æ±‚è¯¥ç½‘ç«™æ—¶ï¼Œæµè§ˆå™¨æŠŠè¯·æ±‚çš„ç½‘å€è¿åŒè¯¥Cookieä¸€åŒæäº¤ç»™æœåŠ¡å™¨ã€‚æœåŠ¡å™¨æ£€æŸ¥è¯¥Cookieï¼Œä»¥æ­¤æ¥è¾¨è®¤ç”¨æˆ·çŠ¶æ€&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/cookie.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥ www.baidu.com ï¼Œæµè§ˆå™¨å‘ç™¾åº¦æœåŠ¡å™¨å‘é€è¯»å–ç½‘é¡µçš„è¯·æ±‚ï¼Œå¹¶ä¸”æŠŠç»“æœæ˜¾ç¤ºå›æ˜¾ç¤ºå™¨ä¸Šã€‚&lt;br&gt;
å‘é€ä¹‹å‰ï¼Œè¿™ä¸ªç½‘é¡µåœ¨æœ¬æœºç”µè„‘ä¸Šå¯»æ‰¾ç™¾åº¦ç½‘ç«™è®¾ç½®çš„ cookie æ–‡ä»¶ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œæµè§ˆå™¨ä¼šæŠŠ cookie æ–‡ä»¶ä¸­çš„æ•°æ®è¿åŒ url ä¸€åŒå‘é€ç»™ç™¾åº¦æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨æ”¶åˆ°æ•°æ®ï¼Œå°±ä¼šåœ¨å®ƒçš„æ•°æ®åº“ä¸­æ£€ç´¢ idã€æœç´¢è®°å½•ç­‰ä¿¡æ¯ï¼Œå¹¶ä¸”è®°å½•ä¸‹è¿™æ¬¡æ–°çš„å†…å®¹ï¼Œå¢åŠ åˆ°æ•°æ®åº“å’Œ cookie æ–‡ä»¶ä¸­ã€‚å¦‚æœæ²¡æœ‰æ£€æµ‹åˆ° cookieï¼Œæˆ–è€… cookie ä¿¡æ¯ä¸æ•°æ®åº“ä¿¡æ¯ä¸ç¬¦åˆï¼Œè¯´æ˜è¿™æ˜¯ç¬¬ä¸€æ¬¡æµè§ˆè¿™ä¸ªç½‘ç«™ï¼ŒæœåŠ¡å™¨å°±ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ idï¼Œå¹¶ä¸”ä¿å­˜åˆ°æ•°æ®åº“ï¼Œå¹¶ç»™æµè§ˆå™¨ä¸‹å‘ä¸€ä¸ª cookieï¼Œè¿™æ ·ä¸‹ä¸€æ¬¡è®¿é—®å°±ä¼šåƒå‰é¢æè¿°çš„é‚£æ ·æŸ¥åˆ° cookie è®°å½•äº†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;cookie-å·¥ä½œåŸç†&#34;&gt;Cookie å·¥ä½œåŸç†&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;9&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/cookie%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;1.æµè§ˆå™¨å‘é€è¯·æ±‚åˆ°æœåŠ¡å™¨&lt;/p&gt;
&lt;p&gt;2.å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡è®¿é—®è¿™ä¸ªæœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨ set-cookie&lt;/p&gt;
&lt;p&gt;3.æœåŠ¡å™¨é€šè¿‡ set-cookie è¿™æ ·çš„ä¸€ä¸ªå“åº”å¤´æŠŠ cookie å‘é€ç»™å®¢æˆ·ç«¯&lt;/p&gt;
&lt;p&gt;4.å®¢æˆ·ç«¯è¯»å–åˆ° set-cookie ä¹‹åï¼ŒæŠŠ cookie å­˜å‚¨åˆ°æœ¬åœ°çš„æ–‡æœ¬æ–‡ä»¶ä¸­&lt;/p&gt;
&lt;p&gt;5.å†æ¬¡å‘é€è¯·æ±‚ï¼Œä¼šæŠŠ cookie ä¸€èµ·å‘é€åˆ°æœåŠ¡å™¨ç«¯&lt;/p&gt;
&lt;p&gt;6.æœåŠ¡å™¨æ¥æ”¶åˆ°è¿™ä¸ª cookieï¼Œæ£€æŸ¥ cookieï¼Œè¯æ˜æ²¡é—®é¢˜ï¼Œç¡®å®æ˜¯æˆ‘å·²ç»å­˜åœ¨çš„ç”¨æˆ·äº†ï¼Œè¿”å›å“åº”ç»“æœã€‚&lt;/p&gt;
&lt;h2 id=&#34;session&#34;&gt;Session&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Sessionæ˜¯å¦ä¸€ç§è®°å½•å®¢æˆ·çŠ¶æ€çš„æœºåˆ¶ï¼Œä¿å­˜åœ¨æœåŠ¡å™¨ä¸Šã€‚å®¢æˆ·ç«¯æµè§ˆå™¨è®¿é—®æœåŠ¡å™¨çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨æŠŠå®¢æˆ·ç«¯ä¿¡æ¯ä»¥æŸç§å½¢å¼è®°å½•åœ¨æœåŠ¡å™¨ä¸Š&lt;/li&gt;
&lt;li&gt;å®¢æˆ·ç«¯æµè§ˆå™¨å†æ¬¡è®¿é—®æ—¶åªéœ€è¦ä»è¯¥Sessionä¸­æŸ¥æ‰¾è¯¥å®¢æˆ·çš„çŠ¶æ€å°±å¯ä»¥äº†&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;##Session å·¥ä½œåŸç†&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/session%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç”¨æˆ·è®¿é—®ä¸€ä¸ªæœåŠ¡å™¨ï¼Œå¦‚æœæœåŠ¡å™¨å¯ç”¨ sessionï¼ŒæœåŠ¡å™¨å°±è¦ä¸ºè¿™ä¸ªç”¨æˆ·åˆ›å»ºä¸€ä¸ª sessionï¼Œåœ¨åˆ›å»ºè¿™ä¸ª session çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨é¦–å…ˆæ£€æŸ¥è¿™ä¸ªç”¨æˆ·å‘æ¥çš„è¯·æ±‚é‡Œï¼Œæ˜¯å¦åŒ…å«ä¸€ä¸ª sessionIDï¼Œå¦‚æœåŒ…å«äº†ï¼Œå°±è¯´æ˜è¿™ä¸ªç”¨æˆ·æ­¤å‰å·²ç»ç™»é™†è¿‡ï¼Œå¹¶ä¸”å·²ç»åˆ›å»ºè¿‡ sessionï¼Œå°±æŒ‰ç…§è¿™ä¸ª sessionID æŠŠ session ä»æœåŠ¡å™¨çš„å†…å­˜ä¸­æŸ¥æ‰¾å‡ºæ¥ã€‚å¦‚æœæŸ¥æ‰¾ä¸åˆ°æˆ–å®¢æˆ·ç«¯è¯·æ±‚å°±ä¸åŒ…å«è¿™ä¸ª sessionIDï¼Œå°±ä¸ºè¿™ä¸ªå®¢æˆ·ç«¯åˆ›å»ºä¸€ä¸ªæ–°çš„ sessionï¼Œå¹¶ä¸”ç”Ÿæˆä¸€ä¸ªä¸æ­¤ session ç›¸å…³çš„ sessionIDï¼Œè¿™ä¸ª sessionID åœ¨æœåŠ¡ç«¯æ˜¯å”¯ä¸€çš„ï¼Œè¿™ä¸ª sessionIDä¼šåœ¨è¿™ä¸€æ¬¡å“åº”ä¸­è¿”å›åˆ°å®¢æˆ·ç«¯è¿›è¡Œä¿å­˜ï¼Œä¿å­˜è¿™ä¸ª sessionID çš„æ­£æ˜¯ cookieã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;ä¿å­˜session-idçš„æ–¹å¼&#34;&gt;ä¿å­˜Session IDçš„æ–¹å¼&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Cookie&lt;/li&gt;
&lt;li&gt;URLé‡å†™ï¼š
&lt;ul&gt;
&lt;li&gt;https://.../xxx?sessionID=BpRZx3lQx33ccEoU6QZcEb64ï¼ˆå‚æ•°ï¼‰&lt;/li&gt;
&lt;li&gt;https://.../xxx;SessionID=BpRZx3lQx33ccEoU6QZcEb64ï¼ˆè·¯å¾„é™„åŠ ä¿¡æ¯ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;éšè—è¡¨å•&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;sessionçš„æœ‰æ•ˆæœŸ&#34;&gt;Sessionçš„æœ‰æ•ˆæœŸ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Sessionè¶…æ—¶å¤±æ•ˆ
&lt;ul&gt;
&lt;li&gt;æœåŠ¡å™¨ç©ºé—´æœ‰é™ï¼Œè®¾ç½® session æœ‰æ•ˆæ—¶é—´ï¼Œé˜²æ­¢æ›´å¤šçš„ç”¨æˆ·è®¿é—®é€ æˆæœåŠ¡å™¨å†…å­˜æº¢å‡º&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç¨‹åºè°ƒç”¨HttpSession.invalidate()
&lt;ul&gt;
&lt;li&gt;ç‚¹å‡»é€€å‡ºï¼Œæ‰‹åŠ¨è°ƒç”¨ session å¤±æ•ˆæ–¹æ³•&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æœåŠ¡å™¨è¿›ç¨‹è¢«åœæ­¢&lt;/li&gt;
&lt;li&gt;Cokie ä¸ Sessionç†å­˜æ”¾ä½ç½®ä¸åŒ
&lt;ul&gt;
&lt;li&gt;Cookie ä¿å­˜åœ¨å®¢æˆ·ç«¯&lt;/li&gt;
&lt;li&gt;Session ä¿å­˜åœ¨æœåŠ¡ç«¯&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å®‰å…¨æ€§ï¼ˆéšç§ç­–ç•¥ï¼‰çš„ä¸åŒ
&lt;ul&gt;
&lt;li&gt;Cookie å­˜å‚¨åœ¨æµè§ˆå™¨ï¼Œå¯¹å®¢æˆ·ç«¯å¯è§ï¼Œå®¢æˆ·ç«¯çš„ç¨‹åºå¯ä¿®æ”¹ Cookie ä¸­çš„å†…å®¹&lt;/li&gt;
&lt;li&gt;Session å­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯ï¼Œå¯¹å®¢æˆ·ç«¯æ¥è¯´æ˜¯é€æ˜çš„ï¼Œä¸å­˜åœ¨æ•æ„Ÿä¿¡æ¯æ³„éœ²çš„é£é™©&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æœ‰æ•ˆæœŸçš„ä¸åŒ
&lt;ul&gt;
&lt;li&gt;è®¾ç½® Cookie çš„è¿‡æœŸæ—¶é—´ä¸ºå¾ˆå¤§çš„æ•°å­—ï¼ŒCookie å°±å¯ä»¥åœ¨æµè§ˆå™¨ä¿å­˜å¾ˆé•¿æ—¶é—´&lt;/li&gt;
&lt;li&gt;æœåŠ¡å™¨ç«¯ä¼šå®šæ—¶æ¸…ç†è¶…æ—¶çš„ sessionIDï¼Œé¿å…å‡ºç°è¿‡å¤§çš„å‹åŠ›&lt;/li&gt;
&lt;li&gt;session ä¾èµ–åä¸º sessionID è¿™æ ·ç±»ä¼¼çš„ cookieï¼Œè€Œ cookie çš„ sessionID è¿‡æœŸæ—¶é—´é»˜è®¸æ˜¯ -1ï¼Œæ‰€ä»¥åªè¦å…³é—­äº†æµè§ˆå™¨ï¼Œä¹Ÿå°±æ˜¯&lt;strong&gt;ä¸€æ¬¡ä¼šè¯&lt;/strong&gt;ç»“æŸï¼Œè¿™ä¸ª session å°±å¤±æ•ˆäº†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¯¹æœåŠ¡å™¨å‹åŠ›çš„ä¸åŒ
&lt;ul&gt;
&lt;li&gt;session ä¿ç®¡åœ¨æœåŠ¡å™¨ç«¯ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½ä¿å­˜ä¸€ä¸ª sessionï¼Œè€—è´¹å¤§é‡å†…å­˜ã€‚&lt;/li&gt;
&lt;li&gt;cookie ä¿å­˜åœ¨å®¢æˆ·ç«¯ï¼Œä¸å¤ªå ç”¨æœåŠ¡å™¨çš„èµ„æºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
">HTTP ç³»åˆ—ï¼ˆäºŒï¼‰ç†Ÿæ‚‰ HTTP åè®®ç»“æ„å’Œé€šè®¯åŸç†</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/leetcode876-lian-biao-de-zhong-jian-jie-dian/"" data-c="
          &lt;h2 id=&#34;é—®é¢˜æè¿°&#34;&gt;é—®é¢˜æè¿°&lt;/h2&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªå¸¦æœ‰å¤´ç»“ç‚¹ head çš„éç©ºå•é“¾è¡¨ï¼Œè¿”å›é“¾è¡¨çš„ä¸­é—´ç»“ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæœ‰ä¸¤ä¸ªä¸­é—´ç»“ç‚¹ï¼Œåˆ™è¿”å›ç¬¬äºŒä¸ªä¸­é—´ç»“ç‚¹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç¤ºä¾‹&#34;&gt;ç¤ºä¾‹&lt;/h2&gt;
&lt;p&gt;ç¤ºä¾‹ 1ï¼š&lt;/p&gt;
&lt;p&gt;è¾“å…¥ï¼š[1,2,3,4,5]&lt;br&gt;
è¾“å‡ºï¼šæ­¤åˆ—è¡¨ä¸­çš„ç»“ç‚¹ 3 (åºåˆ—åŒ–å½¢å¼ï¼š[3,4,5])&lt;br&gt;
è¿”å›çš„ç»“ç‚¹å€¼ä¸º 3 ã€‚ (æµ‹è¯„ç³»ç»Ÿå¯¹è¯¥ç»“ç‚¹åºåˆ—åŒ–è¡¨è¿°æ˜¯ [3,4,5])ã€‚&lt;br&gt;
æ³¨æ„ï¼Œæˆ‘ä»¬è¿”å›äº†ä¸€ä¸ª ListNode ç±»å‹çš„å¯¹è±¡ ansï¼Œè¿™æ ·ï¼š&lt;br&gt;
ans.val = 3, ans.next.val = 4, ans.next.next.val = 5, ä»¥åŠ ans.next.next.next = NULL.&lt;/p&gt;
&lt;p&gt;ç¤ºä¾‹ 2ï¼š&lt;/p&gt;
&lt;p&gt;è¾“å…¥ï¼š[1,2,3,4,5,6]&lt;br&gt;
è¾“å‡ºï¼šæ­¤åˆ—è¡¨ä¸­çš„ç»“ç‚¹ 4 (åºåˆ—åŒ–å½¢å¼ï¼š[4,5,6])&lt;br&gt;
ç”±äºè¯¥åˆ—è¡¨æœ‰ä¸¤ä¸ªä¸­é—´ç»“ç‚¹ï¼Œå€¼åˆ†åˆ«ä¸º 3 å’Œ 4ï¼Œæˆ‘ä»¬è¿”å›ç¬¬äºŒä¸ªç»“ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;æç¤ºï¼š&lt;/p&gt;
&lt;p&gt;ç»™å®šé“¾è¡¨çš„ç»“ç‚¹æ•°ä»‹äº 1 å’Œ 100 ä¹‹é—´ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ–¹æ³•ä¸€éå†ä¸¤æ¬¡é“¾è¡¨&#34;&gt;æ–¹æ³•ä¸€ï¼šéå†ä¸¤æ¬¡é“¾è¡¨&lt;/h2&gt;
&lt;h3 id=&#34;é—®é¢˜åˆ†æ&#34;&gt;é—®é¢˜åˆ†æ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;éå†é“¾è¡¨ï¼Œè®°å½•ä¸‹é“¾è¡¨é•¿åº¦ lengthã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å†éå†é“¾è¡¨è¿”å›ç¬¬ length/2 ä¸ªèŠ‚ç‚¹ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;å¤æ‚åº¦åˆ†æ&#34;&gt;å¤æ‚åº¦åˆ†æ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æ—¶é—´å¤æ‚åº¦ï¼šO(n)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç©ºé—´å¤æ‚åº¦ï¼šO(1)&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é“¾è¡¨èŠ‚ç‚¹æ•°ä¸ºå¥‡æ•°ä¸ªæ—¶ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%8D%95%E9%93%BE%E8%A1%A8%E4%B8%AD%E9%97%B4%E8%8A%82%E7%82%B9.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;é“¾è¡¨èŠ‚ç‚¹æ•°ä¸ºå¶æ•°ä¸ªæ—¶ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%8D%95%E9%93%BE%E8%A1%A8%E4%B8%AD%E9%97%B4%E8%8A%82%E7%82%B92.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;ä»£ç &#34;&gt;ä»£ç &lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;public class AlgoCasts {
  public class ListNode {
    int val;
    ListNode next;
    ListNode(int x) {
      val = x;
    }
  }
  // Time: O(n), Space: O(1)
  public ListNode getMiddleNodeTwoPass(ListNode head) {
    ListNode p = head;
    int len = 0;
    for (; p != null; p = p.next) ++len;
    p = head;
    for (int i = 0; i &amp;lt; len/2; ++i) p = p.next;
    return p;
  }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;æ–¹æ³•äºŒå¿«æ…¢æŒ‡é’ˆ&#34;&gt;æ–¹æ³•äºŒï¼šå¿«æ…¢æŒ‡é’ˆ&lt;/h2&gt;
&lt;h3 id=&#34;é—®é¢˜åˆ†æ-2&#34;&gt;é—®é¢˜åˆ†æ&lt;/h3&gt;
&lt;p&gt;å¿«æŒ‡é’ˆä¸€æ¬¡èµ°ä¸¤æ­¥ï¼Œæ…¢æŒ‡é’ˆä¸€æ¬¡èµ°ä¸€æ­¥ï¼Œ&lt;strong&gt;å½“å¿«æŒ‡é’ˆéå†å®Œé“¾è¡¨æ—¶ï¼Œæ…¢æŒ‡é’ˆæ­£å¥½æŒ‡å‘ä¸­é—´èŠ‚ç‚¹&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¤æ‚åº¦åˆ†æ-2&#34;&gt;å¤æ‚åº¦åˆ†æ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æ—¶é—´å¤æ‚åº¦ï¼šO(n)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç©ºé—´å¤æ‚åº¦ï¼šO(1)&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;while(fast != nul &amp;amp;&amp;amp; fast.next != null){
  fast = fast.next.next; // å¿«æŒ‡é’ˆç§»åŠ¨ä¸¤æ­¥
  slow = slow.next; // æ…¢æŒ‡é’ˆç§»åŠ¨ä¸€æ­¥
}  
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é“¾è¡¨èŠ‚ç‚¹æ•°ä¸ºå¥‡æ•°ä¸ªæ—¶ï¼š&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E9%93%BE%E8%A1%A8%E4%B8%AD%E9%97%B4%E8%8A%82%E7%82%B9_%E5%BF%AB%E6%85%A2%E6%8C%87%E9%92%881.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;é“¾è¡¨èŠ‚ç‚¹æ•°ä¸ºå¶æ•°ä¸ªæ—¶ï¼š&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E9%93%BE%E8%A1%A8%E4%B8%AD%E9%97%B4%E8%8A%82%E7%82%B9_%E5%BF%AB%E6%85%A2%E6%8C%87%E9%92%882.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;ä»£ç -2&#34;&gt;ä»£ç &lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;public class AlgoCasts {
  public class ListNode {
    int val;
    ListNode next;
    ListNode(int x) {
      val = x;
    }
  }
  // Time: O(n), Space: O(1)
  public ListNode getMiddleNodeOnePass(ListNode head) {
    ListNode fast = head, slow = head;
    while (fast != null &amp;amp;&amp;amp; fast.next != null) {
      fast = fast.next.next;
      slow = slow.next;
    }
    return slow;
  }
}
&lt;/code&gt;&lt;/pre&gt;
">leetcode876. é“¾è¡¨çš„ä¸­é—´ç»“ç‚¹</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/httpyi-liao-jie-http-xie-yi/"" data-c="
          &lt;h1 id=&#34;æµè§ˆå™¨èƒŒåçš„æ•…äº‹&#34;&gt;æµè§ˆå™¨èƒŒåçš„æ•…äº‹&lt;/h1&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%B5%8F%E8%A7%88%E5%99%A8%E8%83%8C%E5%90%8E%E7%9A%84%E6%95%85%E4%BA%8B.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨æµè§ˆå™¨åœ°å€æ &lt;strong&gt;è¾“å…¥åŸŸå&lt;/strong&gt;æƒ³è¦è®¿é—®æŸä¸ªç½‘ç«™ï¼Œä½†æ˜¯çœŸæ­£æ ‡è¯†æœåŠ¡å™¨çš„è€Œæ˜¯ IP åœ°å€ã€‚&lt;/li&gt;
&lt;li&gt;æ ¹æ®åŸŸååˆ° &lt;strong&gt;DNS æœåŠ¡å™¨ä¸­æŸ¥è¯¢ç›®æ ‡æœåŠ¡å™¨å¯¹åº”çš„ IP åœ°å€&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;æµè§ˆå™¨æ ¹æ®æŸ¥è¯¢åˆ°çš„ IP åœ°å€&lt;strong&gt;ä¸ WEB æœåŠ¡å™¨è¿›è¡Œé€šä¿¡&lt;/strong&gt;ï¼Œé€šä¿¡çš„åè®®å°±æ˜¯ HTTP åè®®ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;æŠŠè¿™ä¸ªè¿‡ç¨‹ç±»æ¯”ä¸ºç”µè¯é€šä¿¡çš„è¿‡ç¨‹ã€‚å¦‚æœæˆ‘ä»¬æƒ³è¦ç»™æŸä¸ªäººæ‰“ç”µè¯ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä»é€šè®¯å½•ç¿»åˆ°è¿™ä¸ªäººçš„åå­—ï¼ˆåŸŸåï¼‰&lt;/li&gt;
&lt;li&gt;å®é™…æ‹¨æ‰“è¿‡å»çš„ç”µè¯å·ï¼ˆIP åœ°å€ï¼‰&lt;br&gt;
æˆ‘ä»¬å¾ˆå®¹æ˜“è®°ä½å§“åï¼Œä½†å¾ˆéš¾è®°ä½æ¯ä¸ªäººçš„ç”µè¯å·ã€‚&lt;/li&gt;
&lt;li&gt;æ‰“é€šç”µè¯åéœ€è¦è¿›è¡Œå¯¹è¯ï¼Œå°±éœ€è¦ä¸¤ä¸ªäººä½¿ç”¨å…±åŒçš„è¯­è¨€ï¼ˆHTTP åè®®ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;WEB æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œåˆ°åç«¯è¿›è¡Œæ‰§è¡Œï¼Œå°†æ‰§è¡Œç»“æœä»¥&lt;strong&gt;å“åº”æŠ¥æ–‡&lt;/strong&gt;çš„å½¢å¼å›ä¼ åˆ°æµè§ˆå™¨ï¼Œå¦‚æœç›´æ¥å°†å“åº”æŠ¥æ–‡å±•ç¤ºå‡ºæ¥ï¼Œæ˜¯ä¸€ä¸²ä¸²ä»£ç ï¼Œæ™®é€šäººéš¾ä»¥ç†è§£ã€‚&lt;/li&gt;
&lt;li&gt;æµè§ˆå™¨å¯¹å“åº”æŠ¥æ–‡è¿›è¡Œ&lt;strong&gt;æ¸²æŸ“&lt;/strong&gt;ï¼Œä½¿ç”¨ HTML æè¿°å¯¹åº”æ•°æ®ï¼ŒæŠŠç½‘é¡µèµ„æºçš„æºä»£ç è½¬æ¢ä¸ºå›¾åƒç»“æœã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;http&#34;&gt;HTTP&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼ˆHTTPï¼‰æ˜¯ä¸€ç§&lt;strong&gt;é€šä¿¡åè®®&lt;/strong&gt;ï¼Œå®ƒå…è®¸å°†è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€ï¼ˆHTMLï¼‰æ–‡æ¡£ä»WebæœåŠ¡å™¨ä¼ é€åˆ°å®¢æˆ·ç«¯çš„æµè§ˆå™¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼šä¼ è¾“è¶…æ–‡æœ¬ï¼ˆHTMLï¼‰çš„åè®®ã€‚åœ¨æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ä¼ è¾“ HTML è¦éµå®ˆçš„&lt;strong&gt;è§„åˆ™&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;HTTPæ˜¯ä¸€ä¸ªå±äº&lt;strong&gt;åº”ç”¨å±‚çš„é¢å‘å¯¹è±¡çš„åè®®&lt;/strong&gt;ï¼Œç”±äºå…¶ç®€æ·ã€å¿«é€Ÿçš„æ–¹å¼ï¼Œé€‚ç”¨äºåˆ†å¸ƒå¼è¶…åª’ä½“ä¿¡æ¯ç³»ç»Ÿã€‚å®ƒäº1990å¹´æå‡ºï¼Œç»è¿‡å‡ å¹´çš„ä½¿ç”¨ä¸å‘å±•ï¼Œå¾—åˆ°ä¸æ–­åœ°å®Œå–„å’Œæ‰©å±•&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;web-ä¸-http&#34;&gt;WEB ä¸ HTTP&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;WEBæ˜¯ä¸€ç§åŸºäºè¶…æ–‡æœ¬å’ŒHTTPçš„ã€å…¨çƒæ€§çš„ã€åŠ¨æ€äº¤äº’çš„ã€è·¨å¹³å°çš„åˆ†å¸ƒå¼&lt;strong&gt;å›¾å½¢ä¿¡æ¯ç³»ç»Ÿ&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å»ºç«‹åœ¨Internetä¸Šçš„ä¸€ç§&lt;strong&gt;ç½‘ç»œæœåŠ¡&lt;/strong&gt;ï¼Œä¸ºæµè§ˆè€…åœ¨Internetä¸ŠæŸ¥æ‰¾å’Œæµè§ˆä¿¡æ¯æä¾›äº†å›¾å½¢åŒ–çš„ã€æ˜“äºè®¿é—®çš„ç›´è§‚ç•Œé¢ï¼Œå…¶ä¸­çš„æ–‡æ¡£åŠè¶…çº§é“¾æ¥å°†Internetä¸Šçš„ä¿¡æ¯èŠ‚ç‚¹ç»„ç»‡æˆä¸€ä¸ªäº’ä¸ºå…³è”çš„ç½‘çŠ¶ç»“æ„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;http-åè®®çš„å‰ä¸–ä»Šç”Ÿ&#34;&gt;HTTP åè®®çš„å‰ä¸–ä»Šç”Ÿ&lt;/h1&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/HTTP%E5%8D%8F%E8%AE%AE%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h1 id=&#34;é€è¿‡-tcpip-çœ‹-http&#34;&gt;é€è¿‡ TCP/IP çœ‹ HTTP&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;HTTPåè®®æ˜¯æ„å»ºåœ¨ &lt;strong&gt;TCP/IP&lt;/strong&gt; åè®®ä¹‹ä¸Šçš„ï¼Œæ˜¯TCP/IPåè®®çš„ä¸€ä¸ªå­é›†&lt;/li&gt;
&lt;li&gt;ä¸ºäº†æ›´å¥½çš„ç†è§£HTTPåè®®ï¼Œæˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹TCP/IPçš„ç›¸å…³çŸ¥è¯†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;tcpipåè®®æ—&#34;&gt;TCP/IPåè®®æ—&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;TCP/IP åè®®å…¶å®æ˜¯ä¸€ç³»åˆ—ä¸äº’è”ç½‘ç›¸å…³è”çš„åè®®é›†åˆèµ·æ¥çš„æ€»ç§°&lt;/li&gt;
&lt;li&gt;åˆ†å±‚ç®¡ç†æ˜¯ TCP/IP åè®®çš„é‡è¦ç‰¹å¾&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;tcpipåè®®æ—åˆ†å±‚&#34;&gt;TCP/IPåè®®æ—åˆ†å±‚&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;TCP/IPåè®®æ—æ˜¯ç”±ä¸€ä¸ªå››å±‚åè®®ç»„æˆçš„ç³»ç»Ÿï¼Œè¿™å››å±‚åˆ†åˆ«ä¸ºï¼šå’Œæ•°æ®é“¾è·¯å±‚ã€ç½‘ç»œå±‚ã€è¿è¾“å±‚ã€åº”ç”¨å±‚&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%9B%9B%E5%B1%82%E7%BD%91%E7%BB%9C%E7%BB%93%E6%9E%84.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;åº”ç”¨å±‚&#34;&gt;åº”ç”¨å±‚&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;åº”ç”¨å±‚ä¸€èˆ¬æ˜¯æˆ‘ä»¬ç¼–å†™çš„åº”ç”¨ç¨‹åºï¼Œå†³å®šäº†å‘ç”¨æˆ·æä¾›çš„åº”ç”¨æœåŠ¡ã€‚åº”ç”¨å±‚å¯ä»¥é€šè¿‡ç³»ç»Ÿè°ƒç”¨ä¸ä¼ è¾“å±‚è¿›è¡Œé€šä¿¡ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚ï¼š&lt;strong&gt;FTPã€DNSã€HTTP&lt;/strong&gt;ç­‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ä¼ è¾“å±‚&#34;&gt;ä¼ è¾“å±‚&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ä¼ è¾“å±‚é€šè¿‡ç³»ç»Ÿè°ƒç”¨å‘åº”ç”¨å±‚æä¾›å¤„äºç½‘ç»œè¿æ¥ä¸­çš„ä¸¤å°è®¡ç®—æœºä¹‹é—´çš„æ•°æ®ä¼ è¾“åŠŸèƒ½ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨ä¼ è¾“å±‚æœ‰ä¸¤ä¸ªæ€§è´¨ä¸åŒçš„åè®®ï¼š**TCP **å’Œ &lt;strong&gt;UDP&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ç½‘ç»œå±‚&#34;&gt;ç½‘ç»œå±‚&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ç½‘ç»œå±‚ç”¨æ¥å¤„ç†åœ¨ç½‘ç»œä¸ŠæµåŠ¨çš„æ•°æ®åŒ…ï¼Œæ•°æ®åŒ…æ˜¯ç½‘ç»œä¼ è¾“çš„æœ€å°æ•°æ®å•ä½ã€‚è¯¥å±‚è§„å®šäº†é€šè¿‡æ€æ ·çš„è·¯å¾„ï¼ˆ&lt;strong&gt;ä¼ è¾“è·¯çº¿&lt;/strong&gt;ï¼‰åˆ°è¾¾å¯¹æ–¹è®¡ç®—æœºï¼Œå¹¶æŠŠæ•°æ®åŒ…ä¼ è¾“ç»™å¯¹æ–¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;é“¾è·¯å±‚&#34;&gt;é“¾è·¯å±‚&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;é“¾è·¯å±‚ç”¨æ¥å¤„ç†è¿æ¥ç½‘ç»œçš„&lt;strong&gt;ç¡¬ä»¶&lt;/strong&gt;éƒ¨åˆ†ï¼ŒåŒ…æ‹¬æ§åˆ¶æ“ä½œç³»ç»Ÿã€ç¡¬ä»¶è®¾å¤‡é©±åŠ¨ã€NICï¼ˆNetwork Interface Cardï¼Œç½‘ç»œé€‚é…å™¨ï¼‰ä»¥åŠå…‰çº¤ç­‰ç‰©ç†å¯è§éƒ¨åˆ†ã€‚ç¡¬ä»¶ä¸Šçš„èŒƒç•´å‡åœ¨é“¾è·¯å±‚çš„ä½œç”¨èŒƒå›´ä¹‹å†…ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æ•°æ®åŒ…çš„å°è£…è¿‡ç¨‹&#34;&gt;æ•°æ®åŒ…çš„å°è£…è¿‡ç¨‹&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%95%B0%E6%8D%AE%E5%8C%85%E5%B0%81%E8%A3%85%E7%9A%84%E8%BF%87%E7%A8%8B.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;http-æ•°æ®ä¼ è¾“è¿‡ç¨‹&#34;&gt;HTTP æ•°æ®ä¼ è¾“è¿‡ç¨‹&lt;/h2&gt;
&lt;p&gt;å‘é€ç«¯å‘é€æ•°æ®æ—¶ï¼Œæ•°æ®ä¼šä»ä¸Šå±‚ä¼ è¾“åˆ°ä¸‹å±‚ï¼Œä¸”æ¯ç»è¿‡ä¸€å±‚éƒ½ä¼šè¢«æ‰“ä¸Šè¯¥å±‚çš„å¤´éƒ¨ä¿¡æ¯ã€‚è€Œæ¥æ”¶ç«¯æ¥æ”¶æ•°æ®æ—¶ï¼Œæ•°æ®ä¼šä»ä¸‹å±‚ä¼ è¾“åˆ°ä¸Šå±‚ï¼Œä¼ è¾“å‰ä¼šæŠŠä¸‹å±‚çš„å¤´éƒ¨ä¿¡æ¯åˆ é™¤&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/HTTP%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93%E8%BF%87%E7%A8%8B.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;å‘é€ç«¯ä»åº”ç”¨å±‚å‘ä¸‹èµ°ï¼Œæ¥æ”¶ç«¯ä»é“¾è·¯å±‚å‘ä¸Šèµ°ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½œä¸ºå‘é€ç«¯çš„å®¢æˆ·ç«¯ï¼Œåœ¨&lt;strong&gt;åº”ç”¨å±‚&lt;/strong&gt;ï¼Œé€šè¿‡ HTTP åè®®å‘å‡ºä¸€ä¸ªè¯·æ±‚ï¼Œ&lt;/li&gt;
&lt;li&gt;ä¸ºäº†ä¼ è¾“æ–¹ä¾¿ï¼Œåœ¨&lt;strong&gt;ä¼ è¾“å±‚&lt;/strong&gt;ï¼Œé€šè¿‡ TCP åè®®æŠŠåº”ç”¨å±‚æ”¶åˆ°çš„æ•°æ®ï¼ˆHTTP è¯·æ±‚æŠ¥æ–‡ï¼‰è¿›è¡Œåˆ†å‰²å¹¶ä¸”åœ¨å„ä¸ªæŠ¥æ–‡ä¸Šæ‰“ä¸Šæ ‡è®°åºå·ã€ç«¯å£å·ç­‰ä¿¡æ¯ï¼Œå‘é€åˆ°ç½‘ç»œå±‚&lt;/li&gt;
&lt;li&gt;åœ¨&lt;strong&gt;ç½‘ç»œå±‚&lt;/strong&gt;ï¼Œé€šè¿‡ IP åè®®ï¼Œå¢åŠ ä½œä¸ºç›®çš„åœ°çš„ MAC åœ°å€ï¼Œè½¬å‘ç»™é“¾è·¯å±‚ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é“¾è·¯å±‚&lt;/strong&gt;æ·»åŠ å¸§å¤´ã€å¸§å°¾åï¼Œé€šè¿‡ç”µä¿¡å·ä¼ è¾“ç»™æ¥æ”¶ç«¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¥æ”¶ç«¯&lt;/strong&gt;çš„æœåŠ¡å™¨åœ¨é“¾è·¯å±‚æ¥æ”¶åˆ°è¯·æ±‚çš„æ•°æ®ï¼ŒæŒ‰é¡ºåºå‘ä¸Šå±‚å‘é€ï¼Œä¸€ç›´å‘é€åˆ°åº”ç”¨å±‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;ä¼ è¾“å±‚-tcp-ä¸‰æ¬¡æ¡æ‰‹&#34;&gt;ä¼ è¾“å±‚ â€”â€” TCP ä¸‰æ¬¡æ¡æ‰‹&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E4%BC%A0%E8%BE%93%E5%B1%82%E7%9A%84TCP%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ä½¿ç”¨TCPåè®®è¿›è¡Œé€šä¿¡çš„åŒæ–¹å¿…é¡»å…ˆå»ºç«‹è¿æ¥ï¼Œç„¶åæ‰èƒ½å¼€å§‹ä¼ è¾“æ•°æ®ã€‚ä¸ºäº†ç¡®ä¿è¿æ¥åŒæ–¹å¯é æ€§ï¼Œåœ¨åŒæ–¹å»ºç«‹è¿æ¥æ—¶ï¼ŒTCPåè®®é‡‡ç”¨äº†ä¸‰æ¬¡æ¡æ‰‹ç­–ç•¥ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E4%BC%A0%E8%BE%93%E5%B1%82%E7%9A%84TCP%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç¬¬ä¸€æ¬¡æ¡æ‰‹&lt;/strong&gt;ï¼šå®¢æˆ·ç«¯å‘é€å¸¦æœ‰ SYN æ ‡å¿—çš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µï¼Œç„¶åè¿›å…¥SYN_SENDçŠ¶æ€ï¼Œç­‰å¾…æœåŠ¡ç«¯çš„ç¡®è®¤ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;å®¢æˆ·ç«¯ï¼šå®¢æˆ·ç«¯å‘é€èƒ½åŠ›æ­£å¸¸&lt;br&gt;
æœåŠ¡ç«¯ï¼šå®¢æˆ·ç«¯å‘é€èƒ½åŠ›æ­£å¸¸ã€æœåŠ¡ç«¯æ¥æ”¶èƒ½åŠ›æ­£å¸¸&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç¬¬äºŒæ¬¡æ¡æ‰‹&lt;/strong&gt;ï¼šæœåŠ¡ç«¯æ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„ SYN æŠ¥æ–‡æ®µåï¼Œéœ€è¦å‘é€ ACK ä¿¡æ¯å¯¹è¿™ä¸ª SYN æŠ¥æ–‡æ®µè¿›è¡Œç¡®è®¤ã€‚åŒæ—¶ï¼Œè¿˜è¦å‘é€è‡ªå·±çš„ SYN è¯·æ±‚ä¿¡æ¯ã€‚æœåŠ¡ç«¯ä¼šå°†ä¸Šè¿°çš„ä¿¡æ¯æ”¾åˆ°ä¸€ä¸ªæŠ¥æ–‡æ®µï¼ˆSYN+ACKæŠ¥æ–‡æ®µï¼‰ä¸­ï¼Œä¸€å¹¶å‘é€ç»™å®¢æˆ·ç«¯ï¼Œæ­¤æ—¶æœåŠ¡ç«¯å°†ä¼šè¿›å…¥SYN_RECVçŠ¶æ€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;å®¢æˆ·ç«¯ï¼šå®¢æˆ·ç«¯å‘é€èƒ½åŠ›æ­£å¸¸ã€æœåŠ¡ç«¯æ¥æ”¶èƒ½åŠ›æ­£å¸¸ã€å®¢æˆ·ç«¯æ¥æ”¶èƒ½åŠ›æ­£å¸¸ã€æœåŠ¡ç«¯å‘é€èƒ½åŠ›æ­£å¸¸&lt;br&gt;
æœåŠ¡ç«¯ï¼šå®¢æˆ·ç«¯å‘é€èƒ½åŠ›æ­£å¸¸ã€æœåŠ¡ç«¯æ¥æ”¶èƒ½åŠ›æ­£å¸¸&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç¬¬ä¸‰æ¬¡æ¡æ‰‹&lt;/strong&gt;ï¼šå®¢æˆ·ç«¯æ¥æ”¶åˆ°æœåŠ¡ç«¯çš„ SYN+ACK æŠ¥æ–‡æ®µåï¼Œä¼šå‘æœåŠ¡ç«¯å‘é€ ACK ç¡®è®¤æŠ¥æ–‡æ®µï¼Œè¿™ä¸ªæŠ¥æ–‡æ®µå‘é€å®Œæ¯•åï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½è¿›å…¥ ESTABLISHED çŠ¶æ€ï¼Œå®Œæˆ TCP ä¸‰æ¬¡æ¡æ‰‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;å®¢æˆ·ç«¯ï¼šå®¢æˆ·ç«¯å‘é€èƒ½åŠ›æ­£å¸¸ã€æœåŠ¡ç«¯æ¥æ”¶èƒ½åŠ›æ­£å¸¸ã€å®¢æˆ·ç«¯æ¥æ”¶èƒ½åŠ›æ­£å¸¸ã€æœåŠ¡ç«¯å‘é€èƒ½åŠ›æ­£å¸¸&lt;br&gt;
æœåŠ¡ç«¯ï¼šå®¢æˆ·ç«¯å‘é€èƒ½åŠ›æ­£å¸¸ã€æœåŠ¡ç«¯æ¥æ”¶èƒ½åŠ›æ­£å¸¸ã€å®¢æˆ·ç«¯ç«¯æ¥æ”¶èƒ½åŠ›æ­£å¸¸ã€æœåŠ¡ç«¯å‘é€èƒ½åŠ›æ­£å¸¸&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¸‰æ¬¡æ¡æ‰‹ç»“æŸåï¼Œå‘é€ã€æ¥æ”¶åŒæ–¹éƒ½ç¡®è®¤äº†å½¼æ­¤çš„å‘é€å’Œæ¥æ”¶èƒ½åŠ›éƒ½æ­£å¸¸ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä¸ºä»€ä¹ˆä¸¤æ¬¡æ¡æ‰‹ä¸å¯ä»¥&#34;&gt;ä¸ºä»€ä¹ˆä¸¤æ¬¡æ¡æ‰‹ä¸å¯ä»¥ï¼Ÿ&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%A4%E6%AC%A1%E6%8F%A1%E6%89%8B%E4%B8%8D%E5%8F%AF%E4%BB%A5.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ä¸ºäº†é˜²æ­¢å·²ç»å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µçªç„¶åˆä¼ é€åˆ°äº† Bï¼Œå› è€Œäº§ç”Ÿé”™è¯¯ã€‚æ¯”å¦‚ä¸‹é¢è¿™ç§æƒ…å†µï¼šA å‘å‡ºçš„ç¬¬ä¸€ä¸ªè¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µå¹¶æ²¡æœ‰ä¸¢å¤±ï¼Œè€Œæ˜¯åœ¨ç½‘è·¯ç»“ç‚¹é•¿æ—¶é—´æ»ç•™äº†ï¼Œä»¥è‡´äºå»¶è¯¯åˆ°è¿æ¥é‡Šæ”¾ä»¥åçš„æŸä¸ªæ—¶é—´æ®µæ‰åˆ°è¾¾ Bã€‚æœ¬æ¥è¿™æ˜¯ä¸€ä¸ªæ—©å·²å¤±æ•ˆçš„æŠ¥æ–‡æ®µã€‚ä½†æ˜¯ B æ”¶åˆ°æ­¤å¤±æ•ˆçš„é“¾æ¥è¯·æ±‚æŠ¥æ–‡æ®µåï¼Œå°±&lt;strong&gt;è¯¯è®¤ä¸º A åˆå‘å‡ºä¸€æ¬¡æ–°çš„è¿æ¥è¯·æ±‚&lt;/strong&gt;ã€‚äºæ˜¯å°±å‘ A å‘å‡ºç¡®è®¤æŠ¥æ–‡æ®µï¼ŒåŒæ„å»ºç«‹è¿æ¥ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºä¸Šé¢è¿™ç§æƒ…å†µï¼Œå¦‚æœä¸è¿›è¡Œç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼Œ&lt;strong&gt;B å‘å‡ºç¡®è®¤åå°±è®¤ä¸ºæ–°çš„è¿è¾“è¿æ¥å·²ç»å»ºç«‹äº†&lt;/strong&gt;ï¼Œå¹¶ä¸€ç›´ç­‰å¾… A å‘æ¥æ•°æ®ã€‚B çš„è®¸å¤šèµ„æºå°±è¿™æ ·ç™½ç™½æµªè´¹äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœé‡‡ç”¨äº†ä¸‰æ¬¡æ¡æ‰‹ï¼Œç”±äº A å®é™…ä¸Šå¹¶æ²¡æœ‰å‘å‡ºå»ºç«‹è¿æ¥è¯·æ±‚ï¼Œæ‰€ä»¥ä¸ä¼šç†ç¬ B çš„ç¡®è®¤ï¼Œä¹Ÿä¸ä¼šå‘ B å‘é€æ•°æ®ã€‚B ç”±äºæ”¶ä¸åˆ°ç¡®è®¤ï¼Œå°±çŸ¥é“ A å¹¶æ²¡æœ‰è¦æ±‚å»ºç«‹è¿æ¥ã€‚&lt;/p&gt;
&lt;h1 id=&#34;dns-åŸŸåè§£æ&#34;&gt;DNS åŸŸåè§£æ&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;å·²ç»ä»‹ç»äº†ä¸HTTPåè®®æœ‰ç€å¯†åˆ‡å…³ç³»çš„TCP/IPåè®®ï¼Œæ¥ä¸‹æ¥ä»‹ç»çš„DNSæœåŠ¡ä¹Ÿæ˜¯ä¸HTTPåè®®æœ‰ç€å¯†ä¸å¯åˆ†çš„å…³ç³»ã€‚&lt;/li&gt;
&lt;li&gt;é€šå¸¸æˆ‘ä»¬è®¿é—®ä¸€ä¸ªç½‘ç«™ï¼Œä½¿ç”¨çš„æ˜¯ä¸»æœºåæˆ–è€…åŸŸåæ¥è¿›è¡Œè®¿é—®çš„ã€‚å› ä¸ºç›¸å¯¹äºIPåœ°å€ï¼ˆä¸€ç»„çº¯æ•°å­—ï¼‰ï¼ŒåŸŸåæ›´å®¹æ˜“è®©äººè®°ä½ã€‚ ä½†TCP/IPåè®®ä½¿ç”¨çš„æ˜¯IPåœ°å€è¿›è¡Œè®¿é—®çš„ï¼Œæ‰€ä»¥å¿…é¡»æœ‰ä¸ªæœºåˆ¶æˆ–æœåŠ¡æŠŠåŸŸåè½¬æ¢æˆIPåœ°å€ã€‚&lt;strong&gt;DNS&lt;/strong&gt;æœåŠ¡å°±æ˜¯ç”¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„ï¼Œå®ƒæä¾›&lt;strong&gt;åŸŸååˆ°IPåœ°å€ä¹‹é—´çš„è§£æ&lt;/strong&gt;æœåŠ¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;9&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/DNS%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;DNS æœåŠ¡è§£ææ˜¯æœ‰å±‚æ¬¡çš„ï¼Œå°±è¿‘åŸåˆ™ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æœ¬åœ°ç”µè„‘ä¼šå°†ç»å¸¸ä½¿ç”¨çš„åŸŸåå’Œ IP åœ°å€å»ºç«‹æ˜ å°„å…³ç³»å¹¶ä¸”ä¿å­˜åˆ°&lt;strong&gt;ç³»ç»Ÿæ–‡ä»¶&lt;/strong&gt;ä¸­ï¼Œåœ¨è¿›è¡Œ DNS è§£ææ—¶ï¼Œç³»ç»Ÿä¼šä¼˜å…ˆä» &lt;strong&gt;hosts æ–‡ä»¶&lt;/strong&gt;å»å¯»æ‰¾å¯¹åº”çš„ IP åœ°å€ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œç›´æ¥ä½¿ç”¨ hosts æ–‡ä»¶ä¸­çš„ IP åœ°å€ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœæœ¬åœ° hosts æ–‡ä»¶æ²¡æœ‰æ‰¾åˆ°è¯¥åŸŸåå¯¹åº”çš„ IP åœ°å€çš„æ˜ å°„ï¼Œå‘&lt;strong&gt;æœ¬åœ° DNS æœåŠ¡å™¨&lt;/strong&gt;å‘é€è¯·æ±‚ï¼ŒæŸ¥è¯¢åŸŸåå¯¹åº”çš„ IP åœ°å€ï¼Œæœ¬åœ°åŸŸåæœåŠ¡å™¨æ‰¾åˆ°å¯¹åº”çš„ IP åœ°å€ï¼Œå“åº”ç»™æµè§ˆå™¨ã€‚æœ¬åœ° DNS æœåŠ¡æœ‰é™ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œä¾æ¬¡å‘ä¸Šå±‚ DNS æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œ&lt;/li&gt;
&lt;li&gt;ç›´åˆ° &lt;strong&gt;DNS æ ¹æœåŠ¡å™¨&lt;/strong&gt;ï¼Œå¦‚æœæ‰¾åˆ°åˆ™è¿”å›ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;dns-è§£æè¿‡ç¨‹&#34;&gt;DNS è§£æè¿‡ç¨‹&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;10&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/DNS%E8%A7%A3%E6%9E%90%E8%BF%87%E7%A8%8B.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h1 id=&#34;å›æº¯-http-äº‹åŠ¡å¤„ç†è¿‡ç¨‹&#34;&gt;å›æº¯ HTTP äº‹åŠ¡å¤„ç†è¿‡ç¨‹&lt;/h1&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;11&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/HTTP%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86%E8%BF%87%E7%A8%8B.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;å½“å®¢æˆ·ç«¯è®¿é—®Webç«™ç‚¹æ—¶ï¼Œé¦–å…ˆä¼šé€šè¿‡DNSæœåŠ¡æŸ¥è¯¢åˆ°åŸŸåçš„IPåœ°å€ã€‚ç„¶åæµè§ˆå™¨ç”ŸæˆHTTPè¯·æ±‚ï¼Œå¹¶é€šè¿‡TCP/IPåè®®å‘é€ç»™WebæœåŠ¡å™¨ã€‚WebæœåŠ¡å™¨æ¥æ”¶åˆ°è¯·æ±‚åä¼šæ ¹æ®è¯·æ±‚ç”Ÿæˆå“åº”å†…å®¹ï¼Œå¹¶é€šè¿‡TCP/IPåè®®è¿”å›ç»™å®¢æˆ·ç«¯ã€‚&lt;/p&gt;
&lt;h2 id=&#34;http-äº‹åŠ¡å¤„ç†å®Œæ•´è¿‡ç¨‹&#34;&gt;HTTP äº‹åŠ¡å¤„ç†å®Œæ•´è¿‡ç¨‹&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;12&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/HTTP%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86%E5%AE%8C%E6%95%B4%E8%BF%87%E7%A8%8B.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœä½¿ç”¨å®¢æˆ·ç«¯æµè§ˆå™¨æµè§ˆé¡µé¢ï¼Œéœ€è¦ä»ä¸­åˆ†è§£å‡ºåè®®åã€ä¸»æœºåã€ç«¯å£ã€å¯¹è±¡è·¯å¾„ç­‰ï¼Œå¾—åˆ°åè®®æ˜¯ HTTP åè®®ã€ä¸»æœºæ˜¯ mooc.com ä¸»æœºã€ç«¯å£æ˜¯ 80 ç«¯å£ã€è·¯å¾„æ˜¯ mooc çš„æ ¹èŠ‚ç‚¹ã€‚åœ¨è¿™ä¸€æ­¥éœ€è¦é€šè¿‡ DNS æœåŠ¡å™¨è§£æå‡ºå®ƒçš„ &lt;strong&gt;IP åœ°å€&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å°è£… HTTP è¯·æ±‚çš„æ•°æ®åŒ…&lt;/strong&gt;ï¼ŒæŠŠä»¥ä¸Šéƒ¨åˆ†ç»“åˆè‡ªå·±çš„æœ¬æœºä¿¡æ¯å°è£…æˆä¸€ä¸ª HTTP è¯·æ±‚çš„æ•°æ®åŒ…ã€‚&lt;/li&gt;
&lt;li&gt;æ•°æ®æŠ¥å‘ä¸‹å°è£…æˆ &lt;strong&gt;TCP åŒ…&lt;/strong&gt;ï¼Œ&lt;strong&gt;ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹ TCP è¿æ¥&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å®¢æˆ·ç«¯&lt;strong&gt;å‘é€è¯·æ±‚&lt;/strong&gt;ç»™æœåŠ¡å™¨&lt;/li&gt;
&lt;li&gt;æœåŠ¡å™¨è¿›è¡Œ&lt;strong&gt;å“åº”&lt;/strong&gt;ï¼Œæ¶ˆæ¯ä½“æœ‰çŠ¶æ€ç ã€ç‰ˆæœ¬å·&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é‡Šæ”¾ TCP è¿æ¥&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;å®éªŒ&#34;&gt;å®éªŒ&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»äº†è§£äº†HTTPåè®®çš„åŸºæœ¬æ¦‚å¿µï¼Œä¹ŸçŸ¥é“äº†æˆ‘ä»¬æ˜¯å¦‚ä½•ä»æµè§ˆå™¨è®¿é—®åˆ°æˆ‘ä»¬æƒ³è¦çš„ç½‘ç«™èµ„æºçš„ã€‚&lt;/li&gt;
&lt;li&gt;é‚£ä¹ˆå¯¹äºæµè§ˆå™¨æ¥è¯´ï¼ŒHTTPè¯·æ±‚åˆ°åº•æ˜¯ä»€ä¹ˆæ ·å­çš„å‘¢ï¼Ÿè®©æˆ‘ä»¬ä¸€èµ·æ¥è·Ÿè¸ªæŸ¥çœ‹ä¸€ä¸‹ï¼&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;ç¯å¢ƒæ­å»º&#34;&gt;ç¯å¢ƒæ­å»º&lt;/h2&gt;
&lt;p&gt;ä¸‹è½½æŠ“åŒ…å·¥å…·ï¼š&lt;a href=&#34;https://www.wireshark.org/&#34;&gt;https://www.wireshark.org/&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;å®éªŒè¿‡ç¨‹&#34;&gt;å®éªŒè¿‡ç¨‹&lt;/h2&gt;
&lt;p&gt;1.å› ä¸ºè¿æ¥çš„æ˜¯ WIFIï¼Œæ‰€ä»¥é€‰æ‹© WLANï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;13&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/wireshark%E9%80%89%E6%8B%A9WLAN.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;2.æµè§ˆå™¨æ è¾“å…¥åŸŸå &lt;a href=&#34;http://www.baidu.com&#34;&gt;www.baidu.com&lt;/a&gt;ï¼ˆHTTPSåè®®ï¼‰&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://www.jszg.edu.cn/portal/home/index&#34;&gt;http://www.jszg.edu.cn/portal/home/index&lt;/a&gt;ï¼ˆHTTPåè®®ï¼‰&lt;/p&gt;
&lt;p&gt;3.Wireshark ç‚¹å‡»åœæ­¢&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;14&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/wireshark%E5%81%9C%E6%AD%A2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;4.åˆ†æå¤„ç†è¿‡ç¨‹&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;15&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/wrieshark%E5%88%86%E6%9E%90%E5%A4%84%E7%90%86%E8%BF%87%E7%A8%8B.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
">HTTPç³»åˆ—ï¼ˆä¸€ï¼‰äº†è§£ HTTP åè®®</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/mysql-suo-yin-xiang-jie/"" data-c="
          &lt;h2 id=&#34;å­˜å‚¨å¼•æ“&#34;&gt;å­˜å‚¨å¼•æ“&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;InnoDB&lt;/code&gt;ï¼šä¸åŠ ä»»ä½•æ¡ä»¶ &lt;code&gt;select&lt;/code&gt; å‡ºæ¥çš„æ•°æ®æ˜¯æ’å¥½åºçš„ï¼ˆæŒ‰ä¸»é”®å­—æ®µæ’åºï¼‰â€”â€”èšç°‡ç´¢å¼•ã€‚&lt;code&gt;MySQL&lt;/code&gt;é»˜è®¤çš„å­˜å‚¨å¼•æ“æ˜¯ &lt;code&gt;InnoDB&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;MyISAM&lt;/code&gt;ï¼šä¸åŠ ä»»ä½•æ¡ä»¶ &lt;code&gt;select&lt;/code&gt; å‡ºæ¥çš„æ•°æ®æ˜¯æ²¡æœ‰æ’åºçš„ï¼ˆæŒ‰ç…§æ’å…¥é¡ºåºè¾“å‡ºï¼‰â€”â€”å †è¡¨&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;&lt;code&gt;MyISAM&lt;/code&gt;&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;&lt;code&gt;InnoDB&lt;/code&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;strong&gt;é”çº§åˆ«&lt;/strong&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;åªæœ‰&lt;strong&gt;è¡¨çº§é”&lt;/strong&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;æ”¯æŒ&lt;strong&gt;è¡Œçº§é”å’Œè¡¨çº§é”&lt;/strong&gt;ï¼Œé»˜è®¤ä¸ºè¡Œçº§é”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;æŸ¥è¯¢æ€§èƒ½&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;å¼ºè°ƒçš„æ˜¯æ€§èƒ½ï¼Œæ¯æ¬¡æŸ¥è¯¢å…·æœ‰åŸå­æ€§ï¼Œæ‰§è¡Œé€Ÿåº¦å¿«&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;ä½¿ç”¨äº†èšç°‡ç´¢å¼•ã€æˆ–éœ€è¦è®¿é—®çš„æ•°æ®å¯ä»¥æ”¾å…¥å†…å­˜çš„åº”ç”¨ä¸‹é€Ÿåº¦å¿«&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;strong&gt;æ˜¯å¦æ”¯æŒäº‹åŠ¡&lt;/strong&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;ä¸æ”¯æŒ&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;æ”¯æŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;strong&gt;æ˜¯å¦æ”¯æŒå´©æºƒåçš„å®‰å…¨æ¢å¤&lt;/strong&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;ä¸æ”¯æŒ&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;æ”¯æŒã€‚äº‹åŠ¡ã€å›æ»šã€å´©æºƒä¿®å¤èƒ½åŠ›å’Œäº‹åŠ¡å®‰å…¨å‹è¡¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;æ˜¯å¦æ”¯æŒå¤–é”®&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;ä¸æ”¯æŒ&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;æ”¯æŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;æ˜¯å¦æ”¯æŒ &lt;code&gt;MVCC&lt;/code&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;ä¸æ”¯æŒ&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;æ”¯æŒã€‚åº”å¯¹é«˜å¹¶å‘äº‹åŠ¡ï¼Œ&lt;code&gt;MVCC&lt;/code&gt;æ¯”å•çº¯çš„åŠ é”æ›´é«˜æ•ˆã€‚&lt;code&gt;MVCC&lt;/code&gt;åªåœ¨&lt;code&gt;READ COMMITTED&lt;/code&gt; å’Œ &lt;code&gt;REPEATABLE READ&lt;/code&gt; ä¸¤ä¸ªéš”ç¦»çº§åˆ«ä¸‹å·¥ä½œï¼›&lt;code&gt;MVCC&lt;/code&gt; å¯ä»¥ä½¿ç”¨ä¹è§‚é”å’Œæ‚²è§‚é”æ¥å®ç°ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;å…¶ä»–åŠŸèƒ½&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;å…¨æ–‡ç´¢å¼•ã€å‹ç¼©ã€ç©ºé—´å‡½æ•°&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;ç´¢å¼•çš„åˆ†ç±»&#34;&gt;ç´¢å¼•çš„åˆ†ç±»&lt;/h2&gt;
&lt;h3 id=&#34;å“ˆå¸Œç´¢å¼•&#34;&gt;å“ˆå¸Œç´¢å¼•&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Hashç´¢å¼•åº•å±‚çš„æ•°æ®ç»“æ„æ˜¯&lt;strong&gt;å“ˆå¸Œè¡¨&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;Hash ç´¢å¼•ä»…ä»…èƒ½æ»¡è¶³ &amp;quot;=&amp;quot;ã€&amp;quot;IN&amp;quot; çš„&lt;strong&gt;ç­‰å€¼æŸ¥è¯¢&lt;/strong&gt;ï¼Œä¸èƒ½ä½¿ç”¨èŒƒå›´æŸ¥è¯¢ã€‚&lt;/li&gt;
&lt;li&gt;Hash ç´¢å¼•ä¸èƒ½åˆ©ç”¨ç»„åˆç´¢å¼•çš„&lt;strong&gt;éƒ¨åˆ†ç´¢å¼•é”®&lt;/strong&gt;æŸ¥è¯¢ã€‚&lt;/li&gt;
&lt;li&gt;Hash ç´¢å¼•é‡åˆ°å¤§é‡ Hash å€¼ç›¸ç­‰çš„æƒ…å†µåä¼šå‘ç”Ÿ&lt;strong&gt;ç¢°æ’&lt;/strong&gt;ï¼Œæ€§èƒ½ä¸ä¸€å®šä¼šæ¯” B+æ ‘ é«˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;bæ ‘-ç´¢å¼•&#34;&gt;B+æ ‘ ç´¢å¼•&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;B+æ ‘ ç´¢å¼•åº•å±‚çš„æ•°æ®ç»“æ„æ˜¯ &lt;strong&gt;B+æ ‘&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;B+æ ‘ ç´¢å¼•æ”¯æŒ&lt;strong&gt;èŒƒå›´æŸ¥è¯¢&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;B+æ ‘ ç´¢å¼•å¯ä»¥ä½¿ç”¨ç»„åˆç´¢å¼•çš„&lt;strong&gt;éƒ¨åˆ†ç´¢å¼•&lt;/strong&gt;é”®æŸ¥è¯¢ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;innodb-çš„-bæ ‘èšç°‡ç´¢å¼•&#34;&gt;&lt;code&gt;InnoDB&lt;/code&gt; çš„ B+æ ‘ï¼šèšç°‡ç´¢å¼•&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;InnoDB&lt;/code&gt; ä¸­ç´¢å¼•å³æ•°æ®ï¼Œä¹Ÿå°±æ˜¯èšç°‡ç´¢å¼•çš„B+æ ‘çš„å¶å­èŠ‚ç‚¹ä¸­åŒ…å«å®Œæ•´çš„æ•°æ®è®°å½•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;InnoDB&lt;/code&gt; çš„ B+Tree ç´¢å¼•åˆ†ä¸ºä¸»ç´¢å¼•å’Œè¾…åŠ©ç´¢å¼•ã€‚&lt;/p&gt;
&lt;p&gt;ä¸»ç´¢å¼•çš„å¶å­èŠ‚ç‚¹ data åŸŸè®°å½•ç€&lt;strong&gt;å®Œæ•´çš„æ•°æ®è®°å½•&lt;/strong&gt;ï¼Œè¿™ç§ç´¢å¼•æ–¹å¼è¢«ç§°ä¸º&lt;strong&gt;èšç°‡ç´¢å¼•&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¾…åŠ©ç´¢å¼•çš„å¶å­èŠ‚ç‚¹çš„ data åŸŸè®°å½•ç€&lt;strong&gt;ä¸»é”®çš„å€¼&lt;/strong&gt;ï¼Œå› æ­¤åœ¨ä½¿ç”¨è¾…åŠ©ç´¢å¼•è¿›è¡ŒæŸ¥æ‰¾æ—¶ï¼Œéœ€è¦å…ˆæŸ¥æ‰¾åˆ°ä¸»é”®å€¼ï¼Œç„¶åå†åˆ°ä¸»ç´¢å¼•ä¸­è¿›è¡ŒæŸ¥æ‰¾ã€‚&lt;/p&gt;
&lt;h5 id=&#34;èšç°‡ç´¢å¼•&#34;&gt;èšç°‡ç´¢å¼•&lt;/h5&gt;
&lt;p&gt;èšç°‡ç´¢å¼•çš„ç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æŒ‰&lt;strong&gt;ä¸»é”®å€¼çš„å¤§å°&lt;/strong&gt;è¿›è¡Œè®°å½•å’Œé¡µçš„æ’åºï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æ•°æ®é¡µ(å¶å­èŠ‚ç‚¹)é‡Œçš„è®°å½•æ˜¯æŒ‰ç…§ä¸»é”®å€¼ä»å°åˆ°å¤§æ’åºçš„ä¸€ä¸ªå•å‘é“¾è¡¨ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ•°æ®é¡µ(å¶å­èŠ‚ç‚¹)ä¹‹é—´ä¹Ÿæ˜¯æ˜¯æŒ‰ç…§ä¸»é”®å€¼ä»å°åˆ°å¤§æ’åºçš„ä¸€ä¸ªåŒå‘é“¾è¡¨ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;B+æ ‘ä¸­åŒä¸€ä¸ªå±‚çš„é¡µç›®å½•ä¹Ÿæ˜¯æŒ‰ç…§ä¸»é”®å€¼ä»å°åˆ°å¤§æ’åºçš„ä¸€ä¸ªåŒå‘é“¾è¡¨ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;B+æ ‘çš„&lt;strong&gt;å¶å­èŠ‚ç‚¹&lt;/strong&gt;å­˜å‚¨çš„æ˜¯å®Œæ•´çš„ç”¨æˆ·è®°å½•ï¼Œå°±æ˜¯æŒ‡è¿™ä¸ªè®°å½•ä¸­&lt;strong&gt;å­˜å‚¨äº†æ‰€æœ‰åˆ—çš„å€¼&lt;/strong&gt;ï¼ˆåŒ…æ‹¬éšè—åˆ—ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å…·æœ‰è¿™ä¸¤ç§ç‰¹æ€§çš„B+æ ‘ç§°ä¸º&lt;strong&gt;èšç°‡ç´¢å¼•&lt;/strong&gt;ï¼Œæ‰€æœ‰å®Œæ•´çš„ç”¨æˆ·è®°å½•éƒ½å­˜æ”¾åœ¨è¿™ä¸ªèšç°‡ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å¤„ã€‚è¿™ç§èšç°‡ç´¢å¼•å¹¶ä¸éœ€è¦æˆ‘ä»¬åœ¨&lt;code&gt;MySQL&lt;/code&gt;è¯­å¥ä¸­æ˜¾å¼çš„ä½¿ç”¨&lt;code&gt;INDEX&lt;/code&gt;è¯­å¥å»åˆ›å»ºã€‚&lt;code&gt;InnoDB&lt;/code&gt;å­˜å‚¨å¼•æ“ä¼šè‡ªåŠ¨çš„ä¸ºæˆ‘ä»¬åˆ›å»ºèšç°‡ç´¢å¼•ã€‚åœ¨&lt;code&gt;InnoDB&lt;/code&gt;å­˜å‚¨å¼•æ“ä¸­ï¼Œèšç°‡ç´¢å¼•å°±æ˜¯æ•°æ®çš„å­˜å‚¨æ–¹å¼ï¼ˆæ‰€æœ‰çš„ç”¨æˆ·è®°å½•éƒ½å­˜å‚¨åœ¨äº†å¶å­èŠ‚ç‚¹ï¼‰ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„&lt;strong&gt;ç´¢å¼•å³æ•°æ®&lt;/strong&gt;ï¼Œæ•°æ®å³ç´¢å¼•ã€‚&lt;/p&gt;
&lt;h4 id=&#34;myisam-çš„-bæ ‘éèšç°‡ç´¢å¼•&#34;&gt;&lt;code&gt;MyISAM&lt;/code&gt; çš„ B+æ ‘ï¼šéèšç°‡ç´¢å¼•&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;InnoDB&lt;/code&gt; ä¸­ç´¢å¼•å³æ•°æ®ï¼Œä¹Ÿå°±æ˜¯èšç°‡ç´¢å¼•çš„é‚£æ£µB+æ ‘çš„å¶å­èŠ‚ç‚¹ä¸­å·²ç»æŠŠæ‰€æœ‰å®Œæ•´çš„ç”¨æˆ·è®°å½•éƒ½åŒ…å«äº†ï¼Œè€Œ&lt;code&gt;MyISAM&lt;/code&gt; çš„ç´¢å¼•æ–¹æ¡ˆè™½ç„¶ä¹Ÿä½¿ç”¨æ ‘å½¢ç»“æ„ï¼Œä½†æ˜¯å´å°†&lt;strong&gt;ç´¢å¼•å’Œæ•°æ®åˆ†å¼€å­˜å‚¨&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;å°†è¡¨ä¸­çš„è®°å½•æŒ‰ç…§è®°å½•çš„&lt;strong&gt;æ’å…¥é¡ºåº&lt;/strong&gt;å•ç‹¬å­˜å‚¨åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œç§°ä¹‹ä¸ºæ•°æ®æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶å¹¶ä¸åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªæ•°æ®é¡µï¼Œæœ‰å¤šå°‘è®°å½•å°±å¾€è¿™ä¸ªæ–‡ä»¶ä¸­å¡å¤šå°‘è®°å½•å°±æˆäº†ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡&lt;strong&gt;è¡Œå·&lt;/strong&gt;è€Œå¿«é€Ÿè®¿é—®åˆ°ä¸€æ¡è®°å½•ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;MyISAM&lt;/code&gt; å­˜å‚¨å¼•æ“çš„è¡¨ä¼šæŠŠç´¢å¼•ä¿¡æ¯å¦å¤–å­˜å‚¨åˆ°ä¸€ä¸ªç§°ä¸º&lt;strong&gt;ç´¢å¼•æ–‡ä»¶&lt;/strong&gt;çš„å¦ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚&lt;code&gt;MyISAM&lt;/code&gt;ä¼šå•ç‹¬ä¸ºè¡¨çš„ä¸»é”®åˆ›å»ºä¸€ä¸ªç´¢å¼•ï¼Œåªä¸è¿‡åœ¨ç´¢å¼•çš„&lt;strong&gt;å¶å­èŠ‚ç‚¹&lt;/strong&gt;ä¸­å­˜å‚¨çš„ä¸æ˜¯å®Œæ•´çš„ç”¨æˆ·è®°å½•ï¼Œè€Œæ˜¯&lt;strong&gt;ä¸»é”®å€¼+è¡Œå·&lt;/strong&gt;çš„ç»„åˆã€‚ä¹Ÿå°±æ˜¯å…ˆé€šè¿‡ç´¢å¼•æ‰¾åˆ°å¯¹åº”çš„è¡Œå·ï¼Œå†é€šè¿‡è¡Œå·å»æ‰¾å¯¹åº”çš„è®°å½•ï¼è¿™ä¸€ç‚¹å’Œ&lt;code&gt;InnoDB&lt;/code&gt;æ˜¯å®Œå…¨ä¸ç›¸åŒçš„ï¼Œåœ¨&lt;code&gt;lnnoDB&lt;/code&gt;å­˜å‚¨å¼•æ“ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦æ ¹æ®ä¸»é”®å€¼å¯¹èšç°‡ç´¢å¼•è¿›è¡Œä¸€æ¬¡æŸ¥æ‰¾å°±èƒ½æ‰¾åˆ°å¯¹åº”çš„è®°å½•ï¼Œè€Œåœ¨&lt;code&gt;MyISAM&lt;/code&gt;ä¸­å´éœ€è¦è¿›è¡Œä¸€æ¬¡å›è¡¨æ“ä½œï¼Œæ„å‘³ç€&lt;code&gt;MyISAM&lt;/code&gt;ä¸­å»ºç«‹çš„ç´¢å¼•ç›¸å½“äºå…¨éƒ¨éƒ½æ˜¯äºŒçº§ç´¢å¼•ï¼&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¦‚æœæœ‰éœ€è¦çš„è¯ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹å…¶å®ƒçš„åˆ—åˆ†åˆ«å»ºç«‹ç´¢å¼•æˆ–è€…å»ºç«‹è”åˆç´¢å¼•ï¼ŒåŸç†å’Œ&lt;code&gt;InnoDB&lt;/code&gt;ä¸­çš„ç´¢å¼•å·®ä¸å¤šï¼Œä¸è¿‡åœ¨å¶å­èŠ‚ç‚¹å¤„å­˜å‚¨çš„æ˜¯ç›¸åº”çš„&lt;strong&gt;åˆ—+è¡Œå·&lt;/strong&gt;ã€‚è¿™äº›ç´¢å¼•ä¹Ÿå…¨éƒ¨éƒ½æ˜¯äºŒçº§ç´¢å¼•ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆä¸è‡ªåŠ¨ä¸ºæ¯ä¸ªåˆ—éƒ½å»ºç«‹ä¸ªç´¢å¼•å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;â‘  å½“å¯¹è¡¨ä¸­çš„æ•°æ®è¿›è¡Œå¢åŠ ã€åˆ é™¤å’Œä¿®æ”¹çš„æ—¶å€™ï¼Œç´¢å¼•ä¹Ÿè¦&lt;strong&gt;åŠ¨æ€çš„ç»´æŠ¤&lt;/strong&gt;ï¼Œè¿™æ ·å°±é™ä½äº†æ•°æ®çš„ç»´æŠ¤é€Ÿåº¦ã€‚&lt;/p&gt;
&lt;p&gt;â‘¡ ç´¢å¼•éœ€è¦å &lt;strong&gt;ç‰©ç†ç©ºé—´&lt;/strong&gt;ï¼Œé™¤äº†æ•°æ®è¡¨å æ•°æ®ç©ºé—´ä¹‹å¤–ï¼Œæ¯ä¸€ä¸ªç´¢å¼•è¿˜è¦å ä¸€å®šçš„ç‰©ç†ç©ºé—´ï¼Œå¦‚æœè¦å»ºç«‹èšç°‡ç´¢å¼•ï¼Œé‚£ä¹ˆéœ€è¦çš„ç©ºé—´å°±ä¼šæ›´å¤§ã€‚&lt;/p&gt;
&lt;p&gt;â‘¢ åˆ›å»ºç´¢å¼•å’Œç»´æŠ¤ç´¢å¼•è¦&lt;strong&gt;è€—è´¹æ—¶é—´&lt;/strong&gt;ï¼Œè¿™ç§æ—¶é—´éšç€æ•°æ®é‡çš„å¢åŠ è€Œå¢åŠ ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;äºŒçº§ç´¢å¼•è¾…åŠ©ç´¢å¼•&#34;&gt;äºŒçº§ç´¢å¼•ï¼ˆè¾…åŠ©ç´¢å¼•ï¼‰&lt;/h3&gt;
&lt;p&gt;èšç°‡ç´¢å¼•åªèƒ½åœ¨æœç´¢æ¡ä»¶æ˜¯ä¸»é”®å€¼æ—¶æ‰èƒ½å‘æŒ¥ä½œç”¨ï¼Œå› ä¸ºB+æ ‘ä¸­çš„æ•°æ®éƒ½æ˜¯æŒ‰ç…§ä¸»é”®è¿›è¡Œæ’åºçš„ã€‚å½“æˆ‘ä»¬æƒ³ä»¥åˆ«çš„åˆ—ä½œä¸ºæœç´¢æ¡ä»¶æ—¶æˆ‘ä»¬å¯ä»¥å¤šå»ºå‡ æ£µB+æ ‘ï¼Œä¸åŒçš„B+æ ‘ä¸­çš„æ•°æ®é‡‡ç”¨ä¸åŒçš„æ’åºè§„åˆ™ã€‚&lt;/p&gt;
&lt;p&gt;äºŒçº§ç´¢å¼•ä¸èšç°‡ç´¢å¼•æœ‰å‡ å¤„ä¸åŒï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æŒ‰&lt;strong&gt;æŒ‡å®šçš„ç´¢å¼•åˆ—çš„å€¼&lt;/strong&gt;æ¥è¿›è¡Œæ’åº&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¶å­èŠ‚ç‚¹&lt;/strong&gt;å­˜å‚¨çš„ä¸æ˜¯å®Œæ•´çš„ç”¨æˆ·è®°å½•ï¼Œè€Œåªæ˜¯&lt;strong&gt;ç´¢å¼•åˆ—+ä¸»é”®&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç›®å½•é¡¹è®°å½•ä¸­ä¸æ˜¯ä¸»é”®+é¡µå·ï¼Œå˜æˆäº†&lt;strong&gt;ç´¢å¼•åˆ—+é¡µå·&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åœ¨å¯¹äºŒçº§ç´¢å¼•è¿›è¡ŒæŸ¥æ‰¾æ•°æ®æ—¶ï¼Œéœ€è¦æ ¹æ®ä¸»é”®å€¼å»èšç°‡ç´¢å¼•ä¸­å†æŸ¥æ‰¾ä¸€éå®Œæ•´çš„ç”¨æˆ·è®°å½•ï¼Œè¿™ä¸ªè¿‡ç¨‹å«åš &lt;strong&gt;å›è¡¨&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;è”åˆç´¢å¼•&#34;&gt;è”åˆç´¢å¼•&lt;/h3&gt;
&lt;p&gt;ä»¥å¤šä¸ªåˆ—çš„å¤§å°ä¸ºæ’åºè§„åˆ™å»ºç«‹çš„ B+æ ‘ ç§°ä¸ºè”åˆç´¢å¼•ï¼Œæœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€ä¸ªäºŒçº§ç´¢å¼•ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è¦†ç›–ç´¢å¼•&#34;&gt;è¦†ç›–ç´¢å¼•&lt;/h2&gt;
&lt;h3 id=&#34;ä»€ä¹ˆæ˜¯è¦†ç›–ç´¢å¼•&#34;&gt;ä»€ä¹ˆæ˜¯è¦†ç›–ç´¢å¼•&lt;/h3&gt;
&lt;p&gt;å¦‚æœ&lt;strong&gt;ä¸€ä¸ªç´¢å¼•åŒ…å«ï¼ˆæˆ–è€…è¯´è¦†ç›–ï¼‰æ‰€æœ‰éœ€è¦æŸ¥è¯¢çš„å­—æ®µçš„å€¼&lt;/strong&gt;ï¼Œæˆ‘ä»¬å°±ç§°ä¹‹ä¸ºâ€œè¦†ç›–ç´¢å¼•â€ã€‚æˆ‘ä»¬çŸ¥é“åœ¨&lt;code&gt;InnoDB&lt;/code&gt;å­˜å‚¨å¼•æ“ä¸­ï¼Œå¦‚æœä¸æ˜¯ä¸»é”®ç´¢å¼•ï¼Œå¶å­èŠ‚ç‚¹å­˜å‚¨çš„æ˜¯ä¸»é”®+åˆ—å€¼ã€‚æœ€ç»ˆè¿˜æ˜¯è¦â€œå›è¡¨â€ï¼Œä¹Ÿå°±æ˜¯è¦é€šè¿‡ä¸»é”®å†æŸ¥æ‰¾ä¸€æ¬¡ã€‚è¿™æ ·å°±ä¼šæ¯”è¾ƒæ…¢ã€‚è¦†ç›–ç´¢å¼•å°±æ˜¯æŠŠè¦æŸ¥è¯¢å‡ºçš„åˆ—å’Œç´¢å¼•æ˜¯å¯¹åº”çš„ï¼Œä¸åšå›è¡¨æ“ä½œï¼&lt;/p&gt;
&lt;h3 id=&#34;è¦†ç›–ç´¢å¼•ä½¿ç”¨å®ä¾‹&#34;&gt;è¦†ç›–ç´¢å¼•ä½¿ç”¨å®ä¾‹&lt;/h3&gt;
&lt;p&gt;ç°åœ¨æˆ‘åˆ›å»ºäº†ç´¢å¼•(username,age)ï¼Œåœ¨æŸ¥è¯¢æ•°æ®çš„æ—¶å€™ï¼š&lt;code&gt;select username , age from user where username = &#39;Java&#39; and age = 22&lt;/code&gt;ã€‚è¦æŸ¥è¯¢å‡ºçš„åˆ—åœ¨å¶å­èŠ‚ç‚¹éƒ½å­˜åœ¨ï¼æ‰€ä»¥ï¼Œå°±ä¸ç”¨å›è¡¨ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç›®å½•é¡¹è®°å½•çš„å”¯ä¸€æ€§&#34;&gt;ç›®å½•é¡¹è®°å½•çš„å”¯ä¸€æ€§&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬éœ€è¦ä¿è¯åœ¨ B+æ ‘ çš„åŒä¸€å±‚å†…èŠ‚ç‚¹çš„ç›®å½•é¡¹è®°å½•é™¤é¡µå·è¿™ä¸ªå­—æ®µä»¥å¤–æ˜¯å”¯ä¸€çš„ã€‚æ‰€ä»¥å¯¹äºäºŒçº§ç´¢å¼•çš„å†…èŠ‚ç‚¹çš„ç›®å½•é¡¹è®°å½•çš„å†…å®¹å®é™…ä¸Šæ˜¯ç”±ä¸‰ä¸ªéƒ¨åˆ†æ„æˆçš„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ç´¢å¼•åˆ—çš„å€¼&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¸»é”®å€¼&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é¡µå·&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;bæ ‘çš„ç´¢å¼•æ€»ç»“&#34;&gt;B+æ ‘çš„ç´¢å¼•æ€»ç»“&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æ¯ä¸ªç´¢å¼•éƒ½å¯¹åº”ä¸€æ£µ&lt;strong&gt;B+æ ‘&lt;/strong&gt;ã€‚ç”¨æˆ·è®°å½•éƒ½å­˜å‚¨åœ¨ B+æ ‘ çš„å¶å­èŠ‚ç‚¹ï¼Œæ‰€æœ‰ç›®å½•è®°å½•éƒ½å­˜å‚¨åœ¨éå¶å­èŠ‚ç‚¹ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;InnoDB&lt;/code&gt;å­˜å‚¨å¼•æ“ä¼šè‡ªåŠ¨ä¸º&lt;strong&gt;ä¸»é”®&lt;/strong&gt;ï¼ˆå¦‚æœæ²¡æœ‰å®ƒä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬æ·»åŠ ï¼‰å»ºç«‹&lt;strong&gt;èšç°‡ç´¢å¼•&lt;/strong&gt;ï¼Œèšç°‡ç´¢å¼•çš„å¶å­èŠ‚ç‚¹åŒ…å«å®Œæ•´çš„ç”¨æˆ·è®°å½•ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¯ä»¥ä¸ºæŒ‡å®šçš„åˆ—å»ºç«‹äºŒçº§ç´¢å¼•ï¼ŒäºŒçº§ç´¢å¼•çš„å¶å­èŠ‚ç‚¹åŒ…å«çš„ç”¨æˆ·è®°å½•ç”±&lt;strong&gt;ç´¢å¼•åˆ— + ä¸»é”®&lt;/strong&gt;ç»„æˆï¼Œæ‰€ä»¥å¦‚æœæƒ³é€šè¿‡äºŒçº§ç´¢å¼•æ¥æŸ¥æ‰¾å®Œæ•´çš„ç”¨æˆ·è®°å½•çš„è¯ï¼Œéœ€è¦é€šè¿‡&lt;strong&gt;å›è¡¨&lt;/strong&gt;æ“ä½œï¼Œä¹Ÿå°±æ˜¯åœ¨é€šè¿‡äºŒçº§ç´¢å¼•æ‰¾åˆ°ä¸»é”®å€¼ä¹‹åå†åˆ°èšç°‡ç´¢å¼•ä¸­æŸ¥æ‰¾å®Œæ•´çš„ç”¨æˆ·è®°å½•ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;B+æ ‘ä¸­æ¯å±‚èŠ‚ç‚¹éƒ½æ˜¯æŒ‰ç…§ç´¢å¼•åˆ—å€¼ä»å°åˆ°å¤§çš„é¡ºåºæ’åºè€Œç»„æˆäº†åŒå‘é“¾è¡¨ï¼Œè€Œä¸”æ¯ä¸ªé¡µå†…çš„è®°å½•ï¼ˆä¸è®ºæ˜¯ç”¨æˆ·è®°å½•è¿˜æ˜¯ç›®å½•é¡¹è®°å½•ï¼‰éƒ½æ˜¯æŒ‰ç…§ç´¢å¼•åˆ—çš„å€¼ä»å°åˆ°å¤§çš„é¡ºåºè€Œå½¢æˆäº†ä¸€ä¸ªå•é“¾è¡¨ã€‚å¦‚æœæ˜¯è”åˆç´¢å¼•çš„è¯ï¼Œåˆ™é¡µé¢å’Œè®°å½•å…ˆæŒ‰ç…§è”åˆç´¢å¼•å‰è¾¹çš„åˆ—æ’åºï¼Œå¦‚æœè¯¥åˆ—å€¼ç›¸åŒï¼Œå†æŒ‰ç…§è”åˆç´¢å¼•åè¾¹çš„åˆ—æ’åºã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é€šè¿‡ç´¢å¼•æŸ¥æ‰¾è®°å½•æ˜¯ä» B+æ ‘ çš„æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œä¸€å±‚ä¸€å±‚å‘ä¸‹æœç´¢ã€‚ç”±äºæ¯ä¸ªé¡µé¢éƒ½æŒ‰ç…§ç´¢å¼•åˆ—çš„å€¼å»ºç«‹äº†é¡µç›®å½•ï¼Œæ‰€ä»¥åœ¨è¿™äº›é¡µé¢ä¸­çš„æŸ¥æ‰¾éå¸¸å¿«ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¡¨ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;create table t1(
  a int primary key, 
  b int,
  c int,
  d int, 
  e varchar(20)
)engine=InnoDB;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¡¨è®°å½•ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%A1%A8%E8%AE%B0%E5%BD%95.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;åˆ›å»ºç´¢å¼•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;create index idx_t1_bcd on t1(b,c,d);
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B4%A2%E5%BC%95.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;è‡ªè¡Œåˆ›å»ºç´¢å¼•&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E4%B8%BB%E9%94%AE%E7%B4%A2%E5%BC%95.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;ä¸»é”®ç´¢å¼•&lt;/p&gt;
&lt;h2 id=&#34;ç´¢å¼•çš„ä»£ä»·&#34;&gt;ç´¢å¼•çš„ä»£ä»·&lt;/h2&gt;
&lt;h3 id=&#34;ç©ºé—´ä¸Šçš„ä»£ä»·&#34;&gt;ç©ºé—´ä¸Šçš„ä»£ä»·&lt;/h3&gt;
&lt;p&gt;æ¯å»ºç«‹ä¸€ä¸ªç´¢å¼•éƒ½ä¸ºè¦å®ƒå»ºç«‹ä¸€æ£µ B+æ ‘ï¼Œæ¯ä¸€æ£µ &lt;strong&gt;B+æ ‘ çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€ä¸ªæ•°æ®é¡µ&lt;/strong&gt;ï¼Œä¸€ä¸ªé¡µé»˜è®¤ä¼šå ç”¨ &lt;strong&gt;16KB&lt;/strong&gt; çš„å­˜å‚¨ç©ºé—´ï¼Œä¸€æ£µå¾ˆå¤§çš„ B+æ ‘ ç”±è®¸å¤šæ•°æ®é¡µç»„æˆï¼Œé‚£æ˜¯å¾ˆå¤§çš„ä¸€ç‰‡å­˜å‚¨ç©ºé—´ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ—¶é—´ä¸Šçš„ä»£ä»·&#34;&gt;æ—¶é—´ä¸Šçš„ä»£ä»·&lt;/h3&gt;
&lt;p&gt;æ¯æ¬¡å¯¹è¡¨ä¸­çš„æ•°æ®è¿›è¡Œå¢ã€åˆ ã€æ”¹æ“ä½œæ—¶ï¼Œéƒ½éœ€è¦å»ä¿®æ”¹å„ä¸ª B+æ ‘ ç´¢å¼•ã€‚è€Œä¸”æˆ‘ä»¬è®²è¿‡ï¼ŒB+æ ‘ æ¯å±‚èŠ‚ç‚¹éƒ½æ˜¯æŒ‰ç…§ç´¢å¼•åˆ—çš„å€¼ä»å°åˆ°å¤§çš„é¡ºåºæ’åºè€Œç»„æˆäº†åŒå‘é“¾è¡¨ã€‚ä¸è®ºæ˜¯å¶å­èŠ‚ç‚¹ä¸­çš„è®°å½•ï¼Œè¿˜æ˜¯å†…èŠ‚ç‚¹ä¸­çš„è®°å½•ï¼ˆä¹Ÿå°±æ˜¯ä¸è®ºæ˜¯ç”¨æˆ·è®°å½•è¿˜æ˜¯ç›®å½•é¡¹è®°å½•ï¼‰éƒ½æ˜¯æŒ‰ç…§ç´¢å¼•åˆ—çš„å€¼ä»å°åˆ°å¤§çš„é¡ºåºè€Œå½¢æˆäº†ä¸€ä¸ªå•å‘é“¾è¡¨ã€‚è€Œå¢ã€åˆ ã€æ”¹æ“ä½œå¯èƒ½ä¼šå¯¹èŠ‚ç‚¹å’Œè®°å½•çš„æ’åºé€ æˆç ´åï¼Œæ‰€ä»¥å­˜å‚¨å¼•æ“éœ€è¦é¢å¤–çš„æ—¶é—´è¿›è¡Œä¸€äº›è®°å½•ç§»ä½ï¼Œé¡µé¢åˆ†è£‚ã€é¡µé¢å›æ”¶å•¥çš„æ“ä½œæ¥ç»´æŠ¤å¥½èŠ‚ç‚¹å’Œè®°å½•çš„æ’åºã€‚å¦‚æœæˆ‘ä»¬å»ºäº†è®¸å¤šç´¢å¼•ï¼Œæ¯ä¸ªç´¢å¼•å¯¹åº”çš„ B+æ ‘ éƒ½è¦è¿›è¡Œç›¸å…³çš„ç»´æŠ¤æ“ä½œã€‚&lt;/p&gt;
&lt;h2 id=&#34;bæ ‘ç´¢å¼•å®æˆ˜&#34;&gt;B+æ ‘ç´¢å¼•å®æˆ˜&lt;/h2&gt;
&lt;h3 id=&#34;å…¨å€¼åŒ¹é…&#34;&gt;å…¨å€¼åŒ¹é…&lt;/h3&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬çš„æœç´¢æ¡ä»¶ä¸­çš„åˆ—å’Œç´¢å¼•åˆ—ä¸€è‡´çš„è¯ï¼Œè¿™ç§æƒ…å†µå°±ç§°ä¸ºå…¨å€¼åŒ¹é…ï¼Œæ¯”æ–¹è¯´ä¸‹è¾¹è¿™ä¸ªæŸ¥æ‰¾è¯­å¥ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;select * from t1 where b=1 and c=1 and d=1ï¼›
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;MySQL&lt;/code&gt;ä¸­æœ‰æŸ¥è¯¢ä¼˜åŒ–å™¨ï¼Œä¼šåˆ†æè¿™äº›æœç´¢æ¡ä»¶å¹¶ä¸”æŒ‰ç…§å¯ä»¥ä½¿ç”¨çš„ç´¢å¼•ä¸­åˆ—çš„é¡ºåºæ¥å†³å®šå…ˆä½¿ç”¨å“ªä¸ªæœç´¢æ¡ä»¶ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åŒ¹é…å·¦è¾¹çš„åˆ—&#34;&gt;åŒ¹é…å·¦è¾¹çš„åˆ—&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;select * from t1 where b=1ï¼›
select * from t1 where b=1 and c=1ï¼›
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸‹é¢è¿™ä¸ª&lt;code&gt;sql&lt;/code&gt;æ˜¯ç”¨ä¸åˆ°ç´¢å¼•çš„&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;select * from t1 where c = 1ï¼›
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å› ä¸º B+æ ‘ çš„æ•°æ®é¡µå’Œè®°å½•å…ˆæ˜¯æŒ‰ç…§ b åˆ—çš„å€¼æ’åºçš„ï¼Œåœ¨ b åˆ—çš„å€¼ç›¸åŒçš„æƒ…å†µä¸‹æ‰ä½¿ç”¨ c åˆ—è¿›è¡Œæ’åºï¼Œä¹Ÿå°±æ˜¯è¯´ b åˆ—çš„å€¼ä¸åŒçš„è®°å½•ä¸­ c çš„å€¼å¯èƒ½æ˜¯æ— åºçš„ã€‚è€Œç°åœ¨ä½ è·³è¿‡ b åˆ—ç›´æ¥æ ¹æ® c çš„å€¼å»æŸ¥æ‰¾ï¼Œè¿™æ˜¯åšä¸åˆ°çš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åŒ¹é…åˆ—å‰ç¼€&#34;&gt;&lt;strong&gt;åŒ¹é…åˆ—å‰ç¼€&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœåªç»™å‡ºåç¼€æˆ–è€…ä¸­é—´çš„æŸä¸ªå­—ç¬¦ä¸²ï¼Œæ¯”å¦‚è¿™æ ·ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;select * from t1 where b like &#39;&#39;%101%&#39;;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;MySQL å°±æ— æ³•å¿«é€Ÿå®šä½è®°å½•ä½ç½®äº†ï¼Œæ‰€ä»¥åªèƒ½å…¨è¡¨æ‰«æäº†ã€‚æœ‰æ—¶å€™æˆ‘ä»¬æœ‰ä¸€äº›åŒ¹é…æŸäº›å­—ç¬¦ä¸²åç¼€çš„éœ€æ±‚ï¼Œæ¯”æ–¹è¯´æŸä¸ªè¡¨æœ‰ä¸€ä¸ªurlåˆ—ï¼Œè¯¥åˆ—ä¸­å­˜å‚¨äº†è®¸å¤šurlï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;www.baidu.com 

www.google.com 

www.qq.com
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å‡è®¾å·²ç»å¯¹è¯¥ url åˆ—åˆ›å»ºäº†ç´¢å¼•ï¼Œå¦‚æœæˆ‘ä»¬æƒ³æŸ¥è¯¢ä»¥ com ä¸ºåç¼€çš„ç½‘å€çš„è¯å¯ä»¥è¿™æ ·å†™æŸ¥è¯¢æ¡ä»¶ï¼šWHERE url LIKE &#39;%com&#39;ï¼Œä½†æ˜¯è¿™æ ·çš„è¯æ— æ³•ä½¿ç”¨è¯¥ url åˆ—çš„ç´¢å¼•ã€‚ä¸ºäº†åœ¨æŸ¥è¯¢æ—¶ç”¨åˆ°è¿™ä¸ªç´¢å¼•è€Œä¸è‡³äºå…¨è¡¨æ‰«æï¼Œæˆ‘ä»¬å¯ä»¥æŠŠåç¼€æŸ¥è¯¢æ”¹å†™æˆå‰ç¼€æŸ¥è¯¢ï¼Œä¸è¿‡æˆ‘ä»¬å°±å¾—æŠŠè¡¨ä¸­çš„æ•°æ®å…¨éƒ¨é€†åºå­˜å‚¨ä¸€ä¸‹ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥è¿™æ ·ä¿å­˜ url åˆ—ä¸­çš„æ•°æ®ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;moc.udiab.www 

moc.e1goog.www

moc.qq.www
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™æ ·å†æŸ¥æ‰¾ä»¥comä¸ºåç¼€çš„ç½‘å€æ—¶æœç´¢æ¡ä»¶ä¾¿å¯ä»¥è¿™ä¹ˆå†™ï¼šWHERE url LIKE &#39;moc%&#39;ï¼Œè¿™æ ·å°±å¯ä»¥ç”¨åˆ°ç´¢å¼•äº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åŒ¹é…èŒƒå›´å€¼&#34;&gt;åŒ¹é…èŒƒå›´å€¼&lt;/h3&gt;
&lt;p&gt;æŸ¥è¯¢æ–¹å¼ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;è¾…åŠ©ç´¢å¼•æŸ¥è¯¢æˆæœ¬+å›è¡¨æˆæœ¬&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å…¨è¡¨æ‰«ææˆæœ¬&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ‰€æœ‰è®°å½•éƒ½æ˜¯æŒ‰ç…§ç´¢å¼•åˆ—çš„å€¼ä»å°åˆ°å¤§çš„é¡ºåºæ’å¥½åºçš„ï¼Œæ‰€ä»¥è¿™æå¤§çš„æ–¹ä¾¿æˆ‘ä»¬æŸ¥æ‰¾ç´¢å¼•åˆ—çš„å€¼åœ¨æŸä¸ªèŒƒå›´å†…çš„è®°å½•ã€‚æ¯”æ–¹è¯´ä¸‹è¾¹è¿™ä¸ªæŸ¥è¯¢è¯­å¥ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;select * from t1 where b &amp;gt; 1 and b &amp;lt; 2000;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç”±äºB+æ ‘ä¸­çš„æ•°æ®é¡µå’Œè®°å½•æ˜¯å…ˆæŒ‰ b åˆ—æ’åºçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸Šè¾¹çš„æŸ¥è¯¢è¿‡ç¨‹å…¶å®æ˜¯è¿™æ ·çš„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æ‰¾åˆ° b å€¼ä¸º 1 çš„è®°å½•ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ‰¾åˆ° b å€¼ä¸º 20000 çš„è®°å½•ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç”±äºæ‰€æœ‰è®°å½•éƒ½æ˜¯ç”±é“¾è¡¨è¿èµ·æ¥çš„ï¼ˆè®°å½•ä¹‹é—´ç”¨å•é“¾è¡¨ï¼Œæ•°æ®é¡µä¹‹é—´ç”¨åŒé“¾è¡¨ï¼‰ï¼Œæ‰€ä»¥ä»–ä»¬ä¹‹é—´çš„è®°å½•éƒ½å¯ä»¥å¾ˆå®¹æ˜“çš„å–å‡ºæ¥&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ‰¾åˆ°è¿™äº›è®°å½•çš„ä¸»é”®å€¼ï¼Œå†åˆ°èšç°‡ç´¢å¼•ä¸­å›è¡¨æŸ¥æ‰¾å®Œæ•´çš„è®°å½•ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸è¿‡åœ¨ä½¿ç”¨è”åˆè¿›è¡ŒèŒƒå›´æŸ¥æ‰¾çš„æ—¶å€™éœ€è¦æ³¨æ„ï¼Œå¦‚æœå¯¹å¤šä¸ªåˆ—åŒæ—¶è¿›è¡ŒèŒƒå›´æŸ¥æ‰¾çš„è¯ï¼Œåªæœ‰å¯¹ç´¢å¼•æœ€å·¦è¾¹çš„é‚£ä¸ªåˆ—è¿›è¡ŒèŒƒå›´æŸ¥æ‰¾çš„æ—¶å€™æ‰èƒ½ç”¨åˆ° B+æ ‘ ç´¢å¼•ï¼Œæ¯”æ–¹è¯´è¿™æ ·ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;select * from t1 where b &amp;gt; 1 and c &amp;gt; 1;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¾¹è¿™ä¸ªæŸ¥è¯¢å¯ä»¥åˆ†æˆä¸¤ä¸ªéƒ¨åˆ†ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;é€šè¿‡æ¡ä»¶ b&amp;gt;1 æ¥å¯¹ b è¿›è¡ŒèŒƒå›´æŸ¥æ‰¾ï¼ŒæŸ¥æ‰¾çš„ç»“æœå¯èƒ½æœ‰å¤šæ¡ b å€¼ä¸åŒçš„è®°å½•ï¼Œ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¯¹è¿™äº› b å€¼ä¸åŒçš„è®°å½•ç»§ç»­é€šè¿‡ c&amp;gt;1 ç»§ç»­è¿‡æ»¤ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¿™æ ·å­å¯¹äºè”åˆç´¢å¼•æ¥è¯´ï¼Œåªèƒ½ç”¨åˆ° b åˆ—çš„éƒ¨åˆ†ï¼Œè€Œç”¨ä¸åˆ° c åˆ—çš„éƒ¨åˆ†ï¼Œå› ä¸ºåªæœ‰ b å€¼ç›¸åŒçš„æƒ…å†µä¸‹æ‰èƒ½ç”¨ c åˆ—çš„å€¼è¿›è¡Œæ’åºï¼ˆselect * from t1 where b = 1 and c &amp;gt;1ï¼‰ï¼Œè€Œè¿™ä¸ªæŸ¥è¯¢ä¸­é€šè¿‡ b è¿›è¡ŒèŒƒå›´æŸ¥æ‰¾çš„è®°å½•ä¸­å¯èƒ½å¹¶ä¸æ˜¯æŒ‰ç…§ c åˆ—è¿›è¡Œæ’åºçš„ï¼Œæ‰€ä»¥åœ¨æœç´¢æ¡ä»¶ä¸­ç»§ç»­ä»¥ c åˆ—è¿›è¡ŒæŸ¥æ‰¾æ—¶æ˜¯ç”¨ä¸åˆ°è¿™ä¸ªB+æ ‘ç´¢å¼•çš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç²¾ç¡®åŒ¹é…æŸä¸€åˆ—å¹¶èŒƒå›´åŒ¹é…å¦å¤–ä¸€åˆ—&#34;&gt;ç²¾ç¡®åŒ¹é…æŸä¸€åˆ—å¹¶èŒƒå›´åŒ¹é…å¦å¤–ä¸€åˆ—&lt;/h3&gt;
&lt;p&gt;å¯¹äºåŒä¸€ä¸ªè”åˆç´¢å¼•æ¥è¯´ï¼Œè™½ç„¶å¯¹å¤šä¸ªåˆ—éƒ½è¿›è¡ŒèŒƒå›´æŸ¥æ‰¾æ—¶åªèƒ½ç”¨åˆ°æœ€å·¦è¾¹é‚£ä¸ªç´¢å¼•åˆ—ï¼Œä½†æ˜¯å¦‚æœå·¦è¾¹çš„åˆ—æ˜¯ç²¾ç¡®æŸ¥æ‰¾ï¼Œåˆ™å³è¾¹çš„åˆ—å¯ä»¥è¿›è¡ŒèŒƒå›´æŸ¥æ‰¾ï¼Œæ¯”æ–¹è¯´è¿™æ ·ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;select * from t1 where b=1 and c&amp;gt;1ï¼›
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;æ’åº&#34;&gt;æ’åº&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨å†™æŸ¥è¯¢è¯­å¥çš„æ—¶å€™ç»å¸¸éœ€è¦å¯¹æŸ¥è¯¢å‡ºæ¥çš„è®°å½•é€šè¿‡ ORDER BY å­å¥æŒ‰ç…§æŸç§è§„åˆ™è¿›è¡Œæ’åºã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªèƒ½æŠŠè®°å½•éƒ½åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå†ç”¨ä¸€äº›æ’åºç®—æ³•ï¼Œæ¯”å¦‚å¿«é€Ÿæ’åºã€å½’å¹¶æ’åºç­‰ç­‰åœ¨å†…å­˜ä¸­å¯¹è¿™äº›è®°å½•è¿›è¡Œæ’åºï¼Œæœ‰çš„æ—¶å€™å¯èƒ½æŸ¥è¯¢çš„ç»“æœé›†å¤ªå¤§ä»¥è‡³äºä¸èƒ½åœ¨å†…å­˜ä¸­è¿›è¡Œæ’åºçš„è¯ï¼Œè¿˜å¯èƒ½æš‚æ—¶å€ŸåŠ©ç£ç›˜çš„ç©ºé—´æ¥å­˜æ”¾ä¸­é—´ç»“æœï¼Œæ’åºæ“ä½œå®Œæˆåå†æŠŠæ’å¥½åºçš„ç»“æœé›†è¿”å›åˆ°å®¢æˆ·ç«¯ã€‚åœ¨MySQLä¸­ï¼ŒæŠŠè¿™ç§åœ¨å†…å­˜ä¸­æˆ–è€…ç£ç›˜ä¸Šè¿›è¡Œæ’åºçš„æ–¹å¼ç»Ÿç§°ä¸º&lt;strong&gt;æ–‡ä»¶æ’åº&lt;/strong&gt;ï¼ˆè‹±æ–‡åï¼šfilesortï¼‰ï¼Œè¿™äº›æ’åºæ“ä½œéå¸¸æ…¢ã€‚ä½†æ˜¯å¦‚æœ ORDER BY å­å¥é‡Œä½¿ç”¨åˆ°äº†æˆ‘ä»¬çš„ç´¢å¼•åˆ—ï¼Œå°±æœ‰å¯èƒ½çœå»åœ¨å†…å­˜æˆ–æ–‡ä»¶ä¸­æ’åºçš„æ­¥éª¤ï¼Œæ¯”å¦‚ä¸‹è¾¹è¿™ä¸ªç®€å•çš„æŸ¥è¯¢è¯­å¥ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;select * from t1 order by bï¼Œcï¼Œd
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™ä¸ªæŸ¥è¯¢çš„ç»“æœé›†éœ€è¦å…ˆæŒ‰ç…§ b å€¼æ’åºï¼Œå¦‚æœè®°å½•çš„ b å€¼ç›¸åŒï¼Œåˆ™éœ€è¦æŒ‰ç…§ c æ¥æ’åºï¼Œå¦‚æœ c çš„å€¼ç›¸åŒï¼Œåˆ™éœ€è¦æŒ‰ç…§ d æ’åºã€‚å› ä¸ºè¿™ä¸ª B+ æ ‘ç´¢å¼•æœ¬èº«å°±æ˜¯æŒ‰ç…§ä¸Šè¿°è§„åˆ™æ’å¥½åºçš„ï¼Œæ‰€ä»¥ç›´æ¥ä»ç´¢å¼•ä¸­æå–æ•°æ®ï¼Œç„¶åè¿›è¡Œå›è¡¨æ“ä½œå–å‡ºè¯¥ç´¢å¼•ä¸­ä¸åŒ…å«çš„åˆ—å°±å¥½äº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åˆ†ç»„&#34;&gt;åˆ†ç»„&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;select bï¼Œcï¼Œdï¼Œcountï¼ˆ*ï¼‰from t1 group by bï¼Œcï¼Œdï¼›
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™ä¸ªæŸ¥è¯¢è¯­å¥ç›¸å½“äºåšäº†3æ¬¡åˆ†ç»„æ“ä½œï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;å…ˆæŠŠè®°å½•æŒ‰ç…§bå€¼è¿›è¡Œåˆ†ç»„ï¼Œæ‰€æœ‰ b å€¼ç›¸åŒçš„è®°å½•åˆ’åˆ†ä¸ºä¸€ç»„ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å°†æ¯ä¸ª b å€¼ç›¸åŒçš„åˆ†ç»„é‡Œçš„è®°å½•å†æŒ‰ç…§ c çš„å€¼è¿›è¡Œåˆ†ç»„ï¼Œå°† title å€¼ç›¸åŒçš„è®°å½•æ”¾åˆ°ä¸€ä¸ªå°åˆ†ç»„é‡Œï¼Œæ‰€ä»¥çœ‹èµ·æ¥å°±åƒåœ¨ä¸€ä¸ªå¤§åˆ†ç»„é‡ŒåˆåŒ–åˆ†äº†å¥½å¤šå°åˆ†ç»„ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å†å°†ä¸Šä¸€æ­¥ä¸­äº§ç”Ÿçš„å°åˆ†ç»„æŒ‰ç…§ d çš„å€¼åˆ†æˆæ›´å°çš„åˆ†ç»„ï¼Œæ‰€ä»¥æ•´ä½“ä¸Šçœ‹èµ·æ¥å°±åƒæ˜¯å…ˆæŠŠè®°å½•åˆ†æˆä¸€ä¸ªå¤§åˆ†ç»„ï¼Œç„¶åæŠŠå¤§åˆ†ç»„åˆ†æˆè‹¥å¹²ä¸ªå°åˆ†ç»„ï¼Œç„¶åæŠŠè‹¥å¹²ä¸ªå°åˆ†ç»„å†ç»†åˆ†æˆæ›´å¤šçš„å°å°åˆ†ç»„ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç„¶åé’ˆå¯¹é‚£äº›å°å°åˆ†ç»„è¿›è¡Œç»Ÿè®¡ï¼Œæ¯”å¦‚åœ¨æˆ‘ä»¬è¿™ä¸ªæŸ¥è¯¢è¯­å¥ä¸­å°±æ˜¯ç»Ÿè®¡æ¯ä¸ªå°å°åˆ†ç»„åŒ…å«çš„è®°å½•æ¡æ•°ã€‚å¦‚æœæ²¡æœ‰ç´¢å¼•çš„è¯ï¼Œè¿™ä¸ªåˆ†ç»„è¿‡ç¨‹å…¨éƒ¨éœ€è¦åœ¨å†…å­˜é‡Œå®ç°ï¼Œè€Œå¦‚æœæœ‰äº†ç´¢å¼•çš„è¯ï¼Œæ°å·§è¿™ä¸ªåˆ†ç»„é¡ºåºåˆå’Œæˆ‘ä»¬çš„ B+æ ‘ ä¸­çš„ç´¢å¼•åˆ—çš„é¡ºåºæ˜¯ä¸€è‡´çš„ï¼Œè€Œæˆ‘ä»¬çš„ B+æ ‘ ç´¢å¼•åˆæ˜¯æŒ‰ç…§ç´¢å¼•åˆ—æ’å¥½åºçš„ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ä½¿ç”¨ B+æ ‘ ç´¢å¼•è¿›è¡Œåˆ†ç»„ã€‚&lt;/p&gt;
&lt;p&gt;å’Œä½¿ç”¨ B+æ ‘ ç´¢å¼•è¿›è¡Œæ’åºæ˜¯ä¸€ä¸ªé“ç†ï¼Œåˆ†ç»„åˆ—çš„é¡ºåºä¹Ÿéœ€è¦å’Œç´¢å¼•åˆ—çš„é¡ºåºä¸€è‡´ï¼Œä¹Ÿå¯ä»¥åªä½¿ç”¨ç´¢å¼•åˆ—ä¸­å·¦è¾¹çš„åˆ—è¿›è¡Œåˆ†ç»„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä½¿ç”¨è”åˆç´¢å¼•è¿›è¡Œæ’åºæˆ–åˆ†ç»„çš„æ³¨æ„äº‹é¡¹&#34;&gt;ä½¿ç”¨è”åˆç´¢å¼•è¿›è¡Œæ’åºæˆ–åˆ†ç»„çš„æ³¨æ„äº‹é¡¹&lt;/h3&gt;
&lt;p&gt;å¯¹äºè”åˆç´¢å¼•æœ‰ä¸ªé—®é¢˜éœ€è¦æ³¨æ„ï¼ŒORDER BY çš„å­å¥åè¾¹çš„åˆ—çš„é¡ºåºä¹Ÿå¿…é¡»æŒ‰ç…§ç´¢å¼•åˆ—çš„é¡ºåºç»™å‡ºï¼Œå¦‚æœç»™å‡º order by cï¼Œb çš„é¡ºåºï¼Œé‚£ä¹Ÿæ˜¯ç”¨ä¸äº† B+æ ‘ ç´¢å¼•çš„ã€‚&lt;/p&gt;
&lt;p&gt;åŒç†ï¼Œorder by bï¼Œorder by bï¼Œc è¿™ç§åŒ¹é…ç´¢å¼•å·¦è¾¹çš„åˆ—çš„å½¢å¼å¯ä»¥ä½¿ç”¨éƒ¨åˆ†çš„ B+æ ‘ ç´¢å¼•ã€‚å½“è”åˆç´¢å¼•å·¦è¾¹åˆ—çš„å€¼ä¸ºå¸¸é‡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨åè¾¹çš„åˆ—è¿›è¡Œæ’åºï¼Œæ¯”å¦‚è¿™æ ·ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;select * from t1 where b=1 order by cï¼Œdï¼›
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™ä¸ªæŸ¥è¯¢èƒ½ä½¿ç”¨è”åˆç´¢å¼•è¿›è¡Œæ’åºæ˜¯å› ä¸º b åˆ—çš„å€¼ç›¸åŒçš„è®°å½•æ˜¯æŒ‰ç…§ cï¼Œd æ’åºçš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä¸å¯ä»¥ä½¿ç”¨ç´¢å¼•è¿›è¡Œæ’åºæˆ–åˆ†ç»„çš„å‡ ç§æƒ…å†µ&#34;&gt;ä¸å¯ä»¥ä½¿ç”¨ç´¢å¼•è¿›è¡Œæ’åºæˆ–åˆ†ç»„çš„å‡ ç§æƒ…å†µ&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;ASC&lt;/code&gt;ã€&lt;code&gt;DESC&lt;/code&gt;æ··ç”¨&lt;/p&gt;
&lt;p&gt;å¯¹äºä½¿ç”¨è”åˆç´¢å¼•è¿›è¡Œæ’åºçš„åœºæ™¯ï¼Œæˆ‘ä»¬è¦æ±‚å„ä¸ªæ’åºåˆ—çš„æ’åºé¡ºåºæ˜¯ä¸€è‡´çš„ï¼Œä¹Ÿå°±æ˜¯è¦ä¹ˆå„ä¸ªåˆ—éƒ½æ˜¯ &lt;code&gt;ASC&lt;/code&gt; è§„åˆ™æ’åºï¼Œè¦ä¹ˆéƒ½æ˜¯ &lt;code&gt;DESC&lt;/code&gt; è§„åˆ™æ’åºã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ORDER BY å­å¥åçš„åˆ—å¦‚æœä¸åŠ  &lt;code&gt;ASC&lt;/code&gt; æˆ–è€… &lt;code&gt;DESC&lt;/code&gt; é»˜è®¤æ˜¯æŒ‰ç…§ &lt;code&gt;ASC&lt;/code&gt; æ’åºè§„åˆ™æ’åºçš„ï¼Œä¹Ÿå°±æ˜¯å‡åºæ’åºçš„ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;select * from t1 order by b ASCï¼Œc DESCï¼›
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™ä¸ªæŸ¥è¯¢æ—¶ç”¨ä¸åˆ°ç´¢å¼•çš„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¦‚ä½•å»ºç«‹ç´¢å¼•&#34;&gt;å¦‚ä½•å»ºç«‹ç´¢å¼•&lt;/h2&gt;
&lt;h3 id=&#34;è€ƒè™‘ç´¢å¼•é€‰æ‹©æ€§&#34;&gt;è€ƒè™‘ç´¢å¼•é€‰æ‹©æ€§&lt;/h3&gt;
&lt;p&gt;ç´¢å¼•çš„é€‰æ‹©æ€§ï¼ˆSelectivityï¼‰ï¼Œæ˜¯æŒ‡ä¸é‡å¤çš„ç´¢å¼•å€¼ï¼ˆä¹Ÿå«åŸºæ•°ï¼ŒCardinalityï¼‰ä¸è¡¨è®°å½•æ•°çš„æ¯”å€¼ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;é€‰æ‹©æ€§=åŸºæ•°/è®°å½•æ•°
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€‰æ‹©æ€§çš„å–å€¼èŒƒå›´ä¸ºï¼ˆ0ï¼Œ1]ï¼Œé€‰æ‹©æ€§è¶Šé«˜çš„ç´¢å¼•ä»·å€¼è¶Šå¤§ã€‚å¦‚æœé€‰æ‹©æ€§ç­‰äº1ï¼Œå°±ä»£è¡¨è¿™ä¸ªåˆ—çš„ä¸é‡å¤å€¼å’Œè¡¨è®°å½•æ•°æ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¹ˆå¯¹è¿™ä¸ªåˆ—å»ºç«‹ç´¢å¼•æ˜¯éå¸¸åˆé€‚çš„ï¼Œå¦‚æœé€‰æ‹©æ€§éå¸¸å°ï¼Œé‚£ä¹ˆå°±ä»£è¡¨è¿™ä¸ªåˆ—çš„é‡å¤å€¼æ˜¯å¾ˆå¤šçš„ï¼Œä¸é€‚åˆå»ºç«‹ç´¢å¼•ã€‚&lt;/p&gt;
&lt;h3 id=&#34;è€ƒè™‘å‰ç¼€ç´¢å¼•&#34;&gt;è€ƒè™‘å‰ç¼€ç´¢å¼•&lt;/h3&gt;
&lt;p&gt;ç”¨åˆ—çš„å‰ç¼€ä»£æ›¿æ•´ä¸ªåˆ—ä½œä¸ºç´¢å¼• keyï¼Œå½“å‰ç¼€é•¿åº¦åˆé€‚æ—¶ï¼Œå¯ä»¥åšåˆ°æ—¢ä½¿å¾—å‰ç¼€ç´¢å¼•çš„é€‰æ‹©æ€§æ¥è¿‘å…¨åˆ—ç´¢å¼•ï¼ŒåŒæ—¶å› ä¸ºç´¢å¼• key å˜çŸ­è€Œå‡å°‘äº†ç´¢å¼•æ–‡ä»¶çš„å¤§å°å’Œç»´æŠ¤å¼€é”€ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä½¿ç”¨mysqlå®˜ç½‘æä¾›çš„ç¤ºä¾‹æ•°æ®åº“ï¼š&lt;a href=&#34;https://dev.mysql.com/doc/employee/en/employees-installation.html&#34;&gt;https://dev.mysql.com/doc/employee/en/employees-installation.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;githubåœ°å€ï¼š&lt;a href=&#34;https://github.com/datacharmer/test_db&#34;&gt;https://github.com/datacharmer/test_db&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;employeesè¡¨åªæœ‰ä¸€ä¸ªç´¢å¼•&amp;lt;emp_no&amp;gt;ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬æƒ³æŒ‰åå­—æœç´¢ä¸€ä¸ªäººï¼Œå°±åªèƒ½å…¨è¡¨æ‰«æäº†ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;EXPLAIN SELECT * FROM employees.employees WHERE first_name=&#39;Eric&#39; AND last_name=&#39;Anido&#39;;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é‚£ä¹ˆå¯ä»¥å¯¹ &amp;lt;first_name&amp;gt; æˆ– &amp;lt;first_nameï¼Œlast_name&amp;gt; å»ºç«‹ç´¢å¼•ï¼Œçœ‹ä¸‹ä¸¤ä¸ªç´¢å¼•çš„é€‰æ‹©æ€§ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;SELECT count(DISTINCT(first_name))/count(*) AS Selectivity FROM employees.employees; -- 0.0042

SELECT count(DISTINCT(concat(first_name, last_name)))/count(*) AS Selectivity FROM employees.employees; -- 0.9313
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;lt;first_name&amp;gt;æ˜¾ç„¶é€‰æ‹©æ€§å¤ªä½ï¼Œ&amp;lt;first_nameï¼Œlast_name&amp;gt;é€‰æ‹©æ€§å¾ˆå¥½ï¼Œä½†æ˜¯first_nameå’Œlast_nameåŠ èµ·æ¥é•¿åº¦ä¸º30ï¼Œæœ‰æ²¡æœ‰å…¼é¡¾é•¿åº¦å’Œé€‰æ‹©æ€§çš„åŠæ³•ï¼Ÿå¯ä»¥è€ƒè™‘ç”¨first_nameå’Œlast_nameçš„å‰å‡ ä¸ªå­—ç¬¦å»ºç«‹ç´¢å¼•ï¼Œä¾‹å¦‚&amp;lt;first_name, left(last_name, 3)&amp;gt;ï¼Œçœ‹çœ‹å…¶é€‰æ‹©æ€§ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;SELECT count(DISTINCT(concat(first_name, left(last_name, 3))))/count(*) AS Selectivity FROM employees.employees; -- 0.7879
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€‰æ‹©æ€§è¿˜ä¸é”™ï¼Œä½†ç¦»0.9313è¿˜æ˜¯æœ‰ç‚¹è·ç¦»ï¼Œé‚£ä¹ˆæŠŠlast_nameå‰ç¼€åŠ åˆ°4ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;SELECT count(DISTINCT(concat(first_name, left(last_name, 4))))/count(*) AS Selectivity FROM employees.employees; -- 0.9007
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™æ—¶é€‰æ‹©æ€§å·²å¾ˆç†æƒ³äº†ï¼Œè€Œè¿™ä¸ªç´¢å¼•çš„é•¿åº¦åªæœ‰18ï¼Œæ¯”&amp;lt;first_nameï¼Œlast_name&amp;gt;çŸ­äº†æ¥è¿‘ä¸€åŠï¼Œå»ºç«‹å‰ç¼€ç´¢å¼•çš„æ–¹å¼ä¸ºï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;ALTER TABLE employees.employees ADD INDEX first_name_last_name4 (first_name,last_name(4));
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å‰ç¼€ç´¢å¼•å…¼é¡¾ç´¢å¼•å¤§å°å’ŒæŸ¥è¯¢é€Ÿåº¦ï¼Œä½†æ˜¯å…¶ç¼ºç‚¹æ˜¯ä¸èƒ½ç”¨äº OFRDER BY å’Œ GROUP BY æ“ä½œï¼Œä¹Ÿä¸èƒ½ç”¨äºè¦†ç›–ç´¢å¼•ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ç´¢å¼•åˆ—çš„ç±»å‹å°½é‡å°&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åˆ©ç”¨ç´¢å¼•å­—ç¬¦ä¸²å€¼çš„å‰ç¼€&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¸»é”®è‡ªå¢&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å®šä½å¹¶åˆ é™¤è¡¨ä¸­çš„é‡å¤å’Œå†—ä½™ç´¢å¼•&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å°½é‡ä½¿ç”¨è¦†ç›–ç´¢å¼•è¿›è¡ŒæŸ¥è¯¢ï¼Œé¿å…å›è¡¨å¸¦æ¥çš„æ€§èƒ½æŸè€—ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å‚è€ƒèµ„æ–™&#34;&gt;å‚è€ƒèµ„æ–™&lt;/h2&gt;
&lt;p&gt;https://cyc2018.github.io/CS-Notes/#/notes/MySQL&lt;/p&gt;
">MySQL ç´¢å¼•è¯¦è§£</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/yi-pian-wen-zhang-che-di-gao-ding-nio/"" data-c="
          &lt;h1 id=&#34;ç”¨å‘å±•çš„çœ¼å…‰çœ‹çœ‹-bio&#34;&gt;ç”¨å‘å±•çš„çœ¼å…‰çœ‹çœ‹ BIO&lt;/h1&gt;
&lt;h2 id=&#34;jdk14&#34;&gt;JDK1.4&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;java.ioåŒ…  XXX ç±»&lt;/li&gt;
&lt;li&gt;BIOï¼šBlocking IOï¼šåŒæ­¥é˜»å¡çš„ IO&lt;/li&gt;
&lt;li&gt;Socket åº”ç”¨ç¨‹åºï¼š
&lt;ul&gt;
&lt;li&gt;ç›‘å¬ç«¯å£ï¼šServerSocket(9999);&lt;/li&gt;
&lt;li&gt;è·å–å®¢æˆ·ç«¯çš„ Socketï¼šserverSocket.accept();&lt;/li&gt;
&lt;li&gt;è·å– IO æµå¯¹è±¡ï¼Œè¿›è¡ŒæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯çš„æ•°æ®äº¤äº’ï¼šsocket.getInputStream()ã€getOutputStream()&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;jdk14-ä¹‹å&#34;&gt;JDK1.4 ä¹‹å&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;NIOï¼šNon-Blocking IO åŒæ­¥éé˜»å¡&lt;/li&gt;
&lt;li&gt;java.nio åŒ…&lt;/li&gt;
&lt;li&gt;å¯¹ NIO åšä¸€ä¸ªå°è£…ï¼šnetty&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;å›¾è§£ä¸ä»£ç å±•ç°bioåŠé—®é¢˜æ‰€åœ¨&#34;&gt;å›¾è§£ä¸ä»£ç å±•ç°BIOåŠé—®é¢˜æ‰€åœ¨&lt;/h1&gt;
&lt;h2 id=&#34;å•çº¿ç¨‹-bio&#34;&gt;å•çº¿ç¨‹ BIO&lt;/h2&gt;
&lt;h3 id=&#34;ä»£ç &#34;&gt;ä»£ç &lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;package com.gupao;
import java.io.IOException;
import java.net.ServerSocket;
import java.net.Socket;
import java.util.ArrayList;
import java.util.List;
import java.util.Scanner;
public class BIOServer {
    public static void main(String[] args) {
        byte [] bs = new byte[1024];
        List&amp;lt;Socket&amp;gt; list = new ArrayList&amp;lt;&amp;gt;();
        try(ServerSocket serverSocket = new ServerSocket(9999)) {
            System.out.println(&amp;quot;BIOServer has started, listening on port:&amp;quot; + serverSocket.getLocalSocketAddress());
            while (true){
                Socket clientSocket = serverSocket.accept();
                System.out.println(&amp;quot;Connection from &amp;quot; + clientSocket.getRemoteSocketAddress());
                // ä¸šåŠ¡å¤„ç†çš„ä»£ç    
                try(Scanner input = new Scanner(clientSocket.getInputStream())) {
                    while (true){
                        String request = input.nextLine();
                        if(&amp;quot;quit&amp;quot;.equals(request)){
                            break;
                        }
                        System.out.println(String.format(&amp;quot;From %s : %s&amp;quot;, clientSocket.getRemoteSocketAddress(), request));
                        String response = &amp;quot;From BIOServer Hello &amp;quot; + request + &amp;quot;.\n&amp;quot;;
                        clientSocket.getOutputStream().write(response.getBytes());
                    }
                }
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;è¿è¡Œç»“æœ&#34;&gt;è¿è¡Œç»“æœ&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%8D%95%E7%BA%BF%E7%A8%8BBIO%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;åˆ†æ&#34;&gt;åˆ†æ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ç¬¬ä¸€ä¸ª Server å¯åŠ¨ï¼Œ é˜»å¡åœ¨ accept() æ–¹æ³•ä¸Šï¼Œç­‰å¾…ç¬¬äºŒä¸ª Server çš„è¿æ¥ï¼›&lt;/li&gt;
&lt;li&gt;ç¬¬äºŒä¸ª Server è¿æ¥ä¸Šåï¼Œç¬¬ä¸€ä¸ª Server ä¸å†é˜»å¡åœ¨ accept() ä¸Šï¼Œç»§ç»­å‘ä¸‹è¿è¡Œï¼Œé˜»å¡åœ¨ Scanner çš„ nextLine() æ–¹æ³•ä¸Šï¼Œç­‰å¾…ç¬¬äºŒä¸ª Server å‘é€æ•°æ®ï¼›&lt;/li&gt;
&lt;li&gt;ç¬¬äºŒä¸ª Server æ•°æ®å‡†å¤‡å¥½åï¼Œç»™ç¬¬ä¸€ä¸ª Server å‘é€æ•°æ®ï¼Œç¬¬ä¸€ä¸ª Server çš„ nextLine() æ–¹æ³•ä¸å†é˜»å¡ï¼Œç»§ç»­å‘ä¸‹è¿è¡Œï¼Œå†æ¬¡è¿›è¡Œ while å¾ªç¯ï¼Œé‡æ–°é˜»å¡åœ¨ â€œç­‰å¾…æ•°æ®å‡†å¤‡å¥½â€ çš„æ–¹æ³•ä¸Šã€‚&lt;/li&gt;
&lt;li&gt;ç¬¬ä¸‰ä¸ª Server è¿›è¡Œè¿æ¥ï¼Œç¬¬ä¸€ä¸ª Server æ— æ³•æ¥æ”¶åˆ°ç¬¬ä¸‰ä¸ª Server è¿æ¥æˆåŠŸè¯·æ±‚ï¼Œç¬¬ä¸‰ä¸ª Server ä¹Ÿæ— æ³•å‘ç¬¬ä¸€ä¸ª Server å‘é€æ•°æ®ã€‚
&lt;ul&gt;
&lt;li&gt;åªæœ‰ç¬¬äºŒä¸ª Server é€šè¿‡ &amp;quot;quit&amp;quot; ä¸ç¬¬ä¸€ä¸ª Server æ–­å¼€è¿æ¥åï¼Œç¬¬ä¸‰ä¸ª Server æ‰èƒ½ä¸ç¬¬ä¸€ä¸ª Server è¿›è¡Œäº¤äº’&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;æ€»ç»“ï¼šä¸èƒ½ä½¿ç”¨ä¸¤ä¸ªå®¢æˆ·ç«¯åŒæ—¶è¿æ¥ä¸€ä¸ª Server è¿›è¡Œæ“ä½œ&lt;/strong&gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%8D%95%E7%BA%BF%E7%A8%8BBIO%E5%88%86%E6%9E%90.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h1 id=&#34;ä»”ç»†æƒ³æƒ³bioçš„æ ¸å¿ƒé—®é¢˜åŠè§£å†³æ–¹æ¡ˆ&#34;&gt;ä»”ç»†æƒ³æƒ³BIOçš„æ ¸å¿ƒé—®é¢˜åŠè§£å†³æ–¹æ¡ˆ&lt;/h1&gt;
&lt;h2 id=&#34;å¤šçº¿ç¨‹&#34;&gt;å¤šçº¿ç¨‹&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;é‚£ä¹ˆå¦‚ä½•åŒæ—¶å¤„ç†å¤šä¸ªå®¢æˆ·ç«¯æ•°æ®äº¤äº’è¯·æ±‚å‘¢ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%A4%9A%E7%BA%BF%E7%A8%8BBIO.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;çº¿ç¨‹æ± &#34;&gt;çº¿ç¨‹æ± &lt;/h2&gt;
&lt;p&gt;Client è¶Šæ¥è¶Šå¤šï¼Œ Server ç«¯çš„çº¿ç¨‹å°±ä¼šè¶Šæ¥è¶Šå¤šï¼Œä½†æ˜¯ Server ç«¯çš„çº¿ç¨‹å— Server ç«¯èµ„æºã€CPU å½±å“ï¼Œä¸èƒ½æ— é™å¢å¤§ã€‚å°±éœ€è¦æœ‰æ•ˆåœ°&lt;strong&gt;æ§åˆ¶çº¿ç¨‹çš„æ•°é‡&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E7%BA%BF%E7%A8%8B%E6%B1%A0BIO.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;çº¿ç¨‹æ± -bio&#34;&gt;çº¿ç¨‹æ±  BIO&lt;/h2&gt;
&lt;h3 id=&#34;ä»£ç -2&#34;&gt;ä»£ç &lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;package com.gupao;

import java.io.IOException;
import java.net.ServerSocket;
import java.net.Socket;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

public class ServerThreadPool {
    public static void main(String[] args) {
        // çº¿ç¨‹æ± 
        ExecutorService executor = Executors.newFixedThreadPool(2);

        RequestHandler requestHandler = new RequestHandler();
        // ç›‘å¬
        try(ServerSocket serverSocket = new ServerSocket(9999)) {
            System.out.println(&amp;quot;NIOServer has started, listening on port:&amp;quot; + serverSocket.getLocalSocketAddress());
            while (true){
                Socket clientSocket = serverSocket.accept();
                System.out.println(&amp;quot;Connection from &amp;quot; + clientSocket.getRemoteSocketAddress());
                // æœ‰å®¢æˆ·ç«¯è¿æ¥ä¸Šæ¥äº†ï¼Œäº¤ç»™çº¿ç¨‹æ± å¤„ç†
                executor.submit(new ClientHandler(clientSocket,requestHandler));
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}

package com.gupao;

import java.io.IOException;
import java.net.Socket;
import java.util.Scanner;

/**
 * æ¯ä¸ª Clinet è¿æ¥ä¸Šæ¥åï¼Œç»™å®ƒåˆ†é…ä¸€ä¸ªçº¿ç¨‹å»æ‰§è¡Œå¯¹åº”çš„ Ruunable ä»»åŠ¡
 */
public class ClientHandler implements Runnable {

    private final Socket clientSocket;
    private final RequestHandler requestHandler;

    public ClientHandler(Socket clientSocket, RequestHandler requestHandler) {
        this.clientSocket = clientSocket;
        this.requestHandler = requestHandler;
    }

    @Override
    public void run() {
        try(Scanner input = new Scanner(clientSocket.getInputStream())) {
            while (true){
                String request = input.nextLine();
                if(&amp;quot;quit&amp;quot;.equals(request)){
                    break;
                }
                System.out.println(String.format(&amp;quot;From %s : %s&amp;quot;, clientSocket.getRemoteSocketAddress(), request));
                // çœŸæ­£çš„ä¸šåŠ¡å¤„ç†
                String response = requestHandler.handler(request);
                clientSocket.getOutputStream().write(response.getBytes());
            }
        } catch (IOException e) {
            System.out.println(&amp;quot;Caught exception: &amp;quot; + e);
            throw new RuntimeException(e);
        }
    }
}

package com.gupao;

/**
 * ä¸šåŠ¡å¤„ç†ä»£ç 
 */
public class RequestHandler {
    public String handler(String request){
        return &amp;quot;From Server Hello &amp;quot; + request + &amp;quot;.\n&amp;quot;;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;è¿è¡Œç»“æœ-2&#34;&gt;è¿è¡Œç»“æœ&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E7%BA%BF%E7%A8%8B%E6%B1%A0BIO%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E7%BA%BF%E7%A8%8B%E6%B1%A0BIO%E7%BC%BA%E9%99%B7.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h1 id=&#34;é¡ºå…¶è‡ªå¸¦æ¨å¯¼å‡ºnioçš„åŸç†å’Œä»£ç å®ç°&#34;&gt;é¡ºå…¶è‡ªå¸¦æ¨å¯¼å‡ºNIOçš„åŸç†å’Œä»£ç å®ç°&lt;/h1&gt;
&lt;h2 id=&#34;é€‰æ‹©å™¨-selector&#34;&gt;é€‰æ‹©å™¨ Selector&lt;/h2&gt;
&lt;p&gt;å¦‚æœçº¿ç¨‹æ± çš„å¤§å°ä¸º 60ï¼Œæ¥äº† 60 ä¸ªè¯·æ±‚ï¼ŒServer ç«¯æ­£å¸¸åº”è¯¥å¯ä»¥åŒæ—¶å¤„ç†è¿™ 60ä¸ªè¯·æ±‚ã€‚ä½†æ˜¯çº¿ç¨‹è¦æƒ³è¢«æ‰§è¡Œçš„è¯ï¼Œ ä¸€å®šè¦å»æŠ¢åˆ° CPU çš„æ‰§è¡Œæƒï¼ŒCPU è¿›è¡Œè¿™ 60 ä¸ªçº¿ç¨‹çš„åˆ‡æ¢ï¼Œ&lt;strong&gt;é¢‘ç¹çš„çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢&lt;/strong&gt;æ¶ˆè€— CPU èµ„æºè¿‡å¤šï¼Œåˆ©ç”¨ç‡å¤ªä½ã€‚å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œçº¿ç¨‹çš„æ•°é‡ä¼šå½±å“ CPU çš„æ€§èƒ½ï¼Œè¿™å°±éœ€è¦æ§åˆ¶çº¿ç¨‹æ•°é‡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;çº¿ç¨‹åˆ›å»ºçš„æ—¶æœº&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ¯æ¥ä¸€ä¸ª Client è¯·æ±‚è¿æ¥ accept()ï¼Œå°±ä¸ºå®ƒåˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œè¿™ä¸ªçº¿ç¨‹ä¼šä¸€ç›´ç­‰å¾…å®¢æˆ·ç«¯çš„æ•°æ®:input.nextLine();ï¼ˆ&lt;strong&gt;é˜»å¡&lt;/strong&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æœ‰æ²¡æœ‰åŠæ³•ä¸é˜»å¡&lt;/strong&gt;ï¼Ÿ&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å»¶è¿Ÿçº¿ç¨‹åˆ›å»ºçš„æ—¶æœº&lt;/strong&gt;ï¼Œ&lt;strong&gt;ç­‰æ•°æ®å‡†å¤‡å¥½ä»¥åï¼Œæ‰å»åˆ›å»ºçº¿ç¨‹&lt;/strong&gt;ã€‚çº¿ç¨‹çš„æ•°é‡å°±ä¼šå¾—åˆ°æœ‰æ•ˆæ§åˆ¶ï¼ˆæœ‰çš„ Client åªæ˜¯è¿æ¥ï¼Œå¹¶ä¸è¿›è¡Œ IOï¼‰-&amp;gt; CPU ç”¨äºä¸Šä¸‹æ–‡åˆ‡æ¢çš„æ—¶é—´å‡å°‘ -&amp;gt; CPU åˆ©ç”¨ç‡æå‡ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/NIO%E9%80%89%E6%8B%A9%E5%99%A8.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;æ³¨æ„çœ‹ä¸‹é¢ä¸¤æ®µä»£ç çš„æ³¨é‡Šï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;package com.gupao;

import java.io.IOException;
import java.net.Socket;
import java.util.Scanner;

/**
 * æ¯ä¸ª Clinet è¿æ¥ä¸Šæ¥åï¼Œç»™å®ƒåˆ†é…ä¸€ä¸ªçº¿ç¨‹å»æ‰§è¡Œå¯¹åº”çš„ Ruunable ä»»åŠ¡
 */
public class ClientHandler implements Runnable {

    private final Socket clientSocket;
    private final RequestHandler requestHandler;

    public ClientHandler(Socket clientSocket, RequestHandler requestHandler) {
        this.clientSocket = clientSocket;
        this.requestHandler = requestHandler;
    }

    @Override
    public void run() {
        // è¯´æ˜çº¿ç¨‹å·²ç»åˆ›å»ºäº†ï¼Œ
        try(Scanner input = new Scanner(clientSocket.getInputStream())) {
            while (true){
                // ç­‰å¾…å®¢æˆ·ç«¯çš„è¾“å…¥æ•°æ® â€”â€” é˜»å¡çš„ï¼ˆå½“å‰è™½ç„¶åˆ›å»ºäº†ä¸€ä¸ªçº¿ç¨‹ï¼Œä½†å®ƒæ²¡æœ‰è¢«ç”¨åˆ°ï¼Œå°±æµªè´¹äº†ã€‚èƒ½ä¸èƒ½ç­‰åˆ°çœŸæ­£å¤„ç† IO çš„æ—¶å€™æ‰å»åˆ›å»ºçº¿ç¨‹ï¼‰
                String request = input.nextLine();
                if(&amp;quot;quit&amp;quot;.equals(request)){
                    break;
                }
                System.out.println(String.format(&amp;quot;From %s : %s&amp;quot;, clientSocket.getRemoteSocketAddress(), request));
                // å“åº”å®¢æˆ·ç«¯
                String response = requestHandler.handler(request);
                clientSocket.getOutputStream().write(response.getBytes());
            }
        } catch (IOException e) {
            System.out.println(&amp;quot;Caught exception: &amp;quot; + e);
            throw new RuntimeException(e);
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;package com.gupao;

import java.io.IOException;
import java.net.ServerSocket;
import java.net.Socket;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

public class ServerThreadPool {
    public static void main(String[] args) {
        // çº¿ç¨‹æ± 
        ExecutorService executor = Executors.newFixedThreadPool(2);

        RequestHandler requestHandler = new RequestHandler();
        // ç›‘å¬
        try(ServerSocket serverSocket = new ServerSocket(9999)) {
            System.out.println(&amp;quot;NIOServer has started, listening on port:&amp;quot; + serverSocket.getLocalSocketAddress());
            while (true){
                Socket clientSocket = serverSocket.accept();
                System.out.println(&amp;quot;Connection from &amp;quot; + clientSocket.getRemoteSocketAddress());
                // çº¿ç¨‹åˆ›å»ºçš„æ—¶æœºâ€”â€”æ¯ä¸ªå®¢æˆ·ç«¯æ¥äº†å°±ä¸ºå®ƒåˆ›å»ºä¸€ä¸ªçº¿ç¨‹

//                map.put(clientSocket,&amp;quot;Accepted&amp;quot;);   // ä¸åˆ›å»ºçº¿ç¨‹
//                ä»€ä¹ˆæ—¶å€™åˆ›å»ºçº¿ç¨‹ â€”â€” clientSocket çœŸæ­£è¿›è¡Œ IO æ—¶ï¼Œé‡‡å–åˆ›å»ºçº¿ç¨‹

                executor.submit(new ClientHandler(clientSocket,requestHandler));
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;é€šé“-channel&#34;&gt;é€šé“ Channel&lt;/h2&gt;
&lt;p&gt;Client ä¸ Server è¿æ¥è¿›è¡Œæ•°æ®äº¤äº’ï¼Œç„¶åæ•°æ®å†è¿”å›ç»™ Clientã€‚&lt;/p&gt;
&lt;p&gt;è€Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ¯æ¬¡æ•°æ®äº¤äº’ç»“æŸåï¼Œè¿æ¥å°±ä¼šæ–­å¼€ï¼Œ&lt;/p&gt;
&lt;p&gt;è€Œå»ºç«‹è¿æ¥éœ€è¦ä¸‰æ¬¡æ¡æ‰‹å¾ˆè€—æ—¶ï¼Œè¿æ¥æ˜¯å¾ˆå®è´µçš„ï¼Œä¼˜åŒ–è¿æ¥çš„æ–¹å¼ï¼šå»ºç«‹ä¸€æ¡æ¡&lt;strong&gt;é€šé“&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿æ¥å’Œæ•°æ®ä¼ è¾“å°±åœ¨é€šé“ä¸­è¿›è¡Œï¼Œé€šé“å¯ä»¥å¤ç”¨ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/NIO%E9%80%9A%E9%81%93.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;ç¼“å­˜-buffer&#34;&gt;ç¼“å­˜ Buffer&lt;/h2&gt;
&lt;p&gt;é˜»å¡/éé˜»å¡ IOï¼šå®é™…ä¸Šæ˜¯é’ˆå¯¹çš„åº”ç”¨ç¨‹åºå’Œ OS æ•°æ®ä¹‹é—´äº¤äº’çš„è¿™æ ·ä¸€ç§æ–¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;éé˜»å¡ IOï¼šOS æ²¡æœ‰æŠŠæ‰€æœ‰æ•°æ®å…¨éƒ¨ä¼ è¾“å®Œæˆï¼Œåº”ç”¨ç¨‹åºä¸ä¼šä¸€ç›´ç­‰å¾…æ“ä½œæ•°æ®ï¼Œåº”ç”¨ç¨‹åºå…è®¸ OS ä¸€ä¼šä¼ è¾“ä¸€æ®µæ•°æ®ã€‚åº”ç”¨ç¨‹åºæŠŠæ¯æ¬¡æ¥å—åˆ°çš„ä¸€å°æ®µæ•°æ®æ”¾åˆ°&lt;strong&gt;ç¼“å­˜&lt;/strong&gt;å†…ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;9&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/NIO%E7%BC%93%E5%AD%98.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;å¾ˆå¤šæƒ…å†µä¸‹ä¼šå‘ç°ï¼Œå¤„ç†æ•°æ®çš„æ—¶å€™ï¼Œçš„ç¡®ç”¨çš„æ˜¯å¤šçº¿ç¨‹ï¼Œä½†è¿™ä¸ªå¤šçº¿ç¨‹ä¸æ˜¯ä¸ºäº†è§£å†³ IO é˜»å¡é—®é¢˜ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;10&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/NIO%E5%A4%9A%E7%BA%BF%E7%A8%8B.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;nio-ä»£ç &#34;&gt;NIO ä»£ç &lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;package com.gupao;

import java.awt.image.DataBufferByte;
import java.io.IOException;
import java.net.InetSocketAddress;
import java.nio.ByteBuffer;
import java.nio.channels.*;
import java.util.Iterator;
import java.util.Set;

public class NIOServer {
    public static void main(String[] args) throws IOException {
        // 1.Channel é€šé“
        // æœåŠ¡ç«¯ Channel
        ServerSocketChannel serverSocketChannel = ServerSocketChannel.open();
        // æœåŠ¡ç«¯ Channel è®¾ç½®ä¸ºéé˜»å¡
        serverSocketChannel.configureBlocking(false);
        // Channel ç»‘å®šç«¯å£
        serverSocketChannel.bind(new InetSocketAddress(9999));
        System.out.println(&amp;quot;NIOServer has started, listening on port: &amp;quot; + serverSocketChannel.getLocalAddress());

        // 2.Selector é€‰æ‹©å™¨ï¼šæ³¨å†Œå’Œé€‰æ‹©å“ªä¸ª Channel è¿›è¡Œè¯»/å†™
        Selector selector = Selector.open();
        // å°†è¿æ¥ä¸Šæ¥çš„ Channel æ³¨å†Œåˆ° Selector é€‰æ‹©å™¨ä¸Šï¼Œå¹¶ä¸”å°†é»˜è®¤çŠ¶æ€è®¾ç½®ä¸º â€œAcceptedâ€
        serverSocketChannel.register(selector, SelectionKey.OP_ACCEPT);

        // 3.ç¼“å†²åŒº Buffer
        ByteBuffer buffer = ByteBuffer.allocate(1024);
        RequestHandler requestHandler = new RequestHandler();
        // Selector ä¸æ–­è½®è¯¢ç›‘å¬æœ‰å¤šå°‘ä¸ªå®¢æˆ·ç«¯ Channelå·²ç»è¿æ¥ä¸Šäº†
        while (true){
            // ä» Selector ä¸­æ‹¿åˆ°ä¸€ä¸ªä¸ªå®¢æˆ·ç«¯çš„ Channel
            int select = selector.select();
            if(select == 0){
                continue;
            }
            // Set é›†åˆç»´æŠ¤äº† å®¢æˆ·ç«¯-æœåŠ¡ç«¯ çš„ Channelï¼ˆSelectionKeyï¼‰
            Set&amp;lt;SelectionKey&amp;gt; selectionKeys = selector.selectedKeys();
            // è¿­ä»£ set é›†åˆï¼Œ
            Iterator&amp;lt;SelectionKey&amp;gt; iterator = selectionKeys.iterator();
            while (iterator.hasNext()){
                // æ‹¿åˆ°ä¸€ä¸ª SelectionKeyï¼ŒSelectionKey é‡Œé¢æœ‰ï¼šæœåŠ¡ç«¯çš„ ServerSocketChannelï¼›å®¢æˆ·ç«¯çš„ SocketChannel
                SelectionKey key = iterator.next();
                // å¦‚æœæœ‰ä¸€ä¸ªå®¢æˆ·ç«¯çš„ Channel è¿æ¥ä¸Šæ¥äº†ï¼ˆçŠ¶æ€ä¸ºâ€œAcceptedâ€ï¼‰ï¼Œéœ€è¦è¿›è¡Œè¯»/å†™æ“ä½œ
                if(key.isAcceptable()){
                    // æ ¹æ® SelectionKey è·å¾— ServerSocketChannel
                    ServerSocketChannel channel = (ServerSocketChannel) key.channel();
                    // æ ¹æ® ServerSocketChannel è·å¾— SocketChannel
                    SocketChannel clientChannel = channel.accept();
                    System.out.println(&amp;quot;Connection from &amp;quot; + clientChannel.getRemoteAddress());
                    // å®¢æˆ·ç«¯ Channel è®¾ç½®ä¸ºéé˜»å¡
                    clientChannel.configureBlocking(false);
                    // å°† Channel çš„çŠ¶æ€æ”¹å˜ä¸º READï¼Œè¯´æ˜è¯¥ Channel è¦è¯»æ•°æ®äº†
                    clientChannel.register(selector, SelectionKey.OP_READ);
                }

                // å¦‚æœ Channel çš„çŠ¶æ€ä¸º Readï¼Œå¯ä»¥è¿›è¡Œ è¯»æ“ä½œäº†ã€‚
                // å¤„ç†è¯»æ“ä½œï¼šè¿˜æ˜¯æ”¾åœ¨ main çº¿ç¨‹ä¸­ï¼Œè€Œä¸æ˜¯ä¸ºè¿™ä¸ª Client è¯·æ±‚åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹
                if(key.isReadable()){
                    // è·å–åˆ° å®¢æˆ·ç«¯ Channel
                    SocketChannel channel = (SocketChannel) key.channel();
                    // æ•°æ®æ”¾åˆ° Buffer ä¸­
                    channel.read(buffer);
                    String request = new String(buffer.array()).trim();
                    buffer.clear();
                    System.out.println(String.format(&amp;quot;From %s : %s&amp;quot;, channel.getRemoteAddress(),request));
                    // ç»™å®¢æˆ·ç«¯ä¸€ä¸ªå“åº”
                    String response = requestHandler.handler(request);
                    channel.write(ByteBuffer.wrap(response.getBytes()));
                }
                iterator.remove();
            }
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
">ä¸€ç¯‡æ–‡ç« å½»åº•æå®š NIO</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/mysql-explain-guan-jian-zi/"" data-c="
          &lt;h1 id=&#34;explain-å…³é”®å­—&#34;&gt;Explain å…³é”®å­—&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;&lt;strong&gt;åˆ—å&lt;/strong&gt;&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;&lt;strong&gt;æè¿°&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;id&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;åœ¨ä¸€ä¸ªå¤§çš„æŸ¥è¯¢è¯­å¥ä¸­æ¯ä¸ªSELECTå…³é”®å­—éƒ½å¯¹åº”ä¸€ä¸ªå”¯ä¸€çš„id&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;select_type&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;SELECTå…³é”®å­—å¯¹åº”çš„é‚£ä¸ªæŸ¥è¯¢çš„ç±»å‹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;table&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è¡¨å&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;partitions&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;åŒ¹é…çš„åˆ†åŒºä¿¡æ¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;&lt;strong&gt;type&lt;/strong&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;&lt;strong&gt;é’ˆå¯¹å•è¡¨çš„è®¿é—®æ–¹æ³•&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;&lt;strong&gt;possible_keys&lt;/strong&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;&lt;strong&gt;å¯èƒ½ç”¨åˆ°çš„ç´¢å¼•&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;&lt;strong&gt;key&lt;/strong&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;&lt;strong&gt;å®é™…ä¸Šä½¿ç”¨çš„ç´¢å¼•&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;&lt;strong&gt;key_len&lt;/strong&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;&lt;strong&gt;å®é™…ä½¿ç”¨åˆ°çš„ç´¢å¼•é•¿åº¦&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ref&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å½“ä½¿ç”¨ç´¢å¼•åˆ—ç­‰å€¼æŸ¥è¯¢æ—¶ï¼Œä¸ç´¢å¼•åˆ—è¿›è¡Œç­‰å€¼åŒ¹é…çš„å¯¹è±¡ä¿¡æ¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;rows&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;é¢„ä¼°çš„éœ€è¦è¯»å–çš„è®°å½•æ¡æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;filtered&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æŸä¸ªè¡¨ç»è¿‡æœç´¢æ¡ä»¶è¿‡æ»¤åå‰©ä½™è®°å½•æ¡æ•°çš„ç™¾åˆ†æ¯”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;&lt;strong&gt;Extra&lt;/strong&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;&lt;strong&gt;ä¸€äº›é¢å¤–çš„ä¿¡æ¯&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;table&#34;&gt;table&lt;/h2&gt;
&lt;p&gt;è¡¨å&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 join t2; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/table.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;explain select * from t1 join t2;Â &lt;/p&gt;
&lt;h2 id=&#34;id&#34;&gt;id&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬å†™çš„æŸ¥è¯¢è¯­å¥ä¸€èˆ¬éƒ½ä»¥SELECTå…³é”®å­—å¼€å¤´ï¼Œæ¯”è¾ƒç®€å•çš„æŸ¥è¯¢è¯­å¥é‡Œåªæœ‰ä¸€ä¸ªSELECTå…³é”®å­—ï¼Œä½†æ˜¯ä¸‹è¾¹ä¸¤ç§æƒ…å†µä¸‹åœ¨ä¸€æ¡æŸ¥è¯¢è¯­å¥ä¸­ä¼šå‡ºç°å¤šä¸ªSELECTå…³é”®å­—ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æŸ¥è¯¢ä¸­åŒ…å«å­æŸ¥è¯¢çš„æƒ…å†µ&lt;/li&gt;
&lt;li&gt;æŸ¥è¯¢ä¸­åŒ…å«UNIONè¯­å¥çš„æƒ…å†µ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æŸ¥è¯¢è¯­å¥ä¸­æ¯å‡ºç°&lt;strong&gt;ä¸€ä¸ªSELECTå…³é”®å­—&lt;/strong&gt;ï¼ŒMySQLå°±ä¼šä¸ºå®ƒåˆ†é…&lt;strong&gt;ä¸€ä¸ªå”¯ä¸€çš„idå€¼&lt;/strong&gt;ã€‚è¿™ä¸ªidå€¼å°±æ˜¯EXPLAINè¯­å¥çš„ç¬¬ä¸€ä¸ªåˆ—ã€‚å¯¹äºè¿æ¥æŸ¥è¯¢æ¥è¯´ï¼Œä¸€ä¸ªSELECTå…³é”®å­—åè¾¹çš„&lt;strong&gt;FROMå­å¥ä¸­å¯ä»¥è·Ÿéšå¤šä¸ªè¡¨&lt;/strong&gt;ï¼Œæ‰€ä»¥åœ¨è¿æ¥æŸ¥è¯¢çš„æ‰§è¡Œè®¡åˆ’ä¸­ï¼Œ&lt;strong&gt;æ¯ä¸ªè¡¨éƒ½ä¼šå¯¹åº”ä¸€æ¡è®°å½•ï¼Œä½†æ˜¯è¿™äº›è®°å½•çš„idå€¼éƒ½æ˜¯ç›¸åŒçš„ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 join t2; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/id1.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;ä¸€ä¸ª select å…³é”®å­—ï¼Œä¸¤æ¡è®°å½• id å€¼ç›¸åŒ&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åœ¨è¿æ¥æŸ¥è¯¢çš„æ‰§è¡Œè®¡åˆ’ä¸­ï¼Œæ¯ä¸ªè¡¨éƒ½ä¼šå¯¹åº”ä¸€æ¡è®°å½•ï¼Œè¿™äº›è®°å½•çš„idåˆ—çš„å€¼æ˜¯ç›¸åŒçš„ï¼Œå‡ºç°åœ¨å‰è¾¹çš„è¡¨æ˜¯é©±åŠ¨è¡¨ï¼Œå‡ºç°åœ¨åè¾¹çš„è¡¨æ˜¯è¢«é©±åŠ¨è¡¨&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¯¹äº&lt;strong&gt;åŒ…å«å­æŸ¥è¯¢çš„&lt;/strong&gt;æŸ¥è¯¢è¯­å¥æ¥è¯´ï¼Œå°±å¯èƒ½æ¶‰åŠ&lt;strong&gt;å¤šä¸ªSELECT&lt;/strong&gt;å…³é”®å­—ï¼Œæ‰€ä»¥åœ¨åŒ…å«å­æŸ¥è¯¢çš„æŸ¥è¯¢è¯­å¥çš„æ‰§è¡Œè®¡åˆ’ä¸­ï¼Œ&lt;strong&gt;æ¯ä¸ªSELECTå…³é”®å­—éƒ½ä¼šå¯¹åº”ä¸€ä¸ªå”¯ä¸€çš„idå€¼&lt;/strong&gt;ï¼Œæ¯”å¦‚è¿™æ ·ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 where a in (select a from t2) or c = &#39;c&#39;; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/id2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;Â ä¸¤ä¸ª select å…³é”®å­—ï¼Œä¸¤ä¸ªä¸åŒçš„ id  å€¼&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯è¿™é‡Œå¤§å®¶éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼Œ&lt;strong&gt;æŸ¥è¯¢ä¼˜åŒ–å™¨å¯èƒ½å¯¹æ¶‰åŠå­æŸ¥è¯¢çš„æŸ¥è¯¢è¯­å¥è¿›è¡Œé‡å†™ï¼Œä»è€Œè½¬æ¢ä¸ºè¿æ¥æŸ¥è¯¢&lt;/strong&gt;ã€‚æ‰€ä»¥å¦‚æœæˆ‘ä»¬æƒ³çŸ¥é“æŸ¥è¯¢ä¼˜åŒ–å™¨å¯¹æŸä¸ªåŒ…å«å­æŸ¥è¯¢çš„è¯­å¥æ˜¯å¦è¿›è¡Œäº†é‡å†™ï¼Œç›´æ¥æŸ¥çœ‹æ‰§è¡Œè®¡åˆ’å°±å¥½äº†ï¼Œæ¯”å¦‚è¯´ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 where a in (select a from t2); 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96%E5%99%A8%E5%B0%86%E5%AD%90%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96%E4%B8%BA%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;æŸ¥è¯¢ä¼˜åŒ–å™¨å°†å­æŸ¥è¯¢ä¼˜åŒ–ä¸ºè¿æ¥æŸ¥è¯¢&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶æˆ‘ä»¬çš„æŸ¥è¯¢è¯­å¥æ˜¯ä¸€ä¸ªå­æŸ¥è¯¢ï¼Œä½†æ˜¯æ‰§è¡Œè®¡åˆ’ä¸­t1å’Œt2è¡¨å¯¹åº”çš„è®°å½•çš„idå€¼å…¨éƒ¨æ˜¯1ï¼Œè¿™å°±è¡¨æ˜äº†&lt;strong&gt;æŸ¥è¯¢ä¼˜åŒ–å™¨å°†å­æŸ¥è¯¢è½¬æ¢ä¸ºäº†è¿æ¥æŸ¥è¯¢&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹&lt;strong&gt;äºåŒ…å«UNIONå­å¥çš„æŸ¥è¯¢è¯­å¥æ¥è¯´ï¼Œæ¯ä¸ªSELECTå…³é”®å­—å¯¹åº”ä¸€ä¸ªidå€¼&lt;/strong&gt;ä¹Ÿæ˜¯æ²¡é”™çš„ï¼Œä¸è¿‡è¿˜æ˜¯æœ‰ç‚¹å„¿ç‰¹åˆ«çš„ä¸œè¥¿ï¼Œæ¯”æ–¹è¯´ä¸‹è¾¹è¿™ä¸ªæŸ¥è¯¢ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 union select * from t2; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/union%E5%8E%BB%E9%87%8D.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;union å»é‡&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªè¯­å¥çš„æ‰§è¡Œè®¡åˆ’çš„ç¬¬ä¸‰æ¡è®°å½•æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆidå€¼æ˜¯NULLï¼ŸUNIONä¼šæŠŠå¤šä¸ªæŸ¥è¯¢çš„ç»“æœé›†åˆå¹¶èµ·æ¥å¹¶å¯¹ç»“æœé›†ä¸­çš„è®°å½•è¿›è¡Œå»é‡ï¼Œæ€ä¹ˆå»é‡å‘¢ï¼ŸMySQLä½¿ç”¨çš„æ˜¯å†…éƒ¨çš„ä¸´æ—¶è¡¨ã€‚æ­£å¦‚ä¸Šè¾¹çš„æŸ¥è¯¢è®¡åˆ’ä¸­æ‰€ç¤ºï¼Œ&lt;strong&gt;UNIONå­å¥æ˜¯ä¸ºäº†æŠŠidä¸º1çš„æŸ¥è¯¢å’Œidä¸º2çš„æŸ¥è¯¢çš„ç»“æœé›†åˆå¹¶èµ·æ¥å¹¶å»é‡ï¼Œæ‰€ä»¥åœ¨å†…éƒ¨åˆ›å»ºäº†ä¸€ä¸ªåä¸ºçš„ä¸´æ—¶è¡¨&lt;/strong&gt;ï¼ˆå°±æ˜¯æ‰§è¡Œè®¡åˆ’ç¬¬ä¸‰æ¡è®°å½•çš„tableåˆ—çš„åç§°ï¼‰ï¼Œidä¸ºNULLè¡¨æ˜è¿™ä¸ªä¸´æ—¶è¡¨æ˜¯ä¸ºäº†åˆå¹¶ä¸¤ä¸ªæŸ¥è¯¢çš„ç»“æœé›†è€Œåˆ›å»ºçš„ã€‚&lt;/p&gt;
&lt;p&gt;è·ŸUNIONå¯¹æ¯”èµ·æ¥ï¼Œ&lt;strong&gt;UNION ALLå°±ä¸éœ€è¦ä¸ºæœ€ç»ˆçš„ç»“æœé›†è¿›è¡Œå»é‡&lt;/strong&gt;ï¼Œå®ƒåªæ˜¯å•çº¯çš„æŠŠå¤šä¸ªæŸ¥è¯¢çš„ç»“æœé›†ä¸­çš„è®°å½•åˆå¹¶æˆä¸€ä¸ªå¹¶è¿”å›ç»™ç”¨æˆ·ï¼Œæ‰€ä»¥ä¹Ÿå°±ä¸éœ€è¦ä½¿ç”¨ä¸´æ—¶è¡¨ã€‚æ‰€ä»¥åœ¨åŒ…å«UNION ALLå­å¥çš„æŸ¥è¯¢çš„æ‰§è¡Œè®¡åˆ’ä¸­ï¼Œå°±æ²¡æœ‰é‚£ä¸ªidä¸ºNULLçš„è®°å½•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 union all select * from t2; 
+----+-------------+-------+------------+------+---------------+------+---------+----- 
-+------+----------+-------+ 
| id | select_type | table | partitions | type | possible_keys | key | key_len | ref  
| rows | filtered | Extra | 
+----+-------------+-------+------------+------+---------------+------+---------+----- 
-+------+----------+-------+ 
| 1 | PRIMARY | t1 | NULL | ALL | NULL | NULL | NULL | NULL 
| 8 | 100.00 | NULL | 
| 2 | UNION | t2 | NULL | ALL | NULL | NULL | NULL | NULL 
| 8 | 100.00 | NULL | 
+----+-------------+-------+------------+------+---------------+------+---------+----- 
-+------+----------+-------+ 
2 rows in set, 1 warning (0.00 sec) 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;select_type&#34;&gt;select_type&lt;/h2&gt;
&lt;p&gt;æ¯ä¸€ä¸ªSELECTå…³é”®å­—ä»£è¡¨çš„å°æŸ¥è¯¢éƒ½å®šä¹‰äº†ä¸€ä¸ªç§°ä¹‹ä¸ºselect_typeçš„å±æ€§ï¼Œæ„æ€æ˜¯æˆ‘ä»¬åªè¦çŸ¥é“äº†æŸä¸ªå°æŸ¥è¯¢çš„select_typeå±æ€§ï¼Œå°±çŸ¥é“äº†è¿™ä¸ªå°æŸ¥è¯¢åœ¨æ•´ä¸ªå¤§æŸ¥è¯¢ä¸­æ‰®æ¼”äº†ä¸€ä¸ªä»€ä¹ˆè§’è‰²ã€‚&lt;/p&gt;
&lt;h3 id=&#34;simple&#34;&gt;SIMPLE&lt;/h3&gt;
&lt;p&gt;æŸ¥è¯¢è¯­å¥ä¸­&lt;strong&gt;ä¸åŒ…å«UNIONæˆ–è€…å­æŸ¥è¯¢çš„æŸ¥è¯¢&lt;/strong&gt;éƒ½ç®—ä½œæ˜¯SIMPLEç±»å‹ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E7%AE%80%E5%8D%95%E6%9F%A5%E8%AF%A2SIMPLE.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;ç®€å•æŸ¥è¯¢ select_type = SIMPLE&lt;/p&gt;
&lt;p&gt;è¿æ¥æŸ¥è¯¢ä¹Ÿç®—æ˜¯SIMPLEç±»å‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 join t2; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2SIMPLE.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;è¿æ¥æŸ¥è¯¢ select_type = SIMPLE&lt;/p&gt;
&lt;h3 id=&#34;primary&#34;&gt;PRIMARY&lt;/h3&gt;
&lt;p&gt;å¯¹äºåŒ…å«UNIONã€UNION ALLæˆ–è€…å­æŸ¥è¯¢çš„å¤§æŸ¥è¯¢æ¥è¯´ï¼Œå®ƒæ˜¯ç”±å‡ ä¸ªå°æŸ¥è¯¢ç»„æˆçš„ï¼Œå…¶ä¸­æœ€å·¦è¾¹çš„é‚£ä¸ªæŸ¥è¯¢çš„ select_typeå€¼å°±æ˜¯PRIMARYï¼Œæ¯”æ–¹è¯´ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 where a in (select a from t2) or c = &#39;c&#39;; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/PRIMARY.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;ä¸»æŸ¥è¯¢çš„ select_type = PRIMARYï¼›å­æŸ¥è¯¢çš„ select_type = SUBQUERY&lt;/p&gt;
&lt;p&gt;ä»ç»“æœä¸­å¯ä»¥çœ‹åˆ°ï¼Œæœ€å·¦è¾¹çš„å°æŸ¥è¯¢select * from t1å¯¹åº”çš„æ˜¯æ‰§è¡Œè®¡åˆ’ä¸­çš„ç¬¬ä¸€æ¡è®°å½•ï¼Œå®ƒçš„select_typeå€¼å°±æ˜¯ PRIMARYã€‚&lt;/p&gt;
&lt;h3 id=&#34;union&#34;&gt;UNION&lt;/h3&gt;
&lt;p&gt;å¯¹äºåŒ…å«UNIONæˆ–è€…UNION ALLçš„å¤§æŸ¥è¯¢æ¥è¯´ï¼Œå®ƒæ˜¯ç”±å‡ ä¸ªå°æŸ¥è¯¢ç»„æˆçš„ï¼Œå…¶ä¸­é™¤äº†æœ€å·¦è¾¹çš„é‚£ä¸ªå°æŸ¥è¯¢ä»¥å¤–ï¼Œ å…¶ä½™çš„å°æŸ¥è¯¢çš„select_typeå€¼å°±æ˜¯UNIONã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 union select * from t2; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;9&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/UNION.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;UNION æŸ¥è¯¢çš„æœ€å·¦è¾¹æŸ¥è¯¢ select_type = RIMARYï¼Œå…¶ä½™å°æŸ¥è¯¢çš„ select_type = UNION&lt;/p&gt;
&lt;h3 id=&#34;union-result&#34;&gt;UNION RESULT&lt;/h3&gt;
&lt;p&gt;MySQLé€‰æ‹©ä½¿ç”¨ä¸´æ—¶è¡¨æ¥å®ŒæˆUNIONæŸ¥è¯¢çš„å»é‡å·¥ä½œï¼Œé’ˆå¯¹è¯¥ä¸´æ—¶è¡¨çš„æŸ¥è¯¢çš„select_typeå°±æ˜¯UNION RESULTï¼Œä¾‹å­ä¸Šè¾¹æœ‰ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;10&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/UNION_RESULT.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;union æŸ¥è¯¢ä¸­ä¸´æ—¶è¡¨çš„ select_type = UNION RESULT&lt;/p&gt;
&lt;h3 id=&#34;subquery&#34;&gt;SUBQUERY&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;éç›¸å…³å­æŸ¥è¯¢&lt;/strong&gt;ï¼Œç”±äº select_type ä¸º SUBQUERY çš„å­æŸ¥è¯¢ç”±äºä¼šè¢«ç‰©åŒ–ï¼Œæ‰€ä»¥&lt;strong&gt;åªéœ€è¦æ‰§è¡Œä¸€éã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 where a in (select a from t2) or c = &#39;c&#39;; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;11&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/SUBQUERY.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;éç›¸å…³å­æŸ¥è¯¢ select_type = SUBQUERY&lt;/p&gt;
&lt;h3 id=&#34;dependent-subqurey&#34;&gt;DEPENDENT SUBQUREY&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;ç›¸å…³å­æŸ¥è¯¢&lt;/strong&gt;ï¼Œselect_type ä¸º DEPENDENT SUBQUERY çš„æŸ¥è¯¢å¯èƒ½&lt;strong&gt;ä¼šè¢«æ‰§è¡Œå¤šæ¬¡&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 where a in (select a from t2 where t1.a = t2.a) or c = &#39;c&#39;; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;12&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/DEPENDENT_SUBQUREY.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;ç›¸å…³å­æŸ¥è¯¢ select_type = DEPENDENT SUBQUERY&lt;/p&gt;
&lt;h3 id=&#34;derived&#34;&gt;DERIVED&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from (select a, count(*) from t2 group by a ) as deliver1; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;13&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/DERIVED.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;æ´¾ç”Ÿè¡¨ select_type = DRIVED &lt;/p&gt;
&lt;p&gt;ä»æ‰§è¡Œè®¡åˆ’ä¸­å¯ä»¥çœ‹å‡ºï¼Œidä¸º2çš„è®°å½•å°±ä»£è¡¨å­æŸ¥è¯¢çš„æ‰§è¡Œæ–¹å¼ï¼Œå®ƒçš„select_typeæ˜¯DERIVEDï¼Œè¯´æ˜è¯¥å­æŸ¥è¯¢æ˜¯ä»¥ç‰©åŒ–çš„æ–¹å¼æ‰§è¡Œçš„ã€‚idä¸º1çš„è®°å½•ä»£è¡¨å¤–å±‚æŸ¥è¯¢ï¼Œå¤§å®¶æ³¨æ„çœ‹å®ƒçš„tableåˆ—æ˜¾ç¤ºçš„æ˜¯&lt;derived2&gt;ï¼Œè¡¨ç¤ºè¯¥æŸ¥è¯¢æ˜¯é’ˆå¯¹å°†æ´¾ç”Ÿè¡¨ç‰©åŒ–ä¹‹åçš„è¡¨è¿›è¡ŒæŸ¥è¯¢çš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;materialized&#34;&gt;MATERIALIZED&lt;/h3&gt;
&lt;p&gt;å½“æŸ¥è¯¢ä¼˜åŒ–å™¨åœ¨æ‰§è¡ŒåŒ…å«å­æŸ¥è¯¢çš„è¯­å¥æ—¶ï¼Œé€‰æ‹©å°†å­æŸ¥è¯¢ç‰©åŒ–ä¹‹åä¸å¤–å±‚æŸ¥è¯¢è¿›è¡Œè¿æ¥æŸ¥è¯¢æ—¶ï¼Œè¯¥å­æŸ¥è¯¢å¯¹åº”çš„ select_typeå±æ€§å°±æ˜¯MATERIALIZEDã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 where a in (select c from t2 where e = 1);
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;14&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/MATERIALIZED.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;ç‰©åŒ–è¡¨ select_type = MATERIALIZED &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å°†å­æŸ¥è¯¢å‡ºæ¥çš„ç»“æœé›†æ”¾åˆ°ä¸€ä¸ªç‰©åŒ–è¡¨å†…ï¼Œå†å°†ç‰©åŒ–è¡¨ä¸å¤–å±‚æŸ¥è¯¢è¿›è¡Œè¿æ¥æŸ¥è¯¢ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;type&#34;&gt;TYPE&lt;/h2&gt;
&lt;p&gt;è®¿é—®æ–¹æ³•ï¼ˆå…¨è¡¨æ‰«æè¿˜æ˜¯èµ°å“ªä¸ªç´¢å¼•ï¼‰&lt;/p&gt;
&lt;h3 id=&#34;system&#34;&gt;system&lt;/h3&gt;
&lt;p&gt;å½“&lt;strong&gt;è¡¨ä¸­åªæœ‰ä¸€æ¡è®°å½•å¹¶ä¸”è¯¥è¡¨ä½¿ç”¨çš„å­˜å‚¨å¼•æ“çš„ç»Ÿè®¡æ•°æ®æ˜¯ç²¾ç¡®&lt;/strong&gt;çš„ï¼Œæ¯”å¦‚MyISAMã€Memoryï¼Œé‚£ä¹ˆå¯¹è¯¥è¡¨çš„è®¿é—®æ–¹æ³•å°±æ˜¯systemã€‚æ¯”æ–¹è¯´æˆ‘ä»¬æ–°å»ºä¸€ä¸ªMyISAMè¡¨ï¼Œå¹¶ä¸ºå…¶æ’å…¥ä¸€æ¡è®°å½•ï¼š&lt;/p&gt;
&lt;p&gt;åˆ›å»ºè¡¨ t&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; CREATE TABLE t(i int) Engine=MyISAM; 
Query OK, 0 rows affected (0.05 sec) 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å‘ t è¡¨å†…æ’å…¥ä¸€æ¡æ•°æ®&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; INSERT INTO t VALUES(1); 
Query OK, 1 row affected (0.01 sec)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‰§è¡Œ explain è¯­å¥&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;15&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/system.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;è¡¨ä¸­åªæœ‰ä¸€æ¡æ•°æ®ã€å­˜å‚¨å¼•æ“ç²¾ç¡®ç»Ÿè®¡ type = system&lt;/p&gt;
&lt;h3 id=&#34;const&#34;&gt;const&lt;/h3&gt;
&lt;p&gt;å½“æˆ‘ä»¬æ ¹æ®&lt;strong&gt;ä¸»é”®&lt;/strong&gt;æˆ–è€…&lt;strong&gt;å”¯ä¸€äºŒçº§ç´¢å¼•åˆ—&lt;/strong&gt;ä¸&lt;strong&gt;å¸¸æ•°&lt;/strong&gt;è¿›è¡Œ&lt;strong&gt;ç­‰å€¼åŒ¹é…æ—¶&lt;/strong&gt;ï¼Œå¯¹å•è¡¨çš„è®¿é—®æ–¹æ³•å°±æ˜¯constã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 where a = 1; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;16&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/const.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;æ ¹æ®ä¸»é”®ä¸å¸¸æ•°è¿›è¡Œç­‰å€¼åŒ¹é… type = const&lt;/p&gt;
&lt;h3 id=&#34;eq_ref&#34;&gt;eq_ref&lt;/h3&gt;
&lt;p&gt;åœ¨è¿æ¥æŸ¥è¯¢æ—¶ï¼Œå¦‚æœ&lt;strong&gt;è¢«é©±åŠ¨è¡¨æ˜¯é€šè¿‡ä¸»é”®æˆ–è€…å”¯ä¸€äºŒçº§ç´¢å¼•åˆ—ç­‰å€¼åŒ¹é…çš„æ–¹å¼è¿›è¡Œè®¿é—®çš„&lt;/strong&gt;ï¼ˆå¦‚æœè¯¥ä¸»é”®æˆ–è€…å”¯ä¸€äºŒçº§ç´¢å¼•æ˜¯è”åˆç´¢å¼•çš„è¯ï¼Œæ‰€æœ‰çš„ç´¢å¼•åˆ—éƒ½å¿…é¡»è¿›è¡Œç­‰å€¼æ¯”è¾ƒï¼‰ï¼Œåˆ™å¯¹è¯¥è¢«é©±åŠ¨è¡¨çš„è®¿é—®æ–¹æ³•å°±æ˜¯eq_ref&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 join t2 on t1.a = t2.a; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;17&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/eq_ref.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;è¢«é©±åŠ¨è¡¨é€šè¿‡ä¸»é”®ç­‰å€¼åŒ¹é…çš„æ–¹å¼è®¿é—®ï¼Œè¢«é©±åŠ¨è¡¨çš„ type = eq_ref&lt;/p&gt;
&lt;h3 id=&#34;ref&#34;&gt;ref&lt;/h3&gt;
&lt;p&gt;å½“é€šè¿‡&lt;strong&gt;æ™®é€šçš„äºŒçº§ç´¢å¼•åˆ—&lt;/strong&gt;ä¸&lt;strong&gt;å¸¸é‡&lt;/strong&gt;è¿›è¡Œ&lt;strong&gt;ç­‰å€¼åŒ¹é…&lt;/strong&gt;æ—¶æ¥æŸ¥è¯¢æŸä¸ªè¡¨ï¼Œé‚£ä¹ˆå¯¹è¯¥è¡¨çš„è®¿é—®æ–¹æ³•å°±å¯èƒ½æ˜¯refã€‚&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹æ‰€æœ‰ç´¢å¼•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;show keys for t1;
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;18&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%9F%A5%E7%9C%8B%E6%89%80%E6%9C%89%E7%B4%A2%E5%BC%95.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;æŸ¥çœ‹æ‰€æœ‰ç´¢å¼•&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 where b = 1; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;19&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/ref.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;å½“é€šè¿‡æ™®é€šçš„äºŒçº§ç´¢å¼•åˆ—ä¸å¸¸é‡è¿›è¡Œç­‰å€¼åŒ¹é…æ—¶æ¥æŸ¥è¯¢æŸä¸ªè¡¨ type = ref&lt;/p&gt;
&lt;h3 id=&#34;ref_of_null&#34;&gt;ref_of_null&lt;/h3&gt;
&lt;p&gt;å½“å¯¹&lt;strong&gt;æ™®é€šäºŒçº§ç´¢å¼•è¿›è¡Œç­‰å€¼åŒ¹é…æŸ¥è¯¢&lt;/strong&gt;ï¼Œ&lt;strong&gt;è¯¥ç´¢å¼•åˆ—çš„å€¼ä¹Ÿå¯ä»¥æ˜¯NULLå€¼&lt;/strong&gt;æ—¶ï¼Œé‚£ä¹ˆå¯¹è¯¥è¡¨çš„è®¿é—®æ–¹æ³•å°±å¯èƒ½æ˜¯ ref_or_null&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 where b = 1 or b is null; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;20&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/ref_of_null.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;å¯¹æ™®é€šäºŒçº§ç´¢å¼•è¿›è¡Œç­‰å€¼åŒ¹é…æŸ¥è¯¢ï¼Œè¯¥ç´¢å¼•åˆ—çš„å€¼ä¹Ÿå¯ä»¥æ˜¯NULLå€¼ type = ref_of_null&lt;/p&gt;
&lt;h3 id=&#34;index_merge&#34;&gt;index_merge&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;ç´¢å¼•åˆå¹¶&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 where a = 1 or b = 1; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;21&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/index_merge.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;ç´¢å¼•åˆå¹¶ type = index_merge&lt;/p&gt;
&lt;h3 id=&#34;unique_subquery&#34;&gt;unique_subquery&lt;/h3&gt;
&lt;p&gt;å¦‚æœ&lt;strong&gt;æŸ¥è¯¢ä¼˜åŒ–å™¨å†³å®šå°†INå­æŸ¥è¯¢è½¬æ¢ä¸ºEXISTSå­æŸ¥è¯¢ï¼Œ&lt;strong&gt;è€Œä¸”&lt;/strong&gt;å­æŸ¥è¯¢å¯ä»¥ä½¿ç”¨åˆ°ä¸»é”®è¿›è¡Œç­‰å€¼åŒ¹é…&lt;/strong&gt;çš„è¯ï¼Œé‚£ä¹ˆè¯¥å­æŸ¥è¯¢æ‰§è¡Œè®¡åˆ’çš„typeåˆ—çš„å€¼å°±æ˜¯unique_subqueryã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 where c in (select a from t2 where t1.e = t2.e) or a = 1;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»¥ä¸ŠæŸ¥è¯¢å¯ä»¥ä¼˜åŒ–ä¸º EXISTS å­æŸ¥è¯¢ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 where exists(select a from t2 where t1.e = t2.e and t1.c = t2.a) or a = 1
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;22&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/unique_subquery.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;æŸ¥è¯¢ä¼˜åŒ–å™¨å°†INå­æŸ¥è¯¢è½¬æ¢ä¸ºEXISTSå­æŸ¥è¯¢ï¼Œè€Œä¸”å­æŸ¥è¯¢å¯ä»¥ä½¿ç”¨åˆ°ä¸»é”®è¿›è¡Œç­‰å€¼åŒ¹é… &lt;/p&gt;
&lt;p&gt;type = unique_subquery&lt;/p&gt;
&lt;h3 id=&#34;index_subquery&#34;&gt;index_subquery&lt;/h3&gt;
&lt;p&gt;index_subqueryä¸unique_subqueryç±»ä¼¼ï¼Œåªä¸è¿‡è®¿é—®å­æŸ¥è¯¢ä¸­çš„è¡¨æ—¶ä½¿ç”¨çš„æ˜¯æ™®é€šçš„ç´¢å¼•ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 where c in (select b from t2 where t1.e = t2.e) or a = 1;
+----+--------------------+-------+------------+----------------+---------------+----- 
---------+---------+------+------+----------+-------------+ 
| id | select_type | table | partitions | type | possible_keys | key  
| key_len | ref | rows | filtered | Extra | 
+----+--------------------+-------+------------+----------------+---------------+----- 
---------+---------+------+------+----------+-------------+ 
| 1 | PRIMARY | t1 | NULL | ALL | PRIMARY | NULL  
| NULL | NULL | 9 | 100.00 | Using where | 
| 2 | DEPENDENT SUBQUERY | t2 | NULL | index_subquery | idx_t2_b_c_d | 
idx_t2_b_c_d | 5 | func | 1 | 12.50 | Using where | 
+----+--------------------+-------+------------+----------------+---------------+----- 
---------+---------+------+------+----------+-------------+ 
2 rows in set, 2 warnings (0.00 sec) 
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;range&#34;&gt;range&lt;/h3&gt;
&lt;p&gt;èŒƒå›´æŸ¥è¯¢&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 where a &amp;gt; 1; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;23&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%A4%A7%E4%BA%8E_range.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;a &gt; 1 type = range&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 where a in (1);
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;24&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/in_range.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;a in (1) type = const&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 where a in (1,2);
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;25&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/in_range2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;a in (1,2) type = range&lt;/p&gt;
&lt;h3 id=&#34;index&#34;&gt;index&lt;/h3&gt;
&lt;p&gt;å½“æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¦†ç›–ç´¢å¼•ï¼Œä½†&lt;strong&gt;éœ€è¦æ‰«æå…¨éƒ¨çš„ç´¢å¼•è®°å½•&lt;/strong&gt;æ—¶ï¼Œè¯¥è¡¨çš„è®¿é—®æ–¹æ³•å°±æ˜¯indexã€‚&lt;/p&gt;
&lt;p&gt;éå†ç´¢å¼•ä¸Šçš„æ‰€æœ‰å¶å­èŠ‚ç‚¹ï¼Œå› ä¸ºB+æ ‘æ‰€æœ‰æ•°æ®éƒ½å­˜å‚¨åœ¨å¶å­èŠ‚ç‚¹ä¸Šï¼Œè€Œéå¶å­ç»“ç‚¹æ˜¯ç”¨æ¥è¿‡æ»¤ç­›é€‰æ¡ä»¶çš„ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select a from t1; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;26&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/index_1.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ä½¿ç”¨è¾…åŠ©ç´¢å¼•æ²¡æœ‰ä½¿ç”¨ä¸»é”®ç´¢å¼•çš„åŸå› ï¼šè¾…åŠ©ç´¢å¼•ä½“ç§¯è¾ƒå°ï¼Œè¾…åŠ©ç´¢å¼•åªå­˜å‚¨å­—æ®µbã€cã€då’Œä¸»é”®aå­—æ®µï¼›è€Œä¸»ç´¢å¼•å­˜å‚¨æ‰€æœ‰å­—æ®µå€¼ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select b from t1;
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;27&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/index_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; ecplain select e from t1;
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;28&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/index_3.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;e å­—æ®µæ²¡æœ‰ç´¢å¼•ï¼Œæ‰€ä»¥ type = ALL&lt;/p&gt;
&lt;h3 id=&#34;all&#34;&gt;ALL&lt;/h3&gt;
&lt;p&gt;å…¨è¡¨æ‰«æ&lt;/p&gt;
&lt;h2 id=&#34;possible_keys-å’Œ-key&#34;&gt;possible_keys å’Œ key&lt;/h2&gt;
&lt;p&gt;possible_keysåˆ—è¡¨ç¤ºåœ¨æŸä¸ªæŸ¥è¯¢è¯­å¥ä¸­ï¼Œå¯¹æŸä¸ªè¡¨æ‰§è¡Œå•è¡¨æŸ¥è¯¢æ—¶å¯èƒ½ç”¨åˆ°çš„ç´¢å¼•æœ‰å“ªäº›ï¼Œkeyåˆ—è¡¨ç¤ºå®é™…ç”¨åˆ°çš„ç´¢å¼•æœ‰å“ªäº›ã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¿‡æœ‰ä¸€ç‚¹æ¯”è¾ƒç‰¹åˆ«ï¼Œå°±æ˜¯åœ¨ä½¿ç”¨indexè®¿é—®æ–¹æ³•æ¥æŸ¥è¯¢æŸä¸ªè¡¨æ—¶ï¼Œpossible_keysåˆ—æ˜¯ç©ºçš„ï¼Œè€Œkeyåˆ—å±•ç¤ºçš„æ˜¯å®é™…ä½¿ç”¨åˆ°çš„ç´¢å¼• ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;possible_keysåˆ—ä¸­çš„å€¼å¹¶ä¸æ˜¯è¶Šå¤šè¶Šå¥½ï¼Œå¯èƒ½ä½¿ç”¨çš„ç´¢å¼•è¶Šå¤šï¼ŒæŸ¥è¯¢ä¼˜åŒ–å™¨è®¡ç®—æŸ¥è¯¢æˆæœ¬æ—¶å°±å¾—èŠ±è´¹æ›´é•¿ æ—¶é—´ï¼Œæ‰€ä»¥å¦‚æœå¯ä»¥çš„è¯ï¼Œå°½é‡åˆ é™¤é‚£äº›ç”¨ä¸åˆ°çš„ç´¢å¼•&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;key_len&#34;&gt;key_len&lt;/h2&gt;
&lt;p&gt;key_lenåˆ—è¡¨ç¤ºå½“ä¼˜åŒ–å™¨å†³å®šä½¿ç”¨æŸä¸ªç´¢å¼•æ‰§è¡ŒæŸ¥è¯¢æ—¶ï¼Œè¯¥ç´¢å¼•è®°å½•çš„æœ€å¤§é•¿åº¦ï¼Œå®ƒæ˜¯ç”±è¿™ä¸‰ä¸ªéƒ¨åˆ†æ„æˆçš„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹äºä½¿ç”¨å›ºå®šé•¿åº¦ç±»å‹çš„ç´¢å¼•åˆ—æ¥è¯´ï¼Œå®ƒå®é™…å ç”¨çš„å­˜å‚¨ç©ºé—´çš„æœ€å¤§é•¿åº¦å°±æ˜¯è¯¥å›ºå®šå€¼ï¼Œå¯¹äºæŒ‡å®šå­—ç¬¦é›†çš„å˜é•¿ç±»å‹çš„ç´¢å¼•åˆ—æ¥è¯´ï¼Œæ¯”å¦‚æŸä¸ªç´¢å¼•åˆ—çš„ç±»å‹æ˜¯VARCHAR(100)ï¼Œä½¿ç”¨çš„å­—ç¬¦é›†æ˜¯ utf8ï¼Œé‚£ä¹ˆè¯¥åˆ—å®é™…å ç”¨çš„æœ€å¤§å­˜å‚¨ç©ºé—´å°±æ˜¯100 Ã— 3 = 300ä¸ªå­—èŠ‚ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœè¯¥ç´¢å¼•åˆ—å¯ä»¥å­˜å‚¨NULLå€¼ï¼Œåˆ™key_lenæ¯”ä¸å¯ä»¥å­˜å‚¨NULLå€¼æ—¶å¤š1ä¸ªå­—èŠ‚ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹äºå˜é•¿å­—æ®µæ¥è¯´ï¼Œéƒ½ä¼šæœ‰2ä¸ªå­—èŠ‚çš„ç©ºé—´æ¥å­˜å‚¨è¯¥å˜é•¿åˆ—çš„å®é™…é•¿åº¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;29&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/key_len.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;ref-2&#34;&gt;ref&lt;/h2&gt;
&lt;p&gt;å½“ä½¿ç”¨ç´¢å¼•åˆ—ç­‰å€¼åŒ¹é…çš„æ¡ä»¶å»æ‰§è¡ŒæŸ¥è¯¢æ—¶ï¼Œä¹Ÿå°±æ˜¯åœ¨è®¿é—®æ–¹æ³•æ˜¯constã€eq_refã€refã€ref_or_nullã€ unique_subqueryã€index_subqueryå…¶ä¸­ä¹‹ä¸€æ—¶ï¼Œrefåˆ—å±•ç¤ºçš„å°±æ˜¯ä¸ç´¢å¼•åˆ—ä½œç­‰å€¼åŒ¹é…çš„ä¸œè¥¿æ˜¯ä»€ä¹ˆï¼Œæ¯”å¦‚åªæ˜¯ä¸€ä¸ªå¸¸æ•°æˆ–è€…æ˜¯æŸä¸ªåˆ—ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select b from t1 where b = 1; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;30&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/ref_1.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 where a in (select a from t2); 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;31&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/ref_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;rows&#34;&gt;rows&lt;/h2&gt;
&lt;p&gt;å¦‚æœæŸ¥è¯¢ä¼˜åŒ–å™¨å†³å®šä½¿ç”¨å…¨è¡¨æ‰«æçš„æ–¹å¼å¯¹æŸä¸ªè¡¨æ‰§è¡ŒæŸ¥è¯¢æ—¶ï¼Œæ‰§è¡Œè®¡åˆ’çš„rowsåˆ—å°±ä»£è¡¨é¢„è®¡éœ€è¦æ‰«æçš„è¡Œæ•°ï¼Œ å¦‚æœä½¿ç”¨ç´¢å¼•æ¥æ‰§è¡ŒæŸ¥è¯¢æ—¶ï¼Œæ‰§è¡Œè®¡åˆ’çš„rowsåˆ—å°±ä»£è¡¨é¢„è®¡æ‰«æçš„ç´¢å¼•è®°å½•è¡Œæ•°ã€‚&lt;/p&gt;
&lt;h2 id=&#34;filtered&#34;&gt;filtered&lt;/h2&gt;
&lt;p&gt;ä»£è¡¨æŸ¥è¯¢ä¼˜åŒ–å™¨é¢„æµ‹åœ¨è¿™æ‰«æçš„è®°å½•ä¸­ï¼Œæœ‰å¤šå°‘æ¡è®°å½•æ»¡è¶³å…¶ä½™çš„æœç´¢æ¡ä»¶ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 where a &amp;gt; 1 and e = 1; 
+----+-------------+-------+------------+-------+---------------+---------+---------+- 
-----+------+----------+-------------+ 
| id | select_type | table | partitions | type | possible_keys | key | key_len | 
ref | rows | filtered | Extra | 
+----+-------------+-------+------------+-------+---------------+---------+---------+- 
-----+------+----------+-------------+ 
| 1 | SIMPLE | t1 | NULL | range | PRIMARY | PRIMARY | 4 | 
NULL | 8 | 11.11 | Using where | 
+----+-------------+-------+------------+-------+---------------+---------+---------+- 
-----+------+----------+-------------+ 
1 row in set, 1 warning (0.00 sec) 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»æ‰§è¡Œè®¡åˆ’çš„keyåˆ—ä¸­å¯ä»¥çœ‹å‡ºæ¥ï¼Œè¯¥æŸ¥è¯¢ä½¿ç”¨PRIMARYç´¢å¼•æ¥æ‰§è¡ŒæŸ¥è¯¢ï¼Œä»rowsåˆ—å¯ä»¥çœ‹å‡ºæ»¡è¶³a &amp;gt; 1çš„è®°å½•æœ‰ 8æ¡ã€‚æ‰§è¡Œè®¡åˆ’çš„filteredåˆ—å°±ä»£è¡¨æŸ¥è¯¢ä¼˜åŒ–å™¨é¢„æµ‹åœ¨è¿™8æ¡è®°å½•ä¸­ï¼Œ&lt;strong&gt;æœ‰å¤šå°‘æ¡è®°å½•æ»¡è¶³å…¶ä½™çš„æœç´¢æ¡ä»¶&lt;/strong&gt;ï¼Œä¹Ÿå°±æ˜¯e = 1è¿™ä¸ªæ¡ä»¶çš„ç™¾åˆ†æ¯”ã€‚æ­¤å¤„filteredåˆ—çš„å€¼æ˜¯11.11ï¼Œè¯´æ˜æŸ¥è¯¢ä¼˜åŒ–å™¨é¢„æµ‹åœ¨8æ¡è®°å½•ä¸­æœ‰11.11%çš„è®°å½•æ»¡è¶³e = 1 è¿™ä¸ªæ¡ä»¶ã€‚&lt;br&gt;
å¯¹äºå•è¡¨æŸ¥è¯¢æ¥è¯´ï¼Œè¿™ä¸ª filtered åˆ—çš„å€¼æ²¡ä»€ä¹ˆæ„ä¹‰ï¼Œæˆ‘ä»¬æ›´å…³æ³¨åœ¨è¿æ¥æŸ¥è¯¢ä¸­é©±åŠ¨è¡¨å¯¹åº”çš„æ‰§è¡Œè®¡åˆ’è®°å½•çš„  filtered å€¼ï¼Œæ¯”æ–¹è¯´ä¸‹è¾¹è¿™ä¸ªæŸ¥è¯¢ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 join t2 on t1.a = t2.a where t1.e = 1; 
+----+-------------+-------+------------+--------+---------------+---------+--------- 
+------------+------+----------+-------------+ 
| id | select_type | table | partitions | type | possible_keys | key | key_len | 
ref | rows | filtered | Extra | 
+----+-------------+-------+------------+--------+---------------+---------+--------- 
+------------+------+----------+-------------+ 
| 1 | SIMPLE | t1 | NULL | ALL | PRIMARY | NULL | NULL | 
NULL | 9 | 11.11 | Using where | 
| 1 | SIMPLE | t2 | NULL | eq_ref | PRIMARY | PRIMARY | 4 | 
luban.t1.a | 1 | 100.00 | NULL | 
+----+-------------+-------+------------+--------+---------------+---------+--------- 
+------------+------+----------+-------------+ 
2 rows in set, 1 warning (0.00 sec) 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»æ‰§è¡Œè®¡åˆ’ä¸­å¯ä»¥çœ‹å‡ºæ¥ï¼ŒæŸ¥è¯¢ä¼˜åŒ–å™¨æ‰“ç®—æŠŠt1å½“ä½œé©±åŠ¨è¡¨ï¼Œt2å½“ä½œè¢«é©±åŠ¨è¡¨ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°é©±åŠ¨è¡¨t1è¡¨çš„æ‰§è¡Œè®¡åˆ’çš„rowsåˆ—ä¸º9ï¼Œ filtered åˆ—ä¸º11.11ï¼Œè¿™æ„å‘³ç€é©±åŠ¨è¡¨t1è¡¨ç»è¿‡æ¡ä»¶è¿‡æ»¤åæœ‰9 Ã— 11.11% = 0.9999æ¡è®°å½•ï¼Œè¿™è¯´æ˜è¿˜&lt;strong&gt;è¦å¯¹è¢«é©±åŠ¨è¡¨æ‰§è¡Œå¤§çº¦1æ¬¡(row * filtered)æŸ¥è¯¢&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;extra&#34;&gt;Extra&lt;/h2&gt;
&lt;p&gt;Extraåˆ—æ˜¯ç”¨æ¥è¯´æ˜ä¸€äº›é¢å¤–ä¿¡æ¯çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™äº›é¢å¤–ä¿¡æ¯æ¥æ›´å‡†ç¡®çš„ç†è§£MySQLåˆ°åº•å°†å¦‚ä½•æ‰§è¡Œç»™å®šçš„æŸ¥è¯¢è¯­å¥ã€‚&lt;/p&gt;
&lt;h3 id=&#34;no-tables-used&#34;&gt;No tables used&lt;/h3&gt;
&lt;p&gt;å½“&lt;strong&gt;æŸ¥è¯¢è¯­å¥çš„æ²¡æœ‰FROMå­å¥&lt;/strong&gt;æ—¶å°†ä¼šæç¤ºè¯¥é¢å¤–ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select 1; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;32&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Notablesused.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;æŸ¥è¯¢è¯­å¥æ²¡æœ‰ FROM å­å¥æ—¶ï¼šExtra = No tables used&lt;/p&gt;
&lt;h3 id=&#34;impossible-where&#34;&gt;Impossible WHERE&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;æŸ¥è¯¢è¯­å¥çš„WHEREå­å¥æ°¸è¿œä¸ºFALSE&lt;/strong&gt;æ—¶å°†ä¼šæç¤ºè¯¥é¢å¤–ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select b from t1 where 1=0; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;33&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/ImpossibleWHERE.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;WHERE å­å¥æ°¸è¿œä¸º FALSEæ—¶ï¼šExtra = Impossible WHERE&lt;/p&gt;
&lt;h3 id=&#34;no-matching-minmax-row&#34;&gt;No matching min/max row&lt;/h3&gt;
&lt;p&gt;å½“&lt;strong&gt;æŸ¥è¯¢åˆ—è¡¨å¤„æœ‰MINæˆ–è€…MAXèšé›†å‡½æ•°ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰ç¬¦åˆWHEREå­å¥ä¸­çš„æœç´¢æ¡ä»¶çš„è®°å½•&lt;/strong&gt;æ—¶ï¼Œå°†ä¼šæç¤ºè¯¥é¢å¤–ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select max(a) from t1 where a=100; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;34&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/No_matching_minmax_row.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;æŸ¥è¯¢åˆ—è¡¨å¤„æœ‰MINæˆ–è€…MAXèšé›†å‡½æ•°ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰ç¬¦åˆWHEREå­å¥ä¸­çš„æœç´¢æ¡ä»¶çš„è®°å½•æ—¶ï¼šExtra = No matching min/max row&lt;/p&gt;
&lt;h3 id=&#34;using-index&#34;&gt;Using index&lt;/h3&gt;
&lt;p&gt;å½“æˆ‘ä»¬çš„&lt;strong&gt;æŸ¥è¯¢åˆ—è¡¨ä»¥åŠæœç´¢æ¡ä»¶ä¸­åªåŒ…å«å±äºæŸä¸ªç´¢å¼•çš„åˆ—&lt;/strong&gt;ï¼Œä¹Ÿå°±æ˜¯åœ¨&lt;strong&gt;å¯ä»¥ä½¿ç”¨ç´¢å¼•è¦†ç›–&lt;/strong&gt;çš„æƒ…å†µä¸‹ï¼Œåœ¨Extraåˆ—å°†ä¼šæç¤ºè¯¥é¢å¤–ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;è¾…åŠ©ç´¢å¼•åŒ…å« bã€cã€d å­—æ®µï¼Œæ ¹æ®æŸ¥è¯¢æ¡ä»¶ b=1 æ‰¾åˆ°å­—æ®µ d çš„å€¼ï¼Œæ— éœ€å›è¡¨ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select d from t1 where b =1; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;35&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/UsingIndex.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;è¦†ç›–ç´¢å¼• Extra = Using index&lt;/p&gt;
&lt;h3 id=&#34;using-index-condition&#34;&gt;Using index condition&lt;/h3&gt;
&lt;p&gt;æœ‰äº›&lt;strong&gt;æœç´¢æ¡ä»¶ä¸­è™½ç„¶å‡ºç°äº†ç´¢å¼•åˆ—ï¼Œä½†å´ä¸èƒ½ä½¿ç”¨åˆ°ç´¢å¼•&lt;/strong&gt;ï¼ˆåœ¨MySQL 5.6ç‰ˆæœ¬ååŠ å…¥çš„æ–°ç‰¹æ€§ï¼‰&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;36&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Using_index_condition.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 where b =1 and c like &#39;%1&#39;; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;37&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Using_index_condition2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;æœç´¢æ¡ä»¶ä¸­è™½ç„¶å‡ºç°äº†ç´¢å¼•åˆ—ï¼Œä½†å´ä¸èƒ½ä½¿ç”¨åˆ°ç´¢å¼• Extra = Using index condition&lt;/p&gt;
&lt;h3 id=&#34;using-where&#34;&gt;Using where&lt;/h3&gt;
&lt;p&gt;å½“æˆ‘ä»¬ä½¿ç”¨&lt;strong&gt;å…¨è¡¨æ‰«ææ¥æ‰§è¡Œå¯¹æŸä¸ªè¡¨çš„æŸ¥è¯¢ï¼Œå¹¶ä¸”è¯¥è¯­å¥çš„WHEREå­å¥ä¸­æœ‰é’ˆå¯¹è¯¥è¡¨çš„æœç´¢æ¡ä»¶æ—¶&lt;/strong&gt;ï¼Œåœ¨Extraåˆ—ä¸­ä¼šæç¤ºä¸Šè¿°é¢å¤–ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 where e = 1; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;38&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/UsingWhere.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;å…¨è¡¨æ‰«ææ¥æ‰§è¡Œå¯¹æŸä¸ªè¡¨çš„æŸ¥è¯¢ï¼Œå¹¶ä¸”è¯¥è¯­å¥çš„WHEREå­å¥ä¸­æœ‰é’ˆå¯¹è¯¥è¡¨çš„æœç´¢æ¡ä»¶æ—¶ï¼šExtra = Using where&lt;/p&gt;
&lt;h3 id=&#34;using-joinbufferblock-nested-loop&#34;&gt;Using joinbuffer(Block Nested Loop)&lt;/h3&gt;
&lt;p&gt;åœ¨&lt;strong&gt;è¿æ¥æŸ¥è¯¢&lt;/strong&gt;æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå½“è¢«é©±åŠ¨è¡¨&lt;strong&gt;ä¸èƒ½æœ‰æ•ˆçš„åˆ©ç”¨ç´¢å¼•&lt;/strong&gt;åŠ å¿«è®¿é—®é€Ÿåº¦ï¼ŒMySQLä¸€èˆ¬ä¼šä¸ºå…¶åˆ†é…ä¸€å—åå«join buffer çš„å†…å­˜å—æ¥åŠ å¿«æŸ¥è¯¢é€Ÿåº¦ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 join t2 on t1.e = t2.e; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;39&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Using_joinbuffer.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;è¿æ¥æŸ¥è¯¢ä¸èƒ½ç”¨åˆ°ç´¢å¼•ï¼Œåˆ†é… join buffer å†…å­˜å—ï¼šExtra = Using join buffer&lt;/p&gt;
&lt;p&gt;å¯ä»¥åœ¨å¯¹t2è¡¨çš„æ‰§è¡Œè®¡åˆ’çš„Extraåˆ—æ˜¾ç¤ºäº†ä¸¤ä¸ªæç¤ºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Using join buffer (Block Nested Loop)ï¼šè¿™æ˜¯å› ä¸ºå¯¹è¡¨t2çš„è®¿é—®ä¸èƒ½æœ‰æ•ˆåˆ©ç”¨ç´¢å¼•ï¼Œåªå¥½é€€è€Œæ±‚å…¶æ¬¡ï¼Œä½¿ç”¨join bufferæ¥å‡å°‘å¯¹t2è¡¨çš„è®¿é—®æ¬¡æ•°ï¼Œä»è€Œæé«˜æ€§èƒ½ã€‚&lt;/li&gt;
&lt;li&gt;Using whereï¼šå¯ä»¥çœ‹åˆ°æŸ¥è¯¢è¯­å¥ä¸­æœ‰ä¸€ä¸ªt1.e = t2.eæ¡ä»¶ï¼Œå› ä¸ºt1æ˜¯é©±åŠ¨è¡¨ï¼Œt2æ˜¯è¢«é©±åŠ¨è¡¨ï¼Œæ‰€ä»¥åœ¨è®¿é—®t2è¡¨æ—¶ï¼Œt1.eçš„å€¼å·²ç»ç¡®å®šä¸‹æ¥äº†ï¼Œæ‰€ä»¥å®é™…ä¸ŠæŸ¥è¯¢t2è¡¨çš„æ¡ä»¶å°±æ˜¯t2.e = ä¸€ä¸ªå¸¸æ•°ï¼Œæ‰€ä»¥æç¤ºäº†Using whereé¢å¤–ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;using-filesort&#34;&gt;Using filesort&lt;/h3&gt;
&lt;p&gt;å¾ˆå¤šæƒ…å†µä¸‹æ’åºæ“ä½œæ— æ³•ä½¿ç”¨åˆ°ç´¢å¼•ï¼Œåªèƒ½åœ¨å†…å­˜ä¸­ï¼ˆè®°å½•è¾ƒå°‘çš„æ—¶å€™ï¼‰æˆ–è€…ç£ç›˜ä¸­ï¼ˆè®°å½•è¾ƒå¤šçš„æ—¶å€™ï¼‰è¿›è¡Œæ’åºï¼Œè¿™ç§&lt;strong&gt;åœ¨å†…å­˜ä¸­æˆ–è€…ç£ç›˜ä¸Šè¿›è¡Œæ’åºçš„æ–¹å¼ç»Ÿç§°ä¸ºæ–‡ä»¶æ’åº&lt;/strong&gt;ï¼ˆè‹±æ–‡åï¼šfilesortï¼‰ã€‚å¦‚æœ&lt;strong&gt;æŸä¸ªæŸ¥è¯¢éœ€è¦ä½¿ç”¨æ–‡ä»¶æ’åºçš„æ–¹å¼æ‰§è¡ŒæŸ¥è¯¢&lt;/strong&gt;ï¼Œå°±ä¼šåœ¨æ‰§è¡Œè®¡åˆ’çš„Extraåˆ—ä¸­æ˜¾ç¤ºUsing filesortæç¤ºã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 order by e; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;40&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Using_filesort.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;æ’åº Extra = Using filesort&lt;/p&gt;
&lt;h3 id=&#34;using-temporary&#34;&gt;Using temporary&lt;/h3&gt;
&lt;p&gt;åœ¨è®¸å¤šæŸ¥è¯¢çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼ŒMySQLå¯èƒ½ä¼šå€ŸåŠ©&lt;strong&gt;ä¸´æ—¶è¡¨&lt;/strong&gt;æ¥å®Œæˆä¸€äº›åŠŸèƒ½ï¼Œæ¯”å¦‚&lt;strong&gt;å»é‡ã€æ’åº&lt;/strong&gt;ä¹‹ç±»çš„ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨æ‰§è¡Œè®¸å¤šåŒ…å«&lt;strong&gt;DISTINCTã€GROUP BYã€UNION&lt;/strong&gt;ç­‰å­å¥çš„æŸ¥è¯¢è¿‡ç¨‹ä¸­ï¼Œå¦‚æœ&lt;strong&gt;ä¸èƒ½&lt;/strong&gt;æœ‰æ•ˆ&lt;strong&gt;åˆ©ç”¨ç´¢å¼•&lt;/strong&gt;æ¥å®ŒæˆæŸ¥è¯¢ï¼ŒMySQLå¾ˆæœ‰å¯èƒ½å¯»æ±‚é€šè¿‡&lt;strong&gt;å»ºç«‹å†…éƒ¨çš„ä¸´æ—¶è¡¨&lt;/strong&gt;æ¥æ‰§è¡ŒæŸ¥è¯¢ã€‚å¦‚æœæŸ¥è¯¢ä¸­ä½¿ç”¨åˆ°äº†å†…éƒ¨çš„ä¸´æ—¶è¡¨ï¼Œåœ¨æ‰§è¡Œè®¡åˆ’çš„Extraåˆ—å°†ä¼šæ˜¾ç¤ºUsing temporaryæç¤ºã€‚&lt;/p&gt;
&lt;p&gt;èƒ½åˆ©ç”¨ç´¢å¼•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select distinct b from t1; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;41&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Using_temporary.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;åˆ©ç”¨ç´¢å¼•distinctï¼šExtra = Using index&lt;/p&gt;
&lt;p&gt;ä¸èƒ½åˆ©ç”¨ç´¢å¼•&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select distinct e from t1; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;42&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Using_temporary2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;ä¸èƒ½åˆ©ç”¨ç´¢å¼•çš„ distinctï¼Œå»ºç«‹å†…éƒ¨ä¸´æ—¶è¡¨ï¼šExtra = Using temporary&lt;/p&gt;
&lt;p&gt;å³æœ‰Using temporaryï¼Œåˆæœ‰Using filesortï¼Œå› ä¸ºgroup byé»˜è®¤ä¼šå…ˆæ’åº ï¼ˆUsing filesortï¼‰&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select e, count(1) from t1 group by e; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;43&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Using_temporary3.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;Extra = Using temporary; Using filesort&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨order by nullç¦ç”¨æ’åº&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select e, count(1) from t1 group by e order by null; 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;44&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Using_temporary4.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center;font-family:æ¥·ä½“&#34;&gt;ç¦ç”¨æ’åºï¼ŒExtra = Using temporary&lt;/p&gt;
&lt;h3 id=&#34;start-temporary-end-temporary&#34;&gt;Start temporaryã€End temporary&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;æŸ¥è¯¢ä¼˜åŒ–å™¨ä¼šä¼˜å…ˆå°è¯•å°†INå­æŸ¥è¯¢è½¬æ¢æˆsemi-join&lt;/strong&gt;ï¼Œè€Œsemi-joinåˆæœ‰å¥½å¤šç§æ‰§è¡Œç­–ç•¥ï¼Œå½“æ‰§è¡Œç­–ç•¥ä¸º &lt;strong&gt;DuplicateWeedout &lt;strong&gt;æ—¶ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡&lt;/strong&gt;å»ºç«‹ä¸´æ—¶è¡¨&lt;/strong&gt;æ¥å®ç°ä¸ºå¤–å±‚æŸ¥è¯¢ä¸­çš„è®°å½•è¿›è¡Œ&lt;strong&gt;å»é‡&lt;/strong&gt;æ“ä½œæ—¶ï¼Œ&lt;strong&gt;é©±åŠ¨è¡¨&lt;/strong&gt;æŸ¥è¯¢æ‰§è¡Œè®¡åˆ’çš„Extraåˆ—å°†æ˜¾ç¤º&lt;strong&gt;Start temporary&lt;/strong&gt;æç¤ºï¼Œ&lt;strong&gt;è¢«é©±åŠ¨è¡¨&lt;/strong&gt;æŸ¥è¯¢æ‰§è¡Œè®¡åˆ’çš„Extraåˆ—å°†æ˜¾ç¤º&lt;strong&gt;End temporary&lt;/strong&gt;æç¤º&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 where a in (select e from t2 where e = 1); 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;45&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Start_temporary.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;firstmatchè¡¨å&#34;&gt;FirstMatchï¼ˆè¡¨åï¼‰&lt;/h3&gt;
&lt;p&gt;åœ¨å°†Inå­æŸ¥è¯¢è½¬ä¸ºsemi-joinæ—¶ï¼Œå¦‚æœé‡‡ç”¨çš„æ˜¯&lt;strong&gt;FirstMatch&lt;/strong&gt;æ‰§è¡Œç­–ç•¥ï¼Œåˆ™åœ¨&lt;strong&gt;è¢«é©±åŠ¨è¡¨&lt;/strong&gt;æ‰§è¡Œè®¡åˆ’çš„Extraåˆ—å°±æ˜¯æ˜¾ç¤º **FirstMatch(tbl_name)**æç¤ºã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mysql&amp;gt; explain select * from t1 where a in (select c from t2 where c = 1); 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;46&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/FirstMatch.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h1 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h1&gt;
&lt;h2 id=&#34;æ€§èƒ½æŒ‰-type-æ’åº&#34;&gt;æ€§èƒ½æŒ‰ type æ’åº&lt;/h2&gt;
&lt;p&gt;system &amp;gt; const &amp;gt; eq_ref &amp;gt; ref &amp;gt; ref_or_null &amp;gt; index_merge &amp;gt; unique_subquery &amp;gt; index_subquery &amp;gt; range &amp;gt; index &amp;gt; ALL&lt;/p&gt;
&lt;h2 id=&#34;æ€§èƒ½æŒ‰-extra-æ’åº&#34;&gt;æ€§èƒ½æŒ‰ Extra æ’åº&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Using indexï¼šç”¨äº†è¦†ç›–ç´¢å¼•&lt;/li&gt;
&lt;li&gt;Using index conditionï¼šç”¨äº†æ¡ä»¶ç´¢å¼•ï¼ˆç´¢å¼•ä¸‹æ¨ï¼‰&lt;/li&gt;
&lt;li&gt;Using whereï¼šä»ç´¢å¼•æŸ¥å‡ºæ¥æ•°æ®åç»§ç»­ç”¨whereæ¡ä»¶è¿‡æ»¤&lt;/li&gt;
&lt;li&gt;Using join buffer (Block Nested Loop)ï¼šjoinçš„æ—¶å€™åˆ©ç”¨äº†join bufferï¼ˆä¼˜åŒ–ç­–ç•¥ï¼šå»é™¤å¤–è¿æ¥ã€å¢ å¤§join bufferå¤§å°ï¼‰&lt;/li&gt;
&lt;li&gt;Using filesortï¼šç”¨äº†æ–‡ä»¶æ’åºï¼Œæ’åºçš„æ—¶å€™æ²¡æœ‰ç”¨åˆ°ç´¢å¼•&lt;/li&gt;
&lt;li&gt;Using temporaryï¼šç”¨äº†ä¸´æ—¶è¡¨ï¼ˆä¼˜åŒ–ç­–ç•¥ï¼šå¢åŠ æ¡ä»¶ä»¥å‡å°‘ç»“æœé›†ã€å¢åŠ ç´¢å¼•ï¼Œæ€è·¯å°±æ˜¯è¦ä¹ˆå‡å°‘å¾…æ’åºçš„æ•°é‡ï¼Œè¦ä¹ˆå°±æå‰æ’å¥½åºï¼‰&lt;/li&gt;
&lt;li&gt;Start temporary, End temporaryï¼šå­æŸ¥è¯¢çš„æ—¶å€™ï¼Œå¯ä»¥ä¼˜åŒ–æˆåŠè¿æ¥ï¼Œä½†æ˜¯ä½¿ç”¨çš„æ˜¯é€šè¿‡ä¸´æ—¶è¡¨æ¥å»é‡&lt;/li&gt;
&lt;li&gt;FirstMatch(tbl_name)ï¼šå­æŸ¥è¯¢çš„æ—¶å€™ï¼Œå¯ä»¥ä¼˜åŒ–æˆåŠè¿æ¥ï¼Œä½†æ˜¯ä½¿ç”¨çš„æ˜¯ç›´æ¥è¿›è¡Œæ•°æ®æ¯”è¾ƒæ¥å»é‡&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å¸¸è§çš„ä¼˜åŒ–æ‰‹æ®µ&#34;&gt;å¸¸è§çš„ä¼˜åŒ–æ‰‹æ®µ&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;SQLè¯­å¥ä¸­INåŒ…å«çš„å€¼ä¸åº”è¿‡å¤šï¼Œä¸èƒ½è¶…è¿‡200ä¸ªï¼Œ200ä¸ªä»¥å†…æŸ¥è¯¢ä¼˜åŒ–å™¨è®¡ç®—æˆæœ¬æ—¶æ¯”è¾ƒç²¾å‡†ï¼Œè¶…è¿‡200 ä¸ªæ˜¯ä¼°ç®—çš„æˆæœ¬ï¼Œå¦å¤–å»ºè®®èƒ½ç”¨betweenå°±ä¸è¦ç”¨inï¼Œè¿™æ ·å°±å¯ä»¥ä½¿ç”¨rangeç´¢å¼•äº†ã€‚&lt;/li&gt;
&lt;li&gt;SELECTè¯­å¥åŠ¡å¿…æŒ‡æ˜å­—æ®µåç§°ï¼šSELECT * å¢åŠ å¾ˆå¤šä¸å¿…è¦çš„æ¶ˆè€—ï¼ˆcpuã€ioã€å†…å­˜ã€ç½‘ç»œå¸¦å®½ï¼‰ï¼›å¢åŠ äº†ä½¿ç”¨è¦†ç›–ç´¢å¼•çš„å¯èƒ½æ€§ï¼›å½“è¡¨ç»“æ„å‘ç”Ÿæ”¹å˜æ—¶ï¼Œå‰ç«¯ä¹Ÿéœ€è¦æ›´æ–°ã€‚æ‰€ä»¥è¦æ±‚ç›´æ¥åœ¨selectåé¢æ¥ä¸Šå­—æ®µåã€‚&lt;/li&gt;
&lt;li&gt;å½“åªéœ€è¦ä¸€æ¡æ•°æ®çš„æ—¶å€™ï¼Œä½¿ç”¨limit 1&lt;/li&gt;
&lt;li&gt;æ’åºæ—¶æ³¨æ„æ˜¯å¦èƒ½ç”¨åˆ°ç´¢å¼•&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ or æ—¶å¦‚æœæ²¡æœ‰ç”¨åˆ°ç´¢å¼•ï¼Œå¯ä»¥æ”¹ä¸ºunion all æˆ–è€…union&lt;/li&gt;
&lt;li&gt;å¦‚æœinä¸èƒ½ç”¨åˆ°ç´¢å¼•ï¼Œå¯ä»¥æ”¹æˆexistsçœ‹æ˜¯å¦èƒ½ç”¨åˆ°ç´¢å¼•&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨åˆç†çš„åˆ†é¡µæ–¹å¼ä»¥æé«˜åˆ†é¡µçš„æ•ˆç‡&lt;/li&gt;
&lt;li&gt;ä¸å»ºè®®ä½¿ç”¨%å‰ç¼€æ¨¡ç³ŠæŸ¥è¯¢&lt;/li&gt;
&lt;li&gt;é¿å…åœ¨whereå­å¥ä¸­å¯¹å­—æ®µè¿›è¡Œè¡¨è¾¾å¼æ“ä½œ&lt;/li&gt;
&lt;li&gt;é¿å…éšå¼ç±»å‹è½¬æ¢ ï¼ˆå­—ç¬¦ â€˜aâ€™ -&amp;gt; æ•°å­— 0ï¼Œæ•°å­— !-&amp;gt; å­—ç¬¦ï¼‰&lt;/li&gt;
&lt;li&gt;å¯¹äºè”åˆç´¢å¼•æ¥è¯´ï¼Œè¦éµå®ˆæœ€å·¦å‰ç¼€æ³•åˆ™&lt;/li&gt;
&lt;li&gt;å¿…è¦æ—¶å¯ä»¥ä½¿ç”¨force indexæ¥å¼ºåˆ¶æŸ¥è¯¢èµ°æŸä¸ªç´¢å¼•&lt;/li&gt;
&lt;li&gt;å¯¹äºè”åˆç´¢å¼•æ¥è¯´ï¼Œå¦‚æœå­˜åœ¨èŒƒå›´æŸ¥è¯¢ï¼Œæ¯”å¦‚between,&amp;gt;,&amp;lt;ç­‰æ¡ä»¶æ—¶ï¼Œä¼šé€ æˆåé¢çš„ç´¢å¼•å­—æ®µå¤±æ•ˆã€‚&lt;/li&gt;
&lt;li&gt;å°½é‡ä½¿ç”¨inner joinï¼Œé¿å…left joinï¼Œè®©æŸ¥è¯¢ä¼˜åŒ–å™¨æ¥è‡ªåŠ¨é€‰æ‹©å°è¡¨ä½œä¸ºé©±åŠ¨è¡¨&lt;/li&gt;
&lt;li&gt;å¿…è¦æ—¶åˆ»å¯ä»¥ä½¿ç”¨straight_joinæ¥æŒ‡å®šé©±åŠ¨è¡¨ï¼Œå‰ææ¡ä»¶æ˜¯æœ¬èº«æ˜¯inner join&lt;/li&gt;
&lt;/ol&gt;
">MySQL â€”â€” Explain å…³é”®å­—</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/leetcode53-zui-da-zi-xu-he/"" data-c="
          &lt;h2 id=&#34;é—®é¢˜æè¿°&#34;&gt;é—®é¢˜æè¿°&lt;/h2&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ numsÂ ï¼Œæ‰¾åˆ°ä¸€ä¸ªå…·æœ‰æœ€å¤§å’Œçš„è¿ç»­å­æ•°ç»„ï¼ˆå­æ•°ç»„æœ€å°‘åŒ…å«ä¸€ä¸ªå…ƒç´ ï¼‰ï¼Œè¿”å›å…¶æœ€å¤§å’Œã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç¤ºä¾‹&#34;&gt;ç¤ºä¾‹:&lt;/h2&gt;
&lt;p&gt;è¾“å…¥: [-2,1,-3,4,-1,2,1,-5,4],&lt;br&gt;
è¾“å‡º: 6&lt;/p&gt;
&lt;p&gt;è§£é‡Š:Â è¿ç»­å­æ•°ç»„Â [4,-1,2,1] çš„å’Œæœ€å¤§ï¼Œä¸ºÂ 6ã€‚&lt;/p&gt;
&lt;p&gt;è¿›é˜¶:&lt;br&gt;
å¦‚æœä½ å·²ç»å®ç°å¤æ‚åº¦ä¸º O(n) çš„è§£æ³•ï¼Œå°è¯•ä½¿ç”¨æ›´ä¸ºç²¾å¦™çš„åˆ†æ²»æ³•æ±‚è§£ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åˆ†æ&#34;&gt;åˆ†æ&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;&lt;strong&gt;å½“å‰æ•°å­—&lt;/strong&gt;&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;&lt;strong&gt;è¿ç»­å­åºåˆ—æœ€å¤§å’Œ maxSum&lt;/strong&gt;&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;&lt;strong&gt;å­åºåˆ—å½“å‰ç´¯åŠ å’Œ cur&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;2&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;2&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-8&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;3&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;3&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-3 &amp;lt; 0, æ›´æ–° cur = 3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-2&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;4&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;5&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-10&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;-5&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;ç¬¬ä¸€ä¸ªæ•°ï¼š2ã€‚è¿ç»­å­åºåˆ—æœ€å¤§å’Œ &lt;code&gt;maxSum = 2&lt;/code&gt;ï¼›å­åºåˆ—å½“å‰ç´¯åŠ å’Œ &lt;code&gt;cur=2&lt;/code&gt;ï¼›&lt;/li&gt;
&lt;li&gt;ç¬¬äºŒä¸ªæ•°ï¼š-8ã€‚&lt;code&gt;2 - 8 = -6 &amp;lt; maxSum&lt;/code&gt;ï¼Œä¸æ›´æ–° maxSum&lt;/li&gt;
&lt;li&gt;ç¬¬ä¸‰ä¸ªæ•°ï¼š3ã€‚&lt;code&gt;-6 + 3 = -3 &amp;lt; maxSum&lt;/code&gt;ï¼Œä¸æ›´æ–° maxSum
&lt;ul&gt;
&lt;li&gt;å¦‚æœä¸åŠ  -6ï¼Œè€Œæ˜¯è®© 3 è‡ªæˆä¸€ä¸ªå­åºåˆ—ï¼Œ&lt;code&gt;3 &amp;gt; maxSum&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;maxSum = 3ï¼›cur = 3&lt;/li&gt;
&lt;li&gt;å¦‚æœå‰é¢ç´¯åŠ çš„å’Œä¸ºè´Ÿæ•°æˆ–é›¶ï¼Œå¯¹åé¢çš„æ±‚å’Œä¸ä¼šæœ‰æ­£å‘è´¡çŒ®ï¼Œå› æ­¤å¯ä»¥èˆå¼ƒå‰é¢è¿™æ®µå­åºåˆ—çš„å’Œï¼Œé‡æ–°å¼€å§‹ä¸€ä¸ªæ–°çš„å­åºåˆ—ã€‚å½“å‰è¿ç»­å­åºåˆ—çš„å’Œè®°ä¸º cur&lt;/li&gt;
&lt;li&gt;&lt;code&gt;if ( cur&amp;lt;= 0 )&lt;/code&gt;ï¼Œå°±ä»å½“å‰å…ƒç´ é‡æ–°å¼€å§‹ä¸€ä¸ªæ–°çš„å­åºåˆ—ï¼Œå½“å‰å’Œ cur æ›´æ–°ä¸ºå½“å‰çš„å…ƒç´ å€¼ &lt;code&gt;cur = a[i];&lt;/code&gt; å¦åˆ™å­åºåˆ—å°±ç»§ç»­å‘å‰ç›¸åŠ  &lt;code&gt;cur = cur + a[i]&lt;/code&gt; ã€‚æ¯æ¬¡å­åºåˆ—çš„å’Œæ›´æ–°åï¼Œéƒ½è¦å’Œæœ€å¤§å€¼ maxSum å¯¹æ¯”ï¼Œä»¥æ­¤æ›´æ–°æœ€å¤§å€¼ &lt;code&gt;maxSum = max(maxSum, cur)&lt;/code&gt;ï¼Œè¿™æ ·éå†å®Œæ•°ç»„ï¼Œå°±èƒ½æ‰¾åˆ°è¿ç»­å­åºåˆ—çš„æœ€å¤§å’Œ&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç¬¬å››ä¸ªæ•°ï¼š-2ã€‚&lt;code&gt;3 - 2 = 1&lt;/code&gt;ï¼Œ&lt;code&gt;cur=1 &amp;gt; 0&lt;/code&gt;ï¼Œäºæ˜¯ä¿ç•™ &lt;code&gt;cur=1&lt;/code&gt;ã€‚&lt;code&gt;cur=1 &amp;lt; maxSum=3&lt;/code&gt;ï¼Œä¸æ›´æ–° maxSum&lt;/li&gt;
&lt;li&gt;ç¬¬äº”ä¸ªæ•°ï¼š4ã€‚&lt;code&gt;1+4=5 &amp;gt; maxSum&lt;/code&gt;ï¼Œä¿ç•™ &lt;code&gt;cur=5&lt;/code&gt;ï¼Œæ›´æ–° maxSum=5&lt;/li&gt;
&lt;li&gt;ç¬¬å…­ä¸ªæ•°ï¼š-10ã€‚&lt;code&gt;5-10=-5 &amp;lt; 5&lt;/code&gt;ï¼Œä¸æ›´æ–° maxSum&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;å¤æ‚åº¦åˆ†æ&#34;&gt;å¤æ‚åº¦åˆ†æ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;T = O(n)&lt;br&gt;
éå†æ•°ç»„ä¸€éï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(n)ã€‚&lt;/li&gt;
&lt;li&gt;S = O(1)&lt;br&gt;
æ²¡æœ‰ä½¿ç”¨é¢å¤–çš„å­˜å‚¨ç©ºé—´ï¼Œç©ºé—´å¤æ‚åº¦ä¸º O(1)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;ä»£ç &#34;&gt;ä»£ç &lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;class Solution {

  // Time: O(n), Space: O(1)
  public int maxSubArray(int[] nums) {
      // åˆå§‹åŒ–å­åºåˆ—æœ€å¤§å’Œ max å’Œ å­åºåˆ—å½“å‰ç´¯åŠ å’Œ
      int max = Integer.MIN_VALUE, cur = 0;
    // for å¾ªç¯éå†æ•°ç»„
    for (int i = 0; i &amp;lt; nums.length; ++i) {
      // ç´¯åŠ å’Œ &amp;lt;= 0ï¼Œåˆ™ç”¨å½“å‰å…ƒç´ å€¼ nums[i] æ›´æ–°ç´¯åŠ å’Œï¼Œè¡¨ç¤ºå¼€å§‹ä¸€ä¸ªæ–°çš„å­åºåˆ—ï¼›å¦åˆ™ç»§ç»­ç´¯åŠ å½“å‰å…ƒç´ çš„å€¼
      cur = cur &amp;lt;= 0 ? nums[i] : (cur + nums[i]);
      // æ›´æ–°å½“å‰å­åºåˆ—çš„æœ€å¤§å€¼
      max = Math.max(max, cur);
    }
    return max;
  }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;æ¥æº&#34;&gt;æ¥æº&lt;/h2&gt;
&lt;p&gt;æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰&lt;br&gt;
é“¾æ¥ï¼š&lt;a href=&#34;https://leetcode-cn.com/problems/maximum-subarray&#34;&gt;https://leetcode-cn.com/problems/maximum-subarray&lt;/a&gt;&lt;/p&gt;
">leetcode53. æœ€å¤§å­åºå’Œ</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/shen-ru-xue-xi-bing-fa-bian-cheng-zhong-de-synchronized/"" data-c="
          &lt;h1 id=&#34;ç¬¬ä¸€ç« å¹¶å‘ç¼–ç¨‹ä¸­çš„ä¸‰ä¸ªé—®é¢˜&#34;&gt;ç¬¬ä¸€ç« ï¼šå¹¶å‘ç¼–ç¨‹ä¸­çš„ä¸‰ä¸ªé—®é¢˜&lt;/h1&gt;
&lt;h2 id=&#34;å¯è§æ€§&#34;&gt;å¯è§æ€§&lt;/h2&gt;
&lt;p&gt;å¯è§æ€§ï¼ˆVisibilityï¼‰ï¼šæ˜¯æŒ‡&lt;strong&gt;ä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡è¿›è¡Œä¿®æ”¹ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ç«‹å³å¾—åˆ°ä¿®æ”¹åçš„æœ€æ–°å€¼&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¯è§æ€§æ¼”ç¤º&#34;&gt;å¯è§æ€§æ¼”ç¤º&lt;/h3&gt;
&lt;p&gt;æ¡ˆä¾‹æ¼”ç¤ºï¼šä¸€ä¸ªçº¿ç¨‹æ ¹æ® &lt;code&gt;boolean&lt;/code&gt; ç±»å‹çš„æ ‡è®° &lt;code&gt;flag&lt;/code&gt;ï¼Œ &lt;code&gt;while&lt;/code&gt; å¾ªç¯ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹æ”¹å˜è¿™ä¸ª &lt;code&gt;flag&lt;/code&gt; å˜é‡çš„å€¼ï¼Œè¿™ä¸ªçº¿ç¨‹å¹¶ä¸ä¼šåœæ­¢å¾ªç¯ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;package com.itheima.demo01_concurrent_problem;

/**
 *ç›®æ ‡:æ¼”ç¤ºå¯è§æ€§é—®é¢˜
 *     1.åˆ›å»ºä¸€ä¸ªå…±äº«å˜é‡
 *     2.åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ä¸æ–­è¯»å–å…±äº«å˜é‡
 *     3.åˆ›å»ºä¸€é¥¿çº¿ç¨‹ä¿®æ”¹å…±äº«å˜é‡
 */
public class Test01Visibility {
    // 1.åˆ›å»ºä¸€ä¸ªå…±äº«å˜é‡
    private static boolean flag = true;

    public static void main(String[] args) throws InterruptedException {
        // 2.åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ä¸æ–­è¯»å–å…±äº«å˜é‡
        new Thread(() -&amp;gt; {
            while (flag) {

            }
        }).start();

        Thread.sleep(2000);

        // 3.åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹å…±äº«å˜é‡
        new Thread(() -&amp;gt; {
            flag = false;
            System.out.println(&amp;quot;çº¿ç¨‹ä¿®æ”¹äº†å˜é‡çš„å€¼ä¸ºfalse&amp;quot;);
        }).start();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;çº¿ç¨‹ä¿®æ”¹äº†å˜é‡çš„å€¼ä¸ºfalse
ï¼ˆé˜»å¡Â·Â·Â·ï¼‰
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;å°ç»“&#34;&gt;å°ç»“&lt;/h3&gt;
&lt;p&gt;å¹¶å‘ç¼–ç¨‹æ—¶ï¼Œä¼šå‡ºç°å¯è§æ€§é—®é¢˜ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡è¿›è¡Œäº†ä¿®æ”¹ï¼Œå¦å¤–çš„çº¿ç¨‹å¹¶æ²¡æœ‰ç«‹å³çœ‹åˆ°ä¿®æ”¹åçš„æœ€æ–°å€¼ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åŸå­æ€§&#34;&gt;åŸå­æ€§&lt;/h2&gt;
&lt;p&gt;åŸå­æ€§ï¼ˆAtomicityï¼‰ï¼š&lt;strong&gt;åœ¨ä¸€æ¬¡æˆ–å¤šæ¬¡æ“ä½œä¸­ï¼Œè¦ä¹ˆæ‰€æœ‰çš„æ“ä½œéƒ½æ‰§è¡Œå¹¶ä¸”ä¸ä¼šå—å…¶ä»–å› ç´ å¹²æ‰°è€Œä¸­æ–­ï¼Œè¦ä¹ˆæ‰€æœ‰çš„æ“ä½œéƒ½ä¸æ‰§è¡Œ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åŸå­æ€§æ¼”ç¤º&#34;&gt;åŸå­æ€§æ¼”ç¤º&lt;/h3&gt;
&lt;p&gt;æ¡ˆä¾‹æ¼”ç¤º:5ä¸ªçº¿ç¨‹å„æ‰§è¡Œ1000æ¬¡ i++;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;package com.itheima.demo01_concurrent_problem;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;

/**
 * ç›®æ ‡:æ¼”ç¤ºåŸå­æ€§é—®é¢˜
 *     1.å®šä¹‰ä¸€ä¸ªå…±äº«å˜é‡number
 *     2.å¯¹numberè¿›è¡Œ1000çš„++æ“ä½œ
 *     3.ä½¿ç”¨5ä¸ªçº¿ç¨‹æ¥è¿›è¡Œ
 */
public class Test02Atomicity {
    // 1.å®šä¹‰ä¸€ä¸ªå…±äº«å˜é‡number
    private static int number = 0;

    public static void main(String[] args) throws InterruptedException {
        // 2.å¯¹numberè¿›è¡Œ1000çš„++æ“ä½œ
        Runnable increment = () -&amp;gt; {
            for (int i = 0; i &amp;lt; 1000; i++) {
                number++;
            }
        };
        List&amp;lt;Thread&amp;gt; list = new ArrayList&amp;lt;&amp;gt;();
        // 3.ä½¿ç”¨5ä¸ªçº¿ç¨‹æ¥è¿›è¡Œ
        for (int i = 0; i &amp;lt; 5; i++) {
            Thread t = new Thread(increment);
            t.start();
            list.add(t);
        }

        for (Thread t : list) {
            t.join();
        }

        System.out.println(&amp;quot;number = &amp;quot; + number);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;number = 4955
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;javap&lt;/code&gt;åæ±‡ç¼–&lt;code&gt;class&lt;/code&gt;æ–‡ä»¶ï¼Œå¾—åˆ°ä¸‹é¢çš„å­—èŠ‚ç æŒ‡ä»¤ï¼š&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%8E%9F%E5%AD%90%E6%80%A7%E6%BC%94%E7%A4%BA.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ï¼Œå¯¹äº &lt;code&gt;number++&lt;/code&gt; è€Œè¨€ï¼ˆnumber ä¸ºé™æ€å˜é‡ï¼‰ï¼Œå®é™…ä¼šäº§ç”Ÿå¦‚ä¸‹çš„ JVM å­—èŠ‚ç æŒ‡ä»¤ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;9: getstatic #12    // ä»ç±»ä¿¡æ¯ä¸­åŠ è½½ 12 å· static å˜é‡
12: iconst_1         // æŠŠ int ç±»å‹å¸¸é‡ 1 å‹å…¥æ“ä½œæ•°æ ˆ
13: iadd               // å°†æ“ä½œæ•°æ ˆé¡¶å’Œæ¬¡æ ˆé¡¶å…ƒç´ å¼¹å‡ºå¹¶ç›¸åŠ 
14: putstatic #12 // è®¾ç½® 12 å· static å˜é‡
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç”±æ­¤å¯è§&lt;code&gt;number++&lt;/code&gt;æ˜¯ç”±å¤šæ¡è¯­å¥ç»„æˆï¼Œä»¥ä¸Šå¤šæ¡æŒ‡ä»¤åœ¨ä¸€ä¸ªçº¿ç¨‹çš„æƒ…å†µä¸‹æ˜¯ä¸ä¼šå‡ºé—®é¢˜çš„ï¼Œä½†æ˜¯åœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹å°±å¯èƒ½ä¼šå‡ºç°é—®é¢˜ã€‚æ¯”å¦‚ä¸€ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œ&lt;code&gt;13: iadd&lt;/code&gt;æ—¶ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹åˆæ‰§è¡Œ&lt;code&gt;9: getstatic&lt;/code&gt;ã€‚ä¼šå¯¼è‡´ä¸¤æ¬¡&lt;code&gt;number++&lt;/code&gt;ï¼Œå®é™…ä¸ŠåªåŠ äº†1ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å°ç»“-2&#34;&gt;å°ç»“&lt;/h3&gt;
&lt;p&gt;å¹¶å‘ç¼–ç¨‹æ—¶ï¼Œä¼šå‡ºç°åŸå­æ€§é—®é¢˜ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡æ“ä½œåˆ°ä¸€åŠæ—¶ï¼Œå¦å¤–çš„çº¿ç¨‹ä¹Ÿæœ‰å¯èƒ½æ¥æ“ä½œå…±äº«å˜é‡ï¼Œå¹²æ‰°äº†å‰ä¸€ä¸ªçº¿ç¨‹çš„æ“ä½œã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœ‰åºæ€§&#34;&gt;æœ‰åºæ€§&lt;/h2&gt;
&lt;p&gt;æœ‰åºæ€§ï¼ˆOrderingï¼‰ï¼šæ˜¯æŒ‡ç¨‹åºä¸­ä»£ç çš„æ‰§è¡Œé¡ºåºï¼ŒJavaåœ¨ç¼–è¯‘æ—¶å’Œè¿è¡Œæ—¶ä¼šå¯¹ä»£ç è¿›è¡Œä¼˜åŒ–ï¼Œä¼šå¯¼è‡´&lt;strong&gt;ç¨‹åºæœ€ç»ˆçš„æ‰§è¡Œé¡ºåºä¸ä¸€å®šå°±æ˜¯æˆ‘ä»¬ç¼–å†™ä»£ç æ—¶çš„é¡ºåº&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public static void main(String[] args) {
    int a = 10;
    int b = 20;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;æœ‰åºæ€§æ¼”ç¤º&#34;&gt;æœ‰åºæ€§æ¼”ç¤º&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;jcstress&lt;/code&gt;æ˜¯&lt;code&gt;Java&lt;/code&gt;å¹¶å‘å‹æµ‹å·¥å…·ã€‚&lt;a href=&#34;https://wiki.openjdk.java.net/display/CodeTools/jcstress&#34;&gt;https://wiki.openjdk.java.net/display/CodeTools/jcstress&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹pomæ–‡ä»¶ï¼Œæ·»åŠ ä¾èµ–ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dependency&amp;gt; 
  &amp;lt;groupId&amp;gt;org.openjdk.jcstress&amp;lt;/groupId&amp;gt; 
  &amp;lt;artifactId&amp;gt;jcstress-core&amp;lt;/artifactId&amp;gt; 
  &amp;lt;version&amp;gt;${jcstress.version}&amp;lt;/version&amp;gt; 
&amp;lt;/dependency&amp;gt;  
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»£ç &lt;br&gt;
Test03Orderliness.java&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;import org.openjdk.jcstress.annotations.*;
import org.openjdk.jcstress.infra.results.I_Result;
@JCStressTest
@Outcome(id = {&amp;quot;1&amp;quot;, &amp;quot;4&amp;quot;}, expect = Expect.ACCEPTABLE, desc = &amp;quot;ok&amp;quot;)
@Outcome(id = &amp;quot;0&amp;quot;, expect = Expect.ACCEPTABLE_INTERESTING, desc = &amp;quot;danger&amp;quot;)
@State
public class Test03Orderliness {
    int num = 0;
    boolean ready = false;
    // çº¿ç¨‹ä¸€æ‰§è¡Œçš„ä»£ç 
    @Actor
    public void actor1(I_Result r) {
        if(ready) {
            r.r1 = num + num;
        } else {
            r.r1 = 1;
        }
    }
    // çº¿ç¨‹2æ‰§è¡Œçš„ä»£ç 
    @Actor
    public void actor2(I_Result r) {
        num = 2;
        ready = true;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;I_Result&lt;/code&gt; æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæœ‰ä¸€ä¸ªå±æ€§ &lt;code&gt;r1&lt;/code&gt; ç”¨æ¥ä¿å­˜ç»“æœï¼Œåœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹å¯èƒ½å‡ºç°å‡ ç§ç»“æœï¼Ÿ
&lt;ul&gt;
&lt;li&gt;æƒ…å†µ1ï¼šçº¿ç¨‹1å…ˆæ‰§è¡Œ&lt;code&gt;actor1&lt;/code&gt;ï¼Œè¿™æ—¶&lt;code&gt;ready = false&lt;/code&gt;ï¼Œæ‰€ä»¥è¿›å…¥elseåˆ†æ”¯ç»“æœä¸º1ã€‚&lt;/li&gt;
&lt;li&gt;æƒ…å†µ2ï¼šçº¿ç¨‹2æ‰§è¡Œåˆ°&lt;code&gt;actor2&lt;/code&gt;ï¼Œæ‰§è¡Œäº†&lt;code&gt;num = 2;&lt;/code&gt;å’Œ&lt;code&gt;ready = true&lt;/code&gt;ï¼Œçº¿ç¨‹1æ‰§è¡Œï¼Œè¿™å›è¿›å…¥ if åˆ†æ”¯ï¼Œç»“æœä¸º 4ã€‚&lt;/li&gt;
&lt;li&gt;æƒ…å†µ3ï¼šçº¿ç¨‹2å…ˆæ‰§è¡Œ&lt;code&gt;actor2&lt;/code&gt;ï¼Œåªæ‰§è¡Œ&lt;code&gt;num = 2&lt;/code&gt;ï¼›ä½†æ²¡æ¥å¾—åŠæ‰§è¡Œ &lt;code&gt;ready = true&lt;/code&gt;ï¼Œçº¿ç¨‹1æ‰§è¡Œï¼Œè¿˜æ˜¯è¿›å…¥ elseåˆ†æ”¯ï¼Œç»“æœä¸º1ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿˜æœ‰ä¸€ç§ç»“æœ0&lt;/strong&gt;ã€‚ä»£ç é‡æ’åºå°† &lt;code&gt;actor2&lt;/code&gt; ä¸­ &lt;code&gt;num = 2&lt;/code&gt; å’Œ &lt;code&gt;ready = true&lt;/code&gt; ååºã€‚å…ˆæ‰§è¡Œ &lt;code&gt;actor2&lt;/code&gt; ä¸­çš„ &lt;code&gt;ready = true&lt;/code&gt;ï¼Œç„¶åæ‰§è¡Œ &lt;code&gt;actor1&lt;/code&gt; ä¸­ if åˆ¤æ–­ï¼Œç»“æœä¸º 0 + 0 = 0ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿è¡Œæµ‹è¯•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mvn clean install 
java -jar target/jcstress.jar
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;å°ç»“-3&#34;&gt;å°ç»“&lt;/h3&gt;
&lt;p&gt;ç¨‹åºä»£ç åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­çš„å…ˆåé¡ºåºï¼Œç”±äº&lt;code&gt;Java&lt;/code&gt;åœ¨ç¼–è¯‘æœŸä»¥åŠè¿è¡ŒæœŸçš„ä¼˜åŒ–ï¼Œå¯¼è‡´äº†ä»£ç çš„æ‰§è¡Œé¡ºåºæœªå¿…å°±æ˜¯å¼€å‘è€…ç¼–å†™ä»£ç æ—¶çš„é¡ºåºã€‚&lt;/p&gt;
&lt;h1 id=&#34;ç¬¬äºŒç« javaå†…å­˜æ¨¡å‹jmm&#34;&gt;ç¬¬äºŒç« ï¼šJavaå†…å­˜æ¨¡å‹(JMM)&lt;/h1&gt;
&lt;p&gt;åœ¨ä»‹ç»Javaå†…å­˜æ¨¡å‹ä¹‹å‰ï¼Œå…ˆæ¥çœ‹ä¸€ä¸‹åˆ°åº•ä»€ä¹ˆæ˜¯è®¡ç®—æœºå†…å­˜æ¨¡å‹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è®¡ç®—æœºç»“æ„&#34;&gt;è®¡ç®—æœºç»“æ„&lt;/h2&gt;
&lt;h3 id=&#34;è®¡ç®—æœºç»“æ„ç®€ä»‹&#34;&gt;è®¡ç®—æœºç»“æ„ç®€ä»‹&lt;/h3&gt;
&lt;p&gt;å†¯è¯ºä¾æ›¼ï¼Œæå‡ºè®¡ç®—æœºç”±äº”å¤§ç»„æˆéƒ¨åˆ†ï¼Œ&lt;strong&gt;è¾“å…¥è®¾å¤‡ï¼Œè¾“å‡ºè®¾å¤‡ï¼Œå­˜å‚¨å™¨ï¼Œæ§åˆ¶å™¨ï¼Œè¿ç®—å™¨&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%93%E6%9E%84.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center&#34;&gt;è®¡ç®—æœºç»“æ„&lt;/p&gt;
&lt;h3 id=&#34;cpu&#34;&gt;CPU&lt;/h3&gt;
&lt;p&gt;ä¸­å¤®å¤„ç†å™¨ï¼Œæ˜¯è®¡ç®—æœºçš„&lt;strong&gt;æ§åˆ¶å’Œè¿ç®—&lt;/strong&gt;çš„æ ¸å¿ƒï¼Œæˆ‘ä»¬çš„ç¨‹åºæœ€ç»ˆéƒ½ä¼šå˜æˆæŒ‡ä»¤è®©CPUå»æ‰§è¡Œï¼Œå¤„ç†ç¨‹åºä¸­çš„æ•°æ®ã€‚&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/CPU.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p style = &#34;text-align:center&#34;&gt;CPU&lt;/p&gt;
&lt;h3 id=&#34;å†…å­˜&#34;&gt;å†…å­˜&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬çš„ç¨‹åºéƒ½æ˜¯åœ¨å†…å­˜ä¸­è¿è¡Œçš„ï¼Œ&lt;strong&gt;å†…å­˜ä¼šä¿å­˜ç¨‹åºè¿è¡Œæ—¶çš„æ•°æ®&lt;/strong&gt;ï¼Œä¾›CPUå¤„ç†ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%86%85%E5%AD%98.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center&#34;&gt;å†…å­˜&lt;/p&gt;
&lt;h3 id=&#34;ç¼“å­˜&#34;&gt;ç¼“å­˜&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;CPUçš„è¿ç®—é€Ÿåº¦å’Œå†…å­˜çš„è®¿é—®é€Ÿåº¦ç›¸å·®æ¯”è¾ƒå¤§&lt;/strong&gt;ã€‚è¿™å°±å¯¼è‡´CPUæ¯æ¬¡æ“ä½œå†…å­˜éƒ½è¦è€—è´¹å¾ˆå¤šç­‰å¾…æ—¶é—´ã€‚å†…å­˜çš„è¯»å†™é€Ÿåº¦æˆä¸ºäº†è®¡ç®—æœºè¿è¡Œçš„ç“¶é¢ˆã€‚äºæ˜¯å°±æœ‰äº†åœ¨CPUå’Œä¸»å†…å­˜ä¹‹é—´å¢åŠ ç¼“å­˜çš„è®¾è®¡ã€‚æœ€é è¿‘CPU çš„ç¼“å­˜ç§°ä¸ºL1ï¼Œç„¶åä¾æ¬¡æ˜¯ L2ï¼ŒL3å’Œä¸»å†…å­˜ï¼ŒCPUç¼“å­˜æ¨¡å‹å¦‚å›¾ä¸‹å›¾æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/CPU%E7%BC%93%E5%AD%98%E6%A8%A1%E5%9E%8B.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center&#34;&gt;CPU ç¼“å­˜æ¨¡å‹&lt;/p&gt;
&lt;p&gt;CPU Cacheåˆ†æˆäº†ä¸‰ä¸ªçº§åˆ«: L1ï¼Œ L2ï¼Œ L3ã€‚çº§åˆ«è¶Šå°è¶Šæ¥è¿‘CPUï¼Œé€Ÿåº¦ä¹Ÿæ›´å¿«ï¼ŒåŒæ—¶ä¹Ÿä»£è¡¨ç€å®¹é‡è¶Šå°ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;L1æ˜¯æœ€æ¥è¿‘CPUçš„ï¼Œå®ƒå®¹é‡æœ€å°ï¼Œä¾‹å¦‚32Kï¼Œé€Ÿåº¦æœ€å¿«ï¼Œæ¯ä¸ªæ ¸ä¸Šéƒ½æœ‰ä¸€ä¸ªL1 Cacheã€‚&lt;/li&gt;
&lt;li&gt;L2 Cache æ›´å¤§ä¸€äº›ï¼Œä¾‹å¦‚256Kï¼Œé€Ÿåº¦è¦æ…¢ä¸€äº›ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æ¯ä¸ªæ ¸ä¸Šéƒ½æœ‰ä¸€ä¸ªç‹¬ç«‹çš„L2 Cacheã€‚&lt;/li&gt;
&lt;li&gt;L3 Cacheæ˜¯ä¸‰çº§ç¼“å­˜ä¸­æœ€å¤§çš„ä¸€çº§ï¼Œä¾‹å¦‚12MBï¼ŒåŒæ—¶ä¹Ÿæ˜¯ç¼“å­˜ä¸­æœ€æ…¢çš„ä¸€çº§ï¼Œåœ¨åŒä¸€ä¸ªCPUæ’æ§½ä¹‹é—´çš„æ ¸å…±äº«ä¸€ä¸ªL3 Cacheã€‚&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/CPU%E5%8F%82%E6%95%B0.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;Latencyï¼šå»¶è¿Ÿ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Cacheçš„å‡ºç°æ˜¯ä¸ºäº†è§£å†³&lt;strong&gt;CPUç›´æ¥è®¿é—®å†…å­˜æ•ˆç‡ä½ä¸‹&lt;/strong&gt;é—®é¢˜çš„ï¼Œç¨‹åºåœ¨è¿è¡Œçš„è¿‡ç¨‹ä¸­ï¼ŒCPUæ¥æ”¶åˆ°æŒ‡ä»¤åï¼Œå®ƒä¼šæœ€å…ˆå‘CPUä¸­çš„ä¸€çº§ç¼“å­˜ï¼ˆL1 Cacheï¼‰å»å¯»æ‰¾ç›¸å…³çš„æ•°æ®ï¼Œå¦‚æœå‘½ä¸­ç¼“å­˜ï¼ŒCPUè¿›è¡Œè®¡ç®—æ—¶å°±å¯ä»¥ç›´æ¥å¯¹CPU Cacheä¸­çš„æ•°æ®è¿›è¡Œè¯»å–å’Œå†™å…¥ï¼Œå½“è¿ç®—ç»“æŸä¹‹åï¼Œå†å°†CPU Cacheä¸­çš„æœ€æ–°æ•°æ®åˆ·æ–°åˆ°ä¸»å†…å­˜å½“ä¸­ï¼ŒCPUé€šè¿‡ç›´æ¥è®¿é—®Cacheçš„æ–¹å¼æ›¿ä»£ç›´æ¥è®¿é—®ä¸»å­˜çš„æ–¹å¼æå¤§åœ°æé«˜äº†CPU çš„ååèƒ½åŠ›ã€‚ä½†æ˜¯ç”±äºä¸€çº§ç¼“å­˜ï¼ˆL1 Cacheï¼‰å®¹é‡è¾ƒå°ï¼Œæ‰€ä»¥ä¸å¯èƒ½æ¯æ¬¡éƒ½å‘½ä¸­ã€‚è¿™æ—¶CPUä¼šç»§ç»­å‘ä¸‹ä¸€çº§çš„äºŒçº§ç¼“å­˜ï¼ˆL2 Cacheï¼‰å¯»æ‰¾ï¼ŒåŒæ ·çš„é“ç†ï¼Œå½“æ‰€éœ€è¦çš„æ•°æ®åœ¨äºŒçº§ç¼“å­˜ä¸­ä¹Ÿæ²¡æœ‰çš„è¯ï¼Œä¼šç»§ç»­è½¬å‘L3 Cacheã€å†…å­˜(ä¸»å­˜)å’Œç¡¬ç›˜ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å°ç»“-4&#34;&gt;å°ç»“&lt;/h3&gt;
&lt;p&gt;è®¡ç®—æœºçš„ä¸»è¦ç»„æˆï¼šCPUï¼Œå†…å­˜ï¼Œè¾“å…¥è®¾å¤‡ï¼Œè¾“å‡ºè®¾å¤‡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;javaå†…å­˜æ¨¡å‹&#34;&gt;Javaå†…å­˜æ¨¡å‹&lt;/h2&gt;
&lt;p&gt;Java Memory Molde (Javaå†…å­˜æ¨¡å‹/JMM)ï¼Œåƒä¸‡ä¸è¦å’ŒJavaå†…å­˜ç»“æ„æ··æ·†&lt;/p&gt;
&lt;p&gt;å…³äºâ€œJavaå†…å­˜æ¨¡å‹â€çš„æƒå¨è§£é‡Šï¼Œè¯·å‚è€ƒ &lt;a href=&#34;https://download.oracle.com/otn-pub/jcp/memory_model-1.0-pfd-spec-oth-JSpec/memory_model-1_0-pfd-spec.pdf?AuthParam=1581232382_a0e88fb559ae2cdd224df3335e1eb9d3&#34;&gt;https://download.oracle.com/otn-pub/jcp/memory_model-1.0-pfd-spec-oth-JSpec/memory_model-1_0-pfd-spec.pdf&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;Java å†…å­˜æ¨¡å‹ï¼Œæ˜¯ Java è™šæ‹Ÿæœºè§„èŒƒä¸­æ‰€å®šä¹‰çš„ä¸€ç§å†…å­˜æ¨¡å‹ï¼ŒJava å†…å­˜æ¨¡å‹æ˜¯æ ‡å‡†åŒ–çš„ï¼Œå±è”½æ‰äº†åº•å±‚ä¸åŒè®¡ç®—æœºçš„åŒºåˆ«ã€‚&lt;/p&gt;
&lt;p&gt;Javaå†…å­˜æ¨¡å‹æ˜¯ä¸€å¥—è§„èŒƒï¼Œæè¿°äº†Javaç¨‹åºä¸­å„ç§å˜é‡(çº¿ç¨‹å…±äº«å˜é‡)çš„è®¿é—®è§„åˆ™ï¼Œä»¥åŠåœ¨JVMä¸­å°†å˜é‡å­˜å‚¨åˆ°å†…å­˜å’Œä»å†…å­˜ä¸­è¯»å–å˜é‡è¿™æ ·çš„åº•å±‚ç»†èŠ‚ï¼Œå…·ä½“å¦‚ä¸‹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸»å†…å­˜&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸»å†…å­˜æ˜¯&lt;strong&gt;æ‰€æœ‰çº¿ç¨‹éƒ½å…±äº«&lt;/strong&gt;çš„ï¼Œéƒ½èƒ½è®¿é—®çš„ã€‚æ‰€æœ‰çš„&lt;strong&gt;å…±äº«å˜é‡&lt;/strong&gt;éƒ½å­˜å‚¨äºä¸»å†…å­˜ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å·¥ä½œå†…å­˜&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;æ¯ä¸€ä¸ªçº¿ç¨‹æœ‰è‡ªå·±çš„å·¥ä½œå†…å­˜&lt;/strong&gt;ï¼Œå·¥ä½œå†…å­˜åªå­˜å‚¨è¯¥çº¿ç¨‹å¯¹&lt;strong&gt;å…±äº«å˜é‡çš„å‰¯æœ¬&lt;/strong&gt;ã€‚çº¿ç¨‹å¯¹å˜é‡çš„æ‰€æœ‰çš„æ“ä½œ(è¯»ï¼Œå–)éƒ½å¿…é¡»åœ¨å·¥ä½œå†…å­˜ä¸­å®Œæˆï¼Œè€Œä¸èƒ½ç›´æ¥è¯»å†™ä¸»å†…å­˜ä¸­çš„å˜é‡ï¼Œä¸åŒçº¿ç¨‹ä¹‹é—´ä¹Ÿä¸èƒ½ç›´æ¥è®¿é—®å¯¹æ–¹å·¥ä½œå†…å­˜ä¸­çš„å˜é‡ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center&#34;&gt; Java å†…å­˜æ¨¡å‹&lt;/p&gt;
&lt;h3 id=&#34;java-å†…å­˜æ¨¡å‹çš„ä½œç”¨&#34;&gt;Java å†…å­˜æ¨¡å‹çš„ä½œç”¨&lt;/h3&gt;
&lt;p&gt;Javaå†…å­˜æ¨¡å‹æ˜¯ä¸€å¥—åœ¨å¤šçº¿ç¨‹è¯»å†™å…±äº«æ•°æ®æ—¶ï¼Œå¯¹å…±äº«æ•°æ®çš„å¯è§æ€§ã€æœ‰åºæ€§ã€å’ŒåŸå­æ€§çš„è§„åˆ™å’Œä¿éšœã€‚&lt;/p&gt;
&lt;p&gt;synchronized,volatile&lt;/p&gt;
&lt;h3 id=&#34;cpuç¼“å­˜å†…å­˜ä¸-java-å†…å­˜æ¨¡å‹çš„å…³ç³»&#34;&gt;CPUç¼“å­˜ï¼Œå†…å­˜ä¸ Java å†…å­˜æ¨¡å‹çš„å…³ç³»&lt;/h3&gt;
&lt;p&gt;é€šè¿‡å¯¹å‰é¢çš„CPUç¡¬ä»¶å†…å­˜æ¶æ„ã€Javaå†…å­˜æ¨¡å‹ä»¥åŠJavaå¤šçº¿ç¨‹çš„å®ç°åŸç†çš„äº†è§£ï¼Œæˆ‘ä»¬åº”è¯¥å·²ç»æ„è¯†åˆ°ï¼Œ&lt;strong&gt;å¤šçº¿ç¨‹çš„æ‰§è¡Œæœ€ç»ˆéƒ½ä¼šæ˜ å°„åˆ°ç¡¬ä»¶å¤„ç†å™¨ä¸Šè¿›è¡Œæ‰§è¡Œ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä½† Java å†…å­˜æ¨¡å‹å’Œç¡¬ä»¶å†…å­˜æ¶æ„å¹¶ä¸å®Œå…¨ä¸€è‡´ã€‚å¯¹äºç¡¬ä»¶å†…å­˜æ¥è¯´åªæœ‰å¯„å­˜å™¨ã€ç¼“å­˜å†…å­˜ã€ä¸»å†…å­˜çš„æ¦‚å¿µï¼Œå¹¶æ²¡æœ‰å·¥ä½œå†…å­˜å’Œä¸»å†…å­˜ä¹‹åˆ†ï¼Œä¹Ÿå°±æ˜¯è¯´ Java å†…å­˜æ¨¡å‹å¯¹å†…å­˜çš„åˆ’åˆ†å¯¹ç¡¬ä»¶å†…å­˜å¹¶æ²¡æœ‰ä»»ä½•å½±å“ï¼Œ å› ä¸º JMM åªæ˜¯ä¸€ç§æŠ½è±¡çš„æ¦‚å¿µï¼Œæ˜¯ä¸€ç»„è§„åˆ™ï¼Œä¸ç®¡æ˜¯å·¥ä½œå†…å­˜çš„æ•°æ®è¿˜æ˜¯ä¸»å†…å­˜çš„æ•°æ®ï¼Œå¯¹äºè®¡ç®—æœºç¡¬ä»¶æ¥è¯´éƒ½ä¼šå­˜å‚¨åœ¨è®¡ç®—æœºä¸»å†…å­˜ä¸­ï¼Œå½“ç„¶ä¹Ÿæœ‰å¯èƒ½å­˜å‚¨åˆ°CPUç¼“å­˜æˆ–è€…å¯„å­˜å™¨ä¸­ï¼Œå› æ­¤æ€»ä½“ä¸Šæ¥è¯´ï¼ŒJavaå†…å­˜æ¨¡å‹å’Œè®¡ç®—æœºç¡¬ä»¶å†…å­˜æ¶æ„æ˜¯ä¸€ä¸ªç›¸äº’äº¤å‰çš„å…³ç³»ï¼Œæ˜¯ä¸€ç§&lt;strong&gt;æŠ½è±¡æ¦‚å¿µåˆ’åˆ†ä¸çœŸå®ç‰©ç†ç¡¬ä»¶çš„äº¤å‰&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;JMMå†…å­˜æ¨¡å‹ä¸CPUç¡¬ä»¶å†…å­˜æ¶æ„çš„å…³ç³»ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/JMM%E4%B8%8ECPU%E7%A1%AC%E4%BB%B6%E5%86%85%E5%AD%98%E6%9E%B6%E6%9E%84%E7%9A%84%E5%85%B3%E7%B3%BB.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;å°ç»“&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Java å†…å­˜æ¨¡å‹æ˜¯ä¸€å¥—&lt;strong&gt;è§„èŒƒ&lt;/strong&gt;ï¼Œæè¿°äº† &lt;strong&gt;Java ç¨‹åºä¸­å„ç§å˜é‡(çº¿ç¨‹å…±äº«å˜é‡)çš„è®¿é—®è§„åˆ™&lt;/strong&gt;ï¼Œä»¥åŠåœ¨ JVM ä¸­å°†å˜é‡å­˜å‚¨åˆ°å†…å­˜å’Œä»å†…å­˜ä¸­è¯»å–å˜é‡è¿™æ ·çš„åº•å±‚ç»†èŠ‚ï¼ŒJava å†…å­˜æ¨¡å‹æ˜¯å¯¹å…±äº«æ•°æ®çš„å¯è§æ€§ã€æœ‰åºæ€§ã€å’ŒåŸå­æ€§çš„è§„åˆ™å’Œä¿éšœã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜ä¹‹é—´çš„æ•°æ®äº¤äº’è¿‡ç¨‹&#34;&gt;ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜ä¹‹é—´çš„æ•°æ®äº¤äº’è¿‡ç¨‹&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E4%B8%BB%E5%AD%98%E4%B8%8E%E5%B7%A5%E4%BD%9C%E5%86%85%E5%AD%98%E7%9A%84%E4%BA%A4%E4%BA%92.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;Javaå†…å­˜æ¨¡å‹ä¸­å®šä¹‰äº†ä»¥ä¸‹8ç§æ“ä½œæ¥å®Œæˆï¼Œä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜ä¹‹é—´å…·ä½“çš„äº¤äº’åè®®ï¼Œå³ä¸€ä¸ªå˜é‡å¦‚ä½•ä»ä¸»å†…å­˜æ‹·è´åˆ°å·¥ä½œå†…å­˜ã€å¦‚ä½•ä»å·¥ä½œå†…å­˜åŒæ­¥å›ä¸»å†…å­˜ä¹‹ç±»çš„å®ç°ç»†èŠ‚ï¼Œè™šæ‹Ÿæœºå®ç°æ—¶å¿…é¡»ä¿è¯ä¸‹é¢æåŠçš„æ¯ä¸€ç§æ“ä½œéƒ½æ˜¯åŸå­çš„ã€ä¸å¯å†åˆ†çš„ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹åº”å¦‚ä¸‹çš„æµç¨‹å›¾ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E4%B8%BB%E5%AD%98%E4%B8%8E%E5%B7%A5%E4%BD%9C%E5%86%85%E5%AD%98%E5%85%B7%E4%BD%93%E7%9A%84%E4%BA%A4%E4%BA%92%E5%8D%8F%E8%AE%AE.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;readï¼šä»ä¸»å†…å­˜è¯»å–å…±äº«å˜é‡ï¼ˆ&lt;code&gt;boolean x= true&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;loadï¼šå°†å…±äº«å˜é‡ï¼ˆ&lt;code&gt;boolean x = tru&lt;/code&gt;eï¼‰æ”¾å…¥å·¥ä½œå†…å­˜çš„å˜é‡å‰¯æœ¬ä¸­&lt;/li&gt;
&lt;li&gt;useï¼šæŠŠå·¥ä½œå†…å­˜ä¸­ä¸€ä¸ªå˜é‡çš„&lt;strong&gt;å€¼&lt;/strong&gt;ï¼ˆtrueï¼‰ä¼ é€’ç»™æ‰§è¡Œå¼•æ“&lt;/li&gt;
&lt;li&gt;assignï¼šæŠŠä¸€ä¸ªä»æ‰§è¡Œå¼•æ“æ¥æ”¶åˆ°çš„å€¼èµ‹ç»™å·¥ä½œå†…å­˜çš„å˜é‡&lt;/li&gt;
&lt;li&gt;storeï¼šæŠŠå·¥ä½œå†…å­˜çš„ä¸€ä¸ªå…±äº«å˜é‡ä¼ é€åˆ°ä¸»å†…å­˜ä¸­&lt;/li&gt;
&lt;li&gt;writeï¼šåœ¨ store ä¹‹åæ‰§è¡Œï¼ŒæŠŠ store å¾—åˆ°çš„å€¼æ”¾å…¥ä¸»å†…å­˜çš„å˜é‡ä¸­&lt;/li&gt;
&lt;li&gt;lockï¼šä½œç”¨äºä¸»å†…å­˜çš„å˜é‡&lt;/li&gt;
&lt;li&gt;unlock&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ³¨æ„:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;å¦‚æœå¯¹ä¸€ä¸ªå˜é‡æ‰§è¡Œlockæ“ä½œï¼Œå°†ä¼š&lt;strong&gt;æ¸…ç©ºå·¥ä½œå†…å­˜ä¸­æ­¤å˜é‡çš„å€¼&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¯¹ä¸€ä¸ªå˜é‡æ‰§è¡Œunlockæ“ä½œä¹‹å‰ï¼Œå¿…é¡»å…ˆ&lt;strong&gt;æŠŠæ­¤å˜é‡åŒæ­¥åˆ°ä¸»å†…å­˜ä¸­&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;å°ç»“-5&#34;&gt;å°ç»“&lt;/h3&gt;
&lt;p&gt;ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜ä¹‹é—´çš„æ•°æ®äº¤äº’è¿‡ç¨‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;lock -&amp;gt; read -&amp;gt; load -&amp;gt; use -&amp;gt; assign -&amp;gt; store -&amp;gt; write -&amp;gt; unlock
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;ç¬¬ä¸‰ç« synchronizedä¿è¯ä¸‰å¤§ç‰¹æ€§&#34;&gt;ç¬¬ä¸‰ç« ï¼šsynchronizedä¿è¯ä¸‰å¤§ç‰¹æ€§&lt;/h1&gt;
&lt;p&gt;synchronizedèƒ½å¤Ÿä¿è¯åœ¨åŒä¸€æ—¶åˆ»æœ€å¤šåªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œè¯¥æ®µä»£ç ï¼Œä»¥è¾¾åˆ°ä¿è¯å¹¶å‘å®‰å…¨çš„æ•ˆæœã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;synchronized (é”å¯¹è±¡) { 
    // å—ä¿æŠ¤èµ„æº; 
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;synchronizedä¸åŸå­æ€§&#34;&gt;synchronizedä¸åŸå­æ€§&lt;/h2&gt;
&lt;h3 id=&#34;ä½¿ç”¨synchronizedä¿è¯åŸå­æ€§&#34;&gt;ä½¿ç”¨synchronizedä¿è¯åŸå­æ€§&lt;/h3&gt;
&lt;p&gt;æ¡ˆä¾‹æ¼”ç¤º:5ä¸ªçº¿ç¨‹å„æ‰§è¡Œ1000æ¬¡ i++;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;import java.util.ArrayList;
/**
 æ¡ˆä¾‹æ¼”ç¤º:5ä¸ªçº¿ç¨‹å„æ‰§è¡Œ1000æ¬¡ i++; 
 */
public class Test01Atomicity {
    private static int number = 0;
    public static void main(String[] args) throws InterruptedException {
        Runnable increment = new Runnable() {
            @Override
            public void run() {
                for (int i = 0; i &amp;lt; 1000; i++) {
                    synchronized (Test01Atomicity.class) {
                        number++;
                    }
                }
            }
        };
        ArrayList&amp;lt;Thread&amp;gt; ts = new ArrayList&amp;lt;&amp;gt;();
        for (int i = 0; i &amp;lt; 50; i++) {
            Thread t = new Thread(increment);
            t.start();
            ts.add(t);
        }
        for (Thread t : ts) {
            t.join();
        }
        System.out.println(&amp;quot;number = &amp;quot; + number);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;number = 50000
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸»è¦ä»£ç ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;for (int i = 0; i &amp;lt; 1000; i++) {
    synchronized (Test01Atomicity.class) {
        number++;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;synchronizedä¿è¯åŸå­æ€§çš„åŸç†&#34;&gt;synchronizedä¿è¯åŸå­æ€§çš„åŸç†&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/synchronized%E4%BF%9D%E8%AF%81%E5%8E%9F%E5%AD%90%E6%80%A7%E5%8E%9F%E7%90%86.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;å¯¹&lt;code&gt;number++&lt;/code&gt;;å¢åŠ åŒæ­¥ä»£ç å—åï¼Œä¿è¯åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ“ä½œ&lt;code&gt;number++&lt;/code&gt;;ã€‚å°±ä¸ä¼šå‡ºç°å®‰å…¨é—®é¢˜ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å°ç»“-6&#34;&gt;å°ç»“&lt;/h3&gt;
&lt;p&gt;synchronizedä¿è¯åŸå­æ€§çš„åŸç†ï¼šsynchronizedä¿è¯åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‹¿åˆ°é”ï¼Œèƒ½å¤Ÿè¿›å…¥åŒæ­¥ä»£ç å—ã€‚&lt;/p&gt;
&lt;h2 id=&#34;synchronizedä¸å¯è§æ€§&#34;&gt;synchronizedä¸å¯è§æ€§&lt;/h2&gt;
&lt;h3 id=&#34;ä½¿ç”¨synchronizedä¿è¯å¯è§æ€§&#34;&gt;ä½¿ç”¨synchronizedä¿è¯å¯è§æ€§&lt;/h3&gt;
&lt;p&gt;æ¡ˆä¾‹æ¼”ç¤ºï¼šä¸€ä¸ªçº¿ç¨‹æ ¹æ®booleanç±»å‹çš„æ ‡è®°flagï¼Œ whileå¾ªç¯ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹æ”¹å˜è¿™ä¸ªflagå˜é‡çš„å€¼ï¼Œä½¿ç”¨ synchronized åŠ é”è¿™ä¸ªçº¿ç¨‹ä¼šåœæ­¢å¾ªç¯ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/*
    ç›®æ ‡:æ¼”ç¤ºå¯è§æ€§é—®é¢˜
        1.åˆ›å»ºä¸€ä¸ªå…±äº«å˜é‡
        2.åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ä¸æ–­è¯»å–å…±äº«å˜é‡
        3.åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹å…±äº«å˜é‡
 */
public class Test01Visibility {
    // 1.åˆ›å»ºä¸€ä¸ªä½¿ç”¨ volatile ä¿®é¥°çš„å…±äº«å˜é‡
    private static boolean flag = true;
    private static Object obj = new Object();
    public static void main(String[] args) throws InterruptedException {
        // 2.åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ä¸æ–­è¯»å–å…±äº«å˜é‡
        new Thread(() -&amp;gt; {
            while (flag) {
                synchronized (obj){

                }
            }
        }).start();

        Thread.sleep(2000);

        // 3.åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹å…±äº«å˜é‡
        new Thread(() -&amp;gt; {
            flag = false;
            System.out.println(&amp;quot;çº¿ç¨‹ä¿®æ”¹äº†å˜é‡çš„å€¼ä¸ºfalse&amp;quot;);
        }).start();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;çº¿ç¨‹ä¿®æ”¹äº†å˜é‡çš„å€¼ä¸ºfalse
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åˆ†æï¼š&lt;br&gt;
synchronized ï¼šå½“çº¿ç¨‹ 2 å°† flag çš„å€¼æ”¹ä¸º false åï¼Œçº¿ç¨‹ 1 å†æ¬¡æ‰§è¡Œ while æ“ä½œæ—¶ï¼šè¯»å–ä¸»å†…å­˜å˜é‡åˆ°å·¥ä½œç©ºé—´å‰ï¼Œæ‰§è¡Œ Lock æ“ä½œï¼Œä½¿å·¥ä½œå†…å­˜å†…çš„å…±äº«å˜é‡å¤±æ•ˆï¼Œå†æ¬¡å»ä¸»å†…å­˜è¯»å–åˆ·æ–°å…±äº«å˜é‡çš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;synchronizedä¿è¯å¯è§æ€§çš„åŸç†&lt;/strong&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E4%B8%BB%E5%AD%98%E4%B8%8E%E5%B7%A5%E4%BD%9C%E5%86%85%E5%AD%98%E5%85%B7%E4%BD%93%E7%9A%84%E4%BA%A4%E4%BA%92%E5%8D%8F%E8%AE%AE.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœ while æ–¹æ³•å†…å¢åŠ è¾“å‡ºè¯­å¥ &lt;code&gt;System.out.println(&amp;quot;run = &amp;quot; + run);&lt;/code&gt;ï¼Œå³ä½¿ä¸æ˜¾å¼ä½¿ç”¨ &lt;code&gt;synchronized&lt;/code&gt; åŠ é”ä¹Ÿèƒ½ç»ˆæ­¢æ­»å¾ªç¯ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/**
 æ¡ˆä¾‹æ¼”ç¤º:
 ä¸€ä¸ªçº¿ç¨‹æ ¹æ®booleanç±»å‹çš„æ ‡è®°flagï¼Œ whileå¾ªç¯ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹æ”¹å˜è¿™ä¸ªflagå˜é‡çš„å€¼ï¼Œ
 å¦ä¸€ä¸ªçº¿ç¨‹å¹¶ä¸ä¼šåœæ­¢å¾ªç¯.
 */
public class Test01Visibility {
    // å¤šä¸ªçº¿ç¨‹éƒ½ä¼šè®¿é—®çš„æ•°æ®ï¼Œæˆ‘ä»¬ç§°ä¸ºçº¿ç¨‹çš„å…±äº«æ•°æ®
    private static boolean run = true;
    public static void main(String[] args) throws InterruptedException {
        Thread t1 = new Thread(() -&amp;gt; {
            while (run) {
                // å¢åŠ å¯¹è±¡å…±äº«æ•°æ®çš„æ‰“å°ï¼Œprintlnæ˜¯åŒæ­¥æ–¹æ³•
                System.out.println(&amp;quot;run = &amp;quot; + run);
            }
        });
        t1.start();
        Thread.sleep(1000);
        Thread t2 = new Thread(() -&amp;gt; {
            run = false;
            System.out.println(&amp;quot;æ—¶é—´åˆ°ï¼Œçº¿ç¨‹2è®¾ç½®ä¸ºfalse&amp;quot;);
        });
        t2.start();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;run = true
run = true
run = true
Â·Â·Â·Â·Â·Â·
run = true
run = true
run = true
æ—¶é—´åˆ°ï¼Œçº¿ç¨‹2è®¾ç½®ä¸ºfalse
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åˆ†æï¼š&lt;br&gt;
ä½¿ç”¨ sout è¾“å‡ºï¼Œç¨‹åºä¼šåœæ­¢ï¼Œè€Œä¸æ˜¯ä¸€ç›´é˜»å¡ï¼Œå› ä¸º sout å†…éƒ¨ä½¿ç”¨äº† synchronized&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;9&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/sout.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;ä½¿ç”¨-volatile-ä¿è¯å¯è§æ€§&#34;&gt;ä½¿ç”¨ volatile ä¿è¯å¯è§æ€§&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;package com.itheima.demo02_concurrent_problem;

/*
    ç›®æ ‡:æ¼”ç¤ºå¯è§æ€§é—®é¢˜
        1.åˆ›å»ºä¸€ä¸ªå…±äº«å˜é‡
        2.åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ä¸æ–­è¯»å–å…±äº«å˜é‡
        3.åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹å…±äº«å˜é‡
 */
public class Test01Visibility {
    // 1.åˆ›å»ºä¸€ä¸ªä½¿ç”¨ volatile ä¿®é¥°çš„å…±äº«å˜é‡
    private static volatile boolean flag = true;
    private static Object obj = new Object();
    public static void main(String[] args) throws InterruptedException {
        // 2.åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ä¸æ–­è¯»å–å…±äº«å˜é‡
        new Thread(() -&amp;gt; {
            while (flag) {

            }
        }).start();

        Thread.sleep(2000);

        // 3.åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹å…±äº«å˜é‡
        new Thread(() -&amp;gt; {
            flag = false;
            System.out.println(&amp;quot;çº¿ç¨‹ä¿®æ”¹äº†å˜é‡çš„å€¼ä¸ºfalse&amp;quot;);
        }).start();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;çº¿ç¨‹ä¿®æ”¹äº†å˜é‡çš„å€¼ä¸ºfalse
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;å°ç»“-7&#34;&gt;å°ç»“&lt;/h3&gt;
&lt;p&gt;synchronizedä¿è¯å¯è§æ€§çš„åŸç†ï¼Œæ‰§è¡Œsynchronizedæ—¶ï¼Œä¼šå¯¹åº”lockåŸå­æ“ä½œä¼šåˆ·æ–°å·¥ä½œå†…å­˜ä¸­å…±äº«å˜é‡çš„å€¼&lt;/p&gt;
&lt;h2 id=&#34;synchronizedä¸æœ‰åºæ€§&#34;&gt;synchronizedä¸æœ‰åºæ€§&lt;/h2&gt;
&lt;h3 id=&#34;ä¸ºä»€ä¹ˆè¦é‡æ’åº&#34;&gt;ä¸ºä»€ä¹ˆè¦é‡æ’åº&lt;/h3&gt;
&lt;p&gt;ä¸ºäº†&lt;strong&gt;æé«˜ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡&lt;/strong&gt;ï¼Œç¼–è¯‘å™¨å’ŒCPUä¼šå¯¹ç¨‹åºä¸­ä»£ç è¿›è¡Œé‡æ’åºã€‚&lt;/p&gt;
&lt;h3 id=&#34;as-if-serialè¯­ä¹‰&#34;&gt;as-if-serialè¯­ä¹‰&lt;/h3&gt;
&lt;p&gt;as-if-serialè¯­ä¹‰çš„æ„æ€æ˜¯ï¼šä¸ç®¡ç¼–è¯‘å™¨å’ŒCPUå¦‚ä½•é‡æ’åºï¼Œå¿…é¡»ä¿è¯åœ¨&lt;strong&gt;å•çº¿ç¨‹æƒ…å†µä¸‹ç¨‹åºçš„ç»“æœæ˜¯æ­£ç¡®&lt;/strong&gt;çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æ•°æ®æœ‰ä¾èµ–å…³ç³»ï¼Œä¸èƒ½é‡æ’åºã€‚&lt;/p&gt;
&lt;p&gt;å†™åè¯»ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;int a = 1;
int b = a;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å†™åå†™ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;int a = 1;
int a = 2;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¯»åå†™ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;int a = 1;
int b = a;
int a = 2;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç¼–è¯‘å™¨å’Œå¤„ç†å™¨ä¸ä¼šå¯¹å­˜åœ¨æ•°æ®ä¾èµ–å…³ç³»çš„æ“ä½œåšé‡æ’åºï¼Œå› ä¸ºè¿™ç§é‡æ’åºä¼šæ”¹å˜æ‰§è¡Œç»“æœã€‚ä½†æ˜¯ï¼Œå¦‚æœæ“ä½œä¹‹é—´ä¸å­˜åœ¨æ•°æ®ä¾èµ–å…³ç³»ï¼Œè¿™äº›æ“ä½œå°±å¯èƒ½è¢«ç¼–è¯‘å™¨å’Œå¤„ç†å™¨é‡æ’åºã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;int a = 1;
int b = 2;
int c = a + b;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šé¢3ä¸ªæ“ä½œçš„æ•°æ®ä¾èµ–å…³ç³»å¦‚å›¾æ‰€ç¤ºï¼š&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E4%B8%89%E4%B8%AA%E6%93%8D%E4%BD%9C%E6%95%B0%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¦‚ä¸Šå›¾æ‰€ç¤º a å’Œ c ä¹‹é—´å­˜åœ¨æ•°æ®ä¾èµ–å…³ç³»ï¼ŒåŒæ—¶ b å’Œ c ä¹‹é—´ä¹Ÿå­˜åœ¨æ•°æ®ä¾èµ–å…³ç³»ã€‚å› æ­¤åœ¨æœ€ç»ˆæ‰§è¡Œçš„æŒ‡ä»¤åºåˆ—ä¸­ï¼Œc ä¸èƒ½è¢«é‡æ’åºåˆ° a å’Œ b çš„å‰é¢ã€‚ä½† a å’Œ b ä¹‹é—´æ²¡æœ‰æ•°æ®ä¾èµ–å…³ç³»ï¼Œç¼–è¯‘å™¨å’Œå¤„ç†å™¨å¯ä»¥é‡æ’åº a å’Œ b ä¹‹é—´çš„æ‰§è¡Œé¡ºåºã€‚ä¸‹å›¾æ˜¯è¯¥ç¨‹åºçš„ä¸¤ç§æ‰§è¡Œé¡ºåºã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;10&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E4%B8%89%E4%B8%AA%E6%93%8D%E4%BD%9C%E6%95%B0%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;å¯ä»¥è¿™æ ·ï¼š
int a = 1;
int b = 2;
int c = a + b;

ä¹Ÿå¯ä»¥é‡æ’åºè¿™æ ·ï¼š
int b = 2;
int a = 1;
int c = a + b;Â 
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;ä½¿ç”¨-synchronized-ä¿è¯æœ‰åºæ€§&#34;&gt;ä½¿ç”¨ synchronized ä¿è¯æœ‰åºæ€§&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;package com.itheima.demo02_concurrent_problem;

import org.openjdk.jcstress.annotations.*;
import org.openjdk.jcstress.infra.results.I_Result;
@JCStressTest
@Outcome(id = {&amp;quot;1&amp;quot;}, expect = Expect.ACCEPTABLE, desc = &amp;quot;ok&amp;quot;)
@Outcome(id = {&amp;quot;4&amp;quot;}, expect = Expect.ACCEPTABLE_INTERESTING, desc = &amp;quot;danger2&amp;quot;)
@Outcome(id = &amp;quot;0&amp;quot;, expect = Expect.ACCEPTABLE_INTERESTING, desc = &amp;quot;danger&amp;quot;)
@State
public class Test03Ordering {
    private Object obj = new Object();
    volatile int num = 0;
    volatile boolean ready = false;
    // çº¿ç¨‹1æ‰§è¡Œçš„ä»£ç 
    @Actor
    public void actor1(I_Result r) {
        synchronized (obj){
            if (ready) {
                r.r1 = num + num;
            } else {
                r.r1 = 1;
            }
        }
    }
    // çº¿ç¨‹2æ‰§è¡Œçš„ä»£ç 
    @Actor
    public void actor2(I_Result r) {
        synchronized (obj){
            num = 2;
            ready = true;
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœåªæœ‰ 1 å’Œ 4ï¼Œæ²¡æœ‰ 0ã€‚&lt;/p&gt;
&lt;h3 id=&#34;synchronizedä¿è¯æœ‰åºæ€§çš„åŸç†&#34;&gt;synchronizedä¿è¯æœ‰åºæ€§çš„åŸç†&lt;/h3&gt;
&lt;p&gt;synchronizedåï¼Œè™½ç„¶è¿›è¡Œäº†é‡æ’åºï¼Œä¿è¯&lt;strong&gt;åªæœ‰ä¸€ä¸ªçº¿ç¨‹ä¼šè¿›å…¥åŒæ­¥ä»£ç å—&lt;/strong&gt;ï¼Œä¹Ÿèƒ½ä¿è¯æœ‰åºæ€§ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å°ç»“-8&#34;&gt;å°ç»“&lt;/h3&gt;
&lt;p&gt;synchronized ä¿è¯æœ‰åºæ€§çš„åŸç†ï¼Œæˆ‘ä»¬åŠ  synchronized åï¼Œä¾ç„¶ä¼šå‘ç”Ÿé‡æ’åºï¼Œåªä¸è¿‡ï¼Œæˆ‘ä»¬æœ‰åŒæ­¥ä»£ç å—ï¼Œå¯ä»¥ä¿è¯åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡ŒåŒæ­¥ä»£ç ä¸­çš„ä»£ç ï¼Œä¿è¯æœ‰åºæ€§ã€‚&lt;/p&gt;
&lt;h1 id=&#34;ç¬¬å››ç« synchronizedçš„ç‰¹æ€§&#34;&gt;ç¬¬å››ç« ï¼šsynchronizedçš„ç‰¹æ€§&lt;/h1&gt;
&lt;h2 id=&#34;å¯é‡å…¥ç‰¹æ€§&#34;&gt;å¯é‡å…¥ç‰¹æ€§&lt;/h2&gt;
&lt;p&gt;ä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¤šæ¬¡æ‰§è¡Œ synchronized, é‡å¤è·å–åŒä¸€æŠŠé”ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;package com.itheima.demo03_synchronized_nature;

/**
 * ç›®æ ‡:æ¼”ç¤º synchronized å¯é‡å…¥
 *     1.è‡ªå®šä¹‰ä¸€ä¸ªçº¿ç¨‹ç±»
 *     2.åœ¨çº¿ç¨‹ç±»çš„runæ–¹æ³•ä¸­ä½¿ç”¨åµŒå¥—çš„åŒæ­¥ä»£ç å—
 *     3.ä½¿ç”¨ä¸¤ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œ
 */
public class Demo01 {
    public static void main(String[] args) {
        new MyThread().start();
        new MyThread().start();
    }
    public static void test01() {
        synchronized (MyThread.class) {
            String name = Thread.currentThread().getName();
            System.out.println(name + &amp;quot;è¿›å…¥äº†åŒæ­¥ä»£ç å—2&amp;quot;);
        }
    }
}
// 1.è‡ªå®šä¹‰ä¸€ä¸ªçº¿ç¨‹ç±»
class MyThread extends Thread {
    @Override
    public void run() {
        synchronized (MyThread.class) {
            System.out.println(getName() + &amp;quot;è¿›å…¥äº†åŒæ­¥ä»£ç å—1&amp;quot;);

            Demo01.test01();
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Thread-0è¿›å…¥äº†åŒæ­¥ä»£ç å—1
Thread-0è¿›å…¥äº†åŒæ­¥ä»£ç å—2
Thread-1è¿›å…¥äº†åŒæ­¥ä»£ç å—1
Thread-1è¿›å…¥äº†åŒæ­¥ä»£ç å—2
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;å¯é‡å…¥åŸç†&#34;&gt;å¯é‡å…¥åŸç†&lt;/h3&gt;
&lt;p&gt;synchronized çš„é”å¯¹è±¡ä¸­æœ‰ä¸€ä¸ªè®¡æ•°å™¨ï¼ˆrecursionså˜é‡ï¼‰ä¼š&lt;strong&gt;è®°å½•çº¿ç¨‹è·å¾—å‡ æ¬¡é”&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¯é‡å…¥çš„å¥½å¤„&#34;&gt;å¯é‡å…¥çš„å¥½å¤„&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;å¯ä»¥é¿å…æ­»é”&lt;/li&gt;
&lt;li&gt;å¯ä»¥è®©æˆ‘ä»¬æ›´å¥½çš„æ¥å°è£…ä»£ç &lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;å°ç»“-9&#34;&gt;å°ç»“&lt;/h3&gt;
&lt;p&gt;synchronized æ˜¯å¯é‡å…¥é”ï¼Œå†…éƒ¨é”å¯¹è±¡ä¸­ä¼šæœ‰ä¸€ä¸ªè®¡æ•°å™¨è®°å½•çº¿ç¨‹è·å–å‡ æ¬¡é”äº†ï¼Œåœ¨æ‰§è¡Œå®ŒåŒæ­¥ä»£ç å—æ—¶ï¼Œè®¡æ•°å™¨çš„æ•°é‡ä¼š-1ï¼Œç›´åˆ°è®¡æ•°å™¨çš„æ•°é‡ä¸º0ï¼Œå°±é‡Šæ”¾è¿™ä¸ªé”ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸å¯ä¸­æ–­ç‰¹æ€§&#34;&gt;ä¸å¯ä¸­æ–­ç‰¹æ€§&lt;/h2&gt;
&lt;p&gt;ä¸€ä¸ªçº¿ç¨‹è·å¾—é”åï¼Œå¦ä¸€ä¸ªçº¿ç¨‹æƒ³è¦è·å¾—é”ï¼Œå¿…é¡»å¤„äºé˜»å¡æˆ–ç­‰å¾…çŠ¶æ€ï¼Œå¦‚æœç¬¬ä¸€ä¸ªçº¿ç¨‹ä¸é‡Šæ”¾é”ï¼Œç¬¬äºŒä¸ªçº¿ç¨‹ä¼šä¸€ç›´&lt;strong&gt;é˜»å¡æˆ–ç­‰å¾…ï¼Œä¸å¯è¢«ä¸­æ–­&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;synchronizedä¸å¯ä¸­æ–­æ¼”ç¤º&#34;&gt;synchronizedä¸å¯ä¸­æ–­æ¼”ç¤º&lt;/h3&gt;
&lt;p&gt;synchronized æ˜¯ä¸å¯ä¸­æ–­ï¼Œå¤„äºé˜»å¡çŠ¶æ€çš„çº¿ç¨‹ä¼šä¸€ç›´ç­‰å¾…é”ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/*
    ç›®æ ‡:æ¼”ç¤ºsynchronizedä¸å¯ä¸­æ–­
    1.å®šä¹‰ä¸€ä¸ªRunnable
    2.åœ¨Runnableå®šä¹‰åŒæ­¥ä»£ç å—
    3.å…ˆå¼€å¯ä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡ŒåŒæ­¥ä»£ç å—,ä¿è¯ä¸é€€å‡ºåŒæ­¥ä»£ç å—
    4.åå¼€å¯ä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡ŒåŒæ­¥ä»£ç å—(é˜»å¡çŠ¶æ€)
    5.åœæ­¢ç¬¬äºŒä¸ªçº¿ç¨‹
*/
public class Demo02_Uninterruptible {
    private static Object obj = new Object();
    public static void main(String[] args) throws InterruptedException {
        // 1.å®šä¹‰ä¸€ä¸ªRunnable
        Runnable run = () -&amp;gt; {
            // 2.åœ¨Runnableå®šä¹‰åŒæ­¥ä»£ç å—
            synchronized (obj) {
                String name = Thread.currentThread().getName();
                System.out.println(name + &amp;quot;è¿›å…¥åŒæ­¥ä»£ç å—&amp;quot;);
                // ä¿è¯ä¸é€€å‡ºåŒæ­¥ä»£ç å—
                try {
                    Thread.sleep(888888);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }
        };
        // 3.å…ˆå¼€å¯ä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡ŒåŒæ­¥ä»£ç å—
        Thread t1 = new Thread(run);
        t1.start();
        Thread.sleep(1000);
        // 4.åå¼€å¯ä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡ŒåŒæ­¥ä»£ç å—(é˜»å¡çŠ¶æ€)
        Thread t2 = new Thread(run);
        t2.start();
        // 5.åœæ­¢ç¬¬äºŒä¸ªçº¿ç¨‹
        System.out.println(&amp;quot;åœæ­¢çº¿ç¨‹å‰&amp;quot;);
        t2.interrupt();
        System.out.println(&amp;quot;åœæ­¢çº¿ç¨‹å&amp;quot;);
        System.out.println(t1.getState());
        System.out.println(t2.getState());
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Thread-0è¿›å…¥åŒæ­¥ä»£ç å—
åœæ­¢çº¿ç¨‹å‰
åœæ­¢çº¿ç¨‹å
TIMED_WAITING
BLOCKED//å¤„äºé˜»å¡çŠ¶æ€ï¼Œä¸å¯è¢«ä¸­æ–­
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;reentrantlockä¸å¯ä¸­æ–­æ¼”ç¤º&#34;&gt;ReentrantLockä¸å¯ä¸­æ–­æ¼”ç¤º&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;package com.itheima.demo03_synchronized_nature;

import java.util.concurrent.TimeUnit;
import java.util.concurrent.locks.Lock;
import java.util.concurrent.locks.ReentrantLock;

/**
 * ç›®æ ‡:æ¼”ç¤ºLockä¸å¯ä¸­æ–­
 */
public class Demo03_Interruptible {
    private static Lock lock = new ReentrantLock();
    public static void main(String[] args) throws InterruptedException {
         test01();
    }

    // æ¼”ç¤ºLockä¸å¯ä¸­æ–­
    public static void test01() throws InterruptedException {
        Runnable run = () -&amp;gt; {
            String name = Thread.currentThread().getName();
            try {
                lock.lock();
                System.out.println(name + &amp;quot;è·å¾—é”,è¿›å…¥é”æ‰§è¡Œ&amp;quot;);
                Thread.sleep(88888);
            } catch (InterruptedException e) {
                e.printStackTrace();
            } finally {
                lock.unlock();
                System.out.println(name + &amp;quot;é‡Šæ”¾é”&amp;quot;);
            }
        };
        Thread t1 = new Thread(run);
        t1.start();
        Thread.sleep(1000);
        Thread t2 = new Thread(run);
        t2.start();

        System.out.println(&amp;quot;åœæ­¢t2çº¿ç¨‹å‰&amp;quot;);
        t2.interrupt();
        System.out.println(&amp;quot;åœæ­¢t2çº¿ç¨‹å&amp;quot;);
        Thread.sleep(1000);
        System.out.println(t1.getState());
        System.out.println(t2.getState());
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Thread-0è·å¾—é”,è¿›å…¥é”æ‰§è¡Œ
åœæ­¢t2çº¿ç¨‹å‰
åœæ­¢t2çº¿ç¨‹å
TIMED_WAITING
WAITING //t2 interruptä¸­æ–­å¤±è´¥ï¼Œä¸€ç›´å¤„äºç­‰å¾…çŠ¶æ€
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;reentrantlockå¯ä¸­æ–­æ¼”ç¤º&#34;&gt;ReentrantLockå¯ä¸­æ–­æ¼”ç¤º&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;package com.itheima.demo03_synchronized_nature;

import java.util.concurrent.TimeUnit;
import java.util.concurrent.locks.Lock;
import java.util.concurrent.locks.ReentrantLock;

/**
 * ç›®æ ‡:æ¼”ç¤ºLockå¯ä¸­æ–­
 */
public class Demo03_Interruptible {
    private static Lock lock = new ReentrantLock();
    public static void main(String[] args) throws InterruptedException { 
        test02();
    }

    // æ¼”ç¤ºLockå¯ä¸­æ–­
    public static void test02() throws InterruptedException {
        Runnable run = () -&amp;gt; {
            String name = Thread.currentThread().getName();
            boolean b = false;
            try {
                b = lock.tryLock(3, TimeUnit.SECONDS);
                if (b) {
                    System.out.println(name + &amp;quot;è·å¾—é”,è¿›å…¥é”æ‰§è¡Œ&amp;quot;);
                    Thread.sleep(88888);
                } else {
                    System.out.println(name + &amp;quot;åœ¨æŒ‡å®šæ—¶é—´æ²¡æœ‰å¾—åˆ°é”åšå…¶ä»–æ“ä½œ&amp;quot;);
                }
            } catch (InterruptedException e) {
                e.printStackTrace();
            } finally {
                if (b) {
                    lock.unlock();
                    System.out.println(name + &amp;quot;é‡Šæ”¾é”&amp;quot;);
                }
            }
        };

        Thread t1 = new Thread(run);
        t1.start();
        Thread.sleep(1000);
        Thread t2 = new Thread(run);
        t2.start();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Thread-0è·å¾—é”,è¿›å…¥é”æ‰§è¡Œ
Thread-1åœ¨æŒ‡å®šæ—¶é—´æ²¡æœ‰å¾—åˆ°é”åšå…¶ä»–æ“ä½œ
(é˜»å¡å¾ˆä¹…)
Thread-0é‡Šæ”¾é”
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;å°ç»“-10&#34;&gt;å°ç»“&lt;/h3&gt;
&lt;p&gt;ä¸å¯ä¸­æ–­æ˜¯æŒ‡ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è·å¾—é”åï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¸€ç›´å¤„äºé˜»å¡æˆ–ç­‰å¾…çŠ¶æ€ï¼Œå‰ä¸€ä¸ªçº¿ç¨‹ä¸é‡Šæ”¾é”ï¼Œåä¸€ä¸ªçº¿ç¨‹ä¼šä¸€ç›´é˜»å¡æˆ–ç­‰å¾…ï¼Œä¸å¯è¢«ä¸­æ–­ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;synchronized&lt;/code&gt; å±äºä¸å¯è¢«ä¸­æ–­&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Lock&lt;/code&gt; çš„ &lt;code&gt;lock&lt;/code&gt; æ–¹æ³•æ˜¯ä¸å¯ä¸­æ–­çš„&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Lock&lt;/code&gt; çš„ &lt;code&gt;tryLock&lt;/code&gt; æ–¹æ³•æ˜¯å¯ä¸­æ–­çš„&lt;/p&gt;
&lt;h1 id=&#34;ç¬¬äº”ç« synchronized-åŸç†&#34;&gt;ç¬¬äº”ç« ï¼šsynchronized åŸç†&lt;/h1&gt;
&lt;h2 id=&#34;javap-åæ±‡ç¼–&#34;&gt;javap åæ±‡ç¼–&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªç®€å•çš„synchronizedä»£ç ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public class Demo01 {
    private static Object obj = new Object();
    public static void main(String[] args) {
        synchronized (obj) {
            System.out.println(&amp;quot;1&amp;quot;);
        }
    }
    public synchronized void test() {
        System.out.println(&amp;quot;a&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ‘ä»¬è¦çœ‹ synchronized çš„åŸç†ï¼Œä½†æ˜¯ synchronized æ˜¯ä¸€ä¸ªå…³é”®å­—ï¼Œçœ‹ä¸åˆ°æºç ã€‚æˆ‘ä»¬å¯ä»¥å°†classæ–‡ä»¶è¿›è¡Œåæ±‡ç¼–ã€‚&lt;/p&gt;
&lt;p&gt;JDKè‡ªå¸¦çš„ä¸€ä¸ªå·¥å…·ï¼š javap ï¼Œå¯¹å­—èŠ‚ç è¿›è¡Œåæ±‡ç¼–ï¼ŒæŸ¥çœ‹å­—èŠ‚ç æŒ‡ä»¤ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ DOS å‘½ä»¤è¡Œè¾“å…¥ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;javap -p -v C:\Users\Only\æ‚„æ‚„çš„åŠªåŠ›\AQS\synchronizedèµ„æ–™\æ¡ˆä¾‹\Synchronized\target\classes\com\itheima\demo04_synchronized_monitor\Demo01
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åæ±‡ç¼–åçš„æ•ˆæœå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Â  public static void main(java.lang.String[]);
Â  Â  descriptor: ([Ljava/lang/String;)V
Â  Â  flags: (0x0009) ACC_PUBLIC, ACC_STATIC
Â  Â  Code:
Â  Â  Â  stack=2, locals=3, args_size=1
Â  Â  Â  Â  Â 0: getstaticÂ  Â  Â #2Â  Â  Â  Â  Â  Â  Â  Â  Â  // Field obj:Ljava/lang/Object;
Â  Â  Â  Â  Â 3: dup
Â  Â  Â  Â  Â 4: astore_1
Â  Â  Â  Â  Â 5: monitorenter
Â  Â  Â  Â  Â 6: getstaticÂ  Â  Â #3Â  Â  Â  Â  Â  Â  Â  Â  Â  // Field java/lang/System.out:Ljava/io/PrintStream;
Â  Â  Â  Â  Â 9: ldcÂ  Â  Â  Â  Â  Â #4Â  Â  Â  Â  Â  Â  Â  Â  Â  // String 1
Â  Â  Â  Â  11: invokevirtual #5Â  Â  Â  Â  Â  Â  Â  Â  Â  // Method java/io/PrintStream.println:(Ljava/lang/String;)V
Â  Â  Â  Â  14: aload_1
Â  Â  Â  Â  15: monitorexit
Â  Â  Â  Â  16: gotoÂ  Â  Â  Â  Â  24
Â  Â  Â  Â  19: astore_2
Â  Â  Â  Â  20: aload_1
Â  Â  Â  Â  21: monitorexit
Â  Â  Â  Â  22: aload_2
Â  Â  Â  Â  23: athrow
Â  Â  Â  Â  24: return
Â  Â  Â  Exception table:
Â  Â  Â  Â  Â fromÂ  Â  toÂ  target type
Â  Â  Â  Â  Â  Â  Â 6Â  Â  16Â  Â  19Â  Â any
Â  Â  Â  Â  Â  Â  19Â  Â  22Â  Â  19Â  Â any
Â  Â  Â  LineNumberTable:
Â  Â  Â  Â  line 7: 0
Â  Â  Â  Â  line 8: 6
Â  Â  Â  Â  line 9: 14
Â  Â  Â  Â  line 10: 24
Â  Â  Â  LocalVariableTable:
Â  Â  Â  Â  StartÂ  LengthÂ  SlotÂ  NameÂ  Â Signature
Â  Â  Â  Â  Â  Â  0Â  Â  Â  25Â  Â  Â 0Â  argsÂ  Â [Ljava/lang/String;
Â  Â  Â  StackMapTable: number_of_entries = 2
Â  Â  Â  Â  frame_type = 255 /* full_frame */
Â  Â  Â  Â  Â  offset_delta = 19
Â  Â  Â  Â  Â  locals = [ class &amp;quot;[Ljava/lang/String;&amp;quot;, class java/lang/Object ]
Â  Â  Â  Â  Â  stack = [ class java/lang/Throwable ]
Â  Â  Â  Â  frame_type = 250 /* chop */
Â  Â  Â  Â  Â  offset_delta = 4

Â  public synchronized void test();
Â  Â  descriptor: ()V
Â  Â  flags: (0x0021) ACC_PUBLIC, ACC_SYNCHRONIZED
Â  Â  Code:
Â  Â  Â  stack=2, locals=1, args_size=1
Â  Â  Â  Â  Â 0: getstaticÂ  Â  Â #3Â  Â  Â  Â  Â  Â  Â  Â  Â  // Field java/lang/System.out:Ljava/io/PrintStream;
Â  Â  Â  Â  Â 3: ldcÂ  Â  Â  Â  Â  Â #6Â  Â  Â  Â  Â  Â  Â  Â  Â  // String a
Â  Â  Â  Â  Â 5: invokevirtual #5Â  Â  Â  Â  Â  Â  Â  Â  Â  // Method java/io/PrintStream.println:(Ljava/lang/String;)V
Â  Â  Â  Â  Â 8: return
Â  Â  Â  LineNumberTable:
Â  Â  Â  Â  line 13: 0
Â  Â  Â  Â  line 14: 8
Â  Â  Â  LocalVariableTable:
Â  Â  Â  Â  StartÂ  LengthÂ  SlotÂ  NameÂ  Â Signature
Â  Â  Â  Â  Â  Â  0Â  Â  Â  Â 9Â  Â  Â 0Â  thisÂ  Â Lcom/itheima/demo04_synchronized_monitor/Demo01;
Â  static {};
Â  Â  descriptor: ()V
Â  Â  flags: (0x0008) ACC_STATIC
Â  Â  Code:
Â  Â  Â  stack=2, locals=0, args_size=0
Â  Â  Â  Â  Â 0: newÂ  Â  Â  Â  Â  Â #7Â  Â  Â  Â  Â  Â  Â  Â  Â  // class java/lang/Object
Â  Â  Â  Â  Â 3: dup
Â  Â  Â  Â  Â 4: invokespecial #1Â  Â  Â  Â  Â  Â  Â  Â  Â  // Method java/lang/Object.&amp;quot;&amp;lt;init&amp;gt;&amp;quot;:()V
Â  Â  Â  Â  Â 7: putstaticÂ  Â  Â #2Â  Â  Â  Â  Â  Â  Â  Â  Â  // Field obj:Ljava/lang/Object;
Â  Â  Â  Â  10: return
Â  Â  Â  LineNumberTable:
Â  Â  Â  Â  line 4: 0
}

SourceFile: &amp;quot;Demo01.java&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;11&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%90%8C%E6%AD%A5%E4%BB%A3%E7%A0%81%E5%9D%97.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;åŒæ­¥ä»£ç å—&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;12&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/synchronized.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;monitorenter&#34;&gt;monitorenter&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;é¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹JVMè§„èŒƒä¸­å¯¹äºmonitorenterçš„æè¿°ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-6.html#jvms-6.5.monitorenter&#34;&gt;https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-6.html#jvms-6.5.monitorenter&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Each object is associated with a monitor. A monitor is locked if and only if it has an owner.&lt;br&gt;
The thread that executes monitorenter attempts to gain ownership of the monitor associated with objectrefï¼Œ as follows:&lt;br&gt;
If the entry count of the monitor associated with objectref is zeroï¼Œ the thread enters the monitor and sets its entry count to one. The thread is then the owner of the monitor.&lt;br&gt;
If the thread already owns the monitor associated with objectrefï¼Œ it reenters the monitorï¼Œ incrementing its entry count.&lt;br&gt;
If another thread  already owns the monitor associated with objectrefï¼Œ the thread blocks until the monitor&#39;s entry count is zeroï¼Œ then tries again to gain ownership.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç¿»è¯‘è¿‡æ¥ï¼š æ¯ä¸€ä¸ªå¯¹è±¡éƒ½ä¼šå’Œä¸€ä¸ªç›‘è§†å™¨ monitor å…³è”ã€‚ç›‘è§†å™¨è¢«å ç”¨æ—¶ä¼šè¢«é”ä½ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•æ¥è· å–è¯¥ monitorã€‚ å½“ JVM æ‰§è¡ŒæŸä¸ªçº¿ç¨‹çš„æŸä¸ªæ–¹æ³•å†…éƒ¨çš„ monitorenter æ—¶ï¼Œå®ƒä¼šå°è¯•å»è·å–å½“å‰å¯¹è±¡å¯¹åº”çš„ monitor çš„æ‰€æœ‰æƒã€‚å…¶è¿‡ç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è‹¥ monior çš„è¿›å…¥æ•°ä¸º 0ï¼Œçº¿ç¨‹å¯ä»¥è¿›å…¥ monitorï¼Œå¹¶å°† monitor çš„è¿›å…¥æ•°ç½®ä¸º 1ã€‚å½“å‰çº¿ç¨‹æˆä¸º monitor çš„ownerï¼ˆæ‰€æœ‰è€…ï¼‰&lt;/li&gt;
&lt;li&gt;è‹¥å½“å‰çº¿ç¨‹å·²æ‹¥æœ‰ monitor çš„æ‰€æœ‰æƒï¼Œå…è®¸å®ƒé‡å…¥ monitorï¼Œåˆ™è¿›å…¥ monitor çš„è¿›å…¥æ•°åŠ  1&lt;/li&gt;
&lt;li&gt;è‹¥å…¶ä»–çº¿ç¨‹å·²ç»å æœ‰ monitor çš„æ‰€æœ‰æƒï¼Œé‚£ä¹ˆå½“å‰å°è¯•è·å– monitor çš„æ‰€æœ‰æƒçš„çº¿ç¨‹ä¼šè¢«é˜»å¡ï¼Œç›´åˆ° monitor çš„è¿›å…¥æ•°å˜ä¸º 0ï¼Œæ‰èƒ½é‡æ–°å°è¯•è·å– monitor çš„æ‰€æœ‰æƒã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;monitorenterå°ç»“ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;synchronized çš„é”å¯¹è±¡ä¼šå…³è”ä¸€ä¸ª monitor, è¿™ä¸ª monitor ä¸æ˜¯æˆ‘ä»¬ä¸»åŠ¨åˆ›å»ºçš„ï¼Œæ˜¯ JVM çš„çº¿ç¨‹æ‰§è¡Œåˆ°è¿™ä¸ªåŒæ­¥ä»£ç å—,å‘ç°é”å¯¹è±¡æ²¡æœ‰ monitor å°±ä¼šåˆ›å»º monitor, monitor å†…éƒ¨æœ‰ä¸¤ä¸ªé‡è¦çš„æˆå‘˜å˜é‡ &lt;strong&gt;owner:æ‹¥æœ‰è¿™æŠŠé”çš„çº¿ç¨‹&lt;/strong&gt;, &lt;strong&gt;recursionsä¼šè®°å½•çº¿ç¨‹æ‹¥æœ‰é”çš„æ¬¡æ•°&lt;/strong&gt;ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹æ‹¥æœ‰ monito råå…¶ä»–çº¿ç¨‹åªèƒ½ç­‰å¾…ã€‚&lt;/p&gt;
&lt;h3 id=&#34;monitorexit&#34;&gt;monitorexit&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;é¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹JVMè§„èŒƒä¸­å¯¹äºmonitorexitçš„æè¿°ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-6.html#jvms-6.5.monitorexit&#34;&gt;https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-6.html#jvms-6.5.monitorexit&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The thread that executes monitorexit must be the owner of the monitor associated with the instance referenced by objectref.&lt;br&gt;
The thread decrements the entry count of the monitor associated with objectref. If as a result the value of the entry count is zeroï¼Œ the thread exits the monitor and is no longer its owner. Other threads that are blocking to enter the monitor are allowed to attempt to do so.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç¿»è¯‘è¿‡æ¥ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;èƒ½æ‰§è¡Œ monitorexit æŒ‡ä»¤çš„çº¿ç¨‹ä¸€å®šæ˜¯æ‹¥æœ‰å½“å‰å¯¹è±¡çš„ monitor çš„æ‰€æœ‰æƒçš„çº¿ç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;æ‰§è¡Œ monitorexit æ—¶ä¼šå°† monitor çš„è¿›å…¥æ•°å‡ 1ã€‚å½“ monitor çš„è¿›å…¥æ•°å‡ä¸º 0 æ—¶ï¼Œå½“å‰çº¿ç¨‹é€€å‡º monitorï¼Œä¸å†æ‹¥æœ‰ monitor çš„æ‰€æœ‰æƒï¼Œæ­¤æ—¶å…¶ä»–è¢«è¿™ä¸ª monitor é˜»å¡çš„çº¿ç¨‹å¯ä»¥å°è¯•å»è·å–è¿™ä¸ª monitor çš„æ‰€æœ‰æƒ ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;monitorexit-é‡Šæ”¾é”&#34;&gt;monitorexit é‡Šæ”¾é”ã€‚&lt;/h4&gt;
&lt;p&gt;monitorexit æ’å…¥åœ¨&lt;strong&gt;æ–¹æ³•ç»“æŸå¤„&lt;/strong&gt;å’Œ&lt;strong&gt;å¼‚å¸¸å¤„&lt;/strong&gt;ï¼ŒJVMä¿è¯æ¯ä¸ª monitorenter å¿…é¡»æœ‰å¯¹åº”çš„monitorexitã€‚&lt;/p&gt;
&lt;h4 id=&#34;é¢è¯•é¢˜-synchroznied-å‡ºç°å¼‚å¸¸ä¼šé‡Šæ”¾é”å—&#34;&gt;é¢è¯•é¢˜ synchroznied å‡ºç°å¼‚å¸¸ä¼šé‡Šæ”¾é”å—?&lt;/h4&gt;
&lt;p&gt;ä¼šé‡Šæ”¾é”&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;13&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/synchronized%E5%87%BA%E7%8E%B0%E5%BC%82%E5%B8%B8%E4%BC%9A%E9%87%8A%E6%94%BE%E9%94%81.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;synchronizedå‡ºç°å¼‚å¸¸ä¼šé‡Šæ”¾é”&lt;/p&gt;
&lt;h3 id=&#34;åŒæ­¥æ–¹æ³•&#34;&gt;åŒæ­¥æ–¹æ³•&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-2.html#jvms-2.11.10&#34;&gt;https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-2.html#jvms-2.11.10&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°åŒæ­¥æ–¹æ³•åœ¨åæ±‡ç¼–åï¼Œä¼šå¢åŠ  &lt;code&gt;ACC_SYNCHRONIZED&lt;/code&gt; ä¿®é¥°ã€‚ä¼šéšå¼è°ƒç”¨ monitorenter å’Œ monitorexitã€‚åœ¨æ‰§è¡ŒåŒæ­¥æ–¹æ³•å‰ä¼šè°ƒç”¨ monitorenterï¼Œåœ¨æ‰§è¡Œå®ŒåŒæ­¥æ–¹æ³•åä¼šè°ƒç”¨ monitorexitã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;14&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%90%8C%E6%AD%A5%E6%96%B9%E6%B3%95.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center&#34;&gt;åŒæ­¥æ–¹æ³•&lt;/p&gt;
&lt;h3 id=&#34;å°ç»“-11&#34;&gt;å°ç»“&lt;/h3&gt;
&lt;p&gt;é€šè¿‡ javap åæ±‡ç¼–æˆ‘ä»¬çœ‹åˆ° synchronized ä½¿ç”¨å˜æˆäº† monitorenter å’Œ monitorexit ä¸¤ä¸ªæŒ‡ä»¤.æ¯ä¸ªé”å¯¹è±¡éƒ½ä¼šå…³è”ä¸€ä¸ª monitor(ç›‘è§†å™¨,å®ƒæ‰æ˜¯çœŸæ­£çš„é”å¯¹è±¡),å®ƒå†…éƒ¨æœ‰ä¸¤ä¸ªé‡è¦çš„æˆå‘˜å˜é‡owner ä¼šä¿å­˜è·å¾—é”çš„çº¿ç¨‹ï¼Œrecursions ä¼šä¿å­˜çº¿ç¨‹è·å¾—é”çš„æ¬¡æ•°,å½“æ‰§è¡Œåˆ° monitorexit æ—¶,recursions ä¼š -1,å½“è®¡æ•°å™¨å‡åˆ° 0 æ—¶è¿™ä¸ªçº¿ç¨‹å°±ä¼šé‡Šæ”¾é”ã€‚&lt;/p&gt;
&lt;h3 id=&#34;é¢è¯•é¢˜synchronizedä¸lockçš„åŒºåˆ«&#34;&gt;é¢è¯•é¢˜ï¼šsynchronizedä¸Lockçš„åŒºåˆ«&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;synchronized æ˜¯å…³é”®å­—ï¼Œè€Œ Lock æ˜¯ä¸€ä¸ªæ¥å£ã€‚&lt;/li&gt;
&lt;li&gt;synchronized ä¼šè‡ªåŠ¨é‡Šæ”¾é”ï¼Œè€Œ Lock å¿…é¡»æ‰‹åŠ¨é‡Šæ”¾é”ã€‚&lt;/li&gt;
&lt;li&gt;synchronized æ˜¯ä¸å¯ä¸­æ–­çš„ï¼ŒLock å¯ä»¥ä¸­æ–­ä¹Ÿå¯ä»¥ä¸ä¸­æ–­ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡ Lock å¯ä»¥çŸ¥é“çº¿ç¨‹æœ‰æ²¡æœ‰æ‹¿åˆ°é”ï¼ˆtryLock()çš„è¿”å›å€¼ï¼‰ï¼Œè€Œ synchronized ä¸èƒ½ã€‚&lt;/li&gt;
&lt;li&gt;synchronized èƒ½é”ä½æ–¹æ³•å’Œä»£ç å—ï¼Œè€Œ Lock åªèƒ½é”ä½ä»£ç å—ã€‚&lt;/li&gt;
&lt;li&gt;Lock å¯ä»¥ä½¿ç”¨è¯»é”æé«˜å¤šçº¿ç¨‹è¯»æ•ˆç‡ï¼ˆReentrantReadWriteLockï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;synchronized æ˜¯éå…¬å¹³é”ï¼ŒReentrantLock å¯ä»¥æ§åˆ¶æ˜¯å¦æ˜¯å…¬å¹³é”ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;æ·±å…¥jvmæºç &#34;&gt;æ·±å…¥JVMæºç &lt;/h2&gt;
&lt;h3 id=&#34;jvmæºç ä¸‹è½½&#34;&gt;JVMæºç ä¸‹è½½&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;http://openjdk.java.net/&#34;&gt;http://openjdk.java.net/&lt;/a&gt; --&amp;gt; Mercurial --&amp;gt; jdk8 --&amp;gt; hotspot --&amp;gt; zip&lt;/p&gt;
&lt;h3 id=&#34;ideclion-ä¸‹è½½&#34;&gt;IDE(Clion )ä¸‹è½½&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.jetbrains.com/&#34;&gt;https://www.jetbrains.com/&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;monitorç›‘è§†å™¨é”&#34;&gt;monitorç›‘è§†å™¨é”&lt;/h3&gt;
&lt;p&gt;å¯ä»¥çœ‹å‡ºæ— è®ºæ˜¯ synchronized ä»£ç å—è¿˜æ˜¯ synchronized æ–¹æ³•ï¼Œå…¶çº¿ç¨‹å®‰å…¨çš„è¯­ä¹‰å®ç°æœ€ç»ˆä¾èµ–ä¸€ä¸ªå« monitor çš„ä¸œè¥¿ï¼Œé‚£ä¹ˆè¿™ä¸ªç¥ç§˜çš„ä¸œè¥¿æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä¸‹é¢è®©æˆ‘ä»¬æ¥è¯¦ç»†ä»‹ç»ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ HotSpot è™šæ‹Ÿæœºä¸­ï¼Œmonitor æ˜¯ç”± ObjectMonitor å®ç°çš„ã€‚å…¶æºç æ˜¯ç”¨ C++ æ¥å®ç°çš„ï¼Œä½äºHotSpot è™šæ‹Ÿæœºæºç  ObjectMonitor.hpp æ–‡ä»¶ä¸­(src/share/vm/runtime/objectMonitor.hpp)ã€‚ObjectMonitor ä¸»è¦æ•°æ®ç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ObjectMonitor() { 
  _header = NULL; 
  _count = 0; 
  _waiters = 0ï¼Œ 
  _recursions = 0; // çº¿ç¨‹çš„é‡å…¥æ¬¡æ•°
  _object = NULL; // å­˜å‚¨è¯¥monitorçš„å¯¹è±¡ 
  _owner = NULL; // æ ‡è¯†æ‹¥æœ‰è¯¥monitorçš„çº¿ç¨‹ 
  _WaitSet = NULL; // å¤„äºwaitçŠ¶æ€çš„çº¿ç¨‹ï¼Œä¼šè¢«åŠ å…¥åˆ°_WaitSet 
  _WaitSetLock = 0 ; 
  _Responsible = NULL; 
  _succ = NULL; 
  _cxq = NULL; // å¤šçº¿ç¨‹ç«äº‰é”æ—¶çš„å•å‘åˆ—è¡¨ 
  FreeNext = NULL; 
  _EntryList = NULL; // å¤„äºç­‰å¾…é”blockçŠ¶æ€çš„çº¿ç¨‹ï¼Œä¼šè¢«åŠ å…¥åˆ°è¯¥åˆ—è¡¨ 
  _SpinFreq = 0; 
  _SpinClock = 0; 
  OwnerIsThread = 0; 
}
&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;_ownerï¼šåˆå§‹æ—¶ä¸ºNULLã€‚å½“æœ‰&lt;strong&gt;çº¿ç¨‹å æœ‰è¯¥monitor&lt;/strong&gt;æ—¶ï¼Œowner æ ‡è®°ä¸ºè¯¥çº¿ç¨‹çš„å”¯ä¸€æ ‡è¯†ã€‚å½“çº¿ç¨‹é‡Šæ”¾ monitor æ—¶ï¼Œowneråˆæ¢å¤ä¸º NULLã€‚owner æ˜¯ä¸€ä¸ªä¸´ç•Œèµ„æºï¼ŒJVM æ˜¯é€šè¿‡ CAS æ“ä½œæ¥ä¿è¯å…¶çº¿ç¨‹å®‰å…¨çš„ã€‚&lt;/li&gt;
&lt;li&gt;_cxqï¼šç«äº‰é˜Ÿåˆ—ï¼Œ&lt;strong&gt;æ‰€æœ‰è¯·æ±‚é”çš„çº¿ç¨‹&lt;/strong&gt;é¦–å…ˆä¼šè¢«æ”¾åœ¨è¿™ä¸ªé˜Ÿåˆ—ä¸­ï¼ˆå•å‘é“¾æ¥ï¼‰ã€‚_cxq æ˜¯ä¸€ä¸ªä¸´ç•Œèµ„æºï¼ŒJVM é€šè¿‡ CAS åŸå­æŒ‡ä»¤æ¥ä¿®æ”¹ _cxq é˜Ÿåˆ—ã€‚ä¿®æ”¹å‰ _cxq çš„æ—§å€¼å¡«å…¥äº† node çš„ next å­—æ®µï¼Œ_cxq æŒ‡å‘æ–°å€¼ï¼ˆæ–°çº¿ç¨‹ï¼‰ã€‚å› æ­¤_cxq æ˜¯ä¸€ä¸ªåè¿›å…ˆå‡ºçš„ stackï¼ˆæ ˆï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;_EntryListï¼š_cxq é˜Ÿåˆ—ä¸­&lt;strong&gt;æœ‰èµ„æ ¼æˆä¸ºå€™é€‰èµ„æºçš„çº¿ç¨‹&lt;/strong&gt;ä¼šè¢«ç§»åŠ¨åˆ°è¯¥é˜Ÿåˆ—ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;_WaitSetï¼šå› ä¸º&lt;strong&gt;è°ƒç”¨waitæ–¹æ³•è€Œè¢«é˜»å¡&lt;/strong&gt;çš„çº¿ç¨‹ä¼šè¢«æ”¾åœ¨è¯¥é˜Ÿåˆ—ä¸­ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;15&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/monitor%E7%9B%91%E8%A7%86%E5%99%A8.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;æ¯ä¸€ä¸ª Java å¯¹è±¡éƒ½å¯ä»¥ä¸ä¸€ä¸ªç›‘è§†å™¨ monitor å…³è”ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒç†è§£æˆä¸ºä¸€æŠŠé”ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹æƒ³è¦æ‰§è¡Œä¸€æ®µè¢« synchronized åœˆèµ·æ¥çš„åŒæ­¥æ–¹æ³•æˆ–è€…ä»£ç å—æ—¶ï¼Œè¯¥çº¿ç¨‹å¾—å…ˆè·å–åˆ° synchronized ä¿®é¥°çš„å¯¹è±¡å¯¹åº”çš„ monitorã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çš„ Java ä»£ç é‡Œä¸ä¼šæ˜¾ç¤ºåœ°å»åˆ›é€ è¿™ä¹ˆä¸€ä¸ª monitor å¯¹è±¡ï¼Œæˆ‘ä»¬ä¹Ÿæ— éœ€åˆ›å»ºï¼Œäº‹å®ä¸Šå¯ä»¥è¿™ä¹ˆç†è§£ï¼š monitor å¹¶ä¸æ˜¯éšç€å¯¹è±¡åˆ›å»ºè€Œåˆ›å»ºçš„ã€‚æˆ‘ä»¬æ˜¯é€šè¿‡ synchronized ä¿®é¥°ç¬¦å‘Šè¯‰ JVM éœ€è¦ä¸ºæˆ‘ä»¬çš„æŸä¸ªå¯¹è±¡åˆ›å»ºå…³è”çš„ monitor å¯¹è±¡ã€‚æ¯ä¸ªçº¿ç¨‹éƒ½å­˜åœ¨ä¸¤ä¸ª ObjectMonitor å¯¹è±¡åˆ—è¡¨ï¼Œåˆ†åˆ«ä¸ºfree å’Œ used åˆ—è¡¨ã€‚ åŒæ—¶ JVM ä¸­ä¹Ÿç»´æŠ¤ç€ global locklistã€‚å½“çº¿ç¨‹éœ€è¦ ObjectMonitor å¯¹è±¡æ—¶ï¼Œé¦–å…ˆä»çº¿ç¨‹è‡ªèº«çš„ free è¡¨ä¸­ç”³è¯·ï¼Œè‹¥å­˜åœ¨åˆ™ä½¿ç”¨ï¼Œè‹¥ä¸å­˜åœ¨åˆ™ä» global list ä¸­ç”³è¯·ã€‚&lt;/p&gt;
&lt;p&gt;ObjectMonitor çš„æ•°æ®ç»“æ„ä¸­åŒ…å«ï¼š_ownerã€_WaitSet å’Œ _EntryListï¼Œå®ƒä»¬ä¹‹é—´çš„å…³ç³»è½¬æ¢å¯ä»¥ç”¨ä¸‹å›¾è¡¨ç¤ºï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;16&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/monitor%E7%9B%91%E8%A7%86%E5%99%A8%E9%94%812.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;monitorç«äº‰&#34;&gt;monitorç«äº‰&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ä»€ä¹ˆæ—¶å€™ä¼šäº§ç”Ÿ monitor ç«äº‰
&lt;ul&gt;
&lt;li&gt;ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œ synchronized æ—¶ï¼Œä¼šå‘ç”Ÿç«äº‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;å¦‚ä½•ç«äº‰&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ‰§è¡Œ monitorenter æ—¶ï¼Œä¼šè°ƒç”¨InterpreterRuntime.cpp&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;(ä½äºï¼šsrc/share/vm/interpreter/interpreterRuntime.cpp) çš„ InterpreterRuntime::monitorenter å‡½æ•°ã€‚å…·ä½“ä»£ç å¯å‚è§ HotSpot æºç ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;IRT_ENTRY_NO_ASYNC(void, InterpreterRuntime::monitorenter(JavaThread* thread, BasicObjectLock* elem))
#ifdef ASSERT
  thread-&amp;gt;last_frame().interpreter_frame_verify_monitor(elem);
#endif
  if (PrintBiasedLockingStatistics) {
    Atomic::inc(BiasedLocking::slow_path_entry_count_addr());
  }
  Handle h_obj(thread, elem-&amp;gt;obj());
  assert(Universe::heap()-&amp;gt;is_in_reserved_or_null(h_obj()),
         &amp;quot;must be NULL or an object&amp;quot;);
  if (UseBiasedLocking) {//æ˜¯å¦è®¾ç½®ä½¿ç”¨äº†åå‘é”
    // Retry fast entry if bias is revoked to avoid unnecessary inflation
    ObjectSynchronizer::fast_enter(h_obj, elem-&amp;gt;lock(), true, CHECK);
  } else {  // ä½¿ç”¨é‡é‡çº§é”
    ObjectSynchronizer::slow_enter(h_obj, elem-&amp;gt;lock(), CHECK);
  }
  assert(Universe::heap()-&amp;gt;is_in_reserved_or_null(elem-&amp;gt;obj()),
         &amp;quot;must be NULL or an object&amp;quot;);
&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;å¯¹äºé‡é‡çº§é”ï¼Œmonitorenter å‡½æ•°ä¸­ä¼šè°ƒç”¨ ObjectSynchronizer::slow_enter&lt;/li&gt;
&lt;li&gt;æœ€ç»ˆè°ƒç”¨ ObjectMonitor::enterï¼ˆä½äºï¼šsrc/share/vm/runtime/objectMonitor.cppï¼‰ï¼Œæºç å¦‚ä¸‹ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;void ATTR ObjectMonitor::enter(TRAPS) { 
  // The following code is ordered to check the most common cases first 
  // and to reduce RTS-&amp;gt;RTO cache line upgrades on SPARC and IA32 processors. 
  Thread * const Self = THREAD ; 
  void * cur ; 
  
  // é€šè¿‡CASæ“ä½œå°è¯•æŠŠmonitorçš„_ownerå­—æ®µè®¾ç½®ä¸ºå½“å‰çº¿ç¨‹ 
  cur = Atomic::cmpxchg_ptr (Selfï¼Œ &amp;amp;_ownerï¼Œ NULL) ; 
  if (cur == NULL) { 
    // Either ASSERT _recursions == 0 or explicitly set _recursions = 0. 
    assert (_recursions == 0 ï¼Œ &amp;quot;invariant&amp;quot;) ; 
    assert (_owner == Selfï¼Œ &amp;quot;invariant&amp;quot;) ; 
    // CONSIDER: set or assert OwnerIsThread == 1 
    return ; 
  }
  // çº¿ç¨‹é‡å…¥ï¼Œrecursions++ 
  if (cur == Self) { 
    // TODO-FIXME: check for integer overflow! BUGID 6557169. 
    _recursions ++ ; 
    return ; 
  }
  
  // å¦‚æœå½“å‰çº¿ç¨‹æ˜¯ç¬¬ä¸€æ¬¡è¿›å…¥è¯¥monitorï¼Œè®¾ç½®_recursionsä¸º1ï¼Œ_ownerä¸ºå½“å‰çº¿ç¨‹
  if (Self-&amp;gt;is_lock_owned ((address)cur)) {
    assert (_recursions == 0ï¼Œ &amp;quot;internal state error&amp;quot;);
    _recursions = 1 ;
    // Commute owner from a thread-specific on-stack BasicLockObject address to
    // a full-fledged &amp;quot;Thread *&amp;quot;.
    _owner = Self ;
    OwnerIsThread = 1 ;
    return ;
  }
  
  // çœç•¥ä¸€äº›ä»£ç 
  for (;;) {
    jt-&amp;gt;set_suspend_equivalent();
    // cleared by handle_special_suspend_equivalent_condition()
    // or java_suspend_self()
    
    // å¦‚æœè·å–é”å¤±è´¥ï¼Œåˆ™é˜»å¡ï¼Œç­‰å¾…é”çš„é‡Šæ”¾ï¼Œè¿›å…¥_cxqåˆ—è¡¨ï¼›
    EnterI (THREAD) ;
    
    if (!ExitSuspendEquivalent(jt)) break ;

  //
  // We have acquired the contended monitorï¼Œ but while we were
  // waiting another thread suspended us. We don&#39;t want to enter
  // the monitor while suspended because that would surprise the
  // thread that suspended us.
  //
      _recursions = 0 ;
    _succ = NULL ;
    exit (falseï¼Œ Self) ;
  
    jt-&amp;gt;java_suspend_self();
  }
  Self-&amp;gt;set_current_pending_monitor(NULL);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ­¤å¤„çœç•¥é”çš„è‡ªæ—‹ä¼˜åŒ–ç­‰æ“ä½œï¼Œç»Ÿä¸€æ”¾åœ¨åé¢synchronziedä¼˜åŒ–ä¸­è¯´ã€‚&lt;br&gt;
ä»¥ä¸Šä»£ç çš„å…·ä½“æµç¨‹æ¦‚æ‹¬å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é€šè¿‡CASå°è¯•æŠŠ monitor çš„ owner å­—æ®µè®¾ç½®ä¸ºå½“å‰çº¿ç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœè®¾ç½®ä¹‹å‰çš„ owner æŒ‡å‘å½“å‰çº¿ç¨‹ï¼Œè¯´æ˜å½“å‰çº¿ç¨‹å†æ¬¡è¿›å…¥monitorï¼Œå³é‡å…¥é”ï¼Œæ‰§è¡Œ _recursions++ ï¼Œè®°å½•é‡å…¥çš„æ¬¡æ•°ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœå½“å‰çº¿ç¨‹æ˜¯ç¬¬ä¸€æ¬¡è¿›å…¥è¯¥ monitorï¼Œè®¾ç½® _recursions ä¸º 1ï¼Œ_owner ä¸ºå½“å‰çº¿ç¨‹ï¼Œè¯¥çº¿ç¨‹æˆåŠŸè·å¾—é”å¹¶è¿”å›ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœè·å–é”å¤±è´¥ï¼Œåˆ™ç­‰å¾…é”çš„é‡Šæ”¾ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;monitorç­‰å¾…&#34;&gt;monitorç­‰å¾…&lt;/h3&gt;
&lt;p&gt;ç«äº‰å¤±è´¥ç­‰å¾…è°ƒç”¨çš„æ˜¯ ObjectMonitor å¯¹è±¡çš„ EnterI æ–¹æ³•ï¼ˆä½äºï¼šsrc/share/vm/runtime/objectMonitor.cppï¼‰ï¼Œæºç å¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;void ATTR ObjectMonitor::EnterI (TRAPS) { 
  Thread * Self = THREAD ;
  
  // Try the lock - TATAS 
  if (TryLock (Self) &amp;gt; 0) { 
    assert (_succ != Self , &amp;quot;invariant&amp;quot;) ; 
    assert (_owner == Self , &amp;quot;invariant&amp;quot;) ; 
    assert (_Responsible != Self , &amp;quot;invariant&amp;quot;) ; 
    return ; 
  }
  
  if (TrySpin (Self) &amp;gt; 0) { 
    assert (_owner == Self , &amp;quot;invariant&amp;quot;) ; 
    assert (_succ != Self , &amp;quot;invariant&amp;quot;) ; 
    assert (_Responsible != Self , &amp;quot;invariant&amp;quot;) ; 
    return ; 
  }
  
  // çœç•¥éƒ¨åˆ†ä»£ç  
  
  // å½“å‰çº¿ç¨‹è¢«å°è£…æˆObjectWaiterå¯¹è±¡nodeï¼ŒçŠ¶æ€è®¾ç½®æˆObjectWaiter::TS_CXQï¼› 
  ObjectWaiter node(Self) ; 
  Self-&amp;gt;_ParkEvent-&amp;gt;reset() ; 
  node._prev = (ObjectWaiter *) 0xBAD ; 
  node.TState = ObjectWaiter::TS_CXQ ; 
  
  // é€šè¿‡CASæŠŠnodeèŠ‚ç‚¹pushåˆ°_cxqåˆ—è¡¨ä¸­ 
  ObjectWaiter * nxt ; 
  for (;;) { 
    node._next = nxt = _cxq ; 
    if (Atomic::cmpxchg_ptr (&amp;amp;nodeï¼Œ &amp;amp;_cxqï¼Œ nxt) == nxt) break ; 
    
    // Interference - the CAS failed because _cxq changed. Just retry. 
    // As an optional optimization we retry the lock. 
    if (TryLock (Self) &amp;gt; 0) { 
      assert (_succ != Self ï¼Œ &amp;quot;invariant&amp;quot;) ; 
      assert (_owner == Self ï¼Œ &amp;quot;invariant&amp;quot;) ; 
      assert (_Responsible != Self ï¼Œ &amp;quot;invariant&amp;quot;) ; 
      return ; 
    } 
  }
  
  // çœç•¥éƒ¨åˆ†ä»£ç  
  for (;;) { 
    // çº¿ç¨‹åœ¨è¢«æŒ‚èµ·å‰åšä¸€ä¸‹æŒ£æ‰ï¼Œçœ‹èƒ½ä¸èƒ½è·å–åˆ°é” 
    if (TryLock (Self) &amp;gt; 0) break ; 
    assert (_owner != Selfï¼Œ &amp;quot;invariant&amp;quot;) ; 
    if ((SyncFlags &amp;amp; 2) &amp;amp;&amp;amp; _Responsible == NULL) { 
      Atomic::cmpxchg_ptr (Selfï¼Œ &amp;amp;_Responsibleï¼Œ NULL) ; 
    }
    
    // park self 
    if (_Responsible == Self || (SyncFlags &amp;amp; 1)) { 
      TEVENT (Inflated enter - park TIMED) ; 
      Self-&amp;gt;_ParkEvent-&amp;gt;park ((jlong) RecheckInterval) ; 
      // Increase the RecheckIntervalï¼Œ but clamp the value. 
      RecheckInterval *= 8 ; 
      if (RecheckInterval &amp;gt; 1000) RecheckInterval = 1000 ; 
    } else { 
      TEVENT (Inflated enter - park UNTIMED) 
      // é€šè¿‡parkå°†å½“å‰çº¿ç¨‹æŒ‚èµ·ï¼Œç­‰å¾…è¢«å”¤é†’ 
      Self-&amp;gt;_ParkEvent-&amp;gt;park() ; 
    }
    // è¢«å”¤é†’åå°è¯•è·å–é”
    if (TryLock(Self) &amp;gt; 0) break ; 
    // çœç•¥éƒ¨åˆ†ä»£ç  
  }
  
  // çœç•¥éƒ¨åˆ†ä»£ç  
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å½“è¯¥çº¿ç¨‹è¢«å”¤é†’æ—¶ï¼Œä¼šä»æŒ‚èµ·çš„ç‚¹ç»§ç»­æ‰§è¡Œï¼Œé€šè¿‡ ObjectMonitor::TryLock å°è¯•è·å–é”ï¼ŒTryLockæ–¹æ³•å®ç°å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;int ObjectMonitor::TryLock (Thread * Self) { 
  for (;;) { 
    void * own = _owner ; 
    if (own != NULL) return 0 ; 
    // CAS å°è¯•è·å–é”
    if (Atomic::cmpxchg_ptr (Selfï¼Œ &amp;amp;_ownerï¼Œ NULL) == NULL) { 
      // Either guarantee _recursions == 0 or set _recursions = 0. 
      assert (_recursions == 0ï¼Œ &amp;quot;invariant&amp;quot;) ; 
      assert (_owner == Selfï¼Œ &amp;quot;invariant&amp;quot;) ; 
      // CONSIDER: set or assert that OwnerIsThread == 1 
      return 1 ; 
    }
    // The lock had been free momentarilyï¼Œ but we lost the race to the lock. 
    // Interference -- the CAS failed. 
    // We can either return -1 or retry. 
    // Retry doesn&#39;t make as much sense because the lock was just acquired. 
    if (true) return -1 ; 
  } 
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»¥ä¸Šä»£ç çš„å…·ä½“æµç¨‹æ¦‚æ‹¬å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å½“å‰çº¿ç¨‹è¢«å°è£…æˆ ObjectWaiter å¯¹è±¡ nodeï¼ŒçŠ¶æ€è®¾ç½®æˆ ObjectWaiter::TS_CXQã€‚&lt;/li&gt;
&lt;li&gt;åœ¨ for å¾ªç¯ä¸­ï¼Œé€šè¿‡ CAS æŠŠ node èŠ‚ç‚¹ push åˆ° _cxq åˆ—è¡¨ä¸­ï¼ŒåŒä¸€æ—¶åˆ»å¯èƒ½æœ‰å¤šä¸ªçº¿ç¨‹æŠŠè‡ªå·±çš„ node èŠ‚ç‚¹ pus håˆ° _cxq åˆ—è¡¨ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;node èŠ‚ç‚¹ push åˆ° _cxq åˆ—è¡¨ä¹‹åï¼Œé€šè¿‡è‡ªæ—‹å°è¯•è·å–é”ï¼Œå¦‚æœè¿˜æ˜¯æ²¡æœ‰è·å–åˆ°é”ï¼Œåˆ™é€šè¿‡ park å°†å½“å‰çº¿ç¨‹æŒ‚èµ·ï¼Œç­‰å¾…è¢«å”¤é†’ã€‚&lt;/li&gt;
&lt;li&gt;å½“è¯¥çº¿ç¨‹è¢«å”¤é†’æ—¶ï¼Œä¼šä»æŒ‚èµ·çš„ç‚¹ç»§ç»­æ‰§è¡Œï¼Œé€šè¿‡ ObjectMonitor::TryLock å°è¯•è·å–é”ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;monitoré‡Šæ”¾&#34;&gt;monitoré‡Šæ”¾&lt;/h3&gt;
&lt;p&gt;å½“æŸä¸ªæŒæœ‰é”çš„çº¿ç¨‹æ‰§è¡Œå®ŒåŒæ­¥ä»£ç å—æ—¶ï¼Œä¼šè¿›è¡Œé”çš„é‡Šæ”¾ï¼Œç»™å…¶å®ƒçº¿ç¨‹æœºä¼šæ‰§è¡ŒåŒæ­¥ä»£ç ï¼Œåœ¨ HotSpot ä¸­ï¼Œé€šè¿‡é€€å‡º monitor çš„æ–¹å¼å®ç°é”çš„é‡Šæ”¾ï¼Œå¹¶é€šçŸ¥è¢«é˜»å¡çš„çº¿ç¨‹ï¼Œå…·ä½“å®ç°ä½äº ObjectMonitor çš„ exit æ–¹æ³•ä¸­ã€‚ï¼ˆä½äºï¼šsrc/share/vm/runtime/objectMonitor.cppï¼‰ï¼Œæºç å¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;void ATTR ObjectMonitor::exit(bool not_suspendedï¼Œ TRAPS) { 
  Thread * Self = THREAD ; 
  // çœç•¥éƒ¨åˆ†ä»£ç  
  // é‡å…¥é”
  if (_recursions != 0) { 
    _recursions--; // this is simple recursive enterTEVENT (Inflated exit - recursive) ; 
    return ; 
  }
  
  // çœç•¥éƒ¨åˆ†ä»£ç  
  // ç­‰å¾…çš„çº¿ç¨‹ç”¨ ObjectWaiter åŒ…è£…ï¼Œä½¿ç”¨å˜é‡ w å­˜æ”¾è¢«å”¤é†’çš„çº¿ç¨‹
  ObjectWaiter * w = NULL ; 
  int QMode = Knob_QMode ; 
  
  // qmode = 2ï¼šç›´æ¥ç»•è¿‡EntryListé˜Ÿåˆ—ï¼Œä»cxqé˜Ÿåˆ—ä¸­è·å–çº¿ç¨‹ç”¨äºç«äº‰é” 
  if (QMode == 2 &amp;amp;&amp;amp; _cxq != NULL) { 
    w = _cxq ; // _cxq çš„é“¾è¡¨å¤´èµ‹å€¼ç»™ w
    assert (w != NULLï¼Œ &amp;quot;invariant&amp;quot;) ; 
    assert (w-&amp;gt;TState == ObjectWaiter::TS_CXQï¼Œ &amp;quot;Invariant&amp;quot;) ; 
    ExitEpilog (Selfï¼Œ w) ; // å”¤é†’çº¿ç¨‹
    return ; 
  }
  
  // qmode =3ï¼šcxqé˜Ÿåˆ—æ’å…¥EntryListå°¾éƒ¨ï¼› 
  if (QMode == 3 &amp;amp;&amp;amp; _cxq != NULL) { 
    w = _cxq ; 
    for (;;) { 
      assert (w != NULLï¼Œ &amp;quot;Invariant&amp;quot;) ; 
      ObjectWaiter * u = (ObjectWaiter *) Atomic::cmpxchg_ptr (NULLï¼Œ 
      &amp;amp;_cxqï¼Œ w) ; 
      if (u == w) break ; 
      w = u ; 
    }
    assert (w != NULL ï¼Œ &amp;quot;invariant&amp;quot;) ; 
    
    ObjectWaiter * q = NULL ; 
    ObjectWaiter * p ; 
    for (p = w ; p != NULL ; p = p-&amp;gt;_next) { 
      guarantee (p-&amp;gt;TState == ObjectWaiter::TS_CXQï¼Œ &amp;quot;Invariant&amp;quot;) ; 
      p-&amp;gt;TState = ObjectWaiter::TS_ENTER ; 
      p-&amp;gt;_prev = q ; 
      q = p ; 
    }
    ObjectWaiter * Tail ; 
    for (Tail = _EntryList ; Tail != NULL &amp;amp;&amp;amp; Tail-&amp;gt;_next != NULL ; Tail = Tail-&amp;gt;_next) ; 
    if (Tail == NULL) { 
      _EntryList = w ; 
    } else { 
      Tail-&amp;gt;_next = w ; 
      w-&amp;gt;_prev = Tail ; 
    } 
  }
  
  // qmode =4ï¼šcxqé˜Ÿåˆ—æ’å…¥åˆ°_EntryListå¤´éƒ¨ 
  if (QMode == 4 &amp;amp;&amp;amp; _cxq != NULL) { 
    w = _cxq ; 
    for (;;) { 
      assert (w != NULLï¼Œ &amp;quot;Invariant&amp;quot;) ; 
      ObjectWaiter * u = (ObjectWaiter *) Atomic::cmpxchg_ptr (NULLï¼Œ 
      &amp;amp;_cxqï¼Œ w) ; 
      if (u == w) break ; 
      w = u ;
    }
    assert (w != NULL ï¼Œ &amp;quot;invariant&amp;quot;) ; 
    
    ObjectWaiter * q = NULL ; 
    ObjectWaiter * p ; 
    for (p = w ; p != NULL ; p = p-&amp;gt;_next) { 
      guarantee (p-&amp;gt;TState == ObjectWaiter::TS_CXQï¼Œ &amp;quot;Invariant&amp;quot;) ; 
      p-&amp;gt;TState = ObjectWaiter::TS_ENTER ; 
      p-&amp;gt;_prev = q ; 
      q = p ; 
    }
    if (_EntryList != NULL) { 
      q-&amp;gt;_next = _EntryList ; 
      _EntryList-&amp;gt;_prev = q ; 
    }
    _EntryList = w ; 
  }
  w = _EntryList ; 
  if (w != NULL) { 
    assert (w-&amp;gt;TState == ObjectWaiter::TS_ENTERï¼Œ &amp;quot;invariant&amp;quot;) ; 
    ExitEpilog (Selfï¼Œ w) ; 
    return ; 
  }
  w = _cxq ; 
  if (w == NULL) continue ; 
  for (;;) { 
    assert (w != NULLï¼Œ &amp;quot;Invariant&amp;quot;) ; 
    ObjectWaiter * u = (ObjectWaiter *) Atomic::cmpxchg_ptr (NULLï¼Œ &amp;amp;_cxqï¼Œw) ; 
    if (u == w) break ; 
    w = u ; 
  }
  TEVENT (Inflated exit - drain cxq into EntryList) ; 
  assert (w != NULL ï¼Œ &amp;quot;invariant&amp;quot;) ; 
  assert (_EntryList == NULL ï¼Œ &amp;quot;invariant&amp;quot;) ; 
  if (QMode == 1) { 
    // QMode == 1 : drain cxq to EntryListï¼Œ reversing order 
    // We also reverse the order of the list. 
    ObjectWaiter * s = NULL ; 
    ObjectWaiter * t = w ; 
    ObjectWaiter * u = NULL ; 
    while (t != NULL) { 
      guarantee (t-&amp;gt;TState == ObjectWaiter::TS_CXQï¼Œ &amp;quot;invariant&amp;quot;) ; 
      t-&amp;gt;TState = ObjectWaiter::TS_ENTER ; 
      u = t-&amp;gt;_next ; 
      t-&amp;gt;_prev = u ; 
      t-&amp;gt;_next = s ; 
      s = t; 
      t = u ; 
    }
    _EntryList = s ; 
    assert (s != NULLï¼Œ &amp;quot;invariant&amp;quot;) ;
  } else { 
    // QMode == 0 or QMode == 2 
    _EntryList = w ; 
    ObjectWaiter * q = NULL ; 
    ObjectWaiter * p ; 
    for (p = w ; p != NULL ; p = p-&amp;gt;_next) { 
      guarantee (p-&amp;gt;TState == ObjectWaiter::TS_CXQï¼Œ &amp;quot;Invariant&amp;quot;) ; 
      p-&amp;gt;TState = ObjectWaiter::TS_ENTER ; 
      p-&amp;gt;_prev = q ; 
      q = p ; 
      } 
    }
    if (_succ != NULL) continue; 
    
    w = _EntryList ; 
    if (w != NULL) { 
      guarantee (w-&amp;gt;TState == ObjectWaiter::TS_ENTERï¼Œ &amp;quot;invariant&amp;quot;) ; 
      ExitEpilog (Selfï¼Œ w) ; // å”¤é†’çº¿ç¨‹
      return ; 
    } 
  } 
}
&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;é€€å‡ºåŒæ­¥ä»£ç å—æ—¶ä¼šè®© _recursions å‡ 1ï¼Œå½“ _recursions çš„å€¼å‡ä¸º0æ—¶ï¼Œè¯´æ˜çº¿ç¨‹é‡Šæ”¾äº†é”ã€‚&lt;/li&gt;
&lt;li&gt;æ ¹æ®ä¸åŒçš„ç­–ç•¥ï¼ˆç”±QModeæŒ‡å®šï¼‰ï¼Œä» _cxq æˆ– EntryList ä¸­è·å–å¤´èŠ‚ç‚¹ï¼Œé€šè¿‡ObjectMonitor::ExitEpilog æ–¹æ³•å”¤é†’è¯¥èŠ‚ç‚¹å°è£…çš„çº¿ç¨‹ï¼Œå”¤é†’æ“ä½œæœ€ç»ˆç”± unpark å®Œæˆï¼Œå®ç°å¦‚ä¸‹ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;void ObjectMonitor::ExitEpilog (Thread * Selfï¼Œ ObjectWaiter * Wakee) { 
  assert (_owner == Selfï¼Œ &amp;quot;invariant&amp;quot;) ; 
  
  _succ = Knob_SuccEnabled ? Wakee-&amp;gt;_thread : NULL ; 
  ParkEvent * Trigger = Wakee-&amp;gt;_event ; 
  
  Wakee = NULL ; 
  
  // Drop the lock 
  OrderAccess::release_store_ptr (&amp;amp;_ownerï¼Œ NULL) ; 
  OrderAccess::fence() ; // ST _owner vs LD in 
  unpark() 
  if (SafepointSynchronize::do_call_back()) { 
    TEVENT (unpark before SAFEPOINT) ; 
  }
  
  DTRACE_MONITOR_PROBE(contended__exitï¼Œ thisï¼Œ object()ï¼Œ Self); 
  Trigger-&amp;gt;unpark() ; // å”¤é†’ä¹‹å‰è¢«pack()æŒ‚èµ·çš„çº¿ç¨‹. 
  
  // Maintain stats and report events to JVMTI 
  if (ObjectMonitor::_sync_Parks != NULL) { 
    ObjectMonitor::_sync_Parks-&amp;gt;inc() ; 
  } 
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¢«å”¤é†’çš„çº¿ç¨‹ï¼Œä¼šå›åˆ° void ATTR ObjectMonitor::EnterI (TRAPS) çš„ç¬¬600è¡Œï¼Œç»§ç»­æ‰§è¡Œmonitor çš„ç«äº‰ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;// park self 
if (_Responsible == Self || (SyncFlags &amp;amp; 1)) { 
  TEVENT (Inflated enter - park TIMED) ; 
  Self-&amp;gt;_ParkEvent-&amp;gt;park ((jlong) RecheckInterval) ; 
  // Increase the RecheckIntervalï¼Œ but clamp the value. 
  RecheckInterval *= 8 ; 
  if (RecheckInterval &amp;gt; 1000) RecheckInterval = 1000 ; 
} else { 
  TEVENT (Inflated enter - park UNTIMED) ; 
  Self-&amp;gt;_ParkEvent-&amp;gt;park() ; 
}
if (TryLock(Self) &amp;gt; 0) break ;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;monitoræ˜¯é‡é‡çº§é”&#34;&gt;monitoræ˜¯é‡é‡çº§é”&lt;/h3&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ° ObjectMonitor çš„å‡½æ•°è°ƒç”¨ä¸­ä¼šæ¶‰åŠåˆ° Atomic::cmpxchg_ptrï¼ŒAtomic::inc_ptr ç­‰å†…æ ¸å‡½æ•°ï¼Œæ‰§è¡ŒåŒæ­¥ä»£ç å—ï¼Œæ²¡æœ‰ç«äº‰åˆ°é”çš„å¯¹è±¡ä¼š park() è¢«æŒ‚èµ·ï¼Œç«äº‰åˆ°é”çš„çº¿ç¨‹ä¼š unpark() å”¤é†’ã€‚è¿™ä¸ªæ—¶å€™å°±ä¼šå­˜åœ¨æ“ä½œç³»ç»Ÿ&lt;strong&gt;ç”¨æˆ·æ€å’Œå†…æ ¸æ€çš„è½¬æ¢&lt;/strong&gt;ï¼Œè¿™ç§åˆ‡æ¢ä¼šæ¶ˆè€—å¤§é‡çš„ç³»ç»Ÿèµ„æºã€‚æ‰€ä»¥synchronized æ˜¯ Java è¯­è¨€ä¸­æ˜¯ä¸€ä¸ªé‡é‡çº§(Heavyweight)çš„æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;ç”¨æˆ·æ€å’Œå’Œå†…æ ¸æ€æ˜¯ä»€ä¹ˆä¸œè¥¿å‘¢ï¼Ÿè¦æƒ³äº†è§£ç”¨æˆ·æ€å’Œå†…æ ¸æ€è¿˜éœ€è¦å…ˆäº†è§£ä¸€ä¸‹ Linux ç³»ç»Ÿçš„ä½“ç³»æ¶æ„ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;17&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Linux%E7%B3%BB%E7%BB%9F%E7%9A%84%E4%BD%93%E7%B3%BB%E6%9E%B6%E6%9E%84.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p style = &#34;text-align:center&#34;&gt;Linuxç³»ç»Ÿçš„ä½“ç³»æ¶æ„&lt;/p&gt;
&lt;p&gt;ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼ŒLinuxæ“ä½œç³»ç»Ÿçš„ä½“ç³»æ¶æ„åˆ†ä¸ºï¼šç”¨æˆ·ç©ºé—´ï¼ˆåº”ç”¨ç¨‹åºçš„æ´»åŠ¨ç©ºé—´ï¼‰å’Œå†…æ ¸ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å†…æ ¸&lt;/strong&gt;ï¼šæœ¬è´¨ä¸Šå¯ä»¥ç†è§£ä¸ºä¸€ç§è½¯ä»¶ï¼Œæ§åˆ¶è®¡ç®—æœºçš„ç¡¬ä»¶èµ„æºï¼Œå¹¶æä¾›ä¸Šå±‚åº”ç”¨ç¨‹åºè¿è¡Œçš„ç¯å¢ƒã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç”¨æˆ·ç©ºé—´&lt;/strong&gt;ï¼šä¸Šå±‚åº”ç”¨ç¨‹åºæ´»åŠ¨çš„ç©ºé—´ã€‚åº”ç”¨ç¨‹åºçš„æ‰§è¡Œå¿…é¡»ä¾æ‰˜äºå†…æ ¸æä¾›çš„èµ„æºï¼ŒåŒ…æ‹¬CPUèµ„æºã€å­˜å‚¨èµ„æºã€I/Oèµ„æºç­‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç³»ç»Ÿè°ƒç”¨&lt;/strong&gt;ï¼šä¸ºäº†ä½¿ä¸Šå±‚åº”ç”¨èƒ½å¤Ÿè®¿é—®åˆ°è¿™äº›èµ„æºï¼Œå†…æ ¸å¿…é¡»ä¸ºä¸Šå±‚åº”ç”¨æä¾›è®¿é—®çš„æ¥å£ï¼šå³ç³»ç»Ÿè°ƒç”¨ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€æœ‰è¿›ç¨‹åˆå§‹éƒ½è¿è¡Œäºç”¨æˆ·ç©ºé—´ï¼Œæ­¤æ—¶å³ä¸ºç”¨æˆ·è¿è¡ŒçŠ¶æ€ï¼ˆç®€ç§°ï¼šç”¨æˆ·æ€ï¼‰ï¼›ä½†æ˜¯å½“å®ƒè°ƒç”¨ç³»ç»Ÿè°ƒç”¨æ‰§è¡ŒæŸäº›æ“ä½œæ—¶ï¼Œä¾‹å¦‚ I/Oè°ƒç”¨ï¼Œæ­¤æ—¶éœ€è¦é™·å…¥å†…æ ¸ä¸­è¿è¡Œï¼Œæˆ‘ä»¬å°±ç§°è¿›ç¨‹å¤„äºå†…æ ¸è¿è¡Œæ€ï¼ˆæˆ–ç®€ç§°ä¸ºå†…æ ¸æ€ï¼‰ã€‚ ç³»ç»Ÿè°ƒç”¨çš„è¿‡ç¨‹å¯ä»¥ç®€å•ç†è§£ä¸ºï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç”¨æˆ·æ€ç¨‹åºå°†ä¸€äº›æ•°æ®å€¼æ”¾åœ¨å¯„å­˜å™¨ä¸­ï¼Œ æˆ–è€…ä½¿ç”¨å‚æ•°åˆ›å»ºä¸€ä¸ªå †æ ˆï¼Œ ä»¥æ­¤è¡¨æ˜éœ€è¦æ“ä½œç³»ç»Ÿæä¾›çš„æœåŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;ç”¨æˆ·æ€ç¨‹åºæ‰§è¡Œç³»ç»Ÿè°ƒç”¨ã€‚&lt;/li&gt;
&lt;li&gt;CPUåˆ‡æ¢åˆ°å†…æ ¸æ€ï¼Œå¹¶è·³åˆ°ä½äºå†…å­˜æŒ‡å®šä½ç½®çš„æŒ‡ä»¤ã€‚&lt;/li&gt;
&lt;li&gt;ç³»ç»Ÿè°ƒç”¨å¤„ç†å™¨(system call handler)ä¼šè¯»å–ç¨‹åºæ”¾å…¥å†…å­˜çš„æ•°æ®å‚æ•°ï¼Œå¹¶æ‰§è¡Œç¨‹åºè¯·æ±‚çš„æœåŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;ç³»ç»Ÿè°ƒç”¨å®Œæˆåï¼Œæ“ä½œç³»ç»Ÿä¼šé‡ç½®CPUä¸ºç”¨æˆ·æ€å¹¶è¿”å›ç³»ç»Ÿè°ƒç”¨çš„ç»“æœã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç”±æ­¤å¯è§ç”¨æˆ·æ€åˆ‡æ¢è‡³å†…æ ¸æ€éœ€è¦ä¼ é€’è®¸å¤šå˜é‡ï¼ŒåŒæ—¶å†…æ ¸è¿˜éœ€è¦ä¿æŠ¤å¥½ç”¨æˆ·æ€åœ¨åˆ‡æ¢æ—¶çš„ä¸€äº›å¯„å­˜å™¨å€¼ã€å˜é‡ç­‰ï¼Œä»¥å¤‡å†…æ ¸æ€åˆ‡æ¢å›ç”¨æˆ·æ€ã€‚&lt;strong&gt;è¿™ç§åˆ‡æ¢å°±å¸¦æ¥äº†å¤§é‡çš„ç³»ç»Ÿèµ„æºæ¶ˆè€—&lt;/strong&gt;ï¼Œè¿™å°±æ˜¯åœ¨ synchronized æœªä¼˜åŒ–ä¹‹å‰ï¼Œæ•ˆç‡ä½çš„åŸå› ã€‚&lt;/p&gt;
&lt;h1 id=&#34;ç¬¬å…­ç« jdk6-synchronizedä¼˜åŒ–&#34;&gt;ç¬¬å…­ç« ï¼šJDK6 synchronizedä¼˜åŒ–&lt;/h1&gt;
&lt;h2 id=&#34;cas&#34;&gt;CAS&lt;/h2&gt;
&lt;p&gt;CASçš„å…¨ç§°æ˜¯ï¼š Compare And Swap(æ¯”è¾ƒç›¸åŒå†äº¤æ¢)ã€‚æ˜¯ç°ä»£CPUå¹¿æ³›æ”¯æŒçš„ä¸€ç§å¯¹å†…å­˜ä¸­çš„å…±äº«æ•°æ®è¿›è¡Œæ“ä½œçš„ä¸€ç§ç‰¹æ®ŠæŒ‡ä»¤ã€‚&lt;/p&gt;
&lt;p&gt;CASçš„ä½œç”¨ï¼šCASå¯ä»¥å°†æ¯”è¾ƒå’Œäº¤æ¢è½¬æ¢ä¸ºåŸå­æ“ä½œï¼Œè¿™ä¸ª&lt;strong&gt;åŸå­æ“ä½œç›´æ¥ç”±CPUä¿è¯&lt;/strong&gt;ã€‚CASå¯ä»¥ä¿è¯å…±äº«å˜é‡èµ‹å€¼æ—¶çš„åŸå­æ“ä½œã€‚CASæ“ä½œä¾èµ–3ä¸ªå€¼ï¼šå†…å­˜ä¸­çš„å€¼Vï¼Œæ—§çš„é¢„ä¼°å€¼Xï¼Œè¦ä¿®æ”¹çš„æ–°å€¼Bï¼Œå¦‚æœæ—§çš„é¢„ä¼°å€¼Xç­‰äºå†…å­˜ä¸­çš„å€¼Vï¼Œå°±å°†æ–°çš„å€¼Bä¿å­˜åˆ°å†…å­˜ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;CAS å’Œ volatile å®ç°æ— é”å¹¶å‘&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;package com.itheima.demo05_cas;
import java.util.ArrayList;
import java.util.concurrent.atomic.AtomicInteger;
public class Demo01 {
    public static void main(String[] args) throws InterruptedException {
        AtomicInteger atomicInteger = new AtomicInteger();
        Runnable mr = () -&amp;gt; {
            for (int i = 0; i &amp;lt; 1000; i++) {
                atomicInteger.incrementAndGet();
            }
        };
        ArrayList&amp;lt;Thread&amp;gt; ts = new ArrayList&amp;lt;&amp;gt;();
        for (int i = 0; i &amp;lt; 5; i++) {
            Thread t = new Thread(mr);
            t.start();
            ts.add(t);
        }
        for (Thread t : ts) {
            t.join();
        }
        System.out.println(&amp;quot;atomicIntegerÂ = &amp;quot; + atomicInteger.get());
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;atomicIntegerÂ  = 5000
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;casåŸç†&#34;&gt;CASåŸç†&lt;/h3&gt;
&lt;p&gt;é€šè¿‡åˆšæ‰ AtomicInteger çš„æºç æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒUnsafe ç±»æä¾›äº†åŸå­æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Unsafeç±»ä»‹ç»&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Unsafe ç±»ä½¿ Java æ‹¥æœ‰äº†åƒ C è¯­è¨€çš„æŒ‡é’ˆä¸€æ ·æ“ä½œå†…å­˜ç©ºé—´çš„èƒ½åŠ›ï¼ŒåŒæ—¶ä¹Ÿå¸¦æ¥äº†æŒ‡é’ˆçš„é—®é¢˜ã€‚è¿‡åº¦çš„ä½¿ç”¨ Unsafe ç±»ä¼šä½¿å¾—å‡ºé”™çš„å‡ ç‡å˜å¤§ï¼Œå› æ­¤ Java å®˜æ–¹å¹¶ä¸å»ºè®®ä½¿ç”¨çš„ï¼Œå®˜æ–¹æ–‡æ¡£ä¹Ÿå‡ ä¹æ²¡æœ‰ã€‚Unsafe å¯¹è±¡ä¸èƒ½ç›´æ¥è°ƒç”¨ï¼Œåªèƒ½é€šè¿‡åå°„è·å¾—ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;18&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/unsafe%E7%B1%BB.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;public class AtomicInteger extends Number implements java.io.Serializable {
    private static final long serialVersionUID = 6214790243416807050L;

    // setup to use Unsafe.compareAndSwapInt for updates
    private static final Unsafe unsafe = Unsafe.getUnsafe();
    // value çš„åç§»åœ°å€
    private static final long valueOffset;

    static {
        try {
            valueOffset = unsafe.objectFieldOffset
                (AtomicInteger.class.getDeclaredField(&amp;quot;value&amp;quot;));
        } catch (Exception ex) {
             throw new Error(ex); 
        }
    }
    // æ•°å­—ä¿å­˜åœ¨ value ä¸­ã€‚æ ¹æ® AtomicInteger å¯¹è±¡çš„å†…å­˜åœ°å€ å’Œ value çš„åç§»åœ°å€ï¼Œæ‰¾åˆ° value çš„å€¼
    private volatile int value;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Unsafeå®ç°CAS&lt;/strong&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/unsafe%E5%AE%9E%E7%8E%B0CAS.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;ä¹è§‚é”å’Œæ‚²è§‚é”&#34;&gt;ä¹è§‚é”å’Œæ‚²è§‚é”&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;æ‚²è§‚é”&lt;/strong&gt;ä»æ‚²è§‚çš„è§’åº¦å‡ºå‘ï¼š&lt;/p&gt;
&lt;p&gt;æ€»æ˜¯å‡è®¾æœ€åçš„æƒ…å†µï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¼šä¿®æ”¹ï¼Œæ‰€ä»¥æ¯æ¬¡åœ¨æ‹¿æ•°æ®çš„æ—¶å€™éƒ½ä¼šä¸Šé”ï¼Œè¿™æ ·åˆ«äººæƒ³æ‹¿è¿™ä¸ªæ•°æ®å°±ä¼šé˜»å¡ã€‚å› æ­¤&lt;strong&gt;synchronized&lt;/strong&gt;æˆ‘ä»¬ä¹Ÿå°†å…¶ç§°ä¹‹ä¸ºæ‚²è§‚é”ã€‚JDKä¸­çš„&lt;strong&gt;ReentrantLock&lt;/strong&gt;ä¹Ÿæ˜¯ä¸€ç§æ‚²è§‚é”ã€‚æ€§èƒ½è¾ƒå·®ï¼&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¹è§‚é”&lt;/strong&gt;ä»ä¹è§‚çš„è§’åº¦å‡ºå‘:&lt;/p&gt;
&lt;p&gt;æ€»æ˜¯å‡è®¾æœ€å¥½çš„æƒ…å†µï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¸ä¼šä¿®æ”¹ï¼Œå°±ç®—æ”¹äº†ä¹Ÿæ²¡å…³ç³»ï¼Œå†é‡è¯•å³å¯ã€‚æ‰€ä»¥ä¸ä¼šä¸Šé”ï¼Œä½†æ˜¯åœ¨æ›´æ–°çš„æ—¶å€™ä¼šåˆ¤æ–­ä¸€ä¸‹åœ¨æ­¤æœŸé—´åˆ«äººæœ‰æ²¡æœ‰å»ä¿®æ”¹è¿™ä¸ªæ•°æ®ï¼Œå¦‚æœæ²¡æœ‰äººä¿®æ”¹åˆ™æ›´æ–°ï¼Œå¦‚æœæœ‰äººä¿®æ”¹åˆ™é‡è¯•ã€‚&lt;/p&gt;
&lt;p&gt;CASè¿™ç§æœºåˆ¶æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†å…¶ç§°ä¹‹ä¸ºä¹è§‚é”ã€‚ç»¼åˆæ€§èƒ½è¾ƒå¥½ï¼&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;CASè·å–å…±äº«å˜é‡æ—¶ï¼Œä¸ºäº†ä¿è¯è¯¥å˜é‡çš„å¯è§æ€§ï¼Œéœ€è¦ä½¿ç”¨volatileä¿®é¥°ã€‚ç»“åˆCASå’Œvolatileå¯ä»¥å®ç°æ— é”å¹¶å‘ï¼Œé€‚ç”¨äºç«äº‰ä¸æ¿€çƒˆã€å¤šæ ¸ CPU çš„åœºæ™¯ä¸‹ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å› ä¸ºæ²¡æœ‰ä½¿ç”¨ synchronizedï¼Œæ‰€ä»¥çº¿ç¨‹ä¸ä¼šé™·å…¥é˜»å¡ï¼Œè¿™æ˜¯æ•ˆç‡æå‡çš„å› ç´ ä¹‹ä¸€ã€‚&lt;/li&gt;
&lt;li&gt;ä½†å¦‚æœç«äº‰æ¿€çƒˆï¼Œå¯ä»¥æƒ³åˆ°é‡è¯•å¿…ç„¶é¢‘ç¹å‘ç”Ÿï¼Œåè€Œæ•ˆç‡ä¼šå—å½±å“ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;å°ç»“-12&#34;&gt;å°ç»“&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;CASçš„ä½œç”¨?&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;Compare And Swapï¼ŒCASå¯ä»¥å°†æ¯”è¾ƒå’Œäº¤æ¢è½¬æ¢ä¸ºåŸå­æ“ä½œï¼Œè¿™ä¸ªåŸå­æ“ä½œç›´æ¥ç”±å¤„ç†å™¨ä¿è¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;CASçš„åŸç†ï¼Ÿ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;CASéœ€è¦3ä¸ªå€¼:å†…å­˜åœ°å€Vï¼Œæ—§çš„é¢„æœŸå€¼Aï¼Œè¦ä¿®æ”¹çš„æ–°å€¼Bï¼Œå¦‚æœå†…å­˜åœ°å€Vå’Œæ—§çš„é¢„æœŸå€¼Aç›¸ç­‰å°±ä¿®æ”¹å†…å­˜åœ°å€å€¼ä¸ºB&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;synchronizedé”å‡çº§è¿‡ç¨‹&#34;&gt;synchronizedé”å‡çº§è¿‡ç¨‹&lt;/h2&gt;
&lt;p&gt;é«˜æ•ˆå¹¶å‘æ˜¯ä» JDK5 åˆ° JDK6 çš„ä¸€ä¸ªé‡è¦æ”¹è¿›ï¼ŒHotSpot è™›æ‹Ÿæœºå¼€å‘å›¢é˜Ÿåœ¨è¿™ä¸ªç‰ˆæœ¬ä¸ŠèŠ±è´¹äº†å¤§é‡çš„ç²¾åŠ›å»å®ç°å„ç§é”ä¼˜åŒ–æŠ€æœ¯ï¼ŒåŒ…æ‹¬åå‘é”( Biased Locking )ã€è½»é‡çº§é”( Lightweight Locking )å’Œå¦‚é€‚åº”æ€§è‡ªæ—‹(Adaptive Spinning)ã€é”æ¶ˆé™¤( Lock Elimination)ã€é”ç²—åŒ–( Lock Coarsening )ç­‰ï¼Œè¿™äº›æŠ€æœ¯éƒ½æ˜¯ä¸ºäº†åœ¨çº¿ç¨‹ä¹‹é—´æ›´é«˜æ•ˆåœ°å…±äº«æ•°æ®ï¼Œä»¥åŠè§£å†³ç«äº‰é—®é¢˜ï¼Œä»è€Œæé«˜ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ— é” --&amp;gt; åå‘é” --&amp;gt; è½»é‡çº§é” â€“&amp;gt; é‡é‡çº§é”&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;javaå¯¹è±¡çš„å¸ƒå±€&#34;&gt;Javaå¯¹è±¡çš„å¸ƒå±€&lt;/h2&gt;
&lt;p&gt;æœ¯è¯­å‚è€ƒ: &lt;a href=&#34;http://openjdk.java.net/groups/hotspot/docs/HotSpotGlossary.html&#34;&gt;http://openjdk.java.net/groups/hotspot/docs/HotSpotGlossary.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åœ¨JVMä¸­ï¼Œå¯¹è±¡åœ¨å†…å­˜ä¸­çš„å¸ƒå±€åˆ†ä¸ºä¸‰å—åŒºåŸŸï¼šå¯¹è±¡å¤´ã€å®ä¾‹æ•°æ®å’Œå¯¹é½å¡«å……ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;19&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%AF%B9%E8%B1%A1%E5%A4%B4.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;å¯¹è±¡å¤´&#34;&gt;å¯¹è±¡å¤´&lt;/h3&gt;
&lt;p&gt;å½“ä¸€ä¸ªçº¿ç¨‹å°è¯•è®¿é—® synchronized ä¿®é¥°çš„ä»£ç å—æ—¶ï¼Œå®ƒé¦–å…ˆè¦è·å¾—é”ï¼Œé‚£ä¹ˆè¿™ä¸ªé”åˆ°åº•å­˜åœ¨å“ªé‡Œå‘¢ï¼Ÿæ˜¯å­˜åœ¨é”å¯¹è±¡çš„å¯¹è±¡å¤´ä¸­çš„ã€‚&lt;/p&gt;
&lt;p&gt;HotSpot é‡‡ç”¨ instanceOopDesc å’Œ arrayOopDesc æ¥æè¿°å¯¹è±¡å¤´ï¼ŒarrayOopDesc å¯¹è±¡ç”¨æ¥æè¿°æ•°ç»„ç±»å‹ã€‚instanceOopDesc çš„å®šä¹‰çš„åœ¨ Hotspot æºç çš„ instanceOop.hpp æ–‡ä»¶ä¸­ï¼Œå¦å¤–ï¼ŒarrayOopDesc çš„å®šä¹‰å¯¹åº” arrayOop.hpp ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;class instanceOopDesc : public oopDesc {
    public:
    // aligned header size.
    static int header_size() { return sizeof(instanceOopDesc)/HeapWordSize; }
    // If compressed, the offset of the fields of the instance may not be aligned.
    static int base_offset_in_bytes() {
    // offset computation code breaks if UseCompressedClassPointers
    // only is true
            return (UseCompressedOops &amp;amp;&amp;amp; UseCompressedClassPointers) ?
            klass_gap_offset_in_bytes() :
            sizeof(instanceOopDesc);
    }
    static bool contains_field_offset(int offset, int nonstatic_field_size) {
        int base_in_bytes = base_offset_in_bytes();
        return (offset &amp;gt;= base_in_bytes &amp;amp;&amp;amp;
            (offset-base_in_bytes) &amp;lt; nonstatic_field_size * heapOopSize);
    }
};
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä» instanceOopDesc ä»£ç ä¸­å¯ä»¥çœ‹åˆ° instanceOopDesc ç»§æ‰¿è‡ª oopDescï¼ŒoopDesc çš„å®šä¹‰åœ¨Hotspot æºç ä¸­çš„ oop.hpp æ–‡ä»¶ä¸­ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;class oopDesc {
    friend class VMStructs;
   private:
    volatile markOop _mark;
    union _metadata {
        Klass* _klass;
        narrowKlass _compressed_klass;
    } _metadata;
// Fast access to barrier set. Must be initialized. 
    static BarrierSet* _bs;
// çœç•¥å…¶ä»–ä»£ç  
};
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åœ¨æ™®é€šå®ä¾‹å¯¹è±¡ä¸­ï¼ŒoopDesc çš„å®šä¹‰åŒ…å«ä¸¤ä¸ªæˆå‘˜ï¼Œåˆ†åˆ«æ˜¯ _mark å’Œ _metadata&lt;/p&gt;
&lt;p&gt;_mark è¡¨ç¤º&lt;strong&gt;å¯¹è±¡æ ‡è®°&lt;/strong&gt;ã€å±äº markOop ç±»å‹ï¼Œä¹Ÿå°±æ˜¯æ¥ä¸‹æ¥è¦è®²è§£çš„ Mark Worldï¼Œå®ƒè®°å½•äº†&lt;strong&gt;å¯¹è±¡å’Œé”æœ‰å…³çš„ä¿¡æ¯&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;_metadata è¡¨ç¤º&lt;strong&gt;ç±»å…ƒä¿¡æ¯&lt;/strong&gt;ï¼Œç±»å…ƒä¿¡æ¯å­˜å‚¨çš„æ˜¯&lt;strong&gt;å¯¹è±¡æŒ‡å‘å®ƒçš„ç±»å…ƒæ•°æ®(Klass)çš„é¦–åœ°å€&lt;/strong&gt;ï¼Œå…¶ä¸­ Klass è¡¨ç¤ºæ™®é€šæŒ‡é’ˆã€ _compressed_klass è¡¨ç¤ºå‹ç¼©ç±»æŒ‡é’ˆã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;20&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%AF%B9%E8%B1%A1%E5%A4%B4.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;å¯¹è±¡å¤´ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œä¸€éƒ¨åˆ†ç”¨äºå­˜å‚¨è‡ªèº«çš„è¿è¡Œæ—¶æ•°æ®ï¼Œç§°ä¹‹ä¸º Mark Wordï¼Œå¦å¤–ä¸€éƒ¨åˆ†æ˜¯ç±»å‹æŒ‡é’ˆï¼ŒåŠå¯¹è±¡æŒ‡å‘å®ƒçš„ç±»å…ƒæ•°æ®çš„æŒ‡é’ˆã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Mark Word&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Mark Wordç”¨äºå­˜å‚¨&lt;strong&gt;å¯¹è±¡è‡ªèº«çš„è¿è¡Œæ—¶æ•°æ®&lt;/strong&gt;ï¼Œå¦‚&lt;strong&gt;å“ˆå¸Œç ï¼ˆHashCodeï¼‰ã€GCåˆ†ä»£å¹´é¾„ã€é”çŠ¶æ€æ ‡å¿—ã€ çº¿ç¨‹æŒæœ‰çš„é”ã€åå‘çº¿ç¨‹IDã€åå‘æ—¶é—´æˆ³&lt;/strong&gt;ç­‰ç­‰ï¼Œå ç”¨å†…å­˜å¤§å°ä¸è™šæ‹Ÿæœºä½é•¿ä¸€è‡´ã€‚Mark Wordå¯¹åº”çš„ç±»å‹æ˜¯ markOop ã€‚æºç ä½äº markOop.hpp ä¸­ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;// Bit-format of an object header (most significant first, big endian layout below): 
//
// 32 bits: 
// -------- 
// hash:25 ------------&amp;gt;| age:4 biased_lock:1 lock:2 (normal object)// JavaThread*:23 epoch:2 age:4 biased_lock:1 lock:2 (biased object) 
// size:32 ------------------------------------------&amp;gt;| (CMS free block) 
// PromotedObject*:29 ----------&amp;gt;| promo_bits:3 -----&amp;gt;| (CMS promoted object) 
//
// 64 bits: 
// -------- 
// unused:25 hash:31 --&amp;gt;| unused:1 age:4 biased_lock:1 lock:2 (normal object) 
// JavaThread*:54 epoch:2 unused:1 age:4 biased_lock:1 lock:2 (biased object) 
// PromotedObject*:61 ---------------------&amp;gt;| promo_bits:3 -----&amp;gt;| (CMS promoted object) 
// size:64 -----------------------------------------------------&amp;gt;| (CMS free block) 
// [JavaThread* | epoch | age | 1 | 01] lock is biased toward given thread 
// [0 | epoch | age | 1 | 01] lock is anonymously biased 
//
// - the two lock bits are used to describe three states: locked/unlocked and monitor. 
//
// [ptr | 00] locked ptr points to real header on stack 
// [header | 0 | 01] unlocked regular object header 
// [ptr | 10] monitor inflated lock (header is wapped out) 
// [ptr | 11] marked used by markSweep to mark an object 
// not valid at any other time 
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;21&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%AF%B9%E8%B1%A1%E5%A4%B42.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;åœ¨64ä½è™šæ‹Ÿæœºä¸‹ï¼ŒMark Word æ˜¯ 64bit å¤§å°çš„ï¼Œå…¶å­˜å‚¨ç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;22&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/64%E4%BD%8D%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%AF%B9%E8%B1%A1%E5%A4%B4.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;åœ¨32ä½è™šæ‹Ÿæœºä¸‹ï¼ŒMark Word æ˜¯ 32bit å¤§å°çš„ï¼Œå…¶å­˜å‚¨ç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;23&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/32%E4%BD%8D%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%AF%B9%E8%B1%A1%E5%A4%B4.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;klass pointer&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸€éƒ¨åˆ†ç”¨äºå­˜å‚¨å¯¹è±¡çš„ç±»å‹æŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆæŒ‡å‘å®ƒçš„ç±»å…ƒæ•°æ®ï¼ŒJVMé€šè¿‡è¿™ä¸ªæŒ‡é’ˆç¡®å®šå¯¹è±¡æ˜¯&lt;strong&gt;å“ªä¸ªç±»çš„å®ä¾‹&lt;/strong&gt;ã€‚è¯¥æŒ‡é’ˆçš„ä½é•¿åº¦ä¸º JVM çš„ä¸€ä¸ªå­—å¤§å°ï¼Œå³ 32 ä½çš„ JVM ä¸º 32 ä½ï¼Œ64 ä½çš„ JVM ä¸º 64 ä½ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœåº”ç”¨çš„å¯¹è±¡è¿‡å¤šï¼Œä½¿ç”¨ 64 ä½çš„æŒ‡é’ˆå°†æµªè´¹å¤§é‡å†…å­˜ï¼Œç»Ÿè®¡è€Œè¨€ï¼Œ64 ä½çš„ JVM å°†ä¼šæ¯” 32 ä½çš„ JVM å¤šè€—è´¹ 50% çš„å†…å­˜ã€‚ä¸ºäº†èŠ‚çº¦å†…å­˜å¯ä»¥ä½¿ç”¨é€‰é¡¹ &lt;code&gt;-XX:+UseCompressedOops&lt;/code&gt; å¼€å¯æŒ‡é’ˆå‹ç¼©ï¼Œå…¶ä¸­ï¼Œoop å³ ordinary object pointer æ™®é€šå¯¹è±¡æŒ‡é’ˆã€‚å¼€å¯è¯¥é€‰é¡¹åï¼Œä¸‹åˆ—æŒ‡é’ˆå°†å‹ç¼©è‡³ 32 ä½ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ¯ä¸ªClassçš„å±æ€§æŒ‡é’ˆï¼ˆå³é™æ€å˜é‡ï¼‰&lt;/li&gt;
&lt;li&gt;æ¯ä¸ªå¯¹è±¡çš„å±æ€§æŒ‡é’ˆï¼ˆå³å¯¹è±¡å˜é‡ï¼‰&lt;/li&gt;
&lt;li&gt;æ™®é€šå¯¹è±¡æ•°ç»„çš„æ¯ä¸ªå…ƒç´ æŒ‡é’ˆ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å½“ç„¶ï¼Œä¹Ÿä¸æ˜¯æ‰€æœ‰çš„æŒ‡é’ˆéƒ½ä¼šå‹ç¼©ï¼Œä¸€äº›ç‰¹æ®Šç±»å‹çš„æŒ‡é’ˆ JVM ä¸ä¼šä¼˜åŒ–ï¼Œæ¯”å¦‚æŒ‡å‘ PermGen çš„ Class å¯¹è±¡æŒ‡é’ˆ(JDK8 ä¸­æŒ‡å‘å…ƒç©ºé—´çš„ Class å¯¹è±¡æŒ‡é’ˆ)ã€æœ¬åœ°å˜é‡ã€å †æ ˆå…ƒç´ ã€å…¥å‚ã€è¿”å›å€¼å’Œ NULL æŒ‡é’ˆç­‰ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹è±¡å¤´ = Mark Word + ç±»å‹æŒ‡é’ˆï¼ˆæœªå¼€å¯æŒ‡é’ˆå‹ç¼©çš„æƒ…å†µä¸‹ï¼‰&lt;/p&gt;
&lt;p&gt;åœ¨32ä½ç³»ç»Ÿä¸­ï¼ŒMark Word = 4 bytesï¼Œç±»å‹æŒ‡é’ˆ = 4bytesï¼Œå¯¹è±¡å¤´ = 8 bytes = 64 bitsï¼›&lt;/p&gt;
&lt;p&gt;åœ¨64ä½ç³»ç»Ÿä¸­ï¼ŒMark Word = 8 bytesï¼Œç±»å‹æŒ‡é’ˆ = 8bytesï¼Œå¯¹è±¡å¤´ = 16 bytes = 128bitsï¼›&lt;/p&gt;
&lt;h3 id=&#34;å®ä¾‹æ•°æ®&#34;&gt;å®ä¾‹æ•°æ®&lt;/h3&gt;
&lt;p&gt;å°±æ˜¯ç±»ä¸­å®šä¹‰çš„æˆå‘˜å˜é‡ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¯¹é½å¡«å……&#34;&gt;å¯¹é½å¡«å……&lt;/h3&gt;
&lt;p&gt;å¯¹é½å¡«å……å¹¶ä¸æ˜¯å¿…ç„¶å­˜åœ¨çš„ï¼Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„æ„ä¹‰ï¼Œä»–ä»…ä»…èµ·ç€å ä½ç¬¦çš„ä½œç”¨ï¼Œç”±äº HotSpot VM çš„è‡ªåŠ¨å†…å­˜ç®¡ç†ç³»ç»Ÿè¦æ±‚å¯¹è±¡èµ·å§‹åœ°å€å¿…é¡»æ˜¯8å­—èŠ‚çš„æ•´æ•°å€ï¼Œæ¢å¥è¯è¯´ï¼Œå°±æ˜¯å¯¹è±¡çš„å¤§å°å¿…é¡»æ˜¯8å­—èŠ‚çš„æ•´æ•°å€ã€‚è€Œå¯¹è±¡å¤´æ­£å¥½æ˜¯8å­—èŠ‚çš„å€æ•°ï¼Œå› æ­¤ï¼Œå½“å¯¹è±¡å®ä¾‹æ•°æ®éƒ¨åˆ†æ²¡æœ‰å¯¹é½æ—¶ï¼Œå°±éœ€è¦é€šè¿‡å¯¹é½å¡«å……æ¥è¡¥å…¨ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æŸ¥çœ‹javaå¯¹è±¡å¸ƒå±€&#34;&gt;æŸ¥çœ‹Javaå¯¹è±¡å¸ƒå±€&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dependency&amp;gt;
  &amp;lt;groupId&amp;gt;org.openjdk.jol&amp;lt;/groupId&amp;gt;
  &amp;lt;artifactId&amp;gt;jol-core&amp;lt;/artifactId&amp;gt;
  &amp;lt;version&amp;gt;0.9&amp;lt;/version&amp;gt;
&amp;lt;/dependency&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;package com.itheima.demo06_object_layout;

public class LockObj {
    private int x;
    private boolean b;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;package com.itheima.demo06_object_layout;

import org.openjdk.jol.info.ClassLayout;

public class Demo01 {
    public static void main(String[] args) {
        LockObj obj = new LockObj();

        obj.hashCode();
        System.out.println(obj.hashCode());
        System.out.println(Integer.toHexString(obj.hashCode()));

        System.out.println(ClassLayout.parseInstance(obj).toPrintable());
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;24&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%AF%B9%E8%B1%A1%E5%A4%B43.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;å°ç»“-13&#34;&gt;å°ç»“&lt;/h3&gt;
&lt;p&gt;Javaå¯¹è±¡ç”±3éƒ¨åˆ†ç»„æˆï¼Œå¯¹è±¡å¤´ï¼Œå®ä¾‹æ•°æ®ï¼Œå¯¹é½æ•°æ®&lt;/p&gt;
&lt;p&gt;å¯¹è±¡å¤´åˆ†æˆä¸¤éƒ¨åˆ†ï¼šMark World + Klass pointer&lt;/p&gt;
&lt;h2 id=&#34;åå‘é”&#34;&gt;åå‘é”&lt;/h2&gt;
&lt;p&gt;åå‘é”æ˜¯ JDK6 ä¸­çš„é‡è¦å¼•è¿›ï¼Œå› ä¸ºHotSpotä½œè€…ç»è¿‡ç ”ç©¶å®è·µå‘ç°ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œ&lt;strong&gt;é”ä¸ä»…ä¸å­˜åœ¨å¤šçº¿ç¨‹ç«äº‰ï¼Œè€Œä¸”æ€»æ˜¯ç”±åŒä¸€çº¿ç¨‹å¤šæ¬¡è·å¾—&lt;/strong&gt;ï¼Œä¸ºäº†è®©çº¿ç¨‹è·å¾—é”çš„ä»£ä»·æ›´ä½ï¼Œå¼•è¿›äº†åå‘é”ã€‚&lt;/p&gt;
&lt;p&gt;åå‘é”çš„â€œåâ€ï¼Œå°±æ˜¯åå¿ƒçš„â€œåâ€ã€åè¢’çš„â€œåâ€ï¼Œå®ƒçš„æ„æ€æ˜¯è¿™ä¸ªé”ä¼šåå‘äºç¬¬ä¸€ä¸ªè·å¾—å®ƒçš„çº¿ç¨‹ï¼Œä¼šåœ¨å¯¹è±¡å¤´å­˜å‚¨é”åå‘çš„çº¿ç¨‹IDï¼Œä»¥åè¯¥çº¿ç¨‹è¿›å…¥å’Œé€€å‡ºåŒæ­¥å—æ—¶åªéœ€è¦æ£€æŸ¥æ˜¯å¦ä¸ºåå‘é”ã€é”æ ‡å¿—ä½ä»¥ ThreadID å³å¯ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;25&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%81%8F%E5%90%91%E9%94%81.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ä¸è¿‡&lt;strong&gt;ä¸€æ—¦å‡ºç°å¤šä¸ªçº¿ç¨‹ç«äº‰æ—¶å¿…é¡»æ’¤é”€åå‘é”&lt;/strong&gt;ï¼Œæ‰€ä»¥æ’¤é”€åå‘é”æ¶ˆè€—çš„æ€§èƒ½å¿…é¡»å°äºä¹‹å‰èŠ‚çœä¸‹æ¥çš„CASåŸå­æ“ä½œçš„æ€§èƒ½æ¶ˆè€—ï¼Œä¸ç„¶å°±å¾—ä¸å¿å¤±äº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åå‘é”åŸç†&#34;&gt;åå‘é”åŸç†&lt;/h3&gt;
&lt;p&gt;å½“çº¿ç¨‹ç¬¬ä¸€æ¬¡è®¿é—®åŒæ­¥å—å¹¶è·å–é”æ—¶ï¼Œåå‘é”å¤„ç†æµç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è™šæ‹Ÿæœºå°†ä¼šæŠŠå¯¹è±¡å¤´ä¸­çš„æ ‡å¿—ä½è®¾ä¸ºâ€œ01â€ï¼Œå³åå‘æ¨¡å¼ã€‚&lt;/li&gt;
&lt;li&gt;åŒæ—¶ä½¿ç”¨ CAS æ“ä½œæŠŠè·å–åˆ°è¿™ä¸ªé”çš„çº¿ç¨‹çš„ ID è®°å½•åœ¨å¯¹è±¡çš„ Mark Word ä¹‹ä¸­ ï¼Œå¦‚æœ CAS æ“ä½œæˆåŠŸï¼ŒæŒæœ‰åå‘é”çš„çº¿ç¨‹ä»¥åæ¯æ¬¡è¿›å…¥è¿™ä¸ªé”ç›¸å…³çš„åŒæ­¥å—æ—¶ï¼Œè™šæ‹Ÿæœºéƒ½å¯ä»¥ä¸å†è¿›è¡Œä»»ä½•åŒæ­¥æ“ä½œï¼Œåå‘é”çš„æ•ˆç‡é«˜ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;26&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%81%8F%E5%90%91%E9%94%81.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;æŒæœ‰åå‘é”çš„çº¿ç¨‹ä»¥åæ¯æ¬¡è¿›å…¥è¿™ä¸ªé”ç›¸å…³çš„åŒæ­¥å—æ—¶ï¼Œè™šæ‹Ÿæœºéƒ½å¯ä»¥&lt;strong&gt;ä¸å†è¿›è¡Œä»»ä½•åŒæ­¥æ“ä½œ&lt;/strong&gt;ï¼Œåå‘é”çš„æ•ˆç‡é«˜ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åå‘é”çš„æ’¤é”€&#34;&gt;åå‘é”çš„æ’¤é”€&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;åå‘é”çš„æ’¤é”€åŠ¨ä½œå¿…é¡»ç­‰å¾…&lt;strong&gt;å…¨å±€å®‰å…¨ç‚¹&lt;/strong&gt; ï¼ˆæ‰€æœ‰çº¿ç¨‹éƒ½åœä¸‹æ¥çš„ç‚¹ã€‚ä¸¾ä¾‹ï¼šç»Ÿè®¡ 9 ç‚¹æŸåœ°æœ‰å¤šå°‘äººï¼Œ9 ç‚¹è®©æ‰€æœ‰äººåœä¸‹æ¥ï¼Œä¸èƒ½è¿›å‡ºï¼Œå¼€å§‹ç»Ÿè®¡ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æš‚åœæ‹¥æœ‰åå‘é”çš„çº¿ç¨‹&lt;/strong&gt;ï¼Œåˆ¤æ–­é”å¯¹è±¡æ˜¯å¦å¤„äºè¢«é”å®šçŠ¶æ€&lt;/li&gt;
&lt;li&gt;æ’¤é”€åå‘é”ï¼Œæ¢å¤åˆ°æ— é”ï¼ˆæ ‡å¿—ä½ä¸º &lt;strong&gt;01&lt;/strong&gt;ï¼‰æˆ–è½»é‡çº§é”ï¼ˆæ ‡å¿—ä½ä¸º &lt;strong&gt;00&lt;/strong&gt;ï¼‰çš„çŠ¶æ€&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;åå‘é”åœ¨ Java6 ä¹‹åæ˜¯é»˜è®¤å¯ç”¨çš„ï¼Œä½†åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨å‡ ç§’é’Ÿä¹‹åæ‰æ¿€æ´»ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code&gt;-XX:BiasedLockingStartupDelay=0&lt;/code&gt; å‚æ•°å…³é—­å»¶è¿Ÿï¼Œå¦‚æœç¡®å®šåº”ç”¨ç¨‹åºä¸­æ‰€æœ‰é”é€šå¸¸æƒ…å†µä¸‹å¤„äºç«äº‰çŠ¶æ€ï¼Œå¯ä»¥é€šè¿‡ &lt;code&gt;XX:-UseBiasedLocking=false&lt;/code&gt; å‚æ•°å…³é—­åå‘é”ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åå‘é”å¥½å¤„&#34;&gt;åå‘é”å¥½å¤„&lt;/h3&gt;
&lt;p&gt;åå‘é”æ˜¯åœ¨åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡ŒåŒæ­¥å—æ—¶è¿›ä¸€æ­¥æé«˜æ€§èƒ½ï¼Œé€‚ç”¨äº&lt;strong&gt;ä¸€ä¸ªçº¿ç¨‹åå¤è·å¾—åŒä¸€é”&lt;/strong&gt;çš„æƒ…å†µã€‚åå‘é”å¯ä»¥æé«˜å¸¦æœ‰åŒæ­¥ä½†æ— ç«äº‰çš„ç¨‹åºæ€§èƒ½ã€‚&lt;/p&gt;
&lt;p&gt;å®ƒåŒæ ·æ˜¯ä¸€ä¸ªå¸¦æœ‰æ•ˆç›Šæƒè¡¡æ€§è´¨çš„ä¼˜åŒ–ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒå¹¶ä¸ä¸€å®šæ€»æ˜¯å¯¹ç¨‹åºè¿è¡Œæœ‰åˆ©ï¼Œå¦‚æœç¨‹åºä¸­&lt;strong&gt;å¤§å¤šæ•°çš„é”æ€»æ˜¯è¢«å¤šä¸ªä¸åŒçš„çº¿ç¨‹è®¿é—®&lt;/strong&gt;æ¯”å¦‚&lt;strong&gt;çº¿ç¨‹æ± &lt;/strong&gt;ï¼Œé‚£åå‘æ¨¡å¼å°±æ˜¯å¤šä½™çš„ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ JDK5 ä¸­åå‘é”é»˜è®¤æ˜¯å…³é—­çš„ï¼Œè€Œåˆ°äº† JDK6 ä¸­åå‘é”å·²ç»é»˜è®¤å¼€å¯ã€‚ä½†åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨å‡ ç§’é’Ÿä¹‹åæ‰æ¿€æ´»ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code&gt;-XX:BiasedLockingStartupDelay=0&lt;/code&gt; å‚æ•°å…³é—­å»¶è¿Ÿï¼Œå¦‚æœç¡®å®šåº”ç”¨ç¨‹åºä¸­æ‰€æœ‰é”é€šå¸¸æƒ…å†µä¸‹å¤„äºç«äº‰çŠ¶æ€ï¼Œå¯ä»¥é€šè¿‡ &lt;code&gt;XX:-UseBiasedLocking=false&lt;/code&gt; å‚æ•°å…³é—­åå‘é”ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å°ç»“-14&#34;&gt;å°ç»“&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;åå‘é”çš„åŸç†æ˜¯ä»€ä¹ˆ?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å½“é”å¯¹è±¡ç¬¬ä¸€æ¬¡è¢«çº¿ç¨‹è·å–çš„æ—¶å€™ï¼Œè™šæ‹Ÿæœºå°†ä¼šæŠŠå¯¹è±¡å¤´ä¸­çš„æ ‡å¿—ä½è®¾ä¸ºâ€œ01â€ï¼Œåå‘é”è®¾ç½®ä¸ºâ€œ1â€ï¼Œå³åå‘æ¨¡å¼ã€‚åŒæ—¶ä½¿ç”¨CASæ“ä½œæŠŠè·å–åˆ°è¿™ä¸ªé”çš„çº¿ç¨‹çš„IDè®°å½•åœ¨å¯¹è±¡çš„Mark Wordä¹‹ä¸­ ï¼Œå¦‚æœCASæ“ä½œæˆåŠŸï¼ŒæŒæœ‰åå‘é”çš„çº¿ç¨‹ä»¥åæ¯æ¬¡è¿›å…¥è¿™ä¸ªé”ç›¸å…³çš„åŒæ­¥å—æ—¶ï¼Œè™šæ‹Ÿæœºéƒ½å¯ä»¥ä¸å†è¿›è¡Œä»»ä½•åŒæ­¥æ“ä½œï¼Œåå‘é”çš„æ•ˆç‡é«˜ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åå‘é”çš„å¥½å¤„æ˜¯ä»€ä¹ˆ?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åå‘é”æ˜¯åœ¨åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡ŒåŒæ­¥å—æ—¶è¿›ä¸€æ­¥æé«˜æ€§èƒ½ï¼Œé€‚ç”¨äº&lt;strong&gt;ä¸€ä¸ªçº¿ç¨‹åå¤è·å¾—åŒä¸€é”&lt;/strong&gt;çš„æƒ…å†µã€‚åå‘é”å¯ä»¥æé«˜å¸¦æœ‰åŒæ­¥ä½†æ— ç«äº‰çš„ç¨‹åºæ€§èƒ½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è½»é‡çº§é”&#34;&gt;è½»é‡çº§é”&lt;/h2&gt;
&lt;p&gt;è½»é‡çº§é”æ˜¯ JDK6 ä¹‹ä¸­åŠ å…¥çš„æ–°å‹é”æœºåˆ¶ï¼Œå®ƒåå­—ä¸­çš„â€œè½»é‡çº§â€æ˜¯ç›¸å¯¹äºä½¿ç”¨ monitor çš„ä¼ ç»Ÿé”è€Œè¨€çš„ï¼Œå› æ­¤ä¼ ç»Ÿçš„é”æœºåˆ¶å°±ç§°ä¸ºâ€œé‡é‡çº§â€é”ã€‚é¦–å…ˆéœ€è¦å¼ºè°ƒä¸€ç‚¹çš„æ˜¯ï¼Œè½»é‡çº§é”å¹¶ä¸æ˜¯ç”¨æ¥ä»£æ›¿é‡é‡çº§é”çš„ã€‚&lt;/p&gt;
&lt;p&gt;å¼•å…¥è½»é‡çº§é”çš„ç›®çš„ï¼šåœ¨&lt;strong&gt;å¤šçº¿ç¨‹äº¤æ›¿æ‰§è¡ŒåŒæ­¥å—&lt;/strong&gt;çš„æƒ…å†µä¸‹ï¼Œå°½é‡é¿å…é‡é‡çº§é”å¼•èµ·çš„æ€§èƒ½æ¶ˆè€—ï¼Œä½†æ˜¯å¦‚æœå¤šä¸ªçº¿ç¨‹åœ¨åŒä¸€æ—¶åˆ»è¿›å…¥ä¸´ç•ŒåŒºï¼Œä¼šå¯¼è‡´è½»é‡çº§é”è†¨èƒ€å‡çº§é‡é‡çº§é”ï¼Œæ‰€ä»¥è½»é‡çº§é”çš„å‡ºç°å¹¶éæ˜¯è¦æ›¿ä»£é‡é‡çº§é”ã€‚&lt;/p&gt;
&lt;h3 id=&#34;è½»é‡çº§é”åŸç†&#34;&gt;è½»é‡çº§é”åŸç†&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;27&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%BD%BB%E9%87%8F%E7%BA%A7%E9%94%81%E5%8E%9F%E7%90%86.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;å½“å…³é—­åå‘é”åŠŸèƒ½æˆ–è€…å¤šä¸ªçº¿ç¨‹ç«äº‰åå‘é”å¯¼è‡´åå‘é”å‡çº§ä¸ºè½»é‡çº§é”ï¼Œåˆ™ä¼šå°è¯•è·å–è½»é‡çº§é”ï¼Œå…¶æ­¥éª¤å¦‚ä¸‹ï¼š è·å–é”&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åˆ¤æ–­å½“å‰å¯¹è±¡æ˜¯å¦å¤„äºæ— é”çŠ¶æ€ï¼ˆhashcodeã€0ã€01ï¼‰ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ JVM é¦–å…ˆå°†åœ¨å½“å‰çº¿ç¨‹çš„&lt;strong&gt;æ ˆå¸§&lt;/strong&gt;ä¸­å»ºç«‹ä¸€ä¸ªåä¸º&lt;strong&gt;é”è®°å½•&lt;/strong&gt;ï¼ˆLock Recordï¼‰çš„ç©ºé—´ï¼Œç”¨äºå­˜å‚¨&lt;strong&gt;é”å¯¹è±¡ç›®å‰çš„ Mark Word çš„æ‹·è´&lt;/strong&gt;ï¼ˆå®˜æ–¹æŠŠè¿™ä»½æ‹·è´åŠ äº†ä¸€ä¸ª Displaced å‰ç¼€ï¼Œå³ Displaced Mark Wordï¼‰ï¼Œå°†å¯¹è±¡çš„ Mark Word å¤åˆ¶åˆ°æ ˆå¸§ä¸­çš„ Lock Record ä¸­ï¼Œå°† Lock Reocrd ä¸­çš„ owner æŒ‡å‘å½“å‰å¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;JVM åˆ©ç”¨ CAS æ“ä½œå°è¯•&lt;strong&gt;å°†å¯¹è±¡çš„ Mark Word æ›´æ–°ä¸ºæŒ‡å‘ Lock Record çš„æŒ‡é’ˆ&lt;/strong&gt;ï¼Œå¦‚æœ&lt;strong&gt;æˆåŠŸ&lt;/strong&gt;è¡¨ç¤º&lt;strong&gt;ç«äº‰åˆ°é”&lt;/strong&gt;ï¼Œåˆ™å°†é”æ ‡å¿—ä½å˜æˆ 00ï¼Œæ‰§è¡ŒåŒæ­¥æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœå¤±è´¥åˆ™&lt;strong&gt;åˆ¤æ–­å½“å‰å¯¹è±¡çš„ Mark Word æ˜¯å¦æŒ‡å‘å½“å‰çº¿ç¨‹çš„æ ˆå¸§&lt;/strong&gt;ï¼Œå¦‚æœæ˜¯åˆ™è¡¨ç¤ºå½“å‰çº¿ç¨‹å·²ç»æŒæœ‰å½“å‰å¯¹è±¡çš„é”ï¼Œåˆ™ç›´æ¥æ‰§è¡ŒåŒæ­¥ä»£ç å—ï¼›å¦åˆ™åªèƒ½è¯´æ˜è¯¥é”å¯¹è±¡å·²ç»è¢«å…¶ä»–çº¿ç¨‹æŠ¢å äº†ï¼Œè¿™æ—¶è½»é‡çº§é”éœ€è¦è†¨èƒ€ä¸ºé‡é‡çº§é”ï¼Œé”æ ‡å¿—ä½å˜æˆ 10ï¼Œåé¢ç­‰å¾…çš„çº¿ç¨‹å°†ä¼šè¿›å…¥é˜»å¡çŠ¶æ€ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%BD%BB%E9%87%8F%E7%BA%A7%E9%94%81CAS%E6%93%8D%E4%BD%9C%E4%B9%8B%E5%89%8D%E5%A0%86%E6%A0%88%E4%B8%8E%E5%AF%B9%E8%B1%A1%E7%9A%84%E7%8A%B6%E6%80%81.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%BD%BB%E9%87%8F%E7%BA%A7%E9%94%81CAS%E6%93%8D%E4%BD%9C%E4%B9%8B%E5%90%8E%E5%A0%86%E6%A0%88%E4%B8%8E%E5%AF%B9%E8%B1%A1%E7%9A%84%E7%8A%B6%E6%80%81.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;è½»é‡çº§é”çš„é‡Šæ”¾&#34;&gt;è½»é‡çº§é”çš„é‡Šæ”¾&lt;/h3&gt;
&lt;p&gt;è½»é‡çº§é”çš„é‡Šæ”¾ä¹Ÿæ˜¯é€šè¿‡ CAS æ“ä½œæ¥è¿›è¡Œçš„ï¼Œä¸»è¦æ­¥éª¤å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å–å‡ºåœ¨è·å–è½»é‡çº§é”ä¿å­˜åœ¨ Displaced Mark Word ä¸­çš„æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;ç”¨ CAS æ“ä½œå°†å–å‡ºçš„æ•°æ®æ›¿æ¢å½“å‰å¯¹è±¡çš„ Mark Word ä¸­ï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™è¯´æ˜é‡Šæ”¾é”æˆåŠŸã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœ CAS æ“ä½œæ›¿æ¢å¤±è´¥ï¼Œè¯´æ˜æœ‰å…¶ä»–çº¿ç¨‹å°è¯•è·å–è¯¥é”ï¼Œåˆ™éœ€è¦å°†è½»é‡çº§é”éœ€è¦è†¨èƒ€å‡çº§ä¸ºé‡é‡çº§é”ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¯¹äºè½»é‡çº§é”ï¼Œå…¶æ€§èƒ½æå‡çš„ä¾æ®æ˜¯â€œå¯¹äºç»å¤§éƒ¨åˆ†çš„é”ï¼Œ&lt;strong&gt;åœ¨æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…éƒ½æ˜¯ä¸ä¼šå­˜åœ¨ç«äº‰çš„&lt;/strong&gt;â€ï¼Œå¦‚æœæ‰“ç ´è¿™ä¸ªä¾æ®åˆ™é™¤äº†äº’æ–¥çš„å¼€é”€å¤–ï¼Œè¿˜æœ‰é¢å¤–çš„ CAS æ“ä½œï¼Œå› æ­¤åœ¨æœ‰å¤šçº¿ç¨‹ç«äº‰çš„æƒ…å†µä¸‹ï¼Œè½»é‡çº§é”æ¯”é‡é‡çº§é”æ›´æ…¢ã€‚&lt;/p&gt;
&lt;h3 id=&#34;è½»é‡çº§é”å¥½å¤„&#34;&gt;è½»é‡çº§é”å¥½å¤„&lt;/h3&gt;
&lt;p&gt;åœ¨å¤šçº¿ç¨‹&lt;strong&gt;äº¤æ›¿&lt;/strong&gt;æ‰§è¡ŒåŒæ­¥å—çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥é¿å…é‡é‡çº§é”å¼•èµ·çš„æ€§èƒ½æ¶ˆè€—ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å°ç»“-15&#34;&gt;å°ç»“&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;è½»é‡çº§é”çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å°†å¯¹è±¡çš„ Mark Word å¤åˆ¶åˆ°æ ˆå¸§ä¸­çš„ Lock Recod ä¸­ã€‚Mark Word æ›´æ–°ä¸ºæŒ‡å‘ Lock Record çš„æŒ‡é’ˆã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è½»é‡çº§é”å¥½å¤„æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åœ¨å¤šçº¿ç¨‹äº¤æ›¿æ‰§è¡ŒåŒæ­¥å—çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥é¿å…é‡é‡çº§é”å¼•èµ·çš„æ€§èƒ½æ¶ˆè€—ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è‡ªæ—‹é”&#34;&gt;è‡ªæ—‹é”&lt;/h2&gt;
&lt;h3 id=&#34;è‡ªæ—‹é”åŸç†&#34;&gt;è‡ªæ—‹é”åŸç†&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;synchronized (Demo01.class) {
  ...
  System.out.println(&amp;quot;aaa&amp;quot;);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å‰é¢æˆ‘ä»¬è®¨è®º monitor å®ç°é”çš„æ—¶å€™ï¼ŒçŸ¥é“monitorä¼šé˜»å¡å’Œå”¤é†’çº¿ç¨‹ï¼Œçº¿ç¨‹çš„é˜»å¡å’Œå”¤é†’éœ€è¦CPUä»ç”¨æˆ·æ€è½¬ä¸ºæ ¸å¿ƒæ€ï¼Œ&lt;strong&gt;é¢‘ç¹çš„é˜»å¡å’Œå”¤é†’å¯¹CPUæ¥è¯´æ˜¯ä¸€ä»¶è´Ÿæ‹…å¾ˆé‡çš„å·¥ä½œ&lt;/strong&gt;ï¼Œè¿™äº›æ“ä½œç»™ç³»ç»Ÿçš„å¹¶å‘æ€§èƒ½å¸¦æ¥äº†å¾ˆå¤§çš„å‹åŠ›ã€‚åŒæ—¶ï¼Œè™šæ‹Ÿæœºçš„å¼€å‘å›¢é˜Ÿä¹Ÿæ³¨æ„åˆ°åœ¨è®¸å¤šåº”ç”¨ä¸Šï¼Œ&lt;strong&gt;å…±äº«æ•°æ®çš„é”å®šçŠ¶æ€åªä¼šæŒç»­å¾ˆçŸ­çš„ä¸€æ®µæ—¶é—´&lt;/strong&gt;ï¼Œä¸ºäº†è¿™æ®µæ—¶é—´é˜»å¡å’Œå”¤é†’çº¿ç¨‹å¹¶ä¸å€¼å¾—ã€‚å¦‚æœç‰©ç†æœºå™¨æœ‰ä¸€ä¸ªä»¥ä¸Šçš„å¤„ç†å™¨ï¼Œèƒ½è®©ä¸¤ä¸ªæˆ–ä»¥ä¸Šçš„çº¿ç¨‹åŒæ—¶å¹¶è¡Œæ‰§è¡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥è®©åé¢è¯·æ±‚é”çš„é‚£ä¸ªçº¿ç¨‹â€œç¨ç­‰ä¸€ä¸‹â€ï¼Œä½†ä¸æ”¾å¼ƒå¤„ç†å™¨çš„æ‰§è¡Œæ—¶é—´ï¼Œçœ‹çœ‹æŒæœ‰é”çš„çº¿ç¨‹æ˜¯å¦å¾ˆå¿«å°±ä¼šé‡Šæ”¾é”ã€‚ä¸ºäº†è®©çº¿ç¨‹ç­‰å¾…ï¼Œæˆ‘ä»¬åªéœ€è®©çº¿ç¨‹æ‰§è¡Œä¸€ä¸ª&lt;strong&gt;å¿™å¾ªç¯(è‡ªæ—‹) ,&lt;/strong&gt; è¿™é¡¹æŠ€æœ¯å°±æ˜¯æ‰€è°“çš„&lt;strong&gt;è‡ªæ—‹é”&lt;/strong&gt;ã€‚&lt;br&gt;
è‡ªæ—‹é”åœ¨ JDK1.4.2 ä¸­å°±å·²ç»å¼•å…¥ ï¼Œåªä¸è¿‡é»˜è®¤æ˜¯å…³é—­çš„ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code&gt;-XX:+UseSpinning&lt;/code&gt; å‚æ•°å¼€å¯ï¼Œåœ¨ JDK6 ä¸­å°±å·²ç»æ”¹ä¸ºé»˜è®¤å¼€å¯äº†ã€‚è‡ªæ—‹ç­‰å¾…ä¸èƒ½ä»£æ›¿é˜»å¡ï¼Œä¸”å…ˆä¸è¯´å¯¹å¤„ç†å™¨æ•°é‡çš„è¦æ±‚ï¼Œè‡ªæ—‹ç­‰å¾…æœ¬èº«è™½ç„¶é¿å…äº†çº¿ç¨‹åˆ‡æ¢çš„å¼€é”€ï¼Œä½†å®ƒæ˜¯è¦å ç”¨å¤„ç†å™¨æ—¶é—´çš„ï¼Œå› æ­¤ï¼Œ&lt;strong&gt;å¦‚æœé”è¢«å ç”¨çš„æ—¶é—´å¾ˆçŸ­ï¼Œè‡ªæ—‹ç­‰å¾…çš„æ•ˆæœå°±ä¼šéå¸¸å¥½&lt;/strong&gt;ï¼Œåä¹‹ï¼Œå¦‚æœé”è¢«å ç”¨çš„æ—¶é—´å¾ˆé•¿ã€‚é‚£ä¹ˆè‡ªæ—‹çš„çº¿ç¨‹åªä¼šç™½ç™½æ¶ˆè€—å¤„ç†å™¨èµ„æºï¼Œè€Œä¸ä¼šåšä»»ä½•æœ‰ç”¨çš„å·¥ä½œï¼Œåè€Œä¼šå¸¦æ¥æ€§èƒ½ä¸Šçš„æµªè´¹ã€‚å› æ­¤ï¼Œè‡ªæ—‹ç­‰å¾…çš„æ—¶é—´å¿…é¡»è¦æœ‰ä¸€å®šçš„é™åº¦ï¼Œå¦‚æœåœ¨å¤šçº¿ç¨‹äº¤æ›¿æ‰§è¡ŒåŒæ­¥å—çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥é¿å…é‡é‡çº§é”å¼•èµ·çš„æ€§èƒ½æ¶ˆè€—ã€‚è‡ªæ—‹è¶…è¿‡äº†é™å®šçš„æ¬¡æ•°ä»ç„¶æ²¡æœ‰æˆåŠŸè·å¾—é”ï¼Œå°±åº”å½“ä½¿ç”¨ä¼ ç»Ÿçš„æ–¹å¼å»æŒ‚èµ·çº¿ç¨‹äº†ã€‚è‡ªæ—‹æ¬¡æ•°çš„é»˜è®¤å€¼æ˜¯10æ¬¡ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨å‚æ•° &lt;code&gt;-XX:PreBlockSpin&lt;/code&gt;æ¥æ›´æ”¹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;é€‚åº”æ€§è‡ªæ—‹é”&#34;&gt;é€‚åº”æ€§è‡ªæ—‹é”&lt;/h3&gt;
&lt;p&gt;åœ¨ JDK6 ä¸­å¼•å…¥äº†è‡ªé€‚åº”çš„è‡ªæ—‹é”ã€‚è‡ªé€‚åº”æ„å‘³ç€è‡ªæ—‹çš„æ—¶é—´ä¸å†å›ºå®šäº†ï¼Œè€Œæ˜¯&lt;strong&gt;ç”±å‰ä¸€æ¬¡åœ¨åŒä¸€ä¸ªé”ä¸Šçš„è‡ªæ—‹æ—¶é—´åŠé”çš„æ‹¥æœ‰è€…çš„çŠ¶æ€æ¥å†³å®š&lt;/strong&gt;ã€‚å¦‚æœåœ¨åŒä¸€ä¸ªé”å¯¹è±¡ä¸Šï¼Œè‡ªæ—‹ç­‰å¾…åˆšåˆšæˆåŠŸè·å¾—è¿‡é”ï¼Œå¹¶ä¸”æŒæœ‰é”çš„çº¿ç¨‹æ­£åœ¨è¿è¡Œä¸­ï¼Œé‚£ä¹ˆè™šæ‹Ÿæœºå°±ä¼šè®¤ä¸ºè¿™æ¬¡è‡ªæ—‹ä¹Ÿå¾ˆæœ‰å¯èƒ½å†æ¬¡æˆåŠŸï¼Œè¿›è€Œå®ƒå°†å…è®¸è‡ªæ—‹ç­‰å¾…æŒç»­ç›¸å¯¹æ›´é•¿çš„æ—¶é—´ï¼Œæ¯”å¦‚100æ¬¡å¾ªç¯ã€‚å¦å¤–ï¼Œå¦‚æœå¯¹äºæŸä¸ªé”ï¼Œè‡ªæ—‹å¾ˆå°‘æˆåŠŸè·å¾—è¿‡ï¼Œé‚£åœ¨ä»¥åè¦è·å–è¿™ä¸ªé”æ—¶å°†å¯èƒ½çœç•¥æ‰è‡ªæ—‹è¿‡ç¨‹ï¼Œä»¥é¿å…æµªè´¹å¤„ç†å™¨èµ„æºã€‚æœ‰äº†è‡ªé€‚åº”è‡ªæ—‹ï¼Œéšç€ç¨‹åºè¿è¡Œå’Œæ€§èƒ½ç›‘æ§ä¿¡æ¯çš„ä¸æ–­å®Œå–„ï¼Œè™šæ‹Ÿæœºå¯¹ç¨‹åºé”çš„çŠ¶å†µé¢„æµ‹å°±ä¼šè¶Šæ¥è¶Šå‡†ç¡®ï¼Œè™›æ‹Ÿæœºå°±ä¼šå˜å¾—è¶Šæ¥è¶Šâ€œèªæ˜â€äº†ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;int ObjectMonitor::TrySpin_VaryDuration (Thread * Self) {

    // Dumb, brutal spin.  Good for comparative measurements against adaptive spinning.
    // å›ºå®šæ¬¡æ•°çš„è‡ªæ—‹é”
    int ctr = Knob_FixedSpin ;
    if (ctr != 0) {
        while (--ctr &amp;gt;= 0) {
            if (TryLock (Self) &amp;gt; 0) return 1 ;
            SpinPause () ;
        }
        return 0 ;
    }
    // é€‚åº”æ€§è‡ªæ—‹é”
    for (ctr = Knob_PreSpin + 1; --ctr &amp;gt;= 0 ; ) {
      // å¦‚æœæŠ¢åˆ°äº†é”
      if (TryLock(Self) &amp;gt; 0) {
        // Increase _SpinDuration ...
        // Note that we don&#39;t clamp SpinDuration precisely at SpinLimit.
        // Raising _SpurDuration to the poverty line is key.
        int x = _SpinDuration ;
        if (x &amp;lt; Knob_SpinLimit) {
           if (x &amp;lt; Knob_Poverty) x = Knob_Poverty ;
           // ä¿®æ”¹è‡ªæ—‹æ—¶é—´
           _SpinDuration = x + Knob_BonusB ;
        }
        return 1 ;
      }
      SpinPause () ;
    }

    // çœç•¥éƒ¨åˆ†ä»£ç 
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;é”æ¶ˆé™¤&#34;&gt;é”æ¶ˆé™¤&lt;/h2&gt;
&lt;p&gt;é”æ¶ˆé™¤æ˜¯æŒ‡è™šæ‹Ÿæœºå³æ—¶ç¼–è¯‘å™¨ï¼ˆJITï¼‰åœ¨è¿è¡Œæ—¶ï¼Œå¯¹&lt;strong&gt;ä¸€äº›ä»£ç ä¸Šè¦æ±‚åŒæ­¥ï¼Œä½†æ˜¯è¢«æ£€æµ‹åˆ°ä¸å¯èƒ½å­˜åœ¨å…±äº«æ•°æ®ç«äº‰çš„é”&lt;/strong&gt;è¿›è¡Œæ¶ˆé™¤ã€‚é”æ¶ˆé™¤çš„ä¸»è¦åˆ¤å®šä¾æ®æ¥æºäºé€ƒé€¸åˆ†æçš„æ•°æ®æ”¯æŒï¼Œå¦‚æœåˆ¤æ–­åœ¨ä¸€æ®µä»£ç ä¸­ï¼Œ&lt;strong&gt;å †ä¸Šçš„æ‰€æœ‰æ•°æ®éƒ½ä¸ä¼šé€ƒé€¸å‡ºå»ä»è€Œè¢«å…¶ä»–çº¿ç¨‹è®¿é—®åˆ°ï¼Œé‚£å°±å¯ä»¥æŠŠå®ƒä»¬å½“åšæ ˆä¸Šæ•°æ®å¯¹å¾…ï¼Œè®¤ä¸ºå®ƒä»¬æ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼ŒåŒæ­¥åŠ é”è‡ªç„¶å°±æ— é¡»è¿›è¡Œ&lt;/strong&gt;ã€‚å˜é‡æ˜¯å¦é€ƒé€¸ï¼Œå¯¹äºè™šæ‹Ÿæœºæ¥è¯´éœ€è¦ä½¿ç”¨æ•°æ®æµåˆ†ææ¥ç¡®å®šï¼Œä½†æ˜¯ç¨‹åºå‘˜è‡ªå·±åº”è¯¥æ˜¯å¾ˆæ¸…æ¥šçš„ï¼Œæ€ä¹ˆä¼šåœ¨æ˜çŸ¥é“ä¸å­˜åœ¨æ•°æ®äº‰ç”¨çš„æƒ…å†µä¸‹è¦æ±‚åŒæ­¥å‘¢?å®é™…ä¸Šæœ‰è®¸å¤šåŒæ­¥æªæ–½å¹¶ä¸æ˜¯ç¨‹åºå‘˜è‡ªå·±åŠ å…¥çš„ï¼ŒåŒæ­¥çš„ä»£ç åœ¨Javaç¨‹åºä¸­çš„æ™®éç¨‹åº¦ä¹Ÿè®¸è¶…è¿‡äº†å¤§éƒ¨åˆ†è¯»è€…çš„æƒ³è±¡ã€‚ä¸‹é¢è¿™æ®µéå¸¸ç®€å•çš„ä»£ç ä»…ä»…æ˜¯è¾“å‡º3ä¸ªå­—ç¬¦ä¸²ç›¸åŠ çš„ç»“æœï¼Œæ— è®ºæ˜¯æºç å­—é¢ä¸Šè¿˜æ˜¯ç¨‹åºè¯­ä¹‰ä¸Šéƒ½æ²¡æœ‰åŒæ­¥ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public class Demo01 {
    public static void main(String[] args) {
        contactString(&amp;quot;aa&amp;quot;, &amp;quot;bb&amp;quot;, &amp;quot;cc&amp;quot;);
    }

    public static String contactString(String s1, String s2, String s3) {
        return new StringBuffer().append(s1).append(s2).append(s3).toString();
    }
}
@Override
public synchronized StringBuffer append(String str) {
    toStringCache = null;
    super.append(str);
    return this;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;StringBuffffer çš„ append() æ˜¯ä¸€ä¸ªåŒæ­¥æ–¹æ³•ï¼Œé”å°±æ˜¯ this ä¹Ÿå°±æ˜¯(new StringBuilder())ã€‚è™šæ‹Ÿæœºå‘ç°å®ƒçš„åŠ¨æ€ä½œç”¨åŸŸè¢«é™åˆ¶åœ¨ concatString() æ–¹æ³•å†…éƒ¨ã€‚ä¹Ÿå°±æ˜¯è¯´, new StringBuilder()å¯¹è±¡çš„å¼•ç”¨æ°¸è¿œä¸ä¼šâ€œé€ƒé€¸â€åˆ° concatString() æ–¹æ³•ä¹‹å¤–ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•è®¿é—®åˆ°å®ƒï¼Œå› æ­¤ï¼Œè™½ç„¶è¿™é‡Œæœ‰é”ï¼Œä½†æ˜¯å¯ä»¥è¢«å®‰å…¨åœ°æ¶ˆé™¤æ‰ï¼Œåœ¨å³æ—¶ç¼–è¯‘ä¹‹åï¼Œè¿™æ®µä»£ç å°±ä¼šå¿½ç•¥æ‰æ‰€æœ‰çš„åŒæ­¥è€Œç›´æ¥æ‰§è¡Œäº†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;é”ç²—åŒ–&#34;&gt;é”ç²—åŒ–&lt;/h2&gt;
&lt;p&gt;åŸåˆ™ä¸Šï¼Œæˆ‘ä»¬åœ¨ç¼–å†™ä»£ç çš„æ—¶å€™ï¼Œæ€»æ˜¯æ¨èå°†åŒæ­¥å—çš„ä½œç”¨èŒƒå›´é™åˆ¶å¾—å°½é‡å°ï¼Œåªåœ¨å…±äº«æ•°æ®çš„å®é™…ä½œç”¨åŸŸä¸­æ‰è¿›è¡ŒåŒæ­¥ï¼Œè¿™æ ·æ˜¯ä¸ºäº†ä½¿å¾—éœ€è¦åŒæ­¥çš„æ“ä½œæ•°é‡å°½å¯èƒ½å˜å°ï¼Œå¦‚æœå­˜åœ¨é”ç«äº‰ï¼Œé‚£ç­‰å¾…é”çš„çº¿ç¨‹ä¹Ÿèƒ½å°½å¿«æ‹¿åˆ°é”ã€‚å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œä¸Šé¢çš„åŸåˆ™éƒ½æ˜¯æ­£ç¡®çš„ï¼Œä½†æ˜¯å¦‚æœä¸€ç³»åˆ—çš„è¿ç»­æ“ä½œéƒ½å¯¹&lt;strong&gt;åŒä¸€ä¸ªå¯¹è±¡åå¤åŠ é”å’Œè§£é”&lt;/strong&gt;ï¼Œç”šè‡³åŠ é”æ“ä½œæ˜¯å‡ºç°åœ¨å¾ªç¯ä½“ä¸­çš„ï¼Œé‚£å³ä½¿æ²¡æœ‰çº¿ç¨‹ç«äº‰ï¼Œé¢‘ç¹åœ°è¿›è¡Œäº’æ–¥åŒæ­¥æ“ä½œä¹Ÿä¼šå¯¼è‡´ä¸å¿…è¦çš„æ€§èƒ½æŸè€—ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public class Demo01 {
    public static void main(String[] args) {
        StringBuffer sb = new StringBuffer();
        for (int i = 0; i &amp;lt; 100; i++) {
            sb.append(&amp;quot;aa&amp;quot;);
        }
        System.out.println(sb.toString());
    }
}
@Override
public synchronized StringBuffer append(String str) {
    toStringCache = null;
    super.append(str);
    return this;
 }
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;28&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E9%94%81%E7%B2%97%E5%8C%96.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;å°ç»“-16&#34;&gt;å°ç»“&lt;/h3&gt;
&lt;p&gt;ä»€ä¹ˆæ˜¯é”ç²—åŒ–ï¼Ÿ&lt;/p&gt;
&lt;p&gt;JVMä¼šæ¢æµ‹åˆ°ä¸€è¿ä¸²ç»†å°çš„æ“ä½œéƒ½ä½¿ç”¨åŒä¸€ä¸ªå¯¹è±¡åŠ é”ï¼Œå°†åŒæ­¥ä»£ç å—çš„èŒƒå›´æ”¾å¤§ï¼Œæ”¾åˆ°è¿™ä¸²æ“ä½œçš„å¤–é¢ï¼Œè¿™æ ·åªéœ€è¦åŠ ä¸€æ¬¡é”å³å¯ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¹³æ—¶å†™ä»£ç å¦‚ä½•å¯¹synchronizedä¼˜åŒ–&#34;&gt;å¹³æ—¶å†™ä»£ç å¦‚ä½•å¯¹synchronizedä¼˜åŒ–&lt;/h2&gt;
&lt;h3 id=&#34;å‡å°‘-synchronized-çš„èŒƒå›´&#34;&gt;å‡å°‘ synchronized çš„èŒƒå›´&lt;/h3&gt;
&lt;p&gt;åŒæ­¥ä»£ç å—ä¸­å°½é‡çŸ­ï¼Œå‡å°‘åŒæ­¥ä»£ç å—ä¸­ä»£ç çš„æ‰§è¡Œæ—¶é—´ï¼Œå‡å°‘é”çš„ç«äº‰ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;synchronized (Demo01.class) {
    System.out.println(&amp;quot;aaa&amp;quot;);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;é™ä½synchronizedé”çš„ç²’åº¦&#34;&gt;é™ä½synchronizedé”çš„ç²’åº¦&lt;/h3&gt;
&lt;p&gt;å°†ä¸€ä¸ªé”æ‹†åˆ†ä¸ºå¤šä¸ªé”æé«˜å¹¶å‘åº¦&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Hashtable hs = new Hashtable(); 
hs.put(&amp;quot;aa&amp;quot;, &amp;quot;bb&amp;quot;); 
hs.put(&amp;quot;xx&amp;quot;, &amp;quot;yy&amp;quot;);
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;29&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Hashtable%E9%94%81%E5%AE%9A%E6%95%B4%E4%B8%AA%E5%93%88%E5%B8%8C%E8%A1%A8.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;30&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/ConcurrentHashMap%E5%B1%80%E9%83%A8%E9%94%81%E5%AE%9A.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;31&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/LinkedBlockingQueue%E5%85%A5%E9%98%9F%E5%87%BA%E9%98%9F%E4%BD%BF%E7%94%A8%E4%B8%8D%E5%90%8C%E7%9A%84%E9%94%81.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;LinkedBlockingQueueå…¥é˜Ÿå’Œå‡ºé˜Ÿä½¿ç”¨ä¸åŒçš„é”ï¼Œç›¸å¯¹äºè¯»å†™åªæœ‰ä¸€ä¸ªé”æ•ˆç‡è¦é«˜&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;32&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/LinkedBlockingQueue%E5%85%A5%E9%98%9F%E5%87%BA%E9%98%9F%E4%BD%BF%E7%94%A8%E4%B8%8D%E5%90%8C%E7%9A%84%E9%94%812.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;è¯»å†™åˆ†ç¦»&#34;&gt;è¯»å†™åˆ†ç¦»&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;è¯»å–æ—¶ä¸åŠ é”ï¼Œå†™å…¥å’Œåˆ é™¤æ—¶åŠ é”&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ConcurrentHashMapï¼ŒCopyOnWriteArrayList å’Œ ConyOnWriteSet&lt;/p&gt;
">æ·±å…¥å­¦ä¹ å¹¶å‘ç¼–ç¨‹ä¸­çš„synchronized</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/leetcode-191-wei-1-de-ge-shu/"" data-c="
          &lt;h2 id=&#34;é—®é¢˜æè¿°&#34;&gt;é—®é¢˜æè¿°&lt;/h2&gt;
&lt;p&gt;ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥æ˜¯ä¸€ä¸ªæ— ç¬¦å·æ•´æ•°ï¼Œè¿”å›å…¶äºŒè¿›åˆ¶è¡¨è¾¾å¼ä¸­æ•°å­—ä½æ•°ä¸º â€˜1â€™ çš„ä¸ªæ•°ï¼ˆä¹Ÿè¢«ç§°ä¸ºæ±‰æ˜é‡é‡ï¼‰ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç¤ºä¾‹&#34;&gt;ç¤ºä¾‹&lt;/h2&gt;
&lt;p&gt;ç¤ºä¾‹ 1ï¼š&lt;br&gt;
è¾“å…¥ï¼š00000000000000000000000000001011&lt;br&gt;
è¾“å‡ºï¼š3&lt;br&gt;
è§£é‡Šï¼šè¾“å…¥çš„äºŒè¿›åˆ¶ä¸² 00000000000000000000000000001011Â ä¸­ï¼Œå…±æœ‰ä¸‰ä½ä¸º &#39;1&#39;ã€‚&lt;/p&gt;
&lt;p&gt;ç¤ºä¾‹ 2ï¼š&lt;br&gt;
è¾“å…¥ï¼š00000000000000000000000010000000&lt;br&gt;
è¾“å‡ºï¼š1&lt;br&gt;
è§£é‡Šï¼šè¾“å…¥çš„äºŒè¿›åˆ¶ä¸² 00000000000000000000000010000000Â ä¸­ï¼Œå…±æœ‰ä¸€ä½ä¸º &#39;1&#39;ã€‚&lt;/p&gt;
&lt;p&gt;ç¤ºä¾‹ 3ï¼š&lt;br&gt;
è¾“å…¥ï¼š11111111111111111111111111111101&lt;br&gt;
è¾“å‡ºï¼š31&lt;br&gt;
è§£é‡Šï¼šè¾“å…¥çš„äºŒè¿›åˆ¶ä¸² 11111111111111111111111111111101 ä¸­ï¼Œå…±æœ‰ 31 ä½ä¸º &#39;1&#39;ã€‚&lt;/p&gt;
&lt;p&gt;æç¤ºï¼š&lt;br&gt;
è¯·æ³¨æ„ï¼Œåœ¨æŸäº›è¯­è¨€ï¼ˆå¦‚ Javaï¼‰ä¸­ï¼Œæ²¡æœ‰æ— ç¬¦å·æ•´æ•°ç±»å‹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¾“å…¥å’Œè¾“å‡ºéƒ½å°†è¢«æŒ‡å®šä¸ºæœ‰ç¬¦å·æ•´æ•°ç±»å‹ï¼Œå¹¶ä¸”ä¸åº”å½±å“æ‚¨çš„å®ç°ï¼Œå› ä¸ºæ— è®ºæ•´æ•°æ˜¯æœ‰ç¬¦å·çš„è¿˜æ˜¯æ— ç¬¦å·çš„ï¼Œå…¶å†…éƒ¨çš„äºŒè¿›åˆ¶è¡¨ç¤ºå½¢å¼éƒ½æ˜¯ç›¸åŒçš„ã€‚&lt;br&gt;
åœ¨ Java ä¸­ï¼Œç¼–è¯‘å™¨ä½¿ç”¨äºŒè¿›åˆ¶è¡¥ç è®°æ³•æ¥è¡¨ç¤ºæœ‰ç¬¦å·æ•´æ•°ã€‚å› æ­¤ï¼Œåœ¨ä¸Šé¢çš„Â ç¤ºä¾‹ 3Â ä¸­ï¼Œè¾“å…¥è¡¨ç¤ºæœ‰ç¬¦å·æ•´æ•° -3ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ–¹æ³•ä¸€&#34;&gt;æ–¹æ³•ä¸€&lt;/h2&gt;
&lt;h3 id=&#34;åˆ†æ&#34;&gt;åˆ†æ&lt;/h3&gt;
&lt;p&gt;åˆ©ç”¨ä¸è¿ç®—&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;0 &amp;amp; 0 = 0
0 &amp;amp; 1 = 0
1 &amp;amp; 0 = 0
1 &amp;amp; 1 = 1
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ‘ä»¬å‘ç°ï¼Œ1 ä¸ ä»»ä½•æ•°ç›¸ä¸ï¼Œç»“æœä¸ºä»»ä½•æ•°ã€‚äºæ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ€§è´¨ï¼Œé¦–å…ˆåˆå§‹åŒ– count = 0ï¼Œ&lt;strong&gt;å°†äºŒè¿›åˆ¶è¡¨è¾¾å¼ä¸­çš„æ¯ä¸€ä½æ•°å­—ä¾æ¬¡ä¸ 1 è¿›è¡Œä¸è¿ç®—&lt;/strong&gt;ï¼Œå¦‚æœç»“æœä¸º 1ï¼Œå°±ä»£è¡¨æ­¤ä½äºŒè¿›åˆ¶æ•°ä¸º 1ï¼Œcount++ï¼›å¦‚æœç»“æœä¸º 0ï¼Œå°±ä»£è¡¨æ­¤ä½äºŒè¿›åˆ¶æ•°ä¸º 0ã€‚æœ€ç»ˆè¿”å› count å€¼å³ä¸ºäºŒè¿›åˆ¶è¡¨è¾¾å¼ä¸­æ•°å­—ä½æ•°ä¸º â€˜1â€™ çš„ä¸ªæ•°ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å®ä¾‹åˆ†æ&#34;&gt;å®ä¾‹åˆ†æ&lt;/h3&gt;
&lt;p&gt;è¾“å…¥ï¼š00000000000000000000000000001011&lt;br&gt;
è¾“å‡ºï¼š3&lt;br&gt;
è§£é‡Šï¼šè¾“å…¥çš„äºŒè¿›åˆ¶ä¸² 00000000000000000000000000001011Â ä¸­ï¼Œå…±æœ‰ä¸‰ä½ä¸º &#39;1&#39;ã€‚&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/leetcode191_1.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/leetcode191_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/leetcode191_3.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/leetcode191_4.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;ä»£ç &#34;&gt;ä»£ç &lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;public class Solution {
    // you need to treat n as an unsigned value
    public int hammingWeight(int n) {
        // å­—ç¬¦ &#39;1&#39; çš„ä¸ªæ•° count åˆå§‹åŒ–ä¸º 0
        int count = 0;
        // åˆå§‹åŒ–æ©ç ä¸º 1
        int mark = 1;
        // å¾ªç¯ç›´è‡³æ©ç å·¦ç§» 32 ä¸ºåä¸º 0
        while(mark != 0){
            // å°†æ•°å­— n çš„äºŒè¿›åˆ¶è¡¨è¾¾å¼ä¸­æ¯ä¸€ä½æ•°å­—ä¾æ¬¡ä¸ 1 è¿›è¡Œä¸è¿ç®—
            if((n &amp;amp; mark) != 0){ // å¦‚æœç»“æœä¸ä¸º0ï¼Œè¡¨ç¤ºæ­¤ä½ä¸º 1
                count ++;
            }
            // æ©ç å·¦ç§»ï¼Œè®©å‰ä¸€ä½å¯¹åº”çš„æ•°å­—ä¸ 1 è¿›è¡Œä¸è¿ç®—
            mark &amp;lt;&amp;lt;= 1;
        }
        return count;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;å¤æ‚åº¦åˆ†æ&#34;&gt;å¤æ‚åº¦åˆ†æ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;T = O(m)&lt;br&gt;
éå†æ¯ä¸€ä½äºŒè¿›åˆ¶ä½ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦ä¸º O(m)ï¼Œm ä¸ºäºŒè¿›åˆ¶ä½æ•°çš„ä¸ªæ•°&lt;/li&gt;
&lt;li&gt;S = O(1)&lt;br&gt;
æ²¡æœ‰ä½¿ç”¨é¢å¤–çš„ç©ºé—´ï¼Œæ‰€ä»¥ç©ºé—´å¤æ‚åº¦ä¸º O(1)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æ–¹æ³•äºŒ&#34;&gt;æ–¹æ³•äºŒ&lt;/h2&gt;
&lt;h3 id=&#34;å®ä¾‹åˆ†æ-2&#34;&gt;å®ä¾‹åˆ†æ&lt;/h3&gt;
&lt;p&gt;è¾“å…¥ï¼š00000000000000000000000000001011&lt;br&gt;
è¾“å‡ºï¼š3&lt;br&gt;
è§£é‡Šï¼šè¾“å…¥çš„äºŒè¿›åˆ¶ä¸² 00000000000000000000000000001011Â ä¸­ï¼Œå…±æœ‰ä¸‰ä½ä¸º &#39;1&#39;ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;n = 1011
n-1 = 1010
n &amp;amp; n-1 = 1010
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºæ•´æ•° n ï¼Œn &amp;amp; (n-1) çš„æ•ˆæœæ˜¯æŠŠ n çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸­æœ€ä½ä½çš„ 1 æ¶ˆé™¤ï¼Œæœ‰äº†è¿™ä¸ªç‰¹æ€§ï¼Œæˆ‘ä»¬å°±åªéœ€ä¸æ–­å»æ£€æŸ¥ n æ˜¯å¦ä¸º 0ï¼Œä¸ä¸º 0 æ—¶ï¼Œè®¡æ•°å™¨ + 1ï¼Œç„¶åæŠŠå®ƒæœ€ä½ä½çš„ 1 æ¶ˆé™¤ï¼Œè¿™æ ·å¾ªç¯æ“ä½œåï¼Œn æœ€åä¸€å®šä¼šå˜æˆ 0ï¼Œè€Œè®¡æ•°å™¨ä¸­ä¿å­˜çš„åˆ™æ˜¯æ•´æ•° n äºŒè¿›åˆ¶è¡¨ç¤ºä¸­ 1 çš„ä¸ªæ•° ã€‚&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/leetcode191_5.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/leetcode191_6.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/leetcode191_7.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;ä»£ç -2&#34;&gt;ä»£ç &lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;public class Solution {
    // you need to treat n as an unsigned value
    public int hammingWeight(int n) {
        int count = 0;
        while(n!= 0){
            ++count;
            n = n &amp;amp; (n-1);
        }
        return count;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;å¤æ‚åº¦&#34;&gt;å¤æ‚åº¦&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Tï¼šO(k)&lt;br&gt;
k è¡¨ç¤ºæ•´æ•°äºŒè¿›åˆ¶è¡¨ç¤ºä¸­ 1 çš„ä¸ªæ•°&lt;/li&gt;
&lt;li&gt;Sï¼šO(1)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æ¥æº&#34;&gt;æ¥æº&lt;/h2&gt;
&lt;p&gt;æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰&lt;br&gt;
é“¾æ¥ï¼š&lt;a href=&#34;https://leetcode-cn.com/problems/number-of-1-bits&#34;&gt;https://leetcode-cn.com/problems/number-of-1-bits&lt;/a&gt;&lt;/p&gt;
">leetcode191. ä½1çš„ä¸ªæ•°</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/redis-shao-bing/"" data-c="
          &lt;h1 id=&#34;å“¨å…µç®€ä»‹&#34;&gt;å“¨å…µç®€ä»‹&lt;/h1&gt;
&lt;h2 id=&#34;ä¸»æœºå®•æœº&#34;&gt;ä¸»æœºâ€œå®•æœºâ€&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E4%B8%BB%E6%9C%BA%E5%AE%95%E6%9C%BA.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;master å®•æœºï¼Œéœ€è¦é€‰å–ä¸€ä¸ª slave ä½œä¸º master&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;å°†å®•æœºçš„ master ä¸‹çº¿&lt;/li&gt;
&lt;li&gt;æ‰¾ä¸€ä¸ªslaveä½œä¸ºmaster&lt;/li&gt;
&lt;li&gt;é€šçŸ¥æ‰€æœ‰çš„ slave è¿æ¥æ–°çš„ master&lt;/li&gt;
&lt;li&gt;å¯åŠ¨æ–°çš„masterä¸slave&lt;/li&gt;
&lt;li&gt;å…¨é‡å¤åˆ¶&lt;em&gt;N+éƒ¨åˆ†å¤åˆ¶&lt;/em&gt;N&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%93%A8%E5%85%B5.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;è°æ¥ç¡®è®¤ master å®•æœºäº†&lt;/li&gt;
&lt;li&gt;æ‰¾ä¸€ä¸ªä¸»ï¼Ÿæ€ä¹ˆæ‰¾æ³•ï¼Ÿ&lt;/li&gt;
&lt;li&gt;ä¿®æ”¹é…ç½®åï¼ŒåŸå§‹çš„ä¸»æ¢å¤äº†æ€ä¹ˆåŠï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å“¨å…µ&#34;&gt;å“¨å…µ&lt;/h2&gt;
&lt;p&gt;å“¨å…µ(sentinel) æ˜¯ä¸€ä¸ª&lt;strong&gt;åˆ†å¸ƒå¼ç³»ç»Ÿ&lt;/strong&gt;ï¼Œç”¨äºå¯¹ä¸»ä»ç»“æ„ä¸­çš„æ¯å°æœåŠ¡å™¨è¿›è¡Œ&lt;strong&gt;ç›‘æ§&lt;/strong&gt;ï¼Œå½“å‡ºç°æ•…éšœæ—¶é€šè¿‡&lt;strong&gt;æŠ•ç¥¨&lt;/strong&gt;æœºåˆ¶é€‰æ‹©æ–°çš„ masterå¹¶å°†æ‰€æœ‰slaveè¿æ¥åˆ°æ–°çš„masterã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E4%B8%AD%E7%9A%84%E5%93%A8%E5%85%B5.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;å“¨å…µçš„ä½œç”¨&#34;&gt;å“¨å…µçš„ä½œç”¨&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ç›‘æ§
&lt;ul&gt;
&lt;li&gt;ä¸æ–­çš„æ£€æŸ¥masterå’Œslaveæ˜¯å¦æ­£å¸¸è¿è¡Œã€‚&lt;/li&gt;
&lt;li&gt;masterå­˜æ´»æ£€æµ‹ã€masterä¸slaveè¿è¡Œæƒ…å†µæ£€æµ‹&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é€šçŸ¥ï¼ˆæé†’ï¼‰
&lt;ul&gt;
&lt;li&gt;å½“è¢«ç›‘æ§çš„æœåŠ¡å™¨å‡ºç°é—®é¢˜æ—¶ï¼Œå‘å…¶ä»–ï¼ˆå“¨å…µé—´ï¼Œå®¢æˆ·ç«¯ï¼‰å‘é€é€šçŸ¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è‡ªåŠ¨æ•…éšœè½¬ç§»
&lt;ul&gt;
&lt;li&gt;æ–­å¼€masterä¸slaveè¿æ¥ï¼Œé€‰å–ä¸€ä¸ªslaveä½œä¸ºmasterï¼Œå°†å…¶ä»–slaveè¿æ¥åˆ°æ–°çš„masterï¼Œå¹¶å‘ŠçŸ¥å®¢æˆ·ç«¯æ–°çš„æœåŠ¡å™¨åœ°å€&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ³¨æ„ï¼š&lt;/p&gt;
&lt;p&gt;å“¨å…µä¹Ÿæ˜¯ä¸€å°&lt;strong&gt;redisæœåŠ¡å™¨&lt;/strong&gt;ï¼Œåªæ˜¯ä¸æä¾›æ•°æ®æœåŠ¡&lt;/p&gt;
&lt;p&gt;é€šå¸¸å“¨å…µé…ç½®æ•°é‡ä¸º&lt;strong&gt;å•æ•°&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&#34;å¯ç”¨å“¨å…µæ¨¡å¼&#34;&gt;å¯ç”¨å“¨å…µæ¨¡å¼&lt;/h1&gt;
&lt;h2 id=&#34;é…ç½®å“¨å…µ&#34;&gt;é…ç½®å“¨å…µ&lt;/h2&gt;
&lt;p&gt;æ¸…ç©º data ä¸‹æ•°æ®&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[root@iZ2ze4u2bufi0915gyi843Z data]# rm -rf *
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;é…ç½®ä¸€æ‹–äºŒçš„ä¸»ä»ç»“æ„&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;1-ä¸€ä¸ª-master&#34;&gt;1. ä¸€ä¸ª master&lt;/h3&gt;
&lt;p&gt;ï¼ˆ1ï¼‰é…ç½®æ–‡ä»¶&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[root@iZ2ze4u2bufi0915gyi843Z conf]# vim redis-6379.confÂ 
port 6379
daemonize no
#logfile &amp;quot;6379.log&amp;quot;
dir /root/redis-5.0.7/data
dbfilename dump-6379.rdb
rdbcompression yesÂ 
rdbchecksum yesÂ 
appendonly yes
appendfsync everysec
appendfilename appendonly-6379.aof
bind 127.0.0.1
databases 16
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ï¼ˆ2ï¼‰å¯åŠ¨master:6379 redis æœåŠ¡&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[root@iZ2ze4u2bufi0915gyi843Z conf]#Â redis-server redis-6379.conf
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;2-ä¸¤ä¸ª-slave&#34;&gt;2. ä¸¤ä¸ª slave&lt;/h3&gt;
&lt;p&gt;ï¼ˆ1ï¼‰é…ç½®æ–‡ä»¶&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[root@iZ2ze4u2bufi0915gyi843Z conf]# vim redis-6380.confÂ 
port 6380
daemonize no
#logfile &amp;quot;6379.log&amp;quot;
dir &amp;quot;/root/redis-5.0.7/data&amp;quot;
replicaof 127.0.0.1 6379
[root@iZ2ze4u2bufi0915gyi843Z conf]# vim redis-6381.confÂ 
port 6381
daemonize no
#logfile &amp;quot;6379.log&amp;quot;
dir &amp;quot;/root/redis-5.0.7/data&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ï¼ˆ2ï¼‰å¯åŠ¨ slave:6380ã€slave:6381 æœåŠ¡&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[root@iZ2ze4u2bufi0915gyi843Z conf]#Â redis-server redis-6380.conf
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;[root@iZ2ze4u2bufi0915gyi843Z conf]# redis-server redis-6381.conf
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;é…ç½®ä¸‰ä¸ªå“¨å…µé…ç½®ç›¸åŒç«¯å£ä¸åŒ&#34;&gt;é…ç½®ä¸‰ä¸ªå“¨å…µï¼ˆé…ç½®ç›¸åŒï¼Œç«¯å£ä¸åŒï¼‰&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å‚çœ‹sentinel.conf&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ï¼ˆ1ï¼‰æŸ¥çœ‹ sentinel.conf é…ç½®æ–‡ä»¶&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[root@iZ2ze4u2bufi0915gyi843Z redis-5.0.7]# cat sentinel.conf | grep -v &amp;quot;#&amp;quot; | grep -v &amp;quot;^$&amp;quot; // è¿‡æ»¤åˆ°æ³¨é‡Šå’Œç©ºè¡Œ
port 26379
daemonize no
pidfile /var/run/redis-sentinel.pid
logfile &amp;quot;&amp;quot;
dir /tmp
sentinel monitor mymaster 127.0.0.1 6379 2
sentinel down-after-milliseconds mymaster 30000
sentinel parallel-syncs mymaster 1
sentinel failover-timeout mymaster 180000
sentinel deny-scripts-reconfig yes
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/sentinel.conf.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
sentinel.conf&lt;/p&gt;
&lt;p&gt;ï¼ˆ2ï¼‰å°†é…ç½®æ–‡ä»¶ å¤åˆ¶åˆ° redis-5.0.7/conf ç›®å½•ä¸‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[root@iZ2ze4u2bufi0915gyi843Z redis-5.0.7]#cat sentinel.conf | grep -v &amp;quot;#&amp;quot; | grep -v &amp;quot;^$&amp;quot; &amp;gt; ./conf/sentinel-26379.conf
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ï¼ˆ3ï¼‰ä¿®æ”¹ sentinel-26379.conf é…ç½®æ–‡ä»¶&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[root@iZ2ze4u2bufi0915gyi843Z conf]# vim sentinel-26379.confÂ 
port 26379
daemonize no
dir /root/redis-5.0.7/data
sentinel monitor mymaster 127.0.0.1 6379 2
sentinel down-after-milliseconds mymaster 30000
sentinel parallel-syncs mymaster 1
sentinel failover-timeout mymaster 180000
sentinel deny-scripts-reconfig yes
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ï¼ˆ4ï¼‰å¤åˆ¶ç”ŸæˆÂ sentinel-26380.confã€Â sentinel-26381.conf ä¸¤ä¸ªé…ç½®æ–‡ä»¶&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[root@iZ2ze4u2bufi0915gyi843Z conf]# sed &#39;s/26379/26380/g&#39; sentinel-26379.conf &amp;gt; sentinel-26380.conf
[root@iZ2ze4u2bufi0915gyi843Z conf]# sed &#39;s/26379/26381/g&#39; sentinel-26379.conf &amp;gt; sentinel-26381.conf
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;å¯åŠ¨å“¨å…µ&#34;&gt;å¯åŠ¨å“¨å…µ&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;redis-sentinel sentinel-ç«¯å£å·.conf
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¯åŠ¨ä¸‰ä¸ªå“¨å…µï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;redis-sentinel sentinel-26379.conf

redis-sentinel sentinel-26380.conf

redis-sentinel sentinel-26381.conf
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å½“ master:6379 ä¸‹çº¿åï¼Œå“¨å…µæŠ•ç¥¨é€‰ä¸¾å‡ºæ–°çš„ master:6381&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/master%E4%B8%8B%E7%BA%BF%E5%90%8E%EF%BC%8C%E5%93%A8%E5%85%B5%E6%8A%95%E7%A5%A8%E9%80%89%E4%B8%BE%E6%96%B0%E7%9A%84master.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;master ä¸‹çº¿åï¼Œå“¨å…µæŠ•ç¥¨é€‰ä¸¾æ–°çš„ master&lt;/p&gt;
&lt;h2 id=&#34;é…ç½®å“¨å…µ-2&#34;&gt;é…ç½®å“¨å…µ&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;é…ç½®é¡¹&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;èŒƒä¾‹&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;è¯´æ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;sentinel auth-pass    &amp;lt;æœåŠ¡å™¨åç§°&amp;gt; &lt;password&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;sentinel auth-pass mymaster   itcast&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è¿æ¥æœåŠ¡å™¨å£ä»¤&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;sentinel down-after-milliseconds &amp;lt;è‡ªå®šä¹‰æœåŠ¡åç§°&amp;gt;&amp;lt;ä¸»æœºåœ°å€&amp;gt;&amp;lt;ç«¯å£&amp;gt;&amp;lt;ä¸»ä»æœåŠ¡å™¨æ€»é‡&amp;gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;sentinel monitor mymaster    192.168.194.131 6381 1&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è®¾ç½®å“¨å…µç›‘å¬çš„ä¸»æœåŠ¡å™¨ä¿¡æ¯ï¼Œæœ€åçš„å‚æ•°å†³å®šäº†æœ€ç»ˆå‚ä¸é€‰ä¸¾çš„æœåŠ¡å™¨ æ•°é‡ï¼ˆ-1ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;sentinel down-after-milliseconds    &amp;lt;æœåŠ¡åç§°&amp;gt;&amp;lt;æ¯«ç§’æ•°ï¼ˆæ•´æ•°ï¼‰&amp;gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;sentinel down-after  milliseconds mymaster 3000&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æŒ‡å®šå“¨å…µåœ¨ç›‘æ§RedisæœåŠ¡æ—¶ï¼Œåˆ¤å®šæœåŠ¡å™¨æŒ‚æ‰çš„æ—¶é—´å‘¨æœŸï¼Œé»˜è®¤30ç§’ ï¼ˆ30000ï¼‰ï¼Œä¹Ÿæ˜¯ä¸»ä»åˆ‡æ¢çš„å¯åŠ¨æ¡ä»¶ä¹‹ä¸€&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;sentinel parallel-syncs    &amp;lt;æœåŠ¡åç§°&amp;gt;&amp;lt;æœåŠ¡å™¨æ•°ï¼ˆæ•´æ•°ï¼‰&amp;gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;sentinel parallel-syncs    mymaster 1&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æŒ‡å®šåŒæ—¶è¿›è¡Œä¸»ä»çš„slaveæ•°é‡ï¼Œæ•°å€¼è¶Šå¤§ï¼Œè¦æ±‚ç½‘ç»œèµ„æºè¶Šé«˜ï¼Œè¦æ±‚è¶Šå°ï¼ŒåŒæ­¥æ—¶é—´è¶Šé•¿&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;sentinel failover-timeout    &amp;lt;æœåŠ¡åç§°&amp;gt;&amp;lt;æ¯«ç§’æ•°ï¼ˆæ•´æ•°ï¼‰&amp;gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;sentinel failover-timeout    mymaster 9000&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æŒ‡å®šå‡ºç°æ•…éšœåï¼Œæ•…éšœåˆ‡æ¢çš„æœ€å¤§è¶…æ—¶æ—¶é—´ï¼Œè¶…è¿‡è¯¥å€¼ï¼Œè®¤å®šåˆ‡æ¢å¤±è´¥ï¼Œé»˜è®¤3åˆ†é’Ÿ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;sentinel notification-script    &amp;lt;æœåŠ¡åç§°&amp;gt;&amp;lt;è„šæœ¬è·¯å¾„&amp;gt;&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æœåŠ¡å™¨æ— æ³•æ­£å¸¸è”é€šæ—¶ï¼Œè®¾å®šçš„æ‰§è¡Œè„šæœ¬ï¼Œé€šå¸¸è°ƒè¯•ä½¿ç”¨ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;å“¨å…µå·¥ä½œåŸç†&#34;&gt;å“¨å…µå·¥ä½œåŸç†&lt;/h1&gt;
&lt;h2 id=&#34;ä¸»ä»åˆ‡æ¢&#34;&gt;ä¸»ä»åˆ‡æ¢&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å“¨å…µåœ¨è¿›è¡Œä¸»ä»åˆ‡æ¢è¿‡ç¨‹ä¸­ç»å†ä¸‰ä¸ªé˜¶æ®µ
&lt;ul&gt;
&lt;li&gt;ç›‘æ§&lt;/li&gt;
&lt;li&gt;é€šçŸ¥&lt;/li&gt;
&lt;li&gt;æ•…éšœè½¬ç§»&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;é˜¶æ®µä¸€ç›‘æ§é˜¶æ®µ&#34;&gt;é˜¶æ®µä¸€ï¼šç›‘æ§é˜¶æ®µ&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E7%9B%91%E6%8E%A7%E9%98%B6%E6%AE%B5.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;ç”¨äºåŒæ­¥å„ä¸ªèŠ‚ç‚¹çš„çŠ¶æ€ä¿¡æ¯
&lt;ul&gt;
&lt;li&gt;è·å–å„ä¸ªsentinelçš„çŠ¶æ€ï¼ˆæ˜¯å¦åœ¨çº¿ï¼‰&lt;/li&gt;
&lt;li&gt;è·å–masterçš„çŠ¶æ€
&lt;ul&gt;
&lt;li&gt;masterå±æ€§
&lt;ul&gt;
&lt;li&gt;runid&lt;/li&gt;
&lt;li&gt;roleï¼šmaster&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å„ä¸ªslaveçš„è¯¦ç»†ä¿¡æ¯&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è·å–æ‰€æœ‰slaveçš„çŠ¶æ€ï¼ˆæ ¹æ®masterä¸­çš„slaveä¿¡æ¯ï¼‰
&lt;ul&gt;
&lt;li&gt;slaveå±æ€§
&lt;ul&gt;
&lt;li&gt;runid&lt;/li&gt;
&lt;li&gt;roleï¼šslave&lt;/li&gt;
&lt;li&gt;master_hostã€master_port&lt;/li&gt;
&lt;li&gt;offset&lt;/li&gt;
&lt;li&gt;......&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E7%9B%91%E6%8E%A7%E9%98%B6%E6%AE%B52.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;â‘  ç¬¬ä¸€ä¸ªå“¨å…µè¿›å»çš„æ—¶å€™ï¼Œåªæœ‰ master å’Œ slave å¯ä»¥è¿ï¼Œå“¨å…µå…ˆ&lt;strong&gt;è¿æ¥ master&lt;/strong&gt;ï¼Œå‘é€ info æŒ‡ä»¤ã€‚&lt;br&gt;
â‘¡ ä¸ºäº†æ–¹ä¾¿åæœŸ master å’Œ sentinel å‘½ä»¤äº¤æ¢ï¼Œ&lt;strong&gt;å»ºç«‹äº†ä¸€ä¸ª cmd è¿æ¥&lt;/strong&gt;ï¼Œä¸“é—¨ç”¨äºå‘é€å‘½ä»¤ã€‚&lt;br&gt;
åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¿å­˜äº†æ‰€æœ‰å“¨å…µçŠ¶æ€ SentinelStateï¼Œåœ¨å“¨å…µç«¯æŠŠæ‰€æœ‰ä¿¡æ¯è¿›è¡Œè®°å½•ï¼›åœ¨ master ç«¯è®°å½• redis å®ä¾‹å¯¹åº”ä¿¡æ¯ï¼šSentinelRedisInstance&lt;br&gt;
â‘¢ sentinel æ ¹æ®ä» master è·å–çš„ slaves ä¿¡æ¯&lt;strong&gt;å»ä¸æ¯ä¸€ä¸ª slave è¿›è¡Œè¿æ¥&lt;/strong&gt;ï¼Œå‘é€ info å‘½ä»¤ã€‚&lt;br&gt;
â‘£ ä¸‹ä¸€ä¸ª sentinel è¿›å…¥ï¼Œ&lt;strong&gt;å‘é€ info å‘½ä»¤è¿æ¥ master&lt;/strong&gt;ï¼Œå‘ç° master ç«¯çš„ SentinelRedisInstance ä¸­çš„ sentinels æœ‰ä¿¡æ¯ï¼ŒçŸ¥é“äº†åœ¨å®ƒä¹‹å‰æœ‰å¯¹åº”çš„ sentinel ä¸master å»ºç«‹äº†è¿æ¥ã€‚&lt;br&gt;
â‘¤ sentinel &lt;strong&gt;ä¸ master å»ºç«‹ cmd è¿æ¥&lt;/strong&gt;ã€‚&lt;br&gt;
åœ¨ sentinel ç«¯åˆ›å»º SentinelStateï¼ˆåŒ…å«ä¸¤ä¸ª sentinel èŠ‚ç‚¹ä¿¡æ¯ï¼‰ã€‚&lt;br&gt;
ä¸ºäº†ä¿è¯ä¸¤ä¸ª sentinel ä¿¡æ¯åŒæ­¥ï¼Œåœ¨ä¸¤ä¸ª sentinel ä¹‹é—´å»ºç«‹æ²Ÿé€šçš„æ¡¥æ¢è¿›è¡Œå‘å¸ƒè®¢é˜…ï¼Œå‘è¿™ä¸ªé€šé“å‘é€ä¿¡æ¯å¤§å®¶å¯ä»¥äº’è”ï¼Œä¸ºäº†ä¿è¯è¿æ¥ï¼Œä¸¤ä¸ª sentinel è¿˜ä¼šäº’ç›¸å‘é€ ping å‘½ä»¤çœ‹å¯¹æ–¹æ˜¯ä¸æ˜¯è¿˜åœ¨&lt;br&gt;
â‘¥ sentinel ä¸ slave è¿æ¥&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E7%9B%91%E6%8E%A7%E9%98%B6%E6%AE%B53.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;å½“ç¬¬ä¸‰ä¸ªèŠ‚ç‚¹è¿›æ¥æ—¶ï¼Œé™¤äº†è¿æ¥ master å’Œ slavesï¼Œè¿˜éœ€è¦ä¸ç°å­˜çš„ sentinel è¿›è¡Œè¿æ¥ï¼Œæ­¤æ—¶ä¸‰ä¸ª sentinel ç»„æˆäº†ä¸€ä¸ªå°çš„ç½‘ç»œï¼Œå½¼æ­¤é—´äº¤æ¢ä¿¡æ¯ï¼Œåœ¨è¿™ä¸ªç½‘ç»œä¸­ï¼šå“ªä¸ªå“¨å…µæ‹¿åˆ°ä¿¡æ¯ï¼Œå¿«é€Ÿæ‰©æ•£ç»™å¤§å®¶ï¼Œç”±äºæ¯ä¸ª sentinel ä¹‹é—´éƒ½æ˜¯ä¿¡ä»»çš„ï¼Œä¸€æ—¦æœ‰ä¸€ä¸ª sentinel å‘é€ä¿¡æ¯ï¼Œå…¶ä»–å“¨å…µæ¥æ”¶ï¼Œå‘ç°å’Œè‡ªå·±çš„ä¿¡æ¯ä¸ä¸€è‡´ï¼Œå°±æ›´æ–°æ‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç›‘æ§é˜¶æ®µçš„ä¿¡æ¯è·å–ï¼šsentinel ä¼šå‘ masterã€slaveã€å…¶ä»–çš„ sentinel è¦çŠ¶æ€ï¼Œsentinel ä¹‹é—´ä¼šç»„å»ºå¯¹åº”çš„é¢‘é“ï¼Œå¤§å®¶åœ¨è¿™é‡Œå‘å¸ƒã€è®¢é˜…ã€åŒæ­¥ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;h2 id=&#34;é˜¶æ®µäºŒé€šçŸ¥é˜¶æ®µ&#34;&gt;é˜¶æ®µäºŒï¼šé€šçŸ¥é˜¶æ®µ&lt;/h2&gt;
&lt;p&gt;ä¿¡æ¯çš„é•¿æœŸç»´æŠ¤é˜¶æ®µ&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E9%80%9A%E7%9F%A5%E9%98%B6%E6%AE%B5.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸‰ä¸ª sentinel ç»„æˆäº†ä¸€ä¸ªå°ç¾¤ä½“ï¼Œå®ƒä»¬ä¹‹é—´è¿›è¡Œä¿¡æ¯äº’é€šï¼Œæä¾›æ•°æ®çš„ master å’Œ slave æ­£å¸¸å·¥ä½œï¼Œsentinel ä¼šé€šè¿‡ cmd è¿æ¥è·å–å®ƒä»¬å¯¹åº”çš„å·¥ä½œçŠ¶æ€ï¼Œé€šè¿‡å‘å¸ƒ hello ä¿¡æ¯æ¥è·å–ï¼Œæ— è®ºæ˜¯å“ªä¸ª sentinel æ‹¿åˆ°ç»“æœï¼Œéƒ½ä¼šåœ¨ sentinel å†…éƒ¨ç½‘ç»œè¿›è¡Œä¿¡æ¯äº’é€šï¼Œå‘Šè¯‰å…¶ä»– sentinelã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;é˜¶æ®µä¸‰æ•…éšœè½¬ç§»é˜¶æ®µ&#34;&gt;é˜¶æ®µä¸‰ï¼šæ•…éšœè½¬ç§»é˜¶æ®µ&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;9&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%95%85%E9%9A%9C%E8%BD%AC%E7%A7%BB%E9%98%B6%E6%AE%B5.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;â‘  sentinel å‘ master å‘é€ hello æŒ‡ä»¤ï¼Œmaster æ²¡æœ‰å›å¤ï¼Œsentinel å°±ä¸åœç»™ master å‘é€ helloï¼Œå‘é€äº†åˆ°äº†ä¸€å®šé˜¶æ®µåï¼Œsentinel è®¤ä¸º master æ‰çº¿äº†ï¼Œç»™ master æ ‡è®°ä¸º S_DOWN çŠ¶æ€ã€‚&lt;br&gt;
â‘¡ sentinel1 æŠŠè¿™ä¸ªä¿¡æ¯ä¼ é€’åˆ°å†…ç½‘ä¸­ã€‚å¦‚æœæ˜¯æŸä¸ª sentinel æ–­äº†å¯¼è‡´æ— æ³•å’Œ master å»ºç«‹è¿æ¥ï¼Œè¯¥ sentinel æŠŠ master çŠ¶æ€æ ‡è®°ä¸º S_DOWNï¼Œå¹¶æŠŠä¿¡æ¯å‘é€åˆ°å†…ç½‘æ—¶ï¼Œå‘é€å¤±è´¥ï¼ˆæ­¤ sentinel æ–­çº¿äº†ï¼‰ã€‚&lt;br&gt;
â‘¢ å½“å†…ç½‘ä¸­çš„å…¶ä»– sentinel æ¥æ”¶åˆ° master æŒ‚æ‰çš„ä¿¡æ¯åï¼Œäºæ˜¯å»å›´è§‚ä¸åœåœ°ç»™ master å‘é€ helloï¼Œä»ç„¶æ²¡æœ‰å›å¤ï¼Œè¯¥ master æœç„¶æ‰çº¿äº†ã€‚&lt;br&gt;
â‘£ äºæ˜¯æŠŠå®ƒä»¬æ¥æ”¶åˆ°çš„ç»“æœä¿¡æ¯ä¹Ÿä¼ é€åˆ°å†…ç½‘ä¸­ç¡®è®¤ sentinel1 è¯´çš„å¯¹ï¼Œmaster æœç„¶æŒ‚äº†ã€‚&lt;br&gt;
â‘¤ æ­¤æ—¶æ‰€æœ‰ sentinel éƒ½è®¤ä¸º master æŒ‚äº†ï¼Œmaster ç«¯çš„çŠ¶æ€ä¿¡æ¯æ›´æ”¹ä¸ºï¼šO_DOWNã€‚äº‹å®ä¸Šï¼Œåªè¦åŠæ•°ä»¥ä¸Šçš„ sentinel è®¤ä¸º master æŒ‚äº†ï¼ŒçŠ¶æ€å°±æ ‡è®°ä¸º O_DOWNï¼Œä¸å¿…è¦ç­‰æ‰€æœ‰ sentinel éƒ½ç¡®è®¤ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¸»è§‚ä¸‹çº¿ï¼šä¸€ä¸ª sentinel è®¤ä¸º master æŒ‚äº†ã€‚&lt;/p&gt;
&lt;p&gt;å®¢è§‚ä¸‹çº¿ï¼šåŠæ•°ä»¥ä¸Š sentinel è®¤ä¸º master æŒ‚äº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;1-æŠ•ç¥¨é€‰ä¸¾-sentinel-ä»£è¡¨&#34;&gt;1. æŠ•ç¥¨é€‰ä¸¾ sentinel ä»£è¡¨&lt;/h3&gt;
&lt;p&gt;å®¢è§‚ä¸‹çº¿åï¼Œè¿›å…¥ä¸‹ä¸€ç¯èŠ‚ï¼šå¼€å§‹æ¸…ç†é˜Ÿä¼ã€‚æ¸…ç†é˜Ÿä¼å‰ï¼Œéœ€é€‰å‡ºä¸€ä¸ª sentinel ä½œä¸ºä»£è¡¨å»æ¸…ç†ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;10&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%8A%95%E7%A5%A8%E9%80%89%E4%B8%BE%E5%93%A8%E5%85%B5%E4%BB%A3%E8%A1%A8.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;æ‰€æœ‰ sentinel åŒæ—¶å‘é€æŒ‡ä»¤è¡¨ç¤ºæˆ‘è¦ä½œä¸ºä»£è¡¨å»æ¸…ç†é˜Ÿä¼ã€‚&lt;br&gt;
å‘é€çš„æŒ‡ä»¤ä¸­æºå¸¦ä»¥ä¸‹ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æŒ‚çš„ ip&lt;/li&gt;
&lt;li&gt;æŒ‚çš„ç«¯å£&lt;/li&gt;
&lt;li&gt;ç«é€‰æ¬¡æ•°ï¼ˆæˆ‘åœ¨è¿™æ–¹é¢å¤„ç†çš„ç»éªŒï¼šå‚ä¸ç«é€‰çš„æ¬¡æ•°ï¼‰&lt;/li&gt;
&lt;li&gt;è‡ªå·±çš„ runid&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;11&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%93%A8%E5%85%B5%E6%8A%95%E7%A5%A82.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;é‚£ä¹ˆåˆ°åº•åº”è¯¥é€‰å“ªä¸€ä¸ªå‘¢ï¼Ÿ&lt;br&gt;
æŠ•ç¥¨æœºåˆ¶&lt;br&gt;
æ¯ä¸€ä¸ª sentinel ä½œä¸ºå‚é€‰è€…ï¼ŒåŒæ—¶ä¹Ÿæ˜¯æŠ•ç¥¨è€…ï¼Œæ¯äººæœ‰ä¸€ç¥¨ï¼Œå½“ sentinel1 å’Œ sentinel4 åŒæ—¶æŠŠä¿¡æ¯å‘é€åˆ°å¾®ä¿¡ç¾¤ä¸­æ—¶ï¼Œsentinel2 å…ˆæ¥æ”¶åˆ°è°çš„å°±æŠŠç¥¨æŠ•ç»™è°ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;12&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%93%A8%E5%85%B5%E6%8A%95%E7%A5%A83.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;æ‰€æœ‰ä¿¡æ¯æ²Ÿé€šå®Œæ¯•ä¼šå¾—åˆ°ä¸€ä¸ªæŠ•ç¥¨ç»“æœï¼Œå‡å¦‚æœ‰ä¸€ä¸ª sentinel è·å¾—è¶…è¿‡åŠæ•°ä»¥ä¸Šçš„ç¥¨ï¼Œå°±å½“é€‰ï¼Œå¦‚æœæ²¡æœ‰å¾—åˆ°è¿™æ ·çš„ä¸€ä¸ªç»“æœï¼Œå°±é‡æ–°æŠ•ä¸€è½®ï¼Œæ¯å¢åŠ ä¸€è½®ï¼Œç«é€‰æ¬¡æ•°+1.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;2-sentinel-ä»£è¡¨ä»å¤‡é€‰-slave-ä¸­é€‰æ‹©ä¸€ä¸ªå½“-master&#34;&gt;2. sentinel ä»£è¡¨ä»å¤‡é€‰ slave ä¸­é€‰æ‹©ä¸€ä¸ªå½“ master&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æœåŠ¡å™¨åˆ—è¡¨ä¸­æŒ‘é€‰å¤‡é€‰master
&lt;ul&gt;
&lt;li&gt;åœ¨çº¿çš„&lt;/li&gt;
&lt;li&gt;å“åº”æ…¢çš„&lt;/li&gt;
&lt;li&gt;ä¸åŸmasteræ–­å¼€æ—¶é—´ä¹…çš„&lt;/li&gt;
&lt;li&gt;ä¼˜å…ˆåŸåˆ™
&lt;ul&gt;
&lt;li&gt;ä¼˜å…ˆçº§&lt;/li&gt;
&lt;li&gt;offset&lt;/li&gt;
&lt;li&gt;runid&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å‘é€æŒ‡ä»¤ï¼ˆ sentinel ï¼‰
&lt;ul&gt;
&lt;li&gt;å‘æ–°çš„masterå‘é€slaveof no one&lt;/li&gt;
&lt;li&gt;å‘å…¶ä»–slaveå‘é€slaveof æ–°masterIPç«¯å£&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;13&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%95%85%E9%9A%9C%E8%BD%AC%E7%A7%BB%E9%98%B6%E6%AE%B5%E6%80%BB%E7%BB%93.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;ä¸»ä»åˆ‡æ¢è¿‡ç¨‹æ€»ç»“&#34;&gt;ä¸»ä»åˆ‡æ¢è¿‡ç¨‹æ€»ç»“&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ç›‘æ§
&lt;ul&gt;
&lt;li&gt;åŒæ­¥ä¿¡æ¯&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é€šçŸ¥
&lt;ul&gt;
&lt;li&gt;ä¿æŒè”é€š&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ•…éšœè½¬ç§»
&lt;ul&gt;
&lt;li&gt;å‘ç°é—®é¢˜&lt;/li&gt;
&lt;li&gt;ç«é€‰è´Ÿè´£äºº&lt;/li&gt;
&lt;li&gt;ä¼˜é€‰æ–°master&lt;/li&gt;
&lt;li&gt;æ–°masterä¸Šä»»ï¼Œå…¶ä»–slaveåˆ‡æ¢masterï¼ŒåŸmasterä½œä¸ºslaveæ•…éšœæ¢å¤åè¿æ¥&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;14&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E4%B8%BB%E4%BB%8E%E5%88%87%E6%8D%A2%E8%BF%87%E7%A8%8B%E6%97%A5%E5%BF%97.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ä¸»ä»åˆ‡æ¢è¿‡ç¨‹æ—¥å¿—ä¿¡æ¯&lt;/p&gt;
&lt;h1 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;å“¨å…µæ¨¡å¼&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä»€ä¹ˆæ˜¯å“¨å…µ ï¼ˆç›‘æ§æ•´ä½“å·¥ä½œè¿‡ç¨‹ï¼‰&lt;/li&gt;
&lt;li&gt;å“¨å…µæ¨¡å¼æ­å»º&lt;/li&gt;
&lt;li&gt;å“¨å…µå·¥ä½œåŸç†
&lt;ul&gt;
&lt;li&gt;ç›‘æ§&lt;/li&gt;
&lt;li&gt;é€šçŸ¥&lt;/li&gt;
&lt;li&gt;æ•…éšœè½¬ç§»&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
">Redis å“¨å…µ</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/dubbo/"" data-c="
          &lt;h1 id=&#34;ä¸€-åŸºç¡€çŸ¥è¯†&#34;&gt;ä¸€ã€åŸºç¡€çŸ¥è¯†&lt;/h1&gt;
&lt;h2 id=&#34;1-åˆ†å¸ƒå¼åŸºç¡€ç†è®º&#34;&gt;1ã€åˆ†å¸ƒå¼åŸºç¡€ç†è®º&lt;/h2&gt;
&lt;h3 id=&#34;11-ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿ&#34;&gt;1.1ï¼‰ã€ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿï¼Ÿ&lt;/h3&gt;
&lt;p&gt;ã€Šåˆ†å¸ƒå¼ç³»ç»ŸåŸç†ä¸èŒƒå‹ã€‹å®šä¹‰ï¼š&lt;/p&gt;
&lt;p&gt;â€œåˆ†å¸ƒå¼ç³»ç»Ÿæ˜¯è‹¥å¹²ç‹¬ç«‹è®¡ç®—æœºçš„é›†åˆï¼Œè¿™äº›è®¡ç®—æœºå¯¹äºç”¨æˆ·æ¥è¯´å°±åƒå•ä¸ªç›¸å…³ç³»ç»Ÿâ€&lt;/p&gt;
&lt;p&gt;åˆ†å¸ƒå¼ç³»ç»Ÿï¼ˆdistributed systemï¼‰æ˜¯å»ºç«‹åœ¨ç½‘ç»œä¹‹ä¸Šçš„è½¯ä»¶ç³»ç»Ÿã€‚&lt;/p&gt;
&lt;p&gt;éšç€äº’è”ç½‘çš„å‘å±•ï¼Œç½‘ç«™åº”ç”¨çš„è§„æ¨¡ä¸æ–­æ‰©å¤§ï¼Œå¸¸è§„çš„å‚ç›´åº”ç”¨æ¶æ„å·²æ— æ³•åº”å¯¹ï¼Œåˆ†å¸ƒå¼æœåŠ¡æ¶æ„ä»¥åŠæµåŠ¨è®¡ç®—æ¶æ„åŠ¿åœ¨å¿…è¡Œï¼ŒäºŸéœ€&lt;strong&gt;ä¸€ä¸ªæ²»ç†ç³»ç»Ÿ&lt;/strong&gt;ç¡®ä¿æ¶æ„æœ‰æ¡ä¸ç´Šçš„æ¼”è¿›ã€‚&lt;/p&gt;
&lt;h3 id=&#34;12-å‘å±•æ¼”å˜&#34;&gt;1.2ï¼‰ã€å‘å±•æ¼”å˜&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E5%8F%91%E5%B1%95%E6%BC%94%E5%8F%98.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;em&gt;å•ä¸€åº”ç”¨æ¶æ„&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;å½“ç½‘ç«™æµé‡å¾ˆå°æ—¶ï¼Œåªéœ€ä¸€ä¸ªåº”ç”¨ï¼Œå°†æ‰€æœ‰åŠŸèƒ½éƒ½éƒ¨ç½²åœ¨ä¸€èµ·ï¼Œä»¥å‡å°‘éƒ¨ç½²èŠ‚ç‚¹å’Œæˆæœ¬ã€‚æ­¤æ—¶ï¼Œç”¨äºç®€åŒ–å¢åˆ æ”¹æŸ¥å·¥ä½œé‡çš„æ•°æ®è®¿é—®æ¡†æ¶(ORM)æ˜¯å…³é”®ã€‚&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%8D%95%E4%B8%80%E5%BA%94%E7%94%A8%E6%9E%B6%E6%9E%84.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;é€‚ç”¨äºå°å‹ç½‘ç«™ï¼Œå°å‹ç®¡ç†ç³»ç»Ÿï¼Œå°†æ‰€æœ‰åŠŸèƒ½éƒ½éƒ¨ç½²åˆ°ä¸€ä¸ªåŠŸèƒ½é‡Œï¼Œç®€å•æ˜“ç”¨ã€‚

ç¼ºç‚¹ï¼š 1ã€æ€§èƒ½æ‰©å±•æ¯”è¾ƒéš¾ ï¼ˆå¦‚æœä¿®æ”¹æˆ–æ·»åŠ æŸä¸ªåŠŸèƒ½ï¼Œéƒ½éœ€è¦æŠŠæ•´ä¸ªåº”ç”¨é‡æ–°æ‰“åŒ…ï¼Œé‡æ–°æ”¾éƒ¨ç½²åˆ° æœåŠ¡å™¨ï¼‰

Â Â Â Â Â Â Â 2ã€ååŒå¼€å‘é—®é¢˜ï¼ˆæ‰€æœ‰äººéƒ½å»ä¿®æ”¹ä¸€ä¸ªåº”ç”¨ï¼Œå®¹æ˜“ä¹±ï¼‰

Â Â Â Â Â Â Â 3ã€ä¸åˆ©äºå‡çº§ç»´æŠ¤
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;å°†å¤šä¸ªåŠŸèƒ½æ”¾åˆ°ä¸€ä¸ªåº”ç”¨å†…ï¼Œæ‰“åŒ…åæ”¾åˆ°æœåŠ¡å™¨ä¸Šå³å¯ã€‚è®¿é—®é‡å¢å¤§ï¼Œä¸€ä¸ªæœåŠ¡å™¨æ— æ³•æ‰¿å—æ—¶ï¼Œå†æ·»åŠ ä¸€ä¸ªæœåŠ¡å™¨åŒæ—¶è·‘è¿™ä¸ªåº”ç”¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%8D%95%E4%B8%80%E5%BA%94%E7%94%A8%E6%9E%B6%E6%9E%842.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;em&gt;å‚ç›´åº”ç”¨æ¶æ„&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;å½“è®¿é—®é‡é€æ¸å¢å¤§ï¼Œå•ä¸€åº”ç”¨å¢åŠ æœºå™¨å¸¦æ¥çš„åŠ é€Ÿåº¦è¶Šæ¥è¶Šå°ï¼Œå°†åº”ç”¨æ‹†æˆäº’ä¸ç›¸å¹²çš„å‡ ä¸ªåº”ç”¨ï¼Œä»¥æå‡æ•ˆç‡ã€‚æ­¤æ—¶ï¼Œç”¨äºåŠ é€Ÿå‰ç«¯é¡µé¢å¼€å‘çš„Webæ¡†æ¶(MVC)æ˜¯å…³é”®ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%9E%82%E7%9B%B4%E5%BA%94%E7%94%A8%E6%9E%B6%E6%9E%84.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;é€šè¿‡åˆ‡åˆ†ä¸šåŠ¡æ¥å®ç°å„ä¸ªæ¨¡å—ç‹¬ç«‹éƒ¨ç½²ï¼Œé™ä½äº†ç»´æŠ¤å’Œéƒ¨ç½²çš„éš¾åº¦ï¼Œå›¢é˜Ÿå„å¸å…¶èŒæ›´æ˜“ç®¡ç†ï¼Œæ€§èƒ½æ‰©å±•ä¹Ÿæ›´æ–¹ä¾¿ï¼Œæ›´æœ‰é’ˆå¯¹æ€§ã€‚

ç¼ºç‚¹ï¼š å…¬ç”¨æ¨¡å—æ— æ³•é‡å¤åˆ©ç”¨ï¼Œå¼€å‘æ€§çš„æµªè´¹
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;å°†ä¸€ä¸ªå¤§åº”ç”¨æ‹†åˆ†æˆå‡ ä¸ªç‹¬ç«‹çš„å°åº”ç”¨ï¼Œæ¯ä¸€ä¸ªåº”ç”¨éƒ½æ˜¯ä»å¤´åˆ°å°¾å®Œæˆçš„ï¼ˆä»é¡µé¢åˆ°ä¸šåŠ¡é€»è¾‘ç¨‹åºåˆ°æ•°æ®åº“ï¼‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%9E%82%E7%9B%B4%E5%BA%94%E7%94%A8%E6%9E%B6%E6%9E%842.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;å‚ç›´åº”ç”¨æ¶æ„&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å½“æŸä¸€å—åº”ç”¨çš„è®¿é—®é‡æ¯”è¾ƒå¤§æ—¶ï¼Œå°†è¿™ä¸ªåº”ç”¨å¤šæ‰©å±•å‡ ä¸ªæœåŠ¡å™¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%9E%82%E7%9B%B4%E5%BA%94%E7%94%A8%E6%9E%B6%E6%9E%843.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;æ‰©å±•æŸä¸ªå°åº”ç”¨å³å¯&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å¥½å¤„ï¼š1ï¼‰åˆ†å·¥åˆä½œå®¹æ˜“ï¼Œæ¯ä¸ªäººè´Ÿè´£å¼€å‘ç»´æŠ¤ä¸åŒçš„åº”ç”¨ï¼Œäº’ä¸å¹²æ‰°ã€‚&lt;br&gt;
2ï¼‰æ€§èƒ½æ‰©å±•å®¹æ˜“ï¼Œæ¯”å¦‚â€œç”¨æˆ·â€åº”ç”¨çš„è®¿é—®é‡å¢å¤§ï¼Œ å°±æŠŠå®ƒå¤šæ”¾å‡ å°æœåŠ¡å™¨ï¼Œæ‰©å±•çš„æ˜¯æŸä¸ªå°åº”ç”¨ï¼Œå…¶ä»–å°åº”ç”¨æ— éœ€å˜åŠ¨ã€‚&lt;br&gt;
ç¼ºç‚¹ï¼š1ï¼‰ç”±äºæ¯ä¸ªå°åº”ç”¨éƒ½æ˜¯å®Œæ•´çš„ï¼ˆç•Œé¢+ä¸šåŠ¡é€»è¾‘+æ•°æ®åº“ï¼‰ï¼Œä½†æ˜¯ç•Œé¢è¦æ±‚ç»å¸¸å˜åŒ–ï¼Œæ¯ä¸ªç•Œé¢çš„å˜åŒ–éƒ½ä¼šå¯¼è‡´åº”ç”¨çš„é‡æ–°éƒ¨ç½²ã€‚æ— æ³•åšåˆ°é¡µé¢ å’Œ ä¸šåŠ¡é€»è¾‘ çš„åˆ†ç¦»&lt;br&gt;
2ï¼‰ éšç€åº”ç”¨çš„é€æ­¥å¢å¤šï¼Œå‚ç›´åº”ç”¨ä¼šè¶Šæ¥è¶Šå¤šï¼Œè¿™æ ·çš„æƒ…å†µä¸‹ï¼Œä¸å¯èƒ½ç†æƒ³çš„åº”ç”¨å’Œåº”ç”¨ä¹‹é—´äº’ç›¸ç‹¬ç«‹ï¼Œè®¢å•æ¨¡å—éœ€è¦ç”¨æˆ·æ¨¡å—å’Œå•†å“æ¨¡å—ä¿¡æ¯ï¼Œåº”ç”¨ä¹‹é—´äº¤äº’ï¼Œä¸å¯èƒ½å®Œå…¨ç‹¬ç«‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%9E%82%E7%9B%B4%E5%BA%94%E7%94%A8%E6%9E%B6%E6%9E%844.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ç•Œé¢ä¸ä¸šåŠ¡é€»è¾‘æ— æ³•åˆ†ç¦»ï¼Œå„ä¸ªåº”ç”¨é—´éœ€è¦äº¤äº’&lt;/p&gt;
&lt;p&gt;&lt;em&gt;åˆ†å¸ƒå¼æœåŠ¡æ¶æ„&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;å½“å‚ç›´åº”ç”¨è¶Šæ¥è¶Šå¤šï¼Œåº”ç”¨ä¹‹é—´äº¤äº’ä¸å¯é¿å…ï¼Œå°†æ ¸å¿ƒä¸šåŠ¡æŠ½å–å‡ºæ¥ï¼Œä½œä¸ºç‹¬ç«‹çš„æœåŠ¡ï¼Œé€æ¸å½¢æˆç¨³å®šçš„æœåŠ¡ä¸­å¿ƒï¼Œä½¿å‰ç«¯åº”ç”¨èƒ½æ›´å¿«é€Ÿçš„å“åº”å¤šå˜çš„å¸‚åœºéœ€æ±‚ã€‚æ­¤æ—¶ï¼Œç”¨äºæé«˜ä¸šåŠ¡å¤ç”¨åŠæ•´åˆçš„&lt;strong&gt;åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶(RPC)æ˜¯å…³é”®&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9E%B6%E6%9E%841.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;å°†ç”¨æˆ·æŠ½å–æˆâ€œç”¨æˆ·ç•Œé¢â€ å’Œ â€œç”¨æˆ·ä¸šåŠ¡â€ï¼Œè®¢å•æŠ½å–æˆ â€œè®¢å•ç•Œé¢â€ å’Œ â€œè®¢å•ä¸šåŠ¡â€ ç­‰ã€‚&lt;br&gt;
å½“ä¸šåŠ¡é€»è¾‘ä¸å˜çš„æƒ…å†µä¸‹ï¼Œå¦‚æœåªæƒ³ä¿®æ”¹ç•Œé¢ï¼Œé‡å¯ç•Œé¢æœåŠ¡å™¨å³å¯ï¼Œæ ¸å¿ƒä¸šåŠ¡é€»è¾‘è¿˜åœ¨å…¶ä»–æœåŠ¡å™¨ä¸Šï¼Œæ— éœ€å˜åŠ¨ã€‚&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%88%86%E5%B8%83%E5%BC%8F%E6%9E%B6%E6%9E%842.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;ç”¨æˆ·ç•Œé¢æ”¾åœ¨ A æœåŠ¡å™¨ä¸Šï¼Œç”¨æˆ·ä¸šåŠ¡æ”¾åœ¨ B æœåŠ¡å™¨ä¸Šï¼Œè®¢å•ä¸šåŠ¡æ”¾åœ¨ C æœåŠ¡å™¨ä¸Šï¼Œå¦‚æœ A æœåŠ¡å™¨ï¼ˆç”¨æˆ·ç•Œé¢ï¼‰éœ€è¦è°ƒç”¨ B æœåŠ¡å™¨ï¼ˆç”¨æˆ·ä¸šåŠ¡ï¼‰çš„åŠŸèƒ½ã€‚å¦‚æœå†™åœ¨ä¸€ä¸ªåº”ç”¨å†…ï¼ŒA è°ƒç”¨ Bï¼Œç›´æ¥â€œæ–¹æ³• A . æ–¹æ³• Bâ€ å³å¯ï¼Œç›´æ¥è°ƒç”¨ï¼Œè¿›ç¨‹ç±»é€šè®¯ï¼Œéƒ½åœ¨ä¸€ä¸ªæœåŠ¡å™¨ä¸Šï¼Œéƒ½æ˜¯åŒä¸€ä¸ª tomcatï¼ŒåŒä¸€ä¸ªè¿›ç¨‹ç±»é€šè®¯ã€‚ä½†å¦‚æœæ˜¯åˆ†å¸ƒå¼æœåŠ¡æ¶æ„ï¼ŒA å’Œ B åœ¨ä¸¤å°æœåŠ¡å™¨ä¸Šï¼Œè¿™æ ·çš„ä¸åŒæœåŠ¡å™¨é—´çš„äº’ç›¸è°ƒç”¨ç§°ä¸º RPCï¼ˆè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼‰ã€‚åˆ†å¸ƒå¼æœåŠ¡æ¶æ„çš„éš¾ç‚¹ï¼šå¦‚ä½•è¿›è¡Œè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼Œå¦‚æœæ‹†åˆ†åº”ç”¨ï¼Œæå‡ä¸šåŠ¡çš„å¤ç”¨ç¨‹åº¦ã€‚&lt;br&gt;
éšç€ä¸šåŠ¡çš„ä¸æ–­å¢å¤šï¼Œåˆ†æ‹†çš„ä¸šåŠ¡è¶Šæ¥è¶Šå¤šï¼Œæˆåƒä¸Šä¸‡çš„æœåŠ¡å™¨åœ¨è·‘ä¸åŒçš„æœåŠ¡ï¼Œå‡ºç°çš„èµ„æºæµªè´¹é—®é¢˜æ„ˆåŠ ä¸¥é‡ï¼Œæ¯”å¦‚ç”¨æˆ·ä¸šåŠ¡è®¿é—®é‡è¾ƒå°ï¼Œä½†å´æœ‰ 100 å°æœåŠ¡å™¨åœ¨è·‘ï¼Œå°±é€ æˆäº†æµªè´¹ï¼›è€Œ å•†å“ä¸šåŠ¡ è®¿é—®é‡å¾ˆå¤§ï¼Œä½†å´åªæœ‰ 10 å°æœåŠ¡å™¨åœ¨è·‘ã€‚åº”è¯¥æœ‰ä¸€ä¸ªåŸºäºè®¿é—®å‹åŠ›çš„è°ƒåº¦ä¸­å¿ƒèƒ½å¤Ÿå®æ—¶ç›‘æ§æ•°æ®åŠ¨æ€è°ƒåº¦ï¼Œæé«˜èµ„æºåˆ©ç”¨ç‡ï¼Œè®©æ›´å¤šçš„æœåŠ¡å™¨å»è·‘ä¸šåŠ¡é‡æ›´å¤§çš„ä¸šåŠ¡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;æµåŠ¨è®¡ç®—æ¶æ„&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;å½“æœåŠ¡è¶Šæ¥è¶Šå¤šï¼Œå®¹é‡çš„è¯„ä¼°ï¼Œå°æœåŠ¡èµ„æºçš„æµªè´¹ç­‰é—®é¢˜é€æ¸æ˜¾ç°ï¼Œæ­¤æ—¶éœ€å¢åŠ ä¸€ä¸ªè°ƒåº¦ä¸­å¿ƒåŸºäºè®¿é—®å‹åŠ›å®æ—¶ç®¡ç†é›†ç¾¤å®¹é‡ï¼Œæé«˜é›†ç¾¤åˆ©ç”¨ç‡ã€‚æ­¤æ—¶ï¼Œç”¨äº&lt;strong&gt;æé«˜æœºå™¨åˆ©ç”¨ç‡çš„èµ„æºè°ƒåº¦å’Œæ²»ç†ä¸­å¿ƒ(SOA)[ Service Oriented Architecture]æ˜¯å…³é”®&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%B5%81%E5%8A%A8%E8%AE%A1%E7%AE%97%E6%9E%B6%E6%9E%84.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;é‡‡ç”¨æµåŠ¨è®¡ç®—æ¶æ„ï¼Œå¼•å…¥è°ƒåº¦ä¸­å¿ƒï¼Œè´Ÿè´£ç»´æŠ¤æœåŠ¡é—´çš„å¤æ‚å…³ç³»ï¼Œå®æ—¶ç®¡ç†é›†ç¾¤ï¼Œæ¯”å¦‚ A æœåŠ¡å™¨è®¿é—®é‡å¤§äº†ï¼Œç»™ A å¤šå¢åŠ å‡ å°æœåŠ¡å™¨ï¼Œå‡è®¾ ç¬¬ä¸€å° æœ‰ 100 ä¸ªè¯·æ±‚ï¼Œç¬¬äºŒå° æœ‰ 2 ä¸ªè¯·æ±‚ï¼Œç¬¬ä¸‰å°æœ‰ 10000 ä¸ªè¯·æ±‚ï¼Œé‚£ä¹ˆä¸‹æ¬¡è¯·æ±‚è¿›æ¥ï¼Œå°±åº”è¯¥æ‰¾æ¯”è¾ƒé—²çš„ç¬¬äºŒå°æœåŠ¡å™¨æ¥å¤„ç†è¯·æ±‚ï¼Œä»¥æ­¤æé«˜æ•´ä¸ªé›†ç¾¤åˆ©ç”¨ç‡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;9&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%B5%81%E5%8A%A8%E8%AE%A1%E7%AE%97%E6%9E%B6%E6%9E%842.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;æµåŠ¨è®¡ç®—æ¶æ„&lt;/p&gt;
&lt;h3 id=&#34;13-rpc&#34;&gt;1.3ï¼‰ã€RPC&lt;/h3&gt;
&lt;p&gt;&lt;em&gt;ä»€ä¹ˆå«RPC&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;RPCã€Remote Procedure Callã€‘æ˜¯æŒ‡è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼Œæ˜¯ä¸€ç§è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ï¼Œä»–æ˜¯ä¸€ç§æŠ€æœ¯çš„æ€æƒ³ï¼Œè€Œä¸æ˜¯è§„èŒƒã€‚å®ƒå…è®¸ç¨‹åºè°ƒç”¨å¦ä¸€ä¸ªåœ°å€ç©ºé—´ï¼ˆé€šå¸¸æ˜¯å…±äº«ç½‘ç»œçš„å¦ä¸€å°æœºå™¨ä¸Šï¼‰çš„è¿‡ç¨‹æˆ–å‡½æ•°ï¼Œè€Œä¸ç”¨ç¨‹åºå‘˜æ˜¾å¼ç¼–ç è¿™ä¸ªè¿œç¨‹è°ƒç”¨çš„ç»†èŠ‚ã€‚å³ç¨‹åºå‘˜æ— è®ºæ˜¯è°ƒç”¨æœ¬åœ°çš„è¿˜æ˜¯è¿œç¨‹çš„å‡½æ•°ï¼Œæœ¬è´¨ä¸Šç¼–å†™çš„è°ƒç”¨ä»£ç åŸºæœ¬ç›¸åŒã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;RPCåŸºæœ¬åŸç†&lt;/em&gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;10&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/RPC%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;éœ€æ±‚ï¼šA æœåŠ¡å™¨å®¢æˆ·ç«¯ï¼ˆclientï¼‰æœ‰ä¸€ä¸ªå°åŠŸèƒ½ï¼Œæƒ³è¦è°ƒç”¨ B æœåŠ¡å™¨çš„ä¸€ä¸ªå°åŠŸèƒ½ã€‚&lt;br&gt;
å®ç°ï¼šA æœåŠ¡å™¨å®¢æˆ·ç«¯ï¼ˆclientï¼‰å…ˆæ‰¾ä¸€ä¸ªå°åŠ©æ‰‹ï¼ˆclient stubï¼‰ï¼Œè¿™ä¸ªå°åŠ©æ‰‹ä¸€çœ‹ï¼ŒA æœåŠ¡å™¨æƒ³è¦è°ƒç”¨ B æœåŠ¡å™¨ä¸Šçš„åŠŸèƒ½ï¼Œå…ˆè·Ÿ B æœåŠ¡å™¨åœ¨ç½‘ç»œä¸Šå»ºç«‹ä¸€ä¸ª sockets è¿æ¥ï¼Œå°†è¦è°ƒç”¨ B çš„ä¸€äº›ä¿¡æ¯ï¼ˆæ¯”å¦‚è¦è°ƒç”¨ B çš„æŸä¸ªæ–¹æ³•çš„æ–¹æ³•åã€å‚æ•°ï¼‰ä¼ é€’ç»™ B æ¨¡å‹ï¼ŒB æœåŠ¡å™¨ä¸Šçš„å°åŠ©æ‰‹ï¼ˆserver stubï¼‰æ”¶åˆ°è¿™äº›ä¿¡æ¯ï¼ŒçŸ¥é“äº† A æœåŠ¡å™¨æƒ³è¦è°ƒç”¨ æˆ‘çš„ä¸€ä¸ªæ–¹æ³•ï¼Œæ‰§è¡Œè¿™ä¸ªæ–¹æ³•åï¼Œå°†è¿”å›å€¼ä¾æ¬¡ä¼ å› A å®¢æˆ·ç«¯ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;11&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/RPC%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%862.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;RPCä¸¤ä¸ªæ ¸å¿ƒæ¨¡å—ï¼šé€šè®¯ï¼Œåºåˆ—åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;RPC æ¡†æ¶æœ‰å¾ˆå¤šå¦‚ï¼šdubboã€gRPCã€Thriftã€HSF(High Speed Service Framework)&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;12&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/RPC%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%863.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;A æœåŠ¡å™¨ä¸Šæœ‰ä¸€ä¸ª hello()æ–¹æ³•ï¼Œæƒ³è¦è°ƒç”¨ B æœåŠ¡å™¨ä¸Šçš„ hi() æ–¹æ³•ï¼ŒåŒæ—¶ä¼ å…¥ä¸€ä¸ª User  å¯¹è±¡ï¼ŒB æœåŠ¡å™¨ä¸Šçš„ hi() æ–¹æ³•æ‰§è¡Œå®Œäº†ä»¥åï¼Œè¿”å›ä¸€ä¸ª String ç»™ A æœåŠ¡å™¨ï¼ŒAæœåŠ¡å™¨è°ƒå®Œ BæœåŠ¡å™¨çš„æ–¹æ³•åï¼Œæ”¶åˆ° B æœåŠ¡å™¨çš„è¿”å›å€¼å¹¶åœ¨æ§åˆ¶å°æ‰“å°ã€‚&lt;br&gt;
è°ƒç”¨è¿‡ç¨‹ï¼šA æœåŠ¡å™¨å®¢æˆ·ç«¯ï¼ˆClientï¼‰ æƒ³è¦ è°ƒç”¨ B æœåŠ¡å™¨çš„ä»£ç ï¼ŒA æœåŠ¡å™¨ä¸Šæœ‰ä¸€ä¸ªå°åŠ©æ‰‹ï¼ˆClient Stubï¼‰è¿™ä¸ªå°åŠ©æ‰‹ä¸€çœ‹ A æœåŠ¡å™¨ è¦è°ƒç”¨ B æœåŠ¡å™¨ï¼Œå…ˆä¸ B æœåŠ¡å™¨å»ºè®®è¿æ¥ï¼Œå»ºç«‹è¿æ¥åï¼Œç”±äºè°ƒç”¨æ–¹æ³•è¦ä¼ é€’å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°è¦å‘ç»™ B æœåŠ¡å™¨ï¼Œå‚æ•°å¯¹è±¡è¦åœ¨ç½‘ç»œé—´ä¼ é€’éœ€è¦å…ˆåºåˆ—åŒ– ï¼Œåºåˆ—åŒ–åå°†è¦è°ƒç”¨çš„ä¿¡æ¯ä¼ é€’ç»™ B æœåŠ¡å™¨çš„å°åŠ©æ‰‹ï¼ˆServer Stubï¼‰ï¼ŒB æœåŠ¡å™¨çš„å°åŠ©æ‰‹æ”¶åˆ°ä¿¡æ¯ï¼Œä¸€çœ‹æœ‰æ¥è‡ªå¤–ç•Œçš„ A æœåŠ¡å™¨æƒ³è¦è°ƒç”¨æˆ‘çš„ hi() æ–¹æ³•ï¼ŒåŒæ—¶è¿˜ä¼ é€’æ¥äº†ä¸€ä¸ªå‚æ•°å€¼ï¼Œç”±äºæ˜¯åºåˆ—åŒ–ä¼ é€’è¿‡æ¥çš„ï¼Œå¦‚æœä½¿ç”¨åˆ™éœ€ååºåˆ—åŒ–æˆå¯¹è±¡ï¼ŒBæœåŠ¡å™¨ä¸Šçš„å°åŠ©æ‰‹è°ƒç”¨ B æœåŠ¡å™¨ä¸Šçš„æ–¹æ³•ï¼Œæ‹¿åˆ°ååºåˆ—åŒ–çš„å¯¹è±¡ã€ä¸€äº›å±æ€§å€¼ï¼Œæ–¹æ³•è°ƒç”¨å®Œå°±ä¼šæœ‰ä¸€ä¸ªè¿”å›å€¼ï¼Œè¿”å›å€¼è¿‡æ¥è¦åœ¨ç½‘ç»œé—´ä¼ é€’æ•°æ®ï¼Œå°†è¿”å›çš„ String å¯¹è±¡åºåˆ—åŒ–ä¼ é€’ç»™ A æœåŠ¡å™¨çš„å°åŠ©æ‰‹ï¼ŒClient Stub æ”¶åˆ°åå†ååºåˆ—åŒ–ï¼Œè¾“å‡ºã€‚&lt;br&gt;
æ•´ä¸ªè¿‡ç¨‹ä¸¤ä¸ªæ ¸å¿ƒï¼šå»ºç«‹è¿æ¥ã€ä¼ é€’æ•°æ®ï¼ˆåºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼‰ã€‚æ‰€ä»¥ï¼Œå½±å“ä¸€ä¸ª RPC æ¡†æ¶æ€§èƒ½çš„é‡è¦ä¸¤ç‚¹ï¼šèƒ½å¦å¿«é€Ÿåœ°åœ¨å„ä¸ªæœåŠ¡å™¨é—´å»ºç«‹è¿æ¥ï¼›åºåˆ—åŒ–/ååºåˆ—åŒ–æœºåˆ¶çš„é€Ÿåº¦ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;2-dubboæ ¸å¿ƒæ¦‚å¿µ&#34;&gt;2ã€dubboæ ¸å¿ƒæ¦‚å¿µ&lt;/h2&gt;
&lt;h3 id=&#34;21-ç®€ä»‹&#34;&gt;2.1ï¼‰ã€ç®€ä»‹&lt;/h3&gt;
&lt;p&gt;Apache Dubbo (incubating) |ËˆdÊŒbÉ™ÊŠ| æ˜¯ä¸€æ¬¾é«˜æ€§èƒ½ã€è½»é‡çº§çš„å¼€æºJava RPCæ¡†æ¶ï¼Œå®ƒæä¾›äº†ä¸‰å¤§æ ¸å¿ƒèƒ½åŠ›ï¼šé¢å‘æ¥å£çš„è¿œç¨‹æ–¹æ³•è°ƒç”¨ï¼Œæ™ºèƒ½å®¹é”™å’Œè´Ÿè½½å‡è¡¡ï¼Œä»¥åŠæœåŠ¡è‡ªåŠ¨æ³¨å†Œå’Œå‘ç°ã€‚&lt;/p&gt;
&lt;p&gt;å®˜ç½‘ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://dubbo.apache.org/zh-cn/&#34;&gt;http://dubbo.apache.org/zh-cn/&lt;/a&gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;13&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/dubbo%E7%89%B9%E6%80%A7.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;é¢å‘æ¥å£ä»£ç†çš„é«˜æ€§èƒ½ RPC è°ƒç”¨&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä½¿ç”¨ dubbo æ—¶ï¼ŒA æœåŠ¡å™¨ è¦è°ƒç”¨ B æœåŠ¡å™¨ä¸Šçš„ä»£ç ï¼Œåªéœ€å°† B åŠŸèƒ½æ–¹æ³•çš„æ¥å£ InterfaceBæ‹¿è¿‡æ¥ï¼Œè°ƒç”¨æ¥å£æ‰€åœ¨çš„æ–¹æ³• InterfaceB.fun()ï¼Œå°±ä¼šè‡ªåŠ¨å»æ‰¾æœåŠ¡å™¨ B ä¸Šçš„ä»£ç ä»£ç è°ƒç”¨ï¼Œå±è”½äº†è¿œç¨‹çš„è°ƒç”¨ç»†èŠ‚ã€‚ç±»ä¼¼åœ¨ç”¨ Mybatis ï¼Œæ“ä½œæ•°æ®åº“æ—¶ï¼Œåªéœ€è¦å†™ä¸€ä¸ª mapper æ¥å£ï¼Œè°ƒç”¨æ¥å£çš„æ–¹æ³•å³å¯ã€‚&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;&lt;strong&gt;æ™ºèƒ½è´Ÿè½½å‡è¡¡&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ¯”å¦‚ç”¨æˆ·ä¸šåŠ¡è®¿é—®é‡å¾ˆå¤§ï¼Œå°±éœ€è¦å¤šæ”¾å‡ å°æœåŠ¡å™¨ï¼Œâ€œç”¨æˆ·ç•Œé¢â€ æƒ³è¦è°ƒç”¨ â€œç”¨æˆ·ä¸šåŠ¡â€ çš„åŠŸèƒ½ï¼Œè°ƒç”¨ â€œç”¨æˆ·ä¸šåŠ¡â€ çš„å“ªä¸€å°æœåŠ¡å™¨éƒ½å¯ä»¥ï¼Œå‡è®¾ ç¬¬ä¸€å°ç”¨æˆ·ä¸šåŠ¡æœåŠ¡å™¨å½“å‰æœ‰ 100 ä¸ªè¯·æ±‚ï¼Œ ç¬¬äºŒå°ç”¨æˆ·ä¸šåŠ¡æœåŠ¡å™¨å½“å‰æœ‰ 2 ä¸ªè¯·æ±‚ï¼Œ ç¬¬ä¸‰å°ç”¨æˆ·ä¸šåŠ¡æœåŠ¡å™¨å½“å‰æœ‰ 1000 ä¸ªè¯·æ±‚ï¼Œ ç¬¬å››å°ç”¨æˆ·ä¸šåŠ¡æœåŠ¡å™¨å½“å‰æœ‰ 10 ä¸ªè¯·æ±‚ï¼Œå°±åº”è¯¥æ‰¾ä¸€ä¸ªéå¸¸ç©ºé—²çš„æœåŠ¡å™¨å¿«é€Ÿå¤„ç†è¿™æ¬¡å“åº”ï¼Œè¿™ä¸ªæœºåˆ¶å°±å«åš&lt;strong&gt;è´Ÿè½½å‡è¡¡&lt;/strong&gt;ï¼Œè®©æ¯ä¸ªæœåŠ¡å™¨éƒ½æœ‰ä¸€ä¸ªå¾ˆå‡è¡¡çš„è´Ÿè½½ï¼Œä¸è¦è®©æŸä¸€å°æœåŠ¡å™¨åšå¤ªå¤šçš„å“åº”ï¼ŒæŠŠå®ƒå‹å®ï¼Œä¹Ÿä¸è¦è®©æŸä¸€å°æœåŠ¡å™¨å¤ªé—²ï¼Œèµ„æºæµªè´¹ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;14&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%99%BA%E8%83%BD%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;&lt;strong&gt;æœåŠ¡è‡ªåŠ¨æ³¨å†Œä¸å‘ç°&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æƒ³è±¡è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼šä¸šåŠ¡éå¸¸å¤šï¼Œæ¯ä¸€å—çš„è®¿é—®é‡éƒ½ç‰¹åˆ«å¤§ï¼Œæ¯”å¦‚ç”¨æˆ·ä¸šåŠ¡åœ¨ 1ã€2ã€3ã€4 å·æœåŠ¡å™¨éƒ½æœ‰ï¼Œæ”¯ä»˜ä¸šåŠ¡åœ¨ 9ã€11ã€13 å·æœåŠ¡å™¨éƒ½æœ‰ï¼Œé‚£ä¹ˆ è®¢å•web æƒ³è¦è°ƒç”¨æ”¯ä»˜ä¸šåŠ¡ï¼ŒRPC æ¡†æ¶çˆ±å¦‚ä½•çŸ¥é“æ”¯ä»˜ä¸šåŠ¡éƒ½åœ¨å“ªäº›æœåŠ¡å™¨ä¸Šå‘¢ï¼Ÿå¦‚æœ 11 å·æœåŠ¡å™¨å‡ºé—®é¢˜äº†ï¼Œæ¡†æ¶å¦‚ä½•è‡ªåŠ¨åœ°çŸ¥é“è¿™ä¸ªäº‹å‘¢ï¼Ÿå¼•å…¥&lt;strong&gt;æ³¨å†Œä¸­å¿ƒ&lt;/strong&gt;æœºåˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†èƒ½åŠ¨æ€æ„ŸçŸ¥åˆ°æ¯ä¸€ä¸ªæœåŠ¡ï¼Œå¯ä»¥å°†æ‰€æœ‰çš„æœåŠ¡éƒ½æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒï¼ŒåŒ…æ‹¬å‰ç«¯ç¨‹åºä¹Ÿå¯ä»¥éƒ½æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒå†…ï¼Œæ³¨å†Œä¸­å¿ƒç›¸å½“äºç»´æŠ¤äº†ä¸€ä¸ª â€œä¸šåŠ¡ - æœåŠ¡å™¨â€ æ¸…å•ï¼Œæ¯”å¦‚ï¼šç”¨æˆ·ä¸šåŠ¡ï¼š1ã€2ã€3ã€4 å·æœåŠ¡å™¨ï¼Œå¦‚æœ 2 å·æœåŠ¡å™¨å‡ºé—®é¢˜äº†ï¼Œå°±æŠŠå®ƒä»æ¸…å•ä¸­åˆ æ‰ã€‚å¦‚æœ è®¢å•web è¦è°ƒç”¨æ”¯ä»˜ä¸šåŠ¡ï¼Œå…ˆåˆ°æ³¨å†Œä¸­å¿ƒçš„æ¸…å•å†…æ‰¾æ”¯ä»˜ä¸šåŠ¡éƒ½åœ¨å“ªä¸€å°æœåŠ¡å™¨ä¸Šï¼Œç„¶åéšæœºé€‰æ‹©æˆ–è€…é€‰æ‹©è¯·æ±‚é‡æœ€å°‘çš„ä¸€å°æœåŠ¡å™¨è¿›è¡Œè®¿é—®ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;15&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;&lt;strong&gt;é«˜åº¦å¯æ‰©å±•&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¾®å†…æ ¸ + æ’ä»¶&lt;/p&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;&lt;strong&gt;è¿è¡ŒæœŸæµé‡è°ƒåº¦&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å†…ç½®æ¡ä»¶ã€è„šæœ¬ç­‰è·¯ç”±ç­–ç•¥ï¼Œé€šè¿‡é…ç½®ä¸åŒçš„è·¯ç”±è§„åˆ™ï¼Œè½»æ¾å®ç°&lt;strong&gt;ç°åº¦å‘å¸ƒ&lt;/strong&gt;ï¼ŒåŒæœºæˆ¿ä¼˜å…ˆç­‰åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;ç°åº¦å‘å¸ƒï¼šä¸€ä¸ªç”¨æˆ·æœåŠ¡åœ¨ 100 å°æœåŠ¡å™¨ä¸Šè·‘ï¼Œç”¨æˆ·æœåŠ¡åšäº†å¼€å‘å‡çº§ï¼Œå…ˆé€‰å®š 20 å°æœåŠ¡å™¨ï¼Œè®©å®ƒä»¬å…ˆç”¨æ–°ç‰ˆæœ¬çš„æœåŠ¡ï¼Œå‰©ä¸‹çš„ 80 å°ä½¿ç”¨æ—§ç‰ˆæœ¬çš„æœåŠ¡ï¼Œç­‰è¿™ 20 å°ç”¨ç€éƒ½æ²¡é—®é¢˜äº†ï¼Œå†é€‰ 20 å°ï¼Œè¿™æ ·é€æ­¥è¿‡æ¸¡ï¼Œç›´åˆ° 100 å°å…¨ç”¨åˆ°æ–°çš„ç”¨æˆ·æœåŠ¡ã€‚é…ç½®ä¸åŒçš„è·¯ç”±è§„åˆ™ï¼Œè¯·æ±‚è¿›æ¥åï¼Œè®©ä¸€éƒ¨åˆ†è¯·æ±‚ç”¨æ–°å‡çº§çš„æœåŠ¡ï¼Œå‰©ä¸‹çš„æ¥ç”¨æ—§çš„æœåŠ¡ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ä»æ—§æœåŠ¡è½¬åŒ–æˆæ–°æœåŠ¡çš„è¿‡ç¨‹å°±å«åš&lt;strong&gt;ç°åº¦å‘å¸ƒ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;ol start=&#34;6&#34;&gt;
&lt;li&gt;&lt;strong&gt;å¯è§†åŒ–çš„æœåŠ¡æ²»ç†å’Œè¿ç»´&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é€šè¿‡å¯è§†åŒ–çš„ WEB ç•Œé¢åŠ¨æ€æŸ¥è¯¢æœåŠ¡çš„ä¿¡æ¯ã€è°ƒæ•´ä¸€äº›å‚æ•°ã€‚&lt;/p&gt;
&lt;h3 id=&#34;22-åŸºæœ¬æ¦‚å¿µ&#34;&gt;2.2ï¼‰ã€åŸºæœ¬æ¦‚å¿µ&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;16&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/dubbo%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;æœåŠ¡æä¾›è€…ï¼ˆProviderï¼‰&lt;/strong&gt;ï¼šæš´éœ²æœåŠ¡çš„æœåŠ¡æä¾›æ–¹ï¼ŒæœåŠ¡æä¾›è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±æä¾›çš„æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æœåŠ¡æ¶ˆè´¹è€…ï¼ˆConsumerï¼‰&lt;/strong&gt;:Â è°ƒç”¨è¿œç¨‹æœåŠ¡çš„æœåŠ¡æ¶ˆè´¹æ–¹ï¼ŒæœåŠ¡æ¶ˆè´¹è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒè®¢é˜…è‡ªå·±æ‰€éœ€çš„æœåŠ¡ï¼ŒæœåŠ¡æ¶ˆè´¹è€…ï¼Œä»æä¾›è€…åœ°å€åˆ—è¡¨ä¸­ï¼ŒåŸºäºè½¯è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œé€‰ä¸€å°æä¾›è€…è¿›è¡Œè°ƒç”¨ï¼Œå¦‚æœè°ƒç”¨å¤±è´¥ï¼Œå†é€‰å¦ä¸€å°è°ƒç”¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ³¨å†Œä¸­å¿ƒï¼ˆRegistryï¼‰&lt;/strong&gt;ï¼šæ³¨å†Œä¸­å¿ƒè¿”å›æœåŠ¡æä¾›è€…åœ°å€åˆ—è¡¨ç»™æ¶ˆè´¹è€…ï¼Œå¦‚æœæœ‰å˜æ›´ï¼Œæ³¨å†Œä¸­å¿ƒå°†åŸºäºé•¿è¿æ¥æ¨é€å˜æ›´æ•°æ®ç»™æ¶ˆè´¹è€…ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç›‘æ§ä¸­å¿ƒï¼ˆMonitorï¼‰&lt;/strong&gt;ï¼šæœåŠ¡æ¶ˆè´¹è€…å’Œæä¾›è€…ï¼Œåœ¨å†…å­˜ä¸­ç´¯è®¡è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´ï¼Œå®šæ—¶æ¯åˆ†é’Ÿå‘é€ä¸€æ¬¡ç»Ÿè®¡æ•°æ®åˆ°ç›‘æ§ä¸­å¿ƒã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ¡†æ¶å®¹å™¨ï¼ˆContainer&lt;/strong&gt;ï¼‰&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è°ƒç”¨å…³ç³»è¯´æ˜
&lt;ul&gt;
&lt;li&gt;æœåŠ¡å®¹å™¨è´Ÿè´£å¯åŠ¨ï¼ŒåŠ è½½ï¼Œè¿è¡ŒæœåŠ¡æä¾›è€…ã€‚&lt;/li&gt;
&lt;li&gt;æœåŠ¡æä¾›è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±æä¾›çš„æœåŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;æœåŠ¡æ¶ˆè´¹è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒè®¢é˜…è‡ªå·±æ‰€éœ€çš„æœåŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;æ³¨å†Œä¸­å¿ƒè¿”å›æœåŠ¡æä¾›è€…åœ°å€åˆ—è¡¨ç»™æ¶ˆè´¹è€…ï¼Œå¦‚æœæœ‰å˜æ›´ï¼Œæ³¨å†Œä¸­å¿ƒå°†åŸºäºé•¿è¿æ¥æ¨é€å˜æ›´æ•°æ®ç»™æ¶ˆè´¹è€…ã€‚&lt;/li&gt;
&lt;li&gt;æœåŠ¡æ¶ˆè´¹è€…ï¼Œä»æä¾›è€…åœ°å€åˆ—è¡¨ä¸­ï¼ŒåŸºäºè½¯è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œé€‰ä¸€å°æä¾›è€…è¿›è¡Œè°ƒç”¨ï¼Œå¦‚æœè°ƒç”¨å¤±è´¥ï¼Œå†é€‰å¦ä¸€å°è°ƒç”¨ã€‚&lt;/li&gt;
&lt;li&gt;æœåŠ¡æ¶ˆè´¹è€…å’Œæä¾›è€…ï¼Œåœ¨å†…å­˜ä¸­ç´¯è®¡è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´ï¼Œå®šæ—¶æ¯åˆ†é’Ÿå‘é€ä¸€æ¬¡ç»Ÿè®¡æ•°æ®åˆ°ç›‘æ§ä¸­å¿ƒã€‚&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç”¨æˆ·ä¸šåŠ¡æ˜¯å®é™…çš„ä¸šåŠ¡åŠŸèƒ½ï¼Œweb ç•Œé¢è¦å»è°ƒç”¨è¿™äº›ä¸šåŠ¡åŠŸèƒ½ï¼Œæ‰€ä»¥ï¼Œç”¨æˆ·ä¸šåŠ¡æ˜¯ä¸€ä¸ªæœåŠ¡æä¾›è€…ï¼ˆProviderï¼‰ï¼Œè€Œ web ç•Œé¢æ˜¯æœåŠ¡æ¶ˆè´¹è€…ï¼ˆConsumerï¼‰&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿è¡Œæµç¨‹ï¼šå®¹å™¨ Container å¯åŠ¨ï¼Œåˆå§‹åŒ– init ï¼ŒæœåŠ¡æä¾›è€… Provider å°†è‡ªå·±æä¾›çš„ä¿¡æ¯æ³¨å†Œ register åˆ°æ³¨å†Œä¸­å¿ƒ Registry ï¼Œæ³¨å†Œä¸­å¿ƒå°±çŸ¥é“æœ‰å“ªäº›æœåŠ¡ä¸Šçº¿äº†ï¼Œå½“æœåŠ¡æ¶ˆè´¹è€… Consumer å¯åŠ¨ï¼Œä»æ³¨å†Œä¸­å¿ƒè®¢é˜… subscribe è‡ªå·±æ‰€éœ€è¦çš„æœåŠ¡ï¼Œå¦‚æœæœåŠ¡æä¾›è€…å‘ç”Ÿå˜æ›´ï¼ˆ3 å·æœåŠ¡å™¨ä¸‹çº¿äº†ï¼‰ï¼Œæ³¨å†Œä¸­å¿ƒå°†è¿™æ¬¡å˜æ›´æ¨é€ notify ç»™æ¶ˆè´¹è€…ï¼Œæ¶ˆè´¹è€…æ‹¿åˆ°æ‰€æœ‰å®ƒèƒ½è°ƒç”¨çš„æœåŠ¡ï¼Œè°ƒç”¨çš„æ—¶å€™å¯ä»¥åŒæ­¥è°ƒç”¨ invoke æœåŠ¡æä¾›è€…æä¾›çš„æœåŠ¡ï¼Œå¦‚æœæ¶ˆè´¹è€…è¦è°ƒç”¨çš„æœåŠ¡æœ‰å¤šå°æœåŠ¡å™¨åœ¨æä¾›ï¼Œæ¶ˆè´¹è€…æ ¹æ®è´Ÿè½½å‡è¡¡ç®—æ³•é€‰æ‹©ä¸€ä¸ªè¿›è¡Œè°ƒç”¨ã€‚æ¯æ¬¡çš„è°ƒç”¨ä¿¡æ¯ä¼šå®šæ—¶åœ°æ¯éš”ä¸€åˆ†é’Ÿå°†ä¿¡æ¯å‘é€åˆ°ç›‘æ§ä¸­å¿ƒ Monitorï¼Œç›‘æ§ä¸­å¿ƒå°±èƒ½ç›‘æ§åˆ°æœåŠ¡çš„çŠ¶æ€ã€‚&lt;br&gt;
0ã€1ã€2 è¿™ä¸‰æ­¥æ˜¯åœ¨åˆå§‹åŒ–ã€å¯åŠ¨åº”ç”¨æ—¶å®Œæˆçš„ã€‚&lt;br&gt;
3ã€5 æ˜¯å¼‚æ­¥è¿‡ç¨‹ï¼Œ&lt;br&gt;
4 æœåŠ¡æ¶ˆè´¹è€…è°ƒç”¨æœåŠ¡æä¾›è€…æä¾›çš„åŠŸèƒ½æ˜¯ä¸€ä¸ªåŒæ­¥çš„è°ƒç”¨ã€‚&lt;br&gt;
äº†è§£äº† dubbo æ¡†æ¶ï¼Œåœ¨ç¼–å†™ dubbo åº”ç”¨æ—¶ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å…ˆå†™ä¸€ä¸ªæœåŠ¡æä¾›è€…ï¼Œå°†æœåŠ¡æä¾›è€…æä¾›çš„æœåŠ¡æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒï¼›&lt;/li&gt;
&lt;li&gt;ç¼–å†™ä¸€ä¸ªæœåŠ¡æ¶ˆè´¹è€…ï¼Œæ¶ˆè´¹è€…ä»æ³¨å†Œä¸­å¿ƒè®¢é˜…æä¾›è€…æä¾›çš„æœåŠ¡ï¼›&lt;/li&gt;
&lt;li&gt;æµ‹è¯•æ¶ˆè´¹è€…å¦‚ä½•è°ƒç”¨æä¾›è€…æä¾›çš„åŠŸèƒ½ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;3-dubboç¯å¢ƒæ­å»º&#34;&gt;3ã€dubboç¯å¢ƒæ­å»º&lt;/h2&gt;
&lt;h3 id=&#34;31-windows-å®‰è£…zookeeper&#34;&gt;3.1ï¼‰ã€ã€windowsã€‘-å®‰è£…zookeeper&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;1ã€ä¸‹è½½zookeeperç½‘å€Â &lt;a href=&#34;https://archive.apache.org/dist/zookeeper/zookeeper-3.4.13/&#34;&gt;https://archive.apache.org/dist/zookeeper/zookeeper-3.4.13/&lt;/a&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;2ã€è§£å‹zookeeperè§£å‹è¿è¡ŒzkServer.cmd ï¼Œåˆæ¬¡è¿è¡Œä¼šæŠ¥é”™ï¼Œæ²¡æœ‰zoo.cfgé…ç½®æ–‡ä»¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;3ã€ä¿®æ”¹zoo.cfgé…ç½®æ–‡ä»¶å°†confä¸‹çš„zoo_sample.cfgå¤åˆ¶ä¸€ä»½æ”¹åä¸ºzoo.cfgå³å¯ã€‚æ³¨æ„å‡ ä¸ªé‡è¦ä½ç½®ï¼šdataDir=./ Â Â ä¸´æ—¶æ•°æ®å­˜å‚¨çš„ç›®å½•ï¼ˆå¯å†™ç›¸å¯¹è·¯å¾„ï¼‰clientPort=2181 Â Â zookeeperçš„ç«¯å£å·ä¿®æ”¹å®Œæˆåå†æ¬¡å¯åŠ¨zookeeper&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;4ã€ä½¿ç”¨zkCli.cmdæµ‹è¯•ls /ï¼šåˆ—å‡ºzookeeperæ ¹ä¸‹ä¿å­˜çš„æ‰€æœ‰èŠ‚ç‚¹createÂ â€“e /atguigu 123ï¼šåˆ›å»ºä¸€ä¸ªatguiguèŠ‚ç‚¹ï¼Œå€¼ä¸º123get /atguiguï¼šè·å–/atguiguèŠ‚ç‚¹çš„å€¼&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;æ³¨ï¼šè®°å½•ä¸€ä¸ªå° bug&lt;/p&gt;
&lt;p&gt;é—®é¢˜ï¼šã€zookeeperã€‘æŠ¥é”™-Dzookeeper.log.dir=xxx&amp;quot;&#39; ä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤ï¼Œä¹Ÿä¸æ˜¯å¯è¿è¡Œçš„ç¨‹åº æˆ–æ‰¹å¤„ç†æ–‡ä»¶çš„è§£å†³&lt;/p&gt;
&lt;p&gt;è§£å†³ï¼šä¿®æ”¹zkServer.cmdæ–‡ä»¶ã€‚å°† call %JAVA% æ”¹æˆ java&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;java &amp;quot;-Dzookeeper.log.dir=%ZOO_LOG_DIR%&amp;quot; &amp;quot;-Dzookeeper.root.logger=%ZOO_LOG4J_PROP%&amp;quot; -cp &amp;quot;%CLASSPATH%&amp;quot; %ZOOMAIN% &amp;quot;%ZOOCFG%&amp;quot; %*
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å‚è€ƒåšå®¢ï¼š&lt;a href=&#34;https://blog.csdn.net/pangdongh/article/details/90208230&#34;&gt;https://blog.csdn.net/pangdongh/article/details/90208230&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;32-windows-å®‰è£…dubbo-adminç®¡ç†æ§åˆ¶å°&#34;&gt;3.2ï¼‰ã€ã€windowsã€‘-å®‰è£…dubbo-adminç®¡ç†æ§åˆ¶å°&lt;/h3&gt;
&lt;p&gt;dubboæœ¬èº«å¹¶ä¸æ˜¯ä¸€ä¸ªæœåŠ¡è½¯ä»¶ã€‚å®ƒå…¶å®å°±æ˜¯ä¸€ä¸ªjaråŒ…èƒ½å¤Ÿå¸®ä½ çš„javaç¨‹åºè¿æ¥åˆ°zookeeperï¼Œå¹¶åˆ©ç”¨zookeeperæ¶ˆè´¹ã€æä¾›æœåŠ¡ã€‚æ‰€ä»¥ä½ ä¸ç”¨åœ¨Linuxä¸Šå¯åŠ¨ä»€ä¹ˆdubboæœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ä¸ºäº†è®©ç”¨æˆ·æ›´å¥½çš„ç®¡ç†ç›‘æ§ä¼—å¤šçš„dubboæœåŠ¡ï¼Œå®˜æ–¹æä¾›äº†ä¸€ä¸ªå¯è§†åŒ–çš„ç›‘æ§ç¨‹åºï¼Œä¸è¿‡è¿™ä¸ªç›‘æ§å³ä½¿ä¸è£…ä¹Ÿä¸å½±å“ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;1ã€ä¸‹è½½dubbo-admin&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/apache/incubator-dubbo-ops&#34;&gt;https://github.com/apache/incubator-dubbo-ops&lt;/a&gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;17&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/dubbo-admin%E4%B8%8B%E8%BD%BD.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;2ã€è¿›å…¥ç›®å½•ï¼Œä¿®æ”¹dubbo-adminé…ç½®&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹ src\main\resources\application.properties æŒ‡å®šzookeeperåœ°å€&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;18&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/dubbo-admin%E9%85%8D%E7%BD%AE.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;3ã€æ‰“åŒ…dubbo-admin&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mvn clean package -Dmaven.test.skip=trueÂ 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;4ã€è¿è¡Œdubbo-admin&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;java -jar dubbo-admin-0.0.1-SNAPSHOT.jar
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;æ³¨æ„ï¼šã€æœ‰å¯èƒ½æ§åˆ¶å°çœ‹ç€å¯åŠ¨äº†ï¼Œä½†æ˜¯ç½‘é¡µæ‰“ä¸å¼€ï¼Œéœ€è¦åœ¨æ§åˆ¶å°æŒ‰ä¸‹ctrl+cå³å¯ã€‘&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;é»˜è®¤ä½¿ç”¨root/root ç™»é™†&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;19&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%BF%90%E8%A1%8Cdubbo-admin.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;33-linux-å®‰è£…zookeeper&#34;&gt;3.3ï¼‰ã€ã€linuxã€‘-å®‰è£…zookeeper&lt;/h3&gt;
&lt;p&gt;&lt;em&gt;1ã€å®‰è£…jdk&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;1ã€ä¸‹è½½jdk&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html&#34;&gt;http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html&lt;/a&gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;20&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E4%B8%8B%E8%BD%BDjdk.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ä¸è¦ä½¿ç”¨wgetå‘½ä»¤è·å–jdké“¾æ¥ï¼Œè¿™æ˜¯é»˜è®¤ä¸åŒæ„ï¼Œå¯¼è‡´ä¸‹è½½æ¥çš„jdkå‹ç¼©å†…å®¹é”™è¯¯&lt;/p&gt;
&lt;p&gt;2ã€ä¸Šä¼ åˆ°æœåŠ¡å™¨å¹¶è§£å‹&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;21&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/jdk%E8%A7%A3%E5%8E%8B.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;3ã€è®¾ç½®ç¯å¢ƒå˜é‡&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/usr/local/java/jdk1.8.0_171
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;22&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%AE%BE%E7%BD%AE%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;æ–‡ä»¶æœ«å°¾åŠ å…¥ä¸‹é¢é…ç½®&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;export JAVA_HOME=/usr/local/java/jdk1.8.0_171

export JRE_HOME=${JAVA_HOME}/jre

export CLASSPATH=.:${JAVA_HOME}/lib:${JRE_HOME}/lib

export PATH=${JAVA_HOME}/bin:$PATH
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;23&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/jdk%E8%AE%BE%E7%BD%AE%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;4ã€ä½¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ&amp;amp;æµ‹è¯•JDK&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;24&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/jdk%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E7%94%9F%E6%95%88.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;em&gt;2ã€å®‰è£…zookeeper&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;1ã€ä¸‹è½½zookeeper&lt;/p&gt;
&lt;p&gt;ç½‘å€Â &lt;a href=&#34;https://archive.apache.org/dist/zookeeper/zookeeper-3.4.11/&#34;&gt;https://archive.apache.org/dist/zookeeper/zookeeper-3.4.11/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;wget &lt;a href=&#34;https://archive.apache.org/dist/zookeeper/zookeeper-3.4.11/zookeeper-3.4.11.tar.gz&#34;&gt;https://archive.apache.org/dist/zookeeper/zookeeper-3.4.11/zookeeper-3.4.11.tar.gz&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;2ã€è§£å‹&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;25&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%A7%A3%E5%8E%8Bzk.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;3ã€ç§»åŠ¨åˆ°æŒ‡å®šä½ç½®å¹¶æ”¹åä¸ºzookeeper&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;26&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/zk%E7%A7%BB%E5%8A%A8%E5%91%BD%E5%90%8D.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;27&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/zk%E6%9F%A5%E7%9C%8B%E7%9B%AE%E5%BD%95.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;em&gt;3ã€å¼€æœºå¯åŠ¨zookeeper&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;1ï¼‰-å¤åˆ¶å¦‚ä¸‹è„šæœ¬&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#!/bin/bash

#chkconfig:2345 20 90

#description:zookeeper

#processname:zookeeper

ZK_PATH=/usr/local/zookeeper

export JAVA_HOME=/usr/local/java/jdk1.8.0_171

case $1 in

Â Â Â Â Â Â Â Â Â start) sh Â $ZK_PATH/bin/zkServer.sh start;;

Â Â Â Â Â Â Â Â Â stop) Â sh Â $ZK_PATH/bin/zkServer.sh stop;;

Â Â Â Â Â Â Â Â Â status) sh Â $ZK_PATH/bin/zkServer.sh status;;

Â Â Â Â Â Â Â Â Â restart) sh $ZK_PATH/bin/zkServer.sh restart;;

Â Â Â Â Â Â Â Â Â *) Â echo &amp;quot;require start|stop|status|restart&amp;quot; Â ;;

esac
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;28&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%BC%80%E6%9C%BA%E5%90%AF%E5%8A%A8zk.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;2ï¼‰-æŠŠè„šæœ¬æ³¨å†Œä¸ºService&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;29&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%84%9A%E6%9C%AC%E6%B3%A8%E5%86%8C%E4%B8%BAservice.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;3ï¼‰-å¢åŠ æƒé™&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;30&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%A2%9E%E5%8A%A0%E6%9D%83%E9%99%90.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;em&gt;4ã€é…ç½®zookeeper&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;1ã€åˆå§‹åŒ–zookeeperé…ç½®æ–‡ä»¶&lt;/p&gt;
&lt;p&gt;æ‹·è´/usr/local/zookeeper/conf/zoo_sample.cfg&lt;/p&gt;
&lt;p&gt;åˆ°åŒä¸€ä¸ªç›®å½•ä¸‹æ”¹ä¸ªåå­—å«zoo.cfg&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;31&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%88%9D%E5%A7%8B%E5%8C%96zk%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;2ã€å¯åŠ¨zookeeper&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;32&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%90%AF%E5%8A%A8zk.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;34-linux-å®‰è£…dubbo-adminç®¡ç†æ§åˆ¶å°&#34;&gt;3.4ï¼‰ã€ã€linuxã€‘-å®‰è£…dubbo-adminç®¡ç†æ§åˆ¶å°&lt;/h3&gt;
&lt;p&gt;&lt;em&gt;1ã€å®‰è£…Tomcat8ï¼ˆæ—§ç‰ˆdubbo-adminæ˜¯warï¼Œæ–°ç‰ˆæ˜¯jarä¸éœ€è¦å®‰è£…Tomcatï¼‰&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;1ã€ä¸‹è½½Tomcat8å¹¶è§£å‹&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://tomcat.apache.org/download-80.cgi&#34;&gt;https://tomcat.apache.org/download-80.cgi&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;wget &lt;a href=&#34;http://mirrors.shu.edu.cn/apache/tomcat/tomcat-8/v8.5.32/bin/apache-tomcat-8.5.32.tar.gz&#34;&gt;http://mirrors.shu.edu.cn/apache/tomcat/tomcat-8/v8.5.32/bin/apache-tomcat-8.5.32.tar.gz&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;2ã€è§£å‹ç§»åŠ¨åˆ°æŒ‡å®šä½ç½®&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;33&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%A7%A3%E5%8E%8Btomcat.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;3ã€å¼€æœºå¯åŠ¨tomcat8&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;34&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%BC%80%E6%9C%BA%E5%90%AF%E5%8A%A8tomcat.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;å¤åˆ¶å¦‚ä¸‹è„šæœ¬&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#!/bin/bash

#chkconfig:2345 21 90

#description:apache-tomcat-8

#processname:apache-tomcat-8

CATALANA_HOME=/opt/apache-tomcat-8.5.32

export JAVA_HOME=/opt/java/jdk1.8.0_171

case $1 in

start)

Â Â Â Â echo &amp;quot;Starting Tomcat...&amp;quot; Â 

Â Â Â Â $CATALANA_HOME/bin/startup.sh

Â Â Â Â ;;

stop)

Â Â Â Â echo &amp;quot;Stopping Tomcat...&amp;quot; Â 

Â Â Â Â $CATALANA_HOME/bin/shutdown.sh

Â Â Â Â ;;

restart)

Â Â Â Â echo &amp;quot;Stopping Tomcat...&amp;quot; Â 

Â Â Â Â $CATALANA_HOME/bin/shutdown.sh

Â Â Â Â sleep 2

Â Â Â Â echo Â 

Â Â Â Â echo &amp;quot;Starting Tomcat...&amp;quot; Â 

Â Â Â Â $CATALANA_HOME/bin/startup.sh

Â Â Â Â ;;

*)

Â Â Â Â echo &amp;quot;Usage: tomcat {start|stop|restart}&amp;quot; Â 

Â Â Â Â ;; esac
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;4ã€æ³¨å†ŒæœåŠ¡&amp;amp;æ·»åŠ æƒé™&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;35&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/sgrlw1jLRksvtDuA.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;36&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/yFBPAQA9wQcuLiLK.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;5ã€å¯åŠ¨æœåŠ¡&amp;amp;è®¿é—®tomcatæµ‹è¯•&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;37&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/PCItXvgg0c8lpyxk.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;38&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/UkCJSOTip08WixDn.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;em&gt;2ã€å®‰è£…dubbo-admin&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;dubboæœ¬èº«å¹¶ä¸æ˜¯ä¸€ä¸ªæœåŠ¡è½¯ä»¶ã€‚å®ƒå…¶å®å°±æ˜¯ä¸€ä¸ªjaråŒ…èƒ½å¤Ÿå¸®ä½ çš„javaç¨‹åºè¿æ¥åˆ°zookeeperï¼Œå¹¶åˆ©ç”¨zookeeperæ¶ˆè´¹ã€æä¾›æœåŠ¡ã€‚æ‰€ä»¥ä½ ä¸ç”¨åœ¨Linuxä¸Šå¯åŠ¨ä»€ä¹ˆdubboæœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ä¸ºäº†è®©ç”¨æˆ·æ›´å¥½çš„ç®¡ç†ç›‘æ§ä¼—å¤šçš„dubboæœåŠ¡ï¼Œå®˜æ–¹æä¾›äº†ä¸€ä¸ªå¯è§†åŒ–çš„ç›‘æ§ç¨‹åºï¼Œä¸è¿‡è¿™ä¸ªç›‘æ§å³ä½¿ä¸è£…ä¹Ÿä¸å½±å“ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;1ã€ä¸‹è½½dubbo-admin&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/apache/incubator-dubbo-ops&#34;&gt;https://github.com/apache/incubator-dubbo-ops&lt;/a&gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;39&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/NB3VdgOwTJUVLKd7.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;2ã€è¿›å…¥ç›®å½•ï¼Œä¿®æ”¹dubbo-adminé…ç½®&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹ src\main\resources\application.properties æŒ‡å®šzookeeperåœ°å€&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;40&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/Ky405QqumK4BCVLb.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;3ã€æ‰“åŒ…dubbo-admin&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mvn clean package -Dmaven.test.skip=trueÂ 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;4ã€è¿è¡Œdubbo-admin&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;java -jar dubbo-admin-0.0.1-SNAPSHOT.jar
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é»˜è®¤ä½¿ç”¨root/root ç™»é™†&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;41&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/QwVB9l4fvmYkh6a2.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;4-dubbo-helloworld&#34;&gt;4ã€dubbo-helloworld&lt;/h2&gt;
&lt;h3 id=&#34;41-æå‡ºéœ€æ±‚&#34;&gt;4.1ï¼‰ã€æå‡ºéœ€æ±‚&lt;/h3&gt;
&lt;p&gt;æŸä¸ªç”µå•†ç³»ç»Ÿï¼Œè®¢å•æœåŠ¡éœ€è¦è°ƒç”¨ç”¨æˆ·æœåŠ¡è·å–æŸä¸ªç”¨æˆ·çš„æ‰€æœ‰åœ°å€ï¼›&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ç°åœ¨Â éœ€è¦åˆ›å»ºä¸¤ä¸ªæœåŠ¡æ¨¡å—è¿›è¡Œæµ‹è¯•&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;æ¨¡å—&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;åŠŸèƒ½&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;è®¢å•æœåŠ¡webæ¨¡å—&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;åˆ›å»ºè®¢å•ç­‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;ç”¨æˆ·æœåŠ¡serviceæ¨¡å—&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;æŸ¥è¯¢ç”¨æˆ·åœ°å€ç­‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;æµ‹è¯•é¢„æœŸç»“æœï¼š&lt;/p&gt;
&lt;p&gt;è®¢å•æœåŠ¡webæ¨¡å—åœ¨AæœåŠ¡å™¨ï¼Œç”¨æˆ·æœåŠ¡æ¨¡å—åœ¨BæœåŠ¡å™¨ï¼ŒAå¯ä»¥è¿œç¨‹è°ƒç”¨Bçš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;42&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/zu5t5nNfM7A5kcbM.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;42-å·¥ç¨‹æ¶æ„&#34;&gt;4.2ï¼‰ã€å·¥ç¨‹æ¶æ„&lt;/h3&gt;
&lt;p&gt;æ ¹æ®Â dubboã€ŠæœåŠ¡åŒ–æœ€ä½³å®è·µã€‹&lt;/p&gt;
&lt;p&gt;&lt;em&gt;1ã€åˆ†åŒ…&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;å»ºè®®å°†æœåŠ¡æ¥å£ï¼ŒæœåŠ¡æ¨¡å‹ï¼ŒæœåŠ¡å¼‚å¸¸ç­‰å‡æ”¾åœ¨ API åŒ…ä¸­ï¼Œå› ä¸ºæœåŠ¡æ¨¡å‹åŠå¼‚å¸¸ä¹Ÿæ˜¯ API çš„ä¸€éƒ¨åˆ†ï¼ŒåŒæ—¶ï¼Œè¿™æ ·åšä¹Ÿç¬¦åˆåˆ†åŒ…åŸåˆ™ï¼šé‡ç”¨å‘å¸ƒç­‰ä»·åŸåˆ™(REP)ï¼Œå…±åŒé‡ç”¨åŸåˆ™(CRP)ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœéœ€è¦ï¼Œä¹Ÿå¯ä»¥è€ƒè™‘åœ¨ API åŒ…ä¸­æ”¾ç½®ä¸€ä»½ spring çš„å¼•ç”¨é…ç½®ï¼Œè¿™æ ·ä½¿ç”¨æ–¹ï¼Œåªéœ€åœ¨ spring åŠ è½½è¿‡ç¨‹ä¸­å¼•ç”¨æ­¤é…ç½®å³å¯ï¼Œé…ç½®å»ºè®®æ”¾åœ¨æ¨¡å—çš„åŒ…ç›®å½•ä¸‹ï¼Œä»¥å…å†²çªï¼Œå¦‚ï¼šcom/alibaba/china/xxx/dubbo-reference.xmlã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;2ã€ç²’åº¦&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;æœåŠ¡æ¥å£å°½å¯èƒ½å¤§ç²’åº¦ï¼Œæ¯ä¸ªæœåŠ¡æ–¹æ³•åº”ä»£è¡¨ä¸€ä¸ªåŠŸèƒ½ï¼Œè€Œä¸æ˜¯æŸåŠŸèƒ½çš„ä¸€ä¸ªæ­¥éª¤ï¼Œå¦åˆ™å°†é¢ä¸´åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜ï¼ŒDubbo æš‚æœªæä¾›åˆ†å¸ƒå¼äº‹åŠ¡æ”¯æŒã€‚&lt;/p&gt;
&lt;p&gt;æœåŠ¡æ¥å£å»ºè®®ä»¥ä¸šåŠ¡åœºæ™¯ä¸ºå•ä½åˆ’åˆ†ï¼Œå¹¶å¯¹ç›¸è¿‘ä¸šåŠ¡åšæŠ½è±¡ï¼Œé˜²æ­¢æ¥å£æ•°é‡çˆ†ç‚¸ã€‚&lt;/p&gt;
&lt;p&gt;ä¸å»ºè®®ä½¿ç”¨è¿‡äºæŠ½è±¡çš„é€šç”¨æ¥å£ï¼Œå¦‚ï¼šMap query(Map)ï¼Œè¿™æ ·çš„æ¥å£æ²¡æœ‰æ˜ç¡®è¯­ä¹‰ï¼Œä¼šç»™åæœŸç»´æŠ¤å¸¦æ¥ä¸ä¾¿ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;43&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/JGqDnycGLrAYNogH.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;43-åˆ›å»ºæ¨¡å—&#34;&gt;4.3ï¼‰ã€åˆ›å»ºæ¨¡å—&lt;/h3&gt;
&lt;p&gt;&lt;em&gt;1ã€gmall-interfaceï¼šå…¬å…±æ¥å£å±‚ï¼ˆmodelï¼Œserviceï¼Œexceptionâ€¦ï¼‰&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;ä½œç”¨ï¼šå®šä¹‰å…¬å…±æ¥å£ï¼Œä¹Ÿå¯ä»¥å¯¼å…¥å…¬å…±ä¾èµ–&lt;/p&gt;
&lt;p&gt;1ã€Beanæ¨¡å‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public class UserAddress implements Serializable{
Â Â Â Â private Integer id;
Â Â Â Â private String userAddress;
Â Â Â Â private String userId;
Â Â Â Â private String consignee;
Â Â Â Â private String phoneNum;
Â Â Â Â private String isDefault;
    // getterã€setterã€Constructureã€toString
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€Serviceæ¥å£&lt;br&gt;
UserService&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;package com.atguigu.gmall.service;

import com.atguigu.gmall.bean.UserAddress;
import java.util.List;
// ç”¨æˆ·æœåŠ¡
public interface UserService {
   /**
    * æŒ‰ç…§ç”¨æˆ·idè¿”å›æ‰€æœ‰çš„æ”¶è´§åœ°å€
    * @param userId
    * @return
    */
   public List&amp;lt;UserAddress&amp;gt; getUserAddressList(String userId);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;OrderService&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;// è®¢å•æœåŠ¡
public interface OrderService {
   /**
    * åˆå§‹åŒ–è®¢å•
    * @param userId
    */
   public void initOrder(String userId);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;44&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/wyNzvleAZIggOiT2.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;em&gt;2ã€gmall-userï¼šç”¨æˆ·æ¨¡å—ï¼ˆå¯¹ç”¨æˆ·æ¥å£çš„å®ç°ï¼‰&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;1ã€pom.xml&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dependencies&amp;gt;
    &amp;lt;dependency&amp;gt;
        &amp;lt;groupId&amp;gt;com.atguigu.gmall&amp;lt;/groupId&amp;gt;
        &amp;lt;artifactId&amp;gt;gmall-interface&amp;lt;/artifactId&amp;gt;
        &amp;lt;version&amp;gt;1.0-SNAPSHOT&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;
&amp;lt;/dependencies&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€Service&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;publicÂ classÂ UserServiceImpl implementsÂ UserService {
		
	@Override
	publicÂ List&amp;lt;UserAddress&amp;gt; getUserAddressList(String userId) {
		// TODOÂ Auto-generated method stub
		returnÂ userAddressDao.getUserAddressById(userId);
	}
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;em&gt;4ã€gmall-order-webï¼šè®¢å•æ¨¡å—ï¼ˆè°ƒç”¨ç”¨æˆ·æ¨¡å—ï¼‰&lt;/em&gt;&lt;br&gt;
1ã€pom.xml&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dependencies&amp;gt;
    &amp;lt;dependency&amp;gt;
        &amp;lt;groupId&amp;gt;com.atguigu.gmall&amp;lt;/groupId&amp;gt;
        &amp;lt;artifactId&amp;gt;gmall-interface&amp;lt;/artifactId&amp;gt;
        &amp;lt;version&amp;gt;1.0-SNAPSHOT&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;
&amp;lt;/dependencies&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€æµ‹è¯•&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;publicÂ classÂ OrderService {	
	UserService userService;	
	/**
	Â * åˆå§‹åŒ–è®¢å•ï¼ŒæŸ¥è¯¢ç”¨æˆ·çš„æ‰€æœ‰åœ°å€å¹¶è¿”å›
	Â * @paramÂ userId
	Â * @return
	Â */
	publicÂ List&amp;lt;UserAddress&amp;gt; initOrder(String userId){
		returnÂ userService.getUserAddressList(userId);
	}
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç°åœ¨è¿™æ ·æ˜¯æ— æ³•è¿›è¡Œè°ƒç”¨çš„ã€‚æˆ‘ä»¬gmall-order-webå¼•å…¥äº†gmall-interfaceï¼Œä½†æ˜¯interfaceçš„å®ç°æ˜¯gmall-userï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰å¼•å…¥ï¼Œè€Œä¸”å®é™…ä»–å¯èƒ½è¿˜åœ¨åˆ«çš„æœåŠ¡å™¨ä¸­ã€‚&lt;/p&gt;
&lt;h3 id=&#34;44-ä½¿ç”¨dubboæ”¹é€ &#34;&gt;4.4ï¼‰ã€ä½¿ç”¨dubboæ”¹é€ &lt;/h3&gt;
&lt;p&gt;&lt;em&gt;1ã€æ”¹é€ gmall-userä½œä¸ºæœåŠ¡æä¾›è€…&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;1ï¼‰å¯¼å…¥ dubbo ä¾èµ–ï¼ˆ2.6.2ï¼‰ã€å¯¼å…¥æ“ä½œ zookeeper çš„å®¢æˆ·ç«¯ï¼ˆcuratorï¼‰&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;		&amp;lt;!-- å¼•å…¥dubboÂ --&amp;gt;
		&amp;lt;dependency&amp;gt;
			&amp;lt;groupId&amp;gt;com.alibaba&amp;lt;/groupId&amp;gt;
			&amp;lt;artifactId&amp;gt;dubbo&amp;lt;/artifactId&amp;gt;
			&amp;lt;version&amp;gt;2.6.2&amp;lt;/version&amp;gt;
		&amp;lt;/dependency&amp;gt;
	&amp;lt;!-- ç”±äºæˆ‘ä»¬ä½¿ç”¨zookeeperä½œä¸ºæ³¨å†Œä¸­å¿ƒï¼Œæ‰€ä»¥éœ€è¦æ“ä½œzookeeper
	dubbo 2.6ä»¥å‰çš„ç‰ˆæœ¬å¼•å…¥zkclientæ“ä½œzookeeperÂ 
	dubbo 2.6åŠä»¥åçš„ç‰ˆæœ¬å¼•å…¥curatoræ“ä½œzookeeper
	ä¸‹é¢ä¸¤ä¸ªzkå®¢æˆ·ç«¯æ ¹æ®dubboç‰ˆæœ¬2é€‰1å³å¯
		&amp;lt;dependency&amp;gt;
			&amp;lt;groupId&amp;gt;com.101tec&amp;lt;/groupId&amp;gt;
			&amp;lt;artifactId&amp;gt;zkclient&amp;lt;/artifactId&amp;gt;
			&amp;lt;version&amp;gt;0.10&amp;lt;/version&amp;gt;
		&amp;lt;/dependency&amp;gt;
    --&amp;gt;
		&amp;lt;!-- curator-framework --&amp;gt;
		&amp;lt;dependency&amp;gt;
			&amp;lt;groupId&amp;gt;org.apache.curator&amp;lt;/groupId&amp;gt;
			&amp;lt;artifactId&amp;gt;curator-framework&amp;lt;/artifactId&amp;gt;
			&amp;lt;version&amp;gt;2.12.0&amp;lt;/version&amp;gt;
		&amp;lt;/dependency&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ï¼‰é…ç½®æä¾›è€…&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;beans xmlns=&amp;quot;http://www.springframework.org/schema/beans&amp;quot;
       xmlns:xsi=&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;
       xmlns:dubbo=&amp;quot;http://dubbo.apache.org/schema/dubbo&amp;quot;
       xsi:schemaLocation=&amp;quot;http://www.springframework.org/schema/beans        http://www.springframework.org/schema/beans/spring-beans-4.3.xsd        http://dubbo.apache.org/schema/dubbo        http://dubbo.apache.org/schema/dubbo/dubbo.xsd&amp;quot;&amp;gt;

    &amp;lt;!-- 1.æŒ‡å®šå½“å‰æœåŠ¡/åº”ç”¨çš„åå­—ï¼ˆåŒæ ·çš„æœåŠ¡åå­—ç›¸åŒï¼Œä¸è¦å’Œåˆ«çš„æœåŠ¡åŒåï¼‰ --&amp;gt;
    &amp;lt;dubbo:application name=&amp;quot;user-service-provider&amp;quot;  /&amp;gt;

    &amp;lt;!-- 2.æŒ‡å®šæ³¨å†Œä¸­å¿ƒçš„ä½ç½® --&amp;gt;
    &amp;lt;dubbo:registry address=&amp;quot;zookeeper://127.0.0.1:2181&amp;quot; /&amp;gt;

    &amp;lt;!-- 3.æŒ‡å®šé€šä¿¡è§„åˆ™ï¼ˆé€šä¿¡åè®®ã€é€šä¿¡ç«¯å£ï¼‰ --&amp;gt;
    &amp;lt;dubbo:protocol name=&amp;quot;dubbo&amp;quot; port=&amp;quot;20880&amp;quot; /&amp;gt;

    &amp;lt;!-- 4.æš´éœ²æœåŠ¡ refï¼šæŒ‡å‘æœåŠ¡çš„çœŸæ­£å®ç°å¯¹è±¡--&amp;gt;
    &amp;lt;dubbo:service interface=&amp;quot;com.atguigu.gmall.service.UserService&amp;quot; ref=&amp;quot;userServiceImpl&amp;quot; /&amp;gt;

    &amp;lt;!-- æœåŠ¡çš„å®ç°  --&amp;gt;
    &amp;lt;bean id=&amp;quot;userServiceImpl&amp;quot; class=&amp;quot;com.atguigu.gmall.service.impl.UserServiceImpl&amp;quot; /&amp;gt;
&amp;lt;/beans&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3ï¼‰å¯åŠ¨æœåŠ¡&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;package com.atguigu.gmall;
import org.springframework.context.support.ClassPathXmlApplicationContext;
import java.io.IOException;
public class MainApplication {
    public static void main(String[] args) throws IOException {
        ClassPathXmlApplicationContext ioc = new ClassPathXmlApplicationContext(&amp;quot;provider.xml&amp;quot;);
        ioc.start();
        System.in.read();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;45&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/STJJRpsgwTkLRkmY.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;4ï¼‰æµ‹è¯•&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;46&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/reVohj16x2sHjsEN.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;em&gt;2ã€æ”¹é€ gmall-order-webä½œä¸ºæœåŠ¡æ¶ˆè´¹è€…&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;1ï¼‰å¼•å…¥dubbo&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;		&amp;lt;!-- å¼•å…¥dubboÂ --&amp;gt;
		&amp;lt;dependency&amp;gt;
			&amp;lt;groupId&amp;gt;com.alibaba&amp;lt;/groupId&amp;gt;
			&amp;lt;artifactId&amp;gt;dubbo&amp;lt;/artifactId&amp;gt;
			&amp;lt;version&amp;gt;2.6.2&amp;lt;/version&amp;gt;
		&amp;lt;/dependency&amp;gt;
	&amp;lt;!-- ç”±äºæˆ‘ä»¬ä½¿ç”¨zookeeperä½œä¸ºæ³¨å†Œä¸­å¿ƒï¼Œæ‰€ä»¥éœ€è¦å¼•å…¥zkclientæˆ–curatoræ“ä½œzookeeperÂ --&amp;gt;
		&amp;lt;!-- curator-framework --&amp;gt;
		&amp;lt;dependency&amp;gt;
			&amp;lt;groupId&amp;gt;org.apache.curator&amp;lt;/groupId&amp;gt;
			&amp;lt;artifactId&amp;gt;curator-framework&amp;lt;/artifactId&amp;gt;
			&amp;lt;version&amp;gt;2.12.0&amp;lt;/version&amp;gt;
		&amp;lt;/dependency&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ï¼‰é…ç½®æ¶ˆè´¹è€…ä¿¡æ¯&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;UTF-8&amp;quot;?&amp;gt;
&amp;lt;beans xmlns=&amp;quot;http://www.springframework.org/schema/beans&amp;quot;
       xmlns:xsi=&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;
       xmlns:dubbo=&amp;quot;http://dubbo.apache.org/schema/dubbo&amp;quot; xmlns:context=&amp;quot;http://www.springframework.org/schema/context&amp;quot;
       xsi:schemaLocation=&amp;quot;http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans-4.3.xsd
       http://dubbo.apache.org/schema/dubbo
       http://dubbo.apache.org/schema/dubbo/dubbo.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&amp;quot;&amp;gt;
    &amp;lt;!-- 1.æŒ‡å®šå½“å‰æœåŠ¡/åº”ç”¨çš„åå­—ï¼ˆåŒæ ·çš„æœåŠ¡åå­—ç›¸åŒï¼Œä¸è¦å’Œåˆ«çš„æœåŠ¡åŒå --&amp;gt;
    &amp;lt;dubbo:application name=&amp;quot;order-service-consumer&amp;quot;  /&amp;gt;

    &amp;lt;!-- 2.æ³¨å†Œä¸­å¿ƒåœ°å€ --&amp;gt;
    &amp;lt;dubbo:registry address=&amp;quot;zookeeper://127.0.0.1:2181&amp;quot; /&amp;gt;

    &amp;lt;!-- 3.å£°æ˜éœ€è¦è°ƒç”¨çš„è¿œç¨‹æœåŠ¡çš„æ¥å£ --&amp;gt;
    &amp;lt;dubbo:reference interface=&amp;quot;com.atguigu.gmall.service.UserService&amp;quot; id=&amp;quot;userService&amp;quot; /&amp;gt;
    &amp;lt;!-- åŒ…æ‰«æ --&amp;gt;
    &amp;lt;context:component-scan base-package=&amp;quot;com.atguigu.gmall.service.impl&amp;quot;&amp;gt;&amp;lt;/context:component-scan&amp;gt;
&amp;lt;/beans&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3ï¼‰Service æ³¨è§£&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;package com.atguigu.gmall.service.impl;

import com.atguigu.gmall.bean.UserAddress;
import com.atguigu.gmall.service.OrderService;
import com.atguigu.gmall.service.UserService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import java.util.List;

/**
 * 1.è®©æœåŠ¡æä¾›è€…æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒï¼ˆæš´éœ²æœåŠ¡ï¼‰
 *  1ï¼‰å¯¼å…¥ dubbo ä¾èµ–ï¼ˆ2.6.2ï¼‰ã€å¯¼å…¥æ“ä½œ zookeeper çš„å®¢æˆ·ç«¯ï¼ˆcuratorï¼‰
 *  2ï¼‰é…ç½®æœåŠ¡æä¾›è€…
 * 2.è®©æ¶ˆè´¹è€…å»æ³¨å†Œä¸­å¿ƒè®¢é˜…æœåŠ¡æä¾›è€…çš„åœ°å€
 */
@Service
public class OrderServiceImpl implements OrderService {
    @Autowired
    UserService userService;
    @Override
    public void initOrder(String userId) {
        // 1. æŸ¥è¯¢ç”¨æˆ·æ”¶è´§åœ°å€
        List&amp;lt;UserAddress&amp;gt; list = userService.getUserAddressList(userId);
        System.out.println(list);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;4ï¼‰mainæ–¹æ³•æµ‹è¯•&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;package com.atguigu.gmall;

import com.atguigu.gmall.service.OrderService;
import org.springframework.context.support.ClassPathXmlApplicationContext;

import java.io.IOException;

public class MainApplication {
    public static void main(String[] args) throws IOException {
        ClassPathXmlApplicationContext applicationContext = new ClassPathXmlApplicationContext(&amp;quot;consumer.xml&amp;quot;);
        OrderService orderService = applicationContext.getBean(OrderService.class);
        orderService.initOrder(&amp;quot;1&amp;quot;);
        System.out.println(&amp;quot;è°ƒç”¨ç»“æŸ...&amp;quot;);

        System.in.read();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;em&gt;3ã€æµ‹è¯•è°ƒç”¨&lt;/em&gt;&lt;br&gt;
è®¿é—®gmall-order-webçš„initOrderè¯·æ±‚ï¼Œä¼šè°ƒç”¨UserServiceè·å–ç”¨æˆ·åœ°å€ï¼›&lt;/p&gt;
&lt;p&gt;è°ƒç”¨æˆåŠŸã€‚è¯´æ˜æˆ‘ä»¬orderå·²ç»å¯ä»¥è°ƒç”¨è¿œç¨‹çš„UserServiceäº†ï¼›&lt;/p&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ç”¨æˆ· id ï¼š1
åŒ—äº¬å¸‚æ˜Œå¹³åŒºå®ç¦ç§‘æŠ€å›­ç»¼åˆæ¥¼3å±‚
æ·±åœ³å¸‚å®å®‰åŒºè¥¿éƒ¨ç¡…è°·å¤§å¦Båº§3å±‚ï¼ˆæ·±åœ³åˆ†æ ¡ï¼‰
è°ƒç”¨ç»“æŸ...
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;47&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/60BuhhwD1HUmxziW.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;em&gt;4ã€æ³¨è§£ç‰ˆ&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;1ã€æœåŠ¡æä¾›æ–¹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dubbo:applicationÂ name=&amp;quot;gmall-user&amp;quot;&amp;gt;&amp;lt;/dubbo:application&amp;gt;  
&amp;lt;dubbo:registryÂ address=&amp;quot;zookeeper://118.24.44.169:2181&amp;quot;Â /&amp;gt;  
&amp;lt;dubbo:protocolÂ name=&amp;quot;dubbo&amp;quot;Â port=&amp;quot;20880&amp;quot;Â /&amp;gt;
&amp;lt;dubbo:annotationÂ package=*&amp;quot;com.atguigu.gmall.user.impl&amp;quot;/&amp;gt;  

importÂ com.alibaba.dubbo.config.annotation.Service;
importÂ com.atguigu.gmall.bean.UserAddress;  
importÂ com.atguigu.gmall.service.UserService;  
importÂ com.atguigu.gmall.user.mapper.UserAddressMapper;

@Service //ä½¿ç”¨dubboæä¾›çš„serviceæ³¨è§£ï¼Œæ³¨å†Œæš´éœ²æœåŠ¡
public classÂ UserServiceImpl implementsÂ UserService {	
     @Autowired		
    UserAddressMapper userAddressMapper; 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;2ã€æœåŠ¡æ¶ˆè´¹æ–¹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dubbo:applicationÂ name=&amp;quot;gmall-order-web&amp;quot;&amp;gt;&amp;lt;/dubbo:application&amp;gt;  
&amp;lt;dubbo:registryÂ address=&amp;quot;zookeeper://118.24.44.169:2181&amp;quot;Â /&amp;gt;  
&amp;lt;dubbo:annotationÂ package=&amp;quot;com.atguigu.gmall.order.controller&amp;quot;/&amp;gt;

@Controller  
public classÂ OrderController {  	  	
    @Reference Â //ä½¿ç”¨dubboæä¾›çš„referenceæ³¨è§£å¼•ç”¨è¿œç¨‹æœåŠ¡  	
    UserService userService; 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;5-ç›‘æ§ä¸­å¿ƒ&#34;&gt;5ã€ç›‘æ§ä¸­å¿ƒ&lt;/h2&gt;
&lt;h3 id=&#34;51-dubbo-admin&#34;&gt;5.1ï¼‰ã€dubbo-admin&lt;/h3&gt;
&lt;p&gt;å›¾å½¢åŒ–çš„æœåŠ¡ç®¡ç†é¡µé¢ï¼›å®‰è£…æ—¶éœ€è¦æŒ‡å®šæ³¨å†Œä¸­å¿ƒåœ°å€ï¼Œå³å¯ä»æ³¨å†Œä¸­å¿ƒä¸­è·å–åˆ°æ‰€æœ‰çš„æä¾›è€…/æ¶ˆè´¹è€…è¿›è¡Œé…ç½®ç®¡ç†&lt;/p&gt;
&lt;h3 id=&#34;52-dubbo-monitor-simple&#34;&gt;5.2ï¼‰ã€dubbo-monitor-simple&lt;/h3&gt;
&lt;p&gt;ç®€å•çš„ç›‘æ§ä¸­å¿ƒï¼›&lt;/p&gt;
&lt;p&gt;&lt;em&gt;1ã€å®‰è£…&lt;/em&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;1ã€ä¸‹è½½ dubbo-ops  &lt;a href=&#34;https://github.com/apache/incubator-dubbo-ops&#34;&gt;https://github.com/apache/incubator-dubbo-ops&lt;/a&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;2ã€ä¿®æ”¹é…ç½®æŒ‡å®šæ³¨å†Œä¸­å¿ƒåœ°å€è¿›å…¥Â dubbo-monitor-simple\src\main\resources\confä¿®æ”¹Â dubbo.propertiesæ–‡ä»¶&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;48&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/hiBXL60A0HIHytCX.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;3ã€æ‰“åŒ…dubbo-monitor-simplemvn clean package -Dmaven.test.skip=true&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;4ã€è§£å‹ tar.gz æ–‡ä»¶ï¼Œå¹¶è¿è¡Œstart.bat&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;49&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/3VuJjpqB1NQs3dTZ.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;å¦‚æœç¼ºå°‘servlet-apiï¼Œè‡ªè¡Œå¯¼å…¥servlet-apiå†è®¿é—®ç›‘æ§ä¸­å¿ƒ&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;5ã€å¯åŠ¨è®¿é—®8080&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;50&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/8yKt4JScy58YqdVP.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;em&gt;2ã€ç›‘æ§ä¸­å¿ƒé…ç½®&lt;/em&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ‰€æœ‰æœåŠ¡é…ç½®è¿æ¥ç›‘æ§ä¸­å¿ƒï¼Œè¿›è¡Œç›‘æ§ç»Ÿè®¡Â Â Â Â &lt;!-- ç›‘æ§ä¸­å¿ƒåè®®ï¼Œå¦‚æœä¸ºprotocol=&#34;registry&#34;ï¼Œè¡¨ç¤ºä»æ³¨å†Œä¸­å¿ƒå‘ç°ç›‘æ§ä¸­å¿ƒåœ°å€ï¼Œå¦åˆ™ç›´è¿ç›‘æ§ä¸­å¿ƒ --&gt;  	&lt;a href=&#34;dubbo:monitor%C2%A0protocol=%22registry%22&#34;&gt;dubbo:monitorÂ protocol=&amp;quot;registry&amp;quot;&lt;/a&gt;&amp;lt;/dubbo:monitor&amp;gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Simple Monitor æŒ‚æ‰ä¸ä¼šå½±å“åˆ° Consumer å’Œ Provider ä¹‹é—´çš„è°ƒç”¨ï¼Œæ‰€ä»¥ç”¨äºç”Ÿäº§ç¯å¢ƒä¸ä¼šæœ‰é£é™©ã€‚&lt;/p&gt;
&lt;p&gt;Simple Monitor é‡‡ç”¨ç£ç›˜å­˜å‚¨ç»Ÿè®¡ä¿¡æ¯ï¼Œè¯·æ³¨æ„å®‰è£…æœºå™¨çš„ç£ç›˜é™åˆ¶ï¼Œå¦‚æœè¦é›†ç¾¤ï¼Œå»ºè®®ç”¨mountå…±äº«ç£ç›˜ã€‚&lt;/p&gt;
&lt;h2 id=&#34;6-æ•´åˆspringboot&#34;&gt;6ã€æ•´åˆSpringBoot&lt;/h2&gt;
&lt;p&gt;1ï¼‰å¼•å…¥&lt;strong&gt;spring-boot-starterä»¥åŠdubboå’Œcuratorçš„ä¾èµ–&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dependency&amp;gt;
Â Â Â Â &amp;lt;groupId&amp;gt;com.alibaba.boot&amp;lt;/groupId&amp;gt;
Â Â Â Â &amp;lt;artifactId&amp;gt;dubbo-spring-boot-starter&amp;lt;/artifactId&amp;gt;
Â Â Â Â &amp;lt;version&amp;gt;0.2.0&amp;lt;/version&amp;gt;
&amp;lt;/dependency&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ³¨æ„starterç‰ˆæœ¬é€‚é…ï¼š&lt;br&gt;
&lt;img src=&#34;https://uploader.shimo.im/f/d2JLjRxIZZsumBaC.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;2ï¼‰é…ç½®application.properties&lt;/p&gt;
&lt;p&gt;&lt;em&gt;æä¾›è€…é…ç½®ï¼š&lt;/em&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;dubbo.application.name=gmall-user
dubbo.registry.protocol=zookeeper
dubbo.registry.address=192.168.67.159:2181
dubbo.scan.base-package=com.atguigu.gmall
dubbo.protocol.name=dubbo
dubbo.protocol.port=20880
dubbo.monitor.protocol=registry
## application.nameå°±æ˜¯æœåŠ¡åï¼Œä¸èƒ½è·Ÿåˆ«çš„dubboæä¾›ç«¯é‡å¤
## registry.protocolÂ  æ˜¯æŒ‡å®šæ³¨å†Œä¸­å¿ƒåè®®
## registry.address æ˜¯æ³¨å†Œä¸­å¿ƒçš„åœ°å€åŠ ç«¯å£å·
## protocol.nameÂ æ˜¯åˆ†å¸ƒå¼å›ºå®šæ˜¯dubbo,ä¸è¦æ”¹ã€‚
## base-package Â æ³¨è§£æ–¹å¼è¦æ‰«æçš„åŒ…
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;em&gt;æ¶ˆè´¹è€…é…ç½®ï¼š&lt;/em&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;server.port=8081

dubbo.application.name=gmall-order-web
dubbo.registry.protocol=zookeeper
dubbo.registry.address=192.168.67.159:2181
dubbo.scan.base-package=com.atguigu.gmall
dubbo.protocol.name=dubbo
dubbo.monitor.protocol=registry
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;3ã€dubboæ³¨è§£&lt;br&gt;
@Serviceã€@Reference&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ã€å¦‚æœæ²¡æœ‰åœ¨é…ç½®ä¸­å†™dubbo.scan.base-package,è¿˜éœ€è¦åœ¨å¯åŠ¨ç±»ä½¿ç”¨@EnableDubboæ³¨è§£ã€‘&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ¶ˆè´¹è€…ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;@Reference
UserService userService;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœåŠ¡æä¾›è€…ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;@com.alibaba.dubbo.config.annotation.Service // æš´éœ²æœåŠ¡
@Service
public class UserServiceImpl implements UserService {
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;äºŒ-dubboé…ç½®&#34;&gt;äºŒã€dubboé…ç½®&lt;/h1&gt;
&lt;h2 id=&#34;1-é…ç½®åŸåˆ™&#34;&gt;1ã€é…ç½®åŸåˆ™&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;51&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/B1hW7n2x1bYU1d7w.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;JVM å¯åŠ¨ -D å‚æ•°ä¼˜å…ˆï¼Œè¿™æ ·å¯ä»¥ä½¿ç”¨æˆ·åœ¨éƒ¨ç½²å’Œå¯åŠ¨æ—¶è¿›è¡Œå‚æ•°é‡å†™ï¼Œæ¯”å¦‚åœ¨å¯åŠ¨æ—¶éœ€æ”¹å˜åè®®çš„ç«¯å£ã€‚&lt;/p&gt;
&lt;p&gt;XML æ¬¡ä¹‹ï¼Œå¦‚æœåœ¨ XML ä¸­æœ‰é…ç½®ï¼Œåˆ™ dubbo.properties ä¸­çš„ç›¸åº”é…ç½®é¡¹æ— æ•ˆã€‚&lt;/p&gt;
&lt;p&gt;Properties æœ€åï¼Œç›¸å½“äºç¼ºçœå€¼ï¼Œåªæœ‰ XML æ²¡æœ‰é…ç½®æ—¶ï¼Œdubbo.properties çš„ç›¸åº”é…ç½®é¡¹æ‰ä¼šç”Ÿæ•ˆï¼Œé€šå¸¸ç”¨äºå…±äº«å…¬å…±é…ç½®ï¼Œæ¯”å¦‚åº”ç”¨åã€‚&lt;/p&gt;
&lt;h2 id=&#34;2-é‡è¯•æ¬¡æ•°&#34;&gt;2ã€é‡è¯•æ¬¡æ•°&lt;/h2&gt;
&lt;p&gt;å¤±è´¥è‡ªåŠ¨åˆ‡æ¢ï¼Œå½“å‡ºç°å¤±è´¥ï¼Œé‡è¯•å…¶å®ƒæœåŠ¡å™¨ï¼Œä½†é‡è¯•ä¼šå¸¦æ¥æ›´é•¿å»¶è¿Ÿã€‚å¯é€šè¿‡ retries=&amp;quot;2&amp;quot; æ¥è®¾ç½®é‡è¯•æ¬¡æ•°(ä¸å«ç¬¬ä¸€æ¬¡)ã€‚&lt;/p&gt;
&lt;p&gt;é‡è¯•æ¬¡æ•°é…ç½®å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dubbo:service retries=&amp;quot;2&amp;quot; /&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ–&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dubbo:reference retries=&amp;quot;2&amp;quot; /&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ–&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dubbo:reference&amp;gt;
Â Â Â Â &amp;lt;dubbo:method name=&amp;quot;findFoo&amp;quot; retries=&amp;quot;2&amp;quot; /&amp;gt;
&amp;lt;/dubbo:reference&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;å¹‚ç­‰æ“ä½œï¼ˆæ‰§è¡Œå¤šæ¬¡å’Œæ‰§è¡Œä¸€æ¬¡æ•ˆæœç›¸åŒï¼šæŸ¥è¯¢ã€åˆ é™¤ã€ä¿®æ”¹ï¼‰å¯è®¾ç½®é‡è¯•æ¬¡æ•°ï¼Œéå¹‚ç­‰æ“ä½œï¼ˆæ‰§è¡Œå¤šæ¬¡å’Œæ‰§è¡Œä¸€æ¬¡æ•ˆæœä¸åŒï¼šæ–°å¢ï¼‰ä¸å®œè®¾ç½®é‡è¯•æ¬¡æ•°&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;3-è¶…æ—¶æ—¶é—´&#34;&gt;3ã€è¶…æ—¶æ—¶é—´&lt;/h2&gt;
&lt;p&gt;ç”±äºç½‘ç»œæˆ–æœåŠ¡ç«¯ä¸å¯é ï¼Œä¼šå¯¼è‡´è°ƒç”¨å‡ºç°ä¸€ç§ä¸ç¡®å®šçš„ä¸­é—´çŠ¶æ€ï¼ˆè¶…æ—¶ï¼‰ã€‚ä¸ºäº†é¿å…è¶…æ—¶å¯¼è‡´å®¢æˆ·ç«¯èµ„æºï¼ˆçº¿ç¨‹ï¼‰æŒ‚èµ·è€—å°½ï¼Œå¿…é¡»è®¾ç½®è¶…æ—¶æ—¶é—´ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æœåŠ¡æ¶ˆè´¹æ–¹å¼•ç”¨æœåŠ¡æä¾›æ–¹æ—¶ï¼Œå¯èƒ½æœ‰é›¨ç½‘ç»œç­‰åŸå› ï¼ŒæœåŠ¡æä¾›æ–¹è¦æ‰§è¡Œä¸€ä¸ªæ–¹æ³•å¯èƒ½æœ‰å¾ˆé•¿æ—¶é—´ï¼Œå¦‚æœå¾ˆé•¿æ—¶é—´éƒ½æ²¡æœ‰è¿”å›ï¼Œå¯¼è‡´å¤§é‡çº¿ç¨‹é˜»å¡ï¼Œå¯èƒ½ä¼šå¼•èµ·æ€§èƒ½ä¸‹é™ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥æŒ‡å®šè¶…æ—¶æ—¶é—´ï¼Œåªè¦è¿™ä¸ªæ–¹æ³•åœ¨æŒ‡å®šæ—¶é—´å†…æ²¡æœ‰è¿”å›ï¼Œå°±ç«‹å³ç»ˆæ­¢ï¼Œä¸è®©å¤§é‡çº¿ç¨‹é˜»å¡ã€‚è®¾ç½®å•ä½ ms&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;1-dubboæ¶ˆè´¹ç«¯&#34;&gt;1ã€Dubboæ¶ˆè´¹ç«¯&lt;/h3&gt;
&lt;p&gt;å…¨å±€è¶…æ—¶é…ç½®&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dubbo:consumer timeout=&amp;quot;5000&amp;quot; /&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æŒ‡å®šæ¥å£ä»¥åŠç‰¹å®šæ–¹æ³•è¶…æ—¶é…ç½®&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dubbo:reference interface=&amp;quot;com.foo.BarService&amp;quot; timeout=&amp;quot;2000&amp;quot;&amp;gt;
Â Â Â Â &amp;lt;dubbo:method name=&amp;quot;sayHello&amp;quot; timeout=&amp;quot;3000&amp;quot; /&amp;gt;
&amp;lt;/dubbo:reference&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;2-dubboæœåŠ¡ç«¯&#34;&gt;2ã€DubboæœåŠ¡ç«¯&lt;/h3&gt;
&lt;p&gt;å…¨å±€è¶…æ—¶é…ç½®&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dubbo:provider timeout=&amp;quot;5000&amp;quot; /&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æŒ‡å®šæ¥å£ä»¥åŠç‰¹å®šæ–¹æ³•è¶…æ—¶é…ç½®&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dubbo:provider interface=&amp;quot;com.foo.BarService&amp;quot; timeout=&amp;quot;2000&amp;quot;&amp;gt;
Â Â Â Â &amp;lt;dubbo:method name=&amp;quot;sayHello&amp;quot; timeout=&amp;quot;3000&amp;quot; /&amp;gt;
&amp;lt;/dubbo:provider&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;3-é…ç½®åŸåˆ™&#34;&gt;3ã€é…ç½®åŸåˆ™&lt;/h3&gt;
&lt;p&gt;dubboæ¨èåœ¨Providerä¸Šå°½é‡å¤šé…ç½®Consumerç«¯å±æ€§ï¼š&lt;/p&gt;
&lt;p&gt;1ã€ä½œæœåŠ¡çš„æä¾›è€…ï¼Œæ¯”æœåŠ¡ä½¿ç”¨æ–¹æ›´æ¸…æ¥šæœåŠ¡æ€§èƒ½å‚æ•°ï¼Œå¦‚è°ƒç”¨çš„è¶…æ—¶æ—¶é—´ï¼Œåˆç†çš„é‡è¯•æ¬¡æ•°ï¼Œç­‰ç­‰&lt;/p&gt;
&lt;p&gt;2ã€åœ¨Provideré…ç½®åï¼ŒConsumerä¸é…ç½®åˆ™ä¼šä½¿ç”¨Providerçš„é…ç½®å€¼ï¼Œå³Provideré…ç½®å¯ä»¥ä½œä¸ºConsumerçš„ç¼ºçœå€¼ã€‚å¦åˆ™ï¼ŒConsumerä¼šä½¿ç”¨Consumerç«¯çš„å…¨å±€è®¾ç½®ï¼Œè¿™å¯¹äºProviderä¸å¯æ§çš„ï¼Œå¹¶ä¸”å¾€å¾€æ˜¯ä¸åˆç†çš„&lt;/p&gt;
&lt;p&gt;é…ç½®çš„è¦†ç›–è§„åˆ™ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æ–¹æ³•çº§åˆ«é…ç½®ä¼˜äºæ¥å£çº§åˆ«ï¼Œå³å°Scopeä¼˜å…ˆ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Consumerç«¯é…ç½® ä¼˜äº Provideré…ç½® ä¼˜äº å…¨å±€é…ç½®ï¼Œ&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;3)Â æœ€åæ˜¯Dubbo Hard Codeçš„é…ç½®å€¼ï¼ˆè§é…ç½®æ–‡æ¡£ï¼‰&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;52&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/5xoy9sunaRc44qdE.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;4-ç‰ˆæœ¬å·&#34;&gt;4ã€ç‰ˆæœ¬å·&lt;/h2&gt;
&lt;p&gt;å½“ä¸€ä¸ªæ¥å£å®ç°ï¼Œå‡ºç°ä¸å…¼å®¹å‡çº§æ—¶ï¼Œå¯ä»¥ç”¨ç‰ˆæœ¬å·è¿‡æ¸¡ï¼Œç‰ˆæœ¬å·ä¸åŒçš„æœåŠ¡ç›¸äº’é—´ä¸å¼•ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥æŒ‰ç…§ä»¥ä¸‹çš„æ­¥éª¤è¿›è¡Œç‰ˆæœ¬è¿ç§»ï¼š&lt;/p&gt;
&lt;p&gt;åœ¨ä½å‹åŠ›æ—¶é—´æ®µï¼Œå…ˆå‡çº§ä¸€åŠæä¾›è€…ä¸ºæ–°ç‰ˆæœ¬&lt;/p&gt;
&lt;p&gt;å†å°†æ‰€æœ‰æ¶ˆè´¹è€…å‡çº§ä¸ºæ–°ç‰ˆæœ¬&lt;/p&gt;
&lt;p&gt;ç„¶åå°†å‰©ä¸‹çš„ä¸€åŠæä¾›è€…å‡çº§ä¸ºæ–°ç‰ˆæœ¬&lt;/p&gt;
&lt;p&gt;è€ç‰ˆæœ¬æœåŠ¡æä¾›è€…é…ç½®ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dubbo:service interface=&amp;quot;com.foo.BarService&amp;quot; version=&amp;quot;1.0.0&amp;quot; /&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ–°ç‰ˆæœ¬æœåŠ¡æä¾›è€…é…ç½®ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dubbo:service interface=&amp;quot;com.foo.BarService&amp;quot; version=&amp;quot;2.0.0&amp;quot; /&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è€ç‰ˆæœ¬æœåŠ¡æ¶ˆè´¹è€…é…ç½®ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dubbo:reference id=&amp;quot;barService&amp;quot; interface=&amp;quot;com.foo.BarService&amp;quot; version=&amp;quot;1.0.0&amp;quot; /&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ–°ç‰ˆæœ¬æœåŠ¡æ¶ˆè´¹è€…é…ç½®ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dubbo:reference id=&amp;quot;barService&amp;quot; interface=&amp;quot;com.foo.BarService&amp;quot; version=&amp;quot;2.0.0&amp;quot; /&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœä¸éœ€è¦åŒºåˆ†ç‰ˆæœ¬ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹çš„æ–¹å¼é…ç½®ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dubbo:reference id=&amp;quot;barService&amp;quot; interface=&amp;quot;com.foo.BarService&amp;quot; version=&amp;quot;*&amp;quot; /&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;5-å¯åŠ¨æ—¶æ£€æŸ¥&#34;&gt;5ã€å¯åŠ¨æ—¶æ£€æŸ¥&lt;/h2&gt;
&lt;p&gt;Dubbo ç¼ºçœä¼šåœ¨å¯åŠ¨æ—¶æ£€æŸ¥ä¾èµ–çš„æœåŠ¡æ˜¯å¦å¯ç”¨ï¼Œä¸å¯ç”¨æ—¶ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œé˜»æ­¢ Spring åˆå§‹åŒ–å®Œæˆï¼Œä»¥ä¾¿ä¸Šçº¿æ—¶ï¼Œèƒ½åŠæ—©å‘ç°é—®é¢˜ï¼Œé»˜è®¤Â check=&amp;quot;true&amp;quot;ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥é€šè¿‡Â check=&amp;quot;false&amp;quot;Â å…³é—­æ£€æŸ¥ï¼Œæ¯”å¦‚ï¼Œæµ‹è¯•æ—¶ï¼Œæœ‰äº›æœåŠ¡ä¸å…³å¿ƒï¼Œæˆ–è€…å‡ºç°äº†å¾ªç¯ä¾èµ–ï¼Œå¿…é¡»æœ‰ä¸€æ–¹å…ˆå¯åŠ¨ã€‚&lt;/p&gt;
&lt;p&gt;å¦å¤–ï¼Œå¦‚æœä½ çš„ Spring å®¹å™¨æ˜¯æ‡’åŠ è½½çš„ï¼Œæˆ–è€…é€šè¿‡ API ç¼–ç¨‹å»¶è¿Ÿå¼•ç”¨æœåŠ¡ï¼Œè¯·å…³é—­ checkï¼Œå¦åˆ™æœåŠ¡ä¸´æ—¶ä¸å¯ç”¨æ—¶ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œæ‹¿åˆ° null å¼•ç”¨ï¼Œå¦‚æœÂ check=&amp;quot;false&amp;quot;ï¼Œæ€»æ˜¯ä¼šè¿”å›å¼•ç”¨ï¼Œå½“æœåŠ¡æ¢å¤æ—¶ï¼Œèƒ½è‡ªåŠ¨è¿ä¸Šã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç¤ºä¾‹&#34;&gt;ç¤ºä¾‹&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;é€šè¿‡ spring é…ç½®æ–‡ä»¶&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å…³é—­æŸä¸ªæœåŠ¡çš„å¯åŠ¨æ—¶æ£€æŸ¥ (æ²¡æœ‰æä¾›è€…æ—¶æŠ¥é”™)ï¼šå¦‚æœå¯åŠ¨æ—¶æ²¡æœ‰æä¾›è€…å¯ä»¥æˆåŠŸå¯åŠ¨ï¼Œä½†è°ƒç”¨æ—¶å› æ²¡æœ‰æä¾›è€…è°ƒç”¨å¤±è´¥ä¼šæŠ›å‡ºå¼‚å¸¸&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dubbo:reference interface=&amp;quot;com.foo.BarService&amp;quot; check=&amp;quot;false&amp;quot; /&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é…ç½®å½“å‰æ¶ˆè´¹è€…çš„ç»Ÿä¸€è§„åˆ™ï¼Œæ‰€æœ‰çš„æœåŠ¡å¯åŠ¨æ—¶éƒ½ä¸æ£€æŸ¥ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dubbo:consumer check=&amp;quot;false&amp;quot; /&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å…³é—­æ³¨å†Œä¸­å¿ƒå¯åŠ¨æ—¶æ£€æŸ¥ (æ³¨å†Œè®¢é˜…å¤±è´¥æ—¶æŠ¥é”™)ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dubbo:registry check=&amp;quot;false&amp;quot; /&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;é€šè¿‡ dubbo.properties&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;dubbo.reference.com.foo.BarService.check=false
dubbo.reference.check=false
dubbo.consumer.check=false
dubbo.registry.check=false
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;6-å¤šç‰ˆæœ¬&#34;&gt;6ã€å¤šç‰ˆæœ¬&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://dubbo.apache.org/zh-cn/docs/user/demos/multi-versions.html&#34;&gt;http://dubbo.apache.org/zh-cn/docs/user/demos/multi-versions.html&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä½¿ç”¨åœºæ™¯ï¼šæŸä¸€ä¸ªæ¥å£åŠŸèƒ½å‡ºç°äº†ä¸å…¼å®¹çš„å‡çº§ï¼Œå…ˆè®©ä¸€éƒ¨åˆ†äººä½¿ç”¨æ–°åŠŸèƒ½ï¼Œå¦å¤–ä¸€éƒ¨åˆ†äººè¿˜æ˜¯å…ˆç”¨æ—§ç‰ˆæœ¬ï¼Œå¦‚æœæ–°åŠŸèƒ½ç‰ˆæœ¬éƒ½ç¨³å®šäº†ï¼Œå†æŠŠæ‰€æœ‰è€ç‰ˆæœ¬æ›¿æ¢æˆæ–°ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æœåŠ¡æä¾›æ–¹æä¾›æ–°æ—§ä¸¤ä¸ªç‰ˆæœ¬ä¾›æ¶ˆè´¹è€…ä½¿ç”¨&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;!-- 4.æš´éœ²æœåŠ¡ refï¼šæŒ‡å‘æœåŠ¡çš„çœŸæ­£å®ç°å¯¹è±¡--&amp;gt;
&amp;lt;dubbo:service interface=&amp;quot;com.atguigu.gmall.service.UserService&amp;quot; ref=&amp;quot;userServiceImpl01&amp;quot; version=&amp;quot;1.0.0&amp;quot;/&amp;gt;
&amp;lt;!-- æœåŠ¡çš„å®ç°  --&amp;gt;
&amp;lt;bean id=&amp;quot;userServiceImpl01&amp;quot; class=&amp;quot;com.atguigu.gmall.service.impl.UserServiceImpl&amp;quot; /&amp;gt;
&amp;lt;!-- è¿æ¥ç›‘æ§ä¸­å¿ƒ --&amp;gt;
&amp;lt;dubbo:monitor protocol=&amp;quot;registry&amp;quot;&amp;gt;&amp;lt;/dubbo:monitor&amp;gt;
&amp;lt;!-- æ£€æµ‹å¤šç‰ˆæœ¬ --&amp;gt;
&amp;lt;dubbo:service interface=&amp;quot;com.atguigu.gmall.service.UserService&amp;quot; ref=&amp;quot;userServiceImpl02&amp;quot; version=&amp;quot;2.0.0&amp;quot;/&amp;gt;
&amp;lt;bean id=&amp;quot;userServiceImpl02&amp;quot; class=&amp;quot;com.atguigu.gmall.service.impl.UserServiceImpl2&amp;quot; /&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœåŠ¡æ¶ˆè´¹æ–¹å¯é€‰æ‹©å“ªä¸€ä¸ªç‰ˆæœ¬&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;!-- 3.å£°æ˜éœ€è¦è°ƒç”¨çš„è¿œç¨‹æœåŠ¡çš„æ¥å£ --&amp;gt;
&amp;lt;dubbo:reference interface=&amp;quot;com.atguigu.gmall.service.UserService&amp;quot; id=&amp;quot;userService&amp;quot; check=&amp;quot;false&amp;quot; version=&amp;quot;2.0.0&amp;quot;/&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;ç”±æ­¤å®ç°ç°åº¦å‘å¸ƒã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;7-æœ¬åœ°å­˜æ ¹&#34;&gt;7ã€æœ¬åœ°å­˜æ ¹&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://dubbo.apache.org/zh-cn/docs/user/demos/local-stub.html&#34;&gt;http://dubbo.apache.org/zh-cn/docs/user/demos/local-stub.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¿œç¨‹æœåŠ¡åï¼Œå®¢æˆ·ç«¯é€šå¸¸åªå‰©ä¸‹æ¥å£ï¼Œè€Œå®ç°å…¨åœ¨æœåŠ¡å™¨ç«¯ï¼Œä½†æä¾›æ–¹æœ‰äº›æ—¶å€™æƒ³åœ¨å®¢æˆ·ç«¯ä¹Ÿæ‰§è¡Œéƒ¨åˆ†é€»è¾‘ï¼Œæ¯”å¦‚ï¼šåš ThreadLocal ç¼“å­˜ï¼Œæå‰éªŒè¯å‚æ•°ï¼Œè°ƒç”¨å¤±è´¥åä¼ªé€ å®¹é”™æ•°æ®ç­‰ç­‰ï¼Œæ­¤æ—¶å°±éœ€è¦åœ¨ API ä¸­å¸¦ä¸Š Stubï¼Œå®¢æˆ·ç«¯ç”Ÿæˆ Proxy å®ä¾‹ï¼Œä¼šæŠŠ Proxy é€šè¿‡æ„é€ å‡½æ•°ä¼ ç»™ StubÂ &lt;a href=&#34;http://dubbo.apache.org/zh-cn/docs/user/demos/local-stub.html#fn1&#34;&gt;[1]&lt;/a&gt;ï¼Œç„¶åæŠŠ Stub æš´éœ²ç»™ç”¨æˆ·ï¼ŒStub å¯ä»¥å†³å®šè¦ä¸è¦å»è°ƒ Proxyã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;53&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/fCMOKYxIU74ZSiof.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;åœ¨ spring é…ç½®æ–‡ä»¶ä¸­æŒ‰ä»¥ä¸‹æ–¹å¼é…ç½®ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dubbo:service interface=&amp;quot;com.foo.BarService&amp;quot; stub=&amp;quot;true&amp;quot; /&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ–&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dubbo:service interface=&amp;quot;com.foo.BarService&amp;quot; stub=&amp;quot;com.foo.BarServiceStub&amp;quot; /&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æä¾› Stub çš„å®ç°Â &lt;a href=&#34;http://dubbo.apache.org/zh-cn/docs/user/demos/local-stub.html#fn2&#34;&gt;[2]&lt;/a&gt;ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;package com.foo;
public class BarServiceStub implements BarService {
    private final BarService barService;
    
    // æ„é€ å‡½æ•°ä¼ å…¥çœŸæ­£çš„è¿œç¨‹ä»£ç†å¯¹è±¡
    public BarServiceStub(BarService barService){
        this.barService = barService;
    }
 
    public String sayHello(String name) {
        // æ­¤ä»£ç åœ¨å®¢æˆ·ç«¯æ‰§è¡Œ, ä½ å¯ä»¥åœ¨å®¢æˆ·ç«¯åšThreadLocalæœ¬åœ°ç¼“å­˜ï¼Œæˆ–é¢„å…ˆéªŒè¯å‚æ•°æ˜¯å¦åˆæ³•ï¼Œç­‰ç­‰
        try {
            return barService.sayHello(name);
        } catch (Exception e) {
            // ä½ å¯ä»¥å®¹é”™ï¼Œå¯ä»¥åšä»»ä½•AOPæ‹¦æˆªäº‹é¡¹
            return &amp;quot;å®¹é”™æ•°æ®&amp;quot;;
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Stub å¿…é¡»æœ‰å¯ä¼ å…¥ Proxy çš„æ„é€ å‡½æ•°ã€‚Â &lt;a href=&#34;http://dubbo.apache.org/zh-cn/docs/user/demos/local-stub.html#fnref1&#34;&gt;â†©ï¸&lt;/a&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨ interface æ—è¾¹æ”¾ä¸€ä¸ª Stub å®ç°ï¼Œå®ƒå®ç° BarService æ¥å£ï¼Œå¹¶æœ‰ä¸€ä¸ªä¼ å…¥è¿œç¨‹ BarService å®ä¾‹çš„æ„é€ å‡½æ•°Â &lt;a href=&#34;http://dubbo.apache.org/zh-cn/docs/user/demos/local-stub.html#fnref2&#34;&gt;â†©ï¸&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;8-springboot-ä¸-dubbo-æ•´åˆçš„ä¸‰ç§æ–¹å¼&#34;&gt;8ã€Springboot ä¸ dubbo æ•´åˆçš„ä¸‰ç§æ–¹å¼&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;ï¼ˆ1ï¼‰ application.properties&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¯¼å…¥ dubb-starterï¼Œåœ¨ application.properties ä¸­é…ç½®å±æ€§ï¼Œä½¿ç”¨ @Service æš´éœ²æœåŠ¡ï¼›ä½¿ç”¨ @Reference å¼•ç”¨æœåŠ¡&lt;/p&gt;
&lt;p&gt;ï¼ˆæ³¨æ„ @EnableDubbo å¼€å¯åŸºäºæ³¨è§£çš„ dubbo æˆ–åœ¨ properties æ–‡ä»¶ä¸­åŒ…æ‰«æï¼‰&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ï¼ˆ2ï¼‰ä¿ç•™ dubbo xmlé…ç½®æ–‡ä»¶&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¯¼å…¥ dubb-starterï¼Œä½¿ç”¨ @ImportResource å¯¼å…¥é…ç½®æ–‡ä»¶å³å¯ï¼ˆä¸å†ä½¿ç”¨ @EnableDubbo æ³¨è§£ï¼Œè½¬è€Œä½¿ç”¨ @ImportResource(locations=&amp;quot;classpath:provider.xml&amp;quot;)&lt;/p&gt;
&lt;p&gt;æš´éœ² Service ä¹Ÿä¸å†ä½¿ç”¨ @Service äº†ï¼Œå› ä¸º xml ä¸­å·²ç»è®¾ç½®äº†æš´éœ²æœåŠ¡ï¼‰&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ï¼ˆ3ï¼‰ä½¿ç”¨æ³¨è§£ API æ–¹å¼&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å°†æ¯ä¸€ä¸ªç»„ä»¶æ‰‹åŠ¨åˆ›å»ºåˆ°å®¹å™¨ä¸­ï¼Œè®© dubbo æ¥æ‰«æå…¶ä»–çš„ç»„ä»¶&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  @EnableDubbo(scanBasePackages=&amp;quot;com.atguigu.gmall&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;package com.atguigu.gmall.config;

import com.alibaba.dubbo.config.*;
import com.atguigu.gmall.service.UserService;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import java.util.ArrayList;
import java.util.List;

@Configuration
public class MyDubboConfig {

//        &amp;lt;dubbo:application name=&amp;quot;boot-user-service-provider&amp;quot;  /&amp;gt;
    @Bean
    public ApplicationConfig applicationConfig(){
        ApplicationConfig config = new ApplicationConfig();
        config.setName(&amp;quot;boot-user-service-provider&amp;quot;);
        return config;
    }

    // &amp;lt;dubbo:registry address=&amp;quot;zookeeper://127.0.0.1:2181&amp;quot; /&amp;gt;
    @Bean
    public RegistryConfig registryConfig(){
        System.out.println(&amp;quot;--------&amp;quot;);
        RegistryConfig registryConfig = new RegistryConfig();
        registryConfig.setProtocol(&amp;quot;zookeeper&amp;quot;);
        registryConfig.setAddress(&amp;quot;127.0.0.1:2181&amp;quot;);
        return registryConfig;
    }

    //&amp;lt;dubbo:protocol name=&amp;quot;dubbo&amp;quot; port=&amp;quot;20882&amp;quot; /&amp;gt;
    @Bean
    public ProtocolConfig protocolConfig(){
        ProtocolConfig config = new ProtocolConfig();
        config.setName(&amp;quot;dubbo&amp;quot;);
        config.setPort(20882);
        return config;
    }

    //    &amp;lt;dubbo:service interface=&amp;quot;com.atguigu.gmall.service.UserService&amp;quot; ref=&amp;quot;userServiceImpl01&amp;quot;&amp;gt;
    //        &amp;lt;dubbo:method name=&amp;quot;getUserAddressList&amp;quot; timeout=&amp;quot;1000&amp;quot;&amp;gt;&amp;lt;/dubbo:method&amp;gt;
    //    &amp;lt;/dubbo:service&amp;gt;
    @Bean
    public ServiceConfig&amp;lt;UserService&amp;gt; serviceConfig(UserService userService){
        ServiceConfig&amp;lt;UserService&amp;gt; config = new ServiceConfig&amp;lt;&amp;gt;();
        config.setInterface(UserService.class);
        config.setRef(userService);

        // é…ç½®æ¯ä¸€ä¸ª method ä¿¡æ¯
        MethodConfig methodConfig = new MethodConfig();
        methodConfig.setName(&amp;quot;getUserAddressList&amp;quot;);
        methodConfig.setTimeout(1000);

        // å°† method çš„è®¾ç½®å…³è”åˆ° servie ä¸­
        List&amp;lt;MethodConfig&amp;gt; methods = new ArrayList&amp;lt;&amp;gt;();
        methods.add(methodConfig);
        config.setMethods(methods);

        return config;
    }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;ä¸‰-é«˜å¯ç”¨&#34;&gt;ä¸‰ã€é«˜å¯ç”¨&lt;/h1&gt;
&lt;h2 id=&#34;1-zookeeperå®•æœºä¸dubboç›´è¿&#34;&gt;1ã€zookeeperå®•æœºä¸dubboç›´è¿&lt;/h2&gt;
&lt;p&gt;ç°è±¡ï¼šzookeeperæ³¨å†Œä¸­å¿ƒï¼ˆzkServer.cmdï¼‰å®•æœºï¼Œè¿˜å¯ä»¥æ¶ˆè´¹dubboæš´éœ²çš„æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;åŸå› ï¼š&lt;/p&gt;
&lt;p&gt;å¥å£®æ€§&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç›‘æ§ä¸­å¿ƒå®•æ‰ä¸å½±å“ä½¿ç”¨ï¼Œåªæ˜¯ä¸¢å¤±éƒ¨åˆ†é‡‡æ ·æ•°æ®&lt;/li&gt;
&lt;li&gt;æ•°æ®åº“å®•æ‰åï¼Œæ³¨å†Œä¸­å¿ƒä»èƒ½é€šè¿‡ç¼“å­˜æä¾›æœåŠ¡åˆ—è¡¨æŸ¥è¯¢ï¼Œä½†ä¸èƒ½æ³¨å†Œæ–°æœåŠ¡&lt;/li&gt;
&lt;li&gt;æ³¨å†Œä¸­å¿ƒå¯¹ç­‰é›†ç¾¤ï¼Œä»»æ„ä¸€å°å®•æ‰åï¼Œå°†è‡ªåŠ¨åˆ‡æ¢åˆ°å¦ä¸€å°&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ³¨å†Œä¸­å¿ƒå…¨éƒ¨å®•æ‰åï¼ŒæœåŠ¡æä¾›è€…å’ŒæœåŠ¡æ¶ˆè´¹è€…ä»èƒ½é€šè¿‡æœ¬åœ°ç¼“å­˜é€šè®¯&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;æœåŠ¡æä¾›è€…æ— çŠ¶æ€ï¼Œä»»æ„ä¸€å°å®•æ‰åï¼Œä¸å½±å“ä½¿ç”¨&lt;/li&gt;
&lt;li&gt;æœåŠ¡æä¾›è€…å…¨éƒ¨å®•æ‰åï¼ŒæœåŠ¡æ¶ˆè´¹è€…åº”ç”¨å°†æ— æ³•ä½¿ç”¨ï¼Œå¹¶æ— é™æ¬¡é‡è¿ç­‰å¾…æœåŠ¡æä¾›è€…æ¢å¤&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;é«˜å¯ç”¨ï¼šé€šè¿‡è®¾è®¡ï¼Œå‡å°‘ç³»ç»Ÿä¸èƒ½æä¾›æœåŠ¡çš„æ—¶é—´ï¼›&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;dubbo ç›´è¿ï¼ˆç»•è¿‡æ³¨å†Œä¸­å¿ƒï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;@Reference(url = &amp;quot;127.0.0.1:20882&amp;quot;)
UserService userService;
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;2-é›†ç¾¤ä¸‹dubboè´Ÿè½½å‡è¡¡é…ç½®&#34;&gt;2ã€é›†ç¾¤ä¸‹dubboè´Ÿè½½å‡è¡¡é…ç½®&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://dubbo.apache.org/zh-cn/docs/user/demos/loadbalance.html&#34;&gt;http://dubbo.apache.org/zh-cn/docs/user/demos/loadbalance.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åœ¨é›†ç¾¤è´Ÿè½½å‡è¡¡æ—¶ï¼ŒDubbo æä¾›äº†å¤šç§å‡è¡¡ç­–ç•¥ï¼Œç¼ºçœä¸º random éšæœºè°ƒç”¨ã€‚&lt;/p&gt;
&lt;h3 id=&#34;è´Ÿè½½å‡è¡¡ç­–ç•¥&#34;&gt;è´Ÿè½½å‡è¡¡ç­–ç•¥&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Random LoadBalance&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;éšæœºï¼ŒæŒ‰æƒé‡è®¾ç½®éšæœºæ¦‚ç‡ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ä¸€ä¸ªæˆªé¢ä¸Šç¢°æ’çš„æ¦‚ç‡é«˜ï¼Œä½†è°ƒç”¨é‡è¶Šå¤§åˆ†å¸ƒè¶Šå‡åŒ€ï¼Œè€Œä¸”æŒ‰æ¦‚ç‡ä½¿ç”¨æƒé‡åä¹Ÿæ¯”è¾ƒå‡åŒ€ï¼Œæœ‰åˆ©äºåŠ¨æ€è°ƒæ•´æä¾›è€…æƒé‡ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;54&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/t9CCH4EHEeoW2iry.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;åŸºäºæƒé‡çš„éšæœºè´Ÿè½½å‡è¡¡æœºåˆ¶ï¼šorderService æƒ³è¦è°ƒç”¨ userServiceï¼ŒuserService åˆ†åˆ«åœ¨ 1ã€2ã€3 å°æœºå™¨å†…ï¼Œåˆ†åˆ«ä¸ºæ¯ä¸€å°æœºå™¨çš„æœåŠ¡è®¾ç½®æƒé‡ä¸º 100ã€200ã€50ï¼Œæ€»æƒé‡ 350ï¼Œé‚£ä¹ˆå¯¹äº 1 å·æœºå™¨æ¥è¯´ï¼Œå®ƒçš„æ¦‚ç‡å°±æ˜¯ 100/350 = 2/7ï¼Œåœ¨è´Ÿè½½å‡è¡¡çš„æƒ…å†µä¸‹ï¼Œå¤§é‡è¯·æ±‚è¿‡æ¥ï¼Œå¤§çº¦æœ‰ 2/7 çš„è¯·æ±‚ä¼šæ¥åˆ° 1 å·æœºå™¨ã€‚ç¬¬ä¸€æ¬¡è¯·æ±‚æ¥è°ƒç”¨çš„æ˜¯ 1 å·æœºå™¨ï¼Œç¬¬äºŒæ¬¡æ¥æœ‰å¯èƒ½è¿˜è°ƒç”¨ 1 å·æœºå™¨ï¼Œä½†æ€»ä½“ä¸Šï¼ŒæŒ‰ç…§å¤§é‡è¯·æ±‚æ¦‚ç‡åˆ†å¸ƒæ¥çœ‹ï¼Œ1 å·æœºå™¨ä¼šå  2/7 çš„æ¦‚ç‡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;RoundRobin LoadBalance&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è½®å¾ªï¼ŒæŒ‰å…¬çº¦åçš„æƒé‡è®¾ç½®è½®å¾ªæ¯”ç‡ã€‚&lt;/p&gt;
&lt;p&gt;å­˜åœ¨æ…¢çš„æä¾›è€…ç´¯ç§¯è¯·æ±‚çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼šç¬¬äºŒå°æœºå™¨å¾ˆæ…¢ï¼Œä½†æ²¡æŒ‚ï¼Œå½“è¯·æ±‚è°ƒåˆ°ç¬¬äºŒå°æ—¶å°±å¡åœ¨é‚£ï¼Œä¹…è€Œä¹…ä¹‹ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½å¡åœ¨è°ƒåˆ°ç¬¬äºŒå°ä¸Šã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;55&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/fnw0VbVMqhIoKq6S.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;è½®è¯¢è´Ÿè½½å‡è¡¡æœºåˆ¶ï¼šorderService æƒ³è¦è°ƒç”¨ userServiceï¼Œç¬¬ä¸€ä¸ªè¯·æ±‚è¿‡æ¥å…ˆç”¨ 1 å· userService æœåŠ¡ï¼Œç¬¬äºŒä¸ªè¯·æ±‚è¿‡æ¥ä½¿ç”¨ 2 å· userService æœåŠ¡ï¼Œä¸‹ä¸€ä¸ªè¯·æ±‚è¿‡æ¥ä½¿ç”¨ 3 å·userService æœåŠ¡ï¼Œå†ä¸‹ä¸€æ¬¡ 1 å·ï¼Œå†ä¸‹ä¸€æ¬¡ 2 å·...... ä¾æ¬¡è½®è¯¢ã€‚&lt;br&gt;
åŸºäºæƒé‡çš„è½®è¯¢è´Ÿè½½å‡è¡¡æœºåˆ¶ï¼šä¸ºæ¯ä¸ªæœåŠ¡è®¾ç½®æƒé‡ï¼Œ3 å°æœåŠ¡å™¨çš„æƒé‡åˆ†åˆ«ä¸º 2/7ã€4/7ã€1/7ï¼ŒæŒ‰ç…§è½®è¯¢æœºåˆ¶ï¼Œç¬¬ä¸€ä¸ªè¯·æ±‚åˆ°æ¥ä½¿ç”¨ 1 å·æœåŠ¡å™¨ï¼Œç¬¬äºŒä¸ªè¯·æ±‚ä½¿ç”¨ 2 å·æœåŠ¡å™¨ï¼Œç¬¬ä¸‰ä¸ªè¯·æ±‚ä½¿ç”¨ 3 å·æœåŠ¡å™¨ï¼Œç¬¬å››ä¸ªè¯·æ±‚ä½¿ç”¨ 1 å·æœåŠ¡å™¨ï¼Œç¬¬äº”ä¸ªè¯·æ±‚ä½¿ç”¨ 2 å·æœåŠ¡å™¨ï¼Œç¬¬å…­ä¸ªè¯·æ±‚æœ¬åº”ä½¿ç”¨ 3 å·æœåŠ¡å™¨ï¼Œ&lt;strong&gt;ä½†æ˜¯&lt;/strong&gt;ï¼Œç”±äº 3 å·æœåŠ¡å™¨çš„æƒé‡æ˜¯ 1/7ï¼ˆå¦‚æœæœ‰ 7 ä¸ªè¯·æ±‚ï¼Œåˆ™ 7 ä¸ªä¹‹ä¸­çš„ 1 ä¸ªä½¿ç”¨ 3 å·æœåŠ¡å™¨ï¼‰ï¼Œå·²ç»æœ‰ç¬¬ä¸‰ä¸ªè¯·æ±‚ä½¿ç”¨äº† 3 å·æœåŠ¡å™¨ï¼Œç¬¬ä¸€ä¸ªã€ç¬¬å››ä¸ªè¯·æ±‚å·²ç»ä½¿ç”¨äº† ä¸¤æ¬¡ 1 å·æœåŠ¡å™¨ï¼Œæ‰€ä»¥ç¬¬å…­ä¸ªè¯·æ±‚åªèƒ½ä½¿ç”¨ 2 å·æœåŠ¡å™¨ï¼ŒåŒç†ï¼Œç¬¬ä¸ƒä¸ªè¯·æ±‚ä¹Ÿä½¿ç”¨ 2 å·æœåŠ¡å™¨ã€‚&lt;br&gt;
&lt;strong&gt;LeastActive LoadBalance&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æœ€å°‘æ´»è·ƒè°ƒç”¨æ•°ï¼Œç›¸åŒæ´»è·ƒæ•°çš„éšæœºï¼Œæ´»è·ƒæ•°æŒ‡è°ƒç”¨å‰åè®¡æ•°å·®ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿æ…¢çš„æä¾›è€…æ”¶åˆ°æ›´å°‘è¯·æ±‚ï¼Œå› ä¸ºè¶Šæ…¢çš„æä¾›è€…çš„è°ƒç”¨å‰åè®¡æ•°å·®ä¼šè¶Šå¤§ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;56&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/S8G9zCwCrP81SVr3.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ€å°‘æ´»è·ƒæ•°ï¼šorderService è¦è°ƒç”¨ userServiceï¼Œåœ¨ç¡®å®šè¦ä½¿ç”¨å‡ å· userServiceå‰ï¼Œæ ¹æ® â€œæ¯ä¸€ä¸ªæœåŠ¡å™¨ç»Ÿè®¡çš„ä¸Šä¸€æ¬¡çš„è°ƒç”¨æ—¶é—´â€ï¼šä¸‰å°æœåŠ¡å™¨ä¸Šä¸€æ¬¡è¯·æ±‚çš„å¤„ç†æ—¶é—´åˆ†åˆ«ä¸º 100msã€1000msã€300msï¼Œè¯´æ˜ 1 å·æœåŠ¡å™¨å¤„ç†æœ€å¿«ï¼Œäºæ˜¯æ­¤æ¬¡è¯·æ±‚ä¼šæ¥åˆ° 1 å·æœåŠ¡å™¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;ConsistentHash LoadBalance&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¸€è‡´æ€§ Hashï¼Œç›¸åŒå‚æ•°çš„è¯·æ±‚æ€»æ˜¯å‘åˆ°åŒä¸€æä¾›è€…ã€‚&lt;/p&gt;
&lt;p&gt;å½“æŸä¸€å°æä¾›è€…æŒ‚æ—¶ï¼ŒåŸæœ¬å‘å¾€è¯¥æä¾›è€…çš„è¯·æ±‚ï¼ŒåŸºäºè™šæ‹ŸèŠ‚ç‚¹ï¼Œå¹³æ‘Šåˆ°å…¶å®ƒæä¾›è€…ï¼Œä¸ä¼šå¼•èµ·å‰§çƒˆå˜åŠ¨ã€‚ç®—æ³•å‚è§ï¼š&lt;a href=&#34;http://en.wikipedia.org/wiki/Consistent_hashing&#34;&gt;http://en.wikipedia.org/wiki/Consistent_hashing&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç¼ºçœåªå¯¹ç¬¬ä¸€ä¸ªå‚æ•° Hashï¼Œå¦‚æœè¦ä¿®æ”¹ï¼Œè¯·é…ç½® &amp;lt;dubbo:parameter key=&amp;quot;hash.arguments&amp;quot; value=&amp;quot;0,1&amp;quot; /&amp;gt;&lt;/p&gt;
&lt;p&gt;ç¼ºçœç”¨ 160 ä»½è™šæ‹ŸèŠ‚ç‚¹ï¼Œå¦‚æœè¦ä¿®æ”¹ï¼Œè¯·é…ç½® &amp;lt;dubbo:parameter key=&amp;quot;hash.nodes&amp;quot; value=&amp;quot;320&amp;quot; /&amp;gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;57&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/TKBZTSuulaQxa01m.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸€è‡´æ€§ hashï¼šorderService æƒ³è¦è°ƒç”¨ userServiceï¼Œéƒ½æ˜¯è°ƒç”¨çš„åŒä¸€ä¸ª getUser æ–¹æ³•ï¼Œå°†å‚æ•° hash åçš„ä¸åŒå€¼åˆ†ä¸åˆ°ä¸åŒçš„æœåŠ¡å™¨ä¸Šã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;è´Ÿè½½å‡è¡¡é…ç½®&#34;&gt;è´Ÿè½½å‡è¡¡é…ç½®&lt;/h3&gt;
&lt;p&gt;æœåŠ¡ç«¯æœåŠ¡çº§åˆ«ï¼Œæš´éœ²æœåŠ¡æ—¶&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dubbo:service interface=&amp;quot;...&amp;quot; loadbalance=&amp;quot;roundrobin&amp;quot; /&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å®¢æˆ·ç«¯æœåŠ¡çº§åˆ«ï¼Œæ¶ˆè´¹æ—¶&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dubbo:reference interface=&amp;quot;...&amp;quot; loadbalance=&amp;quot;roundrobin&amp;quot; /&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœåŠ¡ç«¯æ–¹æ³•çº§åˆ«&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dubbo:service interface=&amp;quot;...&amp;quot;&amp;gt;
    &amp;lt;dubbo:method name=&amp;quot;...&amp;quot; loadbalance=&amp;quot;roundrobin&amp;quot;/&amp;gt;
&amp;lt;/dubbo:service&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å®¢æˆ·ç«¯æ–¹æ³•çº§åˆ«&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dubbo:reference interface=&amp;quot;...&amp;quot;&amp;gt;
    &amp;lt;dubbo:method name=&amp;quot;...&amp;quot; loadbalance=&amp;quot;roundrobin&amp;quot;/&amp;gt;
&amp;lt;/dubbo:reference&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;3-æ•´åˆhystrixæœåŠ¡ç†”æ–­ä¸é™çº§å¤„ç†&#34;&gt;3ã€æ•´åˆhystrixï¼ŒæœåŠ¡ç†”æ–­ä¸é™çº§å¤„ç†&lt;/h2&gt;
&lt;h3 id=&#34;1-æœåŠ¡é™çº§&#34;&gt;1ã€æœåŠ¡é™çº§&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;ä»€ä¹ˆæ˜¯æœåŠ¡é™çº§ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å½“æœåŠ¡å™¨å‹åŠ›å‰§å¢çš„æƒ…å†µä¸‹ï¼Œæ ¹æ®å®é™…ä¸šåŠ¡æƒ…å†µåŠæµé‡ï¼Œå¯¹ä¸€äº›æœåŠ¡å’Œé¡µé¢æœ‰ç­–ç•¥çš„ä¸å¤„ç†æˆ–æ¢ç§ç®€å•çš„æ–¹å¼å¤„ç†ï¼Œä»è€Œé‡Šæ”¾æœåŠ¡å™¨èµ„æºä»¥ä¿è¯æ ¸å¿ƒäº¤æ˜“æ­£å¸¸è¿ä½œæˆ–é«˜æ•ˆè¿ä½œã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥é€šè¿‡æœåŠ¡é™çº§åŠŸèƒ½ä¸´æ—¶å±è”½æŸä¸ªå‡ºé”™çš„éå…³é”®æœåŠ¡ï¼Œå¹¶å®šä¹‰é™çº§åçš„è¿”å›ç­–ç•¥ã€‚&lt;/p&gt;
&lt;p&gt;å‘æ³¨å†Œä¸­å¿ƒå†™å…¥åŠ¨æ€é…ç½®è¦†ç›–è§„åˆ™ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;RegistryFactory registryFactory = ExtensionLoader.getExtensionLoader(RegistryFactory.class).getAdaptiveExtension();
Registry registry = registryFactory.getRegistry(URL.valueOf(&amp;quot;zookeeper://10.20.153.10:2181&amp;quot;));
registry.register(URL.valueOf(&amp;quot;override://0.0.0.0/com.foo.BarService?category=configurators&amp;amp;dynamic=false&amp;amp;application=foo&amp;amp;mock=force:return+null&amp;quot;));
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å…¶ä¸­ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;mock=force:return+null è¡¨ç¤ºæ¶ˆè´¹æ–¹å¯¹è¯¥æœåŠ¡çš„æ–¹æ³•è°ƒç”¨éƒ½&lt;strong&gt;ç›´æ¥è¿”å› null å€¼ï¼Œä¸å‘èµ·è¿œç¨‹è°ƒç”¨&lt;/strong&gt;ã€‚ç”¨æ¥å±è”½ä¸é‡è¦æœåŠ¡ä¸å¯ç”¨æ—¶å¯¹è°ƒç”¨æ–¹çš„å½±å“ã€‚&lt;/li&gt;
&lt;li&gt;è¿˜å¯ä»¥æ”¹ä¸º mock=fail:return+null è¡¨ç¤ºæ¶ˆè´¹æ–¹å¯¹è¯¥æœåŠ¡çš„æ–¹æ³•&lt;strong&gt;è°ƒç”¨åœ¨å¤±è´¥åï¼Œå†è¿”å› null å€¼&lt;/strong&gt;ï¼Œä¸æŠ›å¼‚å¸¸ã€‚ç”¨æ¥å®¹å¿ä¸é‡è¦æœåŠ¡ä¸ç¨³å®šæ—¶å¯¹è°ƒç”¨æ–¹çš„å½±å“ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;2-é›†ç¾¤å®¹é”™&#34;&gt;2ã€é›†ç¾¤å®¹é”™&lt;/h3&gt;
&lt;p&gt;åœ¨é›†ç¾¤è°ƒç”¨å¤±è´¥æ—¶ï¼ŒDubbo æä¾›äº†å¤šç§å®¹é”™æ–¹æ¡ˆï¼Œç¼ºçœä¸º failover é‡è¯•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;é›†ç¾¤å®¹é”™æ¨¡å¼&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Failover Cluster&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¤±è´¥è‡ªåŠ¨åˆ‡æ¢ï¼Œå½“&lt;strong&gt;å‡ºç°å¤±è´¥ï¼Œé‡è¯•å…¶å®ƒæœåŠ¡å™¨&lt;/strong&gt;ã€‚é€šå¸¸ç”¨äºè¯»æ“ä½œï¼Œä½†é‡è¯•ä¼šå¸¦æ¥æ›´é•¿å»¶è¿Ÿã€‚å¯é€šè¿‡ retries=&amp;quot;2&amp;quot; æ¥è®¾ç½®é‡è¯•æ¬¡æ•°(ä¸å«ç¬¬ä¸€æ¬¡)ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;A æœåŠ¡è°ƒç”¨ B æœåŠ¡ï¼ŒB æœåŠ¡è¶…æ—¶åï¼Œé…ç½®ä¸€ä¸ªé‡è¯•æ¬¡æ•°ï¼Œå¯ä»¥é‡æ–°åˆ‡æ¢åˆ°èƒ½æä¾› BæœåŠ¡çš„å…¶ä»–æœºå™¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é‡è¯•æ¬¡æ•°é…ç½®å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dubbo:service retries=&amp;quot;2&amp;quot; /&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ–&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dubbo:reference retries=&amp;quot;2&amp;quot; /&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ–&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dubbo:reference&amp;gt;
Â Â Â Â &amp;lt;dubbo:method name=&amp;quot;findFoo&amp;quot; retries=&amp;quot;2&amp;quot; /&amp;gt;
&amp;lt;/dubbo:reference&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Failfast Cluster&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¿«é€Ÿå¤±è´¥ï¼Œåªå‘èµ·ä¸€æ¬¡è°ƒç”¨ï¼Œ&lt;strong&gt;å¤±è´¥ç«‹å³æŠ¥é”™&lt;/strong&gt;ã€‚é€šå¸¸ç”¨äºéå¹‚ç­‰æ€§çš„å†™æ“ä½œï¼Œæ¯”å¦‚æ–°å¢è®°å½•ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;A æœåŠ¡è°ƒç”¨ BæœåŠ¡ï¼Œåªå‘èµ·ä¸€æ¬¡è°ƒç”¨ï¼Œå¤±è´¥ç«‹å³æŠ¥é”™ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;Failsafe Cluster&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¤±è´¥å®‰å…¨ï¼Œå‡ºç°å¼‚å¸¸æ—¶ï¼Œç›´æ¥&lt;strong&gt;å¿½ç•¥&lt;/strong&gt;ã€‚é€šå¸¸ç”¨äºå†™å…¥å®¡è®¡æ—¥å¿—ç­‰æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Failback Cluster&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¤±è´¥è‡ªåŠ¨æ¢å¤ï¼Œåå°è®°å½•å¤±è´¥è¯·æ±‚ï¼Œå®šæ—¶é‡å‘&lt;/strong&gt;ã€‚é€šå¸¸ç”¨äºæ¶ˆæ¯é€šçŸ¥æ“ä½œã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;A æœåŠ¡è°ƒç”¨ B æœåŠ¡ï¼Œå¤±è´¥åå¯ä»¥åå°è®°å½•ä¸€ä¸‹ï¼Œéš”ä¸€æ®µæ—¶é—´å®šæ—¶å†è°ƒç”¨ä¸€æ¬¡ã€‚é€‚ç”¨äºï¼šä¸€å®šè¦æˆåŠŸçš„æœåŠ¡è°ƒç”¨&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;Forking Cluster&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¹¶è¡Œè°ƒç”¨å¤šä¸ªæœåŠ¡å™¨ï¼Œåªè¦ä¸€ä¸ªæˆåŠŸå³è¿”å›ã€‚é€šå¸¸ç”¨äº&lt;strong&gt;å®æ—¶æ€§è¦æ±‚è¾ƒé«˜&lt;/strong&gt;çš„è¯»æ“ä½œï¼Œä½†éœ€è¦æµªè´¹æ›´å¤šæœåŠ¡èµ„æºã€‚å¯é€šè¿‡ forks=&amp;quot;2&amp;quot; æ¥è®¾ç½®æœ€å¤§å¹¶è¡Œæ•°ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;A æœåŠ¡è°ƒç”¨ BæœåŠ¡ï¼Œæœ‰å¯èƒ½ä¼šå¤±è´¥ï¼Œèƒ½æä¾› B æœåŠ¡çš„åœ¨ä¸‰å°æœåŠ¡å™¨ä¸Šï¼ŒåŒæ—¶ç»™è¿™ä¸‰å°æœåŠ¡å™¨éƒ½å‘èµ·è¯·æ±‚ï¼Œåªè¦å…¶ä¸­ä¸€ä¸ªæœåŠ¡å™¨å“åº”æˆåŠŸå°±å¯ä»¥ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;Broadcast Cluster&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¹¿æ’­è°ƒç”¨æ‰€æœ‰æä¾›è€…ï¼Œé€ä¸ªè°ƒç”¨ï¼Œä»»æ„ä¸€å°æŠ¥é”™åˆ™æŠ¥é”™ [2]ã€‚é€šå¸¸ç”¨äºé€šçŸ¥æ‰€æœ‰æä¾›è€…æ›´æ–°ç¼“å­˜æˆ–æ—¥å¿—ç­‰æœ¬åœ°èµ„æºä¿¡æ¯ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;A æœåŠ¡è°ƒç”¨ BæœåŠ¡ï¼ŒB æœåŠ¡çš„æä¾›è€…æœ‰å››å°æœºå™¨ï¼Œæ¯ä¸€å°æœºå™¨éƒ½è°ƒç”¨ä¸€éï¼Œåªè¦æœ‰ä»»æ„ä¸€å°å‡ºç°é”™è¯¯ï¼Œéƒ½è®¤ä¸ºè¿™æ¬¡è°ƒç”¨æ˜¯å¤±è´¥çš„ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;é›†ç¾¤æ¨¡å¼é…ç½®&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æŒ‰ç…§ä»¥ä¸‹ç¤ºä¾‹åœ¨æœåŠ¡æä¾›æ–¹å’Œæ¶ˆè´¹æ–¹é…ç½®é›†ç¾¤æ¨¡å¼&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dubbo:service cluster=&amp;quot;failsafe&amp;quot; /&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ–&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dubbo:reference cluster=&amp;quot;failsafe&amp;quot; /&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;3-æ•´åˆhystrix&#34;&gt;3ã€æ•´åˆhystrix&lt;/h3&gt;
&lt;p&gt;Hystrix æ—¨åœ¨é€šè¿‡æ§åˆ¶é‚£äº›è®¿é—®è¿œç¨‹ç³»ç»Ÿã€æœåŠ¡å’Œç¬¬ä¸‰æ–¹åº“çš„èŠ‚ç‚¹ï¼Œä»è€Œå¯¹å»¶è¿Ÿå’Œæ•…éšœæä¾›æ›´å¼ºå¤§çš„å®¹é”™èƒ½åŠ›ã€‚Hystrixå…·å¤‡æ‹¥æœ‰å›é€€æœºåˆ¶å’Œæ–­è·¯å™¨åŠŸèƒ½çš„çº¿ç¨‹å’Œä¿¡å·éš”ç¦»ï¼Œè¯·æ±‚ç¼“å­˜å’Œè¯·æ±‚æ‰“åŒ…ï¼Œä»¥åŠç›‘æ§å’Œé…ç½®ç­‰åŠŸèƒ½&lt;/p&gt;
&lt;p&gt;&lt;em&gt;1ã€é…ç½®spring-cloud-starter-netflix-hystrix&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;spring bootå®˜æ–¹æä¾›äº†å¯¹hystrixçš„é›†æˆï¼Œç›´æ¥åœ¨pom.xmlé‡ŒåŠ å…¥ä¾èµ–ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;dependency&amp;gt;
  &amp;lt;groupId&amp;gt;org.springframework.cloud&amp;lt;/groupId&amp;gt;
  &amp;lt;artifactId&amp;gt;spring-cloud-starter-netflix-hystrix&amp;lt;/artifactId&amp;gt;
  &amp;lt;version&amp;gt;1.4.4.RELEASE&amp;lt;/version&amp;gt;
&amp;lt;/dependency&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç„¶ååœ¨Applicationç±»ä¸Šå¢åŠ @EnableHystrixæ¥å¯ç”¨hystrix starterï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;@SpringBootApplication
@EnableHystrix
public class ProviderApplication {
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;em&gt;2ã€é…ç½®Providerç«¯&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;åœ¨Dubboçš„Providerä¸Šå¢åŠ @HystrixCommandé…ç½®ï¼Œè¿™æ ·å­è°ƒç”¨å°±ä¼šç»è¿‡Hystrixä»£ç†ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;@Service(version = &amp;quot;1.0.0&amp;quot;)
public class HelloServiceImpl implements HelloService {
Â Â Â Â @HystrixCommand(commandProperties = {
Â Â Â Â Â @HystrixProperty(name = &amp;quot;circuitBreaker.requestVolumeThreshold&amp;quot;, value = &amp;quot;10&amp;quot;),
Â Â Â Â Â @HystrixProperty(name = &amp;quot;execution.isolation.thread.timeoutInMilliseconds&amp;quot;, value = &amp;quot;2000&amp;quot;) })
Â Â Â Â @Override
Â Â Â Â public String sayHello(String name) {
Â Â Â Â Â Â Â Â // System.out.println(&amp;quot;async provider received: &amp;quot; + name);
Â Â Â Â Â Â Â Â // return &amp;quot;annotation: hello, &amp;quot; + name;
Â Â Â Â Â Â Â Â throw new RuntimeException(&amp;quot;Exception to show hystrix enabled.&amp;quot;);
Â Â Â Â }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;em&gt;3ã€é…ç½®Consumerç«¯&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;å¯¹äºConsumerç«¯ï¼Œåˆ™å¯ä»¥å¢åŠ ä¸€å±‚methodè°ƒç”¨ï¼Œå¹¶åœ¨methodä¸Šé…ç½®@HystrixCommandã€‚å½“è°ƒç”¨å‡ºé”™æ—¶ï¼Œä¼šèµ°åˆ°fallbackMethod = &amp;quot;reliable&amp;quot;çš„è°ƒç”¨é‡Œã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Â  Â  @Reference(version = &amp;quot;1.0.0&amp;quot;)
Â Â Â Â private HelloService demoService;
Â Â Â Â @HystrixCommand(fallbackMethod = &amp;quot;reliable&amp;quot;)
Â Â Â Â public String doSayHello(String name) {
Â Â Â Â Â Â Â Â return demoService.sayHello(name);
Â Â Â Â }
Â Â Â Â public String reliable(String name) {
Â Â Â Â Â Â Â Â return &amp;quot;hystrix fallback value&amp;quot;;
Â Â Â Â }
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;å››-dubboåŸç†&#34;&gt;å››ã€dubboåŸç†&lt;/h1&gt;
&lt;h2 id=&#34;1-rpcåŸç†&#34;&gt;1ã€RPCåŸç†&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;58&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/VT5w26Fy18AWw61q.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ä¸€æ¬¡å®Œæ•´çš„RPCè°ƒç”¨æµç¨‹ï¼ˆåŒæ­¥è°ƒç”¨ï¼Œå¼‚æ­¥å¦è¯´ï¼‰å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;**1ï¼‰æœåŠ¡æ¶ˆè´¹æ–¹ï¼ˆclientï¼‰è°ƒç”¨ä»¥æœ¬åœ°è°ƒç”¨æ–¹å¼è°ƒç”¨æœåŠ¡ï¼› **&lt;/p&gt;
&lt;p&gt;2ï¼‰client stubæ¥æ”¶åˆ°è°ƒç”¨åè´Ÿè´£å°†æ–¹æ³•ã€å‚æ•°ç­‰ç»„è£…æˆèƒ½å¤Ÿè¿›è¡Œç½‘ç»œä¼ è¾“çš„æ¶ˆæ¯ä½“ï¼›&lt;/p&gt;
&lt;p&gt;3ï¼‰client stubæ‰¾åˆ°æœåŠ¡åœ°å€ï¼Œå¹¶å°†æ¶ˆæ¯å‘é€åˆ°æœåŠ¡ç«¯ï¼›&lt;/p&gt;
&lt;p&gt;4ï¼‰server stubæ”¶åˆ°æ¶ˆæ¯åè¿›è¡Œè§£ç ï¼›&lt;/p&gt;
&lt;p&gt;5ï¼‰server stubæ ¹æ®è§£ç ç»“æœè°ƒç”¨æœ¬åœ°çš„æœåŠ¡ï¼›&lt;/p&gt;
&lt;p&gt;6ï¼‰æœ¬åœ°æœåŠ¡æ‰§è¡Œå¹¶å°†ç»“æœè¿”å›ç»™server stubï¼›&lt;/p&gt;
&lt;p&gt;7ï¼‰server stubå°†è¿”å›ç»“æœæ‰“åŒ…æˆæ¶ˆæ¯å¹¶å‘é€è‡³æ¶ˆè´¹æ–¹ï¼›&lt;/p&gt;
&lt;p&gt;8ï¼‰client stubæ¥æ”¶åˆ°æ¶ˆæ¯ï¼Œå¹¶è¿›è¡Œè§£ç ï¼›&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;9ï¼‰æœåŠ¡æ¶ˆè´¹æ–¹å¾—åˆ°æœ€ç»ˆç»“æœã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;RPCæ¡†æ¶çš„ç›®æ ‡å°±æ˜¯è¦2~8è¿™äº›æ­¥éª¤éƒ½å°è£…èµ·æ¥ï¼Œè¿™äº›ç»†èŠ‚å¯¹ç”¨æˆ·æ¥è¯´æ˜¯é€æ˜çš„ï¼Œä¸å¯è§çš„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;2-nettyé€šä¿¡åŸç†&#34;&gt;2ã€nettyé€šä¿¡åŸç†&lt;/h2&gt;
&lt;p&gt;Nettyæ˜¯ä¸€ä¸ªå¼‚æ­¥äº‹ä»¶é©±åŠ¨çš„ç½‘ç»œåº”ç”¨ç¨‹åºæ¡†æ¶ï¼Œ ç”¨äºå¿«é€Ÿå¼€å‘å¯ç»´æŠ¤çš„é«˜æ€§èƒ½åè®®æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ã€‚å®ƒæå¤§åœ°ç®€åŒ–å¹¶ç®€åŒ–äº†TCPå’ŒUDPå¥—æ¥å­—æœåŠ¡å™¨ç­‰ç½‘ç»œç¼–ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;BIOï¼š(Blocking IO)&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;59&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/2W5W02pWhRc1tfWH.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;BIOï¼šé˜»å¡å¼ IOã€‚æ¯ä¸€ä¸ªè¯·æ±‚è¿›æ¥ï¼Œå¼€ä¸€ä¸ª Socket å¼€ä¸€ä¸ªçº¿ç¨‹æ¥å¤„ç†æ•°æ®ï¼Œè¯»å–åˆ°æ•°æ®åä¸šåŠ¡é€»è¾‘æ“ä½œå®Œæˆåè¿”å›ã€‚æœåŠ¡å™¨æ”¶åˆ°å¾ˆå¤šè¯·æ±‚ï¼ŒåŒæ—¶æ“ä½œï¼Œåœ¨è¿™ä¸ªä¸šåŠ¡é€»è¾‘å®Œæˆå‰è¿™ä¸ªçº¿ç¨‹ä¸èƒ½å¾—åˆ°é‡Šæ”¾ï¼ŒæœåŠ¡å™¨å°±ä¸èƒ½åŒæ—¶å¤„ç†å¤§é‡è¯·æ±‚ï¼Œå› ä¸ºæœ‰å¤§é‡çº¿ç¨‹åœ¨é˜»å¡ï¼Œç­‰å¾…ä¸šåŠ¡é€»è¾‘çš„å®Œæˆã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;NIO (Non-Blocking IO)&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;60&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/i2Hhf1AEfLE0e9rK.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;Channelï¼šé€šé“ï¼Œé€šé“é‡Œé¢æœ‰ Buffer ç”¨æ¥è¿›è¡Œæ•°æ®ä¼ è¾“ã€‚&lt;br&gt;
ä¸€ä¸ª Selector æ³¨å†Œè¿›äº†å¾ˆå¤šé€šé“ï¼Œæ¯ä¸ªè¯·æ±‚ä½¿ç”¨é€šé“è¿›è¡Œæ•°æ®ä¼ é€’é€šä¿¡ï¼ŒSelector é€šè¿‡ç›‘å¬å¤šä¸ªé€šé“ï¼Œå½“å‘ç°æŸä¸€ä¸ªé€šé“é‡Œçš„æ•°æ®å‡†å¤‡å¥½äº†ï¼ŒSelector æ‰§è¡Œç›¸åº”æ“ä½œã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Selector ä¸€èˆ¬ç§° ä¸º&lt;strong&gt;é€‰æ‹©å™¨&lt;/strong&gt;Â ï¼Œä¹Ÿå¯ä»¥ç¿»è¯‘ä¸º &lt;strong&gt;å¤šè·¯å¤ç”¨å™¨ï¼Œ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Connectï¼ˆè¿æ¥å°±ç»ªï¼‰ã€Acceptï¼ˆæ¥å—å°±ç»ªï¼‰ã€Readï¼ˆè¯»å°±ç»ªï¼‰ã€Writeï¼ˆå†™å°±ç»ªï¼‰&lt;/p&gt;
&lt;p&gt;NettyåŸºæœ¬åŸç†ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;61&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/M16PnkZ6fGY7YG8J.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;Netty æœåŠ¡å™¨å¯åŠ¨ï¼ˆServerBootstrap.bindï¼‰ï¼Œç»‘å®šç›‘å¬æŸä¸€ä¸ªç«¯å£ï¼Œæ¯”å¦‚ dubbo çš„20880ç«¯å£ï¼Œè¿™æ ·æ‰€æœ‰ç»™è¿™ä¸ªç«¯å£å‘çš„æ•°æ® netty å°±èƒ½æ”¶åˆ°ï¼Œå¯åŠ¨ååˆå§‹åŒ–æœåŠ¡å™¨çš„é€šé“ï¼ˆNioServerSockerChannelï¼‰ï¼Œæ³¨å†Œåˆ° selectorï¼Œselector è´Ÿè´£ç›‘å¬ accept äº‹ä»¶ï¼ˆå½“é€šé“æ¥æ”¶å‡†å¤‡å°±ç»ªåï¼Œå¤„ç†é€šé“é‡Œçš„ä¿¡æ¯ï¼‰ï¼Œnetty ä¸å®¢æˆ·ç«¯å»ºç«‹è¿æ¥ï¼Œ ç”Ÿæˆ NioSocketChannelï¼ŒæŠŠè¿™ä¸ª  é€šé“æ³¨å†Œåˆ° Selector é‡Œé¢ï¼Œè¿™ä¸ª selector ç›‘å¬ readã€write äº‹ä»¶ï¼ˆé€šé“ä¸­æ•°æ®è¯»ã€å†™å‡†å¤‡å°±ç»ªï¼‰ï¼Œè¯»å†™å‡†å¤‡å°±ç»ªåæ¥å¤„ç†è¿™ä¸ªäº‹ä»¶ï¼ŒæŠ›ç»™ç”¨æˆ·é˜Ÿåˆ—ï¼Œnetty æŠŠè¿™ä¸ªä»»åŠ¡é˜Ÿåˆ—æ‰§è¡Œå®Œ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;3-dubboåŸç†&#34;&gt;3ã€dubboåŸç†&lt;/h2&gt;
&lt;h3 id=&#34;1-dubboåŸç†-æ¡†æ¶è®¾è®¡&#34;&gt;1ã€dubboåŸç†	-æ¡†æ¶è®¾è®¡&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;62&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/mktdQ0QVP0s1eieu.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;dubbo æ¡†æ¶æ•´ä½“åˆ†å±‚ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Business ä¸šåŠ¡é€»è¾‘å±‚ï¼š&lt;br&gt;
1.1 ServiceæœåŠ¡å±‚ï¼šé¢å‘æ¥å£ç¼–ç¨‹ã€‚æ¥å£ã€å®ç°ã€‚æƒ³è¦è¿œç¨‹è°ƒç”¨åªéœ€è¦è°ƒç”¨æ¥å£çš„æ–¹æ³•ï¼Œå°±è‡ªåŠ¨è°ƒå®ç°äº†ã€‚ å¯¹äºç”¨æˆ·ç¼–ç¨‹ï¼Œåªéœ€è¦å…³å¿ƒè¿™ä¸€å±‚å°±ç»“æŸäº†ã€‚&lt;br&gt;
2.RPCå±‚ï¼šå®Œæˆè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼š&lt;br&gt;
2.1 Config é…ç½®å±‚ï¼Œå°è£…é…ç½®æ–‡ä»¶é‡Œè§£æå‡ºæ¥çš„ä¿¡æ¯ ReferenceConfigã€ServiceConfigï¼›&lt;br&gt;
2.2 Proxy æœåŠ¡ä»£ç†å±‚ï¼šåˆ©ç”¨ä»£ç†çš„æ–¹å¼ï¼Œç”Ÿæˆå®¢æˆ·ç«¯ä»£ç†å¯¹è±¡ã€æœåŠ¡ç«¯ä»£ç†å¯¹è±¡ï¼Œä»£ç†å¯¹è±¡äº’ç›¸è°ƒç”¨æ–¹æ³•ï¼›&lt;br&gt;
2.2 Registry æ³¨å†Œä¸­å¿ƒå±‚ï¼šå®ŒæˆæœåŠ¡çš„å‘ç°å’Œæ³¨å†Œï¼›å¾ˆå¤šæœåŠ¡è¦æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒï¼Œæ¶ˆè´¹è€…è¦ä»æ³¨å†Œä¸­å¿ƒè®¢é˜…æ‰€éœ€è¦çš„æœåŠ¡æ¥è°ƒç”¨ï¼›&lt;br&gt;
2.3 Cluster è·¯ç”±å±‚ï¼šè´Ÿè½½å‡è¡¡ã€‚invoker è°ƒç”¨è€…è¦è°ƒç”¨å¾ˆå¤šçš„æœåŠ¡ï¼ŒæœåŠ¡åœ¨å¾ˆå¤šæœºå™¨ä¸Šè·‘ï¼Œéœ€è¦è´Ÿè½½å‡è¡¡ï¼›&lt;br&gt;
2.4 Monitor ç›‘æ§å±‚ï¼šæ¯ä¸€æ¬¡çš„è°ƒç”¨ä¿¡æ¯éƒ½ä¼šå‘ç›‘æ§å±‚å‘é€ä¸€äº›æ•°æ®ï¼›&lt;br&gt;
2.5 Protocol è¿œç¨‹è°ƒç”¨å±‚ï¼šå°è£… RPC è°ƒç”¨ï¼ŒRPC è°ƒç”¨æ ¸å¿ƒçš„ä¸‰ä¸ªï¼šInvokerã€Protocolã€Exporterï¼›&lt;/li&gt;
&lt;li&gt;Remoting å±‚ï¼šè¿œç¨‹è¦è°ƒç”¨å°±è¦è·Ÿ Aã€Bä¸¤ä¸ªæœåŠ¡å™¨æ¶èµ·é€šä¿¡ç®¡é“ï¼Œé€šä¿¡ä»¥åŠåœ¨é€šä¿¡é—´ä¼ é€’æ•°æ®&lt;br&gt;
3.1 Exchange ä¿¡æ¯äº¤æ¢å±‚ï¼šåˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯ ExchangeClientã€æœåŠ¡ç«¯ ExchangeServer&lt;br&gt;
ä¸¤ç«¯æ¶èµ·ç½‘æ¶è¿›è¡Œæ•°æ®çš„äº’è”äº’é€šï¼›&lt;br&gt;
3.2 Transport ä¼ è¾“å±‚ï¼šçœŸæ­£ä¼ è¾“æ•°æ®ç”¨ Transporter æ¥å°è£…ä¼ è¾“çš„ï¼ŒTransporter åº•å±‚å°±æ˜¯ netty æ¡†æ¶ï¼Œnetty æ¡†æ¶å°±æ˜¯åœ¨è¿™ä¸€å±‚å°è£…ï¼›&lt;br&gt;
3.3 Serialize åºåˆ—åŒ–å±‚ï¼šåºåˆ—åŒ–&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;config é…ç½®å±‚ï¼šå¯¹å¤–é…ç½®æ¥å£ï¼Œä»¥ ServiceConfig, ReferenceConfig ä¸ºä¸­å¿ƒï¼Œå¯ä»¥ç›´æ¥åˆå§‹åŒ–é…ç½®ç±»ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ spring è§£æé…ç½®ç”Ÿæˆé…ç½®ç±»&lt;/li&gt;
&lt;li&gt;proxy æœåŠ¡ä»£ç†å±‚ï¼šæœåŠ¡æ¥å£é€æ˜ä»£ç†ï¼Œç”ŸæˆæœåŠ¡çš„å®¢æˆ·ç«¯ Stub å’ŒæœåŠ¡å™¨ç«¯ Skeleton, ä»¥ ServiceProxy ä¸ºä¸­å¿ƒï¼Œæ‰©å±•æ¥å£ä¸º ProxyFactory&lt;/li&gt;
&lt;li&gt;registry æ³¨å†Œä¸­å¿ƒå±‚ï¼šå°è£…æœåŠ¡åœ°å€çš„æ³¨å†Œä¸å‘ç°ï¼Œä»¥æœåŠ¡ URL ä¸ºä¸­å¿ƒï¼Œæ‰©å±•æ¥å£ä¸º RegistryFactory, Registry, RegistryService&lt;/li&gt;
&lt;li&gt;cluster è·¯ç”±å±‚ï¼šå°è£…å¤šä¸ªæä¾›è€…çš„è·¯ç”±åŠè´Ÿè½½å‡è¡¡ï¼Œå¹¶æ¡¥æ¥æ³¨å†Œä¸­å¿ƒï¼Œä»¥ Invoker ä¸ºä¸­å¿ƒï¼Œæ‰©å±•æ¥å£ä¸º Cluster, Directory, Router, LoadBalance&lt;/li&gt;
&lt;li&gt;monitor ç›‘æ§å±‚ï¼šRPC è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´ç›‘æ§ï¼Œä»¥ Statistics ä¸ºä¸­å¿ƒï¼Œæ‰©å±•æ¥å£ä¸º MonitorFactory, Monitor, MonitorService&lt;/li&gt;
&lt;li&gt;protocol è¿œç¨‹è°ƒç”¨å±‚ï¼šå°è£… RPC è°ƒç”¨ï¼Œä»¥ Invocation, Result ä¸ºä¸­å¿ƒï¼Œæ‰©å±•æ¥å£ä¸º Protocol, Invoker, Exporter&lt;/li&gt;
&lt;li&gt;exchange ä¿¡æ¯äº¤æ¢å±‚ï¼šå°è£…è¯·æ±‚å“åº”æ¨¡å¼ï¼ŒåŒæ­¥è½¬å¼‚æ­¥ï¼Œä»¥ Request, Response ä¸ºä¸­å¿ƒï¼Œæ‰©å±•æ¥å£ä¸º Exchanger, ExchangeChannel, ExchangeClient, ExchangeServer&lt;/li&gt;
&lt;li&gt;transport ç½‘ç»œä¼ è¾“å±‚ï¼šæŠ½è±¡ mina å’Œ netty ä¸ºç»Ÿä¸€æ¥å£ï¼Œä»¥ Message ä¸ºä¸­å¿ƒï¼Œæ‰©å±•æ¥å£ä¸º Channel, Transporter, Client, Server, Codec&lt;/li&gt;
&lt;li&gt;serialize æ•°æ®åºåˆ—åŒ–å±‚ï¼šå¯å¤ç”¨çš„ä¸€äº›å·¥å…·ï¼Œæ‰©å±•æ¥å£ä¸º Serialization, ObjectInput, ObjectOutput, ThreadPool&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;2-dubboåŸç†-å¯åŠ¨è§£æ-åŠ è½½é…ç½®ä¿¡æ¯&#34;&gt;2ã€dubboåŸç†	-å¯åŠ¨è§£æã€åŠ è½½é…ç½®ä¿¡æ¯&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;63&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/iFVXso8DLkEuO0r6.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;3-dubboåŸç†-æœåŠ¡æš´éœ²&#34;&gt;3ã€dubboåŸç†	-æœåŠ¡æš´éœ²&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;64&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/2ocFX7K06DopwxGs.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;4-dubboåŸç†-æœåŠ¡å¼•ç”¨&#34;&gt;4ã€dubboåŸç†	-æœåŠ¡å¼•ç”¨&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;65&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/DxTlKd889QMR0jp1.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;5-dubboåŸç†-æœåŠ¡è°ƒç”¨&#34;&gt;5ã€dubboåŸç†	-æœåŠ¡è°ƒç”¨&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;66&#34;&gt;&lt;img src=&#34;https://uploader.shimo.im/f/rugf4MklrfIiNoOW.png!thumbnail&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
">dubbo</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/ji-yi-ge-mian-shi-ti-shi-xian-yi-ge-du-xie-suo/"" data-c="
          &lt;h1 id=&#34;ç”¨å…±äº«å¯¹è±¡å®ç°å†™ä¼˜å…ˆçš„è¯»è€…å†™è€…é”&#34;&gt;ç”¨å…±äº«å¯¹è±¡å®ç°å†™ä¼˜å…ˆçš„è¯»è€…å†™è€…é”&lt;/h1&gt;
&lt;p&gt;é¦–å…ˆï¼Œæˆ‘ä»¬å®ç°ä¸€ä¸ªè¯»è€…/å†™è€…é”ã€‚ç±»ä¼¼äºä¸€ä¸ªæ™®é€šçš„äº’æ–¥é”ï¼Œä¸€ä¸ªè¯»è€…/å†™è€…é”(RWLock)ä¿æŠ¤å…±äº«æ•°æ®ã€‚ç„¶è€Œï¼Œå®ƒä¼šåšå¦‚ä¸‹çš„ä¼˜åŒ–ã€‚ä¸ºäº†æœ€å¤§åŒ–æ€§èƒ½ï¼Œä¸€ä¸ª RWLock å…è®¸å¤šä¸ªâ€œè¯»è€…â€çº¿ç¨‹åŒæ—¶è®¿é—®å…±äº«æ•°æ®ã€‚ä»»æ„æ•°é‡çš„çº¿ç¨‹å¯ä»¥åœ¨åŒä¸€æ—¶é—´å®‰å…¨åœ°è¯»å…±äº«æ•°æ®ï¼Œåªè¦æ²¡æœ‰çº¿ç¨‹åœ¨ä¿®æ”¹æ•°æ®ã€‚ç„¶è€Œï¼Œä»»æ„æ—¶åˆ»ï¼Œè‡³å¤šåªèƒ½æœ‰ 1 ä¸ªå†™è€…çº¿ç¨‹å¯ä»¥æŒæœ‰ RWLockï¼ˆè¯»è€…çº¿ç¨‹åªèƒ½è¯»å…±äº«æ•°æ®ï¼Œå†™è€…çº¿ç¨‹æ—¢å¯ä»¥å†™ä¹Ÿå¯ä»¥è¯»å…±äº«æ•°æ®ï¼‰ã€‚å½“ä¸€ä¸ªå†™è€…çº¿ç¨‹æŒæœ‰ RWLockï¼Œå®ƒå¯ä»¥å®‰å…¨åœ°ä¿®æ”¹æ•°æ®ï¼Œå› ä¸ºé”ä¿è¯äº†ä¸ä¼šæœ‰å…¶ä»–çš„çº¿ç¨‹åŒæ—¶æŒæœ‰è¯¥é”ã€‚è¯»è€…å†™è€…é”å¸¸å¸¸è¢«ç”¨äºæ•°æ®åº“ï¼Œå®ƒä»¬è¢«ç”¨äºæ”¯æŒå¯¹æ•°æ®åº“çš„æ›´å¿«çš„æœç´¢æŸ¥è¯¢ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒä¸å¤ªé¢‘ç¹çš„æ›´æ–°ã€‚å¦ä¸€ä¸ªå¸¸è§çš„åº”ç”¨æ˜¯åœ¨æ“ä½œç³»ç»Ÿå†…æ ¸ä¸­ï¼Œæ ¸å¿ƒçš„æ•°æ®ç»“æ„å¸¸å¸¸è¢«è®¸å¤šçº¿ç¨‹è¯»ä½†æ›´æ–°å´ä¸å¤ªé¢‘ç¹ã€‚ä¸ºäº†å°†æˆ‘ä»¬çš„äº’æ–¥é”ä¸€èˆ¬åŒ–ä¸ºä¸€ä¸ªè¯»è€…/å†™è€…é”ï¼Œæˆ‘ä»¬å®ç°äº†ä¸€ä¸ªæ–°ç±»å‹çš„å…±äº«å¯¹è±¡ï¼ŒRWLockï¼Œæ¥ä¿æŠ¤å¯¹å…±äº«æ•°æ®çš„è®¿é—®ã€‚RWLock é‡‡ç”¨äº†æˆ‘ä»¬æ ‡å‡†åŒ–çš„åŒæ­¥æ„å»ºæ¨¡å—ï¼šäº’æ–¥é”å’Œæ¡ä»¶å˜é‡æ¥å®ç°ã€‚&lt;br&gt;
ä¸€ä¸ªçº¿ç¨‹æƒ³è¦ï¼ˆåŸå­åœ°ï¼‰è¯»å…±äº«æ•°æ®ï¼Œå…¶è¿‡ç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;rwLock-&amp;gt;startRead();
read shared data
rwLock-&amp;gt;doneRead();
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç±»ä¼¼çš„ï¼Œä¸€ä¸ªçº¿ç¨‹æƒ³è¦ï¼ˆåŸå­åœ°ï¼‰å†™å…±äº«æ•°æ®ï¼Œå…¶è¿‡ç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;rwLock-&amp;gt;startWrite();
Read and write shared data
rwLock-&amp;gt;doneWrite();
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸ºäº†è®¾è®¡ RWLock ç±»ï¼Œæˆ‘ä»¬é¦–å…ˆå®šä¹‰å®ƒçš„æ¥å£ï¼ˆå¦‚ä¸Šé¢ä»£ç æ‰€ç¤ºï¼‰ï¼Œå’Œå®ƒçš„å…±äº«çŠ¶æ€ã€‚è¿™é‡Œï¼Œå¯¹è±¡çš„è¡Œä¸ºå¯ä»¥é€šè¿‡&lt;strong&gt;æ­£åœ¨è¯»å’Œæ­£åœ¨å†™çš„çº¿ç¨‹çš„æ•°é‡å’Œç­‰å¾…è¯»å’Œç­‰ä»£å†™çš„çº¿ç¨‹çš„æ•°é‡&lt;/strong&gt;æ¥åˆ»ç”»ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦ 4 ä¸ªæ•´æ•°æ¥è¿½è¸ªè¿™äº›å€¼ã€‚ ä»£ç  5.9 å±•ç¤ºäº† RWLock ç±»çš„æˆå‘˜å’Œæ¥å£. æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬é€šè¿‡æå‡ºä»¥ä¸‹çš„é—®é¢˜æ¥æ·»åŠ åŒæ­¥å˜é‡ï¼Œâ€œä»€ä¹ˆæ—¶å€™æ–¹æ³•éœ€è¦ç­‰å¾…ï¼Ÿâ€é¦–å…ˆï¼Œæˆ‘ä»¬æ·»åŠ ä¸€ä¸ªäº’æ–¥é”ï¼šä¿è¯å½“æœ‰çº¿ç¨‹åœ¨è®¿é—® RWLock çš„æ–¹æ³•çš„æ—¶å€™ï¼Œå…¶ä»–è®¿é—® RWLock çš„æ–¹æ³•çš„çº¿ç¨‹å¿…é¡»ç­‰å¾…ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ° startRead æˆ– startWrite å¯èƒ½éœ€è¦ç­‰å¾…ï¼Œå› æ­¤æˆ‘ä»¬ä¸ºæ¯ç§æƒ…å†µæ·»åŠ äº†ä¸€ä¸ªæ¡ä»¶å˜é‡ï¼šreadGo å’Œ writeGo.&lt;/p&gt;
&lt;h2 id=&#34;è¯»è€…å†™è€…é”çš„æ¥å£å’Œæˆå‘˜å˜é‡&#34;&gt;è¯»è€…/å†™è€…é”çš„æ¥å£å’Œæˆå‘˜å˜é‡&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;class RWLock{
    private:
        //Synchronization variables
        Lock lock;
        CV readGo;
        CV writeGo;

        // State variables
        int activeReaders;
        int activeWriters;
        int waitingReaders;
        int waitingWriters;
    public:
        RWLock();
        ~RWLock(){};
        void startRead();
        void doneRead();
        void startWrite();
        void doneWrite();
    private:
        bool readShouldWait();
        bool writeShouldWait();
} 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»£ç  5.9ï¼š  æˆ‘ä»¬çš„è¯»è€…/å†™è€…é”çš„æ¥å£å’Œæˆå‘˜å˜é‡&lt;br&gt;
RWLock: doneRead å’Œ doneWrite ä¸éœ€è¦ç­‰å¾…ï¼ˆä¸åŒ…æ‹¬è·å–äº’æ–¥é”ï¼‰ã€‚å› æ­¤ï¼Œè¿™äº›æ–¹æ³•ä¸éœ€è¦é¢å¤–çš„æ¡ä»¶å˜é‡ã€‚&lt;br&gt;
ç°åœ¨æˆ‘ä»¬å®ç° RWLockã€‚&lt;br&gt;
é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆç»™æ¯ä¸ªæ–¹æ³•æ·»åŠ ä¸Šé”çš„è·å–å’Œé”çš„é‡Šæ”¾ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;void RWLock :: startRead(){
    lock.acquire();

    lock.release();
}

void RWLock::doneRead(){
    lock.acquire();

    lock.release();
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;RWLock::startWrite å’Œ RWLock::doneWrite ä¹Ÿç±»ä¼¼ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºæˆ‘ä»¬çŸ¥é“ startRead å’Œ startWrite å¿…é¡»ç­‰å¾…ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨æ¯ä¸ªæ–¹æ³•çš„ä¸­é—´å†™ä¸Šwhile(â€¦){wait();}çš„å¾ªç¯ã€‚ç„¶åï¼Œæˆ‘ä»¬å¼€å§‹æ€è€ƒå…¶ä¸­çš„ç»†èŠ‚ï¼Œä¾‹å¦‚å¾ªç¯ç­‰å¾…çš„åˆ¤æ–­æ¡ä»¶ã€‚ä»£ç  5.10 å±•ç¤ºäº†å®Œæ•´çš„è§£æ³•ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è¯»è€…å†™è€…é”å®Œæ•´ä»£ç &#34;&gt;è¯»è€…å†™è€…é”å®Œæ•´ä»£ç &lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;// Wait until no active or waiting writers,then proceed
void RWLock::startRead(){
    lock.acquire();
    waitingReaders++;
    while(readShouldWait()){
        readGo.Wait(&amp;amp;lock);
    }
    waitingReaders--;
    activeReaders++;
    lock.release();
}

// Done reading.If no other active readers,a write may proceed.
void RWLock::doneRead(){
    lock.acquire();
    activeReaders--;
    if(activeReaders == 0 &amp;amp;&amp;amp; waitingWriters &amp;gt; 0){
        writeGo.signal();
    }
    lock.release();
}

// Read waits if any active or waiting write(&amp;quot;writers preferred&amp;quot;).
bool RWLock::readShouldWait(){
    return (activeWriters &amp;gt; 0 || waitingWriters &amp;gt; 0);
}

// Wait until no active read or write then proceed;
void RWLock::startWrite(){
    lock.acquire();
    waitingWriterw++;
    while(writeShouldWait()){
        writeGo.Wait(&amp;amp;lock);
    }
    waitingWriters--;
    activeWriters++;
    lock.release();
}

// Done writing. A waiting write or read may proceed.
void RWLock::doneWrite(){
    lock.acquire();
    activeWriters--;
    assert(activeWriters == 0);
    if(waitingWriters &amp;gt; 0){
        writeGo.signal();
    }else{
        readGo.broadcast();
    }
    lock.release();
}

// Write waits for active read or write.
bool RWLock::writeShouldWait(){
    return(activeWriters &amp;gt; 0 || activeReaders &amp;gt; 0);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»£ç  5.10ï¼š  ä¸€ä¸ªè¯»è€…å†™è€…é”çš„å®ç°&lt;/p&gt;
">è®°ä¸€ä¸ªé¢è¯•é¢˜ â€”â€” å®ç°ä¸€ä¸ªè¯»å†™é”</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/redis-chi-jiu-hua/"" data-c="
          &lt;h1 id=&#34;æŒä¹…åŒ–ç®€ä»‹&#34;&gt;æŒä¹…åŒ–ç®€ä»‹&lt;/h1&gt;
&lt;h2 id=&#34;æ„å¤–çš„æ–­ç”µ&#34;&gt;æ„å¤–çš„æ–­ç”µ&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%96%AD%E7%94%B5.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;è‡ªåŠ¨å¤‡ä»½&#34;&gt;â€œè‡ªåŠ¨å¤‡ä»½â€&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%87%AA%E5%8A%A8%E5%A4%87%E4%BB%BD.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;ä»€ä¹ˆæ˜¯æŒä¹…åŒ–&#34;&gt;ä»€ä¹ˆæ˜¯æŒä¹…åŒ–&lt;/h2&gt;
&lt;p&gt;åˆ©ç”¨æ°¸ä¹…æ€§å­˜å‚¨ä»‹è´¨å°†æ•°æ®è¿›è¡Œä¿å­˜ï¼Œåœ¨ç‰¹å®šçš„æ—¶é—´å°†ä¿å­˜çš„æ•°æ®è¿›è¡Œæ¢å¤çš„å·¥ä½œæœºåˆ¶ç§°ä¸ºæŒä¹…åŒ–ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸ºä»€ä¹ˆè¦è¿›è¡ŒæŒä¹…åŒ–&#34;&gt;ä¸ºä»€ä¹ˆè¦è¿›è¡ŒæŒä¹…åŒ–&lt;/h2&gt;
&lt;p&gt;é˜²æ­¢æ•°æ®çš„æ„å¤–ä¸¢å¤±ï¼Œç¡®ä¿æ•°æ®å®‰å…¨æ€§&lt;/p&gt;
&lt;h2 id=&#34;æŒä¹…åŒ–è¿‡ç¨‹ä¿å­˜ä»€ä¹ˆ&#34;&gt;æŒä¹…åŒ–è¿‡ç¨‹ä¿å­˜ä»€ä¹ˆ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å°†å½“å‰æ•°æ®çŠ¶æ€è¿›è¡Œä¿å­˜ï¼Œ&lt;strong&gt;å¿«ç…§&lt;/strong&gt;å½¢å¼ï¼Œå­˜å‚¨æ•°æ®ç»“æœï¼Œå­˜å‚¨æ ¼å¼ç®€å•ï¼Œå…³æ³¨ç‚¹åœ¨&lt;strong&gt;æ•°æ®&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;å°†æ•°æ®çš„æ“ä½œè¿‡ç¨‹è¿›è¡Œä¿å­˜ï¼Œ&lt;strong&gt;æ—¥å¿—&lt;/strong&gt;å½¢å¼ï¼Œå­˜å‚¨æ“ä½œè¿‡ç¨‹ï¼Œå­˜å‚¨æ ¼å¼å¤æ‚ï¼Œå…³æ³¨ç‚¹åœ¨&lt;strong&gt;æ•°æ®çš„æ“ä½œè¿‡ç¨‹&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/redis%E6%8C%81%E4%B9%85%E5%8C%96.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h1 id=&#34;rdb&#34;&gt;RDB&lt;/h1&gt;
&lt;h2 id=&#34;rdbå¯åŠ¨æ–¹å¼&#34;&gt;RDBå¯åŠ¨æ–¹å¼&lt;/h2&gt;
&lt;h2 id=&#34;è°ä»€ä¹ˆæ—¶é—´å¹²ä»€ä¹ˆäº‹æƒ…&#34;&gt;è°ï¼Œä»€ä¹ˆæ—¶é—´ï¼Œå¹²ä»€ä¹ˆäº‹æƒ…&lt;/h2&gt;
&lt;p&gt;å‘½ä»¤æ‰§è¡Œ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è°ï¼šredisæ“ä½œè€…ï¼ˆç”¨æˆ·ï¼‰&lt;/li&gt;
&lt;li&gt;ä»€ä¹ˆæ—¶é—´ï¼šå³æ—¶ï¼ˆéšæ—¶è¿›è¡Œï¼‰&lt;/li&gt;
&lt;li&gt;å¹²ä»€ä¹ˆäº‹æƒ…ï¼šä¿å­˜æ•°æ®&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;rdbå¯åŠ¨æ–¹å¼-saveæŒ‡ä»¤&#34;&gt;RDBå¯åŠ¨æ–¹å¼ â€”â€” saveæŒ‡ä»¤&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å‘½ä»¤&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;save 
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;ä½œç”¨&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ‰‹åŠ¨æ‰§è¡Œä¸€æ¬¡ä¿å­˜æ“ä½œ&lt;/p&gt;
&lt;p&gt;redis-cli&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;127.0.0.1:6379&amp;gt; set name ssm
OK
127.0.0.1:6379&amp;gt; save
OK
127.0.0.1:6379&amp;gt; set age 20
OK
127.0.0.1:6379&amp;gt; save
OK
127.0.0.1:6379&amp;gt;Â 
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;[root@iZ2ze4u2bufi0915gyi843Z data]# ll
total 4
-rw-r--r-- 1 root root 3918 Feb 25 21:23 6379.log
[root@iZ2ze4u2bufi0915gyi843Z data]# ll
total 8
-rw-r--r-- 1 root root 3969 Feb 25 21:24 6379.log
-rw-r--r-- 1 root rootÂ  107 Feb 25 21:24 dump.rdb
[root@iZ2ze4u2bufi0915gyi843Z data]# ll
total 8
-rw-r--r-- 1 root root 4020 Feb 25 21:24 6379.log
-rw-r--r-- 1 root rootÂ  114 Feb 25 21:24 dump.rdb
[root@iZ2ze4u2bufi0915gyi843Z data]# cat dump.rdbÂ 
REDIS0009	redis-ver5.0.7
redis-bitsó¿¿€ò³¨­e
Â  Â  Â  Â  Â  Â  Â  Uused-memx
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;rdbå¯åŠ¨æ–¹å¼-saveæŒ‡ä»¤ç›¸å…³é…ç½®&#34;&gt;RDBå¯åŠ¨æ–¹å¼ â€”â€” saveæŒ‡ä»¤ç›¸å…³é…ç½®&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;dbfilename dump.rdb
&lt;ul&gt;
&lt;li&gt;è¯´æ˜ï¼šè®¾ç½®æœ¬åœ°æ•°æ®åº“æ–‡ä»¶åï¼Œé»˜è®¤å€¼ä¸º dump.rdb&lt;/li&gt;
&lt;li&gt;ç»éªŒï¼šé€šå¸¸è®¾ç½®ä¸º**dump-&lt;strong&gt;&lt;strong&gt;ç«¯å£å·&lt;/strong&gt;&lt;/strong&gt;.rdb **&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;dir
&lt;ul&gt;
&lt;li&gt;è¯´æ˜ï¼šè®¾ç½®å­˜å‚¨.rdbæ–‡ä»¶çš„è·¯å¾„&lt;/li&gt;
&lt;li&gt;ç»éªŒï¼šé€šå¸¸è®¾ç½®æˆå­˜å‚¨ç©ºé—´è¾ƒå¤§çš„ç›®å½•ä¸­ï¼Œç›®å½•åç§°**data **&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;rdbcompression yes
&lt;ul&gt;
&lt;li&gt;è¯´æ˜ï¼šè®¾ç½®å­˜å‚¨è‡³æœ¬åœ°æ•°æ®åº“æ—¶æ˜¯å¦&lt;strong&gt;å‹ç¼©æ•°æ®&lt;/strong&gt;ï¼Œé»˜è®¤ä¸º yesï¼Œé‡‡ç”¨ LZF å‹ç¼©&lt;/li&gt;
&lt;li&gt;ç»éªŒï¼šé€šå¸¸é»˜è®¤ä¸ºå¼€å¯çŠ¶æ€ï¼Œå¦‚æœè®¾ç½®ä¸ºnoï¼Œå¯ä»¥èŠ‚çœ CPU è¿è¡Œæ—¶é—´ï¼Œä½†ä¼šä½¿å­˜å‚¨çš„æ–‡ä»¶å˜å¤§ï¼ˆå·¨å¤§ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;rdbchecksum yes
&lt;ul&gt;
&lt;li&gt;è¯´æ˜ï¼šè®¾ç½®æ˜¯å¦è¿›è¡ŒRDB&lt;strong&gt;æ–‡ä»¶æ ¼å¼æ ¡éªŒ&lt;/strong&gt;ï¼Œè¯¥æ ¡éªŒè¿‡ç¨‹åœ¨å†™æ–‡ä»¶å’Œè¯»æ–‡ä»¶è¿‡ç¨‹å‡è¿›è¡Œ&lt;/li&gt;
&lt;li&gt;ç»éªŒï¼šé€šå¸¸é»˜è®¤ä¸ºå¼€å¯çŠ¶æ€ï¼Œå¦‚æœè®¾ç½®ä¸ºnoï¼Œå¯ä»¥èŠ‚çº¦è¯»å†™æ€§è¿‡ç¨‹çº¦10%æ—¶é—´æ¶ˆè€—ï¼Œä½†æ˜¯å­˜å‚¨ä¸€å®šçš„æ•°æ®æŸåé£é™©&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;rdbå¯åŠ¨æ–¹å¼-saveæŒ‡ä»¤å·¥ä½œåŸç†&#34;&gt;RDBå¯åŠ¨æ–¹å¼ â€”â€” saveæŒ‡ä»¤å·¥ä½œåŸç†&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Redis%E6%8C%87%E4%BB%A4save.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/Redis%E6%8C%87%E4%BB%A4save2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ³¨æ„ï¼š&lt;strong&gt;saveæŒ‡ä»¤çš„æ‰§è¡Œä¼š&lt;/strong&gt;é˜»å¡&lt;/strong&gt;å½“å‰RedisæœåŠ¡å™¨ï¼Œç›´åˆ°å½“å‰RDBè¿‡ç¨‹å®Œæˆä¸ºæ­¢ï¼Œæœ‰å¯èƒ½ä¼šé€ æˆé•¿æ—¶é—´é˜»å¡ï¼Œçº¿ä¸Šç¯å¢ƒä¸å»ºè®®ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ•°æ®é‡è¿‡å¤§å•çº¿ç¨‹æ‰§è¡Œæ–¹å¼é€ æˆæ•ˆç‡è¿‡ä½å¦‚ä½•å¤„ç†&#34;&gt;æ•°æ®é‡è¿‡å¤§ï¼Œå•çº¿ç¨‹æ‰§è¡Œæ–¹å¼é€ æˆæ•ˆç‡è¿‡ä½å¦‚ä½•å¤„ç†ï¼Ÿ&lt;/h2&gt;
&lt;h3 id=&#34;åå°æ‰§è¡Œ-bgsave&#34;&gt;åå°æ‰§è¡Œ ï¼ˆbgsaveï¼‰&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;è°ï¼šredisæ“ä½œè€…ï¼ˆç”¨æˆ·ï¼‰å‘èµ·æŒ‡ä»¤ï¼›redisæœåŠ¡å™¨æ§åˆ¶æŒ‡ä»¤æ‰§è¡Œ&lt;/li&gt;
&lt;li&gt;ä»€ä¹ˆæ—¶é—´ï¼šå³æ—¶ï¼ˆå‘èµ·ï¼‰ï¼›åˆç†çš„æ—¶é—´ï¼ˆæ‰§è¡Œï¼‰&lt;/li&gt;
&lt;li&gt;å¹²ä»€ä¹ˆäº‹æƒ…ï¼šä¿å­˜æ•°æ®&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;bgsaveæŒ‡ä»¤&#34;&gt;bgsaveæŒ‡ä»¤&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å‘½ä»¤&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;bgsave 
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;ä½œç”¨&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ‰‹åŠ¨å¯åŠ¨åå°ä¿å­˜æ“ä½œï¼Œä½†ä¸æ˜¯ç«‹å³æ‰§è¡Œ&lt;/p&gt;
&lt;h3 id=&#34;bgsaveæŒ‡ä»¤å·¥ä½œåŸç†&#34;&gt;bgsaveæŒ‡ä»¤å·¥ä½œåŸç†&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/bgsave.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;æ³¨æ„ï¼š &lt;strong&gt;bgsaveå‘½ä»¤æ˜¯é’ˆå¯¹saveé˜»å¡é—®é¢˜åšçš„ä¼˜åŒ–ã€‚Rediså†…éƒ¨æ‰€æœ‰æ¶‰åŠåˆ°RDBæ“ä½œéƒ½é‡‡ç”¨bgsaveçš„æ–¹å¼ï¼Œsaveå‘½ä»¤å¯ä»¥æ”¾å¼ƒä½¿ç”¨&lt;/strong&gt;ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&#34;bgsaveæŒ‡ä»¤ç›¸å…³é…ç½®&#34;&gt;bgsaveæŒ‡ä»¤ç›¸å…³é…ç½®&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;dbfilename dump.rdb&lt;/li&gt;
&lt;li&gt;dir&lt;/li&gt;
&lt;li&gt;rdbcompression yes&lt;/li&gt;
&lt;li&gt;rdbchecksum yes&lt;/li&gt;
&lt;li&gt;stop-writes-on-bgsave-error yes
&lt;ul&gt;
&lt;li&gt;è¯´æ˜ï¼šåå°å­˜å‚¨è¿‡ç¨‹ä¸­å¦‚æœå‡ºç°é”™è¯¯ç°è±¡ï¼Œæ˜¯å¦åœæ­¢ä¿å­˜æ“ä½œ&lt;/li&gt;
&lt;li&gt;ç»éªŒï¼šé€šå¸¸é»˜è®¤ä¸ºå¼€å¯çŠ¶æ€&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;åå¤æ‰§è¡Œä¿å­˜æŒ‡ä»¤å¿˜è®°äº†æ€ä¹ˆåŠä¸çŸ¥é“æ•°æ®äº§ç”Ÿäº†å¤šå°‘å˜åŒ–ä½•æ—¶ä¿å­˜&#34;&gt;åå¤æ‰§è¡Œä¿å­˜æŒ‡ä»¤ï¼Œå¿˜è®°äº†æ€ä¹ˆåŠï¼Ÿä¸çŸ¥é“æ•°æ®äº§ç”Ÿäº†å¤šå°‘å˜åŒ–ï¼Œä½•æ—¶ä¿å­˜ï¼Ÿ&lt;/h2&gt;
&lt;h3 id=&#34;è‡ªåŠ¨æ‰§è¡Œ&#34;&gt;è‡ªåŠ¨æ‰§è¡Œ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;è°ï¼šredisæœåŠ¡å™¨å‘èµ·æŒ‡ä»¤ï¼ˆåŸºäºæ¡ä»¶ï¼‰&lt;/li&gt;
&lt;li&gt;ä»€ä¹ˆæ—¶é—´ï¼šæ»¡è¶³æ¡ä»¶&lt;/li&gt;
&lt;li&gt;å¹²ä»€ä¹ˆäº‹æƒ…ï¼šä¿å­˜æ•°æ®&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;saveé…ç½®&#34;&gt;saveé…ç½®&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;redis-6379.conf å†…é…ç½®&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;save second changes 
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;ä½œç”¨&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ»¡è¶³é™å®šæ—¶é—´èŒƒå›´å†…keyçš„å˜åŒ–æ•°é‡è¾¾åˆ°æŒ‡å®šæ•°é‡å³è¿›è¡ŒæŒä¹…åŒ–&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å‚æ•°
&lt;ul&gt;
&lt;li&gt;secondï¼šç›‘æ§æ—¶é—´èŒƒå›´&lt;/li&gt;
&lt;li&gt;changesï¼šç›‘æ§keyçš„å˜åŒ–é‡&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä½ç½®
&lt;ul&gt;
&lt;li&gt;åœ¨confæ–‡ä»¶ä¸­è¿›è¡Œé…ç½®&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;èŒƒä¾‹&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;save 900 1 
save 300 10 
save 60 10000
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;saveé…ç½®åŸç†&#34;&gt;saveé…ç½®åŸç†&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Redis%E6%8C%87%E4%BB%A4save3.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;æ³¨æ„ï¼š saveé…ç½®è¦æ ¹æ®å®é™…ä¸šåŠ¡æƒ…å†µè¿›è¡Œè®¾ç½®ï¼Œé¢‘åº¦è¿‡é«˜æˆ–è¿‡ä½éƒ½ä¼šå‡ºç°æ€§èƒ½é—®é¢˜ï¼Œç»“æœå¯èƒ½æ˜¯ç¾éš¾æ€§çš„&lt;/p&gt;
&lt;p&gt;saveé…ç½®ä¸­å¯¹äºsecondä¸changesè®¾ç½®é€šå¸¸å…·æœ‰äº’è¡¥å¯¹åº”å…³ç³»ï¼Œå°½é‡ä¸è¦è®¾ç½®æˆåŒ…å«æ€§å…³ç³»&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;saveé…ç½®å¯åŠ¨åæ‰§è¡Œçš„æ˜¯bgsaveæ“ä½œ&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;saveé…ç½®ç›¸å…³é…ç½®&#34;&gt;saveé…ç½®ç›¸å…³é…ç½®&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;dbfilename dump.rdb&lt;/li&gt;
&lt;li&gt;dir&lt;/li&gt;
&lt;li&gt;rdbcompression yes&lt;/li&gt;
&lt;li&gt;rdbchecksum yes&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;rdbä¸‰ç§å¯åŠ¨æ–¹å¼å¯¹æ¯”&#34;&gt;RDBä¸‰ç§å¯åŠ¨æ–¹å¼å¯¹æ¯”&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;æ–¹å¼&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;saveæŒ‡ä»¤&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;bgsaveæŒ‡ä»¤ï¼ˆsaveé…ç½®ï¼‰&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è¯»å†™&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;åŒæ­¥&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å¼‚æ­¥&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;é˜»å¡å®¢æˆ·ç«¯æŒ‡ä»¤&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ˜¯&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å¦&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;é¢å¤–å†…å­˜æ¶ˆè€—&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å¦&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ˜¯&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å¯åŠ¨æ–°è¿›ç¨‹&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å¦&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ˜¯&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;rdbç‰¹æ®Šå¯åŠ¨å½¢å¼&#34;&gt;RDBç‰¹æ®Šå¯åŠ¨å½¢å¼&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å…¨é‡å¤åˆ¶&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åœ¨ä¸»ä»å¤åˆ¶ä¸­è¯¦ç»†è®²è§£&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æœåŠ¡å™¨è¿è¡Œè¿‡ç¨‹ä¸­é‡å¯&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;debug reload 
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;å…³é—­æœåŠ¡å™¨æ—¶æŒ‡å®šä¿å­˜æ•°æ®&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;shutdown save 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é»˜è®¤æƒ…å†µä¸‹æ‰§è¡Œshutdownå‘½ä»¤æ—¶ï¼Œè‡ªåŠ¨æ‰§è¡Œ bgsave(å¦‚æœæ²¡æœ‰å¼€å¯AOFæŒä¹…åŒ–åŠŸèƒ½)&lt;/p&gt;
&lt;h2 id=&#34;rdbä¼˜ç‚¹&#34;&gt;RDBä¼˜ç‚¹&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;RDBæ˜¯ä¸€ä¸ªç´§å‡‘å‹ç¼©çš„&lt;strong&gt;äºŒè¿›åˆ¶&lt;/strong&gt;æ–‡ä»¶ï¼Œ**å­˜å‚¨æ•ˆç‡è¾ƒé«˜ **&lt;/li&gt;
&lt;li&gt;RDBå†…éƒ¨å­˜å‚¨çš„æ˜¯redisåœ¨æŸä¸ªæ—¶é—´ç‚¹çš„æ•°æ®å¿«ç…§ï¼Œéå¸¸é€‚åˆç”¨äºæ•°æ®å¤‡ä»½ï¼Œå…¨é‡å¤åˆ¶ç­‰åœºæ™¯&lt;/li&gt;
&lt;li&gt;RDB&lt;strong&gt;æ¢å¤æ•°æ®&lt;/strong&gt;çš„&lt;strong&gt;é€Ÿåº¦&lt;/strong&gt;è¦æ¯”AOF&lt;strong&gt;å¿«&lt;/strong&gt;å¾ˆå¤š&lt;/li&gt;
&lt;li&gt;åº”ç”¨ï¼šæœåŠ¡å™¨ä¸­æ¯Xå°æ—¶æ‰§è¡Œbgsaveå¤‡ä»½ï¼Œå¹¶å°†RDBæ–‡ä»¶æ‹·è´åˆ°è¿œç¨‹æœºå™¨ä¸­ï¼Œç”¨äº&lt;strong&gt;ç¾éš¾æ¢å¤&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;rdbç¼ºç‚¹&#34;&gt;RDBç¼ºç‚¹&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;RDBæ–¹å¼æ— è®ºæ˜¯æ‰§è¡ŒæŒ‡ä»¤è¿˜æ˜¯åˆ©ç”¨é…ç½®ï¼Œæ— æ³•åšåˆ°å®æ—¶æŒä¹…åŒ–ï¼Œå…·æœ‰è¾ƒå¤§çš„å¯èƒ½æ€§&lt;strong&gt;ä¸¢å¤±æ•°æ®&lt;/strong&gt;ï¼ˆ10ç‚¹å¤‡ä»½ä¸€æ¬¡ï¼Œ11ç‚¹å¤‡ä»½ä¸€æ¬¡ï¼Œé‚£ä¹ˆ10ç‚¹45çš„æ•°æ®å°±ä¸¢å¤±äº†ï¼‰&lt;/li&gt;
&lt;li&gt;bgsaveæŒ‡ä»¤æ¯æ¬¡è¿è¡Œè¦æ‰§è¡Œforkæ“ä½œ&lt;strong&gt;åˆ›å»ºå­è¿›ç¨‹&lt;/strong&gt;ï¼Œè¦**ç‰ºç‰²æ‰ä¸€äº›æ€§èƒ½ **&lt;/li&gt;
&lt;li&gt;Redisçš„ä¼—å¤šç‰ˆæœ¬ä¸­æœªè¿›è¡ŒRDBæ–‡ä»¶æ ¼å¼çš„ç‰ˆæœ¬ç»Ÿä¸€ï¼Œæœ‰å¯èƒ½å‡ºç°&lt;strong&gt;å„ç‰ˆæœ¬&lt;/strong&gt;æœåŠ¡ä¹‹é—´æ•°æ®æ ¼å¼&lt;strong&gt;æ— æ³•å…¼å®¹&lt;/strong&gt;ç°è±¡&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;aof&#34;&gt;AOF&lt;/h1&gt;
&lt;h2 id=&#34;rdbå­˜å‚¨çš„å¼Šç«¯&#34;&gt;RDBå­˜å‚¨çš„å¼Šç«¯&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å­˜å‚¨&lt;strong&gt;æ•°æ®é‡è¾ƒå¤§&lt;/strong&gt;ï¼Œæ•ˆç‡è¾ƒä½
&lt;ul&gt;
&lt;li&gt;åŸºäº&lt;strong&gt;å¿«ç…§&lt;/strong&gt;æ€æƒ³ï¼Œæ¯æ¬¡è¯»å†™éƒ½æ˜¯&lt;strong&gt;å…¨éƒ¨&lt;/strong&gt;æ•°æ®ï¼Œå½“æ•°æ®é‡å·¨å¤§æ—¶ï¼Œæ•ˆç‡éå¸¸ä½&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¤§æ•°æ®é‡ä¸‹çš„**IOæ€§èƒ½è¾ƒä½ **&lt;/li&gt;
&lt;li&gt;åŸºäºforkåˆ›å»º&lt;strong&gt;å­è¿›ç¨‹&lt;/strong&gt;ï¼Œ&lt;strong&gt;å†…å­˜&lt;/strong&gt;äº§ç”Ÿé¢å¤–&lt;strong&gt;æ¶ˆè€—&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;å®•æœºå¸¦æ¥çš„&lt;strong&gt;æ•°æ®ä¸¢å¤±&lt;/strong&gt;é£é™© ï¼ˆå¿«ç…§æ˜¯æŸä¸ªæ—¶é—´ç‚¹çš„æ•°æ®ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;è§£å†³æ€è·¯&#34;&gt;è§£å†³æ€è·¯&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ä¸å†™å…¨æ•°æ®ï¼Œä»…**è®°å½•éƒ¨åˆ†æ•°æ® **&lt;/li&gt;
&lt;li&gt;é™ä½åŒºåˆ†æ•°æ®æ˜¯å¦æ”¹å˜çš„éš¾åº¦ï¼Œæ”¹è®°å½•æ•°æ®ä¸º**è®°å½•æ“ä½œè¿‡ç¨‹ **&lt;/li&gt;
&lt;li&gt;å¯¹æ‰€æœ‰æ“ä½œå‡è¿›è¡Œè®°å½•ï¼Œ&lt;strong&gt;æ’é™¤ä¸¢å¤±æ•°æ®çš„é£é™©&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;aofæ¦‚å¿µ&#34;&gt;AOFæ¦‚å¿µ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;AOF(append only file)æŒä¹…åŒ–ï¼šä»¥ç‹¬ç«‹æ—¥å¿—çš„æ–¹å¼è®°å½•æ¯æ¬¡å†™å‘½ä»¤ï¼Œé‡å¯æ—¶å†é‡æ–°æ‰§è¡ŒAOFæ–‡ä»¶ä¸­å‘½ä»¤è¾¾åˆ°æ¢å¤æ•°æ®çš„ç›®çš„ã€‚ä¸RDBç›¸æ¯”å¯ä»¥ç®€å•æè¿°ä¸ºæ”¹è®°å½•æ•°æ®ä¸ºè®°å½•æ•°æ®äº§ç”Ÿçš„è¿‡ç¨‹&lt;/li&gt;
&lt;li&gt;AOFçš„ä¸»è¦ä½œç”¨æ˜¯è§£å†³äº†æ•°æ®æŒä¹…åŒ–çš„å®æ—¶æ€§ï¼Œç›®å‰å·²ç»æ˜¯RedisæŒä¹…åŒ–çš„ä¸»æµæ–¹å¼&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;aofå†™æ•°æ®è¿‡ç¨‹&#34;&gt;AOFå†™æ•°æ®è¿‡ç¨‹&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/AOF.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;aofå†™æ•°æ®ä¸‰ç§ç­–ç•¥appendfsync&#34;&gt;AOFå†™æ•°æ®ä¸‰ç§ç­–ç•¥(****appendfsync)&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;always(æ¯æ¬¡ï¼‰
&lt;ul&gt;
&lt;li&gt;æ¯æ¬¡å†™å…¥æ“ä½œå‡åŒæ­¥åˆ°AOFæ–‡ä»¶ä¸­ï¼Œ&lt;strong&gt;æ•°æ®é›¶è¯¯å·®&lt;/strong&gt;ï¼Œ**æ€§èƒ½è¾ƒä½ **ï¼Œä¸å»ºè®®ä½¿ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;everysecï¼ˆæ¯ç§’ï¼‰
&lt;ul&gt;
&lt;li&gt;æ¯ç§’å°†ç¼“å†²åŒºä¸­çš„æŒ‡ä»¤åŒæ­¥åˆ°AOFæ–‡ä»¶ä¸­ï¼Œæ•°æ®å‡†ç¡®æ€§è¾ƒé«˜ï¼Œ**æ€§èƒ½è¾ƒé«˜ **ï¼Œå»ºè®®ä½¿ç”¨ï¼Œä¹Ÿæ˜¯é»˜è®¤é…ç½®&lt;/li&gt;
&lt;li&gt;åœ¨ç³»ç»Ÿçªç„¶å®•æœºçš„æƒ…å†µä¸‹ä¸¢å¤±1ç§’å†…çš„æ•°æ®&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;noï¼ˆç³»ç»Ÿæ§åˆ¶ï¼‰
&lt;ul&gt;
&lt;li&gt;ç”±æ“ä½œç³»ç»Ÿæ§åˆ¶æ¯æ¬¡åŒæ­¥åˆ°AOFæ–‡ä»¶çš„å‘¨æœŸï¼Œæ•´ä½“è¿‡ç¨‹&lt;strong&gt;ä¸å¯æ§&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;aofåŠŸèƒ½å¼€å¯&#34;&gt;AOFåŠŸèƒ½å¼€å¯&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;é…ç½®&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;appendonly yes|no 
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;ä½œç”¨
&lt;ul&gt;
&lt;li&gt;æ˜¯å¦å¼€å¯AOFæŒä¹…åŒ–åŠŸèƒ½ï¼Œé»˜è®¤ä¸ºä¸å¼€å¯çŠ¶æ€&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é…ç½®&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;appendfsync always|everysec|no 
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;ä½œç”¨&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;AOFå†™æ•°æ®ç­–ç•¥&lt;/p&gt;
&lt;h2 id=&#34;aofç›¸å…³é…ç½®&#34;&gt;AOFç›¸å…³é…ç½®&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;é…ç½®&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;appendfilename filename 
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;ä½œç”¨
&lt;ul&gt;
&lt;li&gt;AOFæŒä¹…åŒ–æ–‡ä»¶åï¼Œé»˜è®¤æ–‡ä»¶åä¸ºappendonly.aofï¼Œå»ºè®®é…ç½®ä¸ºappendonly-ç«¯å£å·.aof&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é…ç½®&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;dir 
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;ä½œç”¨
&lt;ul&gt;
&lt;li&gt;AOFæŒä¹…åŒ–æ–‡ä»¶ä¿å­˜è·¯å¾„ï¼Œä¸RDBæŒä¹…åŒ–æ–‡ä»¶ä¿æŒä¸€è‡´å³å¯&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;aofå†™æ•°æ®é‡åˆ°çš„é—®é¢˜&#34;&gt;AOFå†™æ•°æ®é‡åˆ°çš„é—®é¢˜&lt;/h2&gt;
&lt;h3 id=&#34;å¦‚æœè¿ç»­æ‰§è¡Œå¦‚ä¸‹æŒ‡ä»¤è¯¥å¦‚ä½•å¤„ç†&#34;&gt;å¦‚æœè¿ç»­æ‰§è¡Œå¦‚ä¸‹æŒ‡ä»¤è¯¥å¦‚ä½•å¤„ç†&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/AOF%E4%BE%8B%E5%AD%90.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;aofé‡å†™&#34;&gt;AOFé‡å†™&lt;/h3&gt;
&lt;p&gt;éšç€å‘½ä»¤ä¸æ–­å†™å…¥AOFï¼Œ&lt;strong&gt;æ–‡ä»¶ä¼šè¶Šæ¥è¶Šå¤§&lt;/strong&gt;ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒRediså¼•å…¥äº†AOFé‡å†™æœºåˆ¶å‹ç¼©æ–‡ä»¶ä½“ç§¯ã€‚AOFæ–‡ä»¶é‡å†™æ˜¯å°†Redisè¿›ç¨‹å†…çš„æ•°æ®è½¬åŒ–ä¸ºå†™å‘½ä»¤åŒæ­¥åˆ°æ–°AOFæ–‡ä»¶çš„è¿‡ç¨‹ã€‚ç®€å•è¯´å°±æ˜¯&lt;strong&gt;å°†å¯¹åŒä¸€ä¸ªæ•°æ®çš„è‹¥å¹²ä¸ªæ¡å‘½ä»¤æ‰§è¡Œç»“æœè½¬åŒ–æˆæœ€ç»ˆç»“æœæ•°æ®å¯¹åº”çš„æŒ‡ä»¤&lt;/strong&gt;è¿›è¡Œè®°å½•ã€‚&lt;/p&gt;
&lt;h3 id=&#34;aofé‡å†™ä½œç”¨&#34;&gt;AOFé‡å†™ä½œç”¨&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;é™ä½ç£ç›˜å ç”¨é‡ï¼Œæé«˜ç£ç›˜åˆ©ç”¨ç‡&lt;/li&gt;
&lt;li&gt;æé«˜æŒä¹…åŒ–æ•ˆç‡ï¼Œé™ä½æŒä¹…åŒ–å†™æ—¶é—´ï¼Œæé«˜IOæ€§èƒ½&lt;/li&gt;
&lt;li&gt;é™ä½æ•°æ®æ¢å¤ç”¨æ—¶ï¼Œæé«˜æ•°æ®æ¢å¤æ•ˆç‡&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;aofé‡å†™è§„åˆ™&#34;&gt;AOFé‡å†™è§„åˆ™&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;è¿›ç¨‹å†…å·²è¶…æ—¶çš„æ•°æ®ä¸å†å†™å…¥æ–‡ä»¶&lt;/li&gt;
&lt;li&gt;å¿½ç•¥æ— æ•ˆæŒ‡ä»¤ï¼Œé‡å†™æ—¶ä½¿ç”¨è¿›ç¨‹å†…æ•°æ®ç›´æ¥ç”Ÿæˆï¼Œè¿™æ ·æ–°çš„AOFæ–‡ä»¶åªä¿ç•™æœ€ç»ˆæ•°æ®çš„å†™å…¥å‘½ä»¤
&lt;ul&gt;
&lt;li&gt;å¦‚del key1ã€ hdel key2ã€srem key3ã€set key4 111ã€set key4 222ç­‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¯¹åŒä¸€æ•°æ®çš„å¤šæ¡å†™å‘½ä»¤åˆå¹¶ä¸ºä¸€æ¡å‘½ä»¤
&lt;ul&gt;
&lt;li&gt;å¦‚lpush list1 aã€lpush list1 bã€ lpush list1 c å¯ä»¥è½¬åŒ–ä¸ºï¼šlpush list1 a b cã€‚&lt;/li&gt;
&lt;li&gt;ä¸ºé˜²æ­¢æ•°æ®é‡è¿‡å¤§é€ æˆå®¢æˆ·ç«¯ç¼“å†²åŒºæº¢å‡ºï¼Œå¯¹listã€setã€hashã€zsetç­‰ç±»å‹ï¼Œæ¯æ¡æŒ‡ä»¤æœ€å¤šå†™å…¥64ä¸ªå…ƒç´ &lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;aofé‡å†™æ–¹å¼&#34;&gt;AOFé‡å†™æ–¹å¼&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æ‰‹åŠ¨é‡å†™&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;bgrewriteaof 
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;è‡ªåŠ¨é‡å†™&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;auto-aof-rewrite-min-size size 
auto-aof-rewrite-percentage percentage
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;aofæ‰‹åŠ¨é‡å†™-bgrewriteaofæŒ‡ä»¤å·¥ä½œåŸç†&#34;&gt;AOFæ‰‹åŠ¨é‡å†™ â€”â€” bgrewriteaofæŒ‡ä»¤å·¥ä½œåŸç†&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/bgsave%E6%8C%87%E4%BB%A4%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/bgrewriteaof%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;aofè‡ªåŠ¨é‡å†™æ–¹å¼&#34;&gt;AOFè‡ªåŠ¨é‡å†™æ–¹å¼&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;è‡ªåŠ¨é‡å†™è§¦å‘æ¡ä»¶è®¾ç½®&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;auto-aof-rewrite-min-size size 
auto-aof-rewrite-percentage percent 
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;è‡ªåŠ¨é‡å†™è§¦å‘æ¯”å¯¹å‚æ•°ï¼ˆ è¿è¡ŒæŒ‡ä»¤info Persistenceè·å–å…·ä½“ä¿¡æ¯ ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;aof_current_size 
aof_base_size 
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;è‡ªåŠ¨é‡å†™è§¦å‘æ¡ä»¶&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%87%AA%E5%8A%A8%E8%A7%A6%E5%8F%91%E9%87%8D%E5%86%99%E6%9D%A1%E4%BB%B6.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;aofé‡å†™æµç¨‹&#34;&gt;AOFé‡å†™æµç¨‹&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;9&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/AOF%E9%87%8D%E5%86%99%E6%B5%81%E7%A8%8B1.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;aofé‡å†™æµç¨‹-2&#34;&gt;AOFé‡å†™æµç¨‹&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;10&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/AOF%E9%87%8D%E5%86%99%E6%B5%81%E7%A8%8B2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;AOFç¼“å†²åŒºåŒæ­¥æ–‡ä»¶ç­–ç•¥ï¼Œç”±å‚æ•°appendfsyncæ§åˆ¶&lt;/p&gt;
&lt;p&gt;ç³»ç»Ÿè°ƒç”¨writeå’Œfsyncè¯´æ˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;writeæ“ä½œä¼šè§¦å‘å»¶è¿Ÿå†™ï¼ˆdelayed writeï¼‰æœºåˆ¶ï¼ŒLinuxåœ¨å†…æ ¸æä¾›é¡µç¼“å†²åŒºç”¨æ¥æé«˜ç¡¬ç›˜IOæ€§èƒ½ã€‚writeæ“ä½œåœ¨å†™å…¥ç³»ç»Ÿç¼“å†²åŒºåç›´æ¥è¿”å›ã€‚åŒæ­¥ç¡¬ç›˜æ“ä½œä¾èµ–äºç³»ç»Ÿè°ƒåº¦æœºåˆ¶ï¼Œåˆ—å¦‚ï¼šç¼“å†²åŒºé¡µç©ºé—´å†™æ»¡æˆ–è¾¾åˆ°ç‰¹å®šæ—¶é—´å‘¨æœŸã€‚åŒæ­¥æ–‡ä»¶ä¹‹å‰ï¼Œå¦‚æœæ­¤æ—¶ç³»ç»Ÿæ•…éšœå®•æœºï¼Œç¼“å†²åŒºå†…æ•°æ®å°†ä¸¢å¤±ã€‚&lt;/li&gt;
&lt;li&gt;fsyncé’ˆå¯¹å•ä¸ªæ–‡ä»¶æ“ä½œï¼ˆæ¯”å¦‚AOFæ–‡ä»¶ï¼‰ï¼Œåšå¼ºåˆ¶ç¡¬ç›˜åŒæ­¥ï¼Œfsyncå°†é˜»å¡çŸ¥é“å†™å…¥ç¡¬ç›˜å®Œæˆåè¿”å›ï¼Œä¿è¯äº†æ•°æ®æŒä¹…åŒ–ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é™¤äº†writeã€fsyncã€Linxè¿˜æä¾›äº†syncã€fdatasyncæ“ä½œï¼Œå…·ä½“APIè¯´æ˜å‚è§ï¼š&lt;/p&gt;
&lt;h1 id=&#34;rdbä¸aofåŒºåˆ«&#34;&gt;RDBä¸AOFåŒºåˆ«&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;æŒä¹…åŒ–æ–¹å¼&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;RDB&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;AOF&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å ç”¨å­˜å‚¨ç©ºé—´&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å°ï¼ˆæ•°æ®çº§ï¼šå‹ç¼©ï¼‰&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å¤§ï¼ˆæŒ‡ä»¤çº§ï¼šé‡å†™ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å­˜å‚¨é€Ÿåº¦&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ…¢&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å¿«&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ¢å¤é€Ÿåº¦&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å¿«&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ…¢&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ•°æ®å®‰å…¨æ€§&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ä¼šä¸¢å¤±æ•°æ®&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ä¾æ®ç­–ç•¥å†³å®š&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;èµ„æºæ¶ˆè€—&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;é«˜ / é‡é‡çº§&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ä½ / è½»é‡çº§&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å¯åŠ¨ä¼˜å…ˆçº§&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ä½&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;é«˜&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;rdbä¸aofçš„é€‰æ‹©ä¹‹æƒ‘&#34;&gt;RDBä¸AOFçš„é€‰æ‹©ä¹‹æƒ‘&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹&lt;strong&gt;æ•°æ®éå¸¸æ•æ„Ÿ&lt;/strong&gt;ï¼Œå»ºè®®ä½¿ç”¨é»˜è®¤çš„&lt;strong&gt;AOF&lt;/strong&gt;æŒä¹…åŒ–æ–¹æ¡ˆ
&lt;ul&gt;
&lt;li&gt;AOFæŒä¹…åŒ–ç­–ç•¥ä½¿ç”¨everysecondï¼Œæ¯ç§’é’Ÿfsyncä¸€æ¬¡ã€‚è¯¥ç­–ç•¥redisä»å¯ä»¥ä¿æŒå¾ˆå¥½çš„å¤„ç†æ€§èƒ½ï¼Œå½“å‡ºç°é—®é¢˜æ—¶ï¼Œæœ€å¤šä¸¢å¤±0-1ç§’å†…çš„æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;æ³¨æ„ï¼šç”±äºAOFæ–‡ä»¶å­˜å‚¨ä½“ç§¯è¾ƒå¤§ï¼Œä¸”æ¢å¤é€Ÿåº¦è¾ƒæ…¢&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ•°æ®å‘ˆç°&lt;strong&gt;é˜¶æ®µæœ‰æ•ˆæ€§&lt;/strong&gt;ï¼Œå»ºè®®ä½¿ç”¨&lt;strong&gt;RDB&lt;/strong&gt;æŒä¹…åŒ–æ–¹æ¡ˆ
&lt;ul&gt;
&lt;li&gt;æ•°æ®å¯ä»¥è‰¯å¥½çš„åšåˆ°é˜¶æ®µå†…æ— ä¸¢å¤±ï¼ˆè¯¥é˜¶æ®µæ˜¯å¼€å‘è€…æˆ–è¿ç»´äººå‘˜æ‰‹å·¥ç»´æŠ¤çš„ï¼‰ï¼Œä¸”æ¢å¤é€Ÿåº¦è¾ƒå¿«ï¼Œé˜¶æ®µç‚¹æ•°æ®æ¢å¤é€šå¸¸é‡‡ç”¨RDBæ–¹æ¡ˆ&lt;/li&gt;
&lt;li&gt;æ³¨æ„ï¼šåˆ©ç”¨RDBå®ç°ç´§å‡‘çš„æ•°æ®æŒä¹…åŒ–ä¼šä½¿Redisé™çš„å¾ˆä½&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç»¼åˆæ¯”å¯¹
&lt;ul&gt;
&lt;li&gt;RDBä¸AOFçš„é€‰æ‹©å®é™…ä¸Šæ˜¯åœ¨åšä¸€ç§æƒè¡¡ï¼Œæ¯ç§éƒ½æœ‰åˆ©æœ‰å¼Š&lt;/li&gt;
&lt;li&gt;å¦‚ä¸èƒ½æ‰¿å—æ•°åˆ†é’Ÿä»¥å†…çš„æ•°æ®ä¸¢å¤±ï¼Œå¯¹ä¸šåŠ¡æ•°æ®éå¸¸æ•æ„Ÿï¼Œé€‰ç”¨AOF&lt;/li&gt;
&lt;li&gt;å¦‚èƒ½æ‰¿å—æ•°åˆ†é’Ÿä»¥å†…çš„æ•°æ®ä¸¢å¤±ï¼Œä¸”è¿½æ±‚å¤§æ•°æ®é›†çš„æ¢å¤é€Ÿåº¦ï¼Œé€‰ç”¨RDB&lt;/li&gt;
&lt;li&gt;ç¾éš¾æ¢å¤é€‰ç”¨RDB&lt;/li&gt;
&lt;li&gt;åŒä¿é™©ç­–ç•¥ï¼ŒåŒæ—¶å¼€å¯ RDB å’Œ AOFï¼Œé‡å¯åï¼ŒRedisä¼˜å…ˆä½¿ç”¨ AOF æ¥æ¢å¤æ•°æ®ï¼Œé™ä½ä¸¢å¤±æ•°æ®çš„é‡&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;æŒä¹…åŒ–åº”ç”¨åœºæ™¯&#34;&gt;æŒä¹…åŒ–åº”ç”¨åœºæ™¯&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Tips 1ï¼š&lt;s&gt;redisç”¨äºæ§åˆ¶&lt;/s&gt;&lt;strong&gt;&lt;s&gt;æ•°æ®åº“è¡¨ä¸»é”®id&lt;/s&gt;&lt;/strong&gt;~~ï¼Œä¸ºæ•°æ®åº“è¡¨ä¸»é”®æä¾›ç”Ÿæˆç­–ç•¥ï¼Œä¿éšœæ•°æ®åº“è¡¨çš„ä¸»é”®å”¯ä¸€æ€§ ~~ã€å‡å¦‚ç°åœ¨è®¡ç®—æœºåœæ­¢å·¥ä½œï¼Œä¸‹ä¸€æ¬¡å¯åŠ¨è¦æ¢å¤æ—¶ï¼Œä¸æœŸæœ›æ•°æ®æ˜¯ä» redis è¯»å–çš„ã€‚æ¯”å¦‚ id  å¦‚æœç”¨åˆ° 18 äº†ï¼Œä¸‹ä¸€æ¬¡æ¢å¤çš„æ—¶å€™ä» 18 æ¢å¤ï¼Œå¤§æ¦‚ç‡æœ‰é—®é¢˜ï¼Œä¸­é—´æ–­çš„ä¼šå¯¼è‡´ id ä¸è¿ç»­ï¼Œæ¯”å¦‚æœ‰ä¸€ç§’ç”¨äº† 19ï¼Œä½†æ˜¯ redis æ²¡æœ‰è®°ä¸‹æ¥ï¼Œä¸‹æ¬¡ä» 18 æ¢å¤å°±ä¼š id é‡å¤ã€‚è§£å†³æ–¹æ¡ˆï¼šä»æ•°æ®åº“è¯»å–ï¼Œæ‰¾å‡ºæœ€å¤§çš„ id ï¼Œç„¶ååŠ ä¸€ä½¿ç”¨ã€‚æ‰€ä»¥æ•°æ®åº“ä¸»é”® id ä¸å»ºè®®æŒä¹…åŒ–ã€‘&lt;/li&gt;
&lt;li&gt;Tips 3ï¼š&lt;s&gt;redisåº”ç”¨äºå„ç§ç»“æ„å‹å’Œéç»“æ„å‹&lt;/s&gt;&lt;strong&gt;&lt;s&gt;é«˜çƒ­åº¦æ•°æ®è®¿é—®åŠ é€Ÿ&lt;/s&gt;&lt;/strong&gt;~~ ~~ï¼ˆç¼“å­˜é‡Œçš„æ•°æ®è¦ä¸è¦æ•°æ®åŒ–ï¼Ÿï¼‰ã€ç¼“å­˜ä¸­çš„æ•°æ®ä»æ•°æ®åº“è¯»å–åŠ è½½æ¥çš„ï¼Œä» redis è¯»å–å‡ºæ¥å’Œä»æ•°æ®åº“è¯»å‡ºæ¥æ²¡ä»€ä¹ˆåŒºåˆ«ã€‘&lt;/li&gt;
&lt;li&gt;Tips 4ï¼š&lt;s&gt;redis åº”ç”¨äº&lt;/s&gt;&lt;strong&gt;&lt;s&gt;è´­ç‰©è½¦&lt;/s&gt;&lt;/strong&gt;&lt;s&gt;æ•°æ®å­˜å‚¨è®¾è®¡&lt;/s&gt; ã€è´­ç‰©è½¦ä¿¡æ¯æ•°æ®åº“å†…è‚¯å®šè¦å­˜ï¼Œå°±å¯¼è‡´ redis å’Œæ•°æ®åº“å†…å­˜çš„ä¸€æ ·ï¼Œæ‰€ä»¥ redis å°±ä¸é¢å¤–å­˜å‚¨ã€‘&lt;/li&gt;
&lt;li&gt;Tips 5ï¼šredis åº”ç”¨äº&lt;strong&gt;æŠ¢è´­&lt;/strong&gt;ï¼Œé™è´­ç±»ã€é™é‡å‘æ”¾ä¼˜æƒ å·ã€æ¿€æ´»ç ç­‰ä¸šåŠ¡çš„æ•°æ®å­˜å‚¨è®¾è®¡ ã€æŠ¢è´­ï¼šé€Ÿåº¦éå¸¸å¿«ï¼Œå‡ ç§’é’Ÿå†…å®Œæˆç„¶åæ¶ˆå¤±æ‰ï¼Œå¦‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å‡ºç°é—®é¢˜äº†ï¼Œæ•°æ®åº“å¯èƒ½æ²¡æœ‰æŒä¹…åŒ–ï¼Œ ä¹Ÿå¯èƒ½è®°å½•äº†è¿‡ç¨‹ã€‚ å¿«é€Ÿå­˜å‚¨ã€å¿«é€Ÿæ¶ˆå¤±çš„æ•°æ®æŒä¹…åŒ–ã€‘&lt;/li&gt;
&lt;li&gt;Tips 6ï¼šredis åº”ç”¨äºå…·æœ‰&lt;strong&gt;æ“ä½œå…ˆåé¡ºåº&lt;/strong&gt;çš„æ•°æ®æ§åˆ¶ ã€ä¸´æ—¶ä»»åŠ¡ï¼Œå¦‚æœæ¶ˆæ¯å­˜å‚¨é‡ä¸å¤§ï¼Œå»ºè®®æŒä¹…åŒ–ã€‘&lt;/li&gt;
&lt;li&gt;Tips 7ï¼šredis åº”ç”¨äº&lt;strong&gt;æœ€æ–°æ¶ˆæ¯å±•ç¤º&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Tips 9ï¼š&lt;s&gt;redis åº”ç”¨äºåŒç±»ä¿¡æ¯çš„&lt;/s&gt;&lt;strong&gt;&lt;s&gt;å…³è”æœç´¢&lt;/s&gt;&lt;/strong&gt;~~ï¼ŒäºŒåº¦å…³è”æœç´¢ï¼Œæ·±åº¦å…³è”æœç´¢ ~~ã€å…³ç³»ç½‘åºå¤§ï¼Œå­˜åˆ°æ•°æ®åº“ã€‘&lt;/li&gt;
&lt;li&gt;Tips 12ï¼šredis åº”ç”¨äºåŸºäº&lt;strong&gt;é»‘åå•&lt;/strong&gt;ä¸&lt;strong&gt;ç™½åå•&lt;/strong&gt;è®¾å®šçš„æœåŠ¡æ§åˆ¶ ã€æ°¸ä¹…æ€§å­˜åˆ°æ•°æ®åº“ï¼Œä¸´æ—¶æ€§æŒä¹…åŒ–ã€‘&lt;/li&gt;
&lt;li&gt;Tips 13ï¼šredis åº”ç”¨äºè®¡æ•°å™¨ç»„åˆæ’åºåŠŸèƒ½å¯¹åº”çš„&lt;strong&gt;æ’å ã€20ä¸ªä¸»æ’­ä¸€èµ·ä¸»æ’­ï¼Œè¿›è¡Œæ’åï¼Œä¸»æ’­ç»“æŸæ•°æ®å°±æ¶ˆå¤±äº†ï¼Œå¦‚æœä¸æŒä¹…åŒ–è¿™ä¸ªä¿¡æ¯ï¼Œå®ƒä¹Ÿä¸åœ¨æ•°æ®åº“å†…å­˜å‚¨å°±æ²¡æœ‰äº†ã€‚20ä¸‡äººåœ¨çº¿è§‚çœ‹ï¼Œå¦‚æœä¸æŒä¹…åŒ–è®°å½•æœåŠ¡å™¨ä¸€å®•æœºå°±0äººåœ¨çº¿äº†ï¼Œæ‰€ä»¥éœ€æŒä¹…åŒ–è®°å½•å¿«é€Ÿæ¢å¤ã€‘&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Tips 15ï¼šredis åº”ç”¨äº&lt;strong&gt;å³æ—¶ä»»åŠ¡/æ¶ˆæ¯é˜Ÿåˆ—&lt;/strong&gt;æ‰§è¡Œç®¡ç†&lt;/li&gt;
&lt;li&gt;Tips 16ï¼šredis åº”ç”¨äº&lt;strong&gt;æŒ‰æ¬¡ç»“ç®—çš„æœåŠ¡æ§åˆ¶&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h1&gt;
&lt;p&gt;RedisæŒä¹…åŒ–&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä»€ä¹ˆæ˜¯æŒä¹…åŒ–&lt;/li&gt;
&lt;li&gt;RDB
&lt;ul&gt;
&lt;li&gt;save&lt;/li&gt;
&lt;li&gt;bgsave&lt;/li&gt;
&lt;li&gt;é…ç½®&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;AOF
&lt;ul&gt;
&lt;li&gt;æŒä¹…åŒ–å†™ç­–ç•¥&lt;/li&gt;
&lt;li&gt;é‡å†™&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
">Redis æŒä¹…åŒ–</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/42-dao-ji-suan-ji-wang-luo-mian-shi-gao-pin-ti-da-an-mian-shi-guan-xi-huan-de-da-an-du-zai-zhe-li/"" data-c="
          &lt;h1 id=&#34;1-è°ˆä¸‹ä½ å¯¹äº”å±‚ç½‘ç»œåè®®ä½“ç³»ç»“æ„çš„ç†è§£&#34;&gt;1ã€è°ˆä¸‹ä½ å¯¹äº”å±‚ç½‘ç»œåè®®ä½“ç³»ç»“æ„çš„ç†è§£ï¼ˆ*ï¼‰&lt;/h1&gt;
&lt;p&gt;å­¦ä¹ è®¡ç®—æœºç½‘ç»œæ—¶æˆ‘ä»¬ä¸€èˆ¬é‡‡ç”¨æŠ˜ä¸­çš„åŠæ³•ï¼Œä¹Ÿå°±æ˜¯ä¸­å’Œ OSI å’Œ TCP/IP çš„ä¼˜ç‚¹ï¼Œé‡‡ç”¨ä¸€ç§åªæœ‰äº”å±‚åè®®çš„ä½“ç³»ç»“æ„ï¼Œè¿™æ ·æ—¢ç®€æ´åˆèƒ½å°†æ¦‚å¿µé˜è¿°æ¸…æ¥šã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E4%BA%94%E5%B1%82%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;1-åº”ç”¨å±‚&#34;&gt;1. åº”ç”¨å±‚&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%BA%94%E7%94%A8%E5%B1%82.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;åº”ç”¨å±‚ï¼ˆapplication-layerï¼‰çš„ä»»åŠ¡æ˜¯&lt;strong&gt;é€šè¿‡åº”ç”¨è¿›ç¨‹é—´çš„äº¤äº’æ¥å®Œæˆç‰¹å®šç½‘ç»œåº”ç”¨&lt;/strong&gt;ã€‚åº”ç”¨å±‚åè®®å®šä¹‰çš„æ˜¯åº”ç”¨è¿›ç¨‹ï¼ˆè¿›ç¨‹ï¼šä¸»æœºä¸­æ­£åœ¨è¿è¡Œçš„ç¨‹åºï¼‰é—´çš„é€šä¿¡å’Œäº¤äº’çš„è§„åˆ™ã€‚å¯¹äºä¸åŒçš„ç½‘ç»œåº”ç”¨éœ€è¦ä¸åŒçš„åº”ç”¨å±‚åè®®ã€‚åœ¨äº’è”ç½‘ä¸­åº”ç”¨å±‚åè®®å¾ˆå¤šï¼Œå¦‚åŸŸåç³»ç»Ÿ DNSï¼Œæ”¯æŒä¸‡ç»´ç½‘åº”ç”¨çš„ HTTP åè®®ï¼Œæ”¯æŒç”µå­é‚®ä»¶çš„ SMTP åè®®ç­‰ç­‰ã€‚æˆ‘ä»¬æŠŠåº”ç”¨å±‚äº¤äº’çš„æ•°æ®å•å…ƒç§°ä¸ºæŠ¥æ–‡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;2-è¿è¾“å±‚&#34;&gt;2.Â è¿è¾“å±‚&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%BF%90%E8%BE%93%E5%B1%82.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;è¿è¾“å±‚ï¼ˆtransport layerï¼‰çš„ä¸»è¦ä»»åŠ¡å°±æ˜¯è´Ÿè´£&lt;strong&gt;å‘ä¸¤å°ä¸»æœºè¿›ç¨‹ä¹‹é—´çš„é€šä¿¡æä¾›é€šç”¨çš„æ•°æ®ä¼ è¾“æœåŠ¡&lt;/strong&gt;ã€‚åº”ç”¨è¿›ç¨‹åˆ©ç”¨è¯¥æœåŠ¡ä¼ é€åº”ç”¨å±‚æŠ¥æ–‡ã€‚â€œé€šç”¨çš„â€æ˜¯æŒ‡å¹¶ä¸é’ˆå¯¹æŸä¸€ä¸ªç‰¹å®šçš„ç½‘ç»œåº”ç”¨ï¼Œè€Œæ˜¯å¤šç§åº”ç”¨å¯ä»¥ä½¿ç”¨åŒä¸€ä¸ªè¿è¾“å±‚æœåŠ¡ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%BF%90%E8%BE%93%E5%B1%82_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ç”±äºä¸€å°ä¸»æœºå¯åŒæ—¶è¿è¡Œå¤šä¸ªçº¿ç¨‹ï¼Œå› æ­¤è¿è¾“å±‚æœ‰å¤ç”¨å’Œåˆ†ç”¨çš„åŠŸèƒ½ã€‚æ‰€è°“å¤ç”¨å°±æ˜¯æŒ‡å¤šä¸ªåº”ç”¨å±‚è¿›ç¨‹å¯åŒæ—¶ä½¿ç”¨ä¸‹é¢è¿è¾“å±‚çš„æœåŠ¡ï¼Œåˆ†ç”¨å’Œå¤ç”¨ç›¸åï¼Œæ˜¯è¿è¾“å±‚æŠŠæ”¶åˆ°çš„ä¿¡æ¯åˆ†åˆ«äº¤ä»˜ä¸Šé¢åº”ç”¨å±‚ä¸­çš„ç›¸åº”è¿›ç¨‹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;3-ç½‘ç»œå±‚&#34;&gt;3. ç½‘ç»œå±‚&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E7%BD%91%E7%BB%9C%E5%B1%82.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;åœ¨è®¡ç®—æœºç½‘ç»œä¸­è¿›è¡Œé€šä¿¡çš„ä¸¤ä¸ªè®¡ç®—æœºä¹‹é—´å¯èƒ½ä¼šç»è¿‡å¾ˆå¤šä¸ªæ•°æ®é“¾è·¯ï¼Œä¹Ÿå¯èƒ½è¿˜è¦ç»è¿‡å¾ˆå¤šé€šä¿¡å­ç½‘ã€‚ç½‘ç»œå±‚çš„ä»»åŠ¡å°±æ˜¯&lt;strong&gt;é€‰æ‹©åˆé€‚çš„ç½‘é—´è·¯ç”±å’Œäº¤æ¢ç»“ç‚¹ï¼Œ ç¡®ä¿æ•°æ®åŠæ—¶ä¼ é€&lt;/strong&gt;ã€‚åœ¨å‘é€æ•°æ®æ—¶ï¼Œç½‘ç»œå±‚æŠŠè¿è¾“å±‚äº§ç”Ÿçš„æŠ¥æ–‡æ®µæˆ–ç”¨æˆ·æ•°æ®æŠ¥å°è£…æˆåˆ†ç»„å’ŒåŒ…è¿›è¡Œä¼ é€ã€‚åœ¨ TCP / IP ä½“ç³»ç»“æ„ä¸­ï¼Œç”±äºç½‘ç»œå±‚ä½¿ç”¨ IP åè®®ï¼Œå› æ­¤&lt;strong&gt;åˆ†ç»„&lt;/strong&gt;ä¹Ÿå« &lt;strong&gt;IP æ•°æ®æŠ¥&lt;/strong&gt;ï¼Œç®€ç§°æ•°æ®æŠ¥ã€‚&lt;/p&gt;
&lt;h2 id=&#34;4-æ•°æ®é“¾è·¯å±‚&#34;&gt;4.Â æ•°æ®é“¾è·¯å±‚&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;æ•°æ®é“¾è·¯å±‚ï¼ˆdata link layerï¼‰é€šå¸¸ç®€ç§°ä¸ºé“¾è·¯å±‚ã€‚ä¸¤å°ä¸»æœºä¹‹é—´çš„æ•°æ®ä¼ è¾“ï¼Œæ€»æ˜¯åœ¨ä¸€æ®µä¸€æ®µçš„é“¾è·¯ä¸Šä¼ é€çš„ï¼Œè¿™å°±éœ€è¦ä½¿ç”¨ä¸“é—¨çš„é“¾è·¯å±‚çš„åè®®ã€‚åœ¨ä¸¤ä¸ªç›¸é‚»èŠ‚ç‚¹ä¹‹é—´ä¼ é€æ•°æ®æ—¶ï¼Œ&lt;strong&gt;æ•°æ®é“¾è·¯å±‚å°†ç½‘ç»œå±‚äº¤ä¸‹æ¥çš„ IP æ•°æ®æŠ¥ç»„è£…æˆå¸§ï¼Œåœ¨ä¸¤ä¸ªç›¸é‚»èŠ‚ç‚¹é—´çš„é“¾è·¯ä¸Šä¼ é€å¸§&lt;/strong&gt;ã€‚æ¯ä¸€å¸§åŒ…æ‹¬æ•°æ®å’Œå¿…è¦çš„æ§åˆ¶ä¿¡æ¯ï¼ˆå¦‚ï¼šåŒæ­¥ä¿¡æ¯ï¼Œåœ°å€ä¿¡æ¯ï¼Œå·®é”™æ§åˆ¶ç­‰ï¼‰ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%B0%81%E8%A3%85%E6%88%90%E5%B8%A7.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%B7%AE%E9%94%99%E6%A3%80%E9%AA%8C.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;9&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%8F%AF%E9%9D%A0%E4%BC%A0%E8%BE%93.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;åœ¨æ¥æ”¶æ•°æ®æ—¶ï¼Œæ§åˆ¶ä¿¡æ¯ä½¿æ¥æ”¶ç«¯èƒ½å¤ŸçŸ¥é“ä¸€ä¸ªå¸§ä»å“ªä¸ªæ¯”ç‰¹å¼€å§‹å’Œåˆ°å“ªä¸ªæ¯”ç‰¹ç»“æŸã€‚è¿™æ ·ï¼Œæ•°æ®é“¾è·¯å±‚åœ¨æ”¶åˆ°ä¸€ä¸ªå¸§åï¼Œå°±å¯ä»ä¸­æå‡º&lt;strong&gt;æ•°æ®éƒ¨åˆ†&lt;/strong&gt;ï¼Œä¸Šäº¤ç»™ç½‘ç»œå±‚ã€‚æ§åˆ¶ä¿¡æ¯è¿˜ä½¿æ¥æ”¶ç«¯èƒ½å¤Ÿæ£€æµ‹åˆ°æ‰€æ”¶åˆ°çš„å¸§ä¸­&lt;strong&gt;æœ‰æ— å·®é”™&lt;/strong&gt;ã€‚å¦‚æœå‘ç°å·®é”™ï¼Œæ•°æ®é“¾è·¯å±‚å°±ç®€å•åœ°ä¸¢å¼ƒè¿™ä¸ªå‡ºäº†å·®é”™çš„å¸§ï¼Œä»¥é¿å…ç»§ç»­åœ¨ç½‘ç»œä¸­ä¼ é€ä¸‹å»ç™½ç™½æµªè´¹ç½‘ç»œèµ„æºã€‚å¦‚æœéœ€è¦æ”¹æ­£æ•°æ®åœ¨é“¾è·¯å±‚ä¼ è¾“æ—¶å‡ºç°å·®é”™ï¼ˆè¿™å°±æ˜¯è¯´ï¼Œæ•°æ®é“¾è·¯å±‚ä¸ä»…è¦æ£€é”™ï¼Œè€Œä¸”è¿˜è¦çº é”™ï¼‰ï¼Œé‚£ä¹ˆå°±è¦é‡‡ç”¨&lt;strong&gt;å¯é æ€§ä¼ è¾“åè®®&lt;/strong&gt;æ¥çº æ­£å‡ºç°çš„å·®é”™ã€‚è¿™ç§æ–¹æ³•ä¼šä½¿é“¾è·¯å±‚çš„åè®®å¤æ‚äº›ã€‚&lt;/p&gt;
&lt;h2 id=&#34;5-ç‰©ç†å±‚&#34;&gt;5. ç‰©ç†å±‚&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;10&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E7%89%A9%E7%90%86%E5%B1%82.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;åœ¨ç‰©ç†å±‚ä¸Šæ‰€ä¼ é€çš„æ•°æ®å•ä½æ˜¯&lt;strong&gt;æ¯”ç‰¹&lt;/strong&gt;ã€‚ç‰©ç†å±‚ï¼ˆphysical layerï¼‰çš„ä½œç”¨æ˜¯å®ç°ç›¸é‚»è®¡ç®—æœºèŠ‚ç‚¹ä¹‹é—´&lt;strong&gt;æ¯”ç‰¹æµçš„é€æ˜ä¼ é€&lt;/strong&gt;ï¼Œå°½å¯èƒ½&lt;strong&gt;å±è”½æ‰å…·ä½“ä¼ è¾“ä»‹è´¨å’Œç‰©ç†è®¾å¤‡çš„å·®å¼‚&lt;/strong&gt;ã€‚ä½¿å…¶ä¸Šé¢çš„æ•°æ®é“¾è·¯å±‚ä¸å¿…è€ƒè™‘ç½‘ç»œçš„å…·ä½“ä¼ è¾“ä»‹è´¨æ˜¯ä»€ä¹ˆã€‚â€œé€æ˜ä¼ é€æ¯”ç‰¹æµâ€è¡¨ç¤ºç»å®é™…ç”µè·¯ä¼ é€åçš„æ¯”ç‰¹æµæ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œå¯¹ä¼ é€çš„æ¯”ç‰¹æµæ¥è¯´ï¼Œè¿™ä¸ªç”µè·¯å¥½åƒæ˜¯çœ‹ä¸è§çš„ã€‚&lt;/p&gt;
&lt;h1 id=&#34;2-ç®€å•è¯´ä¸‹æ¯ä¸€å±‚å¯¹åº”çš„ç½‘ç»œåè®®æœ‰å“ªäº›&#34;&gt;2ã€ç®€å•è¯´ä¸‹æ¯ä¸€å±‚å¯¹åº”çš„ç½‘ç»œåè®®æœ‰å“ªäº›ï¼Ÿï¼ˆ**ï¼‰&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;ç®€å•è®°ä½ä¸¤ä¸‰ä¸ªå¸¸è§çš„å°±è¡Œã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è®¡ç®—æœºäº”å±‚ç½‘ç»œä½“ç³»ä¸­æ¶‰åŠçš„åè®®éå¸¸å¤šï¼Œä¸‹é¢å°±å¸¸ç”¨çš„åšäº†åˆ—ä¸¾ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;11&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%AF%8F%E4%B8%80%E5%B1%82%E5%AF%B9%E5%BA%94%E7%9A%84%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h1 id=&#34;3-arp-åè®®çš„å·¥ä½œåŸç†&#34;&gt;3ã€ARP åè®®çš„å·¥ä½œåŸç†ï¼Ÿï¼ˆ*ï¼‰&lt;/h1&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;12&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/ARP%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;mac-åœ°å€&#34;&gt;MAC åœ°å€&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;13&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/MAC%E5%9C%B0%E5%9D%80.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;14&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/MAC%E5%9C%B0%E5%9D%80_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;MAC åœ°å€æœ‰æ—¶ä¹Ÿè¢«ç§°ä¸º&lt;strong&gt;ç‰©ç†åœ°å€&lt;/strong&gt;ï¼Œä½†è¿™ä¸æ„å‘³ç€ MAC å±äºç½‘ç»œä½“ç³»ç»“æ„ä¸­çš„ç‰©ç†å±‚ï¼ŒMAC åœ°å€å±äº&lt;strong&gt;æ•°æ®é“¾è·¯å±‚&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;ip-åœ°å€&#34;&gt;IP åœ°å€&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/IP%E5%9C%B0%E5%9D%80.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E4%BB%8E%E7%BD%91%E7%BB%9C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E7%9C%8BIP%E5%9C%B0%E5%9D%80%E4%B8%8EMAC%E5%9C%B0%E5%9D%80.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%95%B0%E6%8D%AE%E5%8C%85%E8%BD%AC%E5%8F%91%E8%BF%87%E7%A8%8B%E4%B8%ADIP%E5%9C%B0%E5%9D%80%E4%B8%8EMAC%E5%9C%B0%E5%9D%80%E7%9A%84%E5%8F%98%E5%8C%96%E6%83%85%E5%86%B5.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%95%B0%E6%8D%AE%E5%8C%85%E8%BD%AC%E5%8F%91%E8%BF%87%E7%A8%8B%E4%B8%ADIP%E5%9C%B0%E5%9D%80%E4%B8%8EMAC%E5%9C%B0%E5%9D%80%E7%9A%84%E5%8F%98%E5%8C%96%E6%83%85%E5%86%B5_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%95%B0%E6%8D%AE%E5%8C%85%E8%BD%AC%E5%8F%91%E8%BF%87%E7%A8%8B%E4%B8%ADIP%E5%9C%B0%E5%9D%80%E4%B8%8EMAC%E5%9C%B0%E5%9D%80%E7%9A%84%E5%8F%98%E5%8C%96%E6%83%85%E5%86%B5_3.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;arp-åè®®&#34;&gt;ARP åè®®&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/ARP%E5%8D%8F%E8%AE%AE.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/ARP%E5%8D%8F%E8%AE%AE_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/ARP%E5%8D%8F%E8%AE%AE_3.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/ARP%E5%8D%8F%E8%AE%AE_4.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/ARP%E5%8D%8F%E8%AE%AE_5.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/ARP%E5%8D%8F%E8%AE%AE_6.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ARP åªèƒ½åœ¨ä¸€æ®µé“¾è·¯æˆ–ä¸€ä¸ªç½‘ç»œä¸Šä½¿ç”¨ï¼Œä¸èƒ½è·¨ç½‘ç»œä½¿ç”¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;ç½‘ç»œå±‚&lt;/strong&gt;çš„ ARP åè®®å®Œæˆäº† &lt;strong&gt;IP åœ°å€ä¸ç‰©ç†åœ°å€çš„æ˜ å°„&lt;/strong&gt;ã€‚é¦–å…ˆï¼Œæ¯å°ä¸»æœºéƒ½ä¼šåœ¨è‡ªå·±çš„ ARP ç¼“å†²åŒºä¸­å»ºç«‹ä¸€ä¸ª ARP åˆ—è¡¨ï¼Œä»¥è¡¨ç¤º IP åœ°å€å’Œ MAC åœ°å€çš„å¯¹åº”å…³ç³»ã€‚å½“æºä¸»æœºéœ€è¦å°†ä¸€ä¸ªæ•°æ®åŒ…è¦å‘é€åˆ°ç›®çš„ä¸»æœºæ—¶ï¼Œä¼šé¦–å…ˆæ£€æŸ¥è‡ªå·± ARP åˆ—è¡¨ä¸­æ˜¯å¦å­˜åœ¨è¯¥ IP åœ°å€å¯¹åº”çš„ MAC åœ°å€ï¼šå¦‚æœæœ‰ï¼Œå°±ç›´æ¥å°†æ•°æ®åŒ…å‘é€åˆ°è¿™ä¸ª MAC åœ°å€ï¼›å¦‚æœæ²¡æœ‰ï¼Œå°±å‘æœ¬åœ°ç½‘æ®µå‘èµ·ä¸€ä¸ª ARP è¯·æ±‚çš„å¹¿æ’­åŒ…ï¼ŒæŸ¥è¯¢æ­¤ç›®çš„ä¸»æœºå¯¹åº”çš„ MAC åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤ ARP è¯·æ±‚æ•°æ®åŒ…é‡ŒåŒ…æ‹¬æºä¸»æœºçš„ IP åœ°å€ã€ç¡¬ä»¶åœ°å€ã€ä»¥åŠç›®çš„ä¸»æœºçš„ IP åœ°å€ã€‚ç½‘ç»œä¸­æ‰€æœ‰çš„ä¸»æœºæ”¶åˆ°è¿™ä¸ª ARP è¯·æ±‚åï¼Œä¼šæ£€æŸ¥æ•°æ®åŒ…ä¸­çš„ç›®çš„ IP æ˜¯å¦å’Œè‡ªå·±çš„ IP åœ°å€ä¸€è‡´ã€‚å¦‚æœä¸ç›¸åŒå°±å¿½ç•¥æ­¤æ•°æ®åŒ…ï¼›å¦‚æœç›¸åŒï¼Œè¯¥ä¸»æœºé¦–å…ˆå°†å‘é€ç«¯çš„ MAC åœ°å€å’Œ IP åœ°å€æ·»åŠ åˆ°è‡ªå·±çš„ ARP åˆ—è¡¨ä¸­ï¼Œå¦‚æœ ARP è¡¨ä¸­å·²ç»å­˜åœ¨è¯¥ IP çš„ä¿¡æ¯ï¼Œåˆ™å°†å…¶è¦†ç›–ï¼Œç„¶åç»™æºä¸»æœºå‘é€ä¸€ä¸ª ARP å“åº”æ•°æ®åŒ…ï¼Œå‘Šè¯‰å¯¹æ–¹è‡ªå·±æ˜¯å®ƒéœ€è¦æŸ¥æ‰¾çš„ MAC åœ°å€ï¼›æºä¸»æœºæ”¶åˆ°è¿™ä¸ª ARP å“åº”æ•°æ®åŒ…åï¼Œå°†å¾—åˆ°çš„ç›®çš„ä¸»æœºçš„ IP åœ°å€å’Œ MAC åœ°å€æ·»åŠ åˆ°è‡ªå·±çš„ ARP åˆ—è¡¨ä¸­ï¼Œå¹¶åˆ©ç”¨æ­¤ä¿¡æ¯å¼€å§‹æ•°æ®çš„ä¼ è¾“ã€‚å¦‚æœæºä¸»æœºä¸€ç›´æ²¡æœ‰æ”¶åˆ° ARP å“åº”æ•°æ®åŒ…ï¼Œè¡¨ç¤º ARP æŸ¥è¯¢å¤±è´¥ã€‚&lt;/p&gt;
&lt;h1 id=&#34;4-è°ˆä¸‹ä½ å¯¹-ip-åœ°å€åˆ†ç±»çš„ç†è§£&#34;&gt;4ã€è°ˆä¸‹ä½ å¯¹ IP åœ°å€åˆ†ç±»çš„ç†è§£ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;IP åœ°å€æ˜¯æŒ‡äº’è”ç½‘åè®®åœ°å€ï¼Œæ˜¯ IP åè®®æä¾›çš„ä¸€ç§ç»Ÿä¸€çš„åœ°å€æ ¼å¼ï¼Œå®ƒä¸ºäº’è”ç½‘ä¸Šçš„æ¯ä¸€ä¸ªç½‘ç»œå’Œæ¯ä¸€å°ä¸»æœºåˆ†é…ä¸€ä¸ªé€»è¾‘åœ°å€ï¼Œä»¥æ­¤æ¥å±è”½ç‰©ç†åœ°å€çš„å·®å¼‚ã€‚IP åœ°å€ç¼–å€æ–¹æ¡ˆå°† IP åœ°å€ç©ºé—´åˆ’åˆ†ä¸º Aã€Bã€Cã€Dã€E äº”ç±»ï¼Œå…¶ä¸­ Aã€Bã€C æ˜¯åŸºæœ¬ç±»ï¼ŒDã€E ç±»ä½œä¸ºå¤šæ’­å’Œä¿ç•™ä½¿ç”¨ï¼Œä¸ºç‰¹æ®Šåœ°å€ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;15&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/IP%E5%9C%B0%E5%9D%80%E5%88%86%E7%B1%BB.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;æ¯ä¸ª IP åœ°å€åŒ…æ‹¬ä¸¤ä¸ªæ ‡è¯†ç ï¼ˆIDï¼‰ï¼Œå³ç½‘ç»œ ID å’Œä¸»æœº IDã€‚åŒä¸€ä¸ªç‰©ç†ç½‘ç»œä¸Šçš„æ‰€æœ‰ä¸»æœºéƒ½ä½¿ç”¨åŒä¸€ä¸ªç½‘ç»œ IDï¼Œç½‘ç»œä¸Šçš„ä¸€ä¸ªä¸»æœºï¼ˆåŒ…æ‹¬ç½‘ç»œä¸Šå·¥ä½œç«™ï¼ŒæœåŠ¡å™¨å’Œè·¯ç”±å™¨ç­‰ï¼‰æœ‰ä¸€ä¸ªä¸»æœº ID ä¸å…¶å¯¹åº”ã€‚A~E ç±»åœ°å€çš„ç‰¹ç‚¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;A ç±»åœ°å€ï¼šä»¥ 0 å¼€å¤´ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚èŒƒå›´ï¼š0~127ï¼›&lt;/p&gt;
&lt;p&gt;B ç±»åœ°å€ï¼šä»¥ 10 å¼€å¤´ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚èŒƒå›´ï¼š128~191ï¼›&lt;/p&gt;
&lt;p&gt;C ç±»åœ°å€ï¼šä»¥ 110 å¼€å¤´ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚èŒƒå›´ï¼š192~223ï¼›&lt;/p&gt;
&lt;p&gt;D ç±»åœ°å€ï¼šä»¥ 1110 å¼€å¤´ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚èŒƒå›´ä¸º 224~239ï¼›&lt;/p&gt;
&lt;p&gt;E ç±»åœ°å€ï¼šä»¥ 1111 å¼€å¤´ï¼Œä¿ç•™åœ°å€&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/IP%E5%9C%B0%E5%9D%80%E5%88%86%E7%B1%BB_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/IP%E5%9C%B0%E5%9D%80%E5%88%86%E7%B1%BB_3.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/IP%E5%9C%B0%E5%9D%80%E5%88%86%E7%B1%BB_4.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/IP%E5%9C%B0%E5%9D%80%E5%88%86%E7%B1%BB_5.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/IP%E5%9C%B0%E5%9D%80%E5%88%86%E7%B1%BB_6.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;5-tcp-çš„ä¸»è¦ç‰¹ç‚¹æ˜¯ä»€ä¹ˆ&#34;&gt;5ã€TCP çš„ä¸»è¦ç‰¹ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆ*ï¼‰&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;TCP æ˜¯&lt;strong&gt;é¢å‘è¿æ¥&lt;/strong&gt;çš„ã€‚ï¼ˆå°±å¥½åƒæ‰“ç”µè¯ä¸€æ ·ï¼Œé€šè¯å‰éœ€è¦å…ˆæ‹¨å·å»ºç«‹è¿æ¥ï¼Œé€šè¯ç»“æŸåè¦æŒ‚æœºé‡Šæ”¾è¿æ¥ï¼‰ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ¯ä¸€æ¡ TCP è¿æ¥åªèƒ½æœ‰ä¸¤ä¸ªç«¯ç‚¹ï¼Œæ¯ä¸€æ¡ TCP è¿æ¥åªèƒ½æ˜¯ç‚¹å¯¹ç‚¹çš„ï¼ˆ&lt;strong&gt;ä¸€å¯¹ä¸€&lt;/strong&gt;ï¼‰ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;TCP æä¾›&lt;strong&gt;å¯é &lt;/strong&gt;äº¤ä»˜çš„æœåŠ¡ã€‚é€šè¿‡ TCP è¿æ¥ä¼ é€çš„æ•°æ®ï¼Œæ— å·®é”™ã€ä¸ä¸¢å¤±ã€ä¸é‡å¤ã€å¹¶ä¸”æŒ‰åºåˆ°è¾¾ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;TCP æä¾›&lt;strong&gt;å…¨åŒå·¥&lt;/strong&gt;é€šä¿¡ã€‚TCP å…è®¸é€šä¿¡åŒæ–¹çš„åº”ç”¨è¿›ç¨‹åœ¨ä»»ä½•æ—¶å€™éƒ½èƒ½å‘é€æ•°æ®ã€‚TCP è¿æ¥çš„ä¸¤ç«¯éƒ½è®¾æœ‰å‘é€ç¼“å­˜å’Œæ¥æ”¶ç¼“å­˜ï¼Œç”¨æ¥ä¸´æ—¶å­˜æ”¾åŒæ–¹é€šä¿¡çš„æ•°æ®ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é¢å‘&lt;strong&gt;å­—èŠ‚æµ&lt;/strong&gt;ã€‚TCP ä¸­çš„â€œæµâ€ï¼ˆStreamï¼‰æŒ‡çš„æ˜¯æµå…¥è¿›ç¨‹æˆ–ä»è¿›ç¨‹æµå‡ºçš„å­—èŠ‚åºåˆ—ã€‚â€œé¢å‘å­—èŠ‚æµâ€çš„å«ä¹‰æ˜¯ï¼šè™½ç„¶åº”ç”¨ç¨‹åºå’Œ TCP çš„äº¤äº’æ˜¯ä¸€æ¬¡ä¸€ä¸ªæ•°æ®å—ï¼ˆå¤§å°ä¸ç­‰ï¼‰ï¼Œä½† TCP æŠŠåº”ç”¨ç¨‹åºäº¤ä¸‹æ¥çš„æ•°æ®ä»…ä»…çœ‹æˆæ˜¯ä¸€è¿ä¸²çš„æ— ç»“æ„çš„å­—èŠ‚æµã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;6-udp-çš„ä¸»è¦ç‰¹ç‚¹æ˜¯ä»€ä¹ˆ&#34;&gt;6ã€UDP çš„ä¸»è¦ç‰¹ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;UDP æ˜¯&lt;strong&gt;æ— è¿æ¥&lt;/strong&gt;çš„ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;UDP ä½¿ç”¨å°½æœ€å¤§åŠªåŠ›äº¤ä»˜ï¼Œå³&lt;strong&gt;ä¸&lt;/strong&gt;ä¿è¯&lt;strong&gt;å¯é &lt;/strong&gt;äº¤ä»˜ï¼Œå› æ­¤ä¸»æœºä¸éœ€è¦ç»´æŒå¤æ‚çš„é“¾æ¥çŠ¶æ€ï¼ˆè¿™é‡Œé¢æœ‰è®¸å¤šå‚æ•°ï¼‰ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;UDP æ˜¯&lt;strong&gt;é¢å‘æŠ¥æ–‡&lt;/strong&gt;çš„ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;UDP &lt;strong&gt;æ²¡æœ‰æ‹¥å¡æ§åˆ¶&lt;/strong&gt;ï¼Œå› æ­¤ç½‘ç»œå‡ºç°æ‹¥å¡ä¸ä¼šä½¿æºä¸»æœºçš„å‘é€é€Ÿç‡é™ä½ï¼ˆå¯¹å®æ—¶åº”ç”¨å¾ˆæœ‰ç”¨ï¼Œå¦‚ ç›´æ’­ï¼Œå®æ—¶è§†é¢‘ä¼šè®®ç­‰ï¼‰ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;UDP æ”¯æŒ&lt;strong&gt;ä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹ä¸€å’Œå¤šå¯¹å¤š&lt;/strong&gt;çš„äº¤äº’é€šä¿¡ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;UDP çš„&lt;strong&gt;é¦–éƒ¨å¼€é”€å°&lt;/strong&gt;ï¼Œåªæœ‰ 8 ä¸ªå­—èŠ‚ï¼Œæ¯” TCP çš„ 20 ä¸ªå­—èŠ‚çš„é¦–éƒ¨è¦çŸ­ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;7-tcp-å’Œ-udp-çš„åŒºåˆ«&#34;&gt;7ã€TCP å’Œ UDP çš„åŒºåˆ«ï¼Ÿï¼ˆ*ï¼‰&lt;/h1&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;16&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/TCP%E5%92%8CUDP%E7%9A%84%E5%8C%BA%E5%88%AB.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;TCP æä¾›é¢å‘è¿æ¥çš„æœåŠ¡ã€‚åœ¨ä¼ é€æ•°æ®ä¹‹å‰å¿…é¡»å…ˆå»ºç«‹è¿æ¥ï¼Œæ•°æ®ä¼ é€ç»“æŸåè¦é‡Šæ”¾è¿æ¥ã€‚TCP ä¸æä¾›å¹¿æ’­æˆ–å¤šæ’­æœåŠ¡ã€‚ç”±äº TCP è¦æä¾›å¯é çš„ï¼Œé¢å‘è¿æ¥çš„è¿è¾“æœåŠ¡ï¼ˆTCP çš„å¯é ä½“ç°åœ¨ TCP åœ¨ä¼ é€’æ•°æ®ä¹‹å‰ï¼Œä¼šæœ‰ä¸‰æ¬¡æ¡æ‰‹æ¥å»ºç«‹è¿æ¥ï¼Œè€Œä¸”åœ¨æ•°æ®ä¼ é€’æ—¶ï¼Œæœ‰ç¡®è®¤ã€çª—å£ã€é‡ä¼ ã€æ‹¥å¡æ§åˆ¶æœºåˆ¶ï¼Œåœ¨æ•°æ®ä¼ å®Œåï¼Œè¿˜ä¼šæ–­å¼€è¿æ¥ç”¨æ¥èŠ‚çº¦ç³»ç»Ÿèµ„æºï¼‰ï¼Œè¿™éš¾ä»¥é¿å…å¢åŠ äº†è®¸å¤šå¼€é”€ï¼Œå¦‚ç¡®è®¤ï¼Œæµé‡æ§åˆ¶ï¼Œè®¡æ—¶å™¨ä»¥åŠè¿æ¥ç®¡ç†ç­‰ã€‚è¿™ä¸ä»…ä½¿åè®®æ•°æ®å•å…ƒçš„é¦–éƒ¨å¢å¤§å¾ˆå¤šï¼Œè¿˜è¦å ç”¨è®¸å¤šå¤„ç†æœºèµ„æºã€‚&lt;/p&gt;
&lt;p&gt;UDP åœ¨ä¼ é€æ•°æ®ä¹‹å‰ä¸éœ€è¦å…ˆå»ºç«‹è¿æ¥ï¼Œè¿œåœ°ä¸»æœºåœ¨æ”¶åˆ° UDP æŠ¥æ–‡åï¼Œä¸éœ€è¦ç»™å‡ºä»»ä½•ç¡®è®¤ã€‚è™½ç„¶ UDP ä¸æä¾›å¯é äº¤ä»˜ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ UDP ç¡®æ˜¯ä¸€ç§æœ€æœ‰æ•ˆçš„å·¥ä½œæ–¹å¼ï¼ˆä¸€èˆ¬ç”¨äºå³æ—¶é€šä¿¡ï¼‰ï¼Œæ¯”å¦‚ï¼šQQ è¯­éŸ³ã€ QQ è§†é¢‘ ã€ç›´æ’­ç­‰ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/TCP%E5%92%8CUDP%E7%9A%84%E5%8C%BA%E5%88%AB_1.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/TCP%E5%92%8CUDP%E7%9A%84%E5%8C%BA%E5%88%AB_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/TCP%E5%92%8CUDP%E7%9A%84%E5%8C%BA%E5%88%AB_3.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/TCP%E5%92%8CUDP%E7%9A%84%E5%8C%BA%E5%88%AB_4.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/TCP%E5%92%8CUDP%E7%9A%84%E5%8C%BA%E5%88%AB_5.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;8-tcp-å’Œ-udp-åˆ†åˆ«å¯¹åº”çš„å¸¸è§åº”ç”¨å±‚åè®®æœ‰å“ªäº›&#34;&gt;8ã€TCP å’Œ UDP åˆ†åˆ«å¯¹åº”çš„å¸¸è§åº”ç”¨å±‚åè®®æœ‰å“ªäº›ï¼Ÿ&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;ol&gt;
&lt;li&gt;TCP å¯¹åº”çš„åº”ç”¨å±‚åè®®&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;FTPï¼šå®šä¹‰äº†æ–‡ä»¶ä¼ è¾“åè®®ï¼Œä½¿ç”¨ 21 ç«¯å£ã€‚å¸¸è¯´æŸæŸè®¡ç®—æœºå¼€äº† FTP æœåŠ¡ä¾¿æ˜¯å¯åŠ¨äº†æ–‡ä»¶ä¼ è¾“æœåŠ¡ã€‚ä¸‹è½½æ–‡ä»¶ï¼Œä¸Šä¼ ä¸»é¡µï¼Œéƒ½è¦ç”¨åˆ° FTP æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;Telnetï¼šå®ƒæ˜¯ä¸€ç§ç”¨äºè¿œç¨‹ç™»é™†çš„ç«¯å£ï¼Œç”¨æˆ·å¯ä»¥ä»¥è‡ªå·±çš„èº«ä»½è¿œç¨‹è¿æ¥åˆ°è®¡ç®—æœºä¸Šï¼Œé€šè¿‡è¿™ç§ç«¯å£å¯ä»¥æä¾›ä¸€ç§åŸºäº DOS æ¨¡å¼ä¸‹çš„é€šä¿¡æœåŠ¡ã€‚å¦‚ä»¥å‰çš„ BBS æ˜¯-çº¯å­—ç¬¦ç•Œé¢çš„ï¼Œæ”¯æŒ BBS çš„æœåŠ¡å™¨å°† 23 ç«¯å£æ‰“å¼€ï¼Œå¯¹å¤–æä¾›æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;SMTPï¼šå®šä¹‰äº†ç®€å•é‚®ä»¶ä¼ é€åè®®ï¼Œç°åœ¨å¾ˆå¤šé‚®ä»¶æœåŠ¡å™¨éƒ½ç”¨çš„æ˜¯è¿™ä¸ªåè®®ï¼Œç”¨äºå‘é€é‚®ä»¶ã€‚å¦‚å¸¸è§çš„å…è´¹é‚®ä»¶æœåŠ¡ä¸­ç”¨çš„å°±æ˜¯è¿™ä¸ªé‚®ä»¶æœåŠ¡ç«¯å£ï¼Œæ‰€ä»¥åœ¨ç”µå­é‚®ä»¶è®¾ç½®-ä¸­å¸¸çœ‹åˆ°æœ‰è¿™ä¹ˆ SMTP ç«¯å£è®¾ç½®è¿™ä¸ªæ ï¼ŒæœåŠ¡å™¨å¼€æ”¾çš„æ˜¯ 25 å·ç«¯å£ã€‚&lt;/p&gt;
&lt;p&gt;POP3ï¼šå®ƒæ˜¯å’Œ SMTP å¯¹åº”ï¼ŒPOP3 ç”¨äºæ¥æ”¶é‚®ä»¶ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼ŒPOP3 åè®®æ‰€ç”¨çš„æ˜¯ 110 ç«¯å£ã€‚ä¹Ÿæ˜¯è¯´ï¼Œåªè¦ä½ æœ‰ç›¸åº”çš„ä½¿ç”¨ POP3 åè®®çš„ç¨‹åºï¼ˆä¾‹å¦‚ Fo-xmail æˆ– Outlookï¼‰ï¼Œå°±å¯ä»¥ä¸ä»¥ Web æ–¹å¼ç™»é™†è¿›é‚®ç®±ç•Œé¢ï¼Œç›´æ¥ç”¨é‚®ä»¶ç¨‹åºå°±å¯ä»¥æ”¶åˆ°é‚®ä»¶ï¼ˆå¦‚æ˜¯163 é‚®ç®±å°±æ²¡æœ‰å¿…è¦å…ˆè¿›å…¥ç½‘æ˜“ç½‘ç«™ï¼Œå†è¿›å…¥è‡ªå·±çš„é‚®-ç®±æ¥æ”¶ä¿¡ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;HTTPï¼šä» Web æœåŠ¡å™¨ä¼ è¾“è¶…æ–‡æœ¬åˆ°æœ¬åœ°æµè§ˆå™¨çš„ä¼ é€åè®®ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;UDP å¯¹åº”çš„åº”ç”¨å±‚åè®®&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;DNSï¼šç”¨äºåŸŸåè§£ææœåŠ¡ï¼Œå°†åŸŸååœ°å€è½¬æ¢ä¸º IP åœ°å€ã€‚DNS ç”¨çš„æ˜¯ 53 å·ç«¯å£ã€‚&lt;/p&gt;
&lt;p&gt;SNMPï¼šç®€å•ç½‘ç»œç®¡ç†åè®®ï¼Œä½¿ç”¨ 161 å·ç«¯å£ï¼Œæ˜¯ç”¨æ¥ç®¡ç†ç½‘ç»œè®¾å¤‡çš„ã€‚ç”±äºç½‘ç»œè®¾å¤‡å¾ˆå¤šï¼Œæ— è¿æ¥çš„æœåŠ¡å°±ä½“ç°å‡ºå…¶ä¼˜åŠ¿ã€‚&lt;/p&gt;
&lt;p&gt;TFTP(Trival File Transfer Protocal)ï¼šç®€å•æ–‡ä»¶ä¼ è¾“åè®®ï¼Œè¯¥åè®®åœ¨ç†ŸçŸ¥ç«¯å£ 69 ä¸Šä½¿ç”¨ UDP æœåŠ¡ã€‚&lt;/p&gt;
&lt;h1 id=&#34;9-è¯¦ç»†è¯´ä¸‹-tcp-ä¸‰æ¬¡æ¡æ‰‹çš„è¿‡ç¨‹&#34;&gt;9ã€è¯¦ç»†è¯´ä¸‹ TCP ä¸‰æ¬¡æ¡æ‰‹çš„è¿‡ç¨‹ï¼Ÿï¼ˆ*ï¼‰&lt;/h1&gt;
&lt;p&gt;TCP å»ºç«‹è¿æ¥çš„è¿‡ç¨‹å«åšæ¡æ‰‹ï¼Œæ¡æ‰‹éœ€è¦åœ¨å®¢æˆ·å’ŒæœåŠ¡å™¨ä¹‹é—´äº¤æ¢ä¸‰ä¸ª TCP æŠ¥æ–‡æ®µã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;17&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/TCP%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;æœ€åˆå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½å¤„äº CLOSED(å…³é—­) çŠ¶æ€ã€‚æœ¬ä¾‹ä¸­ Aï¼ˆClientï¼‰ ä¸»åŠ¨æ‰“å¼€è¿æ¥ï¼ŒBï¼ˆServerï¼‰ è¢«åŠ¨æ‰“å¼€è¿æ¥ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€å¼€å§‹ï¼ŒB çš„ TCP æœåŠ¡å™¨è¿›ç¨‹é¦–å…ˆåˆ›å»ºä¼ è¾“æ§åˆ¶å—TCBï¼Œå‡†å¤‡æ¥å—å®¢æˆ·ç«¯è¿›ç¨‹çš„è¿æ¥è¯·æ±‚ã€‚ç„¶åæœåŠ¡ç«¯è¿›ç¨‹å°±å¤„äº LISTEN(ç›‘å¬) çŠ¶æ€ï¼Œç­‰å¾…å®¢æˆ·ç«¯çš„è¿æ¥è¯·æ±‚ã€‚å¦‚æœ‰ï¼Œç«‹å³ä½œå‡ºå“åº”ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šA çš„ TCP å®¢æˆ·ç«¯è¿›ç¨‹ä¹Ÿæ˜¯é¦–å…ˆåˆ›å»ºä¼ è¾“æ§åˆ¶å— TCBã€‚ç„¶åï¼Œåœ¨æ‰“ç®—å»ºç«‹ TCP è¿æ¥æ—¶ï¼Œå‘ B å‘å‡ºè¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µï¼Œè¿™æ—¶é¦–éƒ¨ä¸­çš„åŒæ­¥ä½ SYN=1ï¼ŒåŒæ—¶é€‰æ‹©ä¸€ä¸ªåˆå§‹åºå· seq = xã€‚TCP è§„å®šï¼ŒSYN æŠ¥æ–‡æ®µï¼ˆå³ SYN = 1 çš„æŠ¥æ–‡æ®µï¼‰ä¸èƒ½æºå¸¦æ•°æ®ï¼Œä½†è¦æ¶ˆè€—æ‰ä¸€ä¸ªåºå·ã€‚è¿™æ—¶ï¼ŒTCP å®¢æˆ·è¿›ç¨‹è¿›å…¥ SYN-SENTï¼ˆåŒæ­¥å·²å‘é€ï¼‰çŠ¶æ€ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šB æ”¶åˆ°è¿æ¥è¯·æ±‚æŠ¥æ–‡åï¼Œå¦‚æœåŒæ„å»ºç«‹è¿æ¥ï¼Œåˆ™å‘ A å‘é€ç¡®è®¤ã€‚åœ¨ç¡®è®¤æŠ¥æ–‡æ®µä¸­åº”æŠŠ SYN ä½å’Œ ACK ä½éƒ½ç½® 1ï¼Œç¡®è®¤å·æ˜¯ ack = x + 1ï¼ŒåŒæ—¶ä¹Ÿä¸ºè‡ªå·±é€‰æ‹©ä¸€ä¸ªåˆå§‹åºå· seq = yã€‚è¯·æ³¨æ„ï¼Œè¿™ä¸ªæŠ¥æ–‡æ®µä¹Ÿä¸èƒ½æºå¸¦æ•°æ®ï¼Œä½†åŒæ ·è¦æ¶ˆè€—æ‰ä¸€ä¸ªåºå·ã€‚è¿™æ—¶ TCP æœåŠ¡ç«¯è¿›ç¨‹è¿›å…¥ SYN-RCVDï¼ˆåŒæ­¥æ”¶åˆ°ï¼‰çŠ¶æ€ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šTCP å®¢æˆ·è¿›ç¨‹æ”¶åˆ° B çš„ç¡®è®¤åï¼Œè¿˜è¦å‘ B ç»™å‡ºç¡®è®¤ã€‚ç¡®è®¤æŠ¥æ–‡æ®µçš„ ACK ç½® 1ï¼Œç¡®è®¤å· ack = y +Â  1ï¼Œè€Œè‡ªå·±çš„åºå· seq = x + 1ã€‚è¿™æ—¶ ACK æŠ¥æ–‡æ®µå¯ä»¥æºå¸¦æ•°æ®ã€‚ä½†å¦‚æœä¸æºå¸¦æ•°æ®åˆ™ä¸æ¶ˆè€—åºå·ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œä¸‹ä¸€ä¸ªæ•°æ®æŠ¥æ–‡æ®µçš„åºå·ä»æ˜¯ seq = x + 1ã€‚è¿™æ—¶ï¼ŒTCP è¿æ¥å·²ç»å»ºç«‹ï¼ŒA è¿›å…¥ ESTABLISHEDï¼ˆå·²å»ºç«‹è¿æ¥ï¼‰çŠ¶æ€ã€‚&lt;/p&gt;
&lt;h1 id=&#34;10-ä¸ºä»€ä¹ˆä¸¤æ¬¡æ¡æ‰‹ä¸å¯ä»¥å‘¢&#34;&gt;10ã€ä¸ºä»€ä¹ˆä¸¤æ¬¡æ¡æ‰‹ä¸å¯ä»¥å‘¢ï¼Ÿï¼ˆ*ï¼‰&lt;/h1&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;18&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%A4%E6%AC%A1%E6%8F%A1%E6%89%8B%E4%B8%8D%E5%8F%AF%E4%BB%A5.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ä¸ºäº†é˜²æ­¢å·²ç»å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µçªç„¶åˆä¼ é€åˆ°äº† Bï¼Œå› è€Œäº§ç”Ÿé”™è¯¯ã€‚æ¯”å¦‚ä¸‹é¢è¿™ç§æƒ…å†µï¼šA å‘å‡ºçš„ç¬¬ä¸€ä¸ªè¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µå¹¶æ²¡æœ‰ä¸¢å¤±ï¼Œè€Œæ˜¯åœ¨ç½‘è·¯ç»“ç‚¹é•¿æ—¶é—´æ»ç•™äº†ï¼Œä»¥è‡´äºå»¶è¯¯åˆ°è¿æ¥é‡Šæ”¾ä»¥åçš„æŸä¸ªæ—¶é—´æ®µæ‰åˆ°è¾¾ Bã€‚æœ¬æ¥è¿™æ˜¯ä¸€ä¸ªæ—©å·²å¤±æ•ˆçš„æŠ¥æ–‡æ®µã€‚ä½†æ˜¯ B æ”¶åˆ°æ­¤å¤±æ•ˆçš„é“¾æ¥è¯·æ±‚æŠ¥æ–‡æ®µåï¼Œå°±è¯¯è®¤ä¸º A åˆå‘å‡ºä¸€æ¬¡æ–°çš„è¿æ¥è¯·æ±‚ã€‚äºæ˜¯å°±å‘ A å‘å‡ºç¡®è®¤æŠ¥æ–‡æ®µï¼ŒåŒæ„å»ºç«‹è¿æ¥ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºä¸Šé¢è¿™ç§æƒ…å†µï¼Œå¦‚æœä¸è¿›è¡Œç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼ŒB å‘å‡ºç¡®è®¤åå°±è®¤ä¸ºæ–°çš„è¿è¾“è¿æ¥å·²ç»å»ºç«‹äº†ï¼Œå¹¶ä¸€ç›´ç­‰å¾… A å‘æ¥æ•°æ®ã€‚B çš„è®¸å¤šèµ„æºå°±è¿™æ ·ç™½ç™½æµªè´¹äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœé‡‡ç”¨äº†ä¸‰æ¬¡æ¡æ‰‹ï¼Œç”±äº A å®é™…ä¸Šå¹¶æ²¡æœ‰å‘å‡ºå»ºç«‹è¿æ¥è¯·æ±‚ï¼Œæ‰€ä»¥ä¸ä¼šç†ç¬ B çš„ç¡®è®¤ï¼Œä¹Ÿä¸ä¼šå‘ B å‘é€æ•°æ®ã€‚B ç”±äºæ”¶ä¸åˆ°ç¡®è®¤ï¼Œå°±çŸ¥é“ A å¹¶æ²¡æœ‰è¦æ±‚å»ºç«‹è¿æ¥ã€‚&lt;/p&gt;
&lt;h1 id=&#34;11-ä¸ºä»€ä¹ˆä¸éœ€è¦å››æ¬¡æ¡æ‰‹&#34;&gt;11ã€ä¸ºä»€ä¹ˆä¸éœ€è¦å››æ¬¡æ¡æ‰‹ï¼Ÿï¼ˆ*ï¼‰&lt;/h1&gt;
&lt;p&gt;æœ‰äººå¯èƒ½ä¼šè¯´ A å‘å‡ºç¬¬ä¸‰æ¬¡æ¡æ‰‹çš„ä¿¡æ¯ååœ¨æ²¡æœ‰æ¥æ”¶åˆ° B çš„è¯·æ±‚å°±å·²ç»è¿›å…¥äº†è¿æ¥çŠ¶æ€ï¼Œé‚£å¦‚æœ A çš„è¿™ä¸ªç¡®è®¤åŒ…ä¸¢å¤±æˆ–è€…æ»ç•™äº†æ€ä¹ˆåŠï¼Ÿ&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬éœ€è¦æ˜ç™½ä¸€ç‚¹ï¼Œå®Œå…¨å¯é çš„é€šä¿¡åè®®æ˜¯ä¸å­˜åœ¨çš„ã€‚åœ¨ç»è¿‡ä¸‰æ¬¡æ¡æ‰‹ä¹‹åï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å·²ç»å¯ä»¥ç¡®è®¤ä¹‹å‰çš„é€šä¿¡çŠ¶å†µï¼Œéƒ½æ”¶åˆ°äº†ç¡®è®¤ä¿¡æ¯ã€‚æ‰€ä»¥å³ä¾¿å†å¢åŠ æ¡æ‰‹æ¬¡æ•°ä¹Ÿä¸èƒ½ä¿è¯åé¢çš„é€šä¿¡å®Œå…¨å¯é ï¼Œæ‰€ä»¥æ˜¯æ²¡æœ‰å¿…è¦çš„ã€‚&lt;/p&gt;
&lt;h1 id=&#34;12-server-ç«¯æ”¶åˆ°-client-ç«¯çš„-syn-åä¸ºä»€ä¹ˆè¿˜è¦ä¼ å›-syn&#34;&gt;12ã€Server ç«¯æ”¶åˆ° Client ç«¯çš„ SYN åï¼Œä¸ºä»€ä¹ˆè¿˜è¦ä¼ å› SYNï¼Ÿ&lt;/h1&gt;
&lt;p&gt;æ¥æ”¶ç«¯ä¼ å›å‘é€ç«¯æ‰€å‘é€çš„ SYN æ˜¯ä¸ºäº†å‘Šè¯‰å‘é€ç«¯ï¼Œæˆ‘æ¥æ”¶åˆ°çš„ä¿¡æ¯ç¡®å®å°±æ˜¯ä½ æ‰€å‘é€çš„ä¿¡å·äº†ã€‚&lt;/p&gt;
&lt;p&gt;SYN æ˜¯ TCP / IP å»ºç«‹è¿æ¥æ—¶ä½¿ç”¨çš„æ¡æ‰‹ä¿¡å·ã€‚åœ¨å®¢æˆ·æœºå’ŒæœåŠ¡å™¨ä¹‹é—´å»ºç«‹æ­£å¸¸çš„ TCP ç½‘ç»œè¿æ¥æ—¶ï¼Œå®¢æˆ·æœºé¦–å…ˆå‘å‡ºä¸€ä¸ª SYN æ¶ˆæ¯ï¼ŒæœåŠ¡å™¨ä½¿ç”¨ SYN-ACK åº”ç­”è¡¨ç¤ºæ¥æ”¶åˆ°äº†è¿™ä¸ªæ¶ˆæ¯ï¼Œæœ€åå®¢æˆ·æœºå†ä»¥ ACK(Acknowledgement[æ±‰è¯‘ï¼šç¡®è®¤å­—ç¬¦ï¼Œåœ¨æ•°æ®é€šä¿¡ä¼ è¾“ä¸­ï¼Œæ¥æ”¶ç«™å‘ç»™å‘é€ç«™çš„ä¸€ç§ä¼ è¾“æ§åˆ¶å­—ç¬¦ã€‚å®ƒè¡¨ç¤ºç¡®è®¤å‘æ¥çš„æ•°æ®å·²ç»æ¥å—æ— è¯¯]ï¼‰æ¶ˆæ¯å“åº”ã€‚è¿™æ ·åœ¨å®¢æˆ·æœºå’ŒæœåŠ¡å™¨ä¹‹é—´æ‰èƒ½å»ºç«‹èµ·å¯é çš„ TCP è¿æ¥ï¼Œæ•°æ®æ‰å¯ä»¥åœ¨å®¢æˆ·æœºå’ŒæœåŠ¡å™¨ä¹‹é—´ä¼ é€’ã€‚&lt;/p&gt;
&lt;h1 id=&#34;13-ä¼ äº†-synä¸ºä»€ä¹ˆè¿˜è¦ä¼ -ack&#34;&gt;13ã€ä¼ äº† SYNï¼Œä¸ºä»€ä¹ˆè¿˜è¦ä¼  ACKï¼Ÿ&lt;/h1&gt;
&lt;p&gt;åŒæ–¹é€šä¿¡æ— è¯¯å¿…é¡»æ˜¯ä¸¤è€…äº’ç›¸å‘é€ä¿¡æ¯éƒ½æ— è¯¯ã€‚ä¼ äº† SYNï¼Œè¯æ˜å‘é€æ–¹åˆ°æ¥æ”¶æ–¹çš„é€šé“æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯æ¥æ”¶æ–¹åˆ°å‘é€æ–¹çš„é€šé“è¿˜éœ€è¦ ACK ä¿¡å·æ¥è¿›è¡ŒéªŒè¯ã€‚&lt;/p&gt;
&lt;h1 id=&#34;14-è¯¦ç»†è¯´ä¸‹-tcp-å››æ¬¡æŒ¥æ‰‹çš„è¿‡ç¨‹&#34;&gt;14ã€è¯¦ç»†è¯´ä¸‹ TCP å››æ¬¡æŒ¥æ‰‹çš„è¿‡ç¨‹ï¼Ÿï¼ˆ*ï¼‰&lt;/h1&gt;
&lt;p&gt;æ®ä¼ è¾“ç»“æŸåï¼Œé€šä¿¡çš„åŒæ–¹éƒ½å¯ä»¥é‡Šæ”¾è¿æ¥ã€‚ç°åœ¨ A å’Œ B éƒ½å¤„äº ESTABLISHED çŠ¶æ€ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;19&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/TCP%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ï¼šA çš„åº”ç”¨è¿›ç¨‹å…ˆå‘å…¶ TCP å‘å‡ºè¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µï¼Œå¹¶åœæ­¢å†å‘é€æ•°æ®ï¼Œä¸»åŠ¨å…³é—­ TCP è¿æ¥ã€‚A æŠŠè¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µé¦–éƒ¨çš„ç»ˆæ­¢æ§åˆ¶ä½ FIN ç½® 1ï¼Œå…¶åºå· seq = uï¼ˆç­‰äºå‰é¢å·²ä¼ é€è¿‡çš„æ•°æ®çš„æœ€åä¸€ä¸ªå­—èŠ‚çš„åºå·åŠ  1ï¼‰ï¼Œè¿™æ—¶ A è¿›å…¥ FIN-WAIT-1ï¼ˆç»ˆæ­¢ç­‰å¾…1ï¼‰çŠ¶æ€ï¼Œç­‰å¾… B çš„ç¡®è®¤ã€‚è¯·æ³¨æ„ï¼šTCP è§„å®šï¼ŒFIN æŠ¥æ–‡æ®µå³ä½¿ä¸æºå¸¦æ•°æ®ï¼Œä¹Ÿå°†æ¶ˆè€—æ‰ä¸€ä¸ªåºå·ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬äºŒæ¬¡æŒ¥æ‰‹ï¼šB æ”¶åˆ°è¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µåç«‹å³å‘å‡ºç¡®è®¤ï¼Œç¡®è®¤å·æ˜¯ ack = u + 1ï¼Œè€Œè¿™ä¸ªæŠ¥æ–‡æ®µè‡ªå·±çš„åºå·æ˜¯ vï¼ˆç­‰äº B å‰é¢å·²ç»ä¼ é€è¿‡çš„æ•°æ®çš„æœ€åä¸€ä¸ªå­—èŠ‚çš„åºå·åŠ 1ï¼‰ï¼Œç„¶å B å°±è¿›å…¥ CLOSE-WAITï¼ˆå…³é—­ç­‰å¾…ï¼‰çŠ¶æ€ã€‚TCP æœåŠ¡ç«¯è¿›ç¨‹è¿™æ—¶åº”é€šçŸ¥é«˜å±‚åº”ç”¨è¿›ç¨‹ï¼Œå› è€Œä» A åˆ° B è¿™ä¸ªæ–¹å‘çš„è¿æ¥å°±é‡Šæ”¾äº†ï¼Œè¿™æ—¶çš„ TCP è¿æ¥å¤„äºåŠå…³é—­ï¼ˆhalf-closeï¼‰çŠ¶æ€ï¼Œå³ A å·²ç»æ²¡æœ‰æ•°æ®è¦å‘é€äº†ï¼Œä½† B è‹¥å‘é€æ•°æ®ï¼ŒA ä»è¦æ¥æ”¶ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä» B åˆ° A è¿™ä¸ªæ–¹å‘çš„è¿æ¥å¹¶æœªå…³é—­ï¼Œè¿™ä¸ªçŠ¶æ€å¯èƒ½ä¼šæŒç»­ä¸€æ®µæ—¶é—´ã€‚A æ”¶åˆ°æ¥è‡ª B çš„ç¡®è®¤åï¼Œå°±è¿›å…¥ FIN-WAIT-2(ç»ˆæ­¢ç­‰å¾…2)çŠ¶æ€ï¼Œç­‰å¾… B å‘å‡ºçš„è¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹ï¼šè‹¥ B å·²ç»æ²¡æœ‰è¦å‘ A å‘é€çš„æ•°æ®ï¼Œå…¶åº”ç”¨è¿›ç¨‹å°±é€šçŸ¥ TCP é‡Šæ”¾è¿æ¥ã€‚è¿™æ—¶ B å‘å‡ºçš„è¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µå¿…é¡»ä½¿ FIN = 1ã€‚å‡å®š B çš„åºå·ä¸º wï¼ˆåœ¨åŠå…³é—­çŠ¶æ€ï¼ŒB å¯èƒ½åˆå‘é€äº†ä¸€äº›æ•°æ®ï¼‰ã€‚B è¿˜å¿…é¡»é‡å¤ä¸Šæ¬¡å·²å‘é€è¿‡çš„ç¡®è®¤å· ack = u + 1ã€‚è¿™æ—¶ B å°±è¿›å…¥ LAST-ACK(æœ€åç¡®è®¤)çŠ¶æ€ï¼Œç­‰å¾… A çš„ç¡®è®¤ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬å››æ¬¡æŒ¥æ‰‹ï¼šA åœ¨æ”¶åˆ° B çš„è¿æ¥é‡Šæ”¾æŠ¥æ–‡åï¼Œå¿…é¡»å¯¹æ­¤å‘å‡ºç¡®è®¤ã€‚åœ¨ç¡®è®¤æŠ¥æ–‡æ®µä¸­æŠŠ ACK ç½® 1ï¼Œç¡®è®¤å· ack = w + 1ï¼Œè€Œè‡ªå·±çš„åºå· seq = u + 1ï¼ˆå‰é¢å‘é€çš„ FIN æŠ¥æ–‡æ®µè¦æ¶ˆè€—ä¸€ä¸ªåºå·ï¼‰ã€‚ç„¶åè¿›å…¥ TIME-WAIT(æ—¶é—´ç­‰å¾…) çŠ¶æ€ã€‚è¯·æ³¨æ„ï¼Œç°åœ¨ TCP è¿æ¥è¿˜æ²¡æœ‰é‡Šæ”¾æ‰ã€‚å¿…é¡»ç»è¿‡æ—¶é—´ç­‰å¾…è®¡æ—¶å™¨è®¾ç½®çš„æ—¶é—´ 2MSLï¼ˆMSLï¼šæœ€é•¿æŠ¥æ–‡æ®µå¯¿å‘½ï¼‰åï¼ŒA æ‰èƒ½è¿›å…¥åˆ° CLOSED çŠ¶æ€ï¼Œç„¶åæ’¤é”€ä¼ è¾“æ§åˆ¶å—ï¼Œç»“æŸè¿™æ¬¡ TCP è¿æ¥ã€‚å½“ç„¶å¦‚æœ B ä¸€æ”¶åˆ° A çš„ç¡®è®¤å°±è¿›å…¥ CLOSED çŠ¶æ€ï¼Œç„¶åæ’¤é”€ä¼ è¾“æ§åˆ¶å—ã€‚æ‰€ä»¥åœ¨é‡Šæ”¾è¿æ¥æ—¶ï¼ŒB ç»“æŸ TCP è¿æ¥çš„æ—¶é—´è¦æ—©äº Aã€‚&lt;/p&gt;
&lt;h1 id=&#34;15-ä¸ºä»€ä¹ˆ-time-wait-çŠ¶æ€å¿…é¡»ç­‰å¾…-2msl-çš„æ—¶é—´å‘¢&#34;&gt;15ã€ä¸ºä»€ä¹ˆ TIME-WAIT çŠ¶æ€å¿…é¡»ç­‰å¾… 2MSL çš„æ—¶é—´å‘¢ï¼Ÿï¼ˆ*ï¼‰&lt;/h1&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;20&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/TIME-WAIT%E7%AD%89%E5%BE%852MSL.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;ä¸ºäº†ä¿è¯ A å‘é€çš„æœ€åä¸€ä¸ª ACK æŠ¥æ–‡æ®µèƒ½å¤Ÿåˆ°è¾¾ Bã€‚è¿™ä¸ª ACK æŠ¥æ–‡æ®µæœ‰å¯èƒ½ä¸¢å¤±ï¼Œå› è€Œä½¿å¤„åœ¨ LAST-ACK çŠ¶æ€çš„ B æ”¶ä¸åˆ°å¯¹å·²å‘é€çš„ FIN + ACK æŠ¥æ–‡æ®µçš„ç¡®è®¤ã€‚B ä¼šè¶…æ—¶é‡ä¼ è¿™ä¸ª FIN+ACK æŠ¥æ–‡æ®µï¼Œè€Œ A å°±èƒ½åœ¨ 2MSL æ—¶é—´å†…ï¼ˆè¶…æ—¶ + 1MSL ä¼ è¾“ï¼‰æ”¶åˆ°è¿™ä¸ªé‡ä¼ çš„ FIN+ACK æŠ¥æ–‡æ®µã€‚æ¥ç€ A é‡ä¼ ä¸€æ¬¡ç¡®è®¤ï¼Œé‡æ–°å¯åŠ¨ 2MSL è®¡æ—¶å™¨ã€‚æœ€åï¼ŒA å’Œ B éƒ½æ­£å¸¸è¿›å…¥åˆ° CLOSED çŠ¶æ€ã€‚å¦‚æœ A åœ¨ TIME-WAIT çŠ¶æ€ä¸ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œè€Œæ˜¯åœ¨å‘é€å®Œ ACK æŠ¥æ–‡æ®µåç«‹å³é‡Šæ”¾è¿æ¥ï¼Œé‚£ä¹ˆå°±æ— æ³•æ”¶åˆ° B é‡ä¼ çš„ FIN + ACK æŠ¥æ–‡æ®µï¼Œå› è€Œä¹Ÿä¸ä¼šå†å‘é€ä¸€æ¬¡ç¡®è®¤æŠ¥æ–‡æ®µï¼Œè¿™æ ·ï¼ŒB å°±æ— æ³•æŒ‰ç…§æ­£å¸¸æ­¥éª¤è¿›å…¥ CLOSED çŠ¶æ€ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é˜²æ­¢å·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µå‡ºç°åœ¨æœ¬è¿æ¥ä¸­ã€‚A åœ¨å‘é€å®Œæœ€åä¸€ä¸ª ACK æŠ¥æ–‡æ®µåï¼Œå†ç»è¿‡æ—¶é—´ 2MSLï¼Œå°±å¯ä»¥ä½¿æœ¬è¿æ¥æŒç»­çš„æ—¶é—´å†…æ‰€äº§ç”Ÿçš„æ‰€æœ‰æŠ¥æ–‡æ®µéƒ½ä»ç½‘ç»œä¸­æ¶ˆå¤±ã€‚è¿™æ ·å°±å¯ä»¥ä½¿ä¸‹ä¸€ä¸ªè¿æ¥ä¸­ä¸ä¼šå‡ºç°è¿™ç§æ—§çš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;16-ä¸ºä»€ä¹ˆç¬¬äºŒæ¬¡è·Ÿç¬¬ä¸‰æ¬¡ä¸èƒ½åˆå¹¶-ç¬¬äºŒæ¬¡å’Œç¬¬ä¸‰æ¬¡ä¹‹é—´çš„ç­‰å¾…æ˜¯ä»€ä¹ˆ&#34;&gt;16ã€ä¸ºä»€ä¹ˆç¬¬äºŒæ¬¡è·Ÿç¬¬ä¸‰æ¬¡ä¸èƒ½åˆå¹¶, ç¬¬äºŒæ¬¡å’Œç¬¬ä¸‰æ¬¡ä¹‹é—´çš„ç­‰å¾…æ˜¯ä»€ä¹ˆ?&lt;/h1&gt;
&lt;p&gt;å½“æœåŠ¡å™¨æ‰§è¡Œç¬¬äºŒæ¬¡æŒ¥æ‰‹ä¹‹å, æ­¤æ—¶è¯æ˜å®¢æˆ·ç«¯ä¸ä¼šå†å‘æœåŠ¡ç«¯è¯·æ±‚ä»»ä½•æ•°æ®, ä½†æ˜¯æœåŠ¡ç«¯å¯èƒ½è¿˜æ­£åœ¨ç»™å®¢æˆ·ç«¯å‘é€æ•°æ®ï¼ˆå¯èƒ½æ˜¯å®¢æˆ·ç«¯ä¸Šä¸€æ¬¡è¯·æ±‚çš„èµ„æºè¿˜æ²¡æœ‰å‘é€å®Œæ¯•ï¼‰ï¼Œæ‰€ä»¥æ­¤æ—¶æœåŠ¡ç«¯ä¼šç­‰å¾…æŠŠä¹‹å‰æœªä¼ è¾“å®Œçš„æ•°æ®ä¼ è¾“å®Œæ¯•ä¹‹åå†å‘é€å…³é—­è¯·æ±‚ã€‚&lt;/p&gt;
&lt;h1 id=&#34;17-ä¿æ´»è®¡æ—¶å™¨çš„ä½œç”¨&#34;&gt;17ã€ä¿æ´»è®¡æ—¶å™¨çš„ä½œç”¨ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;é™¤æ—¶é—´ç­‰å¾…è®¡æ—¶å™¨å¤–ï¼ŒTCP è¿˜æœ‰ä¸€ä¸ªä¿æ´»è®¡æ—¶å™¨ï¼ˆkeepalive Â timerï¼‰ã€‚è®¾æƒ³è¿™æ ·çš„åœºæ™¯ï¼šå®¢æˆ·å·²ä¸»åŠ¨ä¸æœåŠ¡å™¨å»ºç«‹äº† TCP è¿æ¥ã€‚ä½†åæ¥å®¢æˆ·ç«¯çš„ä¸»æœºçªç„¶å‘ç”Ÿæ•…éšœã€‚æ˜¾ç„¶ï¼ŒæœåŠ¡å™¨ä»¥åå°±ä¸èƒ½å†æ”¶åˆ°å®¢æˆ·ç«¯å‘æ¥çš„æ•°æ®ã€‚å› æ­¤ï¼Œåº”å½“æœ‰æªæ–½ä½¿æœåŠ¡å™¨ä¸è¦å†ç™½ç™½ç­‰å¾…ä¸‹å»ã€‚è¿™å°±éœ€è¦ä½¿ç”¨ä¿æ´»è®¡æ—¶å™¨äº†ã€‚&lt;/p&gt;
&lt;p&gt;æœåŠ¡å™¨æ¯æ”¶åˆ°ä¸€æ¬¡å®¢æˆ·çš„æ•°æ®ï¼Œå°±é‡æ–°è®¾ç½®ä¿æ´»è®¡æ—¶å™¨ï¼Œæ—¶é—´çš„è®¾ç½®é€šå¸¸æ˜¯ä¸¤ä¸ªå°æ—¶ã€‚è‹¥ä¸¤ä¸ªå°æ—¶éƒ½æ²¡æœ‰æ”¶åˆ°å®¢æˆ·ç«¯çš„æ•°æ®ï¼ŒæœåŠ¡ç«¯å°±å‘é€ä¸€ä¸ªæ¢æµ‹æŠ¥æ–‡æ®µï¼Œä»¥ååˆ™æ¯éš”Â  75 ç§’é’Ÿå‘é€ä¸€æ¬¡ã€‚è‹¥è¿ç»­å‘é€ 10ä¸ª æ¢æµ‹æŠ¥æ–‡æ®µåä»ç„¶æ— å®¢æˆ·ç«¯çš„å“åº”ï¼ŒæœåŠ¡ç«¯å°±è®¤ä¸ºå®¢æˆ·ç«¯å‡ºäº†æ•…éšœï¼Œæ¥ç€å°±å…³é—­è¿™ä¸ªè¿æ¥ã€‚&lt;/p&gt;
&lt;h1 id=&#34;18-tcp-åè®®æ˜¯å¦‚ä½•ä¿è¯å¯é ä¼ è¾“çš„&#34;&gt;18ã€TCP åè®®æ˜¯å¦‚ä½•ä¿è¯å¯é ä¼ è¾“çš„ï¼Ÿï¼ˆ*ï¼‰&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ•°æ®åŒ…æ ¡éªŒ&lt;/strong&gt;ï¼šç›®çš„æ˜¯æ£€æµ‹æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­çš„ä»»ä½•å˜åŒ–ï¼Œè‹¥æ ¡éªŒå‡ºåŒ…æœ‰é”™ï¼Œåˆ™ä¸¢å¼ƒæŠ¥æ–‡æ®µå¹¶ä¸”ä¸ç»™å‡ºå“åº”ï¼Œè¿™æ—¶ TCP å‘é€æ•°æ®ç«¯è¶…æ—¶åä¼šé‡å‘æ•°æ®ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¯¹å¤±åºæ•°æ®åŒ…é‡æ’åº&lt;/strong&gt;ï¼šæ—¢ç„¶ TCP æŠ¥æ–‡æ®µä½œä¸º IP æ•°æ®æŠ¥æ¥ä¼ è¾“ï¼Œè€Œ IP æ•°æ®æŠ¥çš„åˆ°è¾¾å¯èƒ½ä¼šå¤±åºï¼Œå› æ­¤ TCP æŠ¥æ–‡æ®µçš„åˆ°è¾¾ä¹Ÿå¯èƒ½ä¼šå¤±åºã€‚TCP å°†å¯¹å¤±åºæ•°æ®è¿›è¡Œé‡æ–°æ’åºï¼Œç„¶åæ‰äº¤ç»™åº”ç”¨å±‚ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä¸¢å¼ƒé‡å¤æ•°æ®&lt;/strong&gt;ï¼šå¯¹äºé‡å¤æ•°æ®ï¼Œèƒ½å¤Ÿä¸¢å¼ƒé‡å¤æ•°æ®ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;åº”ç­”æœºåˆ¶&lt;/strong&gt;ï¼šå½“ TCP æ”¶åˆ°å‘è‡ª TCP è¿æ¥å¦ä¸€ç«¯çš„æ•°æ®ï¼Œå®ƒå°†å‘é€ä¸€ä¸ªç¡®è®¤ã€‚è¿™ä¸ªç¡®è®¤ä¸æ˜¯ç«‹å³å‘é€ï¼Œé€šå¸¸å°†æ¨è¿Ÿå‡ åˆ†ä¹‹ä¸€ç§’ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;è¶…æ—¶é‡å‘&lt;/strong&gt;ï¼šå½“ TCP å‘å‡ºä¸€ä¸ªæ®µåï¼Œå®ƒå¯åŠ¨ä¸€ä¸ªå®šæ—¶å™¨ï¼Œç­‰å¾…ç›®çš„ç«¯ç¡®è®¤æ”¶åˆ°è¿™ä¸ªæŠ¥æ–‡æ®µã€‚å¦‚æœä¸èƒ½åŠæ—¶æ”¶åˆ°ä¸€ä¸ªç¡®è®¤ï¼Œå°†é‡å‘è¿™ä¸ªæŠ¥æ–‡æ®µï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æµé‡æ§åˆ¶&lt;/strong&gt;ï¼šTCP è¿æ¥çš„æ¯ä¸€æ–¹éƒ½æœ‰å›ºå®šå¤§å°çš„ç¼“å†²ç©ºé—´ã€‚TCP çš„æ¥æ”¶ç«¯åªå…è®¸å¦ä¸€ç«¯å‘é€æ¥æ”¶ç«¯ç¼“å†²åŒºæ‰€èƒ½æ¥çº³çš„æ•°æ®ï¼Œè¿™å¯ä»¥é˜²æ­¢è¾ƒå¿«ä¸»æœºè‡´ä½¿è¾ƒæ…¢ä¸»æœºçš„ç¼“å†²åŒºæº¢å‡ºï¼Œè¿™å°±æ˜¯æµé‡æ§åˆ¶ã€‚TCP ä½¿ç”¨çš„æµé‡æ§åˆ¶åè®®æ˜¯å¯å˜å¤§å°çš„æ»‘åŠ¨çª—å£åè®®ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;19-è°ˆè°ˆä½ å¯¹åœæ­¢ç­‰å¾…åè®®çš„ç†è§£&#34;&gt;19ã€è°ˆè°ˆä½ å¯¹åœæ­¢ç­‰å¾…åè®®çš„ç†è§£ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%81%9C%E6%AD%A2%E7%AD%89%E5%BE%85%E5%8D%8F%E8%AE%AE.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%81%9C%E6%AD%A2%E7%AD%89%E5%BE%85%E5%8D%8F%E8%AE%AE_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;åœæ­¢ç­‰å¾…åè®®æ˜¯ä¸ºäº†å®ç°å¯é ä¼ è¾“çš„ï¼Œå®ƒçš„åŸºæœ¬åŸç†å°±æ˜¯æ¯å‘å®Œä¸€ä¸ªåˆ†ç»„å°±åœæ­¢å‘é€ï¼Œç­‰å¾…å¯¹æ–¹ç¡®è®¤ã€‚åœ¨æ”¶åˆ°ç¡®è®¤åå†å‘ä¸‹ä¸€ä¸ªåˆ†ç»„ï¼›åœ¨åœæ­¢ç­‰å¾…åè®®ä¸­ï¼Œè‹¥æ¥æ”¶æ–¹æ”¶åˆ°é‡å¤åˆ†ç»„ï¼Œå°±ä¸¢å¼ƒè¯¥åˆ†ç»„ï¼Œä½†åŒæ—¶è¿˜è¦å‘é€ç¡®è®¤ã€‚ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ç§æƒ…å†µï¼šæ— å·®é”™æƒ…å†µã€å‡ºç°å·®é”™æƒ…å†µï¼ˆè¶…æ—¶é‡ä¼ ï¼‰ã€ç¡®è®¤ä¸¢å¤±å’Œç¡®è®¤è¿Ÿåˆ°ã€ç¡®è®¤ä¸¢å¤±å’Œç¡®è®¤è¿Ÿåˆ°ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;21&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%81%9C%E6%AD%A2%E7%AD%89%E5%BE%85%E5%8D%8F%E8%AE%AE_3.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h1 id=&#34;20-è°ˆè°ˆä½ å¯¹-arq-åè®®çš„ç†è§£&#34;&gt;20ã€è°ˆè°ˆä½ å¯¹ ARQ åè®®çš„ç†è§£ï¼Ÿ&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;è‡ªåŠ¨é‡ä¼ è¯·æ±‚ ARQ åè®®&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åœæ­¢ç­‰å¾…åè®®ä¸­è¶…æ—¶é‡ä¼ æ˜¯æŒ‡åªè¦è¶…è¿‡ä¸€æ®µæ—¶é—´ä»ç„¶æ²¡æœ‰æ”¶åˆ°ç¡®è®¤ï¼Œå°±é‡ä¼ å‰é¢å‘é€è¿‡çš„åˆ†ç»„ï¼ˆè®¤ä¸ºåˆšæ‰å‘é€è¿‡çš„åˆ†ç»„ä¸¢å¤±äº†ï¼‰ã€‚å› æ­¤æ¯å‘é€å®Œä¸€ä¸ªåˆ†ç»„éœ€è¦è®¾ç½®ä¸€ä¸ªè¶…æ—¶è®¡æ—¶å™¨ï¼Œå…¶é‡ä¼ æ—¶é—´åº”æ¯”æ•°æ®åœ¨åˆ†ç»„ä¼ è¾“çš„å¹³å‡å¾€è¿”æ—¶é—´æ›´é•¿ä¸€äº›ã€‚è¿™ç§è‡ªåŠ¨é‡ä¼ æ–¹å¼å¸¸ç§°ä¸ºè‡ªåŠ¨é‡ä¼ è¯·æ±‚ ARQã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¿ç»­ ARQ åè®®&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿ç»­ ARQ åè®®å¯æé«˜ä¿¡é“åˆ©ç”¨ç‡ã€‚å‘é€æ–¹ç»´æŒä¸€ä¸ªå‘é€çª—å£ï¼Œå‡¡ä½äºå‘é€çª—å£å†…çš„åˆ†ç»„å¯ä»¥è¿ç»­å‘é€å‡ºå»ï¼Œè€Œä¸éœ€è¦ç­‰å¾…å¯¹æ–¹ç¡®è®¤ã€‚æ¥æ”¶æ–¹ä¸€èˆ¬é‡‡ç”¨ç´¯è®¡ç¡®è®¤ï¼Œå¯¹æŒ‰åºåˆ°è¾¾çš„æœ€åä¸€ä¸ªåˆ†ç»„å‘é€ç¡®è®¤ï¼Œè¡¨æ˜åˆ°è¿™ä¸ªåˆ†ç»„ä¸ºæ­¢çš„æ‰€æœ‰åˆ†ç»„éƒ½å·²ç»æ­£ç¡®æ”¶åˆ°äº†ã€‚&lt;/p&gt;
&lt;h1 id=&#34;21-è°ˆè°ˆä½ å¯¹æ»‘åŠ¨çª—å£çš„äº†è§£&#34;&gt;21ã€è°ˆè°ˆä½ å¯¹æ»‘åŠ¨çª—å£çš„äº†è§£ï¼Ÿï¼ˆ*ï¼‰&lt;/h1&gt;
&lt;p&gt;TCP åˆ©ç”¨æ»‘åŠ¨çª—å£å®ç°æµé‡æ§åˆ¶çš„æœºåˆ¶ã€‚æ»‘åŠ¨çª—å£ï¼ˆSliding windowï¼‰æ˜¯ä¸€ç§æµé‡æ§åˆ¶æŠ€æœ¯ã€‚æ—©æœŸçš„ç½‘ç»œé€šä¿¡ä¸­ï¼Œé€šä¿¡åŒæ–¹ä¸ä¼šè€ƒè™‘ç½‘ç»œçš„æ‹¥æŒ¤æƒ…å†µç›´æ¥å‘é€æ•°æ®ã€‚ç”±äºå¤§å®¶ä¸çŸ¥é“ç½‘ç»œæ‹¥å¡çŠ¶å†µï¼ŒåŒæ—¶å‘é€æ•°æ®ï¼Œå¯¼è‡´ä¸­é—´èŠ‚ç‚¹é˜»å¡æ‰åŒ…ï¼Œè°ä¹Ÿå‘ä¸äº†æ•°æ®ï¼Œæ‰€ä»¥å°±æœ‰äº†æ»‘åŠ¨çª—å£æœºåˆ¶æ¥è§£å†³æ­¤é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;TCP ä¸­é‡‡ç”¨æ»‘åŠ¨çª—å£æ¥è¿›è¡Œä¼ è¾“æ§åˆ¶ï¼Œæ»‘åŠ¨çª—å£çš„å¤§å°æ„å‘³ç€æ¥æ”¶æ–¹è¿˜æœ‰å¤šå¤§çš„ç¼“å†²åŒºå¯ä»¥ç”¨äºæ¥æ”¶æ•°æ®ã€‚å‘é€æ–¹å¯ä»¥é€šè¿‡æ»‘åŠ¨çª—å£çš„å¤§å°æ¥ç¡®å®šåº”è¯¥å‘é€å¤šå°‘å­—èŠ‚çš„æ•°æ®ã€‚å½“æ»‘åŠ¨çª—å£ä¸º 0 æ—¶ï¼Œå‘é€æ–¹ä¸€èˆ¬ä¸èƒ½å†å‘é€æ•°æ®æŠ¥ï¼Œä½†æœ‰ä¸¤ç§æƒ…å†µé™¤å¤–ï¼Œä¸€ç§æƒ…å†µæ˜¯å¯ä»¥å‘é€ç´§æ€¥æ•°æ®ï¼Œä¾‹å¦‚ï¼Œå…è®¸ç”¨æˆ·ç»ˆæ­¢åœ¨è¿œç«¯æœºä¸Šçš„è¿è¡Œè¿›ç¨‹ã€‚å¦ä¸€ç§æƒ…å†µæ˜¯å‘é€æ–¹å¯ä»¥å‘é€ä¸€ä¸ª 1 å­—èŠ‚çš„æ•°æ®æŠ¥æ¥é€šçŸ¥æ¥æ”¶æ–¹é‡æ–°å£°æ˜å®ƒå¸Œæœ›æ¥æ”¶çš„ä¸‹ä¸€å­—èŠ‚åŠå‘é€æ–¹çš„æ»‘åŠ¨çª—å£å¤§å°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3_1.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3_3.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;22-è°ˆä¸‹ä½ å¯¹æµé‡æ§åˆ¶çš„ç†è§£&#34;&gt;22ã€è°ˆä¸‹ä½ å¯¹æµé‡æ§åˆ¶çš„ç†è§£ï¼Ÿï¼ˆ*ï¼‰&lt;/h1&gt;
&lt;p&gt;TCP åˆ©ç”¨æ»‘åŠ¨çª—å£å®ç°æµé‡æ§åˆ¶ã€‚æµé‡æ§åˆ¶æ˜¯ä¸ºäº†æ§åˆ¶å‘é€æ–¹å‘é€é€Ÿç‡ï¼Œä¿è¯æ¥æ”¶æ–¹æ¥å¾—åŠæ¥æ”¶ã€‚æ¥æ”¶æ–¹å‘é€çš„ç¡®è®¤æŠ¥æ–‡ä¸­çš„çª—å£å­—æ®µå¯ä»¥ç”¨æ¥æ§åˆ¶å‘é€æ–¹çª—å£å¤§å°ï¼Œä»è€Œå½±å“å‘é€æ–¹çš„å‘é€é€Ÿç‡ã€‚å°†çª—å£å­—æ®µè®¾ç½®ä¸º 0ï¼Œåˆ™å‘é€æ–¹ä¸èƒ½å‘é€æ•°æ®ã€‚&lt;/p&gt;
&lt;h1 id=&#34;23-è°ˆä¸‹ä½ å¯¹-tcp-æ‹¥å¡æ§åˆ¶çš„ç†è§£ä½¿ç”¨äº†å“ªäº›ç®—æ³•&#34;&gt;23ã€è°ˆä¸‹ä½ å¯¹ TCP æ‹¥å¡æ§åˆ¶çš„ç†è§£ï¼Ÿä½¿ç”¨äº†å“ªäº›ç®—æ³•ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/TCP%E6%8B%A5%E5%A1%9E%E6%8E%A7%E5%88%B6.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/TCP%E6%8B%A5%E5%A1%9E%E6%8E%A7%E5%88%B6_1.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/TCP%E6%8B%A5%E5%A1%9E%E6%8E%A7%E5%88%B6_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;æ‹¥å¡æ§åˆ¶å’Œæµé‡æ§åˆ¶ä¸åŒï¼Œå‰è€…æ˜¯ä¸€ä¸ªå…¨å±€æ€§çš„è¿‡ç¨‹ï¼Œè€Œåè€…æŒ‡ç‚¹å¯¹ç‚¹é€šä¿¡é‡çš„æ§åˆ¶ã€‚åœ¨æŸæ®µæ—¶é—´ï¼Œè‹¥&lt;strong&gt;å¯¹ç½‘ç»œä¸­æŸä¸€èµ„æºçš„éœ€æ±‚è¶…è¿‡äº†è¯¥èµ„æºæ‰€èƒ½æä¾›çš„å¯ç”¨éƒ¨åˆ†&lt;/strong&gt;ï¼Œç½‘ç»œçš„æ€§èƒ½å°±è¦å˜åã€‚è¿™ç§æƒ…å†µå°±å«&lt;strong&gt;æ‹¥å¡&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ‹¥å¡æ§åˆ¶å°±æ˜¯ä¸ºäº†é˜²æ­¢è¿‡å¤šçš„æ•°æ®æ³¨å…¥åˆ°ç½‘ç»œä¸­ï¼Œè¿™æ ·å°±å¯ä»¥ä½¿ç½‘ç»œä¸­çš„è·¯ç”±å™¨æˆ–é“¾è·¯ä¸è‡´äºè¿‡è½½ã€‚æ‹¥å¡æ§åˆ¶æ‰€è¦åšçš„éƒ½æœ‰ä¸€ä¸ªå‰æï¼Œå°±æ˜¯ç½‘ç»œèƒ½å¤Ÿæ‰¿å—ç°æœ‰çš„ç½‘ç»œè´Ÿè·ã€‚æ‹¥å¡æ§åˆ¶æ˜¯ä¸€ä¸ªå…¨å±€æ€§çš„è¿‡ç¨‹ï¼Œæ¶‰åŠåˆ°æ‰€æœ‰çš„ä¸»æœºï¼Œæ‰€æœ‰çš„è·¯ç”±å™¨ï¼Œä»¥åŠä¸é™ä½ç½‘ç»œä¼ è¾“æ€§èƒ½æœ‰å…³çš„æ‰€æœ‰å› ç´ ã€‚ç›¸åï¼Œæµé‡æ§åˆ¶å¾€å¾€æ˜¯ç‚¹å¯¹ç‚¹é€šä¿¡é‡çš„æ§åˆ¶ï¼Œæ˜¯ä¸ªç«¯åˆ°ç«¯çš„é—®é¢˜ã€‚æµé‡æ§åˆ¶æ‰€è¦åšåˆ°çš„å°±æ˜¯æŠ‘åˆ¶å‘é€ç«¯å‘é€æ•°æ®çš„é€Ÿç‡ï¼Œä»¥ä¾¿ä½¿æ¥æ”¶ç«¯æ¥å¾—åŠæ¥æ”¶ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è¿›è¡Œæ‹¥å¡æ§åˆ¶ï¼ŒTCP å‘é€æ–¹è¦ç»´æŒä¸€ä¸ªæ‹¥å¡çª—å£(cwnd) çš„çŠ¶æ€å˜é‡ã€‚æ‹¥å¡æ§åˆ¶çª—å£çš„å¤§å°å–å†³äºç½‘ç»œçš„æ‹¥å¡ç¨‹åº¦ï¼Œå¹¶ä¸”åŠ¨æ€å˜åŒ–ã€‚å‘é€æ–¹è®©è‡ªå·±çš„å‘é€çª—å£å–ä¸ºæ‹¥å¡çª—å£å’Œæ¥æ”¶æ–¹çš„æ¥å—çª—å£ä¸­è¾ƒå°çš„ä¸€ä¸ªã€‚&lt;/p&gt;
&lt;p&gt;TCP çš„æ‹¥å¡æ§åˆ¶é‡‡ç”¨äº†å››ç§ç®—æ³•ï¼Œå³ï¼šæ…¢å¼€å§‹ã€æ‹¥å¡é¿å…ã€å¿«é‡ä¼ å’Œå¿«æ¢å¤ã€‚åœ¨ç½‘ç»œå±‚ä¹Ÿå¯ä»¥ä½¿è·¯ç”±å™¨é‡‡ç”¨é€‚å½“çš„åˆ†ç»„ä¸¢å¼ƒç­–ç•¥ï¼ˆå¦‚ï¼šä¸»åŠ¨é˜Ÿåˆ—ç®¡ç† AQMï¼‰ï¼Œä»¥å‡å°‘ç½‘ç»œæ‹¥å¡çš„å‘ç”Ÿã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ…¢å¼€å§‹&#34;&gt;æ…¢å¼€å§‹ï¼š&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;22&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%85%A2%E5%BC%80%E5%A7%8B.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;æ…¢å¼€å§‹ç®—æ³•çš„æ€è·¯æ˜¯å½“ä¸»æœºå¼€å§‹å‘é€æ•°æ®æ—¶ï¼Œå¦‚æœç«‹å³æŠŠå¤§é‡æ•°æ®å­—èŠ‚æ³¨å…¥åˆ°ç½‘ç»œï¼Œé‚£ä¹ˆå¯èƒ½ä¼šå¼•èµ·ç½‘ç»œé˜»å¡ï¼Œå› ä¸ºç°åœ¨è¿˜ä¸çŸ¥é“ç½‘ç»œçš„ç¬¦åˆæƒ…å†µã€‚ç»éªŒè¡¨æ˜ï¼Œè¾ƒå¥½çš„æ–¹æ³•æ˜¯å…ˆæ¢æµ‹ä¸€ä¸‹ï¼Œå³ç”±å°åˆ°å¤§é€æ¸å¢å¤§å‘é€çª—å£ï¼Œä¹Ÿå°±æ˜¯ç”±å°åˆ°å¤§é€æ¸å¢å¤§æ‹¥å¡çª—å£æ•°å€¼ã€‚&lt;strong&gt;cwnd åˆå§‹å€¼ä¸º 1ï¼Œæ¯ç»è¿‡ä¸€ä¸ªä¼ æ’­è½®æ¬¡ï¼Œcwnd åŠ å€&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ‹¥å¡é¿å…&#34;&gt;æ‹¥å¡é¿å…ï¼š&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%8B%A5%E5%A1%9E%E9%81%BF%E5%85%8D_1.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%8B%A5%E5%A1%9E%E9%81%BF%E5%85%8D_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%8B%A5%E5%A1%9E%E9%81%BF%E5%85%8D_3.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%8B%A5%E5%A1%9E%E9%81%BF%E5%85%8D_4.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;æ‹¥å¡é¿å…ç®—æ³•çš„æ€è·¯æ˜¯è®©æ‹¥å¡çª—å£ cwnd ç¼“æ…¢å¢å¤§ï¼Œå³æ¯ç»è¿‡ä¸€ä¸ªå¾€è¿”æ—¶é—´ RTT å°±æŠŠ&lt;strong&gt;å‘é€æ–¹çš„ cwnd åŠ  1&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;23&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%8B%A5%E5%A1%9E%E9%81%BF%E5%85%8D_5.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;å¿«é‡ä¼ ä¸å¿«æ¢å¤&#34;&gt;å¿«é‡ä¼ ä¸å¿«æ¢å¤ï¼š&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%BF%AB%E9%87%8D%E4%BC%A0%E4%B8%8E%E5%BF%AB%E6%81%A2%E5%A4%8D_1.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%BF%AB%E9%87%8D%E4%BC%A0%E4%B8%8E%E5%BF%AB%E6%81%A2%E5%A4%8D_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%BF%AB%E9%87%8D%E4%BC%A0%E4%B8%8E%E5%BF%AB%E6%81%A2%E5%A4%8D_3.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%BF%AB%E9%87%8D%E4%BC%A0%E4%B8%8E%E5%BF%AB%E6%81%A2%E5%A4%8D_4.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ TCP/IP ä¸­ï¼Œå¿«é€Ÿé‡ä¼ å’Œå¿«æ¢å¤ï¼ˆfast retransmit and recoveryï¼ŒFRRï¼‰æ˜¯ä¸€ç§æ‹¥å¡æ§åˆ¶ç®—æ³•ï¼Œå®ƒèƒ½å¿«é€Ÿæ¢å¤ä¸¢å¤±çš„æ•°æ®åŒ…ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰æ—¶ï¼Œä¸ªåˆ«æŠ¥æ–‡æ®µä¼šåœ¨ç½‘ç»œä¸­ä¸¢å¤±ï¼Œä½†å®é™…ä¸Šç½‘ç»œå¹¶æœªå‘ç”Ÿæ‹¥å¡ï¼Œè¿™å°†å¯¼è‡´å‘é€æ–¹è¶…æ—¶é‡ä¼ ï¼Œå¹¶è¯¯è®¤ä¸ºç½‘ç»œå‘ç”Ÿäº†æ‹¥å¡ï¼›å‘é€æ–¹æŠŠæ‹¥å¡çª—å£ cwnd åˆè®¾ç½®ä¸ºæœ€å°å€¼ 1ï¼Œå¹¶é”™è¯¯åœ°å¯åŠ¨æ…¢å¼€å§‹ç®—æ³•ï¼Œå› è€Œé™ä½äº†ä¼ è¾“æ•ˆç‡ã€‚é‡‡ç”¨å¿«é‡ä¼ ç®—æ³•å¯ä»¥è®©å‘é€æ–¹å°½æ—©çŸ¥é“å‘ç”Ÿäº†ä¸ªåˆ«æŠ¥æ–‡æ®µçš„ä¸¢å¤±ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€è°“å¿«é‡ä¼ ï¼Œå°±æ˜¯ä½¿å‘é€æ–¹å°½å¿«è¿›è¡Œé‡ä¼ ï¼Œè€Œä¸æ˜¯ç­‰è¶…æ—¶é‡ä¼ è®¡æ—¶å™¨è¶…æ—¶å†é‡ä¼ ã€‚&lt;/p&gt;
&lt;p&gt;è¦æ±‚æ¥æ”¶æ–¹ä¸è¦ç­‰å¾…è‡ªå·±å‘é€æ•°æ®æ—¶æ‰è¿›è¡Œæå¸¦ç¡®è®¤ï¼Œè€Œæ˜¯è¦ç«‹å³å‘é€ç¡®è®¤ï¼›&lt;/p&gt;
&lt;p&gt;å³ä½¿æ”¶åˆ°äº†å¤±åºçš„æŠ¥æ–‡æ®µä¹Ÿè¦ç«‹å³å‘å‡ºå¯¹å·²æ”¶åˆ°çš„æŠ¥æ–‡æ®µçš„é‡å¤ç¡®è®¤ã€‚&lt;/p&gt;
&lt;p&gt;å‘é€æ–¹ä¸€æ—¦æ”¶åˆ°3ä¸ªè¿ç»­çš„é‡å¤ç¡®è®¤ï¼Œå°±å°†ç›¸åº”çš„æŠ¥æ–‡æ®µç«‹å³é‡ä¼ ï¼Œè€Œä¸æ˜¯ç­‰è¯¥æŠ¥æ–‡æ®µçš„è¶…æ—¶é‡ä¼ è®¡æ—¶å™¨è¶…æ—¶å†é‡ä¼ ã€‚&lt;/p&gt;
&lt;h1 id=&#34;24-ä»€ä¹ˆæ˜¯ç²˜åŒ…&#34;&gt;24ã€ä»€ä¹ˆæ˜¯ç²˜åŒ…ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;åœ¨è¿›è¡Œ Java NIO å­¦ä¹ æ—¶ï¼Œå¯èƒ½ä¼šå‘ç°ï¼šå¦‚æœå®¢æˆ·ç«¯è¿ç»­ä¸æ–­çš„å‘æœåŠ¡ç«¯å‘é€æ•°æ®åŒ…æ—¶ï¼ŒæœåŠ¡ç«¯æ¥æ”¶çš„æ•°æ®ä¼šå‡ºç°ä¸¤ä¸ªæ•°æ®åŒ…ç²˜åœ¨ä¸€èµ·çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;TCP æ˜¯åŸºäºå­—èŠ‚æµçš„ï¼Œè™½ç„¶åº”ç”¨å±‚å’Œ TCP ä¼ è¾“å±‚ä¹‹é—´çš„æ•°æ®äº¤äº’æ˜¯å¤§å°ä¸ç­‰çš„æ•°æ®å—ï¼Œä½†æ˜¯ TCP æŠŠè¿™äº›æ•°æ®å—ä»…ä»…çœ‹æˆä¸€è¿ä¸²æ— ç»“æ„çš„å­—èŠ‚æµï¼Œæ²¡æœ‰è¾¹ç•Œï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä» TCP çš„å¸§ç»“æ„ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œåœ¨ TCP çš„é¦–éƒ¨æ²¡æœ‰è¡¨ç¤ºæ•°æ®é•¿åº¦çš„å­—æ®µã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;åŸºäºä¸Šé¢ä¸¤ç‚¹ï¼Œåœ¨ä½¿ç”¨ TCP ä¼ è¾“æ•°æ®æ—¶ï¼Œæ‰æœ‰ç²˜åŒ…æˆ–è€…æ‹†åŒ…ç°è±¡å‘ç”Ÿçš„å¯èƒ½ã€‚ä¸€ä¸ªæ•°æ®åŒ…ä¸­åŒ…å«äº†å‘é€ç«¯å‘é€çš„ä¸¤ä¸ªæ•°æ®åŒ…çš„ä¿¡æ¯ï¼Œè¿™ç§ç°è±¡å³ä¸ºç²˜åŒ…ã€‚&lt;/p&gt;
&lt;p&gt;æ¥æ”¶ç«¯æ”¶åˆ°äº†ä¸¤ä¸ªæ•°æ®åŒ…ï¼Œä½†æ˜¯è¿™ä¸¤ä¸ªæ•°æ®åŒ…è¦ä¹ˆæ˜¯ä¸å®Œæ•´çš„ï¼Œè¦ä¹ˆå°±æ˜¯å¤šå‡ºæ¥ä¸€å—ï¼Œè¿™ç§æƒ…å†µå³å‘ç”Ÿäº†æ‹†åŒ…å’Œç²˜åŒ…ã€‚æ‹†åŒ…å’Œç²˜åŒ…çš„é—®é¢˜å¯¼è‡´æ¥æ”¶ç«¯åœ¨å¤„ç†çš„æ—¶å€™ä¼šéå¸¸å›°éš¾ï¼Œå› ä¸ºæ— æ³•åŒºåˆ†ä¸€ä¸ªå®Œæ•´çš„æ•°æ®åŒ…ã€‚&lt;/p&gt;
&lt;h1 id=&#34;25-tcp-é»åŒ…æ˜¯æ€ä¹ˆäº§ç”Ÿçš„&#34;&gt;25ã€TCP é»åŒ…æ˜¯æ€ä¹ˆäº§ç”Ÿçš„ï¼Ÿ&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å‘é€æ–¹äº§ç”Ÿç²˜åŒ…&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é‡‡ç”¨ TCP åè®®ä¼ è¾“æ•°æ®çš„å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ç»å¸¸æ˜¯ä¿æŒä¸€ä¸ªé•¿è¿æ¥çš„çŠ¶æ€ï¼ˆä¸€æ¬¡è¿æ¥å‘ä¸€æ¬¡æ•°æ®ä¸å­˜åœ¨ç²˜åŒ…ï¼‰ï¼ŒåŒæ–¹åœ¨è¿æ¥ä¸æ–­å¼€çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä¸€ç›´ä¼ è¾“æ•°æ®ã€‚ä½†å½“å‘é€çš„æ•°æ®åŒ…è¿‡äºçš„å°æ—¶ï¼Œé‚£ä¹ˆ TCP åè®®é»˜è®¤çš„ä¼šå¯ç”¨ Nagle ç®—æ³•ï¼Œå°†è¿™äº›è¾ƒå°çš„æ•°æ®åŒ…è¿›è¡Œåˆå¹¶å‘é€ï¼ˆç¼“å†²åŒºæ•°æ®å‘é€æ˜¯ä¸€ä¸ªå †å‹çš„è¿‡ç¨‹ï¼‰ï¼›è¿™ä¸ªåˆå¹¶è¿‡ç¨‹å°±æ˜¯åœ¨å‘é€ç¼“å†²åŒºä¸­è¿›è¡Œçš„ï¼Œä¹Ÿå°±æ˜¯è¯´æ•°æ®å‘é€å‡ºæ¥å®ƒå·²ç»æ˜¯ç²˜åŒ…çš„çŠ¶æ€äº†ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ¥æ”¶æ–¹äº§ç”Ÿç²˜åŒ…&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ¥æ”¶æ–¹é‡‡ç”¨ TCP åè®®æ¥æ”¶æ•°æ®æ—¶çš„è¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼šæ•°æ®åˆ°æ¥æ”¶æ–¹ï¼Œä»ç½‘ç»œæ¨¡å‹çš„ä¸‹æ–¹ä¼ é€’è‡³ä¼ è¾“å±‚ï¼Œä¼ è¾“å±‚çš„ TCP åè®®å¤„ç†æ˜¯å°†å…¶æ”¾ç½®æ¥æ”¶ç¼“å†²åŒºï¼Œç„¶åç”±åº”ç”¨å±‚æ¥ä¸»åŠ¨è·å–ï¼ˆC è¯­è¨€ç”¨ recvã€read ç­‰å‡½æ•°ï¼‰ï¼›è¿™æ—¶ä¼šå‡ºç°ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æˆ‘ä»¬åœ¨ç¨‹åºä¸­è°ƒç”¨çš„è¯»å–æ•°æ®å‡½æ•°ä¸èƒ½åŠæ—¶çš„æŠŠç¼“å†²åŒºä¸­çš„æ•°æ®æ‹¿å‡ºæ¥ï¼Œè€Œä¸‹ä¸€ä¸ªæ•°æ®åˆåˆ°æ¥å¹¶æœ‰ä¸€éƒ¨åˆ†æ”¾å…¥çš„ç¼“å†²åŒºæœ«å°¾ï¼Œç­‰æˆ‘ä»¬è¯»å–æ•°æ®æ—¶å°±æ˜¯ä¸€ä¸ªç²˜åŒ…ã€‚ï¼ˆæ”¾æ•°æ®çš„é€Ÿåº¦ &amp;gt; åº”ç”¨å±‚æ‹¿æ•°æ®é€Ÿåº¦ï¼‰&lt;/p&gt;
&lt;p&gt;â€‹&lt;/p&gt;
&lt;h1 id=&#34;26-æ€ä¹ˆè§£å†³æ‹†åŒ…å’Œç²˜åŒ…&#34;&gt;26ã€æ€ä¹ˆè§£å†³æ‹†åŒ…å’Œç²˜åŒ…ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;åˆ†åŒ…æœºåˆ¶ä¸€èˆ¬æœ‰ä¸¤ä¸ªé€šç”¨çš„è§£å†³æ–¹æ³•ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;ç‰¹æ®Šå­—ç¬¦æ§åˆ¶ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åœ¨åŒ…å¤´é¦–éƒ½æ·»åŠ æ•°æ®åŒ…çš„é•¿åº¦ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¦‚æœä½¿ç”¨ netty çš„è¯ï¼Œå°±æœ‰ä¸“é—¨çš„ç¼–ç å™¨å’Œè§£ç å™¨è§£å†³æ‹†åŒ…å’Œç²˜åŒ…é—®é¢˜äº†ã€‚&lt;/p&gt;
&lt;p&gt;tipsï¼šUDP æ²¡æœ‰ç²˜åŒ…é—®é¢˜ï¼Œä½†æ˜¯æœ‰ä¸¢åŒ…å’Œä¹±åºã€‚ä¸å®Œæ•´çš„åŒ…æ˜¯ä¸ä¼šæœ‰çš„ï¼Œæ”¶åˆ°çš„éƒ½æ˜¯å®Œå…¨æ­£ç¡®çš„åŒ…ã€‚ä¼ é€çš„æ•°æ®å•ä½åè®®æ˜¯ UDP æŠ¥æ–‡æˆ–ç”¨æˆ·æ•°æ®æŠ¥ï¼Œå‘é€çš„æ—¶å€™æ—¢ä¸åˆå¹¶ï¼Œä¹Ÿä¸æ‹†åˆ†ã€‚&lt;/p&gt;
&lt;h1 id=&#34;27-ä½ å¯¹-http-çŠ¶æ€ç æœ‰äº†è§£å—&#34;&gt;27ã€ä½ å¯¹ HTTP çŠ¶æ€ç æœ‰äº†è§£å—ï¼Ÿ&lt;/h1&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;24&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/HTTP%E7%8A%B6%E6%80%81%E7%A0%81.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;1XX ä¿¡æ¯&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;100 Continue ï¼šè¡¨æ˜åˆ°ç›®å‰ä¸ºæ­¢éƒ½å¾ˆæ­£å¸¸ï¼Œå®¢æˆ·ç«¯å¯ä»¥ç»§ç»­å‘é€è¯·æ±‚æˆ–è€…å¿½ç•¥è¿™ä¸ªå“åº”ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;2XX æˆåŠŸ&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;200 OK&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;204 No Content ï¼šè¯·æ±‚å·²ç»æˆåŠŸå¤„ç†ï¼Œä½†æ˜¯è¿”å›çš„å“åº”æŠ¥æ–‡ä¸åŒ…å«å®ä½“çš„ä¸»ä½“éƒ¨åˆ†ã€‚ä¸€èˆ¬åœ¨åªéœ€è¦ä»å®¢æˆ·ç«¯å¾€æœåŠ¡å™¨å‘é€ä¿¡æ¯ï¼Œè€Œä¸éœ€è¦è¿”å›æ•°æ®æ—¶ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;206 Partial Content ï¼šè¡¨ç¤ºå®¢æˆ·ç«¯è¿›è¡Œäº†èŒƒå›´è¯·æ±‚ï¼Œå“åº”æŠ¥æ–‡åŒ…å«ç”± Content-Range æŒ‡å®šèŒƒå›´çš„å®ä½“å†…å®¹ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;3XX é‡å®šå‘&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;301 Moved Permanently ï¼šæ°¸ä¹…æ€§é‡å®šå‘ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;302 Found ï¼šä¸´æ—¶æ€§é‡å®šå‘ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;303 See Other ï¼šå’Œ 302 æœ‰ç€ç›¸åŒçš„åŠŸèƒ½ï¼Œä½†æ˜¯ 303 æ˜ç¡®è¦æ±‚å®¢æˆ·ç«¯åº”è¯¥é‡‡ç”¨ GET æ–¹æ³•è·å–èµ„æºã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;304 Not Modified ï¼šå¦‚æœè¯·æ±‚æŠ¥æ–‡é¦–éƒ¨åŒ…å«ä¸€äº›æ¡ä»¶ï¼Œä¾‹å¦‚ï¼šIf-Matchï¼ŒIf-Modified-Sinceï¼ŒIf-None-Matchï¼ŒIf-Rangeï¼ŒIf-Unmodified-Sinceï¼Œå¦‚æœä¸æ»¡è¶³æ¡ä»¶ï¼Œåˆ™æœåŠ¡å™¨ä¼šè¿”å› 304 çŠ¶æ€ç ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;307 Temporary Redirect ï¼šä¸´æ—¶é‡å®šå‘ï¼Œä¸ 302 çš„å«ä¹‰ç±»ä¼¼ï¼Œä½†æ˜¯ 307 è¦æ±‚æµè§ˆå™¨ä¸ä¼šæŠŠé‡å®šå‘è¯·æ±‚çš„ POST æ–¹æ³•æ”¹æˆ GET æ–¹æ³•ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;4XX å®¢æˆ·ç«¯é”™è¯¯&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;400 Bad Request ï¼šè¯·æ±‚æŠ¥æ–‡ä¸­å­˜åœ¨è¯­æ³•é”™è¯¯ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;401 Unauthorized ï¼šè¯¥çŠ¶æ€ç è¡¨ç¤ºå‘é€çš„è¯·æ±‚éœ€è¦æœ‰è®¤è¯ä¿¡æ¯ï¼ˆBASIC è®¤è¯ã€DIGEST è®¤è¯ï¼‰ã€‚å¦‚æœä¹‹å‰å·²è¿›è¡Œè¿‡ä¸€æ¬¡è¯·æ±‚ï¼Œåˆ™è¡¨ç¤ºç”¨æˆ·è®¤è¯å¤±è´¥ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;403 Forbidden ï¼šè¯·æ±‚è¢«æ‹’ç»ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;404 Not Found&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;5XX æœåŠ¡å™¨é”™è¯¯&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;500 Internal Server Error ï¼šæœåŠ¡å™¨æ­£åœ¨æ‰§è¡Œè¯·æ±‚æ—¶å‘ç”Ÿé”™è¯¯ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;503 Service Unavailable ï¼šæœåŠ¡å™¨æš‚æ—¶å¤„äºè¶…è´Ÿè½½æˆ–æ­£åœ¨è¿›è¡Œåœæœºç»´æŠ¤ï¼Œç°åœ¨æ— æ³•å¤„ç†è¯·æ±‚ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;28-http-çŠ¶æ€ç -301-å’Œ-302-ä»£è¡¨çš„æ˜¯ä»€ä¹ˆæœ‰ä»€ä¹ˆåŒºåˆ«&#34;&gt;28ã€HTTP çŠ¶æ€ç  301 å’Œ 302 ä»£è¡¨çš„æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;301ï¼Œ302 éƒ½æ˜¯ HTTP çŠ¶æ€çš„ç¼–ç ï¼Œéƒ½ä»£è¡¨ç€æŸä¸ª URL å‘ç”Ÿäº†è½¬ç§»ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŒºåˆ«&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;301 redirect: 301 ä»£è¡¨æ°¸ä¹…æ€§è½¬ç§»ï¼ˆPermanently Movedï¼‰&lt;/p&gt;
&lt;p&gt;302 redirect: 302 ä»£è¡¨æš‚æ—¶æ€§è½¬ç§»ï¼ˆTemporarily Movedï¼‰&lt;/p&gt;
&lt;h1 id=&#34;29-forward-å’Œ-redirect-çš„åŒºåˆ«&#34;&gt;29ã€forward å’Œ redirect çš„åŒºåˆ«ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;Forward å’Œ Redirect ä»£è¡¨äº†ä¸¤ç§è¯·æ±‚è½¬å‘æ–¹å¼ï¼šç›´æ¥è½¬å‘å’Œé—´æ¥è½¬å‘ã€‚&lt;/p&gt;
&lt;p&gt;ç›´æ¥è½¬å‘æ–¹å¼ï¼ˆForwardï¼‰ï¼šå®¢æˆ·ç«¯å’Œæµè§ˆå™¨åªå‘å‡º&lt;strong&gt;ä¸€æ¬¡è¯·æ±‚&lt;/strong&gt;ï¼ŒServletã€HTMLã€JSP æˆ–å…¶å®ƒä¿¡æ¯èµ„æºï¼Œç”±ç¬¬äºŒä¸ªä¿¡æ¯èµ„æºå“åº”è¯¥è¯·æ±‚ï¼Œåœ¨è¯·æ±‚å¯¹è±¡ request ä¸­ï¼Œä¿å­˜çš„å¯¹è±¡å¯¹äºæ¯ä¸ªä¿¡æ¯èµ„æºæ˜¯å…±äº«çš„ã€‚&lt;/p&gt;
&lt;p&gt;é—´æ¥è½¬å‘æ–¹å¼ï¼ˆRedirectï¼‰ï¼šå®é™…æ˜¯&lt;strong&gt;ä¸¤æ¬¡ HTTP è¯·æ±‚&lt;/strong&gt;ï¼ŒæœåŠ¡å™¨ç«¯åœ¨å“åº”ç¬¬ä¸€æ¬¡è¯·æ±‚çš„æ—¶å€™ï¼Œè®©æµè§ˆå™¨å†å‘å¦å¤–ä¸€ä¸ª URL å‘å‡ºè¯·æ±‚ï¼Œä»è€Œè¾¾åˆ°è½¬å‘çš„ç›®çš„ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸¾ä¸ªé€šä¿—çš„ä¾‹å­ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç›´æ¥è½¬å‘å°±ç›¸å½“äºï¼šâ€œA æ‰¾ B å€Ÿé’±ï¼ŒB è¯´æ²¡æœ‰ï¼ŒB å»æ‰¾ C å€Ÿï¼Œå€Ÿåˆ°å€Ÿä¸åˆ°éƒ½ä¼šæŠŠæ¶ˆæ¯ä¼ é€’ç»™ Aâ€ï¼›&lt;/p&gt;
&lt;p&gt;é—´æ¥è½¬å‘å°±ç›¸å½“äºï¼š&amp;quot;A æ‰¾ B å€Ÿé’±ï¼ŒB è¯´æ²¡æœ‰ï¼Œè®© A å»æ‰¾ C å€Ÿ&amp;quot;ã€‚&lt;/p&gt;
&lt;h1 id=&#34;30-http-æ–¹æ³•æœ‰å“ªäº›&#34;&gt;30ã€HTTP æ–¹æ³•æœ‰å“ªäº›ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;å®¢æˆ·ç«¯å‘é€çš„ è¯·æ±‚æŠ¥æ–‡ ç¬¬ä¸€è¡Œä¸ºè¯·æ±‚è¡Œï¼ŒåŒ…å«äº†æ–¹æ³•å­—æ®µã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;GETï¼šè·å–èµ„æºï¼Œå½“å‰ç½‘ç»œä¸­ç»å¤§éƒ¨åˆ†ä½¿ç”¨çš„éƒ½æ˜¯ GETï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;HEADï¼šè·å–æŠ¥æ–‡é¦–éƒ¨ï¼Œå’Œ GET æ–¹æ³•ç±»ä¼¼ï¼Œä½†æ˜¯ä¸è¿”å›æŠ¥æ–‡å®ä½“ä¸»ä½“éƒ¨åˆ†ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;POSTï¼šä¼ è¾“å®ä½“ä¸»ä½“&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;PUTï¼šä¸Šä¼ æ–‡ä»¶ï¼Œç”±äºè‡ªèº«ä¸å¸¦éªŒè¯æœºåˆ¶ï¼Œä»»ä½•äººéƒ½å¯ä»¥ä¸Šä¼ æ–‡ä»¶ï¼Œå› æ­¤å­˜åœ¨å®‰å…¨æ€§é—®é¢˜ï¼Œä¸€èˆ¬ä¸ä½¿ç”¨è¯¥æ–¹æ³•ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;PATCHï¼šå¯¹èµ„æºè¿›è¡Œéƒ¨åˆ†ä¿®æ”¹ã€‚PUT ä¹Ÿå¯ä»¥ç”¨äºä¿®æ”¹èµ„æºï¼Œä½†æ˜¯åªèƒ½å®Œå…¨æ›¿ä»£åŸå§‹èµ„æºï¼ŒPATCH å…è®¸éƒ¨åˆ†ä¿®æ”¹ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;OPTIONSï¼šæŸ¥è¯¢æŒ‡å®šçš„ URL æ”¯æŒçš„æ–¹æ³•ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CONNECTï¼šè¦æ±‚åœ¨ä¸ä»£ç†æœåŠ¡å™¨é€šä¿¡æ—¶å»ºç«‹éš§é“ã€‚ä½¿ç”¨ SSLï¼ˆSecure Sockets Layerï¼Œå®‰å…¨å¥—æ¥å±‚ï¼‰å’Œ TLSï¼ˆTransport Layer Securityï¼Œä¼ è¾“å±‚å®‰å…¨ï¼‰åè®®æŠŠé€šä¿¡å†…å®¹åŠ å¯†åç»ç½‘ç»œéš§é“ä¼ è¾“ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;TRACEï¼šè¿½è¸ªè·¯å¾„ã€‚æœåŠ¡å™¨ä¼šå°†é€šä¿¡è·¯å¾„è¿”å›ç»™å®¢æˆ·ç«¯ã€‚å‘é€è¯·æ±‚æ—¶ï¼Œåœ¨ Max-Forwards é¦–éƒ¨å­—æ®µä¸­å¡«å…¥æ•°å€¼ï¼Œæ¯ç»è¿‡ä¸€ä¸ªæœåŠ¡å™¨å°±ä¼šå‡ 1ï¼Œå½“æ•°å€¼ä¸º 0 æ—¶å°±åœæ­¢ä¼ è¾“ã€‚é€šå¸¸ä¸ä¼šä½¿ç”¨ TRACEï¼Œå¹¶ä¸”å®ƒå®¹æ˜“å—åˆ° XST æ”»å‡»ï¼ˆCross-Site Tracingï¼Œè·¨ç«™è¿½è¸ªï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;31-è¯´ä¸‹-get-å’Œ-post-çš„åŒºåˆ«&#34;&gt;31ã€è¯´ä¸‹ GET å’Œ POST çš„åŒºåˆ«ï¼Ÿï¼ˆ**ï¼‰&lt;/h1&gt;
&lt;p&gt;GET å’Œ POST æœ¬è´¨éƒ½æ˜¯ HTTP è¯·æ±‚ï¼Œåªä¸è¿‡å¯¹å®ƒä»¬çš„ä½œç”¨åšäº†ç•Œå®šå’Œé€‚é…ï¼Œå¹¶ä¸”è®©ä»–ä»¬é€‚åº”å„è‡ªçš„åœºæ™¯ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬è´¨åŒºåˆ«ï¼šGET åªæ˜¯ä¸€æ¬¡ HTTPè¯·æ±‚ï¼ŒPOST å…ˆå‘è¯·æ±‚å¤´å†å‘è¯·æ±‚ä½“ï¼Œå®é™…ä¸Šæ˜¯ä¸¤æ¬¡è¯·æ±‚ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;ä»åŠŸèƒ½ä¸Šè®²ï¼ŒGET ä¸€èˆ¬ç”¨æ¥ä»æœåŠ¡å™¨ä¸Šè·å–èµ„æºï¼ŒPOST ä¸€èˆ¬ç”¨æ¥æ›´æ–°æœåŠ¡å™¨ä¸Šçš„èµ„æºï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä» REST æœåŠ¡è§’åº¦ä¸Šè¯´ï¼ŒGET æ˜¯å¹‚ç­‰çš„ï¼Œå³è¯»å–åŒä¸€ä¸ªèµ„æºï¼Œæ€»æ˜¯å¾—åˆ°ç›¸åŒçš„æ•°æ®ï¼Œè€Œ POST ä¸æ˜¯å¹‚ç­‰çš„ï¼Œå› ä¸ºæ¯æ¬¡è¯·æ±‚å¯¹èµ„æºçš„æ”¹å˜å¹¶ä¸æ˜¯ç›¸åŒçš„ï¼›è¿›ä¸€æ­¥åœ°ï¼ŒGET ä¸ä¼šæ”¹å˜æœåŠ¡å™¨ä¸Šçš„èµ„æºï¼Œè€Œ POST ä¼šå¯¹æœåŠ¡å™¨èµ„æºè¿›è¡Œæ”¹å˜ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä»è¯·æ±‚å‚æ•°å½¢å¼ä¸Šçœ‹ï¼ŒGET è¯·æ±‚çš„æ•°æ®ä¼šé™„åœ¨ URL ä¹‹åï¼Œå³å°†è¯·æ±‚æ•°æ®æ”¾ç½®åœ¨ HTTP æŠ¥æ–‡çš„ è¯·æ±‚å¤´ ä¸­ï¼Œä»¥ ? åˆ†å‰² URL å’Œä¼ è¾“æ•°æ®ï¼Œå‚æ•°ä¹‹é—´ä»¥ &amp;amp; ç›¸è¿ã€‚ç‰¹åˆ«åœ°ï¼Œå¦‚æœæ•°æ®æ˜¯è‹±æ–‡å­—æ¯/æ•°å­—ï¼ŒåŸæ ·å‘é€ï¼›å¦åˆ™ï¼Œä¼šå°†å…¶ç¼–ç ä¸º application/x-www-form-urlencoded MIME å­—ç¬¦ä¸²(å¦‚æœæ˜¯ç©ºæ ¼ï¼Œè½¬æ¢ä¸º+ï¼Œå¦‚æœæ˜¯ä¸­æ–‡/å…¶ä»–å­—ç¬¦ï¼Œåˆ™ç›´æ¥æŠŠå­—ç¬¦ä¸²ç”¨ BASE64 åŠ å¯†ï¼Œå¾—å‡ºå¦‚ï¼š%E4%BD%A0%E5%A5%BDï¼Œå…¶ä¸­ ï¼…XX ä¸­çš„ XX ä¸ºè¯¥ç¬¦å·ä»¥ 16 è¿›åˆ¶è¡¨ç¤ºçš„ ASCII)ï¼›è€Œ POST è¯·æ±‚ä¼šæŠŠæäº¤çš„æ•°æ®åˆ™æ”¾ç½®åœ¨æ˜¯ HTTP è¯·æ±‚æŠ¥æ–‡çš„ è¯·æ±‚ä½“ ä¸­ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å°±å®‰å…¨æ€§è€Œè¨€ï¼ŒPOST çš„å®‰å…¨æ€§è¦æ¯” GET çš„å®‰å…¨æ€§é«˜ï¼Œå› ä¸º GET è¯·æ±‚æäº¤çš„æ•°æ®å°†æ˜æ–‡å‡ºç°åœ¨ URL ä¸Šï¼Œè€Œä¸” POST è¯·æ±‚å‚æ•°åˆ™è¢«åŒ…è£…åˆ°è¯·æ±‚ä½“ä¸­ï¼Œç›¸å¯¹æ›´å®‰å…¨ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä»è¯·æ±‚çš„å¤§å°çœ‹ï¼ŒGET è¯·æ±‚çš„é•¿åº¦å—é™äºæµè§ˆå™¨æˆ–æœåŠ¡å™¨å¯¹ URL é•¿åº¦çš„é™åˆ¶ï¼Œå…è®¸å‘é€çš„æ•°æ®é‡æ¯”è¾ƒå°ï¼Œè€Œ POST è¯·æ±‚åˆ™æ˜¯æ²¡æœ‰å¤§å°é™åˆ¶çš„ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;32-åœ¨æµè§ˆå™¨ä¸­è¾“å…¥-url-åœ°å€åˆ°æ˜¾ç¤ºä¸»é¡µçš„è¿‡ç¨‹&#34;&gt;32ã€åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ URL åœ°å€åˆ°æ˜¾ç¤ºä¸»é¡µçš„è¿‡ç¨‹ï¼Ÿï¼ˆ*ï¼‰&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;DNS è§£æï¼šæµè§ˆå™¨æŸ¥è¯¢ DNSï¼Œè·å–åŸŸåå¯¹åº”çš„ IP åœ°å€ï¼šå…·ä½“è¿‡ç¨‹åŒ…æ‹¬æµè§ˆå™¨æœç´¢è‡ªèº«çš„ DNS ç¼“å­˜ã€æœç´¢æ“ä½œç³»ç»Ÿçš„ DNS ç¼“å­˜ã€è¯»å–æœ¬åœ°çš„ Host æ–‡ä»¶å’Œå‘æœ¬åœ° DNS æœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢ç­‰ã€‚å¯¹äºå‘æœ¬åœ° DNS æœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢ï¼Œå¦‚æœè¦æŸ¥è¯¢çš„åŸŸååŒ…å«åœ¨æœ¬åœ°é…ç½®åŒºåŸŸèµ„æºä¸­ï¼Œåˆ™è¿”å›è§£æç»“æœç»™å®¢æˆ·æœºï¼Œå®ŒæˆåŸŸåè§£æ(æ­¤è§£æå…·æœ‰æƒå¨æ€§)ï¼›å¦‚æœè¦æŸ¥è¯¢çš„åŸŸåä¸ç”±æœ¬åœ° DNS æœåŠ¡å™¨åŒºåŸŸè§£æï¼Œä½†è¯¥æœåŠ¡å™¨å·²ç¼“å­˜äº†æ­¤ç½‘å€æ˜ å°„å…³ç³»ï¼Œåˆ™è°ƒç”¨è¿™ä¸ª IP åœ°å€æ˜ å°„ï¼Œå®ŒæˆåŸŸåè§£æï¼ˆæ­¤è§£æä¸å…·æœ‰æƒå¨æ€§ï¼‰ã€‚å¦‚æœæœ¬åœ°åŸŸåæœåŠ¡å™¨å¹¶æœªç¼“å­˜è¯¥ç½‘å€æ˜ å°„å…³ç³»ï¼Œé‚£ä¹ˆå°†æ ¹æ®å…¶è®¾ç½®å‘èµ·é€’å½’æŸ¥è¯¢æˆ–è€…è¿­ä»£æŸ¥è¯¢ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;TCP è¿æ¥ï¼šæµè§ˆå™¨è·å¾—åŸŸåå¯¹åº”çš„ IP åœ°å€ä»¥åï¼Œæµè§ˆå™¨å‘æœåŠ¡å™¨è¯·æ±‚å»ºç«‹é“¾æ¥ï¼Œå‘èµ·ä¸‰æ¬¡æ¡æ‰‹ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å‘é€ HTTP è¯·æ±‚ï¼šTCP è¿æ¥å»ºç«‹èµ·æ¥åï¼Œæµè§ˆå™¨å‘æœåŠ¡å™¨å‘é€ HTTP è¯·æ±‚ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æœåŠ¡å™¨å¤„ç†è¯·æ±‚å¹¶è¿”å› HTTP æŠ¥æ–‡ï¼šæœåŠ¡å™¨æ¥æ”¶åˆ°è¿™ä¸ªè¯·æ±‚ï¼Œå¹¶æ ¹æ®è·¯å¾„å‚æ•°æ˜ å°„åˆ°ç‰¹å®šçš„è¯·æ±‚å¤„ç†å™¨è¿›è¡Œå¤„ç†ï¼Œå¹¶å°†å¤„ç†ç»“æœåŠç›¸åº”çš„è§†å›¾è¿”å›ç»™æµè§ˆå™¨ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æµè§ˆå™¨è§£ææ¸²æŸ“é¡µé¢ï¼šæµè§ˆå™¨è§£æå¹¶æ¸²æŸ“è§†å›¾ï¼Œè‹¥é‡åˆ°å¯¹ js æ–‡ä»¶ã€css æ–‡ä»¶åŠå›¾ç‰‡ç­‰é™æ€èµ„æºçš„å¼•ç”¨ï¼Œåˆ™é‡å¤ä¸Šè¿°æ­¥éª¤å¹¶å‘æœåŠ¡å™¨è¯·æ±‚è¿™äº›èµ„æºï¼›æµè§ˆå™¨æ ¹æ®å…¶è¯·æ±‚åˆ°çš„èµ„æºã€æ•°æ®æ¸²æŸ“é¡µé¢ï¼Œæœ€ç»ˆå‘ç”¨æˆ·å‘ˆç°ä¸€ä¸ªå®Œæ•´çš„é¡µé¢ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è¿æ¥ç»“æŸã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;33-dns-çš„è§£æè¿‡ç¨‹&#34;&gt;33ã€DNS çš„è§£æè¿‡ç¨‹ï¼Ÿï¼ˆ**ï¼‰&lt;/h1&gt;
&lt;p&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/DNS%E8%A7%A3%E6%9E%90_1.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/DNS%E8%A7%A3%E6%9E%90_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä¸»æœºå‘æœ¬åœ°åŸŸåæœåŠ¡å™¨&lt;/strong&gt;çš„æŸ¥è¯¢ä¸€èˆ¬éƒ½æ˜¯é‡‡ç”¨é€’å½’æŸ¥è¯¢ã€‚æ‰€è°“é€’å½’æŸ¥è¯¢å°±æ˜¯ï¼šå¦‚æœä¸»æœºæ‰€è¯¢é—®çš„æœ¬åœ°åŸŸåæœåŠ¡å™¨ä¸çŸ¥é“è¢«æŸ¥è¯¢çš„åŸŸåçš„ IP åœ°å€ï¼Œé‚£ä¹ˆæœ¬åœ°åŸŸåæœåŠ¡å™¨å°±ä»¥ DNS å®¢æˆ·çš„èº«ä»½ï¼Œå‘æ ¹åŸŸåæœåŠ¡å™¨ç»§ç»­å‘å‡ºæŸ¥è¯¢è¯·æ±‚æŠ¥æ–‡(å³æ›¿ä¸»æœºç»§ç»­æŸ¥è¯¢)ï¼Œè€Œä¸æ˜¯è®©ä¸»æœºè‡ªå·±è¿›è¡Œä¸‹ä¸€æ­¥æŸ¥è¯¢ã€‚å› æ­¤ï¼Œé€’å½’æŸ¥è¯¢è¿”å›çš„æŸ¥è¯¢ç»“æœæˆ–è€…æ˜¯æ‰€è¦æŸ¥è¯¢çš„ IP åœ°å€ï¼Œæˆ–è€…æ˜¯æŠ¥é”™ï¼Œè¡¨ç¤ºæ— æ³•æŸ¥è¯¢åˆ°æ‰€éœ€çš„ IP åœ°å€ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æœ¬åœ°åŸŸåæœåŠ¡å™¨å‘æ ¹åŸŸåæœåŠ¡å™¨&lt;/strong&gt;çš„æŸ¥è¯¢çš„è¿­ä»£æŸ¥è¯¢ã€‚è¿­ä»£æŸ¥è¯¢çš„ç‰¹ç‚¹ï¼šå½“æ ¹åŸŸåæœåŠ¡å™¨æ”¶åˆ°æœ¬åœ°åŸŸåæœåŠ¡å™¨å‘å‡ºçš„è¿­ä»£æŸ¥è¯¢è¯·æ±‚æŠ¥æ–‡æ—¶ï¼Œè¦ä¹ˆç»™å‡ºæ‰€è¦æŸ¥è¯¢çš„ IP åœ°å€ï¼Œè¦ä¹ˆå‘Šè¯‰æœ¬åœ°æœåŠ¡å™¨ï¼šâ€œä½ ä¸‹ä¸€æ­¥åº”å½“å‘å“ªä¸€ä¸ªåŸŸåæœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢â€ã€‚ç„¶åè®©æœ¬åœ°æœåŠ¡å™¨è¿›è¡Œåç»­çš„æŸ¥è¯¢ã€‚æ ¹åŸŸåæœåŠ¡å™¨é€šå¸¸æ˜¯æŠŠè‡ªå·±çŸ¥é“çš„é¡¶çº§åŸŸåæœåŠ¡å™¨çš„ IP åœ°å€å‘Šè¯‰æœ¬åœ°åŸŸåæœåŠ¡å™¨ï¼Œè®©æœ¬åœ°åŸŸåæœåŠ¡å™¨å†å‘é¡¶çº§åŸŸåæœåŠ¡å™¨æŸ¥è¯¢ã€‚é¡¶çº§åŸŸåæœåŠ¡å™¨åœ¨æ”¶åˆ°æœ¬åœ°åŸŸåæœåŠ¡å™¨çš„æŸ¥è¯¢è¯·æ±‚åï¼Œè¦ä¹ˆç»™å‡ºæ‰€è¦æŸ¥è¯¢çš„ IP åœ°å€ï¼Œè¦ä¹ˆå‘Šè¯‰æœ¬åœ°æœåŠ¡å™¨ä¸‹ä¸€æ­¥åº”å½“å‘å“ªä¸€ä¸ªæƒé™åŸŸåæœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢ã€‚æœ€åï¼Œæœ¬åœ°åŸŸåæœåŠ¡å™¨å¾—åˆ°äº†æ‰€è¦è§£æçš„ IP åœ°å€æˆ–æŠ¥é”™ï¼Œç„¶åæŠŠè¿™ä¸ªç»“æœè¿”å›ç»™å‘èµ·æŸ¥è¯¢çš„ä¸»æœºã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;34-è°ˆè°ˆä½ å¯¹åŸŸåç¼“å­˜çš„äº†è§£&#34;&gt;34ã€è°ˆè°ˆä½ å¯¹åŸŸåç¼“å­˜çš„äº†è§£ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%9F%9F%E5%90%8D%E7%BC%93%E5%AD%98_1.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%9F%9F%E5%90%8D%E7%BC%93%E5%AD%98_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä¸ºäº†æé«˜ DNS æŸ¥è¯¢æ•ˆç‡ï¼Œå¹¶å‡è½»æœåŠ¡å™¨çš„è´Ÿè·å’Œå‡å°‘å› ç‰¹ç½‘ä¸Šçš„ DNS æŸ¥è¯¢æŠ¥æ–‡æ•°é‡ï¼Œåœ¨&lt;strong&gt;åŸŸåæœåŠ¡å™¨&lt;/strong&gt;ä¸­å¹¿æ³›ä½¿ç”¨äº†&lt;strong&gt;é«˜é€Ÿç¼“å­˜&lt;/strong&gt;ï¼Œç”¨æ¥å­˜æ”¾æœ€è¿‘æŸ¥è¯¢è¿‡çš„åŸŸåä»¥åŠä»ä½•å¤„è·å¾—åŸŸåæ˜ å°„ä¿¡æ¯çš„è®°å½•ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºåå­—åˆ°åœ°å€çš„ç»‘å®šå¹¶ä¸ç»å¸¸æ”¹å˜ï¼Œä¸ºä¿æŒé«˜é€Ÿç¼“å­˜ä¸­çš„å†…å®¹æ­£ç¡®ï¼ŒåŸŸåæœåŠ¡å™¨åº”ä¸ºæ¯é¡¹å†…å®¹è®¾ç½®&lt;strong&gt;è®¡æ—¶å™¨&lt;/strong&gt;å¹¶å¤„ç†è¶…è¿‡åˆç†æ—¶é—´çš„é¡¹ï¼ˆä¾‹å¦‚ï¼šæ¯ä¸ªé¡¹ç›®ä¸¤å¤©ï¼‰ã€‚å½“åŸŸåæœåŠ¡å™¨å·²ä»ç¼“å­˜ä¸­åˆ å»æŸé¡¹ä¿¡æ¯ååˆè¢«è¯·æ±‚æŸ¥è¯¢è¯¥é¡¹ä¿¡æ¯ï¼Œå°±å¿…é¡»é‡æ–°åˆ°æˆæƒç®¡ç†è¯¥é¡¹çš„åŸŸåæœåŠ¡å™¨ç»‘å®šä¿¡æ¯ã€‚å½“æƒé™æœåŠ¡å™¨å›ç­”ä¸€ä¸ªæŸ¥è¯¢è¯·æ±‚æ—¶ï¼Œåœ¨å“åº”ä¸­éƒ½æŒ‡æ˜ç»‘å®šæœ‰æ•ˆå­˜åœ¨çš„æ—¶é—´å€¼ã€‚å¢åŠ æ­¤æ—¶é—´å€¼å¯å‡å°‘ç½‘ç»œå¼€é”€ï¼Œè€Œå‡å°‘æ­¤æ—¶é—´å€¼å¯æé«˜åŸŸåè§£æçš„æ­£ç¡®æ€§ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ä»…åœ¨æœ¬åœ°åŸŸåæœåŠ¡å™¨ä¸­éœ€è¦é«˜é€Ÿç¼“å­˜ï¼Œåœ¨&lt;strong&gt;ä¸»æœº&lt;/strong&gt;ä¸­ä¹Ÿéœ€è¦ã€‚è®¸å¤šä¸»æœºåœ¨å¯åŠ¨æ—¶ä»æœ¬åœ°æœåŠ¡å™¨ä¸‹è½½åå­—å’Œåœ°å€çš„å…¨éƒ¨æ•°æ®åº“ï¼Œç»´æŠ¤å­˜æ”¾è‡ªå·±æœ€è¿‘ä½¿ç”¨çš„åŸŸåçš„é«˜é€Ÿç¼“å­˜ï¼Œå¹¶ä¸”åªåœ¨ä»ç¼“å­˜ä¸­æ‰¾ä¸åˆ°åå­—æ—¶æ‰ä½¿ç”¨åŸŸåæœåŠ¡å™¨ã€‚ç»´æŠ¤æœ¬åœ°åŸŸåæœåŠ¡å™¨æ•°æ®åº“çš„ä¸»æœºåº”å½“å®šæœŸåœ°æ£€æŸ¥åŸŸåæœåŠ¡å™¨ä»¥è·å–æ–°çš„æ˜ å°„ä¿¡æ¯ï¼Œè€Œä¸”ä¸»æœºå¿…é¡»ä»ç¼“å­˜ä¸­åˆ é™¤æ— æ•ˆçš„é¡¹ã€‚ç”±äºåŸŸåæ”¹åŠ¨å¹¶ä¸é¢‘ç¹ï¼Œå¤§å¤šæ•°ç½‘ç‚¹ä¸éœ€èŠ±ç²¾åŠ›å°±èƒ½ç»´æŠ¤æ•°æ®åº“çš„ä¸€è‡´æ€§ã€‚&lt;/p&gt;
&lt;h1 id=&#34;35-è°ˆä¸‹ä½ å¯¹-http-é•¿è¿æ¥å’ŒçŸ­è¿æ¥çš„ç†è§£åˆ†åˆ«åº”ç”¨äºå“ªäº›åœºæ™¯&#34;&gt;35ã€è°ˆä¸‹ä½ å¯¹ HTTP é•¿è¿æ¥å’ŒçŸ­è¿æ¥çš„ç†è§£ï¼Ÿåˆ†åˆ«åº”ç”¨äºå“ªäº›åœºæ™¯ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;åœ¨ HTTP/1.0 ä¸­é»˜è®¤ä½¿ç”¨çŸ­è¿æ¥ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨æ¯è¿›è¡Œä¸€æ¬¡ HTTP æ“ä½œï¼Œå°±å»ºç«‹ä¸€æ¬¡è¿æ¥ï¼Œä»»åŠ¡ç»“æŸå°±ä¸­æ–­è¿æ¥ã€‚å½“å®¢æˆ·ç«¯æµè§ˆå™¨è®¿é—®çš„æŸä¸ª HTML æˆ–å…¶ä»–ç±»å‹çš„ Web é¡µä¸­åŒ…å«æœ‰å…¶ä»–çš„ Web èµ„æºï¼ˆå¦‚ï¼šJavaScript æ–‡ä»¶ã€å›¾åƒæ–‡ä»¶ã€CSS æ–‡ä»¶ç­‰ï¼‰ï¼Œæ¯é‡åˆ°è¿™æ ·ä¸€ä¸ª Web èµ„æºï¼Œæµè§ˆå™¨å°±ä¼šé‡æ–°å»ºç«‹ä¸€ä¸ª HTTP ä¼šè¯ã€‚&lt;/p&gt;
&lt;p&gt;è€Œä» HTTP/1.1 èµ·ï¼Œé»˜è®¤ä½¿ç”¨é•¿è¿æ¥ï¼Œç”¨ä»¥ä¿æŒè¿æ¥ç‰¹æ€§ã€‚ä½¿ç”¨é•¿è¿æ¥çš„ HTTP åè®®ï¼Œä¼šåœ¨å“åº”å¤´åŠ å…¥è¿™è¡Œä»£ç ï¼š&lt;/p&gt;
&lt;p&gt;Connection:keep-alive&lt;/p&gt;
&lt;p&gt;åœ¨ä½¿ç”¨é•¿è¿æ¥çš„æƒ…å†µä¸‹ï¼Œå½“ä¸€ä¸ªç½‘é¡µæ‰“å¼€å®Œæˆåï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ç”¨äºä¼ è¾“ HTTP æ•°æ®çš„ TCP è¿æ¥ä¸ä¼šå…³é—­ï¼Œå®¢æˆ·ç«¯å†æ¬¡è®¿é—®è¿™ä¸ªæœåŠ¡å™¨æ—¶ï¼Œä¼šç»§ç»­ä½¿ç”¨è¿™ä¸€æ¡å·²ç»å»ºç«‹çš„è¿æ¥ã€‚&lt;/p&gt;
&lt;p&gt;Keep-Alive ä¸ä¼šæ°¸ä¹…ä¿æŒè¿æ¥ï¼Œå®ƒæœ‰ä¸€ä¸ªä¿æŒæ—¶é—´ï¼Œå¯ä»¥åœ¨ä¸åŒçš„æœåŠ¡å™¨è½¯ä»¶ï¼ˆå¦‚ï¼šApacheï¼‰ä¸­è®¾å®šè¿™ä¸ªæ—¶é—´ã€‚å®ç°é•¿è¿æ¥éœ€è¦å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½æ”¯æŒé•¿è¿æ¥ã€‚&lt;/p&gt;
&lt;h1 id=&#34;36-è°ˆä¸‹-http-10-å’Œ-11-12-çš„ä¸»è¦å˜åŒ–&#34;&gt;36ã€è°ˆä¸‹ HTTP 1.0Â å’Œ 1.1ã€1.2 çš„ä¸»è¦å˜åŒ–ï¼Ÿ&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;HTTP1.1 çš„ä¸»è¦å˜åŒ–ï¼š&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;HTTP1.0 ç»è¿‡å¤šå¹´å‘å±•ï¼Œåœ¨ 1.1 æå‡ºäº†æ”¹è¿›ã€‚é¦–å…ˆæ˜¯æå‡ºäº†é•¿è¿æ¥ï¼ŒHTTP å¯ä»¥åœ¨ä¸€æ¬¡ TCP è¿æ¥ä¸­ä¸æ–­å‘é€è¯·æ±‚ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç„¶å HTTP1.1 æ”¯æŒåªå‘é€ header è€Œä¸å‘é€ bodyã€‚åŸå› æ˜¯å…ˆç”¨ header åˆ¤æ–­èƒ½å¦æˆåŠŸï¼Œå†å‘æ•°æ®ï¼ŒèŠ‚çº¦å¸¦å®½ï¼Œäº‹å®ä¸Šï¼Œpost è¯·æ±‚é»˜è®¤å°±æ˜¯è¿™æ ·åšçš„ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;HTTP1.1 çš„ host å­—æ®µã€‚ç”±äºè™šæ‹Ÿä¸»æœºå¯ä»¥æ”¯æŒå¤šä¸ªåŸŸåï¼Œæ‰€ä»¥ä¸€èˆ¬å°†åŸŸåè§£æåå¾—åˆ° hostã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;HTTP2.0 çš„ä¸»è¦å˜åŒ–ï¼š&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;HTTP2.0 æ”¯æŒå¤šè·¯å¤ç”¨ï¼ŒåŒä¸€ä¸ªè¿æ¥å¯ä»¥å¹¶å‘å¤„ç†å¤šä¸ªè¯·æ±‚ï¼Œæ–¹æ³•æ˜¯æŠŠ HTTPæ•°æ®åŒ…æ‹†ä¸ºå¤šä¸ªå¸§ï¼Œå¹¶å‘æœ‰åºçš„å‘é€ï¼Œæ ¹æ®åºå·åœ¨å¦ä¸€ç«¯è¿›è¡Œé‡ç»„ï¼Œè€Œä¸éœ€è¦ä¸€ä¸ªä¸ª HTTPè¯·æ±‚é¡ºåºåˆ°è¾¾ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;HTTP2.0 æ”¯æŒæœåŠ¡ç«¯æ¨é€ï¼Œå°±æ˜¯æœåŠ¡ç«¯åœ¨ HTTP è¯·æ±‚åˆ°è¾¾åï¼Œé™¤äº†è¿”å›æ•°æ®ä¹‹å¤–ï¼Œè¿˜æ¨é€äº†é¢å¤–çš„å†…å®¹ç»™å®¢æˆ·ç«¯ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;HTTP2.0 å‹ç¼©äº†è¯·æ±‚å¤´ï¼ŒåŒæ—¶åŸºæœ¬å•ä½æ˜¯äºŒè¿›åˆ¶å¸§æµï¼Œè¿™æ ·çš„æ•°æ®å ç”¨ç©ºé—´æ›´å°‘ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;HTTP2.0 é€‚ç”¨äº HTTPS åœºæ™¯ï¼Œå› ä¸ºå…¶åœ¨ HTTPå’Œ TCP ä¸­é—´åŠ äº†ä¸€å±‚ SSL å±‚ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;37-https-çš„å·¥ä½œè¿‡ç¨‹&#34;&gt;37ã€HTTPS çš„å·¥ä½œè¿‡ç¨‹ï¼Ÿï¼ˆ**ï¼‰&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;å®¢æˆ·ç«¯å‘é€è‡ªå·±æ”¯æŒçš„åŠ å¯†è§„åˆ™ç»™æœåŠ¡å™¨ï¼Œä»£è¡¨å‘Šè¯‰æœåŠ¡å™¨è¦è¿›è¡Œè¿æ¥äº†ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æœåŠ¡å™¨ä»ä¸­é€‰å‡ºä¸€å¥—åŠ å¯†ç®—æ³•å’Œ hash ç®—æ³•ä»¥åŠè‡ªå·±çš„èº«ä»½ä¿¡æ¯ï¼ˆåœ°å€ç­‰ï¼‰ä»¥è¯ä¹¦çš„å½¢å¼å‘é€ç»™æµè§ˆå™¨ï¼Œè¯ä¹¦ä¸­åŒ…å«æœåŠ¡å™¨ä¿¡æ¯ï¼ŒåŠ å¯†å…¬é’¥ï¼Œè¯ä¹¦çš„åŠæ³•æœºæ„ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å®¢æˆ·ç«¯æ”¶åˆ°ç½‘ç«™çš„è¯ä¹¦ä¹‹åè¦åšä¸‹é¢çš„äº‹æƒ…ï¼š&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;3.1 éªŒè¯è¯ä¹¦çš„åˆæ³•æ€§ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;3.2 å¦‚æœéªŒè¯é€šè¿‡è¯ä¹¦ï¼Œæµè§ˆå™¨ä¼šç”Ÿæˆä¸€ä¸²éšæœºæ•°ï¼Œå¹¶ç”¨è¯ä¹¦ä¸­çš„å…¬é’¥è¿›è¡ŒåŠ å¯†ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;3.3 ç”¨çº¦å®šå¥½çš„ hash ç®—æ³•è®¡ç®—æ¡æ‰‹æ¶ˆæ¯ï¼Œç„¶åç”¨ç”Ÿæˆçš„å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼Œç„¶åä¸€èµ·å‘é€ç»™æœåŠ¡å™¨ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;æœåŠ¡å™¨æ¥æ”¶åˆ°å®¢æˆ·ç«¯ä¼ é€æ¥çš„ä¿¡æ¯ï¼Œè¦åšä¸‹é¢çš„äº‹æƒ…ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;4.1 ç”¨ç§é’¥è§£æå‡ºå¯†ç ï¼Œç”¨å¯†ç è§£ææ¡æ‰‹æ¶ˆæ¯ï¼ŒéªŒè¯ hash å€¼æ˜¯å¦å’Œæµè§ˆå™¨å‘æ¥çš„ä¸€è‡´ï¼›&lt;/li&gt;
&lt;li&gt;4.2 ä½¿ç”¨å¯†é’¥åŠ å¯†æ¶ˆæ¯ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;å¦‚æœè®¡ç®—æ³• hash å€¼ä¸€è‡´ï¼Œæ¡æ‰‹æˆåŠŸã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;38-http-å’Œ-https-çš„åŒºåˆ«&#34;&gt;&lt;strong&gt;38ã€HTTP å’Œ HTTPS çš„åŒºåˆ«ï¼Ÿ&lt;/strong&gt;&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;å¼€é”€ï¼šHTTPS åè®®éœ€è¦åˆ° CA ç”³è¯·è¯ä¹¦ï¼Œä¸€èˆ¬å…è´¹è¯ä¹¦å¾ˆå°‘ï¼Œéœ€è¦äº¤è´¹ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;èµ„æºæ¶ˆè€—ï¼šHTTP æ˜¯è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œä¿¡æ¯æ˜¯æ˜æ–‡ä¼ è¾“ï¼ŒHTTPS åˆ™æ˜¯å…·æœ‰å®‰å…¨æ€§çš„ ssl åŠ å¯†ä¼ è¾“åè®®ï¼Œéœ€è¦æ¶ˆè€—æ›´å¤šçš„ CPU å’Œå†…å­˜èµ„æºï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç«¯å£ä¸åŒï¼šHTTP å’Œ HTTPS ä½¿ç”¨çš„æ˜¯å®Œå…¨ä¸åŒçš„è¿æ¥æ–¹å¼ï¼Œç”¨çš„ç«¯å£ä¹Ÿä¸ä¸€æ ·ï¼Œå‰è€…æ˜¯Â  80ï¼Œåè€…æ˜¯ 443ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å®‰å…¨æ€§ï¼šHTTP çš„è¿æ¥å¾ˆç®€å•ï¼Œæ˜¯æ— çŠ¶æ€çš„ï¼›HTTPS åè®®æ˜¯ç”± TSL+HTTP åè®®æ„å»ºçš„å¯è¿›è¡ŒåŠ å¯†ä¼ è¾“ã€èº«ä»½è®¤è¯çš„ç½‘ç»œåè®®ï¼Œæ¯” HTTP åè®®å®‰å…¨ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;39-https-çš„ä¼˜ç¼ºç‚¹&#34;&gt;&lt;strong&gt;39ã€HTTPS çš„ä¼˜ç¼ºç‚¹ï¼Ÿ&lt;/strong&gt;&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹ï¼š&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;ä½¿ç”¨ HTTPS åè®®å¯è®¤è¯ç”¨æˆ·å’ŒæœåŠ¡å™¨ï¼Œç¡®ä¿æ•°æ®å‘é€åˆ°æ­£ç¡®çš„å®¢æˆ·æœºå’ŒæœåŠ¡å™¨ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;HTTPS åè®®æ˜¯ç”± SSL + HTTP åè®®æ„å»ºçš„å¯è¿›è¡ŒåŠ å¯†ä¼ è¾“ã€èº«ä»½è®¤è¯çš„ç½‘ç»œåè®®ï¼Œè¦æ¯” HTTP åè®®å®‰å…¨ï¼Œå¯é˜²æ­¢æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¸è¢«çªƒå–ã€æ”¹å˜ï¼Œç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;HTTPS æ˜¯ç°è¡Œæ¶æ„ä¸‹æœ€å®‰å…¨çš„è§£å†³æ–¹æ¡ˆï¼Œè™½ç„¶ä¸æ˜¯ç»å¯¹å®‰å…¨ï¼Œä½†å®ƒå¤§å¹…å¢åŠ äº†ä¸­é—´äººæ”»å‡»çš„æˆæœ¬ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹ï¼š&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;HTTPS åè®®æ¡æ‰‹é˜¶æ®µæ¯”è¾ƒè´¹æ—¶ï¼Œä¼šä½¿é¡µé¢çš„åŠ è½½æ—¶é—´å»¶é•¿è¿‘ 50%ï¼Œå¢åŠ  10% åˆ° 20% çš„è€—ç”µï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;HTTPS è¿æ¥ç¼“å­˜ä¸å¦‚ HTTP é«˜æ•ˆï¼Œä¼šå¢åŠ æ•°æ®å¼€é”€å’ŒåŠŸè€—ï¼Œç”šè‡³å·²æœ‰çš„å®‰å…¨æªæ–½ä¹Ÿä¼šå› æ­¤è€Œå—åˆ°å½±å“ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;SSL è¯ä¹¦éœ€è¦é’±ï¼ŒåŠŸèƒ½è¶Šå¼ºå¤§çš„è¯ä¹¦è´¹ç”¨è¶Šé«˜ï¼Œä¸ªäººç½‘ç«™ã€å°ç½‘ç«™æ²¡æœ‰å¿…è¦ä¸€èˆ¬ä¸ä¼šç”¨ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;SSL è¯ä¹¦é€šå¸¸éœ€è¦ç»‘å®š IPï¼Œä¸èƒ½åœ¨åŒä¸€ IP ä¸Šç»‘å®šå¤šä¸ªåŸŸåï¼ŒIPv4 èµ„æºä¸å¯èƒ½æ”¯æ’‘è¿™ä¸ªæ¶ˆè€—ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;HTTPS åè®®çš„åŠ å¯†èŒƒå›´ä¹Ÿæ¯”è¾ƒæœ‰é™ï¼Œåœ¨é»‘å®¢æ”»å‡»ã€æ‹’ç»æœåŠ¡æ”»å‡»ã€æœåŠ¡å™¨åŠ«æŒç­‰æ–¹é¢å‡ ä¹èµ·ä¸åˆ°ä»€ä¹ˆä½œç”¨ã€‚æœ€å…³é”®çš„ï¼ŒSSL è¯ä¹¦çš„ä¿¡ç”¨é“¾ä½“ç³»å¹¶ä¸å®‰å…¨ï¼Œç‰¹åˆ«æ˜¯åœ¨æŸäº›å›½å®¶å¯ä»¥æ§åˆ¶ CA æ ¹è¯ä¹¦çš„æƒ…å†µä¸‹ï¼Œä¸­é—´äººæ”»å‡»ä¸€æ ·å¯è¡Œã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;40-ä»€ä¹ˆæ˜¯æ•°å­—ç­¾å&#34;&gt;&lt;strong&gt;40ã€ä»€ä¹ˆæ˜¯æ•°å­—ç­¾åï¼Ÿ&lt;/strong&gt;&lt;/h1&gt;
&lt;p&gt;ä¸ºäº†é¿å…æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­è¢«æ›¿æ¢ï¼Œæ¯”å¦‚é»‘å®¢ä¿®æ”¹äº†ä½ çš„æŠ¥æ–‡å†…å®¹ï¼Œä½†æ˜¯ä½ å¹¶ä¸çŸ¥é“ï¼Œæ‰€ä»¥æˆ‘ä»¬è®©å‘é€ç«¯åšä¸€ä¸ªæ•°å­—ç­¾åï¼ŒæŠŠæ•°æ®çš„æ‘˜è¦æ¶ˆæ¯è¿›è¡Œä¸€ä¸ªåŠ å¯†ï¼Œæ¯”å¦‚ MD5ï¼Œå¾—åˆ°ä¸€ä¸ªç­¾åï¼Œå’Œæ•°æ®ä¸€èµ·å‘é€ã€‚ç„¶åæ¥æ”¶ç«¯æŠŠæ•°æ®æ‘˜è¦è¿›è¡Œ MD5 åŠ å¯†ï¼Œå¦‚æœå’Œç­¾åä¸€æ ·ï¼Œåˆ™è¯´æ˜æ•°æ®ç¡®å®æ˜¯çœŸçš„ã€‚&lt;/p&gt;
&lt;h1 id=&#34;41-ä»€ä¹ˆæ˜¯æ•°å­—è¯ä¹¦&#34;&gt;&lt;strong&gt;41ã€ä»€ä¹ˆæ˜¯æ•°å­—è¯ä¹¦ï¼Ÿ&lt;/strong&gt;&lt;/h1&gt;
&lt;p&gt;å¯¹ç§°åŠ å¯†ä¸­ï¼ŒåŒæ–¹ä½¿ç”¨å…¬é’¥è¿›è¡Œè§£å¯†ã€‚è™½ç„¶æ•°å­—ç­¾åå¯ä»¥ä¿è¯æ•°æ®ä¸è¢«æ›¿æ¢ï¼Œä½†æ˜¯æ•°æ®æ˜¯ç”±å…¬é’¥åŠ å¯†çš„ï¼Œå¦‚æœå…¬é’¥ä¹Ÿè¢«æ›¿æ¢ï¼Œåˆ™ä»ç„¶å¯ä»¥ä¼ªé€ æ•°æ®ï¼Œå› ä¸ºç”¨æˆ·ä¸çŸ¥é“å¯¹æ–¹æä¾›çš„å…¬é’¥å…¶å®æ˜¯å‡çš„ã€‚æ‰€ä»¥ä¸ºäº†ä¿è¯å‘é€æ–¹çš„å…¬é’¥æ˜¯çœŸçš„ï¼ŒCA è¯ä¹¦æœºæ„ä¼šè´Ÿè´£é¢å‘ä¸€ä¸ªè¯ä¹¦ï¼Œé‡Œé¢çš„å…¬é’¥ä¿è¯æ˜¯çœŸçš„ï¼Œç”¨æˆ·è¯·æ±‚æœåŠ¡å™¨æ—¶ï¼ŒæœåŠ¡å™¨å°†è¯ä¹¦å‘ç»™ç”¨æˆ·ï¼Œè¿™ä¸ªè¯ä¹¦æ˜¯ç»ç”±ç³»ç»Ÿå†…ç½®è¯ä¹¦çš„å¤‡æ¡ˆçš„ã€‚&lt;/p&gt;
&lt;h1 id=&#34;42-ä»€ä¹ˆæ˜¯å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†&#34;&gt;&lt;strong&gt;42ã€ä»€ä¹ˆæ˜¯å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†ï¼Ÿ&lt;/strong&gt;&lt;/h1&gt;
&lt;p&gt;å¯¹ç§°å¯†é’¥åŠ å¯†æ˜¯æŒ‡&lt;strong&gt;åŠ å¯†å’Œè§£å¯†ä½¿ç”¨åŒä¸€ä¸ªå¯†é’¥&lt;/strong&gt;çš„æ–¹å¼ï¼Œè¿™ç§æ–¹å¼å­˜åœ¨çš„æœ€å¤§é—®é¢˜å°±æ˜¯å¯†é’¥å‘é€é—®é¢˜ï¼Œå³å¦‚ä½•&lt;strong&gt;å®‰å…¨åœ°å°†å¯†é’¥å‘ç»™å¯¹æ–¹&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;éå¯¹ç§°åŠ å¯†æŒ‡ä½¿ç”¨ä¸€å¯¹éå¯¹ç§°å¯†é’¥ï¼Œå³ï¼šå…¬é’¥å’Œç§é’¥ï¼Œå…¬é’¥å¯ä»¥éšæ„å‘å¸ƒï¼Œä½†ç§é’¥åªæœ‰è‡ªå·±çŸ¥é“ã€‚å‘é€å¯†æ–‡çš„ä¸€æ–¹ä½¿ç”¨å¯¹æ–¹çš„&lt;strong&gt;å…¬é’¥&lt;/strong&gt;è¿›è¡Œ&lt;strong&gt;åŠ å¯†&lt;/strong&gt;å¤„ç†ï¼Œå¯¹æ–¹æ¥æ”¶åˆ°åŠ å¯†ä¿¡æ¯åï¼Œä½¿ç”¨è‡ªå·±çš„&lt;strong&gt;ç§é’¥&lt;/strong&gt;è¿›è¡Œ&lt;strong&gt;è§£å¯†&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºéå¯¹ç§°åŠ å¯†çš„æ–¹å¼ä¸éœ€è¦å‘é€ç”¨æ¥è§£å¯†çš„ç§é’¥ï¼Œæ‰€ä»¥å¯ä»¥ä¿è¯å®‰å…¨æ€§ã€‚ä½†æ˜¯å’Œå¯¹ç§°åŠ å¯†æ¯”èµ·æ¥ï¼Œå®ƒéå¸¸çš„æ…¢ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜æ˜¯è¦ç”¨å¯¹ç§°åŠ å¯†æ¥ä¼ é€æ¶ˆæ¯ï¼Œä½†å¯¹ç§°åŠ å¯†æ‰€ä½¿ç”¨çš„å¯†é’¥æˆ‘ä»¬å¯ä»¥é€šè¿‡éå¯¹ç§°åŠ å¯†çš„æ–¹å¼å‘é€å‡ºå»ã€‚&lt;/p&gt;
&lt;p&gt;é™„ï¼šè®¡ç½‘æ€ç»´å¯¼å›¾&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
é“¾æ¥ï¼š&lt;a href=&#34;https://pan.baidu.com/s/1Tcrix2jNpqlS6QyobotIXw&#34;&gt;https://pan.baidu.com/s/1Tcrix2jNpqlS6QyobotIXw &lt;/a&gt;&lt;br&gt;
æå–ç ï¼š4l3t&lt;/p&gt;
&lt;h1 id=&#34;å‚è€ƒé“¾æ¥&#34;&gt;å‚è€ƒé“¾æ¥&lt;/h1&gt;
&lt;p&gt;&lt;a href=&#34;https://mp.weixin.qq.com/s/Gy4ElItSvBoeQnN4YbMPGQ&#34;&gt;https://mp.weixin.qq.com/s/Gy4ElItSvBoeQnN4YbMPGQ&lt;/a&gt;&lt;/p&gt;
">42é“è®¡ç®—æœºç½‘ç»œé¢è¯•é«˜é¢‘é¢˜+ç­”æ¡ˆ</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/mian-shi-ti-threadlocal/"" data-c="
          &lt;h1 id=&#34;ä¸€-threadlocal-ä»‹ç»&#34;&gt;ä¸€ã€ThreadLocal ä»‹ç»&lt;/h1&gt;
&lt;h2 id=&#34;11-å®˜æ–¹ä»‹ç»&#34;&gt;1.1 å®˜æ–¹ä»‹ç»&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;/**
 * This class provides thread-local variables.  These variables differ from
 * their normal counterparts in that each thread that accesses one (via its
 * {@code get} or {@code set} method) has its own, independently initialized
 * copy of the variable.  {@code ThreadLocal} instances are typically private
 * static fields in classes that wish to associate state with a thread (e.g.,
 * a user ID or Transaction ID).
 *
 * &amp;lt;p&amp;gt;For example, the class below generates unique identifiers local to each
 * thread.
 * A thread&#39;s id is assigned the first time it invokes {@code ThreadId.get()}
 * and remains unchanged on subsequent calls.
 * &amp;lt;pre&amp;gt;
 * import java.util.concurrent.atomic.AtomicInteger;
 *
 * public class ThreadId {
 *     // Atomic integer containing the next thread ID to be assigned
 *     private static final AtomicInteger nextId = new AtomicInteger(0);
 *
 *     // Thread local variable containing each thread&#39;s ID
 *     private static final ThreadLocal&amp;amp;lt;Integer&amp;amp;gt; threadId =
 *         new ThreadLocal&amp;amp;lt;Integer&amp;amp;gt;() {
 *             &amp;amp;#64;Override protected Integer initialValue() {
 *                 return nextId.getAndIncrement();
 *         }
 *     };
 *
 *     // Returns the current thread&#39;s unique ID, assigning it if necessary
 *     public static int get() {
 *         return threadId.get();
 *     }
 * }
 * &amp;lt;/pre&amp;gt;
 * &amp;lt;p&amp;gt;Each thread holds an implicit reference to its copy of a thread-local
 * variable as long as the thread is alive and the {@code ThreadLocal}
 * instance is accessible; after a thread goes away, all of its copies of
 * thread-local instances are subject to garbage collection (unless other
 * references to these copies exist).
 *
 * @author  Josh Bloch and Doug Lea
 * @since   1.2
 */
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä» Java å®˜æ–¹æ–‡æ¡£ä¸­çš„æè¿°ï¼š&lt;code&gt;ThreadLocal&lt;/code&gt;ç±»ç”¨æ¥æä¾›&lt;strong&gt;çº¿ç¨‹å†…éƒ¨çš„å±€éƒ¨å˜é‡&lt;/strong&gt;ã€‚è¿™ç§å˜é‡åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹è®¿é—®ï¼ˆé€šè¿‡&lt;code&gt;get&lt;/code&gt;å’Œ&lt;code&gt;set&lt;/code&gt;æ–¹æ³•è®¿é—®ï¼‰æ—¶èƒ½ä¿è¯å„ä¸ªçº¿ç¨‹çš„å˜é‡ç›¸å¯¹ç‹¬ç«‹äºå…¶ä»–çº¿ç¨‹å†…çš„å˜é‡ã€‚&lt;code&gt;ThreadLocal&lt;/code&gt;å®ä¾‹é€šå¸¸æ¥è¯´éƒ½æ˜¯&lt;code&gt;private static&lt;/code&gt;ç±»å‹çš„ï¼Œç”¨äºå…³è”çº¿ç¨‹å’Œçº¿ç¨‹ä¸Šä¸‹æ–‡ã€‚&lt;br&gt;
æˆ‘ä»¬å¯ä»¥å¾—çŸ¥&lt;code&gt;ThreadLocal&lt;/code&gt;çš„ä½œç”¨æ˜¯ï¼šæä¾›çº¿ç¨‹å†…çš„å±€éƒ¨å˜é‡ï¼Œä¸åŒçš„çº¿ç¨‹ä¹‹é—´ä¸ä¼šç›¸äº’å¹²æ‰°ï¼Œè¿™ç§å˜é‡åœ¨çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸå†…èµ·ä½œç”¨ï¼Œå‡å°‘åŒä¸€ä¸ªçº¿ç¨‹å†…å¤šä¸ªå‡½æ•°æˆ–ç»„ä»¶ä¹‹é—´ä¸€äº›å…¬å…±å˜é‡ä¼ é€’çš„å¤æ‚åº¦ã€‚&lt;/p&gt;
&lt;p&gt;æ€»ç»“ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;çº¿ç¨‹å¹¶å‘ï¼šåœ¨å¤šå¹¶å‘çš„åœºæ™¯ä¸‹&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¼ é€’æ•°æ®ï¼šæˆ‘ä»¬å¯ä»¥é€šè¿‡ &lt;code&gt;ThreadLocal&lt;/code&gt; åœ¨åŒä¸€çº¿ç¨‹ï¼Œä¸åŒç»„ä»¶ä¸­ä¼ é€’å…¬å…±å˜é‡&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;çº¿ç¨‹éš”ç¦»ï¼šæ¯ä¸ªçº¿ç¨‹çš„å˜é‡éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œä¸ä¼šäº’ç›¸å½±å“ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;12-åŸºæœ¬ä½¿ç”¨&#34;&gt;1.2 åŸºæœ¬ä½¿ç”¨&lt;/h2&gt;
&lt;h3 id=&#34;121-å¸¸ç”¨æ–¹æ³•&#34;&gt;1.2.1 å¸¸ç”¨æ–¹æ³•&lt;/h3&gt;
&lt;p&gt;åœ¨ä½¿ç”¨ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥è®¤è¯†å‡ ä¸ª &lt;code&gt;ThreadLoal&lt;/code&gt; çš„å¸¸ç”¨æ–¹æ³•&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;&lt;strong&gt;æ–¹æ³•å£°æ˜&lt;/strong&gt;&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;&lt;strong&gt;æè¿°&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ThreadLocal()&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;åˆ›å»º ThreadLocal å¯¹è±¡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;public void set(T value)&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è®¾ç½®å½“å‰çº¿ç¨‹ç»‘å®šçš„å±€éƒ¨å˜é‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;public T get()&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è·å–å½“å‰çº¿ç¨‹ç»‘å®šçš„å±€éƒ¨å˜é‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;public void remove()&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ç§»é™¤å½“å‰çº¿ç¨‹ç»‘å®šçš„å±€éƒ¨å˜é‡&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;122-ä½¿ç”¨æ¡ˆåˆ—&#34;&gt;1.2.2 ä½¿ç”¨æ¡ˆåˆ—&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;package com.ssm.threadlocal;
/**
 * éœ€æ±‚ï¼šçº¿ç¨‹éš”ç¦»
 *  åœ¨å¤šçº¿ç¨‹å¹¶å‘çš„åœºæ™¯ä¸‹ï¼Œæ¯ä¸ªçº¿ç¨‹ä¸­çš„å˜é‡éƒ½æ˜¯äº’ç›¸ç‹¬ç«‹
 *      çº¿ç¨‹ Aï¼šè®¾ç½®(å˜é‡1)    è·å–(å˜é‡1)
 *      çº¿ç¨‹ Bï¼šè®¾ç½®(å˜é‡2)    è·å–(å˜é‡2)
 */
public class MyDemo01 {
    private String content;
    private String getContent(){
        return content;
    }
    private void setContent(String content){
        this.content = content;
    }

    public static void main(String[] args) {
        MyDemo01 demo = new MyDemo01();
        for (int i = 0; i &amp;lt; 5; i++) {
            Thread thread = new Thread(()-&amp;gt;{
                /*
                    æ¯ä¸ªçº¿ç¨‹ï¼šå­˜ä¸€ä¸ªå˜é‡ï¼Œè¿‡ä¸€ä¼š å–å‡ºè¿™ä¸ªå˜é‡
                 */
                demo.setContent(Thread.currentThread().getName() + &amp;quot;çš„æ•°æ®&amp;quot;);
                System.out.println(&amp;quot; ---------------- &amp;quot;);
                System.out.println(Thread.currentThread().getName() + &amp;quot;---&amp;gt;&amp;quot; + demo.getContent());
            });
            thread.setName(&amp;quot;çº¿ç¨‹&amp;quot; + i);
            thread.start();
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼šéƒ¨åˆ†çº¿ç¨‹å–å‡ºçš„æ•°æ® ä¸ å®ƒå­˜å…¥çš„æ•°æ®ä¸ä¸€æ ·&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Â ----------------Â 
Â ----------------Â 
çº¿ç¨‹2---&amp;gt;çº¿ç¨‹3çš„æ•°æ®
Â ----------------Â 
çº¿ç¨‹1---&amp;gt;çº¿ç¨‹4çš„æ•°æ®
Â ----------------Â 
çº¿ç¨‹4---&amp;gt;çº¿ç¨‹4çš„æ•°æ®
çº¿ç¨‹0---&amp;gt;çº¿ç¨‹2çš„æ•°æ®
Â ----------------Â 
çº¿ç¨‹3---&amp;gt;çº¿ç¨‹4çš„æ•°æ®
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»ç»“æœå¯ä»¥çœ‹å‡ºå¤šä¸ªçº¿ç¨‹åœ¨è®¿é—®åŒä¸€ä¸ªå˜é‡çš„æ—¶å€™å‡ºç°çš„å¼‚å¸¸ï¼Œçº¿ç¨‹é—´çš„æ•°æ®æ²¡æœ‰éš”ç¦»ã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸‹é‡‡ç”¨ ThreadLocal çš„æ–¹å¼æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„ä¾‹å­ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;package com.ssm.threadlocal;

/**
 * éœ€æ±‚ï¼šçº¿ç¨‹éš”ç¦»
 *  åœ¨å¤šçº¿ç¨‹å¹¶å‘çš„åœºæ™¯ä¸‹ï¼Œæ¯ä¸ªçº¿ç¨‹ä¸­çš„å˜é‡éƒ½æ˜¯äº’ç›¸ç‹¬ç«‹
 *      çº¿ç¨‹ Aï¼šè®¾ç½®(å˜é‡1)    è·å–(å˜é‡1)
 *      çº¿ç¨‹ Bï¼šè®¾ç½®(å˜é‡2)    è·å–(å˜é‡2)
 *
 *      ThreadLocal:
 *          1.set()ï¼šå°†å˜é‡ç»‘å®šåˆ°å½“å‰çº¿ç¨‹ä¸­ï¼›
 *          2.get()ï¼šè·å–å½“å‰çº¿ç¨‹ç»‘å®šçš„å˜é‡
 */
public class MyDemo01 {
    ThreadLocal&amp;lt;String&amp;gt; threadLocal = new ThreadLocal&amp;lt;&amp;gt;();
    private String getContent(){
        return threadLocal.get();
    }
    private void setContent(String content){
        // å˜é‡ç»‘å®šåˆ°å½“å‰çº¿ç¨‹ä¸­
        threadLocal.set(content);
    }

    public static void main(String[] args) {
        MyDemo01 demo = new MyDemo01();
        for (int i = 0; i &amp;lt; 5; i++) {
            Thread thread = new Thread(()-&amp;gt;{
                /*
                    æ¯ä¸ªçº¿ç¨‹ï¼šå­˜ä¸€ä¸ªå˜é‡ï¼Œè¿‡ä¸€ä¼š å–å‡ºè¿™ä¸ªå˜é‡
                 */
                demo.setContent(Thread.currentThread().getName() + &amp;quot;çš„æ•°æ®&amp;quot;);
                System.out.println(&amp;quot; ---------------- &amp;quot;);
                System.out.println(Thread.currentThread().getName() + &amp;quot;---&amp;gt;&amp;quot; + demo.getContent());
            });
            thread.setName(&amp;quot;çº¿ç¨‹&amp;quot; + i);
            thread.start();
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Â ----------------Â 
Â ----------------Â 
çº¿ç¨‹3---&amp;gt;çº¿ç¨‹3çš„æ•°æ®
Â ----------------Â 
çº¿ç¨‹2---&amp;gt;çº¿ç¨‹2çš„æ•°æ®
Â ----------------Â 
Â ----------------Â 
çº¿ç¨‹4---&amp;gt;çº¿ç¨‹4çš„æ•°æ®
çº¿ç¨‹0---&amp;gt;çº¿ç¨‹0çš„æ•°æ®
çº¿ç¨‹1---&amp;gt;çº¿ç¨‹1çš„æ•°æ®
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»ç»“æœæ¥çœ‹ï¼Œè¿™æ ·å¾ˆå¥½çš„è§£å†³äº†å¤šçº¿ç¨‹ä¹‹é—´æ•°æ®éš”ç¦»çš„é—®é¢˜ï¼Œååˆ†æ–¹ä¾¿ã€‚&lt;/p&gt;
&lt;h2 id=&#34;13-threadlocal-ä¸-synchronized-å…³é”®å­—&#34;&gt;1.3 ThreadLocal ä¸ synchronized å…³é”®å­—&lt;/h2&gt;
&lt;h3 id=&#34;131-synchronized-åŒæ­¥æ–¹å¼&#34;&gt;1.3.1 synchronized åŒæ­¥æ–¹å¼&lt;/h3&gt;
&lt;p&gt;è¿™é‡Œå¯èƒ½æœ‰çš„æœ‹å‹ä¼šè§‰å¾—åœ¨ä¸Šè¿°ä¾‹å­ä¸­æˆ‘ä»¬å®Œå…¨å¯ä»¥é€šè¿‡åŠ é”æ¥å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚æˆ‘ä»¬é¦–å…ˆæ¥çœ‹ä¸€ä¸‹ç”¨synchronizedä»£ç å—å®ç°çš„æ•ˆæœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;package com.ssm.threadlocal;

/**
 * éœ€æ±‚ï¼šçº¿ç¨‹éš”ç¦»
 *  åœ¨å¤šçº¿ç¨‹å¹¶å‘çš„åœºæ™¯ä¸‹ï¼Œæ¯ä¸ªçº¿ç¨‹ä¸­çš„å˜é‡éƒ½æ˜¯äº’ç›¸ç‹¬ç«‹
 *      çº¿ç¨‹ Aï¼šè®¾ç½®(å˜é‡1)    è·å–(å˜é‡1)
 *      çº¿ç¨‹ Bï¼šè®¾ç½®(å˜é‡2)    è·å–(å˜é‡2)
 */
public class MyDemo02 {
    private String content;
    private String getContent(){
        return content;
    }
    private void setContent(String content){
        this.content = content;
    }

    public static void main(String[] args) {
        MyDemo02 demo = new MyDemo02();
        for (int i = 0; i &amp;lt; 5; i++) {
            Thread thread = new Thread(()-&amp;gt;{
                /*
                    æ¯ä¸ªçº¿ç¨‹ï¼šå­˜ä¸€ä¸ªå˜é‡ï¼Œè¿‡ä¸€ä¼š å–å‡ºè¿™ä¸ªå˜é‡
                 */
                synchronized (MyDemo02.class){
                    demo.setContent(Thread.currentThread().getName() + &amp;quot;çš„æ•°æ®&amp;quot;);
                    System.out.println(&amp;quot; ---------------- &amp;quot;);
                    System.out.println(Thread.currentThread().getName() + &amp;quot;---&amp;gt;&amp;quot; + demo.getContent());
                }

            });
            thread.setName(&amp;quot;çº¿ç¨‹&amp;quot; + i);
            thread.start();
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»ç»“æœå¯ä»¥å‘ç°ï¼ŒåŠ é”ç¡®å®å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯åœ¨è¿™é‡Œæˆ‘ä»¬å¼ºè°ƒçš„æ˜¯&lt;strong&gt;çº¿ç¨‹æ•°æ®éš”ç¦»&lt;/strong&gt;çš„é—®é¢˜ï¼Œå¹¶ä¸æ˜¯&lt;strong&gt;å¤šçº¿ç¨‹å…±äº«æ•°æ®çš„&lt;/strong&gt;é—®é¢˜ï¼Œåœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­ä½¿ç”¨&lt;code&gt;synchronized&lt;/code&gt;å…³é”®å­—æ˜¯ä¸åˆé€‚çš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;132-threadlocal-ä¸-synchronized-å…³é”®å­—çš„åŒºåˆ«&#34;&gt;1.3.2 ThreadLocal ä¸ synchronized å…³é”®å­—çš„åŒºåˆ«&lt;/h3&gt;
&lt;p&gt;è™½ç„¶T&lt;code&gt;hreadLocal&lt;/code&gt;æ¨¡å¼ä¸&lt;code&gt;synchronized&lt;/code&gt;å…³é”®å­—éƒ½ç”¨äºå¤„ç†å¤šçº¿ç¨‹å¹¶å‘è®¿é—®å˜é‡çš„é—®é¢˜ï¼Œä¸è¿‡ä¸¤è€…å¤„ç†é—®é¢˜çš„è§’åº¦å’Œæ€è·¯ä¸åŒã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;synchronized&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;ThreadLocal&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;åŸç†&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;åŒæ­¥æœºåˆ¶é‡‡ç”¨ â€œ&lt;strong&gt;ä»¥æ—¶é—´æ¢ç©ºé—´&lt;/strong&gt;â€ çš„æ–¹å¼ï¼Œåªæä¾›äº†ä¸€åˆ†å˜é‡ï¼Œè®©ä¸ç”¨çš„çº¿ç¨‹æ´¾å¯¹è®¿é—®&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ThreadLocal é‡‡ç”¨ â€œ&lt;strong&gt;ä»¥ç©ºé—´æ¢æ—¶é—´&lt;/strong&gt;â€ çš„æ–¹å¼ï¼Œä¸ºæ¯ä¸€ä¸ªçº¿ç¨‹éƒ½æä¾›äº†ä¸€ä»½å˜é‡çš„å‰¯æœ¬ï¼Œä»è€Œå®ç°åŒæ—¶è®¿é—®äº’ä¸å¹²æ‰°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ä¾§é‡ç‚¹&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å¤šä¸ªçº¿ç¨‹ä¹‹é—´è®¿é—®èµ„æºçš„åŒæ­¥&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å¤šçº¿ç¨‹ä¸­è®©æ¯ä¸ªçº¿ç¨‹ä¹‹é—´çš„æ•°æ®ç›¸äº’éš”ç¦»&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;æ€»ç»“ï¼šåœ¨åˆšåˆšçš„æ¡ˆä¾‹ä¸­ï¼Œè™½ç„¶ä½¿ç”¨&lt;code&gt;ThreadLocal&lt;/code&gt;å’Œ&lt;code&gt;synchronized&lt;/code&gt;éƒ½èƒ½è§£å†³é—®é¢˜ï¼Œä½†æ˜¯ä½¿ç”¨&lt;code&gt;ThreadLocal&lt;/code&gt;æ›´ä¸ºåˆé€‚ï¼Œå› ä¸ºè¿™æ ·å¯ä»¥ä½¿ç¨‹åºæ‹¥æœ‰æ›´é«˜çš„å¹¶å‘æ€§ã€‚&lt;/p&gt;
&lt;h1 id=&#34;äºŒ-è¿ç”¨åœºæ™¯_äº‹åŠ¡æ¡ˆä¾‹&#34;&gt;äºŒã€ è¿ç”¨åœºæ™¯_äº‹åŠ¡æ¡ˆä¾‹&lt;/h1&gt;
&lt;p&gt;â€‹é€šè¿‡ä»¥ä¸Šçš„ä»‹ç»ï¼Œæˆ‘ä»¬å·²ç»åŸºæœ¬äº†è§£&lt;code&gt;ThreadLocal&lt;/code&gt;çš„ç‰¹ç‚¹ã€‚ä½†æ˜¯å®ƒå…·ä½“æ˜¯è¿ç”¨åœ¨ä»€ä¹ˆåœºæ™¯ä¸­å‘¢ï¼Ÿ æ¥ä¸‹æ¥è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªæ¡ˆä¾‹ï¼š äº‹åŠ¡æ“ä½œã€‚&lt;/p&gt;
&lt;h2 id=&#34;21-è½¬è´¦æ¡ˆä¾‹&#34;&gt;2.1 è½¬è´¦æ¡ˆä¾‹&lt;/h2&gt;
&lt;h3 id=&#34;211-åœºæ™¯æ„å»º&#34;&gt;2.1.1 åœºæ™¯æ„å»º&lt;/h3&gt;
&lt;p&gt;â€‹è¿™é‡Œæˆ‘ä»¬å…ˆæ„å»ºä¸€ä¸ªç®€å•çš„è½¬è´¦åœºæ™¯ï¼š æœ‰ä¸€ä¸ªæ•°æ®è¡¨&lt;code&gt;account&lt;/code&gt;ï¼Œé‡Œé¢æœ‰ä¸¤ä¸ªç”¨æˆ·&lt;code&gt;Jack&lt;/code&gt;å’Œ&lt;code&gt;Rose&lt;/code&gt;ï¼Œç”¨æˆ·&lt;code&gt;Jack&lt;/code&gt;  ç»™ç”¨æˆ·&lt;code&gt;Rose&lt;/code&gt; è½¬è´¦ã€‚&lt;/p&gt;
&lt;p&gt;æ¡ˆä¾‹çš„å®ç°ä¸»è¦ç”¨&lt;code&gt;mysql&lt;/code&gt;æ•°æ®åº“ï¼Œ&lt;code&gt;JDBC&lt;/code&gt; å’Œ &lt;code&gt;C3P0&lt;/code&gt; æ¡†æ¶ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†ä»£ç  ï¼š&lt;/p&gt;
&lt;p&gt;ï¼ˆ1ï¼‰ é¡¹ç›®ç»“æ„&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/001.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ï¼ˆ2ï¼‰ æ•°æ®å‡†å¤‡&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-sql&#34;&gt;-- ä½¿ç”¨æ•°æ®åº“
use test;
-- åˆ›å»ºä¸€å¼ è´¦æˆ·è¡¨
create table account(
	id int primary key auto_increment,
	name varchar(20),
	money double
);
-- åˆå§‹åŒ–æ•°æ®
insert into account values(null, &#39;Jack&#39;, 1000);
insert into account values(null, &#39;Rose&#39;, 0);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ï¼ˆ3ï¼‰ C3P0é…ç½®æ–‡ä»¶å’Œå·¥å…·ç±»&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-xml&#34;&gt;&amp;lt;c3p0-config&amp;gt;
  &amp;lt;!-- ä½¿ç”¨é»˜è®¤çš„é…ç½®è¯»å–è¿æ¥æ± å¯¹è±¡ --&amp;gt;
  &amp;lt;default-config&amp;gt;
  	&amp;lt;!--  è¿æ¥å‚æ•° --&amp;gt;
    &amp;lt;property name=&amp;quot;driverClass&amp;quot;&amp;gt;com.mysql.jdbc.Driver&amp;lt;/property&amp;gt;
    &amp;lt;property name=&amp;quot;jdbcUrl&amp;quot;&amp;gt;jdbc:mysql://localhost:3306/test&amp;lt;/property&amp;gt;
    &amp;lt;property name=&amp;quot;user&amp;quot;&amp;gt;root&amp;lt;/property&amp;gt;
    &amp;lt;property name=&amp;quot;password&amp;quot;&amp;gt;1234&amp;lt;/property&amp;gt;
    
    &amp;lt;!-- è¿æ¥æ± å‚æ•° --&amp;gt;
    &amp;lt;property name=&amp;quot;initialPoolSize&amp;quot;&amp;gt;5&amp;lt;/property&amp;gt;
    &amp;lt;property name=&amp;quot;maxPoolSize&amp;quot;&amp;gt;10&amp;lt;/property&amp;gt;
    &amp;lt;property name=&amp;quot;checkoutTimeout&amp;quot;&amp;gt;3000&amp;lt;/property&amp;gt;
  &amp;lt;/default-config&amp;gt;

&amp;lt;/c3p0-config&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ï¼ˆ4ï¼‰ å·¥å…·ç±» ï¼š JdbcUtils&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.itheima.transfer.utils;

import com.mchange.v2.c3p0.ComboPooledDataSource;
import java.sql.Connection;
import java.sql.SQLException;

public class JdbcUtils {
    // c3p0 æ•°æ®åº“è¿æ¥æ± å¯¹è±¡å±æ€§
    private static final ComboPooledDataSource ds = new ComboPooledDataSource();
    // è·å–è¿æ¥
    public static Connection getConnection() throws SQLException {
        return ds.getConnection();
    }
    //é‡Šæ”¾èµ„æº
    public static void release(AutoCloseable... ios){
        for (AutoCloseable io : ios) {
            if(io != null){
                try {
                    io.close();
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        }
    }
    
    
    public static void commitAndClose(Connection conn) {
        try {
            if(conn != null){
                //æäº¤äº‹åŠ¡
                conn.commit();
                //é‡Šæ”¾è¿æ¥
                conn.close();
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }

    public static void rollbackAndClose(Connection conn) {
        try {
            if(conn != null){
                //å›æ»šäº‹åŠ¡
                conn.rollback();
                //é‡Šæ”¾è¿æ¥
                conn.close();
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ï¼ˆ5ï¼‰ daoå±‚ä»£ç  ï¼š AccountDao&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.itheima.transfer.dao;

import com.itheima.transfer.utils.JdbcUtils;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;

public class AccountDao {

    public void out(String outUser, int money) throws SQLException {
        String sql = &amp;quot;update account set money = money - ? where name = ?&amp;quot;;

        Connection conn = JdbcUtils.getConnection();
        PreparedStatement pstm = conn.prepareStatement(sql);
        pstm.setInt(1,money);
        pstm.setString(2,outUser);
        pstm.executeUpdate();

        JdbcUtils.release(pstm,conn);
    }

    public void in(String inUser, int money) throws SQLException {
        String sql = &amp;quot;update account set money = money + ? where name = ?&amp;quot;;

        Connection conn = JdbcUtils.getConnection();
        PreparedStatement pstm = conn.prepareStatement(sql);
        pstm.setInt(1,money);
        pstm.setString(2,inUser);
        pstm.executeUpdate();

        JdbcUtils.release(pstm,conn);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ï¼ˆ6ï¼‰ serviceå±‚ä»£ç  ï¼š AccountService&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.itheima.transfer.service;

import com.itheima.transfer.dao.AccountDao;
import java.sql.SQLException;

public class AccountService {

    public boolean transfer(String outUser, String inUser, int money) {
        AccountDao ad = new AccountDao();
        try {
            // è½¬å‡º
            ad.out(outUser, money);
            // è½¬å…¥
            ad.in(inUser, money);
        } catch (Exception e) {
            e.printStackTrace();
            return false;
        }
        return true;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ï¼ˆ7ï¼‰ webå±‚ä»£ç  ï¼š AccountWeb&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.itheima.transfer.web;

import com.itheima.transfer.service.AccountService;

public class AccountWeb {

    public static void main(String[] args) {
        // æ¨¡æ‹Ÿæ•°æ® : Jack ç»™ Rose è½¬è´¦ 100
        String outUser = &amp;quot;Jack&amp;quot;;
        String inUser = &amp;quot;Rose&amp;quot;;
        int money = 100;

        AccountService as = new AccountService();
        boolean result = as.transfer(outUser, inUser, money);

        if (result == false) {
            System.out.println(&amp;quot;è½¬è´¦å¤±è´¥!&amp;quot;);
        } else {
            System.out.println(&amp;quot;è½¬è´¦æˆåŠŸ!&amp;quot;);
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;212-å¼•å…¥äº‹åŠ¡&#34;&gt;2.1.2 å¼•å…¥äº‹åŠ¡&lt;/h3&gt;
&lt;p&gt;â€‹æ¡ˆä¾‹ä¸­çš„è½¬è´¦æ¶‰åŠä¸¤ä¸ªDMLæ“ä½œï¼š ä¸€ä¸ªè½¬å‡ºï¼Œä¸€ä¸ªè½¬å…¥ã€‚è¿™äº›æ“ä½œæ˜¯éœ€è¦å…·å¤‡åŸå­æ€§çš„ï¼Œä¸å¯åˆ†å‰²ã€‚ä¸ç„¶å°±æœ‰å¯èƒ½å‡ºç°æ•°æ®ä¿®æ”¹å¼‚å¸¸æƒ…å†µã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;public class AccountService {
    public boolean transfer(String outUser, String inUser, int money) {
        AccountDao ad = new AccountDao();
        try {
            // è½¬å‡º
            ad.out(outUser, money);
            // æ¨¡æ‹Ÿè½¬è´¦è¿‡ç¨‹ä¸­çš„å¼‚å¸¸
            int i = 1/0;
            // è½¬å…¥
            ad.in(inUser, money);
        } catch (Exception e) {
            e.printStackTrace();
            return false;
        }
        return true;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‰€ä»¥è¿™é‡Œå°±éœ€è¦æ“ä½œäº‹åŠ¡ï¼Œæ¥ä¿è¯è½¬å‡ºå’Œè½¬å…¥æ“ä½œå…·å¤‡åŸå­æ€§ï¼Œè¦ä¹ˆåŒæ—¶æˆåŠŸï¼Œè¦ä¹ˆåŒæ—¶å¤±è´¥ã€‚&lt;br&gt;
ï¼ˆ1ï¼‰ JDBCä¸­å…³äºäº‹åŠ¡çš„æ“ä½œçš„api&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Connectionæ¥å£çš„æ–¹æ³•&lt;/th&gt;
&lt;th&gt;ä½œç”¨&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;void  setAutoCommit(false)&lt;/td&gt;
&lt;td&gt;ç¦ç”¨äº‹åŠ¡è‡ªåŠ¨æäº¤ï¼ˆæ”¹ä¸ºæ‰‹åŠ¨ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;void  commit();&lt;/td&gt;
&lt;td&gt;æäº¤äº‹åŠ¡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;void rollback();&lt;/td&gt;
&lt;td&gt;å›æ»šäº‹åŠ¡&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ï¼ˆ2ï¼‰ &lt;strong&gt;å¼€å¯äº‹åŠ¡çš„æ³¨æ„ç‚¹&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ä¸ºäº†ä¿è¯æ‰€æœ‰çš„æ“ä½œåœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­,æ¡ˆä¾‹ä¸­ä½¿ç”¨çš„è¿æ¥å¿…é¡»æ˜¯åŒä¸€ä¸ª:  &lt;code&gt;service&lt;/code&gt;å±‚å¼€å¯äº‹åŠ¡çš„&lt;code&gt;connection&lt;/code&gt;éœ€è¦è·Ÿ&lt;code&gt;dao&lt;/code&gt;å±‚è®¿é—®æ•°æ®åº“çš„&lt;code&gt;connection&lt;/code&gt;ä¿æŒä¸€è‡´&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;çº¿ç¨‹å¹¶å‘æƒ…å†µä¸‹, æ¯ä¸ªçº¿ç¨‹åªèƒ½æ“ä½œå„è‡ªçš„ &lt;code&gt;connection&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;22-å¸¸è§„è§£å†³æ–¹æ¡ˆ&#34;&gt;2.2  å¸¸è§„è§£å†³æ–¹æ¡ˆ&lt;/h2&gt;
&lt;h3 id=&#34;221-å¸¸è§„æ–¹æ¡ˆçš„å®ç°&#34;&gt;2.2.1 å¸¸è§„æ–¹æ¡ˆçš„å®ç°&lt;/h3&gt;
&lt;p&gt;åŸºäºä¸Šé¢ç»™å‡ºçš„å‰æï¼Œ å¤§å®¶é€šå¸¸æƒ³åˆ°çš„è§£å†³æ–¹æ¡ˆæ˜¯ ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¼ å‚: ä»&lt;code&gt;service&lt;/code&gt;å±‚å°†&lt;code&gt;connection&lt;/code&gt;å¯¹è±¡å‘&lt;code&gt;dao&lt;/code&gt;å±‚ä¼ é€’&lt;/li&gt;
&lt;li&gt;åŠ é”&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯ä»£ç å®ç°ä¿®æ”¹çš„éƒ¨åˆ†ï¼š&lt;/p&gt;
&lt;p&gt;ï¼ˆ1 ) AccountService ç±»&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.itheima.transfer.service;

import com.itheima.transfer.dao.AccountDao;
import com.itheima.transfer.utils.JdbcUtils;
import java.sql.Connection;

public class AccountService {

    public boolean transfer(String outUser, String inUser, int money) {
        AccountDao ad = new AccountDao();
        //çº¿ç¨‹å¹¶å‘æƒ…å†µä¸‹,ä¸ºäº†ä¿è¯æ¯ä¸ªçº¿ç¨‹ä½¿ç”¨å„è‡ªçš„connection,æ•…åŠ é”
        synchronized (AccountService.class) {

            Connection conn = null;
            try {
                conn = JdbcUtils.getConnection();
                //å¼€å¯äº‹åŠ¡
                conn.setAutoCommit(false);
                // è½¬å‡º
                ad.out(conn, outUser, money);
                // æ¨¡æ‹Ÿè½¬è´¦è¿‡ç¨‹ä¸­çš„å¼‚å¸¸
//            int i = 1/0;
                // è½¬å…¥
                ad.in(conn, inUser, money);
                //äº‹åŠ¡æäº¤
                JdbcUtils.commitAndClose(conn);
            } catch (Exception e) {
                e.printStackTrace();
                //äº‹åŠ¡å›æ»š
                JdbcUtils.rollbackAndClose(conn);
                return false;
            }
            return true;
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ï¼ˆ2) AccountDao ç±» ï¼ˆè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼š connectionä¸èƒ½åœ¨daoå±‚é‡Šæ”¾ï¼Œè¦åœ¨serviceå±‚ï¼Œä¸ç„¶åœ¨daoå±‚é‡Šæ”¾ï¼Œserviceå±‚å°±æ— æ³•ä½¿ç”¨äº†ï¼‰&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.itheima.transfer.dao;

import com.itheima.transfer.utils.JdbcUtils;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;

public class AccountDao {

    public void out(Connection conn, String outUser, int money) throws SQLException{
        String sql = &amp;quot;update account set money = money - ? where name = ?&amp;quot;;
        //æ³¨é‡Šä»è¿æ¥æ± è·å–è¿æ¥çš„ä»£ç ,ä½¿ç”¨ä»serviceä¸­ä¼ é€’è¿‡æ¥çš„connection
//        Connection conn = JdbcUtils.getConnection();
        PreparedStatement pstm = conn.prepareStatement(sql);
        pstm.setInt(1,money);
        pstm.setString(2,outUser);
        pstm.executeUpdate();
        //è¿æ¥ä¸èƒ½åœ¨è¿™é‡Œé‡Šæ”¾,serviceå±‚ä¸­è¿˜éœ€è¦ä½¿ç”¨
//        JdbcUtils.release(pstm,conn);
        JdbcUtils.release(pstm);
    }

    public void in(Connection conn, String inUser, int money) throws SQLException {
        String sql = &amp;quot;update account set money = money + ? where name = ?&amp;quot;;
//        Connection conn = JdbcUtils.getConnection();
        PreparedStatement pstm = conn.prepareStatement(sql);
        pstm.setInt(1,money);
        pstm.setString(2,inUser);
        pstm.executeUpdate();
//        JdbcUtils.release(pstm,conn);
        JdbcUtils.release(pstm);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;222-å¸¸è§„æ–¹æ¡ˆçš„å¼Šç«¯&#34;&gt;2.2.2 å¸¸è§„æ–¹æ¡ˆçš„å¼Šç«¯&lt;/h3&gt;
&lt;p&gt;ä¸Šè¿°æ–¹å¼æˆ‘ä»¬çœ‹åˆ°çš„ç¡®æŒ‰è¦æ±‚è§£å†³äº†é—®é¢˜ï¼Œä½†æ˜¯ä»”ç»†è§‚å¯Ÿï¼Œä¼šå‘ç°è¿™æ ·å®ç°çš„å¼Šç«¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;ç›´æ¥ä»&lt;code&gt;service&lt;/code&gt;å±‚ä¼ é€’&lt;code&gt;connection&lt;/code&gt;åˆ°&lt;code&gt;dao&lt;/code&gt;å±‚, é€ æˆä»£ç è€¦åˆåº¦æé«˜&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åŠ é”ä¼šé€ æˆçº¿ç¨‹å¤±å»å¹¶å‘æ€§ï¼Œç¨‹åºæ€§èƒ½é™ä½&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;23-threadlocalè§£å†³æ–¹æ¡ˆ&#34;&gt;2.3 ThreadLocalè§£å†³æ–¹æ¡ˆ&lt;/h2&gt;
&lt;h3 id=&#34;231-threadlocalæ–¹æ¡ˆçš„å®ç°&#34;&gt;2.3.1 ThreadLocalæ–¹æ¡ˆçš„å®ç°&lt;/h3&gt;
&lt;p&gt;åƒè¿™ç§éœ€è¦åœ¨é¡¹ç›®ä¸­è¿›è¡Œ&lt;strong&gt;æ•°æ®ä¼ é€’&lt;/strong&gt;å’Œ&lt;strong&gt;çº¿ç¨‹éš”ç¦»&lt;/strong&gt;çš„åœºæ™¯ï¼Œæˆ‘ä»¬ä¸å¦¨ç”¨&lt;code&gt;ThreadLocal&lt;/code&gt;æ¥è§£å†³ï¼š&lt;/p&gt;
&lt;p&gt;ï¼ˆ1ï¼‰ å·¥å…·ç±»çš„ä¿®æ”¹ï¼š åŠ å…¥ThreadLocal&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.itheima.transfer.utils;

import com.mchange.v2.c3p0.ComboPooledDataSource;
import java.sql.Connection;
import java.sql.SQLException;

public class JdbcUtils {
    //ThreadLocalå¯¹è±¡ : å°†connectionç»‘å®šåœ¨å½“å‰çº¿ç¨‹ä¸­
    private static final ThreadLocal&amp;lt;Connection&amp;gt; tl = new ThreadLocal();

    // c3p0 æ•°æ®åº“è¿æ¥æ± å¯¹è±¡å±æ€§
    private static final ComboPooledDataSource ds = new ComboPooledDataSource();

    // è·å–è¿æ¥
    public static Connection getConnection() throws SQLException {
        //å–å‡ºå½“å‰çº¿ç¨‹ç»‘å®šçš„connectionå¯¹è±¡
        Connection conn = tl.get();
        if (conn == null) {
            //å¦‚æœæ²¡æœ‰ï¼Œåˆ™ä»è¿æ¥æ± ä¸­å–å‡º
            conn = ds.getConnection();
            //å†å°†connectionå¯¹è±¡ç»‘å®šåˆ°å½“å‰çº¿ç¨‹ä¸­
            tl.set(conn);
        }
        return conn;
    }

    //é‡Šæ”¾èµ„æº
    public static void release(AutoCloseable... ios) {
        for (AutoCloseable io : ios) {
            if (io != null) {
                try {
                    io.close();
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        }
    }

    public static void commitAndClose() {
        try {
            Connection conn = getConnection();
            //æäº¤äº‹åŠ¡
            conn.commit();
            //è§£é™¤ç»‘å®š
            tl.remove();
            //é‡Šæ”¾è¿æ¥
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }

    public static void rollbackAndClose() {
        try {
            Connection conn = getConnection();
            //å›æ»šäº‹åŠ¡
            conn.rollback();
            //è§£é™¤ç»‘å®š
            tl.remove();
            //é‡Šæ”¾è¿æ¥
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ï¼ˆ2ï¼‰ AccountServiceç±»çš„ä¿®æ”¹ï¼šä¸éœ€è¦ä¼ é€’connectionå¯¹è±¡&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.itheima.transfer.service;

import com.itheima.transfer.dao.AccountDao;
import com.itheima.transfer.utils.JdbcUtils;
import java.sql.Connection;

public class AccountService {

    public boolean transfer(String outUser, String inUser, int money) {
        AccountDao ad = new AccountDao();

        try {
            Connection conn = JdbcUtils.getConnection();
            //å¼€å¯äº‹åŠ¡
            conn.setAutoCommit(false);
            // è½¬å‡º ï¼š è¿™é‡Œä¸éœ€è¦ä¼ å‚äº† ï¼
            ad.out(outUser, money);
            // æ¨¡æ‹Ÿè½¬è´¦è¿‡ç¨‹ä¸­çš„å¼‚å¸¸
//            int i = 1 / 0;
            // è½¬å…¥
            ad.in(inUser, money);
            //äº‹åŠ¡æäº¤
            JdbcUtils.commitAndClose();
        } catch (Exception e) {
            e.printStackTrace();
            //äº‹åŠ¡å›æ»š
           JdbcUtils.rollbackAndClose();
            return false;
        }
        return true;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ï¼ˆ3ï¼‰ AccountDaoç±»çš„ä¿®æ”¹ï¼šç…§å¸¸ä½¿ç”¨&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;package com.itheima.transfer.dao;

import com.itheima.transfer.utils.JdbcUtils;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;

public class AccountDao {

    public void out(String outUser, int money) throws SQLException {
        String sql = &amp;quot;update account set money = money - ? where name = ?&amp;quot;;
        Connection conn = JdbcUtils.getConnection();
        PreparedStatement pstm = conn.prepareStatement(sql);
        pstm.setInt(1,money);
        pstm.setString(2,outUser);
        pstm.executeUpdate();
        //ç…§å¸¸ä½¿ç”¨
//        JdbcUtils.release(pstm,conn);
        JdbcUtils.release(pstm);
    }

    public void in(String inUser, int money) throws SQLException {
        String sql = &amp;quot;update account set money = money + ? where name = ?&amp;quot;;
        Connection conn = JdbcUtils.getConnection();
        PreparedStatement pstm = conn.prepareStatement(sql);
        pstm.setInt(1,money);
        pstm.setString(2,inUser);
        pstm.executeUpdate();
//        JdbcUtils.release(pstm,conn);
        JdbcUtils.release(pstm);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;232-threadlocalæ–¹æ¡ˆçš„å¥½å¤„&#34;&gt;2.3.2 ThreadLocalæ–¹æ¡ˆçš„å¥½å¤„&lt;/h3&gt;
&lt;p&gt;ä»ä¸Šè¿°çš„æ¡ˆä¾‹ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ åœ¨ä¸€äº›ç‰¹å®šåœºæ™¯ä¸‹ï¼Œ&lt;code&gt;ThreadLocal&lt;/code&gt;æ–¹æ¡ˆæœ‰ä¸¤ä¸ªçªå‡ºçš„ä¼˜åŠ¿ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;ä¼ é€’æ•°æ® ï¼š ä¿å­˜æ¯ä¸ªçº¿ç¨‹ç»‘å®šçš„æ•°æ®ï¼Œåœ¨éœ€è¦çš„åœ°æ–¹å¯ä»¥ç›´æ¥è·å–, é¿å…å‚æ•°ç›´æ¥ä¼ é€’å¸¦æ¥çš„ä»£ç è€¦åˆé—®é¢˜&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;çº¿ç¨‹éš”ç¦» ï¼š å„çº¿ç¨‹ä¹‹é—´çš„æ•°æ®ç›¸äº’éš”ç¦»å´åˆå…·å¤‡å¹¶å‘æ€§ï¼Œé¿å…åŒæ­¥æ–¹å¼å¸¦æ¥çš„æ€§èƒ½æŸå¤±&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;ä¸‰-threadlocalçš„å†…éƒ¨ç»“æ„&#34;&gt;ä¸‰ã€ThreadLocalçš„å†…éƒ¨ç»“æ„&lt;/h1&gt;
&lt;p&gt;é€šè¿‡ä»¥ä¸Šçš„å­¦ä¹ ï¼Œæˆ‘ä»¬å¯¹&lt;code&gt;ThreadLocal&lt;/code&gt;çš„ä½œç”¨æœ‰äº†ä¸€å®šçš„è®¤è¯†ã€‚ç°åœ¨æˆ‘ä»¬ä¸€èµ·æ¥çœ‹ä¸€ä¸‹&lt;code&gt;ThreadLocal&lt;/code&gt;çš„å†…éƒ¨ç»“æ„ï¼Œæ¢ç©¶å®ƒèƒ½å¤Ÿå®ç°çº¿ç¨‹æ•°æ®éš”ç¦»çš„åŸç†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;31å¸¸è§çš„è¯¯è§£&#34;&gt;3.1å¸¸è§çš„è¯¯è§£&lt;/h2&gt;
&lt;p&gt;é€šå¸¸ï¼Œå¦‚æœæˆ‘ä»¬ä¸å»çœ‹æºä»£ç çš„è¯ï¼Œæˆ‘çŒœ &lt;code&gt;ThreadLocal&lt;/code&gt; æ˜¯è¿™æ ·å­è®¾è®¡çš„ï¼šæ¯ä¸ª&lt;code&gt;ThreadLocal&lt;/code&gt; ç±»éƒ½åˆ›å»ºä¸€ä¸ª &lt;code&gt;Map&lt;/code&gt;ï¼Œç„¶åç”¨çº¿ç¨‹ä½œä¸º&lt;code&gt;Map&lt;/code&gt;çš„&lt;code&gt;key&lt;/code&gt;ï¼Œè¦å­˜å‚¨çš„å±€éƒ¨å˜é‡ä½œä¸º&lt;code&gt;Map&lt;/code&gt;çš„&lt;code&gt;value&lt;/code&gt;ï¼Œè¿™æ ·å°±èƒ½è¾¾åˆ°å„ä¸ªçº¿ç¨‹çš„å±€éƒ¨å˜é‡éš”ç¦»çš„æ•ˆæœã€‚è¿™æ˜¯æœ€ç®€å•çš„è®¾è®¡æ–¹æ³•ï¼Œ&lt;code&gt;JDK&lt;/code&gt;æœ€æ—©æœŸçš„&lt;code&gt;ThreadLocal&lt;/code&gt;å°±æ˜¯è¿™æ ·è®¾è®¡çš„ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%97%A9%E6%9C%9FThreadLocal.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;32-ç°åœ¨çš„è®¾è®¡&#34;&gt;3.2 ç°åœ¨çš„è®¾è®¡&lt;/h2&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œ&lt;code&gt;JDK&lt;/code&gt;åé¢ä¼˜åŒ–äº†è®¾è®¡æ–¹æ¡ˆï¼Œ&lt;code&gt;JDK8&lt;/code&gt; ä¸­ &lt;code&gt;ThreadLocal&lt;/code&gt;çš„è®¾è®¡æ˜¯ï¼šæ¯ä¸ª&lt;code&gt;Thread&lt;/code&gt;ç»´æŠ¤ä¸€ä¸ª&lt;code&gt;ThreadLocalMap&lt;/code&gt; å“ˆå¸Œè¡¨ï¼Œè¿™ä¸ªå“ˆå¸Œè¡¨çš„&lt;code&gt;key&lt;/code&gt;æ˜¯&lt;code&gt;ThreadLocal&lt;/code&gt;å®ä¾‹æœ¬èº«ï¼Œ&lt;code&gt;value&lt;/code&gt;æ‰æ˜¯çœŸæ­£è¦å­˜å‚¨çš„å€¼&lt;code&gt;object&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ï¼ˆ1ï¼‰æ¯ä¸ª&lt;code&gt;Thread&lt;/code&gt;çº¿ç¨‹å†…éƒ¨éƒ½æœ‰ä¸€ä¸ª&lt;code&gt;Mapï¼ˆThreadLocalMapï¼‰&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ï¼ˆ2ï¼‰&lt;code&gt;Map&lt;/code&gt;é‡Œé¢å­˜å‚¨&lt;code&gt;ThreadLocal&lt;/code&gt;å¯¹è±¡ï¼ˆ&lt;code&gt;key&lt;/code&gt;ï¼‰å’Œçº¿ç¨‹çš„å˜é‡å‰¯æœ¬ï¼ˆ&lt;code&gt;value&lt;/code&gt;ï¼‰&lt;/p&gt;
&lt;p&gt;ï¼ˆ3ï¼‰&lt;code&gt;Thread&lt;/code&gt;å†…éƒ¨çš„&lt;code&gt;Map&lt;/code&gt;æ˜¯ç”±&lt;code&gt;ThreadLocal&lt;/code&gt;ç»´æŠ¤çš„ï¼Œç”±ThreadLocalè´Ÿè´£å‘mapè·å–å’Œè®¾ç½®çº¿ç¨‹çš„å˜é‡å€¼ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/JDK8ThreadLocal.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;33-jdk8çš„è®¾è®¡æ–¹æ¡ˆä¸¤ä¸ªå¥½å¤„&#34;&gt;3.3 JDK8çš„è®¾è®¡æ–¹æ¡ˆä¸¤ä¸ªå¥½å¤„&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;æ¯ä¸ª&lt;code&gt;Map&lt;/code&gt;å­˜å‚¨çš„&lt;code&gt;Entry&lt;/code&gt;æ•°é‡å˜å°‘&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;[åœ¨æ—©æœŸç‰ˆæœ¬å†…ï¼ŒMap çš„ Entry æ•°é‡ç”± Thread å†³å®šï¼›è€Œ JDK8 ä¸­ï¼ŒMap çš„ Entry æ•°é‡ç”± ThreadLocal å†³å®šï¼Œä¸€èˆ¬æƒ…å†µä¸‹ ThreadLocal æ•°é‡æ˜¯æ¯” Thread å°‘çš„]&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;å½“&lt;code&gt;Thread&lt;/code&gt;é”€æ¯çš„æ—¶å€™ï¼Œ&lt;code&gt;ThreadLocalMap&lt;/code&gt;ä¹Ÿä¼šéšä¹‹é”€æ¯ï¼Œå‡å°‘å†…å­˜çš„ä½¿ç”¨&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;[æ—©æœŸç‰ˆæœ¬å†…ï¼ŒThreadLocalMap ç”± ThreadLocal ç»´æŠ¤ï¼›è€Œ JDK8 ä¸­ï¼ŒThreadLocalMap ç”± Thread ç»´æŠ¤ï¼Œå½“ Thread é”€æ¯ï¼ŒThreadLocalMap ä¹Ÿä¼šé”€æ¯]&lt;/p&gt;
&lt;h1 id=&#34;å››-threadlocal-çš„å’Œæ ¸å¿ƒæ–¹æ³•æºç &#34;&gt;å››ã€ThreadLocal çš„å’Œæ ¸å¿ƒæ–¹æ³•æºç &lt;/h1&gt;
&lt;p&gt;åŸºäº&lt;code&gt;ThreadLocal&lt;/code&gt;çš„å†…éƒ¨ç»“æ„ï¼Œæˆ‘ä»¬ç»§ç»­åˆ†æå®ƒçš„æ ¸å¿ƒæ–¹æ³•æºç ï¼Œæ›´æ·±å…¥çš„äº†è§£å…¶æ“ä½œåŸç†ã€‚&lt;/p&gt;
&lt;p&gt;é™¤äº†æ„é€ æ–¹æ³•ä¹‹å¤–ï¼Œ&lt;code&gt;ThreadLocal&lt;/code&gt;å¯¹å¤–æš´éœ²çš„æ–¹æ³•æœ‰ä»¥ä¸‹4ä¸ªï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;æ–¹æ³•å£°æ˜&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;æè¿°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;protected T initialValue()&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è¿”å›å½“å‰çº¿ç¨‹å±€éƒ¨å˜é‡çš„åˆå§‹å€¼&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;public void set(T value)&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è®¾ç½®å½“å‰çº¿ç¨‹ç»‘å®šçš„å±€éƒ¨å˜é‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;public T get()&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è·å–å½“å‰çº¿ç¨‹ç»‘å®šçš„å±€éƒ¨å˜é‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;public void remove()&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ç§»é™¤å½“å‰çº¿ç¨‹ç»‘å®šçš„å±€éƒ¨å˜é‡&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯è¿™4ä¸ªæ–¹æ³•çš„è¯¦ç»†æºç åˆ†æï¼ˆä¸ºäº†ä¿è¯æ€è·¯æ¸…æ™°ï¼Œ&lt;code&gt;ThreadLocalMap&lt;/code&gt;éƒ¨åˆ†æš‚æ—¶ä¸å±•å¼€ï¼Œä¸‹ä¸€ä¸ªçŸ¥è¯†ç‚¹è¯¦è§£ï¼‰&lt;/p&gt;
&lt;h2 id=&#34;41-setæ–¹æ³•&#34;&gt;4.1 setæ–¹æ³•&lt;/h2&gt;
&lt;p&gt;ï¼ˆ1ï¼‰æºç å’Œå¯¹åº”çš„ä¸­æ–‡æ³¨é‡Š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/**
 * è®¾ç½®å½“å‰çº¿ç¨‹å¯¹åº”çš„ ThreadLocal çš„å€¼
 * @param value å°†è¦ä¿å­˜åœ¨å½“å‰çº¿ç¨‹å¯¹åº”çš„ThreadLocalçš„å€¼
 */
public void set(T value) {
    // è·å–å½“å‰çº¿ç¨‹å¯¹è±¡
    Thread t = Thread.currentThread();
    // è·å–å½“å‰çº¿ç¨‹å¯¹è±¡ä¸­ç»´æŠ¤çš„ ThreadLocalMap å¯¹è±¡
    ThreadLocalMap map = getMap(t);
    // åˆ¤æ–­ map æ˜¯å¦å­˜åœ¨
    if (map != null)
        // å­˜åœ¨åˆ™è°ƒç”¨ map.set è®¾ç½®æ­¤å®ä½“ Entry
        map.set(this, value);
    else
        // 1ï¼‰å½“å‰çº¿ç¨‹ Thread ä¸å­˜åœ¨ ThreadLocalMap å¯¹è±¡
        // 2ï¼‰åˆ™è°ƒç”¨ createMap è¿›è¡Œ ThreadLocalMap å¯¹è±¡çš„åˆå§‹åŒ–
        // 3ï¼‰å¹¶å°† tï¼ˆå½“å‰çº¿ç¨‹ï¼‰å’Œvalueï¼ˆtå¯¹åº”çš„å€¼ï¼‰ä½œä¸ºç¬¬ä¸€ä¸ª entry å­˜æ”¾è‡³ ThreadLocalMap ä¸­
        createMap(t, value);
}
/**
 * è·å–å½“å‰çº¿ç¨‹ Thread å¯¹åº”ç»´æŠ¤çš„ ThreadLocalMap
 *
 * @param  t the current thread å½“å‰çº¿ç¨‹
 * @return the map å¯¹åº”ç»´æŠ¤çš„ ThreadLocalMap
 */

ThreadLocalMap getMap(Thread t) {
    return t.threadLocals;
}

/**
 * åˆ›å»ºå½“å‰çº¿ç¨‹ Thread å¯¹åº”ç»´æŠ¤çš„ ThreadLocalMap
 *
 * @param t the current thread å½“å‰çº¿ç¨‹
 * @param firstValue value for the initial entry of the map å­˜æ”¾åˆ° map ä¸­ç¬¬ä¸€ä¸ª entry å€¼ 
 */
void createMap(Thread t, T firstValue) {
    // è¿™é‡Œçš„ this æ˜¯è°ƒç”¨æ­¤æ–¹æ³•çš„threadLocal
    t.threadLocals = new ThreadLocalMap(this, firstValue);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ï¼ˆ2ï¼‰ä»£ç æ‰§è¡Œæµç¨‹&lt;br&gt;
A.é¦–å…ˆè·å–å½“å‰çº¿ï¼Œå¹¶æ ¹æ®å½“å‰çº¿ç¨‹è·å–ä¸€ä¸ª&lt;code&gt;Map&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;B.å¦‚æœè·å–çš„&lt;code&gt;Map&lt;/code&gt;ä¸ä¸ºç©ºï¼Œåˆ™å°†å‚æ•°è®¾ç½®åˆ°&lt;code&gt;Map&lt;/code&gt;ä¸­ï¼ˆå½“å‰&lt;code&gt;ThreadLocal&lt;/code&gt;çš„å¼•ç”¨ä½œä¸º&lt;code&gt;key&lt;/code&gt;ï¼‰&lt;/p&gt;
&lt;p&gt;C.å¦‚æœ&lt;code&gt;Map&lt;/code&gt;ä¸ºç©ºï¼Œåˆ™ç»™è¯¥çº¿ç¨‹åˆ›å»º&lt;code&gt;Map&lt;/code&gt;ï¼Œå¹¶è®¾ç½®åˆå§‹å€¼&lt;/p&gt;
&lt;h2 id=&#34;42-getæ–¹æ³•&#34;&gt;4.2 getæ–¹æ³•&lt;/h2&gt;
&lt;p&gt;ï¼ˆ1ï¼‰æºç å’Œå¯¹åº”çš„ä¸­æ–‡æ³¨é‡Š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/**
 * è¿”å›å½“å‰çº¿ç¨‹ä¸­ä¿å­˜ ThreadLocal çš„å€¼
 * å½“å‰çº¿ç¨‹æ²¡æœ‰æ­¤ ThreadLocal å˜é‡
 * åˆ™å®ƒä¼šé€šè¿‡è°ƒç”¨ {@link #initialValue} æ–¹æ³•è¿›è¡Œåˆå§‹åŒ–
 *
 * @return è¿”å›å½“å‰çº¿ç¨‹å¯¹åº”æ­¤ ThreadLocal çš„å€¼
 */
public T get() {
    // è·å–å½“å‰çº¿ç¨‹å¯¹è±¡
    Thread t = Thread.currentThread();
    // è·å–å½“å‰çº¿ç¨‹ä¸­ç»´æŠ¤çš„ ThreadLocalMap å¯¹è±¡
    ThreadLocal.ThreadLocalMap map = getMap(t);
    // å¦‚æœæ­¤ map å­˜åœ¨
    if (map != null) {
        // ä»¥å½“å‰çš„ ThreadLocal ä¸º keyï¼Œè°ƒç”¨ getEntry è·å–å¯¹åº”çš„å­˜å‚¨å®ä½“ e
        ThreadLocal.ThreadLocalMap.Entry e = map.getEntry(this);
        // å¯¹ e è¿›è¡Œåˆ¤ç©º
        if (e != null) {
            @SuppressWarnings(&amp;quot;unchecked&amp;quot;)
            // è·å–å­˜å‚¨å®ä½“ e å¯¹åº”çš„ value å€¼ï¼Œå³ä¸ºæˆ‘ä»¬æƒ³è¦çš„å½“å‰çº¿ç¨‹å¯¹åº”æ­¤ ThreadLocal çš„å€¼
            T result = (T)e.value;
            return result;
        }
    }
    /*
        åˆå§‹åŒ–ï¼šæœ‰ä¸¤ç§æƒ…å†µæ‰§è¡Œå½“å‰ä»£ç 
        ç¬¬ä¸€ç§æƒ…å†µï¼šmap ä¸å­˜åœ¨ï¼Œè¡¨ç¤ºæ­¤çº¿ç¨‹æ²¡æœ‰ç»´æŠ¤çš„ ThreadLocalMap å¯¹è±¡
        ç¬¬äºŒç§æƒ…å†µï¼šmap å­˜åœ¨ï¼Œä½†æ˜¯æ²¡æœ‰ä¸å½“å‰ ThreadLocal å…³è”çš„ Entry
     */
    return setInitialValue();
}
/**
 * åˆå§‹åŒ–
 *
 * @return the initial value
 */
private T setInitialValue() {
    // è°ƒç”¨ initialValue è·å–åˆå§‹åŒ–çš„å€¼
    // æ­¤æ–¹æ³•å¯ä»¥è¢«å­ç±»é‡å†™ï¼Œå¦‚æœä¸é‡å†™é»˜è®¤è¿”å› null
    T value = initialValue();
    // è·å–å½“å‰çº¿ç¨‹å¯¹è±¡
    Thread t = Thread.currentThread();
    // è·å–æ­¤çº¿ç¨‹å¯¹è±¡ä¸­ç»´æŠ¤çš„ ThreadLocalMap å¯¹è±¡
    ThreadLocal.ThreadLocalMap map = getMap(t);
    // åˆ¤æ–­ map æ˜¯å¦å­˜åœ¨
    if (map != null)
        // å­˜åœ¨åˆ™è°ƒç”¨ map.set è®¾ç½®æ­¤å®ä½“ entry
        map.set(this, value);
    else
        // 1)å½“å‰çº¿ç¨‹ Thread ä¸å­˜åœ¨ ThreadLocalMap å¯¹è±¡
        // 2)åˆ™è°ƒç”¨ createMap è¿›è¡Œ ThreadLocalMap å¯¹è±¡çš„åˆå§‹åŒ–
        // 3)å¹¶å°† t(å½“å‰çº¿ç¨‹)å’Œ value(tå¯¹åº”çš„å€¼)ä½œä¸ºç¬¬ä¸€ä¸ª entry å­˜æ”¾è‡³ ThreadLocalMap ä¸­
        createMap(t, value);
    // è¿”å›è®¾ç½®çš„å€¼ value
    return value;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ï¼ˆ2ï¼‰ä»£ç æ‰§è¡Œæµç¨‹&lt;br&gt;
A.é¦–å…ˆè·å–å½“å‰çº¿ç¨‹ï¼Œæ ¹æ®å½“å‰çº¿ç¨‹è·å–ä¸€ä¸ª&lt;code&gt;Map&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;B.å¦‚æœè·å–çš„&lt;code&gt;Map&lt;/code&gt;ä¸ä¸ºç©ºï¼Œåˆ™åœ¨&lt;code&gt;Map&lt;/code&gt;ä¸­ä»¥&lt;code&gt;ThreadLocal&lt;/code&gt;çš„å¼•ç”¨ä½œä¸º&lt;code&gt;key&lt;/code&gt;æ¥åœ¨&lt;code&gt;Map&lt;/code&gt;ä¸­è·å–å¯¹åº”çš„&lt;code&gt;Entry&lt;/code&gt;ï¼Œå¦åˆ™è½¬åˆ°D&lt;/p&gt;
&lt;p&gt;C.å¦‚æœ&lt;code&gt;e&lt;/code&gt;ä¸ä¸º&lt;code&gt;null&lt;/code&gt;ï¼Œåˆ™è¿”å›&lt;code&gt;e.value&lt;/code&gt;ï¼Œå¦åˆ™è½¬åˆ°D&lt;/p&gt;
&lt;p&gt;D.&lt;code&gt;Map&lt;/code&gt;ä¸ºç©ºæˆ–è€…&lt;code&gt;e&lt;/code&gt;ä¸ºç©ºï¼Œåˆ™é€šè¿‡&lt;code&gt;initiaValue&lt;/code&gt;å‡½æ•°è·å–åˆå§‹å€¼&lt;code&gt;value&lt;/code&gt;ï¼Œç„¶åç”¨&lt;code&gt;ThreadLocal&lt;/code&gt;çš„å¼•ç”¨å’Œ&lt;code&gt;value&lt;/code&gt;ä½œä¸º&lt;code&gt;firstKey&lt;/code&gt;å’Œ&lt;code&gt;firstValue&lt;/code&gt;åˆ›å»ºä¸€ä¸ªæ–°çš„&lt;code&gt;Map&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ€»ç»“ï¼š&lt;strong&gt;å…ˆè·å–å½“å‰çº¿ç¨‹çš„ThreadLocalMapå˜é‡ï¼Œå¦‚æœå­˜åœ¨åˆ™è¿”å›å€¼ï¼Œä¸å­˜åœ¨åˆ™åˆ›å»ºå¹¶è¿”å›åˆå§‹å€¼&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;43-removeæ–¹æ³•&#34;&gt;4.3 removeæ–¹æ³•&lt;/h2&gt;
&lt;p&gt;ï¼ˆ1ï¼‰æºç å’Œå¯¹åº”çš„ä¸­æ–‡æ³¨é‡Š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/**
 * åˆ é™¤å½“å‰çº¿ç¨‹ä¸­ä¿å­˜çš„ ThreadLocal å¯¹åº”çš„å®ä½“ entry
 */
public void remove() {
    // è·å–å½“å‰çº¿ç¨‹å¯¹è±¡ä¸­ç»´æŠ¤çš„ ThreadLocalMap
    ThreadLocal.ThreadLocalMap m = getMap(Thread.currentThread());
    // å¦‚æœæ­¤ map å­˜åœ¨
    if (m != null)
        // å­˜åœ¨åˆ™è°ƒç”¨ map.remove
        // ä»¥å½“å‰ ThreadLocal ä¸º key åˆ é™¤å¯¹åº”çš„å®ä½“ entry
        m.remove(this);
}

        /**
         * ç§»é™¤ key ä¸ºç»™å®šå€¼çš„ Entry èŠ‚ç‚¹
         */
        private void remove(ThreadLocal&amp;lt;?&amp;gt; key) {
            // æš‚å­˜ Entry æ•°ç»„
            Entry[] tab = table;
            int len = tab.length;
            // è·å–å½“å‰ key å¯¹åº”çš„ Entry åœ¨æ•°ç»„ä¸­çš„ä½ç½®
            int i = key.threadLocalHashCode &amp;amp; (len-1);
            for (Entry e = tab[i];
                 e != null;
                 e = tab[i = nextIndex(i, len)]) {
                if (e.get() == key) {
                    e.clear();
                    expungeStaleEntry(i);
                    return;
                }
            }
        }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ï¼ˆ2ï¼‰ä»£ç æ‰§è¡Œæµç¨‹&lt;br&gt;
A.é¦–å…ˆè·å–å½“å‰çº¿ç¨‹ï¼Œå¹¶æ ¹æ®å½“å‰çº¿ç¨‹è·å–ä¸€ä¸ª&lt;code&gt;Map&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;B.å¦‚æœè·å–çš„&lt;code&gt;Map&lt;/code&gt;ä¸ä¸ºç©ºï¼Œåˆ™ç§»é™¤å½“å‰&lt;code&gt;ThreadLocal&lt;/code&gt;å¯¹è±¡å¯¹åº”çš„&lt;code&gt;Entry&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;44-initialvalueæ–¹æ³•&#34;&gt;4.4 initialValueæ–¹æ³•&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;/**
 * è¿”å›å½“å‰çº¿ç¨‹å¯¹åº”çš„ThreadLocalçš„åˆå§‹å€¼
 * 
 * æ­¤æ–¹æ³•çš„ç¬¬ä¸€æ¬¡è°ƒç”¨å‘ç”Ÿåœ¨ï¼Œå½“çº¿ç¨‹é€šè¿‡getæ–¹æ³•è®¿é—®æ­¤çº¿ç¨‹çš„ThreadLocalå€¼æ—¶
 * é™¤éçº¿ç¨‹å…ˆè°ƒç”¨äº†setæ–¹æ³•ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œinitialvalue æ‰ä¸ä¼šè¢«è¿™ä¸ªçº¿ç¨‹è°ƒç”¨ã€‚
 * é€šå¸¸æƒ…å†µä¸‹ï¼Œæ¯ä¸ªçº¿ç¨‹æœ€å¤šè°ƒç”¨ä¸€æ¬¡è¿™ä¸ªæ–¹æ³•ã€‚
 * &amp;lt;p&amp;gt;è¿™ä¸ªæ–¹æ³•ä»…ä»…ç®€å•çš„è¿”å›nu11{@code nu11}ï¼›
 * å¦‚æœç¨‹åºå‘˜æƒ³ThreadLocalçº¿ç¨‹å±€éƒ¨å˜é‡æœ‰ä¸€ä¸ªé™¤null ä»¥å¤–çš„åˆå§‹å€¼ï¼Œ
 * å¿…é¡»é€šè¿‡å­ç±»ç»§æ‰¿{@code ThreadLocal}çš„æ–¹å¼å»é‡å†™æ­¤æ–¹æ³•
 * é€šå¸¸ï¼Œå¯ä»¥é€šè¿‡åŒ¿åå†…éƒ¨ç±»çš„æ–¹å¼å®ç°
 * 
 * @return å½“å‰ ThreadLocal çš„åˆå§‹å€¼
 */
protected T initialValue() {
    return null;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ­¤æ–¹æ³•çš„ä½œç”¨æ˜¯è¿”å›è¯¥çº¿ç¨‹å±€éƒ¨å˜é‡çš„åˆå§‹å€¼ã€‚&lt;br&gt;
ï¼ˆ1ï¼‰è¿™ä¸ªæ–¹æ³•æ˜¯ä¸€ä¸ªå»¶è¿Ÿè°ƒç”¨æ–¹æ³•ï¼Œä»é¢çš„ä»£ç æˆ‘ä»¬å¾—çŸ¥ï¼Œåœ¨&lt;code&gt;set&lt;/code&gt;æ–¹æ³•è¿˜æœªè°ƒç”¨è€Œå…ˆè°ƒç”¨äº†&lt;code&gt;get&lt;/code&gt;æ–¹æ³•æ—¶æ‰æ‰§è¡Œï¼Œå¹¶ä¸”ä»…æ‰§è¡Œ1æ¬¡ã€‚&lt;/p&gt;
&lt;p&gt;ï¼ˆ2ï¼‰è¿™ä¸ªæ–¹æ³•ç¼ºçœå®ç°ç›´æ¥è¿”å›ä¸€ä¸ª&lt;code&gt;null&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ï¼ˆ3ï¼‰å¦‚æœæƒ³è¦ä¸€ä¸ªé™¤&lt;code&gt;null&lt;/code&gt;ä¹‹å¤–çš„åˆå§‹å€¼ï¼Œå¯ä»¥é‡å†™æ­¤æ–¹æ³•ã€‚ï¼ˆå¤‡æ³¨ï¼šè¯¥æ–¹æ³•æ˜¯ä¸€ä¸ª&lt;code&gt;protected&lt;/code&gt;çš„æ–¹æ³•ï¼Œæ˜¾ç„¶æ˜¯ä¸ºäº†è®©å­ç±»è¦†ç›–è€Œè®¾è®¡çš„ï¼‰&lt;/p&gt;
&lt;h1 id=&#34;äº”-threadlocalmapæºç åˆ†æ&#34;&gt;äº”ã€ThreadLocalMapæºç åˆ†æ&lt;/h1&gt;
&lt;p&gt;åœ¨åˆ†æ&lt;code&gt;ThreadLocal&lt;/code&gt;æ–¹æ³•çš„æ—¶å€™ï¼Œæˆ‘ä»¬äº†è§£åˆ°&lt;code&gt;ThreadLocal&lt;/code&gt;çš„æ“ä½œå®é™…ä¸Šæ˜¯å›´ç»•&lt;code&gt;ThreadLocalMap&lt;/code&gt;å±•å¼€çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ThreadLocalMap&lt;/code&gt;çš„æºç ç›¸å¯¹æ¯”è¾ƒå¤æ‚ï¼Œæˆ‘ä»¬ä»ä»¥ä¸‹ä¸‰ä¸ªæ–¹é¢è¿›è¡Œè®¨è®ºã€‚&lt;/p&gt;
&lt;h2 id=&#34;51åŸºæœ¬ç»“æ„&#34;&gt;5.1åŸºæœ¬ç»“æ„&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;ThreadLocalMap&lt;/code&gt;æ˜¯&lt;code&gt;ThreadLocal&lt;/code&gt;çš„å†…éƒ¨ç±»ï¼Œæ²¡æœ‰å®ç°&lt;code&gt;Map&lt;/code&gt;æ¥å£ï¼Œç”¨ç‹¬ç«‹çš„æ–¹å¼å®ç°äº†&lt;code&gt;Map&lt;/code&gt;çš„åŠŸèƒ½ï¼Œå…¶å†…éƒ¨çš„&lt;code&gt;Entry&lt;/code&gt;ä¹Ÿæ˜¯ç‹¬ç«‹å®ç°ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/ThreadLocal%E7%9A%84UML.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ï¼ˆ1ï¼‰æˆå‘˜å˜é‡&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/**
 * åˆå§‹å®¹é‡ - å¿…é¡»æ˜¯ 2 çš„æ•´æ¬¡å¹‚
 */
private static final int INITIAL_CAPACITY = 16;

/**
 * å­˜æ”¾æ•°æ®çš„ tableï¼ŒEntryç±»çš„å®šä¹‰åœ¨ä¸‹é¢åˆ†æ
 * åŒæ ·ï¼Œæ•°ç»„é•¿åº¦å¿…é¡»æ˜¯ 2 çš„æ•´æ¬¡å¹‚ã€‚
 */
private ThreadLocal.ThreadLocalMap.Entry[] table;

/**
 * æ•°ç»„é‡Œé¢ entrys çš„ä¸ªæ•°ï¼Œå¯ä»¥ç”¨äºåˆ¤æ–­ table å½“å‰ä½¿ç”¨é‡æ˜¯å¦è¶…è¿‡é˜ˆå€¼
 */
private int size = 0;

/**
 * è¿›è¡Œæ‰©å®¹çš„é˜ˆå€¼ï¼Œè¡¨ä½¿ç”¨é‡å¤§äºå®ƒçš„æ—¶å€™è¿›è¡Œæ‰©å®¹ã€‚
 */
private int threshold; // Default to 0
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è·ŸHashMapç±»ä¼¼ï¼Œ&lt;code&gt;INITIAL_CAPACITY&lt;/code&gt;ä»£è¡¨è¿™ä¸ª&lt;code&gt;Map&lt;/code&gt;çš„åˆå§‹å®¹é‡ï¼›&lt;code&gt;table&lt;/code&gt;æ˜¯ä¸€ä¸ª&lt;code&gt;Entry&lt;/code&gt;ç±»å‹çš„æ•°ç»„ï¼Œç”¨äºå­˜å‚¨æ•°æ®ï¼›&lt;code&gt;size&lt;/code&gt;ä»£è¡¨è¡¨ä¸­çš„å­˜å‚¨æ•°ç›®ï¼›&lt;code&gt;threshold&lt;/code&gt; ä»£è¡¨éœ€è¦æ‰©å®¹æ—¶å¯¹åº” &lt;code&gt;size&lt;/code&gt;çš„é˜ˆå€¼ã€‚&lt;br&gt;
ï¼ˆ2ï¼‰å­˜å‚¨ç»“æ„-Entry&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/**
 * Entry ç»§æ‰¿ WeakReferenceï¼Œå¹¶ä¸”ç”¨ ThreadLocal ä½œä¸º key
 * å¦‚æœ key ä¸º null(entry.get() == null)ï¼Œæ„å‘³ç€ key ä¸å†è¢«å¼•ç”¨ï¼Œ
 * å› æ­¤è¿™æ—¶å€™ entry ä¹Ÿå¯ä»¥ä» table ä¸­æ¸…é™¤
 */
static class Entry extends WeakReference&amp;lt;ThreadLocal&amp;lt;?&amp;gt;&amp;gt; {
    /** The value associated with this ThreadLocal. */
    Object value;

    Entry(ThreadLocal&amp;lt;?&amp;gt; k, Object v) {
        super(k);
        value = v;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åœ¨&lt;code&gt;ThreadLocalMap&lt;/code&gt;ä¸­ï¼Œä¹Ÿæ˜¯ç”¨&lt;code&gt;Entry&lt;/code&gt;æ¥ä¿å­˜&lt;code&gt;K-V&lt;/code&gt;ç»“æ„æ•°æ®çš„ã€‚ä¸è¿‡&lt;code&gt;Entry&lt;/code&gt;ä¸­çš„&lt;code&gt;key&lt;/code&gt;åªèƒ½æ˜¯&lt;code&gt;ThreadLocal&lt;/code&gt;å¯¹è±¡ï¼Œè¿™ç‚¹åœ¨æ„é€ æ–¹æ³•ä¸­å·²ç»é™å®šæ­»äº†ã€‚&lt;br&gt;
å¦å¤–ï¼Œ&lt;code&gt;Entry&lt;/code&gt;ç»§æ‰¿&lt;code&gt;WeakReference&lt;/code&gt;ï¼Œä¹Ÿå°±æ˜¯&lt;code&gt;keyï¼ˆThreadLocalï¼‰&lt;/code&gt;æ˜¯å¼±å¼•ç”¨ï¼Œå…¶ç›®çš„æ˜¯å°†&lt;code&gt;ThreadLocal&lt;/code&gt;å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå’Œçº¿ç¨‹ç”Ÿå‘½å‘¨æœŸè§£ç»‘ã€‚&lt;/p&gt;
&lt;h2 id=&#34;52å¼±å¼•ç”¨å’Œå†…å­˜æ³„æ¼&#34;&gt;5.2å¼±å¼•ç”¨å’Œå†…å­˜æ³„æ¼&lt;/h2&gt;
&lt;p&gt;æœ‰äº›ç¨‹åºå‘˜åœ¨ä½¿ç”¨&lt;code&gt;ThreadLocal&lt;/code&gt;çš„è¿‡ç¨‹ä¸­ä¼šå‘ç°æœ‰å†…å­˜æ³„æ¼çš„æƒ…å†µå‘ç”Ÿï¼Œå°±çŒœæµ‹è¿™ä¸ªå†…å­˜æ³„æ¼è·Ÿ&lt;code&gt;Entry&lt;/code&gt;ä¸­ä½¿ç”¨äº†&lt;strong&gt;å¼±å¼•ç”¨&lt;/strong&gt;çš„&lt;code&gt;key&lt;/code&gt;æœ‰å…³ç³»ã€‚è¿™ä¸ªç†è§£å…¶å®æ˜¯ä¸å¯¹çš„ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å…ˆæ¥å›é¡¾è¿™ä¸ªé—®é¢˜ä¸­æ¶‰åŠçš„å‡ ä¸ªåè¯æ¦‚å¿µï¼Œå†æ¥åˆ†æé—®é¢˜ã€‚&lt;/p&gt;
&lt;h3 id=&#34;1å†…å­˜æ³„æ¼ç›¸å…³æ¦‚å¿µ&#34;&gt;ï¼ˆ1ï¼‰å†…å­˜æ³„æ¼ç›¸å…³æ¦‚å¿µ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Memory overflowï¼šå†…å­˜æº¢å‡ºï¼Œæ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜æä¾›ç”³è¯·è€…ä½¿ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;Memory leakï¼šå†…å­˜æ³„æ¼æ˜¯æŒ‡ç¨‹åºä¸­&lt;strong&gt;å·±åŠ¨æ€åˆ†é…çš„å †å†…å­˜ç”±äºæŸç§åŸå› ç¨‹åºæœªé‡Šæ”¾æˆ–æ— æ³•é‡Šæ”¾ï¼Œé€ æˆç³»ç»Ÿå†…å­˜çš„æµªè´¹&lt;/strong&gt;ï¼Œå¯¼è‡´ç¨‹åºè¿è¡Œé€Ÿåº¦å‡æ…¢ç”šè‡³ç³»ç»Ÿæºƒç­‰ä¸¥é‡åæœã€‚å†…å­˜æ³„æ¼çš„å †ç§¯ç»ˆå°†å¯¼è‡´å†…å­˜æº¢å‡ºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;2å¼±å¼•ç”¨ç›¸å…³æ¦‚å¿µ&#34;&gt;ï¼ˆ2ï¼‰å¼±å¼•ç”¨ç›¸å…³æ¦‚å¿µ&lt;/h3&gt;
&lt;p&gt;Javaä¸­çš„å¼•ç”¨æœ‰4ç§ç±»å‹ï¼šå¼ºã€è½¯ã€å¼±ã€è™šã€‚å½“å‰è¿™ä¸ªé—®é¢˜ä¸»è¦æ¶‰åŠåˆ°å¼ºå¼•ç”¨å’Œå¼±å¼•ç”¨ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¼ºå¼•ç”¨&lt;/strong&gt;ï¼ˆ&amp;quot;Strongâ€Referenceï¼‰ï¼Œå°±æ˜¯æˆ‘ä»¬æœ€å¸¸è§çš„æ™®é€šå¯¹è±¡å¼•ç”¨ï¼Œåªè¦è¿˜æœ‰å¼ºå¼•ç”¨æŒ‡å‘ä¸€ä¸ªå¯¹è±¡ï¼Œå°±èƒ½è¡¨æ˜å¯¹è±¡è¿˜â€œæ´»ç€â€ï¼Œåƒåœ¾å›æ”¶å™¨å°±ä¸ä¼šå›æ”¶è¿™ç§å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¼±å¼•ç”¨&lt;/strong&gt;ï¼ˆWeakReferenceï¼‰ï¼Œåƒåœ¾å›æ”¶å™¨ä¸€æ—¦å‘ç°äº†åªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡ï¼Œä¸ç®¡å½“å‰å†…å­˜ç©ºé—´è¶³å¤Ÿä¸å¦ï¼Œéƒ½ä¼šå›æ”¶å®ƒçš„å†…å­˜ã€‚&lt;/p&gt;
&lt;h3 id=&#34;3å¦‚æœkeyä½¿ç”¨å¼ºå¼•ç”¨&#34;&gt;ï¼ˆ3ï¼‰å¦‚æœkeyä½¿ç”¨å¼ºå¼•ç”¨&lt;/h3&gt;
&lt;p&gt;å‡è®¾&lt;code&gt;ThreadLocalMap&lt;/code&gt;ä¸­çš„&lt;code&gt;key&lt;/code&gt;ä½¿ç”¨äº†å¼ºå¼•ç”¨ï¼Œé‚£ä¹ˆä¼šå‡ºç°å†…å­˜æ³„æ¼å—ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶&lt;code&gt;ThreadLocal&lt;/code&gt;çš„å†…å­˜å›¾ï¼ˆå®çº¿è¡¨ç¤ºå¼ºå¼•ç”¨ï¼‰å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/key%E5%BC%BA%E5%BC%95%E7%94%A8.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;1.å‡è®¾åœ¨ä¸šåŠ¡ä»£ç ä¸­ä½¿ç”¨å®Œ&lt;code&gt;ThreadLocal&lt;/code&gt;ï¼Œ&lt;code&gt;ThreadLocal Ref&lt;/code&gt;è¢«å›æ”¶äº†ã€‚&lt;/p&gt;
&lt;p&gt;2.ä½†æ˜¯å› ä¸º&lt;code&gt;ThreadLocalMap&lt;/code&gt;çš„&lt;code&gt;Entry&lt;/code&gt;å¼ºå¼•ç”¨äº†&lt;code&gt;ThreadLocal&lt;/code&gt;ï¼Œé€ æˆ&lt;code&gt;ThreadLocal&lt;/code&gt;æ— æ³•è¢«å›æ”¶ã€‚&lt;/p&gt;
&lt;p&gt;3.åœ¨æ²¡æœ‰æ‰‹åŠ¨åˆ é™¤è¿™ä¸ª&lt;code&gt;Entry&lt;/code&gt;ä»¥åŠ&lt;code&gt;CurrentThread&lt;/code&gt;ä¾ç„¶è¿è¡Œçš„å‰æä¸‹ï¼Œå§‹ç»ˆæœ‰å¼ºå¼•ç”¨é“¾&lt;code&gt;ThreadRef-&amp;gt;CurrentThread-&amp;gt;ThreadLocalMap-&amp;gt;Entry&lt;/code&gt;ï¼Œ&lt;code&gt;Entry&lt;/code&gt;å°±ä¸ä¼šè¢«å›æ”¶ï¼ˆ&lt;code&gt;Entry&lt;/code&gt;ä¸­åŒ…æ‹¬äº†&lt;code&gt;ThreadLocal&lt;/code&gt;å®ä¾‹å’Œ&lt;code&gt;value&lt;/code&gt;ï¼‰ï¼Œ&lt;strong&gt;å¯¼è‡´&lt;code&gt;Entry&lt;/code&gt;å†…å­˜æ³„æ¼&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ï¼Œ&lt;code&gt;ThreadLocalMap&lt;/code&gt;ä¸­çš„&lt;code&gt;key&lt;/code&gt;ä½¿ç”¨äº†å¼ºå¼•ç”¨ï¼Œæ˜¯æ— æ³•å®Œå…¨é¿å…å†…å­˜æ³„æ¼çš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;4å¦‚æœkeyä½¿ç”¨å¼±å¼•ç”¨&#34;&gt;ï¼ˆ4ï¼‰å¦‚æœkeyä½¿ç”¨å¼±å¼•ç”¨&lt;/h3&gt;
&lt;p&gt;é‚£ä¹ˆ&lt;code&gt;ThreadLocalMap&lt;/code&gt;ä¸­çš„&lt;code&gt;key&lt;/code&gt;ä½¿ç”¨äº†å¼±å¼•ç”¨ï¼Œä¼šå‡ºç°å†…å­˜æ³„æ¼å—ï¼Ÿæ­¤æ—¶&lt;code&gt;ThreadLocal&lt;/code&gt;çš„å†…å­˜å›¾ï¼ˆå®çº¿è¡¨ç¤ºå¼ºå¼•ç”¨ï¼Œè™šçº¿è¡¨ç¤ºå¼±å¼•ç”¨ï¼‰å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/key%E5%BC%B1%E5%BC%95%E7%94%A8.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;åŒæ ·å‡è®¾åœ¨ä¸šåŠ¡ä»£ç ä¸­ä½¿ç”¨å®Œ&lt;code&gt;ThreadLocal&lt;/code&gt;ï¼Œ&lt;code&gt;ThreadLocal Ref&lt;/code&gt;è¢«å›æ”¶äº†ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äº&lt;code&gt;ThreadLocalMap&lt;/code&gt;åªæŒæœ‰&lt;code&gt;ThreadLocal&lt;/code&gt;çš„å¼±å¼•ç”¨ï¼Œæ²¡æœ‰ä»»ä½•å¼ºå¼•ç”¨æŒ‡å‘&lt;code&gt;Threadlocal&lt;/code&gt;å®ä¾‹ï¼Œæ‰€ä»¥&lt;code&gt;Threadlocal&lt;/code&gt;å°±å¯ä»¥é¡ºåˆ©è¢«&lt;code&gt;gc&lt;/code&gt;å›æ”¶ï¼Œæ­¤æ—¶&lt;code&gt;Entry&lt;/code&gt;ä¸­çš„&lt;code&gt;key=null&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯åœ¨æ²¡æœ‰æ‰‹åŠ¨åˆ é™¤è¿™ä¸ª&lt;code&gt;Entry&lt;/code&gt;ä»¥åŠ&lt;code&gt;CurrentThread&lt;/code&gt;ä¾ç„¶è¿è¡Œçš„å‰æä¸‹ï¼Œä¹Ÿå­˜åœ¨æœ‰å¼ºå¼•ç”¨é“¾ &lt;code&gt;ThreadRef -&amp;gt;CurrentThread-&amp;gt;ThreadLocalMap-&amp;gt;Entry-&amp;gt;value&lt;/code&gt;ï¼Œ&lt;code&gt;value&lt;/code&gt;ä¸ä¼šè¢«å›æ”¶ï¼Œè€Œè¿™å—&lt;code&gt;value&lt;/code&gt;æ°¸è¿œä¸ä¼šè¢«è®¿é—®åˆ°äº†ï¼Œ&lt;strong&gt;å¯¼è‡´&lt;code&gt;value&lt;/code&gt;å†…å­˜æ³„æ¼&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ï¼Œ&lt;code&gt;ThreadLocalMap&lt;/code&gt;ä¸­çš„&lt;code&gt;key&lt;/code&gt;ä½¿ç”¨äº†å¼±å¼•ç”¨ï¼Œä¹Ÿæœ‰å¯èƒ½å†…å­˜æ³„æ¼ã€‚&lt;/p&gt;
&lt;h3 id=&#34;5å‡ºç°å†…å­˜æ³„æ¼çš„çœŸå®åŸå› &#34;&gt;ï¼ˆ5ï¼‰å‡ºç°å†…å­˜æ³„æ¼çš„çœŸå®åŸå› &lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/ThreadLocal%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F%E7%9C%9F%E6%AD%A3%E5%8E%9F%E5%9B%A0.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;æ¯”è¾ƒä»¥ä¸Šä¸¤ç§æƒ…å†µï¼Œæˆ‘ä»¬å°±ä¼šå‘ç°ï¼Œå†…å­˜æ³„æ¼çš„å‘ç”Ÿè·Ÿ&lt;code&gt;ThreadLocalMap&lt;/code&gt;ä¸­çš„&lt;code&gt;key&lt;/code&gt;æ˜¯å¦ä½¿ç”¨å¼±å¼•ç”¨æ˜¯æ²¡æœ‰å…³ç³»çš„ã€‚é‚£ä¹ˆå†…å­˜æ³„æ¼çš„çš„çœŸæ­£åŸå› æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ç»†å¿ƒçš„åŒå­¦ä¼šå‘ç°ï¼Œåœ¨ä»¥ä¸Šä¸¤ç§å†…å­˜æ³„æ¼çš„æƒ…å†µä¸­ï¼Œéƒ½æœ‰ä¸¤ä¸ªå‰æï¼š&lt;/p&gt;
&lt;p&gt;1.æ²¡æœ‰æ‰‹åŠ¨åˆ é™¤è¿™ä¸ª&lt;code&gt;Entry&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;2.&lt;code&gt;CurrentThread&lt;/code&gt;ä¾ç„¶è¿è¡Œ&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€ç‚¹å¾ˆå¥½ç†è§£ï¼Œåªè¦åœ¨ä½¿ç”¨å®Œ&lt;code&gt;ThreadLocal&lt;/code&gt;ï¼Œè°ƒç”¨å…¶&lt;code&gt;remove&lt;/code&gt;æ–¹æ³•åˆ é™¤å¯¹åº”çš„&lt;code&gt;Entry&lt;/code&gt;ï¼Œå°±èƒ½é¿å…å†…å­˜æ³„æ¼ã€‚ç¬¬äºŒç‚¹ç¨å¾®å¤æ‚ä¸€ç‚¹ï¼Œç”±äº&lt;code&gt;ThreadLocalMap&lt;/code&gt;æ˜¯&lt;code&gt;Thread&lt;/code&gt;çš„ä¸€ä¸ªå±æ€§ï¼Œè¢«å½“å‰çº¿ç¨‹æ‰€å¼•ç”¨ï¼Œæ‰€ä»¥å®ƒçš„ç”Ÿå‘½å‘¨æœŸè·Ÿ&lt;code&gt;Thread&lt;/code&gt;ä¸€æ ·é•¿ã€‚é‚£ä¹ˆåœ¨ä½¿ç”¨å®Œ&lt;code&gt;ThreadLocal&lt;/code&gt;çš„ä½¿ç”¨ï¼Œå¦‚æœå½“å‰&lt;code&gt;Thread&lt;/code&gt;ä¹Ÿéšä¹‹æ‰§è¡Œç»“æŸï¼Œ&lt;code&gt;ThreadLocalMap&lt;/code&gt;è‡ªç„¶ä¹Ÿä¼šè¢«&lt;code&gt;gc&lt;/code&gt;å›æ”¶ï¼Œä»æ ¹æºä¸Šé¿å…äº†å†…å­˜æ³„æ¼ã€‚&lt;/p&gt;
&lt;p&gt;ç»¼ä¸Šï¼Œ&lt;code&gt;ThreadLocal&lt;/code&gt;å†…å­˜æ³„æ¼çš„æ ¹æºæ˜¯ï¼šç”±äº&lt;code&gt;ThreadLocalMap&lt;/code&gt;çš„ç”Ÿå‘½å‘¨æœŸè·Ÿ&lt;code&gt;Thread&lt;/code&gt;ä¸€æ ·é•¿ï¼Œå¦‚æœæ²¡æœ‰æ‰‹åŠ¨åˆ é™¤å¯¹åº”&lt;code&gt;key&lt;/code&gt;å°±ä¼šå¯¼è‡´å†…å­˜æ³„æ¼ã€‚&lt;/p&gt;
&lt;h3 id=&#34;6ä¸ºä»€ä¹ˆä½¿ç”¨å¼±å¼•ç”¨&#34;&gt;ï¼ˆ6ï¼‰ä¸ºä»€ä¹ˆä½¿ç”¨å¼±å¼•ç”¨&lt;/h3&gt;
&lt;p&gt;æ ¹æ®åˆšæ‰çš„åˆ†æï¼Œæˆ‘ä»¬çŸ¥é“äº†ï¼šæ— è®ºä½¿ç”¨&lt;code&gt;ThreadLocalMap&lt;/code&gt;ä¸­çš„&lt;code&gt;key&lt;/code&gt;ä½¿ç”¨å“ªç§ç±»å‹å¼•ç”¨éƒ½æ— æ³•å®Œå…¨é¿å…å†…å­˜æ³„æ¼ï¼Œè·Ÿä½¿ç”¨å¼±å¼•ç”¨æ²¡æœ‰å…³ç³»ã€‚è¦é¿å…å†…å­˜æ³„æ¼æœ‰ä¸¤ç§æ–¹å¼ï¼š&lt;/p&gt;
&lt;p&gt;1.ä½¿ç”¨å®Œ&lt;code&gt;ThreadLocal&lt;/code&gt;ï¼Œè°ƒç”¨å…¶&lt;code&gt;remove&lt;/code&gt;æ–¹æ³•åˆ é™¤å¯¹åº”çš„&lt;code&gt;Entry&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;2.ä½¿ç”¨å®Œ&lt;code&gt;ThreadLocal&lt;/code&gt;ï¼Œå½“å‰&lt;code&gt;Thread&lt;/code&gt;ä¹Ÿéšä¹‹è¿è¡Œç»“æŸ&lt;/p&gt;
&lt;p&gt;ç›¸å¯¹ç¬¬ä¸€ç§æ–¹å¼ï¼Œç¬¬äºŒç§æ–¹å¼æ˜¾ç„¶æ›´ä¸å¥½æ§åˆ¶ï¼Œç‰¹åˆ«æ˜¯ä½¿ç”¨çº¿ç¨‹æ± çš„æ—¶å€™ï¼Œçº¿ç¨‹ç»“æŸæ˜¯ä¸ä¼šé”€æ¯çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦è®°å¾—åœ¨ä½¿ç”¨å®Œ&lt;code&gt;ThreadLocal&lt;/code&gt;åŠæ—¶çš„è°ƒç”¨&lt;code&gt;remove&lt;/code&gt;ï¼Œæ— è®º&lt;code&gt;key&lt;/code&gt;æ˜¯å¼ºå¼•ç”¨è¿˜æ˜¯å¼±å¼•ç”¨éƒ½ä¸ä¼šæœ‰é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;é‚£ä¹ˆä¸ºä»€ä¹ˆkeyè¦ç”¨å¼±å¼•ç”¨å‘¢ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;äº‹å®ä¸Šï¼Œåœ¨&lt;code&gt;ThreadLocalMap&lt;/code&gt;ä¸­çš„&lt;code&gt;set/getEntry&lt;/code&gt;æ–¹æ³•ä¸­ï¼Œä¼šå¯¹&lt;code&gt;key&lt;/code&gt;ä¸º&lt;code&gt;null&lt;/code&gt;ï¼ˆä¹Ÿå³æ˜¯&lt;code&gt;ThreadLocal&lt;/code&gt;ä¸º&lt;code&gt;null&lt;/code&gt;ï¼‰è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœä¸º&lt;code&gt;null&lt;/code&gt;çš„è¯ï¼Œé‚£ä¹ˆæ˜¯ä¼šå¯¹&lt;code&gt;value&lt;/code&gt;ç½®ä¸º&lt;code&gt;null&lt;/code&gt;çš„ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å°±æ„å‘³ç€ä½¿ç”¨å®Œ&lt;code&gt;ThreadLocal&lt;/code&gt;ï¼Œ&lt;code&gt;CurrentThread&lt;/code&gt;ä¾ç„¶è¿è¡Œçš„å‰æä¸‹ï¼Œå°±ç®—å¿˜è®°è°ƒç”¨&lt;code&gt;remove&lt;/code&gt;æ–¹æ³•ï¼Œå¼±å¼•ç”¨æ¯”å¼ºå¼•ç”¨å¯ä»¥å¤šä¸€å±‚ä¿éšœï¼šå¼±å¼•ç”¨çš„&lt;code&gt;ThreadLocal&lt;/code&gt;ä¼šè¢«å›æ”¶ï¼Œå¯¹åº”çš„&lt;code&gt;value&lt;/code&gt;åœ¨ä¸‹ä¸€æ¬¡&lt;code&gt;ThreadLocalMap&lt;/code&gt;è°ƒç”¨&lt;code&gt;set&lt;/code&gt;ï¼Œ&lt;code&gt;get&lt;/code&gt;ï¼Œ&lt;code&gt;remove&lt;/code&gt;ä¸­çš„ä»»ä¸€æ–¹æ³•çš„æ—¶å€™ä¼šè¢«æ¸…é™¤ï¼Œä»è€Œé¿å…å†…å­˜æ³„æ¼ã€‚&lt;/p&gt;
&lt;h2 id=&#34;53hashå†²çªçš„è§£å†³&#34;&gt;5.3hashå†²çªçš„è§£å†³&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;hash&lt;/code&gt;å†²çªçš„è§£å†³æ˜¯&lt;code&gt;Map&lt;/code&gt;ä¸­çš„ä¸€ä¸ªé‡è¦å†…å®¹ã€‚æˆ‘ä»¬ä»¥&lt;code&gt;hash&lt;/code&gt;å†²çªçš„è§£å†³ä¸ºçº¿ç´¢ï¼Œæ¥ç ”ç©¶ä¸€ä¸‹&lt;code&gt;ThreadLocalMap&lt;/code&gt;çš„æ ¸å¿ƒæºç ã€‚&lt;/p&gt;
&lt;h3 id=&#34;1é¦–å…ˆä»threadlocalçš„setæ–¹æ³•å…¥æ‰‹&#34;&gt;ï¼ˆ1ï¼‰é¦–å…ˆä»ThreadLocalçš„set(ï¼‰æ–¹æ³•å…¥æ‰‹&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;public void set(T value) {
    Thread t = Thread.currentThread();
    ThreadLocalMap map = getMap(t);
    if (map != null)
        map.set(this, value);
    else
        createMap(t, value);
}
ThreadLocalMap getMap(Thread t) {
    return t.threadLocals;
}
void createMap(Thread t, T firstValue) {
    t.threadLocals = new ThreadLocalMap(this, firstValue);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™ä¸ªæ–¹æ³•æˆ‘ä»¬åˆšæ‰åˆ†æè¿‡ï¼Œå…¶ä½œç”¨æ˜¯è®¾ç½®å½“å‰çº¿ç¨‹ç»‘å®šçš„å±€éƒ¨å˜é‡ï¼š&lt;br&gt;
A.é¦–å…ˆè·å–å½“å‰çº¿ç¨‹ï¼Œå¹¶æ ¹æ®å½“å‰çº¿ç¨‹è·å–ä¸€ä¸ª&lt;code&gt;Map&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;B.å¦‚æœè·å–çš„&lt;code&gt;Map&lt;/code&gt;ä¸ä¸ºç©ºï¼Œåˆ™å°†å‚æ•°è®¾ç½®åˆ°&lt;code&gt;Map&lt;/code&gt;ä¸­ï¼ˆå½“å‰&lt;code&gt;ThreadLocal&lt;/code&gt;çš„å¼•ç”¨ä½œä¸º&lt;code&gt;key&lt;/code&gt;ï¼‰&lt;/p&gt;
&lt;p&gt;ï¼ˆè¿™é‡Œè°ƒç”¨äº†&lt;code&gt;ThreadLocalMap&lt;/code&gt;çš„&lt;code&gt;set&lt;/code&gt;æ–¹æ³•ï¼‰&lt;/p&gt;
&lt;p&gt;C.å¦‚æœ&lt;code&gt;Map&lt;/code&gt;ä¸ºç©ºï¼Œåˆ™ç»™è¯¥çº¿ç¨‹åˆ›å»º&lt;code&gt;Map&lt;/code&gt;ï¼Œå¹¶è®¾ç½®åˆå§‹å€¼&lt;/p&gt;
&lt;p&gt;ï¼ˆè¿™é‡Œè°ƒç”¨äº†&lt;code&gt;ThreadLocalMap&lt;/code&gt;çš„æ„é€ æ–¹æ³•ï¼‰&lt;/p&gt;
&lt;h3 id=&#34;2æ„é€ æ–¹æ³•threadlocalmapthreadlocal-firstkey-object-firstvalue&#34;&gt;ï¼ˆ2ï¼‰æ„é€ æ–¹æ³•ThreadLocalMap(ThreadLocal&amp;lt;?&amp;gt; firstKey, Object firstValue)&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;/**
 * @param firstKey æœ¬åœ° ThreadLocal å®ä¾‹(this)
 * @param firstValue è¦ä¿å­˜çš„çº¿ç¨‹æœ¬åœ°å˜é‡
 */
ThreadLocalMap(ThreadLocal&amp;lt;?&amp;gt; firstKey, Object firstValue) {
    // åˆå§‹åŒ– table
    table = new ThreadLocal.ThreadLocalMap.Entry[INITIAL_CAPACITY];
    // è®¡ç®—ç´¢å¼•ï¼ˆé‡ç‚¹ä»£ç ï¼‰
    int i = firstKey.threadLocalHashCode &amp;amp; (INITIAL_CAPACITY - 1);
    // è®¾ç½®å€¼
    table[i] = new ThreadLocal.ThreadLocalMap.Entry(firstKey, firstValue);
    size = 1;
    // è®¾ç½®é˜ˆå€¼
    setThreshold(INITIAL_CAPACITY);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ„é€ å‡½æ•°é¦–å…ˆåˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º16çš„&lt;code&gt;Entry&lt;/code&gt;æ•°ç»„ï¼Œç„¶åè®¡ç®—å‡º&lt;code&gt;firstKey&lt;/code&gt;å¯¹åº”çš„ç´¢å¼•ï¼Œç„¶åå­˜å‚¨åˆ°&lt;code&gt;table&lt;/code&gt;ä¸­ï¼Œå¹¶è®¾ç½®&lt;code&gt;size&lt;/code&gt;å’Œ&lt;code&gt;threshold&lt;/code&gt;ã€‚&lt;br&gt;
é‡ç‚¹åˆ†æï¼š&lt;code&gt;int i = firstKey.threadLocalHashCode &amp;amp; (INITIAL_CAPACITY - 1);&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;a.å…³äº&lt;code&gt;firstkey.threadLocalHashcode&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;private final int threadLocalHashCode = nextHashCode();
private static int nextHashCode() {
    return nextHashCode.getAndAdd(HASH_INCREMENT);
}
// AtomicIntegerÂ æ˜¯ä¸€ä¸ªæä¾›åŸå­æ“ä½œçš„ Integerç±»ï¼Œé€šè¿‡çº¿ç¨‹å®‰å…¨çš„æ–¹å¼æ“ä½œåŠ å‡ï¼Œé€‚åˆé«˜å¹¶å‘æƒ…å†µä¸‹çš„ä½¿ç”¨
private static AtomicInteger nextHashCode =
    new AtomicInteger();
// ç‰¹æ®Šçš„ hash å€¼
private static final int HASH_INCREMENT = 0x61c88647;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™é‡Œå®šä¹‰äº†ä¸€ä¸ª&lt;code&gt;Atomiclnteger&lt;/code&gt;ç±»å‹ï¼Œæ¯æ¬¡è·å–å½“å‰å€¼å¹¶åŠ ä¸Š&lt;code&gt;HASH_INCREMENT&lt;/code&gt;ï¼Œ&lt;code&gt;HASH_INCREMENT=0x61c88647&lt;/code&gt;ï¼Œè¿™ä¸ªå€¼è·Ÿæ–æ³¢é‚£å¥‘æ•°åˆ—ï¼ˆé»„é‡‘åˆ†å‰²æ•°ï¼‰æœ‰å…³ï¼Œå…¶ä¸»è¦ç›®çš„å°±æ˜¯ä¸ºäº†è®©å“ˆå¸Œç èƒ½å‡åŒ€çš„åˆ†å¸ƒåœ¨2çš„næ¬¡æ–¹çš„æ•°ç»„é‡Œï¼Œä¹Ÿå°±æ˜¯&lt;code&gt;Entry[]]table&lt;/code&gt;ä¸­ï¼Œè¿™æ ·åšå¯ä»¥å°½é‡é¿å…&lt;code&gt;hash&lt;/code&gt;å†²çªã€‚&lt;/p&gt;
&lt;p&gt;b.å…³äº&lt;code&gt;&amp;amp;ï¼ˆINITIAL_CAPACITY-1ï¼‰&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;è®¡ç®—&lt;code&gt;hash&lt;/code&gt;çš„æ—¶å€™é‡Œé¢é‡‡ç”¨äº†&lt;code&gt;hashCode&amp;amp;(size-1)&lt;/code&gt;çš„ç®—æ³•ï¼Œè¿™ç›¸å½“äºå–æ¨¡è¿ç®—&lt;code&gt;hashCode%size&lt;/code&gt;çš„ä¸€ä¸ªæ›´é«˜æ•ˆçš„å®ç°ã€‚æ­£æ˜¯å› ä¸ºè¿™ç§ç®—æ³•ï¼Œæˆ‘ä»¬è¦æ±‚&lt;code&gt;size&lt;/code&gt;å¿…é¡»æ˜¯2çš„æ•´æ¬¡å¹‚ï¼Œè¿™ä¹Ÿèƒ½ä¿è¯ä¿è¯åœ¨ç´¢å¼•ä¸è¶Šç•Œçš„å‰æä¸‹ï¼Œä½¿å¾—&lt;code&gt;hash&lt;/code&gt;å‘ç”Ÿå†²çªçš„æ¬¡æ•°å‡å°ã€‚&lt;/p&gt;
&lt;h3 id=&#34;3threadlocalmapä¸­çš„setæ–¹æ³•&#34;&gt;ï¼ˆ3ï¼‰ThreadLocalMapä¸­çš„setæ–¹æ³•&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;private void set(ThreadLocal&amp;lt;?&amp;gt; key, Object value) {

    // We don&#39;t use a fast path as with get() because it is at
    // least as common to use set() to create new entries as
    // it is to replace existing ones, in which case, a fast
    // path would fail more often than not.

    ThreadLocal.ThreadLocalMap.Entry[] tab = table;
    int len = tab.length;
    // è®¡ç®—ç´¢å¼•ï¼ˆé‡ç‚¹ä»£ç ï¼‰
    int i = key.threadLocalHashCode &amp;amp; (len-1);

    /**
     * ä½¿ç”¨çº¿æ€§æ¢æµ‹æ³•æŸ¥æ‰¾å…ƒç´ ï¼ˆé‡ç‚¹ä»£ç ï¼‰
     */
    for (ThreadLocal.ThreadLocalMap.Entry e = tab[i];
         e != null;
         e = tab[i = nextIndex(i, len)]) {
        ThreadLocal&amp;lt;?&amp;gt; k = e.get();
        // ThreadLocal å¯¹åº”çš„ key å­˜åœ¨ï¼Œç›´æ¥è¦†ç›–ä¹‹å‰çš„å€¼
        if (k == key) {
            e.value = value;
            return;
        }

        // key ä¸º nullï¼Œä½†æ˜¯å€¼ä¸ä¸º nullï¼Œè¯´æ˜ä¹‹å‰çš„ ThreadLocal å¯¹è±¡å·²ç»è¢«å›æ”¶äº†
        // å½“å‰æ•°ç»„ä¸­çš„ Entry æ˜¯ä¸€ä¸ªé™ˆæ—§ï¼ˆstaleï¼‰çš„å…ƒç´ 
        if (k == null) {
            // ç”¨æ–°å…ƒç´ æ›¿æ¢æ—§å…ƒç´ ï¼Œè¿™ä¸ªæ–¹æ³•è¿›è¡Œäº†ä¸å°‘çš„åƒåœ¾æ¸…ç†åŠ¨ä½œï¼Œé˜²æ­¢å†…å­˜æ³„æ¼
            replaceStaleEntry(key, value, i);
            return;
        }
    }
    //ThreadLocalå¯¹åº”çš„keyä¸å­˜åœ¨å¹¶ä¸”æ²¡æœ‰æ‰¾åˆ°é™ˆæ—§çš„å…ƒç´ ï¼Œåˆ™åœ¨ç©ºå…ƒç´ çš„ä½ç½®åˆ›å»ºä¸€ä¸ªæ–°çš„Entryã€‚
    tab[i] = new ThreadLocal.ThreadLocalMap.Entry(key, value);
    int sz = ++size;
    /**
     * cleanSomeslotsç”¨äºæ¸…é™¤é‚£äº›e.get()==nu11çš„å…ƒç´ ï¼Œ
     * è¿™ç§æ•°æ®keyå…³è”çš„å¯¹è±¡å·²ç»è¢«å›æ”¶ï¼Œæ‰€ä»¥è¿™ä¸ªEntryï¼ˆtable[index]ï¼‰å¯ä»¥è¢«ç½®nu11ã€‚
     * å¦‚æœæ²¡æœ‰æ¸…é™¤ä»»ä½•entryï¼Œå¹¶ä¸”å½“å‰ä½¿ç”¨é‡è¾¾åˆ°äº†è´Ÿè½½å› å­æ‰€å®šä¹‰ï¼ˆé•¿åº¦çš„2/3ï¼‰ï¼Œé‚£ä¹ˆè¿›è¡Œ
     * rehashï¼ˆæ‰§è¡Œä¸€æ¬¡å…¨è¡¨çš„æ‰«ææ¸…ç†å·¥ä½œï¼‰
     */
    if (!cleanSomeSlots(i, sz) &amp;amp;&amp;amp; sz &amp;gt;= threshold)
        rehash();
}
// è·å–ç¯å½¢æ•°ç»„çš„ä¸‹ä¸€ä¸ªç´¢å¼•
private static int nextIndex(int i, int len) {
    return ((i + 1 &amp;lt; len) ? i + 1 : 0);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»£ç æ‰§è¡Œæµç¨‹ï¼š&lt;br&gt;
A.é¦–å…ˆè¿˜æ˜¯æ ¹æ®&lt;code&gt;key&lt;/code&gt;è®¡ç®—å‡ºç´¢å¼• iï¼Œç„¶åæŸ¥æ‰¾ä½ç½®ä¸Šçš„&lt;code&gt;Entry&lt;/code&gt;ï¼Œ&lt;br&gt;
B.è‹¥æ˜¯&lt;code&gt;Entry&lt;/code&gt;å·²ç»å­˜åœ¨å¹¶ä¸”&lt;code&gt;key&lt;/code&gt;ç­‰äºä¼ å…¥çš„&lt;code&gt;key&lt;/code&gt;ï¼Œé‚£ä¹ˆè¿™æ—¶å€™ç›´æ¥ç»™è¿™ä¸ª&lt;code&gt;Entry&lt;/code&gt;èµ‹æ–°çš„&lt;code&gt;value&lt;/code&gt;å€¼&lt;br&gt;
C.è‹¥æ˜¯&lt;code&gt;Entry&lt;/code&gt;å­˜åœ¨ï¼Œä½†æ˜¯&lt;code&gt;key&lt;/code&gt;ä¸º&lt;code&gt;null&lt;/code&gt;ï¼Œåˆ™è°ƒç”¨&lt;code&gt;replaceStaleEntry&lt;/code&gt;æ¥æ›´æ¢è¿™ä¸ª&lt;code&gt;key&lt;/code&gt;ä¸ºç©ºçš„&lt;code&gt;Entry&lt;/code&gt;ï¼Œ&lt;br&gt;
D.ä¸æ–­å¾ªç¯æ£€æµ‹ï¼Œç›´åˆ°é‡åˆ°ä¸º&lt;code&gt;null&lt;/code&gt;çš„åœ°æ–¹ï¼Œè¿™æ—¶å€™è¦æ˜¯è¿˜æ²¡åœ¨å¾ªç¯è¿‡ç¨‹ä¸­&lt;code&gt;return&lt;/code&gt;ï¼Œé‚£ä¹ˆå°±åœ¨è¿™ä¸ª&lt;code&gt;null&lt;/code&gt;çš„ä½ç½®æ–°å»ºä¸€ä¸ª&lt;code&gt;Entry&lt;/code&gt;ï¼Œå¹¶ä¸”æ’å…¥ï¼ŒåŒæ—¶&lt;code&gt;size&lt;/code&gt;å¢åŠ 1ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åè°ƒç”¨&lt;code&gt;cleanSomeSlots&lt;/code&gt;ï¼Œæ¸…ç†&lt;code&gt;key&lt;/code&gt;ä¸º&lt;code&gt;null&lt;/code&gt;çš„&lt;code&gt;Entry&lt;/code&gt;ï¼Œæœ€åè¿”å›æ˜¯å¦æ¸…ç†äº†&lt;code&gt;Entry&lt;/code&gt;ï¼Œæ¥ä¸‹æ¥å†åˆ¤æ–­&lt;code&gt;size&lt;/code&gt;æ˜¯å¦&lt;code&gt;&amp;gt;=thresgold&lt;/code&gt;è¾¾åˆ°äº†&lt;code&gt;rehash&lt;/code&gt;çš„æ¡ä»¶ï¼Œè¾¾åˆ°çš„è¯å°±ä¼šè°ƒç”¨&lt;code&gt;rehash&lt;/code&gt;å‡½æ•°æ‰§è¡Œä¸€æ¬¡å…¨è¡¨çš„æ‰«ææ¸…ç†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;é‡ç‚¹åˆ†æ&lt;/strong&gt;ï¼š&lt;code&gt;ThreadLocalMap&lt;/code&gt;ä½¿ç”¨&lt;strong&gt;çº¿æ€§æ¢æµ‹æ³•&lt;/strong&gt;æ¥è§£å†³å“ˆå¸Œå†²çªçš„ã€‚&lt;/p&gt;
&lt;p&gt;è¯¥æ–¹æ³•ä¸€æ¬¡æ¢æµ‹ä¸‹ä¸€ä¸ªåœ°å€ï¼Œç›´åˆ°æœ‰ç©ºçš„åœ°å€åæ’å…¥ï¼Œè‹¥æ•´ä¸ªç©ºé—´éƒ½æ‰¾ä¸åˆ°ç©ºä½™çš„åœ°å€ï¼Œåˆ™äº§ç”Ÿæº¢å‡ºã€‚&lt;/p&gt;
&lt;p&gt;ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾å½“å‰&lt;code&gt;table&lt;/code&gt;é•¿åº¦ä¸º16ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœè®¡ç®—å‡ºæ¥&lt;code&gt;key&lt;/code&gt;çš„&lt;code&gt;hash&lt;/code&gt;å€¼ä¸º14ï¼Œå¦‚æœ&lt;code&gt;table&lt;/code&gt;[14]ä¸Šå·²ç»æœ‰å€¼ï¼Œå¹¶ä¸”å…¶&lt;code&gt;key&lt;/code&gt;ä¸å½“å‰&lt;code&gt;key&lt;/code&gt;ä¸ä¸€è‡´ï¼Œé‚£ä¹ˆå°±å‘ç”Ÿäº†&lt;code&gt;hash&lt;/code&gt;å†²çªï¼Œè¿™ä¸ªæ—¶å€™å°†14+1å¾—åˆ°15ï¼Œå–table[15]è¿›è¡Œåˆ¤æ–­ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœè¿˜æ˜¯å†²çªä¼šå›åˆ°0ï¼Œå–table[0]ï¼Œä»¥æ­¤ç±»æ¨ï¼Œç›´åˆ°å¯ä»¥æ’å…¥ã€‚&lt;/p&gt;
&lt;p&gt;æŒ‰ç…§ä¸Šé¢çš„æè¿°ï¼Œå¯ä»¥æŠŠ&lt;code&gt;Entry[]table&lt;/code&gt;çœ‹æˆä¸€ä¸ªç¯å½¢æ•°ç»„ã€‚&lt;/p&gt;
">é¢è¯•é¢˜ â€”â€” ç”±æµ…å…¥æ·±å…¨é¢è§£æ ThreadLocal</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/mian-shi-ti-xi-lie-java-bing-fa/"" data-c="
          &lt;blockquote&gt;
&lt;p&gt;Java å¹¶å‘çš„ä¸œè¥¿æ¯”è¾ƒå¤šï¼Œä»Šå¤©å…ˆæ€»ç»“ä¸€éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&#34;1ä»€ä¹ˆæ˜¯çº¿ç¨‹å’Œè¿›ç¨‹&#34;&gt;1.ä»€ä¹ˆæ˜¯çº¿ç¨‹å’Œè¿›ç¨‹ï¼Ÿ&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;è¿›ç¨‹æ˜¯ OS èµ„æºåˆ†é…çš„åŸºæœ¬å•ä½ã€‚è¿›ç¨‹æ‹¥æœ‰ç‹¬ç«‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ã€‚&lt;/li&gt;
&lt;li&gt;çº¿ç¨‹æ˜¯ CPU è°ƒåº¦çš„åŸºæœ¬å•ä½ã€‚çº¿ç¨‹å…±äº«è¿›ç¨‹çš„å †ã€æ–¹æ³•åŒºèµ„æºï¼Œä½†æ¯ä¸ªçº¿ç¨‹æœ‰è‡ªå·±çš„ç¨‹åºè®¡æ•°å™¨ã€è™šæ‹Ÿæœºæ ˆã€æœ¬åœ°æ–¹æ³•æ ˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;2å¹¶å‘å’Œå¹¶è¡Œçš„åŒºåˆ«&#34;&gt;2.å¹¶å‘å’Œå¹¶è¡Œçš„åŒºåˆ«ï¼Ÿ&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;å¹¶å‘ï¼šç»Ÿä¸€æ—¶é—´æ®µå†…ï¼Œå¤šä¸ªä»»åŠ¡éƒ½åœ¨æ‰§è¡Œã€‚&lt;/li&gt;
&lt;li&gt;å¹¶è¡Œï¼šåŒä¸€æ—¶é—´å†…ï¼Œå¤šä¸ªä»»åŠ¡åŒæ—¶æ‰§è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;3ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å¤šçº¿ç¨‹&#34;&gt;3.ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å¤šçº¿ç¨‹ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;å…ˆä»æ€»ä½“ä¸Šæ¥è¯´ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä»è®¡ç®—æœºåº•å±‚æ¥è¯´ï¼šçº¿ç¨‹å¯ä»¥æ¯”ä½œæ˜¯è½»é‡çº§çš„è¿›ç¨‹ï¼Œæ˜¯ç¨‹åºæ‰§è¡Œçš„æœ€å°å•ä½ï¼Œ&lt;strong&gt;çº¿ç¨‹é—´çš„åˆ‡æ¢å’Œè°ƒåº¦çš„æˆæœ¬è¿œè¿œå°äºè¿›ç¨‹&lt;/strong&gt;å¦å¤–ï¼Œå¤šæ ¸CPUæ—¶ä»£æ„å‘³ç€å¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶è¿è¡Œï¼Œè¿™å‡å°‘äº†çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€ã€‚&lt;/li&gt;
&lt;li&gt;ä»å½“ä»£äº’è”ç½‘å‘å±•è¶‹åŠ¿æ¥è¯´ï¼šç°åœ¨çš„ç³»ç»ŸåŠ¨ä¸åŠ¨å°±è¦æ±‚ç™¾ä¸‡çº§ç”šè‡³åƒä¸‡çº§çš„å¹¶å‘é‡ï¼Œè€Œå¤šçº¿ç¨‹å¹¶å‘ç¼–ç¨‹æ­£æ˜¯å¼€å‘é«˜å¹¶å‘ç³»ç»Ÿçš„åŸºç¡€ï¼Œåˆ©ç”¨å¥½å¤šçº¿ç¨‹æœºåˆ¶å¯ä»¥å¤§å¤§æé«˜ç³»ç»Ÿæ•´ä½“çš„å¹¶å‘èƒ½åŠ›ä»¥åŠæ€§èƒ½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å†æ·±å…¥åˆ°è®¡ç®—æœºåº•å±‚æ¥æ¢è®¨ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å•æ ¸æ—¶ä»£ï¼šåœ¨å•æ ¸æ—¶ä»£å¤šçº¿ç¨‹ä¸»è¦æ˜¯ä¸ºäº†æé«˜CPUå’ŒIOè®¾å¤‡çš„ç»¼åˆåˆ©ç”¨ç‡ã€‚ä¸¾ä¸ªä¾‹å­ï¼šå½“åªæœ‰ä¸€ä¸ªçº¿ç¨‹çš„æ—¶å€™ä¼šå¯¼è‡´CPUè®¡ç®—æ—¶ï¼ŒIOè®¾å¤‡ç©ºé—²ï¼›è¿›è¡ŒIOæ“ä½œæ—¶ï¼ŒCPUç©ºé—²ã€‚æˆ‘ä»¬å¯ä»¥ç®€å•åœ°è¯´è¿™ä¸¤è€…çš„åˆ©ç”¨ç‡ç›®å‰éƒ½æ˜¯50%å·¦å³ã€‚ä½†æ˜¯å½“æœ‰ä¸¤ä¸ªçº¿ç¨‹çš„æ—¶å€™å°±ä¸ä¸€æ ·äº†ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹æ‰§è¡ŒCPUè®¡ç®—æ—¶ï¼Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è¿›è¡ŒIOæ“ä½œï¼Œè¿™æ ·ä¸¤ä¸ªçš„åˆ©ç”¨ç‡å°±å¯ä»¥åœ¨ç†æƒ³æƒ…å†µä¸‹è¾¾åˆ°100%äº†ã€‚&lt;/li&gt;
&lt;li&gt;å¤šæ ¸æ—¶ä»£ï¼šå¤šæ ¸æ—¶ä»£å¤šçº¿ç¨‹ä¸»è¦æ˜¯ä¸ºäº†&lt;strong&gt;æé«˜CPUåˆ©ç”¨ç‡&lt;/strong&gt;ã€‚ä¸¾ä¸ªä¾‹å­ï¼šå‡å¦‚æˆ‘ä»¬è¦è®¡ç®—ä¸€ä¸ªå¤æ‚çš„ä»»åŠ¡ï¼Œæˆ‘ä»¬åªç”¨ä¸€ä¸ªçº¿ç¨‹çš„è¯ï¼ŒCPUåªä¼šä¸€ä¸ªCPUæ ¸å¿ƒè¢«åˆ©ç”¨åˆ°ï¼Œè€Œåˆ›å»ºå¤šä¸ªçº¿ç¨‹å°±å¯ä»¥è®©å¤šä¸ªCPUæ ¸å¿ƒè¢«åˆ©ç”¨åˆ°ï¼Œè¿™æ ·å°±æé«˜äº†CPUçš„åˆ©ç”¨ç‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;4åˆ›å»ºçº¿ç¨‹çš„æ–¹å¼&#34;&gt;4.åˆ›å»ºçº¿ç¨‹çš„æ–¹å¼&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;å®ç° Runnable æ¥å£&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;// 1. å®ç° Runnable æ¥å£
class MyRunnable implements Runnbale{
  // 2. å®ç° run æ–¹æ³•
  public void run(){
    // ...
  }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;public static void main(String[] args){
  // 3. ä½¿ç”¨è‡ªå®šä¹‰ runnable å¯¹è±¡åˆ›å»ºçº¿ç¨‹
  MyRunnableÂ runnable = new MyRunnable();
  Thread thread = new Thread(runnable);
  // 4. start() å¯åŠ¨çº¿ç¨‹
  thread.start();
}
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;å®ç° Callable æ¥å£&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸ Runnable ç›¸æ¯”ï¼ŒCallable å¯ä»¥æœ‰è¿”å›å€¼ï¼Œè¿”å›å€¼ç”± FutureTask è¿›è¡Œå°è£…ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;// 1. å®ç° Callable æ¥å£ï¼Œå¹¶å£°æ˜æ³›å‹
class MyCallable implements Callable&amp;lt;Integer&amp;gt;{
  // 2. é‡å†™ call æ–¹æ³•
  public Integer call(){
    return 123;
  }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;public static void main(String[] args) throws ExecutionException, InterruptedException{
  MyCallable callable = new MyCallable();
  // 3. ä½¿ç”¨ FutureTask å°è£… call æ–¹æ³•çš„è¿”å›å€¼
  FutureTask&amp;lt;Integer&amp;gt; ft = new FutureTask&amp;lt;&amp;gt;(callable);
  Thread thread = new Thread(ft);
  thread.start();
  System.out.println(ft.get());
}
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;ç»§æ‰¿ Thread ç±»&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;class MyThread extends Thread{
  public void run(){
    // ...
  }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;public static void main(String[] args){
  MyThread thread = new MyThread();
  thread.start();
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;ç»§æ‰¿-vs-å®ç°æ¥å£&#34;&gt;ç»§æ‰¿ vs å®ç°æ¥å£&lt;/h2&gt;
&lt;p&gt;å®ç°æ¥å£æ›´å¥½ä¸€äº›ï¼Œå› ä¸ºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Java ä¸æ”¯æŒå¤šé‡ç»§æ‰¿ï¼Œå› æ­¤ç»§æ‰¿äº† Thread ç±»å°±æ— æ³•é›†æˆå…¶å®ƒç±»ï¼Œä½†æ˜¯å¯ä»¥å®ç°å¤šä¸ªæ¥å£ã€‚&lt;/li&gt;
&lt;li&gt;é€‚åˆå¤šä¸ªçº¿ç¨‹è¿›è¡Œèµ„æºå…±äº«ï¼ˆRunnable ç±»å¯ä»¥ä½œä¸ºå¤šä¸ª Thread æ„é€ æ–¹æ³•çš„å‚æ•°ï¼‰&lt;/li&gt;
&lt;li&gt;çº¿ç¨‹æ± å†…åªèƒ½æ”¾å…¥ Runnable æˆ– Callable æ¥å£çš„å®ç°ç±»ï¼Œä¸èƒ½æ”¾å…¥ç»§æ‰¿ Thread å¯¹è±¡çš„ç±»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;5runnable-æ¥å£å’Œ-callable-æ¥å£çš„åŒºåˆ«&#34;&gt;5.Runnable æ¥å£å’Œ Callable æ¥å£çš„åŒºåˆ«&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Runnable æ¥å£é‡å†™çš„æ˜¯ run æ–¹æ³•ï¼ŒCallable æ¥å£é‡å†™çš„æ˜¯ call æ–¹æ³•&lt;/li&gt;
&lt;li&gt;run æ–¹æ³•æ‰§è¡Œåä¸èƒ½æœ‰è¿”å›å€¼ï¼Œcall æ–¹æ³•æ‰§è¡Œåå¯ä»¥æœ‰è¿”å›å€¼ã€‚&lt;/li&gt;
&lt;li&gt;call()æ–¹æ³•å¯ä»¥æŠ›å‡ºå¼‚å¸¸ï¼Œrun()æ–¹æ³•ä¸å¯ä»¥&lt;/li&gt;
&lt;li&gt;è¿è¡ŒCallableä»»åŠ¡å¯ä»¥æ‹¿åˆ°ä¸€ä¸ªFutureå¯¹è±¡ï¼Œè¡¨ç¤ºå¼‚æ­¥è®¡ç®—çš„ç»“æœ ã€‚é€šè¿‡Futureå¯¹è±¡å¯ä»¥äº†è§£ä»»åŠ¡æ‰§è¡Œæƒ…å†µï¼Œå¯å–æ¶ˆä»»åŠ¡çš„æ‰§è¡Œï¼Œè¿˜å¯è·å–æ‰§è¡Œç»“æœã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;6start-æ–¹æ³•å’Œ-run-æ–¹æ³•çš„åŒºåˆ«&#34;&gt;6.start() æ–¹æ³•å’Œ run() æ–¹æ³•çš„åŒºåˆ«&lt;/h1&gt;
&lt;p&gt;new ä¸€ä¸ª Threadï¼Œçº¿ç¨‹è¿›å…¥äº†æ–°å»ºçŠ¶æ€&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;start() æ–¹æ³•å¯ä»¥å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ï¼Œå°†çº¿ç¨‹ç”±æ–°å»ºçŠ¶æ€åˆ‡æ¢åˆ°å°±ç»ªæ€ã€‚&lt;/li&gt;
&lt;li&gt;run() æ–¹æ³•ä¸ä¼šå¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ï¼Œåªä¼šæŠŠå®ƒå½“åšä¸€ä¸ªæ™®é€šæ–¹æ³•å»æ‰§è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;7sleep-æ–¹æ³•å’Œ-wait-æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«&#34;&gt;7.sleep æ–¹æ³•å’Œ wait æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;wait() æ˜¯ Object ç±»çš„æ–¹æ³•ï¼Œè€Œ sleep() æ˜¯ Thread çš„é™æ€æ–¹æ³•ã€‚&lt;/li&gt;
&lt;li&gt;sleep å’Œ wait æ–¹æ³•éƒ½å¯ä»¥ç”¨æ¥æ”¾å¼ƒ CPU ä¸€å®šæ—¶é—´ï¼Œ&lt;strong&gt;æš‚åœçº¿ç¨‹çš„æ‰§è¡Œ&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ˜¯å¦é‡Šæ”¾é”&lt;/strong&gt;ï¼šä¸¤è€…æœ€ä¸»è¦çš„åŒºåˆ«åœ¨äºï¼šsleep æ–¹æ³•ä¸ä¼šé‡Šæ”¾é”ï¼Œè€Œ wait æ–¹æ³•ä¼šé‡Šæ”¾é”ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç”¨é€”&lt;/strong&gt;ï¼šwait é€šå¸¸ç”¨äºçº¿ç¨‹é—´äº¤äº’ / é€šä¿¡ï¼Œsleep é€šå¸¸è¢«ç”¨äºæš‚åœæ‰§è¡Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ˜¯å¦ä¼šè‡ªåŠ¨è‹é†’&lt;/strong&gt;ï¼šwait æ–¹æ³•è¢«è°ƒç”¨åï¼Œçº¿ç¨‹ä¸ä¼šè‡ªåŠ¨è‹é†’ï¼Œéœ€è¦åˆ«çš„çº¿ç¨‹è°ƒç”¨åŒä¸€ä¸ªå¯¹è±¡ä¸Šçš„ notify() æˆ–è€… notifyAll() æ–¹æ³•ã€‚sleep() æ–¹æ³•æ‰§è¡Œå®Œæˆåï¼Œçº¿ç¨‹ä¼šè‡ªåŠ¨è‹é†’ã€‚æˆ–è€…å¯ä»¥ä½¿ç”¨ wait(long timeout) è¶…æ—¶åçº¿ç¨‹ä¼šè‡ªåŠ¨è‹é†’ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;8reentrantlock-å’Œ-synchronized-çš„æ¯”è¾ƒ&#34;&gt;8.ReentrantLock å’Œ synchronized çš„æ¯”è¾ƒ&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;é”çš„å®ç°&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;synchronized æ˜¯ JVM å®ç°çš„ï¼Œè€Œ ReentrantLock æ˜¯ JDK å®ç°çš„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;æ€§èƒ½&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æ–°ç‰ˆæœ¬ Java å¯¹ synchronized è¿›è¡Œäº†å¾ˆå¤šä¼˜åŒ–ï¼Œä¾‹å¦‚è‡ªæ—‹é”ç­‰ï¼Œsynchronized å’Œ ReentrantLock å¤§è‡´ç›¸åŒã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;ç­‰å¾…å¯ä¸­æ–­&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;å½“æŒæœ‰é”çš„çº¿ç¨‹é•¿æœŸä¸é‡Šæ”¾é”æ—¶ï¼Œæ­£åœ¨ç­‰å¾…çš„çº¿ç¨‹å¯ä»¥é€‰æ‹©æ”¾å¼ƒç­‰å¾…ï¼Œæ”¹ä¸ºå¤„ç†å…¶ä»–äº‹æƒ…ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ReentrantLock å¯ä¸­æ–­ï¼Œè€Œ synchronized ä¸è¡Œã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;å…¬å¹³é”&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;å…¬å¹³é”æ˜¯æŒ‡å¤šä¸ªçº¿ç¨‹åœ¨ç­‰å¾…åŒä¸€ä¸ªé”æ—¶ï¼Œå¿…é¡»æŒ‰ç…§ç”³è¯·é”çš„æ—¶é—´é¡ºåºæ¥ä¾æ¬¡è·å¾—é”ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;synchronized æ˜¯ä¸å…¬å¹³é”ï¼Œè€Œ ReentrantLock é»˜è®¤æƒ…å†µä¸‹ä¹Ÿæ˜¯éå…¬å¹³çš„ï¼Œä½†æ˜¯å¯ä»¥åœ¨æ„é€ å‡½æ•°ä¸­è®¾ç½®å…¬å¹³è¿˜æ˜¯ä¸å…¬å¹³é”ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;é”ç»‘å®šå¤šä¸ªæ¡ä»¶&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€ä¸ª ReentrantLock å¯ä»¥åŒæ—¶ç»‘å®šå¤šä¸ª Condition å¯¹è±¡&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;6&#34;&gt;
&lt;li&gt;ä½¿ç”¨é€‰æ‹©&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;é™¤ééœ€è¦ä½¿ç”¨ ReentrantLock çš„é«˜çº§åŠŸèƒ½ï¼Œå¦åˆ™ä¼˜å…ˆä½¿ç”¨ synchronizedã€‚è¿™æ˜¯å› ä¸º synchronized æ˜¯ JVM å®ç°çš„ä¸€ ç§é”æœºåˆ¶ï¼ŒJVM åŸç”Ÿåœ°æ”¯æŒå®ƒï¼Œè€Œ ReentrantLock ä¸æ˜¯æ‰€æœ‰çš„ JDK ç‰ˆæœ¬éƒ½æ”¯æŒã€‚å¹¶ä¸”ä½¿ç”¨ synchronized ä¸ç”¨æ‹…å¿ƒæ²¡æœ‰é‡Šæ”¾é”è€Œå¯¼è‡´æ­»é”é—®é¢˜ï¼Œå› ä¸º JVM ä¼šç¡®ä¿é”çš„é‡Šæ”¾ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;9cyclicbarrierå’Œcountdownlatchçš„åŒºåˆ«&#34;&gt;9.CyclicBarrierå’ŒCountDownLatchçš„åŒºåˆ«&lt;/h1&gt;
&lt;h2 id=&#34;countdownlatch&#34;&gt;CountDownLatch&lt;/h2&gt;
&lt;p&gt;ç”¨æ¥æ§åˆ¶ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…å¤šä¸ªçº¿ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;ç»´æŠ¤äº†ä¸€ä¸ªè®¡æ•°å™¨ cntï¼Œ&lt;strong&gt;æ¯æ¬¡è°ƒç”¨ countDown() æ–¹æ³•ä¼šè®©è®¡æ•°å™¨çš„å€¼å‡ 1ï¼Œå‡åˆ° 0 çš„æ—¶å€™ï¼Œé‚£äº›å› ä¸ºè°ƒç”¨ await() æ–¹æ³•è€Œåœ¨ç­‰å¾…çš„çº¿ç¨‹å°±ä¼šè¢«å”¤é†’&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;cyclicbarrier&#34;&gt;CyclicBarrier&lt;/h2&gt;
&lt;p&gt;ç”¨æ¥æ§åˆ¶å¤šä¸ªçº¿ç¨‹äº’ç›¸ç­‰å¾…ï¼Œåªæœ‰å½“å¤šä¸ªçº¿ç¨‹éƒ½åˆ°è¾¾æ—¶ï¼Œè¿™äº›çº¿ç¨‹æ‰ä¼šç»§ç»­æ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;å’Œ CountdownLatch ç›¸ä¼¼ï¼Œéƒ½æ˜¯é€šè¿‡ç»´æŠ¤è®¡æ•°å™¨æ¥å®ç°çš„ã€‚&lt;strong&gt;çº¿ç¨‹æ‰§è¡Œ await() æ–¹æ³•ä¹‹åè®¡æ•°å™¨ä¼šå‡ 1ï¼Œå¹¶è¿›è¡Œç­‰å¾…ï¼Œç›´åˆ°è®¡æ•°å™¨ä¸º 0ï¼Œæ‰€æœ‰è°ƒç”¨ await() æ–¹æ³•è€Œåœ¨ç­‰å¾…çš„çº¿ç¨‹æ‰èƒ½ç»§ç»­æ‰§è¡Œ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;CyclicBarrier å’Œ CountdownLatch çš„ä¸€ä¸ªåŒºåˆ«æ˜¯ï¼ŒCyclicBarrier çš„è®¡æ•°å™¨é€šè¿‡è°ƒç”¨ reset() æ–¹æ³•å¯ä»¥å¾ªç¯ä½¿ç”¨ï¼Œæ‰€ä»¥å®ƒæ‰å«åš&lt;strong&gt;å¾ªç¯å±éšœ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;CyclicBarrier æœ‰ä¸¤ä¸ªæ„é€ å‡½æ•°ï¼Œå…¶ä¸­ parties æŒ‡ç¤ºè®¡æ•°å™¨çš„åˆå§‹å€¼ï¼ŒbarrierAction åœ¨æ‰€æœ‰çº¿ç¨‹éƒ½åˆ°è¾¾å±éšœçš„æ—¶å€™ä¼šæ‰§è¡Œä¸€æ¬¡ã€‚&lt;/p&gt;
&lt;h1 id=&#34;10semaphoreæœ‰ä»€ä¹ˆä½œç”¨&#34;&gt;10.Semaphoreæœ‰ä»€ä¹ˆä½œç”¨&lt;/h1&gt;
&lt;p&gt;Semaphoreå°±æ˜¯ä¸€ä¸ªä¿¡å·é‡ï¼Œå®ƒçš„ä½œç”¨æ˜¯&lt;strong&gt;é™åˆ¶æŸæ®µä»£ç å—çš„å¹¶å‘æ•°&lt;/strong&gt;ã€‚Semaphoreæœ‰ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå¯ä»¥ä¼ å…¥ä¸€ä¸ªintå‹æ•´æ•°nï¼Œè¡¨ç¤ºæŸæ®µä»£ç æœ€å¤šåªæœ‰nä¸ªçº¿ç¨‹å¯ä»¥è®¿é—®ï¼Œå¦‚æœè¶…å‡ºäº†nï¼Œé‚£ä¹ˆè¯·ç­‰å¾…ï¼Œç­‰åˆ°æŸä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•è¿™æ®µä»£ç å—ï¼Œä¸‹ä¸€ä¸ªçº¿ç¨‹å†è¿›å…¥ã€‚ç”±æ­¤å¯ä»¥çœ‹å‡ºå¦‚æœSemaphoreæ„é€ å‡½æ•°ä¸­ä¼ å…¥çš„intå‹æ•´æ•°n=1ï¼Œç›¸å½“äºå˜æˆäº†ä¸€ä¸ªsynchronizedäº†ã€‚&lt;/p&gt;
&lt;h1 id=&#34;11volatileå…³é”®å­—çš„ä½œç”¨&#34;&gt;11.volatileå…³é”®å­—çš„ä½œç”¨&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;ä¿è¯äº†å¯è§æ€§ï¼Œä¸èƒ½ä¿è¯åŸå­æ€§&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç«‹åˆ»å°†ç¼“å­˜ä¸­çš„å€¼å†™åˆ°å†…å­˜ï¼›çº¿ç¨‹é€šè¿‡å—…æ¢æ€»çº¿ä¸Šä¼ æ’­è¿‡æ¥çš„æ•°æ®ç›‘æµ‹è‡ªå·±çš„ç¼“å­˜æ˜¯å¦è¿‡æœŸäº†ï¼Œå¦‚æœè¿‡æœŸäº†ï¼Œå°±æŠŠç¼“å­˜å†…çš„å€¼è®¾ç½®ä¸ºå¤±æ•ˆï¼Œå¦‚æœè¦ä¿®æ”¹æ—¶ï¼Œå°±å»ä¸»å­˜è¯»å–æ–°å€¼ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¦æ­¢æŒ‡ä»¤é‡æ’&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;12ä½¿ç”¨-blockingqueue-ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜&#34;&gt;12.ä½¿ç”¨ BlockingQueue ç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;public class ProductConsumer{
  private static BlockingQueue&amp;lt;String&amp;gt; queue = new BlockingQueue&amp;lt;&amp;gt;();
  private static class Producer extends Thread{
    @Override
    public void run(){
      try{
        queue.put(&amp;quot;product&amp;quot;);
      }catch(InterruptedException e){
        e.printStackTrace();
      }
      System.out.print(&amp;quot;produce...&amp;quot;);
    }
  }
  private static class Consumer extends Thread{
    @Override
    public void run(){
      try{
        String product = queue.take();
      }catch(InterruptedException e){
        e.printStackTrace();
      }
      System.out.print(&amp;quot;consume...&amp;quot;)
    }
  }
  public static void main(String[] args) {
    for (int i = 0; i &amp;lt; 2; i++) {
        Producer producer = new Producer();
        producer.start();
    }
    for (int i = 0; i &amp;lt; 5; i++) {
        Consumer consumer = new Consumer();
        consumer.start();
    }
    for (int i = 0; i &amp;lt; 3; i++) {
        Producer producer = new Producer();
        producer.start();
    }Â 
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œç»“æœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;produce..produce..consume..consume..produce..consume..produce..consume..produce..consume..Â 
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;13ä¸€ä¸ªçº¿ç¨‹å¦‚æœå‡ºç°äº†è¿è¡Œæ—¶å¼‚å¸¸ä¼šæ€ä¹ˆæ ·&#34;&gt;13.ä¸€ä¸ªçº¿ç¨‹å¦‚æœå‡ºç°äº†è¿è¡Œæ—¶å¼‚å¸¸ä¼šæ€ä¹ˆæ ·&lt;/h1&gt;
&lt;p&gt;å¦‚æœè¿™ä¸ªå¼‚å¸¸æ²¡æœ‰è¢«æ•è·çš„è¯ï¼Œè¿™ä¸ªçº¿ç¨‹å°±åœæ­¢æ‰§è¡Œäº†ã€‚å¦å¤–é‡è¦çš„ä¸€ç‚¹æ˜¯ï¼š&lt;strong&gt;å¦‚æœè¿™ä¸ªçº¿ç¨‹æŒæœ‰æŸä¸ªæŸä¸ªå¯¹è±¡çš„ç›‘è§†å™¨ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡ç›‘è§†å™¨ä¼šè¢«ç«‹å³é‡Šæ”¾&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&#34;14threadlocalæœ‰ä»€ä¹ˆç”¨&#34;&gt;14.ThreadLocalæœ‰ä»€ä¹ˆç”¨&lt;/h1&gt;
&lt;p&gt;çº¿ç¨‹å±€éƒ¨å˜é‡ï¼Œ&lt;strong&gt;ä»¥ç©ºé—´æ¢æ—¶é—´&lt;/strong&gt;ï¼Œæ¯ä¸ªçº¿ç¨‹å†…éƒ½æœ‰ä¸€ä¸ªï¼ŒæŠŠæ•°æ®è¿›è¡Œéš”ç¦»ï¼Œè§£å†³å¤šçº¿ç¨‹ä¹‹é—´å…±äº«æ•°æ®çš„å®‰å…¨é—®é¢˜ã€‚&lt;/p&gt;
&lt;h1 id=&#34;15waitæ–¹æ³•å’Œnotifynotifyallæ–¹æ³•åœ¨æ”¾å¼ƒå¯¹è±¡ç›‘è§†å™¨æ—¶æœ‰ä»€ä¹ˆåŒºåˆ«&#34;&gt;15.wait()æ–¹æ³•å’Œnotify()/notifyAll()æ–¹æ³•åœ¨æ”¾å¼ƒå¯¹è±¡ç›‘è§†å™¨æ—¶æœ‰ä»€ä¹ˆåŒºåˆ«&lt;/h1&gt;
&lt;p&gt;wait()æ–¹æ³•å’Œnotify()/notifyAll()æ–¹æ³•åœ¨æ”¾å¼ƒå¯¹è±¡ç›‘è§†å™¨çš„æ—¶å€™çš„åŒºåˆ«åœ¨äºï¼š&lt;strong&gt;wait()æ–¹æ³•ç«‹å³é‡Šæ”¾å¯¹è±¡ç›‘è§†å™¨ï¼Œnotify()/notifyAll()æ–¹æ³•åˆ™ä¼šç­‰å¾…çº¿ç¨‹å‰©ä½™ä»£ç æ‰§è¡Œå®Œæ¯•æ‰ä¼šæ”¾å¼ƒå¯¹è±¡ç›‘è§†å™¨&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h1 id=&#34;16ä¸ºä»€ä¹ˆè¦ä½¿ç”¨çº¿ç¨‹æ± &#34;&gt;16.ä¸ºä»€ä¹ˆè¦ä½¿ç”¨çº¿ç¨‹æ± &lt;/h1&gt;
&lt;p&gt;æ¥ä¸€ä¸ªè¯·æ±‚åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œæ‰§è¡Œç»“æŸå†é”€æ¯çº¿ç¨‹ï¼Œèµ„æºè€—è´¹å¤ªå¤§ï¼Œä½¿ç”¨çº¿ç¨‹æ± è¾¾åˆ°å¯¹&lt;strong&gt;çº¿ç¨‹çš„å¤ç”¨&lt;/strong&gt;ã€‚ä½¿ç”¨çº¿ç¨‹æ± è¿˜å¯ä»¥çµæ´»åœ°æ§åˆ¶å¹¶å‘çš„æ•°ç›®ã€‚&lt;/p&gt;
&lt;h1 id=&#34;17æ€ä¹ˆæ£€æµ‹ä¸€ä¸ªçº¿ç¨‹æ˜¯å¦æŒæœ‰å¯¹è±¡ç›‘è§†å™¨&#34;&gt;17.æ€ä¹ˆæ£€æµ‹ä¸€ä¸ªçº¿ç¨‹æ˜¯å¦æŒæœ‰å¯¹è±¡ç›‘è§†å™¨&lt;/h1&gt;
&lt;p&gt;æˆ‘ä¹Ÿæ˜¯åœ¨ç½‘ä¸Šçœ‹åˆ°ä¸€é“å¤šçº¿ç¨‹é¢è¯•é¢˜æ‰çŸ¥é“æœ‰æ–¹æ³•å¯ä»¥åˆ¤æ–­æŸä¸ªçº¿ç¨‹æ˜¯å¦æŒæœ‰å¯¹è±¡ç›‘è§†å™¨ï¼šThreadç±»æä¾›äº†ä¸€ä¸ªholdsLock(Object obj)æ–¹æ³•ï¼Œå½“ä¸”ä»…å½“å¯¹è±¡objçš„ç›‘è§†å™¨è¢«æŸæ¡çº¿ç¨‹æŒæœ‰çš„æ—¶å€™æ‰ä¼šè¿”å›trueï¼Œæ³¨æ„è¿™æ˜¯ä¸€ä¸ªstaticæ–¹æ³•ï¼Œè¿™æ„å‘³ç€&amp;quot;æŸæ¡çº¿ç¨‹&amp;quot;æŒ‡çš„æ˜¯å½“å‰çº¿ç¨‹ã€‚&lt;/p&gt;
&lt;h1 id=&#34;18concurrenthashmapçš„å¹¶å‘åº¦æ˜¯ä»€ä¹ˆ&#34;&gt;18.ConcurrentHashMapçš„å¹¶å‘åº¦æ˜¯ä»€ä¹ˆ&lt;/h1&gt;
&lt;p&gt;ConcurrentHashMapçš„å¹¶å‘åº¦å°±æ˜¯segmentçš„å¤§å°ï¼Œé»˜è®¤ä¸º16ï¼Œè¿™æ„å‘³ç€æœ€å¤šåŒæ—¶å¯ä»¥æœ‰16æ¡çº¿ç¨‹æ“ä½œConcurrentHashMapï¼Œè¿™ä¹Ÿæ˜¯ConcurrentHashMapå¯¹Hashtableçš„æœ€å¤§ä¼˜åŠ¿ï¼Œä»»ä½•æƒ…å†µä¸‹ï¼ŒHashtableèƒ½åŒæ—¶æœ‰ä¸¤æ¡çº¿ç¨‹è·å–Hashtableä¸­çš„æ•°æ®å—ï¼Ÿ&lt;/p&gt;
&lt;h1 id=&#34;19futuretaskæ˜¯ä»€ä¹ˆ&#34;&gt;19.FutureTaskæ˜¯ä»€ä¹ˆ&lt;/h1&gt;
&lt;p&gt;åœ¨ä»‹ç» Callable æ—¶æˆ‘ä»¬çŸ¥é“å®ƒå¯ä»¥æœ‰è¿”å›å€¼ï¼Œè¿”å›å€¼é€šè¿‡ Future è¿›è¡Œå°è£…ã€‚FutureTask å®ç°äº† RunnableFuture æ¥å£ï¼Œè¯¥æ¥å£ç»§æ‰¿è‡ª Runnable å’Œ Future æ¥å£ï¼Œè¿™ä½¿å¾— FutureTask æ—¢å¯ä»¥å½“åšä¸€ä¸ªä»»åŠ¡æ‰§è¡Œï¼Œä¹Ÿå¯ä»¥æœ‰è¿”å›å€¼ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public class FutureTask&amp;lt;V&amp;gt; implements RunnableFuture&amp;lt;V&amp;gt; 
public interface RunnableFuture&amp;lt;V&amp;gt; extends Runnable, Future&amp;lt;V&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;FutureTask å¯ç”¨&lt;strong&gt;äºå¼‚æ­¥è·å–æ‰§è¡Œç»“æœ&lt;/strong&gt;æˆ–&lt;strong&gt;å–æ¶ˆæ‰§è¡Œä»»åŠ¡çš„åœºæ™¯&lt;/strong&gt;ã€‚å½“ä¸€ä¸ªè®¡ç®—ä»»åŠ¡éœ€è¦æ‰§è¡Œå¾ˆé•¿æ—¶é—´ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨ FutureTask æ¥å°è£…è¿™ä¸ªä»»åŠ¡ï¼Œä¸»çº¿ç¨‹åœ¨å®Œæˆè‡ªå·±çš„ä»»åŠ¡ä¹‹åå†å»è·å–ç»“æœã€‚&lt;/p&gt;
&lt;h1 id=&#34;20aqs&#34;&gt;20.AQS&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;æ¦‚å¿µ&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;AbstractQueuedSynchronizer&lt;/li&gt;
&lt;li&gt;åŒæ­¥å‘ç”Ÿå™¨&lt;/li&gt;
&lt;li&gt;æ„å»º LOCK&lt;/li&gt;
&lt;li&gt;JUCï¼šjava.util.current&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;åŸºæœ¬æ€æƒ³&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;AQSæ ¸å¿ƒæ€æƒ³æ˜¯ï¼Œå¦‚æœè¢«è¯·æ±‚çš„å…±äº«èµ„æºç©ºé—²ï¼Œåˆ™å°†å½“å‰è¯·æ±‚èµ„æºçš„çº¿ç¨‹è®¾ç½®ä¸ºæœ‰æ•ˆçš„å·¥ä½œçº¿ç¨‹ï¼Œå¹¶ä¸”å°†å…±äº«èµ„æºè®¾ç½®ä¸ºé”å®šçŠ¶æ€ã€‚å¦‚æœè¢«è¯·æ±‚çš„å…±äº«èµ„æºè¢«å ç”¨ï¼Œé‚£ä¹ˆå°±éœ€è¦ä¸€å¥—çº¿ç¨‹é˜»å¡ç­‰å¾…ä»¥åŠè¢«å”¤é†’æ—¶é”åˆ†é…çš„æœºåˆ¶ï¼Œè¿™ä¸ªæœºåˆ¶AQSæ˜¯ç”¨CLHé˜Ÿåˆ—é”å®ç°çš„ï¼Œå³å°†æš‚æ—¶è·å–ä¸åˆ°é”çš„çº¿ç¨‹åŠ å…¥åˆ°é˜Ÿåˆ—ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;CLH(Craig,Landin,and Hagersten)é˜Ÿåˆ—æ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„åŒå‘é˜Ÿåˆ—ï¼ˆè™šæ‹Ÿçš„åŒå‘é˜Ÿåˆ—å³ä¸å­˜åœ¨é˜Ÿåˆ—å®ä¾‹ï¼Œä»…å­˜åœ¨ç»“ç‚¹ä¹‹é—´çš„å…³è”å…³ç³»ï¼‰ã€‚AQS æ˜¯å°†æ¯æ¡è¯·æ±‚å…±äº«èµ„æºçš„çº¿ç¨‹å°è£…æˆä¸€ä¸ª CLH é”é˜Ÿåˆ—çš„ä¸€ä¸ªç»“ç‚¹ï¼ˆNodeï¼‰æ¥å®ç°é”çš„åˆ†é…ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;CLHåŒæ­¥é˜Ÿåˆ—&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/CLH%E5%90%8C%E6%AD%A5%E9%98%9F%E5%88%97.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;AQS ä½¿ç”¨ä¸€ä¸ª int æˆå‘˜å˜é‡æ¥è¡¨ç¤ºåŒæ­¥çŠ¶æ€ï¼Œé€šè¿‡å†…ç½®çš„ FIFO é˜Ÿåˆ—æ¥å®Œæˆè·å–èµ„æºçº¿ç¨‹çš„æ’é˜Ÿå·¥ä½œã€‚AQS ä½¿ç”¨ CAS å¯¹è¯¥åŒæ­¥çŠ¶æ€è¿›è¡ŒåŸå­æ“ä½œå®ç°å¯¹å…¶å€¼çš„ä¿®æ”¹ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;private volatile int state;//å…±äº«å˜é‡ï¼Œä½¿ç”¨volatileä¿®é¥°ä¿è¯çº¿ç¨‹å¯è§æ€§
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;çŠ¶æ€ä¿¡æ¯é€šè¿‡ protected ç±»å‹çš„getStateï¼ŒsetStateï¼ŒcompareAndSetStateè¿›è¡Œæ“ä½œ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;//è¿”å›åŒæ­¥çŠ¶æ€çš„å½“å‰å€¼
protected final int getState() {
        return state;
}
 // è®¾ç½®åŒæ­¥çŠ¶æ€çš„å€¼
protected final void setState(int newState) {
        state = newState;
}
//åŸå­åœ°ï¼ˆCASæ“ä½œï¼‰å°†åŒæ­¥çŠ¶æ€å€¼è®¾ç½®ä¸ºç»™å®šå€¼updateå¦‚æœå½“å‰åŒæ­¥çŠ¶æ€çš„å€¼ç­‰äºexpectï¼ˆæœŸæœ›å€¼ï¼‰
protected final boolean compareAndSetState(int expect, int update) {
        return unsafe.compareAndSwapInt(this, stateOffset, expect, update);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;å‚è€ƒé“¾æ¥&#34;&gt;å‚è€ƒé“¾æ¥&lt;/h1&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/Snailclimb/JavaGuide/blob/master/docs/java/Multithread/JavaConcurrencyBasicsCommonInterviewQuestionsSummary.md&#34;&gt;https://github.com/Snailclimb/JavaGuide/blob/master/docs/java/Multithread/JavaConcurrencyBasicsCommonInterviewQuestionsSummary.md&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://mp.weixin.qq.com/s/SCugxnAV1_f3sq-UhFD7wg&#34;&gt;https://mp.weixin.qq.com/s/SCugxnAV1_f3sq-UhFD7wg&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://github.com/Snailclimb/JavaGuide/blob/master/docs/java/Multithread/AQS.md&#34;&gt;https://github.com/Snailclimb/JavaGuide/blob/master/docs/java/Multithread/AQS.md&lt;/a&gt;&lt;/p&gt;
">é¢è¯•é¢˜ç³»åˆ— â€”â€” Java å¹¶å‘</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/ji-yi-ge-mian-shi-ti-redis-yi-qi-dong-gua-liao-zen-me-ban/"" data-c="
          &lt;blockquote&gt;
&lt;p&gt;é¢è¯•å®˜ï¼šRedis ä¸€å¯åŠ¨å°±æŒ‚äº†æ€ä¹ˆåŠï¼Ÿ&lt;br&gt;
ç­”ï¼šæ·»åŠ  Redis é›†ç¾¤&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&#34;é›†ç¾¤ç®€ä»‹&#34;&gt;é›†ç¾¤ç®€ä»‹&lt;/h1&gt;
&lt;h2 id=&#34;ç°çŠ¶é—®é¢˜&#34;&gt;ç°çŠ¶é—®é¢˜&lt;/h2&gt;
&lt;h3 id=&#34;ä¸šåŠ¡å‘å±•è¿‡ç¨‹ä¸­é‡åˆ°çš„å³°å€¼ç“¶é¢ˆ&#34;&gt;ä¸šåŠ¡å‘å±•è¿‡ç¨‹ä¸­é‡åˆ°çš„å³°å€¼ç“¶é¢ˆ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;redisæä¾›çš„æœåŠ¡OPSå¯ä»¥è¾¾åˆ°10ä¸‡/ç§’ï¼Œå½“å‰ä¸šåŠ¡OPSå·²ç»è¾¾åˆ°20ä¸‡/ç§’&lt;/li&gt;
&lt;li&gt;å†…å­˜å•æœºå®¹é‡è¾¾åˆ°256Gï¼Œå½“å‰ä¸šåŠ¡éœ€æ±‚å†…å­˜å®¹é‡1T&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨é›†ç¾¤çš„æ–¹å¼å¯ä»¥å¿«é€Ÿè§£å†³ä¸Šè¿°é—®é¢˜&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;é›†ç¾¤æ¶æ„&#34;&gt;é›†ç¾¤æ¶æ„&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;é›†ç¾¤å°±æ˜¯ä½¿ç”¨ç½‘ç»œå°†è‹¥å¹²å°è®¡ç®—æœºè”é€šèµ·æ¥ï¼Œå¹¶æä¾›ç»Ÿä¸€çš„ç®¡ç†æ–¹å¼ï¼Œä½¿å…¶å¯¹å¤–å‘ˆç°å•æœºçš„æœåŠ¡æ•ˆæœ&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Redis%E9%9B%86%E7%BE%A4%E6%9E%B6%E6%9E%84.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;é›†ç¾¤ä½œç”¨&#34;&gt;é›†ç¾¤ä½œç”¨&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;åˆ†æ•£å•å°æœåŠ¡å™¨çš„è®¿é—®å‹åŠ›ï¼Œå®ç°è´Ÿè½½å‡è¡¡&lt;/li&gt;
&lt;li&gt;åˆ†æ•£å•å°æœåŠ¡å™¨çš„å­˜å‚¨å‹åŠ›ï¼Œå®ç°å¯æ‰©å±•æ€§&lt;/li&gt;
&lt;li&gt;é™ä½å•å°æœåŠ¡å™¨å®•æœºå¸¦æ¥çš„ä¸šåŠ¡ç¾éš¾&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Redis%E9%9B%86%E7%BE%A4%E4%BD%9C%E7%94%A8.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h1 id=&#34;redisé›†ç¾¤ç»“æ„è®¾è®¡&#34;&gt;Redisé›†ç¾¤ç»“æ„è®¾è®¡&lt;/h1&gt;
&lt;h2 id=&#34;æ•°æ®å­˜å‚¨è®¾è®¡&#34;&gt;&lt;strong&gt;æ•°æ®å­˜å‚¨è®¾è®¡&lt;/strong&gt;&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E8%AE%BE%E8%AE%A1.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸€ä¸ª key æ”¾åœ¨ Redis å­˜å‚¨ç©ºé—´ï¼šå•æœºæ–¹æ¡ˆã€‚&lt;br&gt;
ä¸€ä¸ª key å¯¹åº”å¤šä¸ªå­˜å‚¨ç©ºé—´ï¼Œå˜æˆå¤šå°è®¡ç®—æœºäº†ï¼Œåº”è¯¥æ€æ ·å­˜å‚¨å‘¢ï¼Ÿ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Redis%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A82.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ç®—æ³•è®¾è®¡ï¼Œè®¡ç®—å‡ºkeyåº”è¯¥ä¿å­˜çš„ä½ç½®&lt;/li&gt;
&lt;li&gt;å°†æ‰€æœ‰çš„å­˜å‚¨ç©ºé—´è®¡åˆ’åˆ‡å‰²æˆ16384ä»½ï¼Œæ¯å°ä¸»æœºä¿å­˜ä¸€éƒ¨åˆ†
&lt;ul&gt;
&lt;li&gt;æ¯ä»½ä»£è¡¨çš„æ˜¯ä¸€ä¸ªå­˜å‚¨ç©ºé—´ï¼Œä¸æ˜¯ä¸€ä¸ªkeyçš„ä¿å­˜ç©ºé—´&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å°†keyæŒ‰ç…§è®¡ç®—å‡ºçš„ç»“æœæ”¾åˆ°å¯¹åº”çš„å­˜å‚¨ç©ºé—´&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Redis%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A83.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;å‡å®šç°åœ¨æœ‰ä¸‰ä¸ªå­˜å‚¨ç©ºé—´ï¼Œçªç„¶åˆå¢åŠ äº†ä¸€ä¸ªå­˜å‚¨ç©ºé—´ã€‚æŠŠåŸæ¥çš„ä¸‰ä¸ª Redis å­˜å‚¨ç©ºé—´éƒ½è¿›è¡Œä¼˜åŒ–ï¼Œæ¯ä¸ªå­˜å‚¨ç©ºé—´æ‹¿å‡ºä¸€éƒ¨åˆ†ç»™æ–°çš„å­˜å‚¨ç©ºé—´&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;å¢å¼ºå¯æ‰©å±•æ€§&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Redis%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A85.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;æ—§çš„å­˜å‚¨ç©ºé—´ç»™æ–°çš„å­˜å‚¨ç©ºé—´ çš„ è¿™ä¸€å°å—ç©ºé—´ï¼ˆä¹Ÿå°±æ˜¯å‰é¢æ ‡è®°çš„37ï¼‰å«åšæ§½ï¼Œç”¨æ¥æ”¾æ•°æ®çš„ç©ºé—´åŒºåŸŸã€‚æ‰€è°“çš„å¢åŠ ã€åˆ é™¤ Redis å­˜å‚¨ç©ºé—´å°±æ˜¯ï¼šæ”¹å˜æ§½æ‰€å­˜å‚¨çš„ä½ç½®ä¸åŒã€‚&lt;br&gt;
æ§½æ›´æ¢ä½ç½®åï¼Œå¦‚ä½•çŸ¥é“å®ƒè¢«æ¢åˆ°å“ªé‡Œäº†å‘¢ï¼Ÿ&lt;br&gt;
å†…éƒ¨é€šè®¯è®¾è®¡&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;é›†ç¾¤å†…éƒ¨é€šè®¯è®¾è®¡&#34;&gt;&lt;strong&gt;é›†ç¾¤å†…éƒ¨é€šè®¯è®¾è®¡&lt;/strong&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å„ä¸ªæ•°æ®åº“ç›¸äº’é€šä¿¡ï¼Œä¿å­˜å„ä¸ªåº“ä¸­æ§½çš„ç¼–å·æ•°æ®&lt;/li&gt;
&lt;li&gt;ä¸€æ¬¡å‘½ä¸­ï¼Œç›´æ¥è¿”å›&lt;/li&gt;
&lt;li&gt;ä¸€æ¬¡æœªå‘½ä¸­ï¼Œå‘ŠçŸ¥å…·ä½“ä½ç½®&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Redis%E9%9B%86%E7%BE%A4%E5%86%85%E9%83%A8%E9%80%9A%E8%AE%AF%E8%AE%BE%E8%AE%A1.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;å‡å®šç°åœ¨æœ‰ Aã€Bã€C ä¸‰ä¸ªæœºå™¨äº’è”ï¼Œä¸‰ä¸ªæœºå™¨å­˜å‚¨å¥½äº†ä»¥åï¼Œä¼šè¿›è¡Œäº’è”ï¼Œäº’è”çš„ç›®çš„ï¼šè°é‚£æœ‰ä»€ä¹ˆæ ·çš„ä¸œè¥¿ä¸€æ¸…äºŒæ¥šã€‚æ¯ä¸€å°è®¡ç®—æœºéƒ½æœ‰ä¸€ä¸ªè´¦æœ¬ï¼Œå­˜å‚¨å„ä¸ªè®¡ç®—æœºé‡Œå¯¹åº”çš„å­˜å‚¨ç©ºé—´çš„æ§½æ˜¯å‡ åˆ°å‡ ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Redis%E9%9B%86%E7%BE%A4%E5%86%85%E9%83%A8%E9%80%9A%E8%AE%AF%E8%AE%BE%E8%AE%A12.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;å‡å®šç°åœ¨æ¥äº†ä¸€å°è®¡ç®—æœºï¼Œå‘å‡ºä¸€ä¸ª key è¦è®¿é—® Redisï¼Œkey é€šè¿‡ä¸¤ä¸ªç®—æ³•è®¡ç®—åå¾—åˆ° key å¯¹åº”çš„å­˜å‚¨æ§½åœ¨å“ªé‡Œï¼Œå‡å®šå®ƒè®¿é—®çš„å°±æ˜¯ Aï¼Œä¸€æ¬¡å‘½ä¸­ï¼Œç›´æ¥è¿”å›ã€‚å‡è®¾å®ƒæ²¡æœ‰å‘½ä¸­ï¼Œä¼šæ ¹æ®è¿™ä¸ª key å¯¹åº”çš„æ§½ä½ç½®åœ¨ A çš„å°æœ¬å­é‡Œé¢æ‰¾ï¼Œå‘ç°è¿™ä¸ªä¸œè¥¿åœ¨ B é‡Œé¢ï¼Œäºæ˜¯å°±è®©è¿™ä¸ª key å» B é‡Œé¢æ‰¾ï¼Œä¸æ˜¯ A å» B é‡Œé¢æ‰¾ï¼Œè€Œæ˜¯è¿™ä¸ªè¿æ¥è¯·æ±‚å®¢æˆ·ç«¯ç›´æ¥å» B é‡Œé¢æ‰¾ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;key åŠ å¯†å°±æ˜¯ä¸ºäº†ç¡®å®šå­˜å‚¨ä½ç½®ï¼Œä¿è¯æœ€å¤šä¸¤æ¬¡å‘½ä¸­&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;é›†ç¾¤å†…å­˜å­˜å‚¨ç»“æ„è®¾è®¡ï¼š&lt;/p&gt;
&lt;p&gt;1.æ§½ç”¨æ¥åŒºåˆ†æ•°æ®å­˜å‚¨ç©ºé—´&lt;/p&gt;
&lt;p&gt;2.key åŠ å¯†åç¡®å®šå­˜å‚¨çš„ä½ç½®&lt;/p&gt;
&lt;p&gt;3.ä¸€æ¬¡å‘½ä¸­æˆ–ä¸¤æ¬¡å‘½ä¸­å°±å¯ä»¥æ‰¾åˆ°æ•°æ®&lt;/p&gt;
&lt;h1 id=&#34;clusteré›†ç¾¤ç»“æ„æ­å»º&#34;&gt;clusteré›†ç¾¤ç»“æ„æ­å»º&lt;/h1&gt;
&lt;h2 id=&#34;æ­å»ºæ–¹å¼&#34;&gt;æ­å»ºæ–¹å¼&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;åŸç”Ÿå®‰è£…ï¼ˆå•æ¡å‘½ä»¤ï¼‰
&lt;ul&gt;
&lt;li&gt;é…ç½®æœåŠ¡å™¨ï¼ˆ3ä¸»3ä»ï¼‰&lt;/li&gt;
&lt;li&gt;å»ºç«‹é€šä¿¡ï¼ˆMeetï¼‰&lt;/li&gt;
&lt;li&gt;åˆ†æ§½ï¼ˆSlotï¼‰&lt;/li&gt;
&lt;li&gt;æ­å»ºä¸»ä»ï¼ˆmaster-slaveï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å·¥å…·å®‰è£…ï¼ˆæ‰¹å¤„ç†ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;clusterèŠ‚ç‚¹æ“ä½œå‘½ä»¤&#34;&gt;ClusterèŠ‚ç‚¹æ“ä½œå‘½ä»¤&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;æŸ¥çœ‹é›†ç¾¤èŠ‚ç‚¹ä¿¡æ¯&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;cluster nodes 
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;è¿›å…¥ä¸€ä¸ªä»èŠ‚ç‚¹ redisï¼Œåˆ‡æ¢å…¶ä¸»èŠ‚ç‚¹&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;cluster replicate &amp;lt;master-id&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;å‘ç°ä¸€ä¸ªæ–°èŠ‚ç‚¹ï¼Œæ–°å¢ä¸»èŠ‚ç‚¹&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;cluster meet ip:port 
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;å¿½ç•¥ä¸€ä¸ªæ²¡æœ‰soltçš„èŠ‚ç‚¹&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;cluster forget &amp;lt;id&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;æ‰‹åŠ¨æ•…éšœè½¬ç§»&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;cluster failover
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;redis-tribå‘½ä»¤&#34;&gt;redis-tribå‘½ä»¤&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;æ·»åŠ èŠ‚ç‚¹&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;redis-trib.rb add-node 
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;åˆ é™¤èŠ‚ç‚¹&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;redis-trib.rb del-node 
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;é‡æ–°åˆ†ç‰‡&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;redis-trib.rb reshard
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;clusteré…ç½®&#34;&gt;Clusteré…ç½®&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;æ·»åŠ èŠ‚ç‚¹&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;cluster-enabled yes|no 
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;clusteré…ç½®æ–‡ä»¶åï¼Œè¯¥æ–‡ä»¶å±äºè‡ªåŠ¨ç”Ÿæˆï¼Œä»…ç”¨äºå¿«é€ŸæŸ¥æ‰¾æ–‡ä»¶å¹¶æŸ¥è¯¢æ–‡ä»¶å†…å®¹&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;cluster-config-file &amp;lt;filename&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;èŠ‚ç‚¹æœåŠ¡å“åº”è¶…æ—¶æ—¶é—´ï¼Œç”¨äºåˆ¤å®šè¯¥èŠ‚ç‚¹æ˜¯å¦ä¸‹çº¿æˆ–åˆ‡æ¢ä¸ºä»èŠ‚ç‚¹&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;cluster-node-timeout &amp;lt;milliseconds&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;masterè¿æ¥çš„slaveæœ€å°æ•°é‡&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt; cluster-migration-barrier &amp;lt;count&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;ä¿®æ”¹ redis.conf é…ç½®æ–‡ä»¶&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;[root@iZ2ze4u2bufi0915gyi843Z conf]# vim redis-6379.confÂ 
port 6379
daemonize no
#logfile &amp;quot;6379.log&amp;quot;
dir &amp;quot;/root/redis-5.0.7/data&amp;quot;
dbfilename &amp;quot;dump-6379.rdb&amp;quot;
rdbcompression yes
rdbchecksum yes
appendonly yes
appendfsync everysec
appendfilename &amp;quot;appendonly-6379.aof&amp;quot;
bind 127.0.0.1
databases 16

cluster-enabled yes
cluster-config-file nodes-6379.conf
cluster-node-timeout 10000
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;[root@iZ2ze4u2bufi0915gyi843Z conf]# sed &amp;quot;s/6379/6380/g&amp;quot; redis-6379.conf &amp;gt; redis-6380.confÂ 
[root@iZ2ze4u2bufi0915gyi843Z conf]# sed &amp;quot;s/6379/6381/g&amp;quot; redis-6379.conf &amp;gt; redis-6381.confÂ 
[root@iZ2ze4u2bufi0915gyi843Z conf]# sed &amp;quot;s/6379/6382/g&amp;quot; redis-6379.conf &amp;gt; redis-6382.confÂ 
[root@iZ2ze4u2bufi0915gyi843Z conf]# sed &amp;quot;s/6379/6383/g&amp;quot; redis-6379.conf &amp;gt; redis-6383.confÂ 
[root@iZ2ze4u2bufi0915gyi843Z conf]# sed &amp;quot;s/6379/6384/g&amp;quot; redis-6379.conf &amp;gt; redis-6384.confÂ 
[root@iZ2ze4u2bufi0915gyi843Z conf]# sed &amp;quot;s/6379/6385/g&amp;quot; redis-6379.conf &amp;gt; redis-6385.confÂ 
&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;å¯åŠ¨ redis å®¢æˆ·ç«¯&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;[root@iZ2ze4u2bufi0915gyi843Z conf]# redis-server redis-6379.confÂ 
[root@iZ2ze4u2bufi0915gyi843Z conf]# redis-server redis-6380.confÂ 
[root@iZ2ze4u2bufi0915gyi843Z conf]# redis-server redis-6381.confÂ 
[root@iZ2ze4u2bufi0915gyi843Z conf]# redis-server redis-6382.confÂ 
[root@iZ2ze4u2bufi0915gyi843Z conf]# redis-server redis-6383.confÂ 
[root@iZ2ze4u2bufi0915gyi843Z conf]# redis-server redis-6384.confÂ 
&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;æ¯ä¸ª reids æœåŠ¡éƒ½ä»¥ cluster èŠ‚ç‚¹å‘ˆç°&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;[root@iZ2ze4u2bufi0915gyi843Z conf]# ps -ef | grep redis-
rootÂ  Â  Â  9015Â  8373Â  0 18:44 pts/1Â  Â  00:00:00 redis-server 127.0.0.1:6379 [cluster]
rootÂ  Â  Â  9019Â  8430Â  0 18:44 pts/5Â  Â  00:00:00 redis-server 127.0.0.1:6380 [cluster]
rootÂ  Â  Â  9023Â  8411Â  0 18:45 pts/4Â  Â  00:00:00 redis-server 127.0.0.1:6381 [cluster]
rootÂ  Â  Â  9028Â  8469Â  0 18:45 pts/6Â  Â  00:00:00 redis-server 127.0.0.1:6382 [cluster]
rootÂ  Â  Â  9033Â  8488Â  0 18:45 pts/7Â  Â  00:00:00 redis-server 127.0.0.1:6383 [cluster]
rootÂ  Â  Â  9037Â  8507Â  0 18:46 pts/8Â  Â  00:00:00 redis-server 127.0.0.1:6384 [cluster]
rootÂ  Â  Â  9045Â  8545Â  0 18:46 pts/10Â  Â 00:00:00 grep --color=auto redis-
&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;æŠŠè¿™äº›  cluster èŠ‚ç‚¹ è¿æ¥åœ¨ä¸€èµ·&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;redis5.0ä¹‹å‰çš„ç‰ˆæœ¬éœ€è¦éƒ¨ç½² ruby å’Œ gemï¼š&lt;a href=&#34;https://blog.51cto.com/wujianwei/2460638&#34;&gt;éƒ¨ç½²rubyç¯å¢ƒé‡åˆ°çš„å‘&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;redis5.0ä»¥ä¸Šçš„ç‰ˆæœ¬å¯ä»¥ä½¿ç”¨redis-cliå‘½ä»¤&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://juejin.im/post/5d16206b518825597909b5f9&#34;&gt;https://juejin.im/post/5d16206b518825597909b5f9&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[root@iZ2ze4u2bufi0915gyi843Z redis-5.0.7]# src/redis-cli --cluster create 127.0.0.1:6379 127.0.0.1:6380 127.0.0.1:6381 127.0.0.1:6382 127.0.0.1:6383 127.0.0.1:6384 --cluster-replicas 1
// --cluster-replicas 1ï¼šä¸€ä¸ª master è¿æ¥ä¸€ä¸ª slaveï¼›2ï¼šä¸€ä¸ª master è¿æ¥ä¸¤ä¸ª slave
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;9&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;è¾“å…¥ yes é‡å†™é…ç½®æ–‡ä»¶åï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;10&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;è§£æ-master-å’Œ-slave-æ—¥å¿—ä¿¡æ¯&#34;&gt;è§£æ master å’Œ slave æ—¥å¿—ä¿¡æ¯&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;11&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E9%9B%86%E7%BE%A4master%E6%97%A5%E5%BF%97.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;masterï¼š6379 æ—¥å¿—&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;12&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E9%9B%86%E7%BE%A4slave%E6%97%A5%E5%BF%97.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;slaveï¼š6382 æ—¥å¿—&lt;/p&gt;
&lt;h2 id=&#34;è®¾ç½®ä¸è·å–æ•°æ®&#34;&gt;è®¾ç½®ä¸è·å–æ•°æ®&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;[root@iZ2ze4u2bufi0915gyi843Z ~]# redis-cli
127.0.0.1:6379&amp;gt; set name itheima  Â // æŠŠ name å¯¹åº”çš„ key è¿›è¡Œè½¬åŒ–åï¼Œå¯¹åº”çš„æ§½åœ¨ 6380ï¼Œä¸èƒ½åœ¨ 6379 set
(error) MOVED 5798 127.0.0.1:6380 
127.0 .0.1:6379&amp;gt; set lll sss      //  lll å¯¹åº”çš„ key è¿›è¡Œè½¬åŒ–åï¼Œå¯¹åº”çš„æ§½åœ¨ 6379ï¼Œæ‰€ä»¥æ­¤å¤„ set æˆåŠŸ
OK

[root@iZ2ze4u2bufi0915gyi843Z ~]# redis-cli -cÂ   // -c ä¸“é—¨ç”¨æ¥æ“ä½œ cluster é›†ç¾¤çš„
127.0.0.1:6379&amp;gt; set name itheima
-&amp;gt; Redirected to slot [5798] located at 127.0.0.1:6380  // é‡å®šå‘åˆ° 5798 è¿™ä¸ªæ§½ï¼Œè¿™ä¸ªæ§½åœ¨ 6380 ä¸‹
OK
127.0.0.1:6380&amp;gt; get name
&amp;quot;itheima&amp;quot;
[root@iZ2ze4u2bufi0915gyi843Z ~]# redis-cli -c -p 6382
127.0.0.1:6382&amp;gt; get name
-&amp;gt; Redirected to slot [5798] located at 127.0.0.1:6380
&amp;quot;itheima&amp;quot;
127.0.0.1:6380&amp;gt;Â 
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;ä¸»ä»ä¸‹çº¿ä¸ä¸»ä»åˆ‡æ¢&#34;&gt;ä¸»ä»ä¸‹çº¿ä¸ä¸»ä»åˆ‡æ¢&lt;/h2&gt;
&lt;h3 id=&#34;slave6382-ä¸‹çº¿&#34;&gt;slave:6382 ä¸‹çº¿&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;13&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/slave%E4%B8%8B%E7%BA%BF%E4%B8%BB%E8%8A%82%E7%82%B9%E6%97%A5%E5%BF%97.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;master:6381ï¼ˆslave:6382 çš„ masterï¼‰ æ—¥å¿—æ‰“å°&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;14&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/slave%E4%B8%8B%E7%BA%BFmaster%E6%97%A5%E5%BF%97.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;master:6379 æ—¥å¿—æ‰“å°&lt;/p&gt;
&lt;h3 id=&#34;slave6382-é‡æ–°ä¸Šçº¿&#34;&gt;slave:6382 é‡æ–°ä¸Šçº¿&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;15&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/slave%E9%87%8D%E6%96%B0%E4%B8%8A%E7%BA%BFmaster%E6%97%A5%E5%BF%97.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;master:6381ï¼ˆslave:6382 çš„ masterï¼‰ æ—¥å¿—æ‰“å°&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E9%87%8D%E6%96%B0%E4%B8%8A%E7%BA%BF%E7%9A%84master%E5%8F%98%E6%88%90slave%E4%BA%86.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;master:6379 æ—¥å¿—æ‰“å°&lt;/p&gt;
&lt;h3 id=&#34;master6379-ä¸‹çº¿&#34;&gt;master:6379 ä¸‹çº¿&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;16&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/master%E4%B8%8B%E7%BA%BFslave%E6%97%A5%E5%BF%97.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;slave:6383ï¼ˆmaster:6379 çš„ slaveï¼‰æ—¥å¿—æ‰“å°&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹ cluster ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;17&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/master%E4%B8%8B%E7%BA%BFcluster%E6%97%A5%E5%BF%97.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;slave:6383 è‡ªå·±å½“ master&lt;/p&gt;
&lt;h3 id=&#34;master6379-é‡æ–°ä¸Šçº¿&#34;&gt;master:6379 é‡æ–°ä¸Šçº¿&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;18&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/master%E9%87%8D%E6%96%B0%E4%B8%8A%E7%BA%BFmaster%E6%97%A5%E5%BF%97.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;master:6383&lt;/strong&gt;ï¼ˆslave:6379 çš„ masterï¼‰ æ—¥å¿—ä¿¡æ¯&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;19&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E9%87%8D%E6%96%B0%E4%B8%8A%E7%BA%BF%E7%9A%84master%E5%8F%98%E6%88%90slave%E4%BA%86.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;å†æ¬¡ä¸Šçº¿çš„ 6379 å˜æˆ slave äº†&lt;/p&gt;
&lt;h1 id=&#34;æ€»ç»“-2&#34;&gt;æ€»ç»“&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;é›†ç¾¤&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é›†ç¾¤ç®€ä»‹&lt;/li&gt;
&lt;li&gt;é›†ç¾¤ç»“æ„&lt;/li&gt;
&lt;li&gt;clusteré›†ç¾¤ç»“æ„æ­å»º&lt;/li&gt;
&lt;/ul&gt;
">è®°ä¸€ä¸ªé¢è¯•é¢˜ â€”â€” Redis ä¸€å¯åŠ¨æŒ‚äº†æ€ä¹ˆåŠ</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/mian-shi-chang-wen-zhi-huan-cun-chuan-tou-huan-cun-xue-beng/"" data-c="
          &lt;h1 id=&#34;ç¼“å­˜é¢„çƒ­&#34;&gt;ç¼“å­˜é¢„çƒ­&lt;/h1&gt;
&lt;h2 id=&#34;å®•æœº&#34;&gt;â€œå®•æœºâ€&lt;/h2&gt;
&lt;p&gt;æœåŠ¡å™¨&lt;strong&gt;å¯åŠ¨åè¿…é€Ÿå®•æœº&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;é—®é¢˜æ’æŸ¥&#34;&gt;é—®é¢˜æ’æŸ¥&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;è¯·æ±‚æ•°é‡è¾ƒé«˜&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¸»ä»ä¹‹é—´æ•°æ®ååé‡è¾ƒå¤§ï¼ˆä¸åœåœ°åŠ è½½æ•°æ®ï¼‰ï¼Œæ•°æ®åŒæ­¥æ“ä½œé¢‘åº¦è¾ƒé«˜&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;æ•°æ®åº“è¯»çš„é¢‘åº¦é«˜ï¼šæœåŠ¡å™¨ä¸€å¯åŠ¨ï¼Œç¼“å­˜ä¸­æ²¡æœ‰æ•°æ®ï¼Œè‡ªç„¶å°±ä¼šç»™æœåŠ¡å™¨å¸¦æ¥å‹åŠ›ï¼Œè¿™æ—¶å€™å¦‚æœè¯·æ±‚æ¯”è¾ƒå¤šçš„è¯ï¼Œredis æœåŠ¡å™¨å°±ä¼šå®•æœºã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;è§£å†³æ–¹æ¡ˆ&#34;&gt;è§£å†³æ–¹æ¡ˆ&lt;/h2&gt;
&lt;p&gt;å‰ç½®å‡†å¤‡å·¥ä½œï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ—¥å¸¸ä¾‹è¡Œç»Ÿè®¡æ•°æ®è®¿é—®è®°å½•ï¼Œç»Ÿè®¡è®¿é—®é¢‘åº¦è¾ƒé«˜çš„çƒ­ç‚¹æ•°æ®&lt;/li&gt;
&lt;li&gt;åˆ©ç”¨LRUæ•°æ®åˆ é™¤ç­–ç•¥ï¼Œæ„å»ºæ•°æ®ç•™å­˜é˜Ÿåˆ—
&lt;ul&gt;
&lt;li&gt;ä¾‹å¦‚ï¼šstormä¸kafkaé…åˆ&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å‡†å¤‡å·¥ä½œï¼š&lt;/p&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;å°†ç»Ÿè®¡ç»“æœä¸­çš„æ•°æ®åˆ†ç±»ï¼Œæ ¹æ®çº§åˆ«ï¼Œredisä¼˜å…ˆåŠ è½½çº§åˆ«è¾ƒé«˜çš„çƒ­ç‚¹æ•°æ®&lt;/li&gt;
&lt;li&gt;åˆ©ç”¨åˆ†å¸ƒå¼å¤šæœåŠ¡å™¨åŒæ—¶è¿›è¡Œæ•°æ®è¯»å–ï¼Œæé€Ÿæ•°æ®åŠ è½½è¿‡ç¨‹&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å®æ–½ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä½¿ç”¨è„šæœ¬ç¨‹åºå›ºå®šè§¦å‘æ•°æ®é¢„çƒ­è¿‡ç¨‹&lt;/li&gt;
&lt;li&gt;å¦‚æœæ¡ä»¶å…è®¸ï¼Œä½¿ç”¨äº†CDNï¼ˆå†…å®¹åˆ†å‘ç½‘ç»œï¼‰ï¼Œæ•ˆæœä¼šæ›´å¥½&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;ç¼“å­˜é¢„çƒ­å°±æ˜¯ç³»ç»Ÿå¯åŠ¨å‰ï¼Œ&lt;strong&gt;æå‰å°†ç›¸å…³çš„ç¼“å­˜æ•°æ®ç›´æ¥åŠ è½½åˆ°ç¼“å­˜ç³»ç»Ÿ&lt;/strong&gt;ã€‚é¿å…åœ¨ç”¨æˆ·è¯·æ±‚çš„æ—¶å€™ï¼Œå…ˆæŸ¥è¯¢æ•°æ®åº“ï¼Œç„¶åå†å°†æ•°æ®ç¼“å­˜çš„é—®é¢˜ï¼ç”¨æˆ·ç›´æ¥æŸ¥è¯¢äº‹å…ˆè¢«é¢„çƒ­çš„ç¼“å­˜æ•°æ®ï¼&lt;/p&gt;
&lt;h1 id=&#34;ç¼“å­˜é›ªå´©&#34;&gt;ç¼“å­˜é›ªå´©&lt;/h1&gt;
&lt;h2 id=&#34;æ•°æ®åº“æœåŠ¡å™¨å´©æºƒ1&#34;&gt;æ•°æ®åº“æœåŠ¡å™¨å´©æºƒï¼ˆ1ï¼‰&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;ç³»ç»Ÿå¹³ç¨³è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œå¿½ç„¶æ•°æ®åº“è¿æ¥é‡æ¿€å¢&lt;/li&gt;
&lt;li&gt;åº”ç”¨æœåŠ¡å™¨æ— æ³•åŠæ—¶å¤„ç†è¯·æ±‚&lt;/li&gt;
&lt;li&gt;å¤§é‡408ï¼Œ500é”™è¯¯é¡µé¢å‡ºç°&lt;/li&gt;
&lt;li&gt;å®¢æˆ·åå¤åˆ·æ–°é¡µé¢è·å–æ•°æ®&lt;/li&gt;
&lt;li&gt;æ•°æ®åº“å´©æºƒ&lt;/li&gt;
&lt;li&gt;åº”ç”¨æœåŠ¡å™¨å´©æºƒ&lt;/li&gt;
&lt;li&gt;é‡å¯åº”ç”¨æœåŠ¡å™¨æ— æ•ˆ&lt;/li&gt;
&lt;li&gt;RedisæœåŠ¡å™¨å´©æºƒ&lt;/li&gt;
&lt;li&gt;Redisé›†ç¾¤å´©æºƒ&lt;/li&gt;
&lt;li&gt;é‡å¯æ•°æ®åº“åå†æ¬¡è¢«ç¬é—´æµé‡æ”¾å€’&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;é—®é¢˜æ’æŸ¥-2&#34;&gt;é—®é¢˜æ’æŸ¥&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨ä¸€ä¸ª&lt;span style=&#34;color:red&#34;&gt;è¾ƒçŸ­&lt;/span&gt;çš„æ—¶é—´å†…ï¼Œç¼“å­˜ä¸­è¾ƒå¤šçš„&lt;span style=&#34;color:red&#34;&gt;keyé›†ä¸­è¿‡æœŸ &lt;/span&gt;&lt;/li&gt;
&lt;li&gt;æ­¤å‘¨æœŸå†…è¯·æ±‚è®¿é—®è¿‡æœŸçš„æ•°æ®ï¼Œredisæœªå‘½ä¸­ï¼Œrediså‘æ•°æ®åº“è·å–æ•°æ®&lt;/li&gt;
&lt;li&gt;æ•°æ®åº“åŒæ—¶æ¥æ”¶åˆ°å¤§é‡çš„è¯·æ±‚æ— æ³•åŠæ—¶å¤„ç†&lt;/li&gt;
&lt;li&gt;Rediså¤§é‡è¯·æ±‚è¢«ç§¯å‹ï¼Œå¼€å§‹å‡ºç°è¶…æ—¶ç°è±¡&lt;/li&gt;
&lt;li&gt;æ•°æ®åº“æµé‡æ¿€å¢ï¼Œæ•°æ®åº“å´©æºƒ&lt;/li&gt;
&lt;li&gt;é‡å¯åä»ç„¶é¢å¯¹ç¼“å­˜ä¸­æ— æ•°æ®å¯ç”¨&lt;/li&gt;
&lt;li&gt;RedisæœåŠ¡å™¨èµ„æºè¢«ä¸¥é‡å ç”¨ï¼ŒRedisæœåŠ¡å™¨å´©æºƒ&lt;/li&gt;
&lt;li&gt;Redisé›†ç¾¤å‘ˆç°å´©å¡Œï¼Œé›†ç¾¤ç“¦è§£&lt;/li&gt;
&lt;li&gt;åº”ç”¨æœåŠ¡å™¨æ— æ³•åŠæ—¶å¾—åˆ°æ•°æ®å“åº”è¯·æ±‚ï¼Œæ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚æ•°é‡è¶Šæ¥è¶Šå¤šï¼Œåº”ç”¨æœåŠ¡å™¨å´©æºƒ&lt;/li&gt;
&lt;li&gt;åº”ç”¨æœåŠ¡å™¨ï¼Œredisï¼Œæ•°æ®åº“å…¨éƒ¨é‡å¯ï¼Œæ•ˆæœä¸ç†æƒ³&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;é—®é¢˜åˆ†æ&#34;&gt;é—®é¢˜åˆ†æ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;çŸ­æ—¶é—´èŒƒå›´å†…&lt;/li&gt;
&lt;li&gt;å¤§é‡keyé›†ä¸­è¿‡æœŸ&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;è§£å†³æ–¹æ¡ˆé“&#34;&gt;è§£å†³æ–¹æ¡ˆï¼ˆé“ï¼‰&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;æ›´å¤šçš„é¡µé¢é™æ€åŒ–å¤„ç†&lt;/li&gt;
&lt;li&gt;æ„å»ºå¤šçº§ç¼“å­˜æ¶æ„&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Nginxç¼“å­˜+redisç¼“å­˜+ehcacheç¼“å­˜&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;æ£€æµ‹Mysqlä¸¥é‡è€—æ—¶ä¸šåŠ¡è¿›è¡Œä¼˜åŒ–&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹æ•°æ®åº“çš„ç“¶é¢ˆæ’æŸ¥ï¼šä¾‹å¦‚è¶…æ—¶æŸ¥è¯¢ã€è€—æ—¶è¾ƒé«˜äº‹åŠ¡ç­‰&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;ç¾éš¾é¢„è­¦æœºåˆ¶&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;ç›‘æ§redisæœåŠ¡å™¨æ€§èƒ½æŒ‡æ ‡
&lt;ul&gt;
&lt;li&gt;CPUå ç”¨ã€CPUä½¿ç”¨ç‡&lt;/li&gt;
&lt;li&gt;å†…å­˜å®¹é‡&lt;/li&gt;
&lt;li&gt;æŸ¥è¯¢å¹³å‡å“åº”æ—¶é—´&lt;/li&gt;
&lt;li&gt;çº¿ç¨‹æ•°&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;é™æµã€é™çº§&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;çŸ­æ—¶é—´èŒƒå›´å†…ç‰ºç‰²ä¸€äº›å®¢æˆ·ä½“éªŒï¼Œé™åˆ¶ä¸€éƒ¨åˆ†è¯·æ±‚è®¿é—®ï¼Œé™ä½åº”ç”¨æœåŠ¡å™¨å‹åŠ›ï¼Œå¾…ä¸šåŠ¡ä½é€Ÿè¿è½¬åå†é€æ­¥æ”¾å¼€è®¿é—®&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;è§£å†³æ–¹æ¡ˆæœ¯&#34;&gt;è§£å†³æ–¹æ¡ˆï¼ˆæœ¯ï¼‰&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;LRUä¸LFUåˆ‡æ¢&lt;/li&gt;
&lt;li&gt;æ•°æ®æœ‰æ•ˆæœŸç­–ç•¥è°ƒæ•´&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æ ¹æ®ä¸šåŠ¡æ•°æ®æœ‰æ•ˆæœŸè¿›è¡Œåˆ†ç±»é”™å³°ï¼ŒAç±»90åˆ†é’Ÿï¼ŒBç±»80åˆ†é’Ÿï¼ŒCç±»70åˆ†é’Ÿ&lt;/li&gt;
&lt;li&gt;è¿‡æœŸæ—¶é—´ä½¿ç”¨å›ºå®šæ—¶é—´+éšæœºå€¼çš„å½¢å¼ï¼Œç¨€é‡Šé›†ä¸­åˆ°æœŸçš„keyçš„æ•°é‡&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;è¶…çƒ­æ•°æ®ä½¿ç”¨æ°¸ä¹…key&lt;/li&gt;
&lt;li&gt;å®šæœŸç»´æŠ¤ï¼ˆè‡ªåŠ¨+äººå·¥ï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹å³å°†è¿‡æœŸæ•°æ®åšè®¿é—®é‡åˆ†æï¼Œç¡®è®¤æ˜¯å¦å»¶æ—¶ï¼Œé…åˆè®¿é—®é‡ç»Ÿè®¡ï¼Œåšçƒ­ç‚¹æ•°æ®çš„å»¶æ—¶&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;åŠ é”&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æ…ç”¨ï¼&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æ€»ç»“-2&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;ç¼“å­˜é›ªå´©å°±æ˜¯&lt;strong&gt;ç¬é—´è¿‡æœŸæ•°æ®é‡å¤ªå¤§&lt;/strong&gt;ï¼Œå¯¼è‡´å¯¹æ•°æ®åº“æœåŠ¡å™¨é€ æˆå‹åŠ›ã€‚å¦‚èƒ½å¤Ÿæœ‰&lt;strong&gt;æ•ˆé¿å…è¿‡æœŸæ—¶é—´é›†ä¸­&lt;/strong&gt;ï¼Œå¯ä»¥æœ‰æ•ˆè§£å†³é›ªå´©ç°è±¡çš„å‡ºç° ï¼ˆçº¦40%ï¼‰ï¼Œé…åˆå…¶ä»–ç­–ç•¥ä¸€èµ·ä½¿ç”¨ï¼Œå¹¶ç›‘æ§æœåŠ¡å™¨çš„è¿è¡Œæ•°æ®ï¼Œæ ¹æ®è¿è¡Œè®°å½•åšå¿«é€Ÿè°ƒæ•´&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9-1.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;å¤§é‡ key é›†ä¸­è¿‡æœŸï¼Œæ›´å¤šå‘ mysql å‘èµ·è¯·æ±‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9-2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h1 id=&#34;ç¼“å­˜å‡»ç©¿&#34;&gt;ç¼“å­˜å‡»ç©¿&lt;/h1&gt;
&lt;h2 id=&#34;æ•°æ®åº“æœåŠ¡å™¨å´©æºƒ2&#34;&gt;æ•°æ®åº“æœåŠ¡å™¨å´©æºƒï¼ˆ2ï¼‰&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;ç³»ç»Ÿå¹³ç¨³è¿è¡Œè¿‡ç¨‹ä¸­&lt;/li&gt;
&lt;li&gt;æ•°æ®åº“è¿æ¥é‡ç¬é—´æ¿€å¢&lt;/li&gt;
&lt;li&gt;RedisæœåŠ¡å™¨æ— å¤§é‡keyè¿‡æœŸ&lt;/li&gt;
&lt;li&gt;Rediså†…å­˜å¹³ç¨³ï¼Œæ— æ³¢åŠ¨&lt;/li&gt;
&lt;li&gt;RedisæœåŠ¡å™¨CPUæ­£å¸¸&lt;/li&gt;
&lt;li&gt;æ•°æ®åº“å´©æºƒ&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;é—®é¢˜æ’æŸ¥-3&#34;&gt;é—®é¢˜æ’æŸ¥&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Redisä¸­&lt;strong&gt;æŸä¸ªkeyè¿‡æœŸï¼Œè¯¥keyè®¿é—®é‡å·¨å¤§&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;å¤šä¸ªæ•°æ®è¯·æ±‚ä»æœåŠ¡å™¨ç›´æ¥å‹åˆ°Redisåï¼Œå‡æœªå‘½ä¸­&lt;/li&gt;
&lt;li&gt;Redisåœ¨çŸ­æ—¶é—´å†…å‘èµ·äº†å¤§é‡å¯¹æ•°æ®åº“ä¸­åŒä¸€æ•°æ®çš„è®¿é—®&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;é—®é¢˜åˆ†æ-2&#34;&gt;é—®é¢˜åˆ†æ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å•ä¸ªkeyé«˜çƒ­æ•°æ®&lt;/li&gt;
&lt;li&gt;keyè¿‡æœŸ&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;è§£å†³æ–¹æ¡ˆæœ¯-2&#34;&gt;è§£å†³æ–¹æ¡ˆï¼ˆæœ¯ï¼‰&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;é¢„å…ˆè®¾å®š&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;ä»¥ç”µå•†ä¸ºä¾‹ï¼Œæ¯ä¸ªå•†å®¶æ ¹æ®åº—é“ºç­‰çº§ï¼ŒæŒ‡å®šè‹¥å¹²æ¬¾ä¸»æ‰“å•†å“ï¼Œåœ¨è´­ç‰©èŠ‚æœŸé—´ï¼ŒåŠ å¤§æ­¤ç±»ä¿¡æ¯keyçš„è¿‡æœŸæ—¶é•¿&lt;/li&gt;
&lt;li&gt;æ³¨æ„ï¼šè´­ç‰©èŠ‚ä¸ä»…ä»…æŒ‡å½“å¤©ï¼Œä»¥åŠåç»­è‹¥å¹²å¤©ï¼Œè®¿é—®å³°å€¼å‘ˆç°é€æ¸é™ä½çš„è¶‹åŠ¿&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;ç°åœºè°ƒæ•´&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;ç›‘æ§è®¿é—®é‡ï¼Œå¯¹è‡ªç„¶æµé‡æ¿€å¢çš„æ•°æ®å»¶é•¿è¿‡æœŸæ—¶é—´æˆ–è®¾ç½®ä¸ºæ°¸ä¹…æ€§key&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;åå°åˆ·æ–°æ•°æ®&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å¯åŠ¨å®šæ—¶ä»»åŠ¡ï¼Œé«˜å³°æœŸæ¥ä¸´ä¹‹å‰ï¼Œåˆ·æ–°æ•°æ®æœ‰æ•ˆæœŸï¼Œç¡®ä¿ä¸ä¸¢å¤±&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;äºŒçº§ç¼“å­˜&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;è®¾ç½®ä¸åŒçš„å¤±æ•ˆæ—¶é—´ï¼Œä¿éšœä¸ä¼šè¢«åŒæ—¶æ·˜æ±°å°±è¡Œ&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;åŠ é”&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;åˆ†å¸ƒå¼é”ï¼Œé˜²æ­¢è¢«å‡»ç©¿ï¼Œä½†æ˜¯è¦æ³¨æ„ä¹Ÿæ˜¯æ€§èƒ½ç“¶é¢ˆï¼Œæ…é‡ï¼&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æ€»ç»“-3&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;ç¼“å­˜å‡»ç©¿å°±æ˜¯&lt;strong&gt;å•ä¸ªé«˜çƒ­æ•°æ®è¿‡æœŸçš„ç¬é—´ï¼Œæ•°æ®è®¿é—®é‡è¾ƒå¤§&lt;/strong&gt;ï¼Œæœªå‘½ä¸­redisåï¼Œå‘èµ·äº†å¤§é‡å¯¹åŒä¸€æ•°æ®çš„æ•°æ®åº“è®¿é—®ï¼Œå¯¼è‡´å¯¹æ•°æ®åº“æœåŠ¡å™¨é€ æˆå‹åŠ›ã€‚åº”å¯¹ç­–ç•¥åº”è¯¥åœ¨ä¸šåŠ¡æ•°æ®åˆ†æä¸é¢„é˜²æ–¹é¢è¿›è¡Œï¼Œé…åˆè¿è¡Œç›‘æ§æµ‹è¯•ä¸å³æ—¶è°ƒæ•´ç­–ç•¥ï¼Œæ¯•ç«Ÿå•ä¸ªkeyçš„è¿‡æœŸç›‘æ§éš¾åº¦è¾ƒé«˜ï¼Œé…åˆé›ªå´©å¤„ç†ç­–ç•¥å³å¯ã€‚&lt;/p&gt;
&lt;h1 id=&#34;ç¼“å­˜ç©¿é€&#34;&gt;ç¼“å­˜ç©¿é€&lt;/h1&gt;
&lt;h2 id=&#34;æ•°æ®åº“æœåŠ¡å™¨å´©æºƒ3&#34;&gt;æ•°æ®åº“æœåŠ¡å™¨å´©æºƒï¼ˆ3ï¼‰&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;ç³»ç»Ÿå¹³ç¨³è¿è¡Œè¿‡ç¨‹ä¸­&lt;/li&gt;
&lt;li&gt;åº”ç”¨æœåŠ¡å™¨æµé‡éšæ—¶é—´å¢é‡è¾ƒå¤§&lt;/li&gt;
&lt;li&gt;RedisæœåŠ¡å™¨å‘½ä¸­ç‡éšæ—¶é—´é€æ­¥é™ä½&lt;/li&gt;
&lt;li&gt;Rediså†…å­˜å¹³ç¨³ï¼Œå†…å­˜æ— å‹åŠ›&lt;/li&gt;
&lt;li&gt;RedisæœåŠ¡å™¨CPUå ç”¨æ¿€å¢&lt;/li&gt;
&lt;li&gt;æ•°æ®åº“æœåŠ¡å™¨å‹åŠ›æ¿€å¢&lt;/li&gt;
&lt;li&gt;æ•°æ®åº“å´©æºƒ&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;é—®é¢˜æ’æŸ¥-4&#34;&gt;é—®é¢˜æ’æŸ¥&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Redisä¸­å¤§é¢ç§¯å‡ºç°æœªå‘½ä¸­&lt;/li&gt;
&lt;li&gt;å‡ºç°éæ­£å¸¸URLè®¿é—®&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;é—®é¢˜åˆ†æ-3&#34;&gt;é—®é¢˜åˆ†æ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;è·å–çš„æ•°æ®åœ¨æ•°æ®åº“ä¸­ä¹Ÿä¸å­˜åœ¨ï¼Œæ•°æ®åº“æŸ¥è¯¢æœªå¾—åˆ°å¯¹åº”æ•°æ®&lt;/li&gt;
&lt;li&gt;Redisè·å–åˆ°nullæ•°æ®æœªè¿›è¡ŒæŒä¹…åŒ–ï¼Œç›´æ¥è¿”å›&lt;/li&gt;
&lt;li&gt;ä¸‹æ¬¡æ­¤ç±»æ•°æ®åˆ°è¾¾é‡å¤ä¸Šè¿°è¿‡ç¨‹&lt;/li&gt;
&lt;li&gt;å‡ºç°é»‘å®¢æ”»å‡»æœåŠ¡å™¨&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;è§£å†³æ–¹æ¡ˆï¼ˆæœ¯ï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç¼“å­˜null&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹æŸ¥è¯¢ç»“æœä¸ºnullçš„æ•°æ®è¿›è¡Œç¼“å­˜ï¼ˆé•¿æœŸä½¿ç”¨ï¼Œå®šæœŸæ¸…ç†ï¼‰ï¼Œè®¾å®šçŸ­æ—¶é™ï¼Œä¾‹å¦‚30-60ç§’ï¼Œæœ€é«˜5åˆ†é’Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;ç™½åå•ç­–ç•¥&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æå‰é¢„çƒ­å„ç§åˆ†ç±»æ•°æ®idå¯¹åº”çš„bitmapsï¼Œidä½œä¸ºbitmapsçš„offsetï¼Œç›¸å½“äºè®¾ç½®äº†æ•°æ®ç™½åå•ã€‚å½“åŠ è½½æ­£å¸¸æ•°æ®æ—¶ï¼Œæ”¾è¡Œï¼ŒåŠ è½½å¼‚å¸¸æ•°æ®æ—¶ç›´æ¥æ‹¦æˆªï¼ˆæ•ˆç‡åä½ï¼‰&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆæœ‰å…³å¸ƒéš†è¿‡æ»¤å™¨çš„å‘½ä¸­é—®é¢˜å¯¹å½“å‰çŠ¶å†µå¯ä»¥å¿½ç•¥ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;å®æ–½ç›‘æ§&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å®æ—¶ç›‘æ§rediså‘½ä¸­ç‡ï¼ˆä¸šåŠ¡æ­£å¸¸èŒƒå›´æ—¶ï¼Œé€šå¸¸ä¼šæœ‰ä¸€ä¸ªæ³¢åŠ¨å€¼ï¼‰ä¸nullæ•°æ®çš„å æ¯”
&lt;ul&gt;
&lt;li&gt;éæ´»åŠ¨æ—¶æ®µæ³¢åŠ¨ï¼šé€šå¸¸æ£€æµ‹3-5å€ï¼Œè¶…è¿‡5å€çº³å…¥é‡ç‚¹æ’æŸ¥å¯¹è±¡&lt;/li&gt;
&lt;li&gt;æ´»åŠ¨æ—¶æ®µæ³¢åŠ¨ï¼šé€šå¸¸æ£€æµ‹10-50å€ï¼Œè¶…è¿‡50å€çº³å…¥é‡ç‚¹æ’æŸ¥å¯¹è±¡&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ ¹æ®å€æ•°ä¸åŒï¼Œå¯åŠ¨ä¸åŒçš„æ’æŸ¥æµç¨‹ã€‚ç„¶åä½¿ç”¨é»‘åå•è¿›è¡Œé˜²æ§ï¼ˆè¿è¥ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;keyåŠ å¯†&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;é—®é¢˜å‡ºç°åï¼Œä¸´æ—¶å¯åŠ¨é˜²ç¾ä¸šåŠ¡keyï¼Œå¯¹keyè¿›è¡Œä¸šåŠ¡å±‚ä¼ è¾“åŠ å¯†æœåŠ¡ï¼Œè®¾å®šæ ¡éªŒç¨‹åºï¼Œè¿‡æ¥çš„keyæ ¡éªŒ&lt;/li&gt;
&lt;li&gt;ä¾‹å¦‚æ¯å¤©éšæœºåˆ†é…60ä¸ªåŠ å¯†ä¸²ï¼ŒæŒ‘é€‰2åˆ°3ä¸ªï¼Œæ··æ·†åˆ°é¡µé¢æ•°æ®idä¸­ï¼Œå‘ç°è®¿é—®keyä¸æ»¡è¶³è§„åˆ™ï¼Œé©³å›æ•°æ®è®¿é—®&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æ€»ç»“-4&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;ç¼“å­˜å‡»ç©¿&lt;strong&gt;è®¿é—®äº†ä¸å­˜åœ¨çš„æ•°æ®&lt;/strong&gt;ï¼Œè·³è¿‡äº†åˆæ³•æ•°æ®çš„redisæ•°æ®ç¼“å­˜é˜¶æ®µï¼Œæ¯æ¬¡è®¿é—®æ•°æ®åº“ï¼Œå¯¼è‡´å¯¹æ•°æ®åº“æœåŠ¡å™¨é€ æˆå‹åŠ›ã€‚é€šå¸¸æ­¤ç±»æ•°æ®çš„å‡ºç°é‡æ˜¯ä¸€ä¸ªè¾ƒä½çš„å€¼ï¼Œå½“å‡ºç°æ­¤ç±»æƒ…å†µä»¥æ¯’æ”»æ¯’ï¼Œå¹¶åŠæ—¶æŠ¥è­¦ã€‚åº”å¯¹ç­–ç•¥åº”è¯¥åœ¨ä¸´æ—¶é¢„æ¡ˆé˜²èŒƒæ–¹é¢å¤šåšæ–‡ç« ã€‚&lt;/p&gt;
&lt;p&gt;æ— è®ºæ˜¯é»‘åå•è¿˜æ˜¯ç™½åå•ï¼Œéƒ½æ˜¯å¯¹æ•´ä½“ç³»ç»Ÿçš„å‹åŠ›ï¼Œè­¦æŠ¥è§£é™¤åå°½å¿«ç§»é™¤ã€‚&lt;/p&gt;
&lt;h1 id=&#34;æ€§èƒ½æŒ‡æ ‡ç›‘æ§&#34;&gt;æ€§èƒ½æŒ‡æ ‡ç›‘æ§&lt;/h1&gt;
&lt;h2 id=&#34;ç›‘æ§æŒ‡æ ‡&#34;&gt;ç›‘æ§æŒ‡æ ‡&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;æ€§èƒ½æŒ‡æ ‡ï¼šPerformance&lt;/li&gt;
&lt;li&gt;å†…å­˜æŒ‡æ ‡ï¼šMemory&lt;/li&gt;
&lt;li&gt;åŸºæœ¬æ´»åŠ¨æŒ‡æ ‡ï¼šBasic activity&lt;/li&gt;
&lt;li&gt;æŒä¹…æ€§æŒ‡æ ‡ï¼šPersistence&lt;/li&gt;
&lt;li&gt;é”™è¯¯æŒ‡æ ‡ï¼šError&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ€§èƒ½æŒ‡æ ‡performance&#34;&gt;æ€§èƒ½æŒ‡æ ‡ï¼šPerformance&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;&lt;strong&gt;Name&lt;/strong&gt;&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;&lt;strong&gt;Description&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;latency&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Rediså“åº”ä¸€ä¸ªè¯·æ±‚çš„æ—¶é—´&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;instantaneous_ops_per_sec&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å¹³å‡æ¯ç§’å¤„ç†æ€»æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;hit rate(calculate)&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ç¼“å­˜å‘½ä¸­ç‡ï¼ˆè®¡ç®—å‡ºæ¥çš„ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;å†…å­˜æŒ‡æ ‡memory&#34;&gt;å†…å­˜æŒ‡æ ‡ï¼šMemory&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;&lt;strong&gt;Name&lt;/strong&gt;&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;&lt;strong&gt;Description&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;used_memory&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å·²ä½¿ç”¨å†…å­˜&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;mem_fragmentation_ratio&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å†…å­˜ç¢ç‰‡åŒ–&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;evicted_keys&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ç”±äºæœ€å¤§å†…å­˜é™åˆ¶è¢«ç§»é™¤çš„ key çš„æ•°é‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;blocked_clients&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ç”±äº BLPOPã€BRPOPã€or BRPOPLPUSH è€Œå¤‡å—é˜»å¡çš„å®¢æˆ·ç«¯&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;åŸºæœ¬æ´»åŠ¨æŒ‡æ ‡basic-activity&#34;&gt;åŸºæœ¬æ´»åŠ¨æŒ‡æ ‡ï¼šBasic activity&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;&lt;strong&gt;Name&lt;/strong&gt;&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;&lt;strong&gt;Description&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;connected_clients&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å®¢æˆ·ç«¯è¿æ¥æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;connected_slaves&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Slave æ•°é‡&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;master_last_io_seconds_ago&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æœ€è¿‘ä¸€æ¬¡ä¸»ä»äº¤äº’ä¹‹åçš„ç§’æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;keyspace&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ•°æ®åº“ä¸­çš„ key å€¼æ€»æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;æŒä¹…æ€§æŒ‡æ ‡persistence&#34;&gt;æŒä¹…æ€§æŒ‡æ ‡ï¼šPersistence&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;&lt;strong&gt;Name&lt;/strong&gt;&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;&lt;strong&gt;Description&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;rdb_last_save_time&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æœ€åä¸€æ¬¡æŒä¹…åŒ–ä¿å­˜åˆ°ç£ç›˜çš„æ—¶é—´æˆ³&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;rdb_changes_since_last_save&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è‡ªæœ€åä¸€æ¬¡æŒä¹…åŒ–ä¾èµ–æ•°æ®åº“çš„æ›´æ”¹æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;é”™è¯¯æŒ‡æ ‡error&#34;&gt;é”™è¯¯æŒ‡æ ‡ï¼šError&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;&lt;strong&gt;Name&lt;/strong&gt;&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;&lt;strong&gt;Description&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;rejected_connections&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ç”±äºè¾¾åˆ° maxclient é™åˆ¶è€Œè¢«æ‹’ç»çš„è¿æ¥æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;keyspace_misses&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;key å€¼æŸ¥æ‰¾å¤±è´¥ï¼ˆæ²¡æœ‰å‘½ä¸­ï¼‰æ¬¡æ•°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;master_link_down_since_seconds&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ä¸»ä»æ–­å¼€çš„æŒç»­æ—¶é—´ï¼ˆä»¥ç§’ä¸ºå•ä½ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;ç›‘æ§æ–¹å¼&#34;&gt;ç›‘æ§æ–¹å¼&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å·¥å…·
&lt;ul&gt;
&lt;li&gt;Cloud Insight Redis&lt;/li&gt;
&lt;li&gt;Prometheus&lt;/li&gt;
&lt;li&gt;Redis-stat&lt;/li&gt;
&lt;li&gt;Redis-faina&lt;/li&gt;
&lt;li&gt;RedisLive&lt;/li&gt;
&lt;li&gt;zabbix&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å‘½ä»¤
&lt;ul&gt;
&lt;li&gt;benchmark&lt;/li&gt;
&lt;li&gt;redis cli
&lt;ul&gt;
&lt;li&gt;monitor&lt;/li&gt;
&lt;li&gt;showlog&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;benchmark&#34;&gt;benchmark&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å‘½ä»¤&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;redis-benchmark [-h ] [-p ] [-c ] [-n &amp;lt;requests]&amp;gt; [-k ] 
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;èŒƒä¾‹1&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;[root@iZ2ze4u2bufi0915gyi843Z ~]# redis-benchmarkÂ 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¯´æ˜ï¼š50ä¸ªè¿æ¥ï¼Œ10000æ¬¡è¯·æ±‚å¯¹åº”çš„æ€§èƒ½&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;èŒƒä¾‹2&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;redis-benchmark -c 100 -n 5000 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¯´æ˜ï¼š100ä¸ªè¿æ¥ï¼Œ5000æ¬¡è¯·æ±‚å¯¹åº”çš„æ€§èƒ½&lt;/p&gt;
&lt;h2 id=&#34;benchmark-2&#34;&gt;&lt;strong&gt;benchmark&lt;/strong&gt;&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/benchmark.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;monitor&#34;&gt;monitor&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å‘½ä»¤&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;monitor 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‰“å°æœåŠ¡å™¨è°ƒè¯•ä¿¡æ¯&lt;/p&gt;
&lt;h2 id=&#34;slowlog&#34;&gt;slowlog&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å‘½ä»¤&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;slowlog [operator] 
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;get ï¼šè·å–æ…¢æŸ¥è¯¢æ—¥å¿—&lt;/li&gt;
&lt;li&gt;len ï¼šè·å–æ…¢æŸ¥è¯¢æ—¥å¿—æ¡ç›®æ•°&lt;/li&gt;
&lt;li&gt;reset ï¼šé‡ç½®æ…¢æŸ¥è¯¢æ—¥å¿—&lt;/li&gt;
&lt;li&gt;ç›¸å…³é…ç½®&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;slowlog-log-slower-than 1000 #è®¾ç½®æ…¢æŸ¥è¯¢çš„æ—¶é—´ä¸‹çº¿ï¼Œå•ä½ï¼šå¾®å¦™ 
slowlog-max-len 100 #è®¾ç½®æ…¢æŸ¥è¯¢å‘½ä»¤å¯¹åº”çš„æ—¥å¿—æ˜¾ç¤ºé•¿åº¦ï¼Œå•ä½ï¼šå‘½ä»¤æ•°
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;æ€»ç»“-5&#34;&gt;æ€»ç»“&lt;/h1&gt;
&lt;p&gt;ä¼ä¸šçº§è§£å†³æ–¹æ¡ˆ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¼“å­˜é¢„çƒ­&lt;/li&gt;
&lt;li&gt;ç¼“å­˜é›ªå´©&lt;/li&gt;
&lt;li&gt;ç¼“å­˜å‡»ç©¿&lt;/li&gt;
&lt;li&gt;ç¼“å­˜ç©¿é€&lt;/li&gt;
&lt;li&gt;æ€§èƒ½æŒ‡æ ‡ç›‘æ§
&lt;ul&gt;
&lt;li&gt;å·¥å…·&lt;/li&gt;
&lt;li&gt;å‘½ä»¤&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
">é¢è¯•å¸¸é—®ä¹‹ç¼“å­˜é¢„çƒ­ã€ç¼“å­˜é›ªå´©ã€ç¼“å­˜å‡»ç©¿ã€ç¼“å­˜ç©¿é€</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/xian-cheng/"" data-c="
          &lt;h1 id=&#34;p-stylecolorred1-çº¿ç¨‹æŠ½è±¡p&#34;&gt;&lt;p style=&#34;color:red&#34;&gt;1. çº¿ç¨‹æŠ½è±¡&lt;/p&gt;&lt;/h1&gt;
&lt;p&gt;ä¸€ä¸ªçº¿ç¨‹æ˜¯ä¸€ä¸ªå•ä¸€çš„æ‰§è¡Œåºåˆ—ï¼Œå®ƒè¡¨ç¤ºäº†ä¸€ä¸ªå•ç‹¬è¢«è°ƒåº¦çš„ä»»åŠ¡.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å•ä¸€çš„æ‰§è¡Œåºåˆ—&lt;/strong&gt;. æ¯ä¸ªçº¿ç¨‹æ‰§è¡Œä¸€ä¸ªæŒ‡ä»¤åºåˆ—â€”â€”èµ‹å€¼ï¼Œæ¡ä»¶ï¼Œå¾ªç¯ï¼Œè¿‡ç¨‹, ç­‰ç­‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å•ç‹¬è¢«è°ƒåº¦çš„ä»»åŠ¡&lt;/strong&gt;. æ“ä½œç³»ç»Ÿå¯ä»¥åœ¨ä»»æ„æ—¶åˆ»ï¼Œè¿è¡Œï¼Œæš‚åœæˆ–è€…ç»§ç»­ä¸€ä¸ªçº¿ç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿è¡Œï¼ŒæŒ‚èµ·å’Œç»§ç»­æ‰§è¡Œçš„çº¿ç¨‹&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;çº¿ç¨‹æä¾›äº†ä¸€ä¸ªæœ‰æ— é™ä¸ªå¤„ç†æœºçš„å¹»è±¡ã€‚OS å¦‚ä½•å®ç°è¿™æ ·çš„å¹»è±¡å‘¢ï¼Ÿå®ƒå¿…é¡»æ‰§è¡Œæ¯ä¸ªè¿›ç¨‹çš„æŒ‡ä»¤ä½¿å¾—æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è¿›å±•ï¼Œä½†å®é™…çš„ç¡¬ä»¶åªæœ‰æœ‰é™ä¸ªæ•°çš„å¤„ç†æœºï¼Œç”šè‡³åªæœ‰ 1 ä¸ª&lt;/p&gt;
&lt;p&gt;ä¸ºäº†å°†ä»»æ„æ•°é‡çš„çº¿ç¨‹æ˜ å°„åˆ°æœ‰é™ä¸ªå¤„ç†æœºä¸Šï¼ŒOS åŒ…å«ä¸€ä¸ªè°ƒåº¦å™¨(scheduler)èƒ½å¤Ÿåœ¨è¿è¡Œå’Œå°±ç»ªçš„çº¿ç¨‹ä¹‹é—´æ¥å›åˆ‡æ¢ã€‚ä½†æ˜¯çº¿ç¨‹çš„åˆ‡æ¢å¯¹çº¿ç¨‹æ¥è¯´æ˜¯é€æ˜çš„ï¼Œåªæ˜¯æŸäº›æ—¶åˆ»å¤„ç†æœºçš„æ‰§è¡Œå˜å¾—æ¯”è¾ƒæ…¢è€Œå·²ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E7%BA%BF%E7%A8%8B%E4%B8%8D%E5%90%8C%E7%9A%84%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F.jpg&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;å›¾ 4.3&lt;/strong&gt;: ä¸€ä¸ªçº¿ç¨‹ 3 ç§å¯èƒ½çš„æ‰§è¡Œæ–¹å¼ ï¼Œå¯¹äºç¨‹åºå‘˜æ¥è¯´æ˜¯æ— å·®çš„.&lt;/p&gt;
&lt;p&gt;ä¸Šå›¾è¯´æ˜äº†ä¸€ä¸ªç¨‹åºå‘˜è§’åº¦çš„ä¸€ä¸ªç®€å•ç¨‹åºæœ‰ä¸‰ç§ä¸åŒçš„æ‰§è¡Œæ–¹å¼ï¼Œè¿™å–å†³äºè°ƒåº¦å™¨ã€‚ä»çº¿ç¨‹çš„è§’åº¦ï¼Œé™¤äº†æ‰§è¡Œçš„é€Ÿåº¦ä¸ä¸€æ ·ï¼Œè¿™äº›æ˜¯æ²¡å·®çš„ã€‚ç¡®å®ï¼Œçº¿ç¨‹å¹¶ä¸çŸ¥é“æœ‰å…¶ä»–çº¿ç¨‹åœ¨æ‰§è¡Œã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E7%BA%BF%E7%A8%8B%E4%BA%A4%E9%94%99%E6%89%A7%E8%A1%8C.jpg&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;å›¾ 4.4&lt;/strong&gt;: 3 ä¸ªçº¿ç¨‹åœ¨è¿è¡Œæ—¶è®¸å¤šç§å¯èƒ½çš„äº¤é”™æ‰§è¡Œçš„æ–¹å¼.&lt;/p&gt;
&lt;p&gt;ä¸Šå›¾å±•ç¤ºäº† 3 ä¸ªçº¿ç¨‹çš„äº¤æ›¿æ‰§è¡Œã€‚ä»–ä»¬çš„è¿™ç§é€Ÿåº¦æ˜¯ä¸å¯æ§çš„ï¼Œæ¯æ¬¡æ‰§è¡Œå¯èƒ½éƒ½ä¸ä¸€æ ·ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¾‹å­&lt;/strong&gt;:å†…æ ¸ä¸­æ–­å¤„ç†ç¨‹åºæ˜¯ä¸€ä¸ªçº¿ç¨‹?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å›ç­”ï¼š ä¸ï¼Œä¸€ä¸ªä¸­æ–­å¤„ç†ç¨‹åºä¸æ˜¯ä¸€ä¸ªçº¿ç¨‹&lt;/strong&gt;. ä¸€ä¸ªå†…æ ¸ä¸­æ–­å¤„ç†ç¨‹åºå’Œçº¿ç¨‹æœ‰ä¸€äº›ç›¸ä¼¼æ€§: å®ƒæ˜¯ä¸€ä¸ªæŒ‡ä»¤çš„åºåˆ—ï¼Œ ä»å¼€å¤´æ‰§è¡Œåˆ°ç»“å°¾ã€‚ç„¶è€Œï¼Œä¸€ä¸ªä¸­æ–­å¤„ç†ç¨‹åº&lt;strong&gt;ä¸æ˜¯ç‹¬ç«‹å¯è°ƒåº¦çš„&lt;/strong&gt;: å®ƒè¢«ä¸€ä¸ªç¡¬ä»¶I/O äº‹ä»¶æ‰€è§¦å‘æ‰§è¡Œ,  è€Œä¸æ˜¯å†…æ ¸ä¸­çº¿ç¨‹è°ƒåº¦å™¨æ¥å†³å®šä»€ä¹ˆæ—¶å€™æ‰§è¡Œ. ä¸€æ—¦å¼€å§‹ï¼Œä¸­æ–­å¤„ç†ç¨‹åºè¿è¡Œåˆ°ç»“æŸï¼Œé™¤éè¢«å¦å¤–ä¸€ä¸ªä¼˜å…ˆçº§æ›´é«˜çš„ä¸­æ–­æŠ¢å .&lt;/p&gt;
&lt;h1 id=&#34;p-stylecolorred2-ç®€åŒ–çš„çº¿ç¨‹-apip&#34;&gt;&lt;p style=&#34;color:red&#34;&gt;2. ç®€åŒ–çš„çº¿ç¨‹ API&lt;/p&gt;&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;void thread_create  (thread, func,arg)&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹, æŠŠä¿¡æ¯å­˜å…¥ thread. å’Œè°ƒç”¨çš„çº¿ç¨‹å¹¶å‘æ‰§è¡Œï¼Œçº¿ç¨‹æ‰§è¡Œå‡½æ•° funcï¼Œå…¶å‚æ•°ä¸º arg.&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;void thread_yield()&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è°ƒç”¨çš„çº¿ç¨‹è‡ªæ„¿æ”¾å¼ƒå¤„ç†æœºè®©å…¶ä»–çº¿ç¨‹æ¥è¿è¡Œã€‚è°ƒåº¦å™¨ä¹Ÿå¯ä»¥ç»§ç»­è¿è¡Œè°ƒç”¨çš„çº¿ç¨‹.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;int thread_join  (thread)&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ç­‰å¾… thread ç»“æŸå¦‚æœ thread è¿˜æ²¡æœ‰ç»“æŸçš„è¯; ç„¶åè¿”å›ç”± thread é€šè¿‡ thread_exit ä¼ é€’æ¥çš„å‚æ•°. æ³¨æ„ï¼Œ å¯¹æ¯ä¸ªçº¿ç¨‹ï¼Œthread_join åªèƒ½è¢«è°ƒç”¨ä¸€æ¬¡.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;void thread_exit(ret)&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å®Œæˆå½“å‰çš„çº¿ç¨‹. å°† ret çš„å€¼å­˜åœ¨å½“å‰çº¿ç¨‹çš„æ•°æ®ç»“æ„ä¸­ã€‚å¦‚æœå¦ä¸€ä¸ªçº¿ç¨‹å·²ç»ç”¨ thread_join ç­‰å¾…è¯¥çº¿ç¨‹, åˆ™ç»§ç»­æ‰§è¡Œé‚£ä¸ªç­‰å¾…çš„çº¿ç¨‹.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;å›¾ 4.5&lt;/strong&gt;:ä½¿ç”¨çº¿ç¨‹ç®€åŒ–çš„ API&lt;/p&gt;
&lt;p&gt;å›¾ 4.5 å±•ç¤ºäº†ä½¿ç”¨çº¿ç¨‹çš„ç®€å•çš„API. è¿™ä¸ªç®€åŒ–çš„API æ˜¯åŸºäºPOSIX æ ‡å‡†çš„pthreads API, ä½†æ˜¯å®ƒå¿½ç•¥äº†æŸäº›POSIX é€‰é¡¹å’Œé”™è¯¯å¤„ç†(ä¸ºäº†ç®€åŒ–). ç»å¤§å¤šæ•°å…¶ä»–çº¿ç¨‹åŒ…ä¹Ÿç±»ä¼¼ï¼Œå¦‚æœä½ ç†è§£å¦‚ä½•ç”¨è¿™ä¸ª API ç¼–ç¨‹çš„è¯ï¼Œä½ ä¼šå‘ç°å¯¹äºç»å¤§å¤šæ•°æ ‡å‡†çš„çº¿ç¨‹ API æ¥è¯´ï¼Œå…¶ä»£ç å¾ˆå®¹æ˜“ç¼–å†™.&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çœ‹è§ UNIX è¿›ç¨‹æŠ½è±¡ä¸­æœ‰ç±»ä¼¼çš„æ¦‚å¿µ. thread_create ç±»ä¼¼äºUNIX è¿›ç¨‹ fork å’Œ exec, è€Œ thread_join ç±»ä¼¼äº UNIX è¿›ç¨‹wait. UNIX fork åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„è¿›ç¨‹å’ŒåŸæ¥è°ƒç”¨ fork çš„è¿›ç¨‹å¹¶å‘çš„æ‰§è¡Œ;UNIX exec å¯¼è‡´è¿›ç¨‹è¿è¡Œä¸€ä¸ªæŒ‡å®šçš„ç¨‹åºã€‚UNIX wait è¿è¡Œè°ƒç”¨çš„è¿›ç¨‹æš‚åœæ‰§è¡Œç›´åˆ°æ–°çš„è¿›ç¨‹å®Œæˆä¸ºæ­¢ã€‚&lt;/p&gt;
&lt;h2 id=&#34;1-å¤šçº¿ç¨‹çš„hello-world&#34;&gt;1. å¤šçº¿ç¨‹çš„Hello World!&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%A4%9A%E7%BA%BF%E7%A8%8Bhelloworld%E8%BE%93%E5%87%BA%E7%BB%93%E6%9E%9C.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;å›¾ 4.6&lt;/strong&gt;: ç”¨ç®€å•çº¿ç¨‹API æ¥æ‰“å°â€Helloâ€åæ¬¡çš„å¤šçº¿ç¨‹ç¼–ç¨‹çš„ä¾‹å­ã€‚ä¹Ÿå±•ç¤ºäº†ä¸€ç§å¯èƒ½çš„è¾“å‡ºã€‚&lt;/p&gt;
&lt;p&gt;ä¸Šå›¾æ˜¯ä¸€ä¸ªå¤šçº¿ç¨‹çš„ç¨‹åºï¼Œç”¨äº†ç®€å•çš„çº¿ç¨‹ API æ¥æ‰“å° hello åæ¬¡ã€‚ä¹Ÿå±•ç¤ºäº†ä¸€ä¸ªå¯èƒ½çš„è¾“å‡ºç»“æœã€‚Main å‡½æ•°ç”¨ thread_create åˆ›å»ºäº† 10 ä¸ªå­çº¿ç¨‹ã€‚æœ‰è¶£çš„å‚æ•°æ˜¯ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªã€‚ç¬¬äºŒä¸ªå‚æ•° go æ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆâ€”â€”æ–°åˆ›å»ºçš„æ£€æµ‹åº”è¯¥å¼€å§‹æ‰§è¡Œçš„ä»£ç ä½ç½®ã€‚ç¬¬ä¸‰ä¸ªå‚æ•° i ä¼ é€’ç»™ go å‡½æ•°ã€‚å› æ­¤ï¼Œthread_create åˆå§‹åŒ–ç¬¬i ä¸ªçº¿ç¨‹çš„çŠ¶æ€ä½¿å¾—å®ƒå‡†å¤‡è°ƒç”¨å‡½æ•° goï¼Œå‚æ•°æ˜¯ iã€‚&lt;/p&gt;
&lt;p&gt;å½“è°ƒåº¦è€…è¿è¡Œç¬¬ i ä¸ªçº¿ç¨‹ï¼Œçº¿ç¨‹è¿è¡Œå‡½æ•°goï¼Œå‚æ•°ä¸º iï¼Œæ‰“å° hello from çº¿ç¨‹ iã€‚ çº¿ç¨‹æ¥ç€è¿”å›å€¼ i+100 é€šè¿‡è°ƒç”¨ thread_exit. è¿™ä¸ªè°ƒç”¨å°†ç‰¹å®šçš„å€¼ä¿å­˜åˆ° trhead_t çš„å¯¹è±¡é‡Œï¼Œä½¿å¾— thread_join èƒ½å¤Ÿæ‰¾åˆ°å®ƒã€‚&lt;/p&gt;
&lt;p&gt;Main å‡½æ•°ç”¨thread_join æ¥ç­‰å¾…æ¯ä¸ªå®ƒåˆ›å»ºçš„çº¿ç¨‹ã€‚å½“æ¯ä¸ªçº¿ç¨‹å®Œæˆçš„æ—¶å€™ï¼Œmain çš„ä»£ç ä¼šçš„è¯»å–å®Œæˆçº¿ç¨‹çš„é€€å‡ºå€¼å¹¶æ‰“å°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¾‹å­&lt;/strong&gt;ï¼šä¸ºä»€ä¹ˆæ¥è‡ªçº¿ç¨‹ 2 çš„â€œçº¿ç¨‹ returnedâ€çš„æ¶ˆæ¯&lt;strong&gt;ä¸€å®šæ˜¯&lt;/strong&gt;åœ¨æ¥è‡ªçº¿ç¨‹ 5 çš„çº¿ç¨‹ returned çš„æ¶ˆæ¯æ‰“å°ä¹‹å‰å…ˆæ‰“å°ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å›ç­”ï¼šè™½ç„¶æ¯ä¸ªåˆ›å»ºçš„çº¿ç¨‹å®Œæˆçš„é¡ºåºæ˜¯ä¸ç¡®å®šçš„ï¼Œä½†æ˜¯ä¸»çº¿ç¨‹æ˜¯æŒ‰ç…§åˆ›å»ºçš„é¡ºåºæŒ‰é¡ºåºæ£€æŸ¥çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¾‹å­&lt;/strong&gt;ï¼šå½“çº¿ç¨‹ 5 æ‰“å° hello çš„æ—¶å€™æœªé€€å‡ºçš„çº¿ç¨‹çš„æœ€å°‘æ•°æ˜¯å¤šå°‘ï¼Ÿæœ€å¤šæ•°æ˜¯å¤šå°‘ï¼Ÿ&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å›ç­”&lt;/strong&gt;ï¼šæœ€å°‘æ˜¯ 2ï¼Œæœ€å¤šæ˜¯ 11&lt;/p&gt;
&lt;h2 id=&#34;2-åˆ›å»ºçº¿ç¨‹thread_createå’Œçº¿ç¨‹ç­‰å¾…thread_joinåœ¨å¹¶è¡Œè®¡ç®—ä¸­çš„åº”ç”¨&#34;&gt;2. åˆ›å»ºçº¿ç¨‹(thread_create)å’Œçº¿ç¨‹ç­‰å¾…(thread_join)åœ¨å¹¶è¡Œè®¡ç®—ä¸­çš„åº”ç”¨&lt;/h2&gt;
&lt;p&gt;å°½ç®¡çº¿ç¨‹æ¥å£å¾ˆç®€å•ï¼Œä½†éå¸¸å¼ºå¤§ã€‚ä¾‹å¦‚ç”¨â€&lt;strong&gt;fork-join å¹¶è¡Œâ€&lt;/strong&gt;ï¼ˆ&lt;strong&gt;fork-join å¹¶è¡Œ&lt;/strong&gt;å³ thread_create å’Œ thread_join ä¸€èµ·ä½¿ç”¨æ¥å®ç°å¹¶è¡ŒåŒ–è®¡ç®—ï¼‰, ä¸€ä¸ªçº¿ç¨‹å¯ä»¥åˆ›å»ºå­çº¿ç¨‹æ¥æ‰§è¡Œå·¥ä½œ(â€œforkâ€, æˆ–è€… thread_create), å®ƒå¯ä»¥ç­‰å¾…ä»–ä»¬çš„ç»“æœ(â€œjoinâ€).&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;// ä¸ºäº†ä¼ é€’ä¸¤ä¸ªå‚æ•°ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªç»“æ„æ¥ä¿å­˜å®ƒä»¬.
typedef struct bzeroparams {
   unsigned char *buffer; int length;
};
#define NTHREADS 10
void go (struct bzeroparams *p) {
   memset(p-&amp;gt;buffer, 0, p-&amp;gt;length);
}
//ç”¨å¤šçº¿ç¨‹å¯¹ä¸€ä¸ªå—è¿›è¡Œæ¸…é›¶.
void blockzero (unsigned char *p, int length) {
  int i;
  thread_t threads[NTHREADS];
  struct bzeroparams params[NTHREADS];
  // ä¸ºäº†ç®€åŒ–ï¼Œå‡è®¾é•¿åº¦å¯ä»¥è¢«NTHREADS æ•´é™¤. assert((length   NTHREADS) == 0);
  for (i = 0; i &amp;lt; NTHREADS; i++) {
      params[i].buffer = p + i * length/NTHREADS; params[i].length = length/NTHREADS; thread_create_p(&amp;amp;(threads[i]), &amp;amp;go, &amp;amp;params[i]);
  }
  for (i = 0; i &amp;lt; NTHREADS; i++) {
      thread_join(threads[i]);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;å›¾ 4.7&lt;/strong&gt;: ä½¿ç”¨å¤šçº¿ç¨‹å¹¶è¡Œåœ°å¯¹ä¸€ä¸ªå†…å­˜è¿ç»­åŒºåŸŸæ¸…é›¶çš„ç¨‹åº.&lt;br&gt;
&lt;strong&gt;ä¾‹å­ï¼šå¹¶è¡Œçš„å—æ¸…é›¶&lt;/strong&gt;.åœ¨æ“ä½œç³»ç»Ÿä¸­ä¸€ä¸ªåº”ç”¨ fork-join å¹¶è¡Œçš„ç®€å•ä¾‹å­æ˜¯å¯¹ä¸€æ®µè¿ç»­å†…å­˜å—æ¸…é›¶çš„è¿‡ç¨‹. æ¯å½“ä¸€ä¸ªè¿›ç¨‹ç»“æŸçš„æ—¶å€™ï¼Œä¸ºäº†é˜»æ­¢æ— æ„çš„æ•°æ®æ³„éœ², æ“ä½œç³»ç»Ÿå¿…é¡»æŠŠåˆ†é…ç»™è¿™ä¸ªè¿›ç¨‹ä¸­çš„å†…å­˜æ¸…é›¶ã€‚å¦åˆ™ï¼Œä¸€ä¸ªæ–°çš„è¿›ç¨‹å¯èƒ½ä¼šè¢«é‡æ–°åˆ†é…ç»™è¿™ä¸ªå†…å­˜, ä½¿å¾—è¿™ä¸ªè¿›ç¨‹å¯ä»¥è¯»å–æ½œåœ¨çš„æ•æ„Ÿçš„æ•°æ®ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæ“ä½œç³»ç»Ÿçš„è¿œç¨‹ç™»å½•ç¨‹åºå¯èƒ½æš‚æ—¶å­˜å‚¨ä¸€ä¸ªç”¨æˆ·çš„å¯†ç åœ¨å†…å­˜ä¸­ï¼Œä½†æ˜¯ä¸‹ä¸€ä¸ªä½¿ç”¨åŒä¸€å†…å­˜åŒºé—´çš„è¿›ç¨‹å¯èƒ½ä¼šæ˜¯ä¸€ä¸ªè¢«ä¸€ä¸ªæ¶æ„ç”¨æˆ·è°ƒç”¨çš„æ‰«æå†…å­˜çš„ç¨‹åº.&lt;/p&gt;
&lt;p&gt;å¯¹äºä¸€ä¸ªå¤§çš„è¿›ç¨‹ï¼Œå¹¶è¡Œåœ°æ¸…é›¶çš„å‡½æ•°æ˜¯åˆç†çš„ã€‚åœ¨ç°ä»£è®¡ç®—æœºä¸Šï¼Œå¯¹ 1GB çš„å†…å­˜æ¸…é›¶éœ€è¦å¤§çº¦ 50 æ¯«ç§’; ç›¸æ¯”ä¹‹ä¸‹ï¼Œåˆ›å»ºå’Œå¯åŠ¨ä¸€ä¸ªæ–°çš„çº¿ç¨‹åªéœ€è¦å‡ åå¾®ç§’.&lt;/p&gt;
&lt;p&gt;å›¾ 4.7 å±•ç¤ºäº†ä¸€ä¸ªä½¿ç”¨fork-join å¹¶è¡Œæ¸…é›¶çš„ä»£ç ã€‚å¤šçº¿ç¨‹çš„ blockzero åˆ›å»ºäº†ä¸€ç³»åˆ—çº¿ç¨‹å¹¶ç»™æ¯ä¸ªåˆ†é…äº†ä¸€æ®µä¸ç›¸äº¤çš„å†…å­˜åŒºé—´; å½“æ‰€æœ‰çº¿ç¨‹éƒ½å®Œæˆå®ƒä»¬çš„å·¥ä½œçš„æ—¶å€™æ•´ä¸ªåŒºé—´éƒ½è¢«æ¸…é›¶. æ“ä½œç³»ç»Ÿå¯ä»¥åˆ›å»ºä¸€ç³»åˆ—ä½ä¼˜å…ˆçº§çš„çº¿ç¨‹æ¥è¿è¡Œ blockzero. ä¹‹åï¼Œå½“å†…å­˜è¢«éœ€è¦çš„æ—¶å€™ï¼Œå†…æ ¸å¯ä»¥è°ƒç”¨ thread_join. å¦‚æœé‚£ä¸ªæ—¶å€™å·²ç»å®Œå…¨æ¸…é›¶ï¼Œåˆ™join ä¼šç«‹å³è¿”å›ï¼›å¦åˆ™å®ƒéœ€è¦ç­‰å¾…ç›´åˆ°è¿™å—å†…å­˜å¯ä»¥è¢«å®‰å…¨ä½¿ç”¨.&lt;/p&gt;
&lt;h1 id=&#34;p-stylecolorred3-çº¿ç¨‹çš„æ•°æ®ç»“æ„p&#34;&gt;&lt;p style=&#34;color:red&#34;&gt;3. çº¿ç¨‹çš„æ•°æ®ç»“æ„&lt;/p&gt;&lt;/h1&gt;
&lt;p&gt;ä¸ºäº†ç†è§£æ“ä½œç³»ç»Ÿå¦‚ä½•å®ç°çº¿ç¨‹çš„æŠ½è±¡ï¼Œæˆ‘ä»¬å¿…é¡»å®šä¹‰ä¸¤ç§çŠ¶æ€ï¼Œä¸€ä¸ªæ˜¯æ¯ä¸ªçº¿ç¨‹çš„çŠ¶æ€(the Per-Thread State)ï¼Œ å¦ä¸€ä¸ªæ˜¯å¤šä¸ªçº¿ç¨‹çš„å…±äº«çŠ¶æ€(the Shared State)ã€‚ç„¶åæˆ‘ä»¬æ‰èƒ½ç»™æè¿°ä¸€ä¸ªçº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸâ€”â€”æä¾›ä¸Šè¿°æŠ½è±¡ï¼Œæ“ä½œç³»ç»Ÿæ˜¯å¦‚ä½•èƒ½å¤Ÿåˆ›å»ºï¼Œå¼€å§‹ï¼Œæš‚åœå’Œåˆ é™¤çº¿ç¨‹çš„ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E7%BA%BF%E7%A8%8B%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84.jpg&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;å›¾ 4.8&lt;/strong&gt;: ä¸€ä¸ªå¤šçº¿ç¨‹çš„è¿›ç¨‹æˆ–è€…æ“ä½œç³»ç»Ÿçš„å†…æ ¸æ—¢æœ‰æ¯ä¸ªçº¿ç¨‹çš„çŠ¶æ€ä¹Ÿæœ‰å…±äº«çŠ¶æ€. çº¿ç¨‹æ§åˆ¶å—ï¼ˆTCBï¼‰å­˜å‚¨äº†æ¯ä¸ªçº¿ç¨‹çš„çŠ¶æ€: çº¿ç¨‹å½“å‰çš„è®¡ç®—çŠ¶æ€(ä¾‹å¦‚ï¼Œè¢«ä¿å­˜çš„å¤„ç†æœºçš„å¯„å­˜å™¨å’Œä¸€ä¸ªæŒ‡å‘(å†…æ ¸)æ ˆçš„æŒ‡é’ˆ)å’Œéœ€è¦ç®¡ç†è¯¥çº¿ç¨‹çš„å…ƒæ•°æ®(ä¾‹å¦‚ï¼Œçº¿ç¨‹çš„ IDï¼Œè°ƒåº¦ä¼˜å…ˆçº§ï¼Œæ‹¥æœ‰è€…). å…±äº«çš„çŠ¶æ€åŒ…æ‹¬ç¨‹åºçš„ä»£ç ï¼Œå…¨å±€é™æ€å˜é‡å’Œå †.&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªå¤šçº¿ç¨‹çš„è¿›ç¨‹æˆ–è€…æ“ä½œç³»ç»Ÿå†…æ ¸éƒ½æœ‰æ¯ä¸ªçº¿ç¨‹çš„çŠ¶æ€å’Œå…±äº«çŠ¶æ€ã€‚çº¿ç¨‹æ§åˆ¶å—ä¿å­˜ç€æ¯ä¸ªçº¿ç¨‹çš„çŠ¶æ€: çº¿ç¨‹è®¡ç®—å½“å‰çš„çŠ¶æ€(ä¾‹å¦‚ï¼Œä¿å­˜çš„å¤„ç†æœºçš„å¯„å­˜å™¨å’Œ(å†…æ ¸)æ ˆæŒ‡é’ˆ)å’Œéœ€è¦ç®¡ç†è¿™ä¸ªçº¿ç¨‹çš„å…ƒæ•°æ®(ä¾‹å¦‚ï¼Œçº¿ç¨‹çš„ IDï¼Œ è°ƒåº¦çš„ä¼˜å…ˆçº§ï¼Œæ‹¥æœ‰è€…)ã€‚å…±äº«çŠ¶æ€åŒ…æ‹¬ï¼šç¨‹åºçš„ä»£ç ï¼Œå…¨å±€å˜é‡å’Œå †ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ¯ä¸ªçº¿ç¨‹çš„çŠ¶æ€(Per-Thread State)å’Œçº¿ç¨‹æ§åˆ¶å—(TCB)&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ“ä½œç³»ç»Ÿéœ€è¦ä¸€ä¸ªæ•°æ®ç»“æ„æ¥è¡¨ç¤ºä¸€ä¸ªçº¿ç¨‹çš„çŠ¶æ€ï¼›çº¿ç¨‹å°±å¥½æ¯”æ˜¯è¿™ä¸ªæ•°æ®ç»“æ„ä¸‹çš„ä¸€ä¸ªå…·ä½“çš„å¯¹è±¡ã€‚è¿™ä¸ªæ•°æ®ç»“æ„è¢«ç§°ä¸ºçº¿ç¨‹æ§åˆ¶å—(çº¿ç¨‹æ§åˆ¶å—, TCB)ã€‚å¯¹äºæ¯ä¸ªæ“ä½œç³»ç»Ÿåˆ›å»ºçš„çº¿ç¨‹ï¼Œå®ƒå°±åˆ›å»ºä¸€ä¸ªTCBã€‚&lt;/p&gt;
&lt;p&gt;çº¿ç¨‹æ§åˆ¶å—è®°å½•ä¸¤ç§ç±»å‹çš„æ¯ä¸ªçº¿ç¨‹çš„ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è¿™ä¸ªçº¿ç¨‹å½“å‰çš„è®¡ç®—çŠ¶æ€ï¼šæ ˆå’Œå¤„ç†å™¨ä¸­å¯„å­˜å™¨çš„å€¼&lt;/li&gt;
&lt;li&gt;ç”¨äºç®¡ç†è¯¥çº¿ç¨‹çš„å…ƒæ•°æ®&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å…±äº«çŠ¶æ€&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ‰ä¸€äº›çŠ¶æ€æ˜¯å±äºåŒä¸€åº”ç”¨è¿›ç¨‹é‡Œçš„ä¸åŒçº¿ç¨‹ä¹‹é—´å…±äº«çš„çŠ¶æ€ï¼Œæˆ–è€…æ˜¯æ“ä½œç³»ç»Ÿå†…æ ¸å†…çš„çº¿ç¨‹ä¹‹é—´å…±äº«çš„çŠ¶æ€ã€‚ç‰¹åˆ«çš„ï¼Œç¨‹åºä»£ç æ˜¯åŒä¸€è¿›ç¨‹ä¸­æ‰€æœ‰çº¿ç¨‹å…±äº«çš„ï¼Œå°½ç®¡æ¯ä¸ªçº¿ç¨‹å¯èƒ½æ‰§è¡Œä»£ç çš„ä¸åŒä½ç½®ã€‚é™¤æ­¤ä»¥å¤–ï¼Œé™æ€åˆ†é…çš„  å…¨å±€å˜é‡å’ŒåŠ¨æ€åˆ†é…çš„å †å˜é‡ä¹Ÿæ˜¯åŒä¸€è¿›ç¨‹çš„æ‰€æœ‰çº¿ç¨‹æ‰€å…±äº«çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è­¦å‘Š&lt;/strong&gt;ï¼šè¿™æ˜¯é€»è¾‘ä¸Šçš„åŒºåˆ†çŠ¶æ€ï¼ˆPer-Thread State å’Œ Shared Stateï¼‰ï¼Œè€Œæ“ä½œç³»ç»Ÿå¾€å¾€ä¸å¼ºåˆ¶è¿™ç§åŒºåˆ†ï¼Œæ¢å¥è¯è¯´ï¼Œä¸€ä¸ªçº¿ç¨‹å¯ä»¥å»è®¿é—®åŒä¸€è¿›ç¨‹å†…çš„å…¶ä»–çº¿ç¨‹çš„æ¯ä¸ªçº¿ç¨‹çš„çŠ¶æ€ï¼Œä¾‹å¦‚è®¿é—®å…¶ä»–çº¿ç¨‹çš„ç”¨æˆ·æ ˆã€‚&lt;strong&gt;è¿™æ˜¯è¢«å…è®¸çš„&lt;/strong&gt;ã€‚é‚£ä¹ˆä¸ºäº†é¿å…ä¸è¦çš„é”™è¯¯ï¼Œç¼–å†™ä¸€ä¸ªå¤šçº¿ç¨‹çš„ç¨‹åºçš„æ—¶å€™å¿…é¡»è¦æ¸…æ¥šå“ªäº›å˜é‡æ˜¯çº¿ç¨‹ä¹‹é—´å…±äº«çš„ï¼Œå“ªäº›æ˜¯ç§æœ‰çš„ã€‚ä»¥é˜²ä¸€ä¸ªçº¿ç¨‹ä¼šç ´åå…¶ä»–çº¿ç¨‹ã€‚&lt;/p&gt;
&lt;h1 id=&#34;p-stylecolorred4-çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸp&#34;&gt;&lt;p style=&#34;color:red&#34;&gt;4. çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ&lt;/p&gt;&lt;/h1&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E7%BA%BF%E7%A8%8B%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F.jpg&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;å›¾ 4.9: ä¸€ä¸ªçº¿ç¨‹åœ¨å®ƒçš„ç”Ÿå‘½å‘¨æœŸä¸­çš„çŠ¶æ€.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¸Šå›¾å±•ç¤ºäº†ä¸€ä¸ªçº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ–°å»º&lt;/strong&gt;ï¼šçº¿ç¨‹åˆ›å»ºä¼šæŠŠä¸€ä¸ªçº¿ç¨‹è®¾ä¸ºæ–°å»ºçŠ¶æ€ï¼Œåˆ†é…å’Œåˆå§‹åŒ–æ¯ä¸ªçº¿ç¨‹çš„çš„æ•°æ®ç»“æ„ã€‚ä¸€æ—¦è¿™äº›å®Œæˆï¼Œthread_ creation ä»£ç ä¼šæŠŠè¯¥çº¿ç¨‹æ”¾åˆ°å°±ç»ªé˜Ÿåˆ—ä¸­ï¼ˆéšå«çš„æ„æ€æ˜¯è®¾ç½®ä¸ºREADY çŠ¶æ€ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å°±ç»ª&lt;/strong&gt;ï¼šä¸€ä¸ªçº¿ç¨‹æ˜¯å°±ç»ªæ€å°±æ˜¯æŒ‡å®ƒå¯ä»¥è¿è¡Œä½†å½“å‰è¿˜æ²¡æœ‰è¿è¡Œã€‚å®ƒçš„ TCB è¢«æ”¾åœ¨å°±ç»ªé˜Ÿåˆ—ä¸Šï¼Œå®ƒçš„å¯„å­˜å™¨çš„å€¼è¢«ä¿å­˜åœ¨å®ƒçš„ TCB ä¸­ã€‚åœ¨ä»»æ„æ—¶åˆ»ï¼Œè°ƒåº¦å™¨å¯ä»¥è®©ä¸€ä¸ªçº¿ç¨‹ä»å°±ç»ªæ€åˆ°è¿è¡Œæ€ï¼Œåªéœ€è¦æŠŠå®ƒä¿å­˜åœ¨ TCB ä¸­çš„å¯„å­˜å™¨çš„å€¼æ¢å¤åˆ°å¤„ç†æœºçš„å¯„å­˜å™¨ä¸Šã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿è¡Œ&lt;/strong&gt;ï¼šä¸€ä¸ªçº¿ç¨‹æ˜¯è¿è¡Œæ€å°±æ˜¯æŒ‡å®ƒæ­£åœ¨ä¸€ä¸ªå¤„ç†æœºä¸Šè¿è¡Œã€‚æ­¤æ—¶ï¼Œå®ƒçš„å¯„å­˜å™¨çš„å€¼è¿˜åœ¨å¤„ç†æœºçš„å¯„å­˜å™¨ä¸Šï¼Œè€Œä¸æ˜¯TCB ä¸­ã€‚ä¸€ä¸ªè¿è¡Œæ€çš„çº¿ç¨‹å¯ä»¥æŒ‰ä¸‹é¢ä¸¤ç§æ–¹å¼åˆ‡æ¢åˆ°å°±ç»ªæ€ï¼š
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;è°ƒåº¦å™¨æŠ¢å ä¸€ä¸ªè¿è¡Œçš„çº¿ç¨‹ï¼Œç„¶åå°†å®ƒæ”¾åˆ°å°±ç»ªæ€ï¼Œé€šè¿‡ï¼ˆ1ï¼‰ä¿å­˜çº¿ç¨‹çš„å¯„å­˜å™¨å€¼åˆ°å®ƒçš„ TCB ä¸­ï¼›å¹¶ä¸”ï¼ˆ2ï¼‰å°†å¤„ç†æœºåˆ‡æ¢å»æ‰§è¡Œå°±ç»ªé˜Ÿåˆ—ä¸­æŸçº¿ç¨‹&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¸€ä¸ªè¿è¡Œæ€çš„çº¿ç¨‹å¯ä»¥è‡ªæ„¿åœ°æ”¾å¼ƒ(relinquish)å¤„ç†æœºç„¶åä»è¿è¡Œæ€åˆ°å°±ç»ªæ€ï¼Œé€šè¿‡è°ƒç”¨ yield(ä¾‹å¦‚ï¼Œçº¿ç¨‹åº“ä¸­çš„ thread_yield)&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ³¨ï¼šä¸€ä¸ªçº¿ç¨‹å¯ä»¥ä»å°±ç»ªæ€åˆ°è¿è¡Œæ€ï¼Œå†ä»è¿è¡Œæ€åˆ°å°±ç»ªæ€ï¼Œè¿™æ ·å¤šæ¬¡åˆ‡æ¢ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç­‰å¾…&lt;/strong&gt;ï¼šä¸€ä¸ªçº¿ç¨‹åœ¨ç­‰å¾…æ€æ˜¯æŒ‡å®ƒåœ¨ç­‰å¾…æŸä¸ªäº‹ä»¶ã€‚è°ƒåº¦å™¨èƒ½å¤Ÿå°†ä¸€ä¸ªçº¿ç¨‹ä»å°±ç»ªæ€ç§»åŠ¨åˆ°è¿è¡Œæ€ï¼Œä¸€ä¸ªåœ¨ç­‰å¾…æ€çš„çº¿ç¨‹å´ä¸èƒ½åˆ‡æ¢åˆ°è¿è¡Œæ€ï¼Œå®ƒå¿…é¡»è¦ç­‰å¾…æŸä¸ªå…¶ä»–çš„çº¿ç¨‹å°†å®ƒä»ç­‰å¾…æ€ç§»åŠ¨åˆ°å°±ç»ªæ€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®Œæˆ&lt;/strong&gt;ï¼šä¸€ä¸ªçº¿ç¨‹åœ¨å®Œæˆæ€å°±æ„å‘³ç€å®ƒç”¨äºä¸ä¼šå†è¿è¡Œäº†ã€‚ç³»ç»Ÿèƒ½å¤Ÿé‡Šæ”¾éƒ¨åˆ†æˆ–è€…å®ƒçš„å…¨éƒ¨çŠ¶æ€ï¼Œä½†å®ƒä»ç„¶è¦ä¿ç•™çº¿ç¨‹æ®‹ç•™çš„ä¸€äº›ä¿¡æ¯ï¼Œå¹¶æŠŠçº¿ç¨‹çš„ TCB æ”¾åˆ°ä¸€ä¸ªå®Œæˆé˜Ÿåˆ—ä¸Šã€‚ä¾‹å¦‚ï¼Œthread_exit è°ƒç”¨ä¼šè®©ä¸€ä¸ªçº¿ç¨‹å°†å®ƒçš„é€€å‡ºå€¼é€šè¿‡ thread_join ä¼ é€’ç»™å®ƒçš„çˆ¶äº²çº¿ç¨‹ã€‚å½“ä¸€ä¸ªçº¿ç¨‹çš„çŠ¶æ€å†æ²¡ä»»ä½•ç”¨å¤„çš„æ—¶å€™ï¼ˆä¾‹å¦‚ï¼Œå½“å®ƒçš„é€€å‡ºå€¼å·²ç»è¢« thread_join è¯»å–äº†ï¼‰ï¼Œç³»ç»Ÿå°±å¯ä»¥åˆ é™¤å’Œå–å›è¯¥çº¿ç¨‹çš„çŠ¶æ€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E4%B8%8D%E5%90%8C%E7%8A%B6%E6%80%81%E4%B8%8B%E7%BA%BF%E7%A8%8B%E7%9A%84%E4%BD%8D%E7%BD%AE.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;å›¾ 4.10: åœ¨ä¸åŒçŠ¶æ€ä¸‹çº¿ç¨‹çš„æ¯ä¸ªçº¿ç¨‹çŠ¶æ€çš„ä½ç½®.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç†è§£è¿™äº›çŠ¶æ€çš„ä¸€ç§æ–¹å¼å°±æ˜¯è€ƒè™‘ä¸€ä¸ªçº¿ç¨‹çš„ TCB å’Œå¯„å­˜å™¨å€¼å­˜æ”¾çš„ä½ç½®ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚å½“æ‰€æœ‰çº¿ç¨‹åœ¨å°±ç»ªæ€ï¼Œå®ƒä»¬çš„ TCB è¢«æ”¾åœ¨å°±ç»ªé˜Ÿåˆ—ï¼Œå®ƒä»¬çš„å¯„å­˜å™¨çš„å€¼çš„æ‹·è´ä¹Ÿæ”¾åœ¨ TCB ä¸­ã€‚æ‰€æœ‰åœ¨è¿è¡Œæ€çš„çº¿ç¨‹ï¼Œå®ƒä»¬çš„ TCB è¢«æ”¾åœ¨è¿è¡Œé˜Ÿåˆ—ä¸Šï¼Œå®ƒä»¬çš„å¯„å­˜å™¨å€¼æ˜¯åœ¨ç¡¬ä»¶å¯„å­˜å™¨ä¸Šã€‚æ‰€æœ‰åœ¨ç­‰å¾…æ€çš„çº¿ç¨‹å®ƒä»¬çš„ TCB æ˜¯æ”¾åœ¨ä¸åŒçš„åŒæ­¥å˜é‡çš„ç­‰å¾…é˜Ÿåˆ—ä¸Šã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;idle çº¿ ç¨‹&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœä¸€ä¸ªç³»ç»Ÿæœ‰ k ä¸ªå¤„ç†æœº,  ç»å¤§å¤šæ•°æ“ä½œç³»ç»Ÿç¡®ä¿æ­£å¥½æœ‰ k ä¸ªæ‰§è¡Œæ€çš„çº¿ç¨‹,  é€šè¿‡åœ¨æ¯ä¸ªå¤„ç†æœºä¸Šç»´æŠ¤ä¸€ä¸ªä½ä¼˜å…ˆçº§çš„ &lt;strong&gt;idle çº¿ç¨‹&lt;/strong&gt;ä»¥ä¿è¯å½“è¯¥å¤„ç†æœºæ²¡æœ‰ä»€ä¹ˆäº‹æƒ…å¯åšçš„æ—¶å€™ï¼Œä»ç„¶æœ‰çº¿ç¨‹åœ¨æ‰§è¡Œ.&lt;/p&gt;
&lt;p&gt;åœ¨æ—§æœºå™¨ä¸Šï¼Œidle çº¿ç¨‹ä¼šåœ¨ä¸€ä¸ªç´§å‡‘å¾ªç¯ä¸­ä»€ä¹ˆä¹Ÿä¸åš. è€Œä»Šå¤©ï¼Œidle çº¿ç¨‹ä»ç„¶åœ¨ä¸€ä¸ªloop ä¸­ spin, ä½†æ˜¯ä¸ºäº†çœç”µï¼Œåœ¨æ¯æ¬¡è¿­ä»£ä¸­ï¼Œå®ƒæŠŠå¤„ç†æœºè¿›å…¥ä¸€ä¸ªä½è€—ç”µçš„ç¡çœ æ¨¡å¼ã€‚åœ¨ç¡çœ æ¨¡å¼ä¸­ï¼Œå¤„ç†æœºæš‚åœæ‰§è¡ŒæŒ‡ä»¤ç›´åˆ°å‡ºç°ä¸€ä¸ªç¡¬ä»¶ä¸­æ–­ã€‚ç„¶åï¼Œå¤„ç†æœºé†’æ¥å¹¶æŒ‰ç…§é€šå¸¸çš„æ–¹å¼æ¥å¤„ç†ä¸­æ–­â€”ä¿å­˜å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹(idle çº¿ç¨‹)çš„çŠ¶æ€å¹¶æ‰§è¡Œå¤„ç†ç¨‹åº. åœ¨è¿è¡Œäº†å¤„ç†ç¨‹åºä¹‹åï¼Œä¸€ä¸ªç­‰å¾…æ­¤ I/O äº‹ä»¶çš„çº¿ç¨‹ç°åœ¨å¯ä»¥æ˜¯å°±ç»ªæ€. å¦‚æœæ˜¯è¿™æ ·çš„è¯ï¼Œè°ƒåº¦å™¨æ¥ä¸‹æ¥å°±æ‰§è¡Œè¿™ä¸ªè¿›å…¥å°±ç»ªæ€çš„çº¿ç¨‹ï¼›å¦åˆ™ idle çº¿ç¨‹ç»§ç»­æ‰§è¡Œï¼Œè®©å¤„ç†æœºå†æ¬¡å»ç¡è§‰.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;ä¾‹å­&lt;/strong&gt;ï¼šå¯¹äºçº¿ç¨‹ Hello ç¨‹åºï¼Œåœ¨ä¸€ä¸ªå•å¤„ç†æœºä¸Šï¼Œä¸»çº¿ç¨‹è¿›å…¥å°±ç»ªæ€çš„æœ€å°‘æ¬¡æ•°æ˜¯å¤šå°‘ï¼Ÿæœ€å¤šæ¬¡æ•°åˆæ˜¯å¤šå°‘ï¼Ÿ&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å›ç­”&lt;/strong&gt;ï¼šå½“ä¸»çº¿ç¨‹è¢«åˆ›å»ºæ—¶ï¼Œå®ƒå¿…é¡»è¿›å…¥å°±ç»ªæ€ï¼›å¦åˆ™å®ƒæ°¸è¿œä¸ä¼šè¢«è°ƒåº¦ã€‚åœ¨ä¸€ä¸ªå•å¤„ç†æœºä¸Šï¼Œå®ƒå¿…é¡»æ”¾å¼ƒå¤„ç†æœºä¸ºäº†è®©å®ƒçš„çº¿ç¨‹è¿è¡Œã€‚åœ¨ä¸»çº¿ç¨‹è¢«é‡æ–°è°ƒåº¦ä¹‹å‰ï¼Œå­çº¿ç¨‹ä»¬æ¥ä¸‹æ¥å¯ä»¥å®Œæˆè¿è¡Œã€‚ä¸€æ—¦å­©å­ä»¬å®Œæˆï¼Œä¸»çº¿ç¨‹å¯ä»¥å®Œæˆè¿è¡Œã€‚&lt;strong&gt;å› æ­¤æœ€å°çš„æ¬¡æ•°æ˜¯ 2&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æœ€å¤§çš„æ¬¡æ•°åˆ™æ˜¯æ¥è¿‘äºæ— ç©·å¤§&lt;/strong&gt;ã€‚ä¸€ä¸ªè¿è¡Œçš„çº¿ç¨‹å¯ä»¥è¢«æŠ¢å ç„¶åè¢«é‡æ–°è°ƒåº¦è‹¥å¹²æ¬¡ï¼Œè€Œä¸å½±å“æ‰§è¡Œçš„æ­£ç¡®æ€§ã€‚&lt;/p&gt;
&lt;h1 id=&#34;p-stylecolorred5-å®ç°å†…æ ¸çº¿ç¨‹p&#34;&gt;&lt;p style=&#34;color:red&#34;&gt;5. å®ç°å†…æ ¸çº¿ç¨‹&lt;/p&gt;&lt;/h1&gt;
&lt;p&gt;æˆ‘ä»¬ä»‹ç»å†…æ ¸çº¿ç¨‹çš„å®ç°ã€‚è¿™æ˜¯æ‰€æœ‰çº¿ç¨‹å®ç°ä¸­æœ€åŸºç¡€çš„ï¼Œä¹Ÿæ˜¯æœ€ç®€å•çš„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;p-stylecolorreda-åˆ›å»ºå†…æ ¸çº¿ç¨‹ä»£ç ä¸è¦æ±‚ä½†åé¢ä»‹ç»çš„åŸºæœ¬æ­¥éª¤éœ€è¦æŒæ¡p&#34;&gt;&lt;p style=&#34;color:red&#34;&gt;a. åˆ›å»ºå†…æ ¸çº¿ç¨‹ï¼ˆä»£ç ä¸è¦æ±‚ï¼Œä½†åé¢ä»‹ç»çš„åŸºæœ¬æ­¥éª¤éœ€è¦æŒæ¡ï¼‰&lt;/p&gt;&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;// func æ˜¯ä¸€ä¸ªæŒ‡å‘çº¿ç¨‹è¦è¿è¡Œçš„è¿‡ç¨‹çš„æŒ‡é’ˆ.
// arg æ˜¯ä¼ é€’ç»™è¿™ä¸ªè¿‡ç¨‹çš„å‚æ•°.
void thread_create(thread_t *thread, void (*func)(int), int arg) {
  // Allocate TCB and stack TCB *tcb = new TCB();
  thread -&amp;gt;tcb = tcb;
  tcb-&amp;gt;stack_size = INITIAL_STACK_SIZE;
  tcb-&amp;gt;stack = new Stack(INITIAL_STACK_SIZE);
  // åˆå§‹åŒ–å¯„å­˜å™¨ä½¿å¾—å½“çº¿ç¨‹ç»§ç»­æ‰§è¡Œçš„æ—¶å€™ï¼Œå®ƒä» stub å¼€å§‹æ‰§è¡Œã€‚
  //æ ˆä»åˆ†é…çš„åŒºåŸŸçš„é¡¶ç«¯å¼€å§‹ï¼Œç„¶åå‘ä¸‹å¢é•¿. tcb-&amp;gt;sp = tcb-&amp;gt;stack + INITIAL_STACK_SIZE; tcb-&amp;gt;pc = stub;
  // é€šè¿‡æŠŠ stub çš„å‚æ•°å‹æ ˆæ¥åˆ›å»ºä¸€ä¸ªæ ˆå¸§
  *(tcb-&amp;gt;sp) = arg; tcb-&amp;gt;sp--;
  *(tcb-&amp;gt;sp) = func; tcb-&amp;gt;sp--;
  // åˆ›å»ºå¦ä¸€ä¸ªæ ˆå¸§ä½¿å¾— thread_switch æ­£ç¡®å·¥ä½œ. è¿™ä¸ª routine åœ¨æœ¬ç« åé¢è§£é‡Š. thread_dummySwitchFrame(tcb);
  tcb-&amp;gt;state = READY;
  readyList.add(tcb); // æŠŠ TCB æ”¾åœ¨å°±ç»ªé˜Ÿåˆ—
}
void stub(void (*func)(int), int arg) {
  (*func)(arg); // æ‰§è¡Œå‡½æ•° func()
  thread_exit(0); // å¦‚æœ func()ä¸è°ƒç”¨ exit,åœ¨è¿™é‡Œè°ƒç”¨ exit.
}


&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;å›¾ 4.13&lt;/strong&gt;åˆ›å»ºçº¿ç¨‹çš„ä¼ªä»£ç ã€‚å¯¹æ ˆçš„åˆå§‹åŒ–å’Œä¼ å‚ç»™åˆå§‹å‡½æ•°æ˜¯å’Œæœºå™¨ç›¸å…³çš„ã€‚åœ¨ intel x86 æ¶æ„ä¸­ï¼Œæ ˆä»æåœ°å€å¼€å§‹ç„¶åå‘ä¸‹å¢é•¿ï¼Œè€Œå‚æ•°è¢«ä¼ é€’åˆ°æ ˆä¸Šã€‚åœ¨å…¶ä»–ç³»ç»Ÿï¼Œæ ˆèƒ½å¤Ÿå‘ä¸Šå¢é•¿ï¼Œå‚æ•°æ˜¯é€šè¿‡å¯„å­˜å™¨ä¼ é€’ã€‚å›¾ 4.14 æä¾›äº†thread_dummySwitchFrame çš„ä¼ªä»£ç &lt;br&gt;
å›¾ 4.13 å±•ç¤ºäº†åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹çš„ä¼ªä»£ç ã€‚thread_create çš„ç›®æ ‡æ˜¯æ‰§è¡Œä¸€ä¸ªå¼‚æ­¥çš„è¿‡ç¨‹è°ƒç”¨ç»™ funcï¼Œå…¶å‚æ•°ä¸º argã€‚å½“çº¿ç¨‹è¿è¡Œæ—¶ï¼Œå®ƒæ‰§è¡Œ func(arg)ã€ä¸çˆ¶è¿›ç¨‹å¹¶å‘æ‰§è¡Œã€‘&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æœ‰ 3 ä¸ªæ­¥éª¤&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åˆ†é…æ¯ä¸ªçº¿ç¨‹çš„çŠ¶æ€&lt;/strong&gt;. ç¬¬ä¸€æ­¥æ˜¯ä¸ºçº¿ç¨‹çš„æ¯ä¸ªçº¿ç¨‹çš„çŠ¶æ€åˆ†é…ç©ºé—´ï¼šTCB å’Œæ ˆã€‚æ­£å¦‚æˆ‘ä»¬æ‰€æåˆ°çš„ï¼ŒTCB æ˜¯æ“ä½œç³»ç»Ÿç”¨äºç®¡ç†çº¿ç¨‹çš„æ•°æ®ç»“æ„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆå§‹åŒ–æ¯ä¸ªçº¿ç¨‹çš„çŠ¶æ€&lt;/strong&gt;. ä¸ºäº†åˆå§‹åŒ–TCBï¼Œéœ€è¦åˆå§‹åŒ–å„ä¸ªå¯„å­˜å™¨çš„å€¼ã€‚å½“è¯¥çº¿ç¨‹è¢«è°ƒåº¦æ—¶ï¼Œæˆ‘ä»¬æƒ³è¦æˆ‘ä»¬æƒ³è¦å®ƒè¿è¡Œ func(arg)ã€‚ç„¶è€Œï¼Œæ˜¯å…ˆä»ä¸€ä¸ª dummy å‡½æ•°, stub, è¿è¡Œï¼Œstub æ¥ç€è°ƒç”¨funcã€‚æˆ‘ä»¬éœ€è¦è¿™ä¸ªæ­¥éª¤æ˜¯å› ä¸º func æ˜¯è¿”å›è€Œä¸æ˜¯è°ƒç”¨ thread_exitã€‚æ²¡æœ‰è¿™ä¸ª stub çš„è¯ï¼Œfunc ä¼šè¿”å›æ ˆé¡¶çš„ä¸€ä¸ªéšæœºçš„ä½ç½®ã€‚ï¼Œæœ‰äº† stubï¼Œå‡½æ•° func è¿”å›åˆ°stubï¼Œç„¶åå†ç”± stub è°ƒç”¨ thread_exit æ¥å®Œæˆçº¿ç¨‹ã€‚åœ¨ä¼ªä»£ç ä¸­ï¼Œæˆ‘ä»¬ç»™ stub å‹å…¥ä¸¤ä¸ªå‚æ•°è¿›æ ˆï¼šfunc å’Œ argã€‚å½“çº¿ç¨‹å¼€å§‹è¿è¡Œï¼Œstub çš„ä»£ç å°±ä¼šè®¿é—®å®ƒçš„ä»£ç å°±è¡Œä¸€ä¸ªæ™®é€šçš„procedureã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å°†TCB æ”¾åˆ°å°±ç»ªé˜Ÿåˆ—&lt;/strong&gt;. åˆ›å»ºä¸€ä¸ªçº¿ç¨‹çš„æœ€åä¸€æ­¥å°±æ˜¯å°†å®ƒçš„çŠ¶æ€è®¾ç½®ä¸ºå°±ç»ªæ€ï¼Œç„¶åæŠŠæ–°çš„ TCB æ”¾åˆ°å°±ç»ªé˜Ÿåˆ—ï¼Œ ä½¿å¾—è¯¥çº¿ç¨‹èƒ½å¤Ÿè¢«è°ƒåº¦ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;p-stylecolorred-b-ä¸€ä¸ªè‡ªæ„¿çš„å†…æ ¸çº¿ç¨‹åˆ‡æ¢ä»£ç ä¸è¦æ±‚ä½†çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„åŸºæœ¬æ­¥éª¤éœ€è¦æŒæ¡å³ä¿å­˜æ—§çº¿ç¨‹çš„å¯„å­˜å™¨çš„å€¼åˆ°tcb-ä¸­æŠŠæ–°çº¿ç¨‹çš„tcb-ä¸­å¯„å­˜å™¨çš„å€¼åŠ è½½åˆ°cpu-çš„å¯„å­˜å™¨ä¸­p&#34;&gt;&lt;p style=&#34;color:red&#34;&gt; b. ä¸€ä¸ªè‡ªæ„¿çš„å†…æ ¸çº¿ç¨‹åˆ‡æ¢ï¼ˆä»£ç ä¸è¦æ±‚ï¼Œä½†çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„åŸºæœ¬æ­¥éª¤éœ€è¦æŒæ¡ï¼Œå³ï¼šä¿å­˜æ—§çº¿ç¨‹çš„å¯„å­˜å™¨çš„å€¼åˆ°TCB ä¸­ï¼ŒæŠŠæ–°çº¿ç¨‹çš„TCB ä¸­å¯„å­˜å™¨çš„å€¼åŠ è½½åˆ°CPU çš„å¯„å­˜å™¨ä¸­&lt;/p&gt;&lt;/h2&gt;
&lt;p&gt;å›¾ 4.14 å±•ç¤ºäº†åœ¨Intel x86 ç¡¬ä»¶æ¶æ„ä¸‹ï¼Œthread_yiled çš„ç®€å•å®ç°çš„ä¼ªä»£ç .ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ thread_yield è‡ªæ„¿åœ°æ”¾å¼ƒå¤„ç†æœºç»™å¦ä¸€ä¸ªçº¿ç¨‹ç”¨. è°ƒç”¨çš„çº¿ç¨‹çš„å¯„å­˜å™¨è¢«æ‹·è´åˆ°å®ƒçš„ TCB å’Œæ ˆä¸­ï¼Œä¾¿äºå½“è°ƒåº¦å™¨å†æ¬¡é€‰æ‹©å®ƒçš„æ—¶å€™ï¼Œå¯ä»¥ç»§ç»­è¿è¡Œ.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;//æˆ‘ä»¬ä»¥ä¸€ä¸ªæ—§çº¿ç¨‹è¿›å…¥ï¼Œè€Œä»¥æ–°çº¿ç¨‹è¿”å›.
//ä»¥æ–°çº¿ç¨‹çš„å¯„å­˜å™¨å’Œæ ˆè¿”å›.
void thread_switch(oldThreadTCB, newThread TCB) { 
    pushad; //æŠŠé€šç”¨å¯„å­˜å™¨çš„å€¼å‹å…¥æ—§çš„æ ˆä¸­. 
    oldThreadTCB-&amp;gt;sp = esp; //ä¿å­˜æ—§çº¿ç¨‹çš„æ ˆæŒ‡é’ˆ. 
    esp = newThreadTCB-&amp;gt;sp; // åˆ‡ æ¢ åˆ° æ–° çš„ æ ˆ . 
    popad; // ä»æ–°çš„æ ˆå¼¹å‡ºå¯„å­˜å™¨çš„å€¼.
    return;
}
void thread_yield() {
  TCB *chosenTCB, *finishedTCB;
  // åœ¨åˆ‡æ¢çš„ä¸­é—´è¿‡ç¨‹ä¸­é˜»æ­¢æœ‰ä¸­æ–­æš‚åœ. disableInterrupts();
  // ä» å°± ç»ª é˜Ÿ åˆ— ä¸­ é€‰ æ‹© å¦ ä¸€ ä¸ª TCB. chosenTCB = readyList.getNext çº¿ç¨‹(); 
  if (chosenTCB == NULL) {
    // æ²¡æœ‰ä»€ä¹ˆå¯ä»¥è¿è¡Œçš„ï¼Œå›å»è¿è¡ŒåŸå§‹çš„çº¿ç¨‹.
  } else {
    // å°†è¿è¡Œçš„çº¿ç¨‹ç§»åŠ¨åˆ°å°±ç»ªé˜Ÿåˆ—. runningThread-&amp;gt;state = ready; readyList.add(runningThread);
    thread_switch(runningThread, chosenTCB); // åˆ‡æ¢åˆ°æ–°çš„çº¿ç¨‹. runningThread -&amp;gt;state = running;
  }
  //åˆ é™¤å®Œæˆé˜Ÿåˆ—ä¸Šçš„ä»»æ„çº¿ç¨‹.
  while ((finishedTCB = finishedList-&amp;gt;getNextThread()) != NULL) {
    delete finishedTCB-&amp;gt;stack;
    delete finishedTCB;
  }
  enableInterrupts();
}
//thread_create å¿…é¡»åœ¨å®ƒçš„æ ˆé¡¶æ”¾ä¸€ä¸ª dummy frame:
// è¿”å›çš„ PC å’Œç»™ pushad çš„ç©ºé—´æ¥å­˜å‚¨å¯„å­˜å™¨çš„å¤‡ä»½.
// è¿™æ ·çš„è¯ï¼Œå½“æŸäººåˆ‡æ¢åˆ°ä¸€ä¸ªæ–°åˆ›å»ºçš„çº¿ç¨‹, thread_switch çš„æœ€åä¸¤è¡Œèƒ½æ­£ç¡®å·¥ä½œ.
void thread_dummySwitchFrame(new çº¿ç¨‹) {
  *(tcb-&amp;gt;sp) = stub; //è¿”å›åˆ° stub çš„å¼€å¤´. tcb-&amp;gt;sp--;
  tcb-&amp;gt;sp -= SizeOfPopad;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;å›¾ 4.14&lt;/strong&gt;: åœ¨ Intel x86 æ¶æ„ä¸Š thread_switch å’Œ thread_yield çš„ä¼ªä»£ç ã€‚æ³¨æ„ï¼Œ thread_yield æ˜¯ä¸€ä¸ªç©ºæ“ä½œå¦‚æœæ²¡æœ‰å…¶ä»–çº¿ç¨‹å¯ä»¥è¿è¡Œã€‚å¦åˆ™ï¼Œå®ƒä¿å­˜æ—§çº¿ç¨‹çš„çŠ¶æ€å¹¶æ¢å¤æ–°çº¿ç¨‹çš„çŠ¶æ€ã€‚å½“æ—§çº¿ç¨‹è¢«é‡æ–°è°ƒåº¦ï¼Œå®ƒä»thread_switch è¿”å›åˆ°æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;thread_yield çš„ä¼ªä»£ç é¦–å…ˆå…³é—­ä¸­æ–­æ¥é˜»æ­¢çº¿ç¨‹ç³»ç»Ÿè¯•å›¾åœ¨åŒä¸€æ—¶é—´åšä¸¤ä¸ªä¸Šä¸‹æ–‡åˆ‡æ¢. ä¼ªä»£ç æ¥ç€æŠŠä¸‹ä¸€ä¸ªçº¿ç¨‹æ‹‰å‡ºå°±ç»ªé˜Ÿåˆ—(å¦‚æœæœ‰çš„è¯)ï¼Œç„¶ååˆ‡æ¢åˆ°å®ƒ. thread_switch ä»£ç ä¹Ÿè®¸çœ‹ä¸Šå»æœ‰ç‚¹ä¸æ˜“ç†è§£, ç”±äºå®ƒæ˜¯åœ¨æ—§çº¿ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­è¢«è°ƒç”¨ï¼Œè€Œå®Œæˆçš„æ—¶å€™æ˜¯åœ¨æ–°çº¿ç¨‹çš„ä¸Šä¸‹æ–‡. ä¸ºäº†å®Œæˆåˆ‡æ¢ï¼Œthread_switch æŠŠå¯„å­˜å™¨çš„çŠ¶æ€ä¿å­˜åˆ°æ ˆä¸Šï¼Œç„¶åæŠŠæ ˆæŒ‡é’ˆä¿å­˜åˆ° TCB ä¸­ã€‚æ¥ç€å®ƒåˆ‡æ¢åˆ°æ–°çš„çº¿ç¨‹çš„æ ˆï¼Œä»æ–°çº¿ç¨‹çš„æ ˆæ¥æ¢å¤æ–°çº¿ç¨‹çš„çŠ¶æ€ï¼Œç„¶åè¿”å›åˆ°å­˜å‚¨åœ¨æ–°æ ˆä¸­çš„ç¨‹åºè®¡æ•°å™¨çš„ä½ç½®. ä¸€ä¸ªæ¯”è¾ƒæ‰­æ›²çš„åœ°æ–¹æ˜¯è¿”å›çš„ä½ç½®å¯èƒ½ä¸æ˜¯ thread_yield!  è¿”å›åˆ°äº†æ–°çº¿ç¨‹ä¹‹å‰è¢«æš‚åœçš„åœ°æ–¹.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;ä¸€ä¸ª 0-çº¿ç¨‹çš„å†…æ ¸&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä¸ä»…å¯ä»¥æœ‰ä¸€ä¸ªå•çº¿ç¨‹çš„å†…æ ¸æˆ–è€…ä¸€ä¸ªå¤šçº¿ç¨‹çš„å†…æ ¸ï¼Œè¿˜æœ‰å¯èƒ½æœ‰ä¸€ä¸ªæ²¡æœ‰çº¿ç¨‹çš„å†…æ ¸â€”â€”0 çº¿ç¨‹çš„å†…æ ¸ã€‚å®é™…ä¸Šï¼Œè¿™ä¹Ÿæ˜¯å¸¸è§çš„ã€‚å› ä¸ºå‡ ä¹å†…æ ¸ä¸­æ‰€æœ‰äº‹æƒ…éƒ½æ˜¯äº‹ä»¶é©±åŠ¨çš„ï¼Œä¾‹å¦‚å“åº”ä¸€ä¸ªä¸­æ–­ï¼Œå¤„ç†æœºå¼‚å¸¸æˆ–è€…ç³»ç»Ÿè°ƒç”¨ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ä¸€ä¸ªç®€å•çš„æ“ä½œç³»ç»Ÿä¸­ï¼Œå°±æ²¡æœ‰å¿…è¦åˆ›å»ºå†…æ ¸çº¿ç¨‹æˆ–è€…å†…æ ¸çº¿ç¨‹æ§åˆ¶å—æ¥è¿½è¸ªæ­£åœ¨è¿›è¡Œçš„è®¡ç®—ã€‚è€Œæ˜¯ï¼Œå½“å‘ç”Ÿä¸€ä¸ªä¸­æ–­ï¼Œé™·é˜±æˆ–è€…å¼‚å¸¸ï¼Œæ ˆæŒ‡é’ˆå°±è®¾ç½®ä¸ºæŒ‡å‘ä¸­æ–­æ ˆçš„æ ˆåº•ï¼ŒæŒ‡ä»¤æŒ‡é’ˆè®¾ç½®ä¸ºå¤„ç†ç¨‹åºçš„åœ°å€ã€‚æ¥ç€ï¼Œå¤„ç†ç¨‹åºå¼€å§‹æ‰§è¡Œï¼Œè¦ä¸å°±ç«‹å³è¿”å›åˆ°ç”¨æˆ·çº§çš„è¿›ç¨‹è¦ä¸å°±æš‚åœç”¨æˆ·çº§çš„è¿›ç¨‹ï¼Œç„¶åè¿”å›åˆ°å…¶ä»–ç”¨æˆ·çº§è¿›ç¨‹ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id=&#34;p-stylecolorred6-å®ç°å¤šçº¿ç¨‹çš„è¿›ç¨‹p&#34;&gt;&lt;p style=&#34;color:red&#34;&gt;6. å®ç°å¤šçº¿ç¨‹çš„è¿›ç¨‹&lt;/p&gt;&lt;/h1&gt;
&lt;p&gt;æ‰€æœ‰å¹¿æ³›è¢«åº”ç”¨çš„æ“ä½œç³»ç»Ÿæ—¢æ”¯æŒå†…æ ¸çº¿ç¨‹ä¹Ÿæ”¯æŒå¤šçº¿ç¨‹è¿›ç¨‹ã€‚ç¼–ç¨‹è¯­è¨€ï¼Œä¾‹å¦‚ Javaï¼Œå’Œæ ‡å‡†åº“æ¥å£ä¾‹å¦‚ POSIX ç”¨æ“ä½œç³»ç»Ÿçš„è¿™ç§æ”¯æŒæ¥ä¸ºç¼–ç¨‹è€…æä¾›çº¿ç¨‹çš„æŠ½è±¡ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç”¨å†…æ ¸çº¿ç¨‹å®ç°å¤šçº¿ç¨‹çš„è¿›ç¨‹&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ”¯æŒå¤šçº¿ç¨‹è¿›ç¨‹çš„æœ€ç®€å•çš„æ–¹å¼æ˜¯ä½¿ç”¨å†…æ ¸çº¿ç¨‹çš„å®ç°ã€‚å½“ä¸€ä¸ªç”¨æˆ·çº§çº¿ç¨‹è®¿é—®çº¿ç¨‹åº“è¦åšåŒæ ·çš„äº‹æƒ…ï¼Œå®ƒç”¨ç³»ç»Ÿè°ƒç”¨æ¥è¯·æ±‚å†…æ ¸åšåŒæ ·çš„æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;å¦‚å›¾ 4.12 æ‰€ç¤ºï¼Œä¸€ä¸ªè¿›ç¨‹çš„çº¿ç¨‹æœ‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€ä¸ªç”¨æˆ·çº§çš„æ ˆç”¨äºæ‰§è¡Œç”¨æˆ·ä»£ç &lt;/li&gt;
&lt;li&gt;ä¸€ä¸ªå†…æ ¸ä¸­æ–­æ ˆï¼šå½“è¯¥çº¿ç¨‹åšç³»ç»Ÿè°ƒç”¨æ—¶ï¼Œæˆ–è€…å¼•å‘äº†ä¸€æ¬¡å¤„ç†æœºå¼‚å¸¸ï¼Œæˆ–è€…è¢«ä¸­æ–­&lt;/li&gt;
&lt;li&gt;ä¸€ä¸ªå†…æ ¸TCBï¼šç”¨äºä¿å­˜å’Œæ¢å¤æ¯ä¸ªçº¿ç¨‹çš„çŠ¶æ€&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸ºäº†åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œ&lt;strong&gt;ç”¨æˆ·çº¿ç¨‹åº“&lt;/strong&gt;åˆ†é…ä¸€ä¸ªç”¨æˆ·çº§çš„æ ˆç»™æ–°çš„çº¿ç¨‹ï¼Œç„¶ååšä¸€ä¸ªç³»ç»Ÿè°ƒç”¨è¿›å…¥å†…æ ¸ã€‚å†…æ ¸åˆ†é…ä¸€ä¸ªTCB å’Œå†…æ ¸æ ˆï¼Œè®¾ç½®çº¿ç¨‹çš„çŠ¶æ€ä½¿å…¶ç”¨ç”¨æˆ·çº§æ ˆä»è¢«è¯·æ±‚çš„è¿‡ç¨‹çš„å¼€å§‹å¤„å¼€å§‹æ‰§è¡Œã€‚å†…æ ¸éœ€è¦åœ¨&lt;strong&gt;è¿›ç¨‹æ§åˆ¶å—&lt;/strong&gt;ï¼ˆ&lt;strong&gt;PCB&lt;/strong&gt;ï¼‰ ä¸­ä¿å­˜ä¸€ä¸ªæŒ‡å‘è¯¥TCB çš„æŒ‡é’ˆï¼›å¦‚æœè¿›ç¨‹é€€å‡ºï¼Œå†…æ ¸å¿…é¡»ç»ˆæ­¢åœ¨è¿™ä¸ªè¿›ç¨‹å†…çš„ä»»æ„çº¿ç¨‹ã€‚åœ¨åˆ›å»ºäº†çº¿ç¨‹åï¼Œå†…æ ¸æŠŠæ–°çš„çº¿ç¨‹æ”¾åˆ°å°±ç»ªé˜Ÿåˆ—ä¸Šï¼Œå°±åƒå…¶ä»–çº¿ç¨‹ä¸€æ ·å¯ä»¥è¢«è°ƒåº¦ï¼Œç„¶åè¿”å›ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ç»™ç”¨æˆ·ç¨‹åºï¼Œä»¥ä¾¿äºä»¥åæƒ³è¦æŒ‡å®šè¿™ä¸ªæ–°åˆ›å»ºçš„çº¿ç¨‹çš„æ—¶å€™ä½¿ç”¨ï¼ˆä¾‹å¦‚ï¼Œfor joinï¼‰ã€‚çº¿ç¨‹çš„ join, yield,å’Œ exit ç”¨åŒæ ·çš„æ–¹å¼å®ç°ï¼š&lt;strong&gt;é€šè¿‡ç³»ç»Ÿè°ƒç”¨è¿›å…¥å†…æ ¸æ¥æ‰§è¡Œæ‰€è¯·æ±‚çš„å‡½æ•°&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h1 id=&#34;p-stylecolorred7-å®ç°ç”¨æˆ·çº§çº¿ç¨‹æ²¡æœ‰å†…æ ¸æ”¯æŒp&#34;&gt;&lt;p style=&#34;color:red&#34;&gt;7. å®ç°ç”¨æˆ·çº§çº¿ç¨‹ï¼ˆæ²¡æœ‰å†…æ ¸æ”¯æŒï¼‰&lt;/p&gt;&lt;/h1&gt;
&lt;p&gt;ä¹Ÿå¯ä»¥å®ç°ä¸€ä¸ªå®Œå…¨åœ¨ç”¨æˆ·çº§çš„çº¿ç¨‹ï¼ˆä½œä¸ºåº“å‡½æ•°ï¼‰ï¼Œä¸éœ€è¦ä»»ä½•æ“ä½œç³»ç»Ÿçš„æ”¯æŒã€‚æ—©æœŸçº¿ç¨‹åº“å‡½æ•°é‡‡ç”¨è¿™ç§çº¯ç”¨æˆ·çº§æ–¹æ³•çš„åŸå› æ˜¯ï¼šå› ä¸ºæå°‘æœ‰æ“ä½œç³»ç»Ÿæ”¯æŒå¤šçº¿ç¨‹çš„è¿›ç¨‹ã€‚åœ¨ JAVA è™šæ‹Ÿæœºä¸­ï¼Œä¹Ÿè¢«ç§°ä¸ºç»¿çº¿ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;åŸºæœ¬æ€æƒ³æ¯”è¾ƒç®€å•ã€‚çº¿ç¨‹åº“å‡½æ•°åœ¨è¿›ç¨‹ä¸­åˆå§‹åŒ–çº¿ç¨‹çš„æ‰€æœ‰æ•°æ®ç»“æ„ï¼šTCBï¼Œå°±ç»ªé˜Ÿåˆ—ï¼Œå®Œæˆé˜Ÿåˆ—ï¼Œç­‰å¾…é˜Ÿåˆ—ï¼Œè¿™äº›å…¨éƒ¨åœ¨è¿›ç¨‹çš„ç”¨æˆ·åœ°å€ç©ºé—´ã€‚å¯¹çº¿ç¨‹åº“å‡½æ•°çš„è°ƒç”¨å°±æ˜¯æ™®é€šçš„è¿‡ç¨‹è°ƒç”¨ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ“ä½œç³»ç»Ÿå†…æ ¸çœ‹æ¥ï¼Œä¸€ä¸ªç”¨æˆ·çº§å¤šçº¿ç¨‹çš„åº”ç”¨ç¨‹åºå°±æ˜¯ä¸€ä¸ªæ™®é€šçš„å•çº¿ç¨‹è¿›ç¨‹ã€‚ç»¿çº¿ç¨‹çš„é™åˆ¶æ˜¯æ“ä½œç³»ç»Ÿ&lt;strong&gt;å†…æ ¸ä¸çŸ¥é“ç”¨æˆ·çº§å°±ç»ªé˜Ÿåˆ—&lt;/strong&gt;ã€‚å¦‚æœåº”ç”¨ç¨‹åºçš„æŸä¸ªçº¿ç¨‹æ‰§è¡Œä¸€ä¸ªç³»ç»Ÿè°ƒç”¨éœ€è¦ç­‰å¾… I/Oï¼Œå†…æ ¸ä¸çŸ¥é“è¿˜æœ‰åˆ«çš„ç”¨æˆ·çº§çº¿ç¨‹å¯ä»¥è¿è¡Œã€‚å°±ä¼š&lt;strong&gt;æŠŠæ•´ä¸ªè¿›ç¨‹éƒ½é˜»å¡&lt;/strong&gt;ã€‚ç±»ä¼¼çš„ï¼Œåœ¨ä¸€ä¸ªå¤šå¤„ç†æœºä¸Šï¼Œå†…æ ¸ä¹Ÿä¸èƒ½è®©ä¸€ä¸ªè¿›ç¨‹çš„å¤šä¸ªçº¿ç¨‹åœ¨ä¸åŒçš„å¤„ç†æœºä¸Šè¿è¡Œã€‚&lt;/p&gt;
">çº¿ç¨‹</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/jin-cheng/"" data-c="
          &lt;h1 id=&#34;p-stylecolorred1-ä¸ºä»€ä¹ˆå¼•å…¥è¿›ç¨‹p&#34;&gt;&lt;p style=&#34;color:red&#34;&gt;1. ä¸ºä»€ä¹ˆå¼•å…¥è¿›ç¨‹ï¼Ÿ&lt;/p&gt;&lt;/h1&gt;
&lt;p&gt;æ“ä½œç³»ç»Ÿéœ€è¦ä¸€ç§ç»Ÿä¸€çš„æ–¹æ³•ç›‘è§†ã€ç®¡ç†ã€æ§åˆ¶å¤„ç†å™¨ä¸­ä¸åŒç¨‹åºçš„åŠ¨æ€æ‰§è¡Œè¿‡ç¨‹ï¼Œâ€œè¿›ç¨‹â€çš„æ¦‚å¿µè¢«å¼•å…¥ï¼&lt;/p&gt;
&lt;h1 id=&#34;p-stylecolorred2-è¿›ç¨‹çš„å®šä¹‰p&#34;&gt;&lt;p style=&#34;color:red&#34;&gt;2. è¿›ç¨‹çš„å®šä¹‰&lt;/p&gt;&lt;/h1&gt;
&lt;p&gt;è¿›ç¨‹æ²¡æœ‰ä¸¥æ ¼çš„å®šä¹‰ï¼Œä½†å¯ä»¥é€šè¿‡ä¸åŒçš„è§’åº¦å»æè¿°ï¼šè®¡ç®—æœºä¸­æ­£åœ¨è¿è¡Œçš„ç¨‹åºçš„ä¸€ä¸ªå®ä¾‹ï¼ˆInstanceã€‚å®ƒåŒ…å«ï¼ˆå†…å­˜ä¸­çš„ï¼‰ä»£ç æ®µï¼Œæ•°æ®æ®µï¼Œå †ï¼Œæ ˆï¼ˆç”¨æˆ·æ ˆå’Œå†…æ ¸æ ˆï¼‰ï¼›å’Œå½“å‰çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼ˆPCï¼ŒSP å’Œå…¶ä»–å¯„å­˜å™¨ï¼‰ï¼Œæ“ä½œç³»ç»Ÿé€šè¿‡ç»´æŠ¤æ•°æ®ç»“æ„â€”â€”è¿›ç¨‹æ§åˆ¶å—ï¼ˆPCBï¼‰æ¥ç®¡ç†æ¯ä¸ªè¿›ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è¿›ç¨‹æ§åˆ¶å—ï¼ˆProcess Control Blockâ€”â€”PCB&lt;/strong&gt;ï¼šPCB æ˜¯æ˜¯æ“ä½œç³»ç»Ÿç”¨æ¥ç®¡ç†è¿›ç¨‹çš„æ•°æ®ç»“æ„ï¼Œæ˜¯è¿›ç¨‹å­˜åœ¨çš„å”¯ä¸€æ ‡è¯†ã€‚æ¯å½“æ“ä½œç³»ç»Ÿåˆ›å»ºä¸€ä¸ªè¿›ç¨‹ï¼Œå°±æ˜¯ç”±æ“ä½œç³»ç»Ÿä¸ºè¯¥è¿›ç¨‹è®¾ç½®ä¸€ä¸ª PCBï¼›è¿›ç¨‹æ‰§è¡Œå®Œæˆæ—¶ï¼Œç”±ç³»ç»Ÿæ”¶å›å…¶ PCBï¼Œ è¯¥è¿›ç¨‹ä¾¿æ¶ˆäº¡äº†ã€‚PCB çš„å†…å®¹åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¿›ç¨‹çš„çŠ¶æ€ï¼ˆå°±ç»ªï¼Œæ‰§è¡Œï¼Œç­‰å¾…ï¼Œå®Œæˆï¼‰&lt;/li&gt;
&lt;li&gt;è¿›ç¨‹çš„ ID&lt;/li&gt;
&lt;li&gt;è¿›ç¨‹çš„åå­—&lt;/li&gt;
&lt;li&gt;è¿›ç¨‹çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼ˆPCï¼ŒSPï¼ŒELFAGSï¼Œå…¶ä»–å¯„å­˜å™¨ï¼‰&lt;/li&gt;
&lt;li&gt;è°ƒåº¦éœ€è¦çš„ä¿¡æ¯ï¼ˆä¼˜å…ˆçº§ï¼Œè°ƒåº¦å‚æ•°ï¼Œä½¿ç”¨çš„ CPU æ—¶é—´ï¼Œè¿›ç¨‹å¼€å§‹çš„æ—¶é—´â€¦ï¼‰&lt;/li&gt;
&lt;li&gt;å†…å­˜ç®¡ç†çš„ä¿¡æ¯ï¼ˆåŸºå€å’Œç•Œé™â€¦ï¼‰&lt;/li&gt;
&lt;li&gt;I/O çŠ¶æ€ä¿¡æ¯ï¼ˆæ‰“å¼€çš„æ–‡ä»¶ï¼Œå ç”¨çš„ I/O è®¾å¤‡â€¦ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;p-stylecolorred3-å†…æ ¸çº¿ç¨‹å’Œç”¨æˆ·è¿›ç¨‹æ”¾åˆ°ä¸€èµ·p&#34;&gt;&lt;p style=&#34;color:red&#34;&gt;3. å†…æ ¸çº¿ç¨‹å’Œç”¨æˆ·è¿›ç¨‹æ”¾åˆ°ä¸€èµ·&lt;/p&gt;&lt;/h1&gt;
&lt;p&gt;ä¸‹é¢ä¸¤ä¸ªå›¾å±•ç¤ºäº†åŒ…å«ç”¨æˆ·è¿›ç¨‹ï¼ˆä¸Šå›¾æ˜¯å•çº¿ç¨‹è¿›ç¨‹ï¼Œä¸‹å›¾æ˜¯å¤šçº¿ç¨‹è¿›ç¨‹ï¼‰å’Œå†…æ ¸çº¿ç¨‹çš„å†…å­˜ç©ºé—´ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ‰€æœ‰&lt;strong&gt;å†…æ ¸çº¿ç¨‹&lt;/strong&gt;éƒ½&lt;strong&gt;å…±äº«&lt;/strong&gt;å†…æ ¸çš„ä»£ç æ®µï¼ˆCodeï¼‰ï¼Œå…¨å±€å˜é‡(Globals)ï¼Œå †(Heap)ï¼Œå’Œè‡ªå·±&lt;strong&gt;ä¸“é—¨&lt;/strong&gt;çš„ TCB å’Œå†…æ ¸æ ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å•çº¿ç¨‹çš„ç”¨æˆ·è¿›ç¨‹&lt;/strong&gt;åœ¨ç”¨æˆ·ç©ºé—´æœ‰è‡ªå·±çš„ä»£ç æ®µï¼Œæ•°æ®æ®µï¼Œå †ï¼Œæ ˆï¼Œåœ¨å†…æ ¸ç©ºé—´æœ‰å†…æ ¸ç”¨äºç®¡ç†è¯¥è¿›ç¨‹ä½¿ç”¨çš„ PCBå’Œå†…æ ¸æ ˆã€‚&lt;/li&gt;
&lt;li&gt;å¤šçº¿ç¨‹çš„ç”¨æˆ·è¿›ç¨‹åœ¨ç”¨æˆ·ç©ºé—´æœ‰è‡ªå·±çš„ä»£ç æ®µï¼Œæ•°æ®æ®µï¼Œå †å’Œå¤šä¸ªçº¿ç¨‹ã€‚æ¯ä¸ªçº¿ç¨‹æœ‰è‡ªå·±çš„ç”¨æˆ·æ ˆï¼Œå’Œå†…æ ¸ç©ºé—´çš„å†…æ ¸æ ˆä»¥åŠå†…æ ¸ç”¨äºç®¡ç†è¯¥çº¿ç¨‹çš„TCBã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%86%85%E6%A0%B8%E7%BA%BF%E7%A8%8B-%E7%94%A8%E6%88%B7%E7%BA%BF%E7%A8%8B.jpg&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;å›¾ 4.11&lt;/strong&gt;:ä¸€ä¸ªå¤šçº¿ç¨‹çš„å†…æ ¸ï¼šæœ‰ 3 ä¸ªå†…æ ¸çº¿ç¨‹å’Œä¸¤ä¸ªå•çº¿ç¨‹çš„ç”¨æˆ·çº§è¿›ç¨‹. æ¯ä¸ªå†…æ ¸çº¿ç¨‹ æœ‰å®ƒè‡ªå·±çš„ TCB å’Œå®ƒè‡ªå·±çš„æ ˆ. æ¯ä¸ªç”¨æˆ·è¿›ç¨‹æœ‰ä¸€ä¸ªç”¨æˆ·çº§çš„æ ˆç”¨äºæ‰§è¡Œç”¨æˆ·çš„ä»£ç å’Œä¸€ä¸ªå†…æ ¸ä¸­æ–­æ ˆç”¨äºæ‰§è¡Œç³»ç»Ÿè°ƒç”¨å’Œä¸­æ–­.&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%86%85%E6%A0%B8.jpg&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;å›¾ 4.12&lt;/strong&gt;: ä¸€ä¸ªå¤šçº¿ç¨‹çš„å†…æ ¸ï¼šæœ‰ 3 ä¸ªå†…æ ¸çº¿ç¨‹å’Œä¸¤ä¸ªç”¨æˆ·çº§çš„è¿›ç¨‹, æ¯ä¸ªè¿›ç¨‹æœ‰ 2 ä¸ªçº¿ç¨‹. æ¯ä¸ªç”¨æˆ·çº§çº¿ç¨‹æœ‰ä¸€ä¸ªç”¨æˆ·çº§æ ˆå’Œä¸€ä¸ªå†…æ ¸ä¸­çš„ä¸­æ–­æ ˆç”¨äºæ‰§è¡Œç³»ç»Ÿè°ƒç”¨å’Œä¸­æ–­.&lt;/p&gt;
&lt;h1 id=&#34;p-stylecolorred4-è¿›ç¨‹çš„çŠ¶æ€åŠå…¶å˜è¿p&#34;&gt;&lt;p style=&#34;color:red&#34;&gt;4. è¿›ç¨‹çš„çŠ¶æ€åŠå…¶å˜è¿&lt;/p&gt;&lt;/h1&gt;
&lt;h2 id=&#34;a-ä¸‰çŠ¶æ€å˜è¿å›¾&#34;&gt;a)  ä¸‰çŠ¶æ€å˜è¿å›¾&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;è¿è¡Œä¸­çš„&lt;/strong&gt;è¿›ç¨‹è‡³å°‘å…·æœ‰ä»¥ä¸‹ä¸‰ç§åŸºæœ¬çŠ¶æ€ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å°±ç»ªçŠ¶æ€&lt;/strong&gt;â€“ åœ¨æŸæ—¶åˆ»ï¼Œè¿›ç¨‹å·²è·å¾—é™¤å¤„ç†æœºä»¥å¤–çš„æ‰€æœ‰èµ„æºï¼Œä¸€æ—¦åˆ†åˆ°äº†å¤„ç†æœºå°±å¯ä»¥ç«‹å³æ‰§è¡Œ&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿è¡ŒçŠ¶æ€&lt;/strong&gt;â€“ è¿›ç¨‹å·²ç»è·å¾—å¿…è¦èµ„æºï¼Œå¹¶å æœ‰å¤„ç†æœºè¿è¡Œ&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç­‰å¾…çŠ¶æ€&lt;/strong&gt;ï¼ˆä¹Ÿå«&lt;strong&gt;é˜»å¡çŠ¶æ€&lt;/strong&gt;ï¼‰ â€“ æ­£åœ¨æ‰§è¡Œçš„è¿›ç¨‹ï¼Œç”±äºå‘ç”ŸæŸäº‹ä»¶è€Œæš‚æ—¶æ— æ³•æ‰§è¡Œä¸‹å»&lt;/li&gt;
&lt;/ol&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%BF%9B%E7%A8%8B%E7%8A%B6%E6%80%81%E5%8F%98%E5%8C%96%E5%9B%BE-%E4%B8%89%E7%8A%B6%E6%80%81.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œä¸‹å›¾å±•ç¤ºäº† 3 ä¸ªè¿›ç¨‹çš„çŠ¶æ€çš„å˜è¿ã€‚å…¶ä¸­è°ƒåº¦ç¨‹åºæ˜¯æ“ä½œç³»ç»Ÿå†…æ ¸ä¸­ç”¨äºä»å°±ç»ªé˜Ÿåˆ—ä¸­é€‰æ‹©ä¸‹ä¸€ä¸ªå ç”¨CPU æ‰§è¡Œçš„è¿›ç¨‹çš„è°ƒåº¦ç¨‹åºã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%BF%9B%E7%A8%8B%E7%8A%B6%E6%80%81%E5%8F%98%E5%8C%96%E5%BA%8F%E5%88%97%E5%9B%BE%E4%B8%BE%E4%BE%8B-%E4%B8%89%E7%8A%B6%E6%80%81.jpg&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;b-äº”çŠ¶æ€å˜è¿å›¾&#34;&gt;b)  äº”çŠ¶æ€å˜è¿å›¾&lt;/h2&gt;
&lt;p&gt;å…¶çŠ¶æ€å˜è¿å›¾å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ¯” 3 çŠ¶æ€å›¾å¤šäº†ä¸¤ä¸ªçŠ¶æ€ï¼šæ–°å»ºå’Œé€€å‡ºã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ–°å»ºçŠ¶æ€&lt;/strong&gt;â€“ è‡³å°‘å»ºç«‹PCBï¼Œä½†è¿›ç¨‹ç›¸å…³çš„å…¶ä»–å†…å®¹å¯èƒ½æœªè°ƒå…¥ä¸»å­˜&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€€å‡ºçŠ¶æ€&lt;/strong&gt;â€“ è¿›ç¨‹å·²ç»ç»ˆæ­¢ï¼Œä½†èµ„æºç­‰å¾…çˆ¶è¿›ç¨‹æˆ–ç³»ç»Ÿå›æ”¶&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%BF%9B%E7%A8%8B%E7%8A%B6%E6%80%81%E5%8F%98%E5%8C%96%E5%9B%BE-%E4%BA%94%E7%8A%B6%E6%80%81.jpg&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;è§¦å‘è¿›ç¨‹çŠ¶æ€å˜è¿çš„äº‹ä»¶&lt;/strong&gt;æè¿°å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆ›å»º&lt;/strong&gt;â†’&lt;strong&gt;å°±ç»ª&lt;/strong&gt;ï¼š(1)ç³»ç»Ÿåˆå§‹åŒ–ï¼Œ(2)ç”¨æˆ·è¯·æ±‚åˆ›å»ºä¸€ä¸ªæ–°è¿›ç¨‹ï¼Œ(3)è¿›ç¨‹æ‰§è¡Œäº†åˆ›å»ºè¿›ç¨‹çš„ç³»ç»Ÿè°ƒç”¨&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å°±ç»ª&lt;/strong&gt;â†’&lt;strong&gt;æ‰§è¡Œ&lt;/strong&gt;ï¼šå†…æ ¸çš„è°ƒåº¦ç¨‹åº(scheduler)é€‰æ‹©äº†ä¸€ä¸ªå°±ç»ªçš„è¿›ç¨‹ï¼Œè®©å®ƒå ç”¨å¤„ç†æœºæ‰§è¡Œ&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿è¡Œ&lt;/strong&gt;â†’&lt;strong&gt;ç­‰å¾…&lt;/strong&gt;: éœ€è¦ç­‰å¾…æŸä¸ªäº‹ä»¶å‘ç”Ÿæ‰å¯ä»¥ç»§ç»­æ‰§è¡Œï¼Œä¾‹å¦‚ I/O è¯·æ±‚æˆ–è€…æŸä¸ªå…±äº«æ•°æ®è¢«é”ä½ä¸èƒ½è®¿é—®&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿è¡Œ&lt;/strong&gt;â†’&lt;strong&gt;å°±ç»ª&lt;/strong&gt;ï¼ˆè¢«&lt;strong&gt;æŠ¢å &lt;/strong&gt;ï¼‰ï¼šé«˜ä¼˜å…ˆçº§çš„è¿›ç¨‹è¿›å…¥å°±ç»ªæ€ï¼Œè¿›ç¨‹çš„æ—¶é—´ç‰‡ç”¨å®Œ&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç­‰å¾…&lt;/strong&gt;â†’&lt;strong&gt;å°±ç»ª&lt;/strong&gt;(è¢«&lt;strong&gt;å”¤é†’&lt;/strong&gt;)ï¼šç­‰å¾…çš„äº‹ä»¶å‘ç”Ÿï¼Œä¾‹å¦‚ I/O è¯·æ±‚å®Œæˆï¼Œå…±äº«æ•°æ®å¯ä»¥è®¿é—®&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿è¡Œ&lt;/strong&gt;â†’&lt;strong&gt;ç»“æŸ&lt;/strong&gt;ï¼šå¯èƒ½æ˜¯æ­£å¸¸é€€å‡ºï¼ˆè°ƒç”¨ exit ç³»ç»Ÿè°ƒç”¨ï¼‰ï¼Œå¯èƒ½æ˜¯å‡ºé”™ï¼ˆå¼‚å¸¸ï¼Œç”±æ“ä½œç³»ç»Ÿå¼ºåˆ¶ç»ˆæ­¢ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;c-ä¸ƒçŠ¶æ€å˜è¿å›¾&#34;&gt;c.) ä¸ƒçŠ¶æ€å˜è¿å›¾&lt;/h2&gt;
&lt;p&gt;å½“å†…å­˜ä¸å¤Ÿçš„æ—¶å€™ï¼Œæ‰§è¡ŒçŠ¶æ€çš„è¿›ç¨‹ï¼Œå°±ç»ªçŠ¶æ€çš„è¿›ç¨‹å’Œç­‰å¾…çŠ¶æ€çš„è¿›ç¨‹éƒ½æœ‰å¯èƒ½å› ä¸ºä¼˜å…ˆçº§è¾ƒä½è€Œè¢«ä»å†…å­˜ç§»å‡ºæ”¾åˆ°å¤–å­˜ï¼Œå¦‚æœæ˜¯æ‰§è¡Œæ€å’Œå°±ç»ªæ€çš„è¿›ç¨‹è¢«ç§»å‡ºåˆ°å¤–å­˜ï¼Œåˆ™è¢«ç§°ä¸º&lt;strong&gt;å°±ç»ªæŒ‚èµ·&lt;/strong&gt;ï¼›å¦‚æœæ˜¯ç­‰å¾…æ€çš„è¿›ç¨‹è¢«ç§»å‡ºåˆ°å¤–å­˜ï¼Œåˆ™è¢«ç§°ä¸º&lt;strong&gt;ç­‰å¾…æŒ‚èµ·&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç­‰å¾…æŒ‚èµ·&lt;/strong&gt;ï¼šè¿›ç¨‹åœ¨å¤–å­˜ç­‰å¾…æŸäº‹ä»¶çš„å‡ºç°&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å°±ç»ªæŒ‚èµ·&lt;/strong&gt;ï¼šè¿›ç¨‹åœ¨å¤–å­˜ï¼Œä½†åªè¦è¿›å…¥å†…å­˜å°±å¯ä»¥è¿è¡Œæ–°åŠ å…¥çš„&lt;strong&gt;çŠ¶æ€å˜è¿&lt;/strong&gt;æœ‰ä¸¤ç±»ï¼šæŒ‚èµ·å’Œæ¿€æ´»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŒ‚èµ·ï¼šæŠŠä¸€ä¸ªè¿›ç¨‹ä»å†…å­˜ç§»åˆ°å¤–å­˜&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç­‰å¾…&lt;/strong&gt;â†’&lt;strong&gt;ç­‰å¾…æŒ‚èµ·&lt;/strong&gt;ï¼šæ²¡æœ‰è¿›ç¨‹å¤„äºå°±ç»ªçŠ¶æ€æˆ–è€…å°±ç»ªè¿›ç¨‹è¦æ±‚æ›´å¤šçš„å†…å­˜&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å°±ç»ª&lt;/strong&gt;â†’&lt;strong&gt;å°±ç»ªæŒ‚èµ·&lt;/strong&gt;ï¼šå½“æœ‰é«˜ä¼˜å…ˆçº§ç­‰å¾…çš„è¿›ç¨‹å’Œä½ä¼˜å…ˆçº§çš„å°±ç»ªè¿›ç¨‹&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿è¡Œ&lt;/strong&gt;â†’&lt;strong&gt;å°±ç»ªæŒ‚èµ·&lt;/strong&gt;ï¼šå½“æœ‰é«˜ä¼˜å…ˆçº§ç­‰å¾…æŒ‚èµ·è¿›ç¨‹å› ä¸ºç­‰å¾…çš„äº‹ä»¶å‘ç”Ÿäº†è€Œè¿›å…¥å°±ç»ªæŒ‚èµ·&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç­‰å¾…æŒ‚èµ·&lt;/strong&gt;â†’&lt;strong&gt;å°±ç»ªæŒ‚èµ·&lt;/strong&gt;ï¼šå½“æœ‰ç­‰å¾…æŒ‚èµ·çš„è¿›ç¨‹æ‰€ç­‰å¾…çš„äº‹ä»¶å‘ç”Ÿäº†&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¿€æ´»ï¼šæŠŠä¸€ä¸ªè¿›ç¨‹ä»å¤–å­˜ç§»åˆ°å†…å­˜&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å°±ç»ªæŒ‚èµ·&lt;/strong&gt;â†’&lt;strong&gt;å°±ç»ª&lt;/strong&gt;ï¼šæ²¡æœ‰å°±ç»ªè¿›ç¨‹æˆ–æŒ‚èµ·å°±ç»ªè¿›ç¨‹ä¼˜å…ˆçº§é«˜äºå°±ç»ªè¿›ç¨‹&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç­‰å¾…æŒ‚èµ·&lt;/strong&gt;â†’&lt;strong&gt;ç­‰å¾…&lt;/strong&gt;ï¼šå½“ä¸€ä¸ªè¿›ç¨‹é‡Šæ”¾è¶³å¤Ÿå†…å­˜ï¼Œå¹¶æœ‰é«˜ä¼˜å…ˆçº§ç­‰å¾…æŒ‚èµ·è¿›ç¨‹&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%BF%9B%E7%A8%8B%E7%8A%B6%E6%80%81%E5%8F%98%E5%8C%96%E5%9B%BE-%E4%B8%83%E7%8A%B6%E6%80%81.jpg&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h1 id=&#34;p-stylecolorred5-è¿›ç¨‹çŠ¶æ€çš„é˜Ÿåˆ—p&#34;&gt;&lt;p style=&#34;color:red&#34;&gt;5. è¿›ç¨‹çŠ¶æ€çš„é˜Ÿåˆ—&lt;/p&gt;&lt;/h1&gt;
&lt;p&gt;è¿›ç¨‹æ§åˆ¶å—æ ¹æ®ä¸åŒçŠ¶æ€è¢«æ”¾åˆ°ä¸åŒçš„é˜Ÿåˆ—ä¸­ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å°±ç»ªé˜Ÿåˆ—ï¼šçŠ¶æ€ä¸ºå°±ç»ªçš„PCB é˜Ÿåˆ—ï¼Œè¯¥é˜Ÿåˆ—å¯ä»¥æ˜¯é“¾è¡¨ä¹Ÿå¯ä»¥æ˜¯ç´¢å¼•ï¼Œè¿˜å¯ä»¥å¤šä¸ªé˜Ÿåˆ—&lt;/li&gt;
&lt;li&gt;æ‰§è¡Œé˜Ÿåˆ—ï¼šçŠ¶æ€ä¸ºæ‰§è¡Œçš„PCB é˜Ÿåˆ—&lt;/li&gt;
&lt;li&gt;ç­‰å¾…é˜Ÿåˆ—ï¼šçŠ¶æ€ä¸ºç­‰å¾…çš„PCB é˜Ÿåˆ—ï¼Œä¸åŒçš„ç­‰å¾…äº‹ä»¶å¯¹åº”ä¸åŒçš„ç­‰å¾…é˜Ÿåˆ—&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%BF%9B%E7%A8%8B%E7%8A%B6%E6%80%81%E7%9A%84%E9%98%9F%E5%88%97.jpg&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h1 id=&#34;p-stylecolorred6-è¿›ç¨‹çŠ¶æ€åˆ‡æ¢çš„å®ç°p&#34;&gt;&lt;p style=&#34;color:red&#34;&gt;6. è¿›ç¨‹çŠ¶æ€åˆ‡æ¢çš„å®ç°&lt;/p&gt;&lt;/h1&gt;
&lt;p&gt;æˆ‘ä»¬ç”¨ä¸‹å›¾æ¥è¯´æ˜ä¸¤ä¸ªè¿›ç¨‹ä¹‹é—´çš„åˆ‡æ¢è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%BF%9B%E7%A8%8B%E7%8A%B6%E6%80%81%E7%9A%84%E5%88%87%E6%8D%A2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæœ‰ä¸¤ä¸ªå¹¶å‘æ‰§è¡Œçš„è¿›ç¨‹ï¼ŒP0 å’Œ P1.é¦–å…ˆæ˜¯ P0 æ‰§è¡Œï¼Œå½“å‡ºç°ä¸€ä¸ªä¸­æ–­æˆ–ç³»ç»Ÿè°ƒç”¨ï¼Œç¡¬ä»¶å¼€å§‹æ‰§è¡Œç›¸åº”çš„å¤„ç†ç¨‹åºï¼Œå‡è®¾è¯¥å¤„ç†ç¨‹åºè°ƒç”¨äº† schedulerï¼ˆè°ƒåº¦ç¨‹åºï¼‰ï¼Œè¯¥è°ƒåº¦ç¨‹åºå†³å®šè®©è¿›ç¨‹ P1 æ‰§è¡Œï¼Œäºæ˜¯éœ€è¦åˆ‡æ¢è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ã€‚å…·ä½“åœ°ï¼Œ(1)å…ˆå°†è¿›ç¨‹ P0 çš„è¿›ç¨‹ä¸Šä¸‹æ–‡ï¼ˆPCï¼ŒSP å’Œå…¶ä»–å¯„å­˜å™¨ä¿¡æ¯ï¼‰ä¿å­˜åˆ° PCB0ï¼Œ(2)å¦‚æœæ˜¯æ—¶é’Ÿä¸­æ–­ï¼Œå°†PCB0 åŠ å…¥å°±ç»ªé˜Ÿåˆ—ä¸­ç­‰å¾…ä¸‹ä¸€æ¬¡è¢« scheduler è°ƒåº¦ï¼›å¦‚æœæ˜¯ä¸€æ¬¡ I/O ç³»ç»Ÿè°ƒç”¨ï¼Œåˆ™å°† PCB0 æ”¾å…¥ç›¸åº”çš„ç­‰å¾…é˜Ÿåˆ—ä¸­ï¼Œ (3)æŠŠè¿›ç¨‹ P1 çš„ PCB1 ä»å°±ç»ªé˜Ÿåˆ—ä¸­ç§»é™¤ï¼Œæ”¾è¿›æ‰§è¡Œé˜Ÿåˆ—ä¸­ï¼Œ(4)å°†è¿›ç¨‹ä¸Šä¸‹æ–‡ä» PCB1 ä¸­æ¢å¤åˆ°å¯„å­˜å™¨ä¸­ï¼Œæ­¤æ—¶ PC æŒ‡å‘äº†è¿›ç¨‹ P1 è¦æ‰§è¡Œçš„æŒ‡ä»¤ï¼ŒSP æŒ‡å‘äº†è¿›ç¨‹ P1 çš„æ‰§è¡Œæ ˆï¼Œäºæ˜¯ P1 å¼€å§‹æ‰§è¡Œã€‚å½“å†æ¬¡å‡ºç°æ—¶é’Ÿä¸­æ–­æˆ–è€…ç³»ç»Ÿè°ƒç”¨ï¼Œå†ç”¨åŒæ ·çš„æ–¹å¼ä¿å­˜ P1 çš„çŠ¶æ€åˆ° PCB1 ä¸­ã€‚ä¸å†èµ˜è¿°ã€‚&lt;/p&gt;
&lt;h1 id=&#34;p-stylecolorred7-windows-çš„è¿›ç¨‹ç®¡ç†p&#34;&gt;&lt;p style=&#34;color:red&#34;&gt;7. Windows çš„è¿›ç¨‹ç®¡ç†&lt;/p&gt;&lt;/h1&gt;
&lt;p&gt;è¿›ç¨‹ç®¡ç†ä¹‹ä¸€å°±æ˜¯å¢åŠ ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨ï¼Œç”¨äºåˆ›å»ºä¸€ä¸ªè¿›ç¨‹ã€‚è¿™ä¸ªç†è®ºä¸Šå¾ˆç®€å•ä½†å®é™…å®ç°å´æ¯”è¾ƒå¤æ‚ã€‚åœ¨Windows ä¸­ï¼Œæœ‰ä¸€ä¸ªç¨‹åºï¼Œç§°ä¸ºCreateProcessï¼Œå®ƒçš„ç®€åŒ–å½¢å¼å¦‚ä¸‹&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Boolean CreateProcess(char *prog, char *args);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ‘ä»¬ç§°åˆ›å»ºè¿›ç¨‹çš„è¿›ç¨‹ä¸º&lt;strong&gt;çˆ¶äº²&lt;/strong&gt;ï¼Œè€Œè¢«åˆ›å»ºçš„è¿›ç¨‹è¢«ç§°ä¸º&lt;strong&gt;å­©å­&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;CreateProcess éœ€è¦æ‰§è¡Œå“ªäº›æ­¥éª¤å‘¢ï¼Ÿæˆ‘ä»¬ä¹‹å‰å·²æœ‰ä»‹ç»ï¼Œå†…æ ¸éœ€è¦&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åˆ›å»ºå¹¶åˆå§‹åŒ–å†…æ ¸ä¸­çš„ PCB&lt;/li&gt;
&lt;li&gt;åˆ›å»ºå’Œåˆå§‹åŒ–ä¸€ä¸ªæ–°çš„åœ°å€ç©ºé—´&lt;/li&gt;
&lt;li&gt;åŠ è½½ç¨‹åºprog è¿›å…¥åœ°å€ç©ºé—´&lt;/li&gt;
&lt;li&gt;å°†å‚æ•° args æ‹·è´åˆ°åœ°å€ç©ºé—´çš„å†…å­˜ä¸­&lt;/li&gt;
&lt;li&gt;åˆå§‹åŒ–ç¡¬ä»¶ä¸Šä¸‹æ–‡æ¥ä»ç¬¬ä¸€æ¡æŒ‡ä»¤å¼€å§‹æ‰§è¡Œ&lt;/li&gt;
&lt;li&gt;é€šçŸ¥è°ƒåº¦ç¨‹åºæœ‰æ–°çš„è¿›ç¨‹å‡†å¤‡è¿è¡Œäº†&lt;br&gt;
ä¸å¹¸çš„æ˜¯ï¼Œå®é™…çš„å®ç°è¦å¤æ‚çš„å¤šï¼ŒCreateProcess æœ‰åä¸ªå‚æ•°éœ€è¦è®¾ç½®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/CreateProcess.png&#34; alt=&#34;**Figure 3.3**: ä¸€ä¸ªå¦‚ä½•ç”¨ Windows çš„ç³»ç»Ÿè°ƒç”¨ CreateProcess çš„ä¾‹å­. å‰ä¸¤ä¸ªå‚æ•°æŒ‡å®šç¨‹åºå’Œå®ƒçš„å‚æ•°ï¼›å‰©ä¸‹çš„å…³å¿ƒè¿›ç¨‹çš„è¿è¡Œç¯å¢ƒ.&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Figure 3.3: ä¸€ä¸ªå¦‚ä½•ç”¨ Windows çš„ç³»ç»Ÿè°ƒç”¨ CreateProcess çš„ä¾‹å­. å‰ä¸¤ä¸ªå‚æ•°æŒ‡å®šç¨‹åºå’Œå®ƒçš„å‚æ•°ï¼›å‰©ä¸‹çš„å…³å¿ƒè¿›ç¨‹çš„è¿è¡Œç¯å¢ƒ.&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;p-stylecolorred-8-unix-çš„è¿›ç¨‹ç®¡ç†p&#34;&gt;&lt;p style=&#34;color:red&#34;&gt; 8. UNIX çš„è¿›ç¨‹ç®¡ç†&lt;/p&gt;&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;&lt;strong&gt;åˆ›å»ºå’Œç®¡ç†è¿›ç¨‹çš„ API&lt;/strong&gt;&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;fork()&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ä½œä¸ºå½“å‰è¿›ç¨‹çš„ä¸€ä¸ªå…‹éš†ã€‚fork è°ƒç”¨æœ‰ä¸¤ä¸ª  è¿”å›ï¼Œä¸€ä¸ªæ˜¯è¿”å›åˆ°çˆ¶è¿›ç¨‹ï¼Œå¦ä¸€ä¸ªè¿”å›åˆ°å­è¿›ç¨‹.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;exec(prog, args)&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;åœ¨å½“å‰è¿›ç¨‹ä¸­è¿è¡Œåº”ç”¨ç¨‹åº prog.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;exit()&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å‘Šè¯‰å†…æ ¸å½“å‰çš„è¿›ç¨‹å®Œæˆäº†ï¼Œå®ƒçš„æ•°æ®ç»“æ„éœ€è¦è¢«åƒåœ¾å›æ”¶.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;wait(processID)&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æš‚åœä¸€ç›´åˆ°è¯¥å­è¿›ç¨‹ç»“æŸ.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;signal(processID, type)&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å‘é€ä¸€ä¸ªç‰¹å®šç±»å‹çš„ä¸­æ–­ç»™å…¶ä»–ä¸€ä¸ªè¿›ç¨‹.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;Figure 3.7&lt;/strong&gt;: UNIX ä¸­ç®¡ç†å’Œåˆ›å»ºè¿›ç¨‹çš„ API.&lt;/p&gt;
&lt;p&gt;UNIX ç”¨ä¸€ç§ä¸åŒçš„æ–¹æ³•æ¥åˆ›å»ºè¿›ç¨‹ï¼Œè¿™ç§å®ç°æ˜¯åœ¨ç†è®ºä¸Šå¤æ‚ï¼Œä½†å®ç°ä¸Šå´æ¯”è¾ƒç®€å•ã€‚UNIX æŠŠ CreateProcess åˆ†å‰²æˆä¸¤ä¸ªé˜¶æ®µï¼Œåˆ†åˆ«ç§°ä¸º fork å’Œ execï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;9&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/fork-exec.jpg&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;Figure 3.4&lt;/strong&gt;: UNIX çš„ç³»ç»Ÿè°ƒç”¨ fork å’Œ exec çš„æ“ä½œ. UNIX çš„ fork å¯¹çˆ¶è¿›ç¨‹åšäº†ä¸€ä¸ªæ‹·è´; UNIX çš„ exec å°†å­è¿›ç¨‹æ”¹å˜æˆæ–°è¿è¡Œçš„ç¨‹åº.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;UNIX çš„ fork&lt;/strong&gt;åˆ›å»ºä¸€ä¸ªå’Œçˆ¶è¿›ç¨‹å®Œå…¨ä¸€è‡´çš„æ‹·è´ï¼Œåªæœ‰ä¸€é¡¹ä¾‹å¤–ï¼ˆæˆ‘ä»¬éœ€è¦æŸç§æ–¹æ³•æ¥åŒºåˆ†çˆ¶è¿›ç¨‹å’Œå­©å­ï¼‰ã€‚ä¸€æ—¦ä¸Šä¸‹æ–‡è®¾ç½®å¥½ï¼Œå­è¿›ç¨‹å°±è°ƒç”¨ UNIX çš„ exec ç¨‹åºã€‚exec åŠ è½½æ–°çš„å¯æ‰§è¡Œé•œåƒè¿›å…¥å†…å­˜å¹¶å¼€å§‹æ‰§è¡Œã€‚çœ‹ä¸Šå»å…ˆæ‹·è´çˆ¶è¿›ç¨‹ï¼Œç„¶ååˆç”¨ä¸€ä¸ªæ–°çš„å¯æ‰§è¡Œé•œåƒè¦†ç›–çœ‹ä¸Šå»æœ‰äº›æ²¡å¿…è¦ã€‚å®é™…ä¸Š fork å’Œ exec æ¥åˆ›å»ºæ–°è¿›ç¨‹çš„å®ç°ç¡®æ˜¯éå¸¸å¿«é€Ÿçš„ï¼Œå…¶ä¸­æ‰€ä½¿ç”¨çš„æŠ€æœ¯æˆ‘ä»¬ä¼šåœ¨åé¢ä»‹ç»ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ä¸ªè®¾è®¡ä¸­, UNIX çš„ fork ä¸æ¥å—å‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ•´æ•°ã€‚UNIX çš„ exec æ¥å—ä¸¤ä¸ªå‚æ•°(è¦è¿è¡Œçš„ç¨‹åºçš„åå­—å’Œä¼ é€’ç»™è¯¥ç¨‹åºçš„å‚æ•°çš„æ•°ç»„). è¿™é‡Œæ˜¯ CreateProcess éœ€è¦ 10 ä¸ªå‚æ•°. éƒ¨åˆ†æ˜¯å› ä¸º UNIX çš„ fork å’Œ exec çš„ç®€æ´æ€§ï¼Œ è¿™ä¸ªæ¥å£ä» 70 å¹´ä»£åˆæœŸè¢«è®¾è®¡å‡ºæ¥åˆ°ç°åœ¨å‡ ä¹æ²¡æœ‰æ”¹å˜.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;UNIX çš„ fork&lt;/strong&gt;ç¨‹åºåŒ…å«ä»¥ä¸‹æ­¥éª¤ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åˆ›å»ºå’Œåˆå§‹åŒ–å†…æ ¸ä¸­çš„ PCB&lt;/li&gt;
&lt;li&gt;åˆ›å»ºä¸€ä¸ªæ–°çš„åœ°å€ç©ºé—´&lt;/li&gt;
&lt;li&gt;åˆå§‹åŒ–åœ°å€ç©ºé—´ï¼Œå°†çˆ¶è¿›ç¨‹çš„åœ°å€ç©ºé—´å®Œå…¨æ‹·è´è¿‡æ¥&lt;/li&gt;
&lt;li&gt;ç»§æ‰¿çˆ¶è¿›ç¨‹çš„æ‰§è¡Œä¸Šä¸‹æ–‡&lt;/li&gt;
&lt;li&gt;é€šçŸ¥è°ƒåº¦ç¨‹åºæœ‰æ–°çš„è¿›ç¨‹å¯ä»¥è¿è¡Œ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ¯”è¾ƒè¯¡å¼‚çš„ä¸€ç‚¹å°±æ˜¯ fork è¿™ä¸ªç³»ç»Ÿè°ƒç”¨è¿”å›ä¼šè¿”å›ä¸¤æ¬¡ï¼šä¸€ä¸ªæ˜¯è¿”å›ç»™çˆ¶äº²è¿›ç¨‹ï¼Œä¸€ä¸ªæ˜¯è¿”å›ç»™å­è¿›ç¨‹ã€‚å¯¹äºçˆ¶è¿›ç¨‹ï¼ŒUNIX è¿”å›å­è¿›ç¨‹çš„ IDï¼Œå¯¹äºå­è¿›ç¨‹ï¼Œè¿”å› 0 æ¥è¡¨ç¤ºæˆåŠŸã€‚æ˜¾ç„¶ï¼Œå½“ä½ å…‹éš†äº†ä½ è‡ªå·±ï¼Œä½ éœ€è¦æœ‰æŸç§æ–¹å¼æ¥åˆ†è¾¨è°æ˜¯å…‹éš†è€…ï¼Œè°æ˜¯ä½ æœ¬èº«ã€‚UNIX å°±é€šè¿‡ fork è¿™ä¸ªç³»ç»Ÿè°ƒç”¨çš„è¿”å›å€¼æ¥åŒºåˆ†è¿™ä¸¤ä¸ªè¿›ç¨‹ã€‚Fork çš„ sample code å¦‚ä¸‹å›¾æ‰€ç¤º&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;int child_pid = fork();
if (child_pid == 0) { //æˆ‘æ˜¯å­è¿›ç¨‹.
  printf(&amp;quot;I am process #   d\n&amp;quot;, getpid()); return 0;
} else { //æˆ‘æ˜¯çˆ¶è¿›ç¨‹.
  printf(&amp;quot;I am the parent of process #   d\n&amp;quot;, child_pid); return 0;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¯èƒ½çš„è¾“å‡ºæœ‰ä¸¤ç§ï¼š&lt;br&gt;
&lt;strong&gt;I am the parent of process 495 I am process 495&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¦ä¸€ç§æ¦‚ç‡å°ä½†ä»å¯èƒ½çš„è¾“å‡ºæ˜¯:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;I am process 456&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;I am the parent of process 456&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Figure 3.5&lt;/strong&gt;: fork ä¸€ä¸ªè¿›ç¨‹çš„ UNIX ä»£ç , å’Œè¿è¡Œè¿™ä¸ªä»£ç çš„å¯èƒ½çš„è¾“å‡ºã€‚ã€‚getpid æ˜¯ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨ï¼Œç”¨æ¥è·å–å½“å‰è¿›ç¨‹çš„ ID.&lt;/p&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬è¿è¡Œå›¾ 3.5 çš„ç¨‹åºä¼šå‘ç”Ÿä»€ä¹ˆï¼ŸUNIX fork è¿”å›ä¸¤æ¬¡ï¼Œä¸€æ¬¡æ˜¯ä»å­è¿›ç¨‹è¿”å›ï¼Œç»“æœæ˜¯ 0ï¼Œä¸€æ¬¡ä»çˆ¶è¿›ç¨‹è¿”å›ï¼Œ ç»“æœæ˜¯å­è¿›ç¨‹çš„ IDã€‚ç„¶è€Œï¼Œæˆ‘ä»¬ä¸çŸ¥é“æ˜¯çˆ¶è¿›ç¨‹è¿˜æ˜¯å­è¿›ç¨‹å…ˆè¿è¡Œã€‚çˆ¶è¿›ç¨‹å·²ç»åœ¨è¿è¡Œäº†ï¼Œçœ‹ä¸Šå»å®ƒæ›´å¯èƒ½å…ˆæ‰“å°è¾“å‡ºã€‚ç„¶è€Œï¼Œä¸€ä¸ªæ—¶é’Ÿä¸­æ–­(timer interrupt)å¯èƒ½åœ¨çˆ¶è¿›ç¨‹fork äº†è¿›ç¨‹åå‡ºç°ï¼Œå› æ­¤ä¼šå‡ºç°è¿›ç¨‹åˆ‡æ¢ã€‚æˆ–è€…ï¼Œæˆ‘ä»¬åœ¨å¤šæ ¸ç³»ç»Ÿä¸Šè¿è¡Œï¼Œçˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹æ˜¯åŒæ—¶è¿è¡Œã€‚æ— è®ºå“ªç§æƒ…å†µå­è¿›ç¨‹éƒ½å¯èƒ½åœ¨çˆ¶è¿›ç¨‹ä¹‹å‰è¾“å‡ºã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;UNIX çš„exec å’Œwait&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;UNIX çš„ç³»ç»Ÿè°ƒç”¨ exec å®Œæˆéœ€è¦è¿è¡Œä¸€ä¸ªæ–°æˆæ•ˆçš„æ­¥éª¤ã€‚ä¸€æ—¦å­è¿›ç¨‹ä» UNIX fork è¿”å›å¹¶è®¾ç½®äº†æ–°è¿›ç¨‹çš„æ‰§è¡Œç¯èŠ‚åï¼Œå­è¿›ç¨‹è°ƒç”¨ UNIX exec. åœ¨æˆ‘ä»¬ä¸‹ä¸€èŠ‚è®¨è®ºUNIX ç®¡é“çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šæè¿°æ›´å¤šè¿™ä¸ªå¦‚ä½•å·¥ä½œçš„.&lt;/p&gt;
&lt;p&gt;Exec åŒ…å«å¦‚ä¸‹æ­¥éª¤ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åŠ è½½ç¨‹åºprog åˆ°å½“å‰çš„åœ°å€ç©ºé—´&lt;/li&gt;
&lt;li&gt;æ‹·è´å‚æ•° args åˆ°åœ°å€ç©ºé—´ä¸­&lt;/li&gt;
&lt;li&gt;åˆå§‹åŒ–ç¡¬ä»¶ä¸Šä¸‹æ–‡æ¥ä»å¼€å¤´å¼€å§‹æ‰§è¡Œ  åˆ°æ­¤ä¸ºæ­¢ï¼Œexec å°±åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„è¿›ç¨‹&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦ä¸€æ–¹é¢ï¼Œçˆ¶è¿›ç¨‹å¸¸å¸¸éœ€è¦æš‚åœç›´åˆ°å­è¿›ç¨‹å®Œæˆè¿è¡Œä¸ºæ­¢ï¼Œä¾‹å¦‚ä¸‹ä¸€æ­¥éª¤æ˜¯ä¾èµ–äºä¸Šä¸€æ­¥éª¤çš„è¾“å‡ºã€‚æ‰€ä»¥ UNIX è¿˜æœ‰ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨ï¼Œå¾ˆè‡ªç„¶åœ°è¢«å«åšwaitï¼Œå®ƒä¼šæš‚åœçˆ¶è¿›ç¨‹çŸ¥é“å­è¿›ç¨‹å®Œæˆæˆ–è€…å´©æ‰æˆ–è€…ç»ˆæ­¢ã€‚ç”±äºçˆ¶è¿›ç¨‹å¯èƒ½åˆ›å»ºäº†è®¸å¤šçš„å­è¿›ç¨‹ï¼Œwait éœ€è¦è®¾å®šå­è¿›ç¨‹çš„ ID ä½œä¸ºå‚æ•°ï¼Œæ¥ç¡®å®šè¦ç­‰å¾…çš„å­è¿›ç¨‹ã€‚ç„¶è€Œï¼Œè¿™ä¸ªå¯¹wait çš„è°ƒç”¨åœ¨ UNIX ä¸­æ˜¯å¯é€‰çš„ã€‚&lt;/p&gt;
&lt;h1 id=&#34;p-stylecolorred9-æ¡ˆä¾‹å®ç°ä¸€ä¸ªç®€å•çš„-shellp&#34;&gt;&lt;p style=&#34;color:red&#34;&gt;9. æ¡ˆä¾‹ï¼šå®ç°ä¸€ä¸ªç®€å•çš„ Shell&lt;/p&gt;&lt;/h1&gt;
&lt;p&gt;å›¾ 3.7 åˆ—å‡ºçš„UNIX ç³»ç»Ÿè°ƒç”¨å·²ç»è¶³ä»¥æ„å»ºä¸€ä¸ªçµæ´»å’Œå¼ºå¤§çš„å‘½ä»¤è¡Œ shellï¼Œè¯¥ shell å®Œå…¨åœ¨ç”¨æˆ·çº§è¿è¡Œï¼Œä¸éœ€è¦ç‰¹æ®Šæƒé™.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;main() {
  char *prog = NULL; char **args = NULL;
  // ä¸€æ¬¡è¯»å–è¾“å…¥çš„ä¸€è¡Œï¼Œå¹¶è§£ææ¯ä¸€è¡Œä¸ºç¨‹åºåå­—å’Œç¨‹åºå‚æ•°
  while (readAndParseCmdLine(&amp;amp;prog, &amp;amp;args)) {
    // åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹æ¥è¿è¡Œå‘½ä»¤. int child_pid = fork();
    if (child_pid == 0) {
      //æˆ‘æ˜¯å­è¿›ç¨‹ï¼Œç”¨çˆ¶è¿›ç¨‹çš„è¾“å…¥æ¥è¿è¡Œç¨‹åºexec(prog, args);
      // è¿™é‡Œä¸ä¼šåˆ°è¾¾ã€‚ã€‚
      } else {
        // æˆ‘æ˜¯çˆ¶è¿›ç¨‹ï¼Œç­‰å¾…å­è¿›ç¨‹å®Œæˆ. wait(child_pid);
        return 0;
    }
  }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Figure 3.8&lt;/strong&gt;: ä¸€ä¸ªç®€å•çš„ UNIX shell çš„ä»£ç .&lt;br&gt;
å›¾ 3.8 å±•ç¤ºäº†ä¸€ä¸ªshell çš„åŸºæœ¬æ“ä½œçš„ä»£ç ã€‚è¿™ä¸ª shell ä»è¾“å…¥è¯»å–ä¸€ä¸ªå‘½ä»¤è¡Œ, ç„¶åå®ƒ fork ä¸€ä¸ªè¿›ç¨‹æ¥æ‰§è¡ŒæŒ‡ä»¤.çˆ¶è¿›ç¨‹(shell)åœ¨è¯»å–ä¸‹ä¸€ä¸ªè¦æ‰§è¡Œçš„å‘½ä»¤è¡Œä¹‹å‰å¿…é¡»ç­‰å¾…å­è¿›ç¨‹å®Œæˆã€‚&lt;/p&gt;
">è¿›ç¨‹</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/mian-shi-ti-xi-lie-mysql-shu-ju-ku/"" data-c="
          &lt;h1 id=&#34;1å­˜å‚¨å¼•æ“&#34;&gt;1.å­˜å‚¨å¼•æ“&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;MySQL é»˜è®¤çš„å­˜å‚¨å¼•æ“æ˜¯ InnoDB&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;myisam-å’Œ-innodb-çš„åŒºåˆ«&#34;&gt;MyISAM å’Œ InnoDB çš„åŒºåˆ«&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;MyISAM&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;InnoDB&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;&lt;strong&gt;æ˜¯å¦æ”¯æŒè¡Œçº§é”&lt;/strong&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;åªæœ‰&lt;strong&gt;è¡¨çº§é”&lt;/strong&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ”¯æŒ&lt;strong&gt;è¡Œçº§é”å’Œè¡¨çº§é”&lt;/strong&gt;ï¼Œé»˜è®¤ä¸ºè¡Œçº§é”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æŸ¥è¯¢æ€§èƒ½&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å¼ºè°ƒçš„æ˜¯æ€§èƒ½ï¼Œæ¯æ¬¡æŸ¥è¯¢å…·æœ‰åŸå­æ€§ï¼Œæ‰§è¡Œé€Ÿåº¦å¿«&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ä½¿ç”¨äº†èšç°‡ç´¢å¼•ã€æˆ–éœ€è¦è®¿é—®çš„æ•°æ®å¯ä»¥æ”¾å…¥å†…å­˜çš„åº”ç”¨ä¸‹é€Ÿåº¦å¿«&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;&lt;strong&gt;æ˜¯å¦æ”¯æŒäº‹åŠ¡&lt;/strong&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ä¸æ”¯æŒ&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ”¯æŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;&lt;strong&gt;æ˜¯å¦æ”¯æŒå´©æºƒåçš„å®‰å…¨æ¢å¤&lt;/strong&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ä¸æ”¯æŒ&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ”¯æŒã€‚äº‹åŠ¡ã€å›æ»šã€å´©æºƒä¿®å¤èƒ½åŠ›å’Œäº‹åŠ¡å®‰å…¨å‹è¡¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ˜¯å¦æ”¯æŒå¤–é”®&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ä¸æ”¯æŒ&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ”¯æŒ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ˜¯å¦æ”¯æŒ MVCC&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ä¸æ”¯æŒ&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ”¯æŒã€‚åº”å¯¹é«˜å¹¶å‘äº‹åŠ¡ï¼ŒMVCCæ¯”å•çº¯çš„åŠ é”æ›´é«˜æ•ˆã€‚MVCCåªåœ¨READ COMMITTED å’Œ REPEATABLE READ ä¸¤ä¸ªéš”ç¦»çº§åˆ«ä¸‹å·¥ä½œï¼›MVCC å¯ä»¥ä½¿ç”¨ä¹è§‚é”å’Œæ‚²è§‚é”æ¥å®ç°ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å…¶ä»–åŠŸèƒ½&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å…¨æ–‡ç´¢å¼•ã€å‹ç¼©ã€ç©ºé—´å‡½æ•°&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;2ç´¢å¼•&#34;&gt;2.ç´¢å¼•&lt;/h1&gt;
&lt;h2 id=&#34;1-èšç°‡ç´¢å¼•ä¸éèšç°‡ç´¢å¼•&#34;&gt;(1) èšç°‡ç´¢å¼•ä¸éèšç°‡ç´¢å¼•&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;MyISAMï¼šB+ æ ‘å¶å­èŠ‚ç‚¹çš„ data åŸŸå­˜æ”¾çš„æ˜¯&lt;strong&gt;æ•°æ®è®°å½•çš„åœ°å€&lt;/strong&gt;ã€‚åœ¨ç´¢å¼•æ£€ç´¢çš„æ—¶å€™ï¼Œé¦–å…ˆæŒ‰ç…§ B+ æ ‘æœç´¢ç®—æ³•æœç´¢ç´¢å¼•ï¼Œå¦‚æœæŒ‡å®šçš„ key å­˜åœ¨ï¼Œåˆ™å–å‡ºå…¶ data åŸŸçš„å€¼ï¼Œç„¶åä»¥ data åŸŸçš„å€¼ä¸ºåœ°å€è¯»å–ç›¸åº”çš„æ•°æ®è®°å½•ã€‚è¿™è¢«ç§°ä¸º â€œ&lt;strong&gt;éèšç°‡ç´¢å¼•&lt;/strong&gt;â€ã€‚&lt;/li&gt;
&lt;li&gt;InnoDBï¼šå…¶æ•°æ®æœ¬èº«å°±æ˜¯ç´¢å¼•æ–‡ä»¶ã€‚ç›¸æ¯” MyISAMï¼Œç´¢å¼•æ–‡ä»¶å’Œæ•°æ®æ–‡ä»¶æ˜¯åˆ†ç¦»çš„ï¼Œå…¶è¡¨æ•°æ®æ–‡ä»¶æœ¬èº«å°±æ˜¯æŒ‰ç…§ B+ æ ‘ç»„ç»‡çš„ä¸€ä¸ªç´¢å¼•ç»“æ„ã€‚B+ æ ‘å¶å­èŠ‚ç‚¹çš„ data åŸŸä¿å­˜äº†å®Œæ•´çš„æ•°æ®è®°å½•ã€‚è¿™ä¸ªç´¢å¼•çš„ key æ˜¯æ•°æ®è¡¨çš„ä¸»é”®ï¼Œå› æ­¤ &lt;strong&gt;InnoDB è¡¨æ•°æ®æ–‡ä»¶æœ¬èº«å°±æ˜¯ä¸»ç´¢å¼•&lt;/strong&gt;ã€‚è¿™è¢«ç§°ä¸ºâ€œ&lt;strong&gt;èšç°‡ç´¢å¼•&lt;/strong&gt;â€ï¼ˆæˆ–â€œèšé›†ç´¢å¼•â€ï¼‰ã€‚è€Œå…¶ä½™çš„ç´¢å¼•éƒ½ä½œä¸ºè¾…åŠ©ç´¢å¼•ï¼Œ&lt;strong&gt;è¾…åŠ©ç´¢å¼•çš„ data åŸŸå­˜å‚¨ç›¸åº”è®°å½•ä¸»é”®çš„å€¼&lt;/strong&gt;è€Œä¸æ˜¯åœ°å€ï¼Œè¿™ä¹Ÿæ˜¯å’Œ MyISAM ä¸åŒçš„åœ°æ–¹ã€‚åœ¨æ ¹æ®ä¸»ç´¢å¼•æœç´¢æ—¶ï¼Œç›´æ¥æ‰¾åˆ° key æ‰€åœ¨çš„èŠ‚ç‚¹å³å¯å–å‡ºæ•°æ®ï¼›åœ¨æ ¹æ®è¾…åŠ©ç´¢å¼•æŸ¥æ‰¾æ—¶ï¼Œåˆ™éœ€è¦å…ˆå–å‡ºä¸»é”®çš„å€¼ï¼Œå†èµ°ä¸€éä¸»ç´¢å¼•ã€‚å› æ­¤ï¼Œåœ¨è®¾è®¡è¡¨çš„æ—¶å€™ï¼Œä¸å»ºè®®ä½¿ç”¨è¿‡é•¿çš„å­—æ®µä½œä¸ºä¸»é”®ï¼Œä¹Ÿä¸å»ºè®®ä½¿ç”¨éå•è°ƒçš„å­—æ®µä½œä¸ºä¸»é”®ï¼Œè¿™æ ·ä¼šé€ æˆä¸»ç´¢å¼•é¢‘ç¹åˆ†è£‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;2-hash-ç´¢å¼•ä¸-b-æ•°ç´¢å¼•&#34;&gt;(2) Hash ç´¢å¼•ä¸ B+ æ•°ç´¢å¼•&lt;/h2&gt;
&lt;h3 id=&#34;hash-ç´¢å¼•&#34;&gt;Hash ç´¢å¼•&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Hash ç´¢å¼•ä»…ä»…èƒ½æ»¡è¶³ &amp;quot;=&amp;quot;ã€â€œINâ€ çš„ç­‰å€¼æŸ¥è¯¢ï¼Œä¸èƒ½ä½¿ç”¨èŒƒå›´æŸ¥è¯¢ã€‚&lt;/li&gt;
&lt;li&gt;Hash ç´¢å¼•ä¸èƒ½åˆ©ç”¨ç»„åˆç´¢å¼•çš„éƒ¨åˆ†ç´¢å¼•é”®æŸ¥è¯¢ã€‚&lt;/li&gt;
&lt;li&gt;Hash ç´¢å¼•é‡åˆ°å¤§é‡ Hash å€¼ç›¸ç­‰çš„æƒ…å†µåæ€§èƒ½ä¸ä¸€å®šå°±ä¼šæ¯” B+ æ ‘é«˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;b-æ ‘ç´¢å¼•&#34;&gt;B+ æ ‘ç´¢å¼•&lt;/h3&gt;
&lt;p&gt;B+æ ‘ç´¢å¼•çš„å…³é”®å­—æ£€ç´¢æ•ˆç‡æ¯”è¾ƒå¹³å‡ï¼Œä¸åƒBæ ‘é‚£æ ·æ³¢åŠ¨å¹…åº¦å¤§ï¼Œ&lt;strong&gt;åœ¨æœ‰å¤§é‡é‡å¤é”®å€¼æƒ…å†µä¸‹ï¼Œå“ˆå¸Œç´¢å¼•çš„æ•ˆç‡ä¹Ÿæ˜¯æä½çš„ï¼Œå› ä¸ºå­˜åœ¨æ‰€è°“çš„å“ˆå¸Œç¢°æ’é—®é¢˜&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h1 id=&#34;3ä»€ä¹ˆæ˜¯äº‹åŠ¡&#34;&gt;3.ä»€ä¹ˆæ˜¯äº‹åŠ¡ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;äº‹åŠ¡æ˜¯é€»è¾‘ä¸Šçš„ä¸€ç»„æ“ä½œï¼Œè¦ä¹ˆéƒ½æ‰§è¡Œï¼Œè¦ä¹ˆéƒ½ä¸æ‰§è¡Œã€‚&lt;/p&gt;
&lt;h1 id=&#34;4äº‹åŠ¡çš„å››å¤§ç‰¹å¾&#34;&gt;4.äº‹åŠ¡çš„å››å¤§ç‰¹å¾&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;åŸå­æ€§ï¼ˆAtomicityï¼‰ï¼šäº‹åŠ¡è¢«è§†ä¸ºä¸å¯åˆ†å‰²çš„æœ€å°å•å…ƒã€‚äº‹åŠ¡çš„æ‰€æœ‰æ“ä½œè¦ä¹ˆå…¨éƒ¨æˆåŠŸæäº¤ï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥å›æ»šã€‚&lt;/li&gt;
&lt;li&gt;ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼šæ•°æ®åº“åœ¨äº‹åŠ¡æ‰§è¡Œå‰åä¿æŒä¸€è‡´æ€§çŠ¶æ€ï¼Œå¤šä¸ªäº‹åŠ¡å¯¹åŒä¸€ä¸ªæ•°æ®è¯»å–çš„ç»“æœæ˜¯ç›¸åŒçš„ã€‚&lt;/li&gt;
&lt;li&gt;éš”ç¦»æ€§ï¼ˆIsolationï¼‰ï¼šä¸€ä¸ªäº‹åŠ¡æ‰€åšçš„ä¿®æ”¹åœ¨æœ€ç»ˆæäº¤ä»¥å‰ï¼Œå¯¹å…¶ä»–äº‹åŠ¡æ˜¯ä¸å¯è§çš„ã€‚&lt;/li&gt;
&lt;li&gt;æŒä¹…æ€§ï¼ˆDurabilityï¼‰ï¼šä¸€æ—¦äº‹åŠ¡æäº¤ï¼Œåˆ™å…¶æ‰€åšçš„ä¿®æ”¹å°†æ°¸è¿œä¿å­˜åœ¨æ•°æ®åº“ä¸­ã€‚å³ä½¿ç³»ç»Ÿå‘ç”Ÿå´©æºƒï¼Œäº‹åŠ¡æ‰§è¡Œçš„ç»“æœé¡µä¸èƒ½ä¸¢å¤±ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;åªæœ‰æ»¡è¶³ä¸€è‡´æ€§ï¼Œäº‹åŠ¡çš„æ‰§è¡Œç»“æœæ‰æ˜¯æ­£ç¡®çš„ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨æ— å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œäº‹åŠ¡ä¸²è¡Œæ‰§è¡Œï¼Œéš”ç¦»æ€§ä¸€å®šèƒ½å¤Ÿæ»¡è¶³ã€‚æ­¤æ—¶åªè¦æ»¡è¶³åŸå­æ€§ï¼Œå°±ä¸€å®šèƒ½æ»¡è¶³ä¸€è‡´æ€§ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œå¤šä¸ªå¤±è¯¯å¹¶è¡Œæ‰§è¡Œï¼Œäº‹åŠ¡ä¸ä»…è¦æ»¡è¶³åŸå­æ€§ï¼Œè¿˜è¦æ»¡è¶³éš”ç¦»æ€§ï¼Œæ‰èƒ½æ»¡è¶³ä¸€è‡´æ€§ã€‚&lt;/li&gt;
&lt;li&gt;äº‹åŠ¡æ»¡è¶³æŒä¹…åŒ–æ˜¯ä¸ºäº†èƒ½åº”å¯¹æ•°æ®åº“å´©æºƒçš„æƒ…å†µã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;AUTOCOMMIT&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;MySQL é»˜è®¤é‡‡ç”¨è‡ªåŠ¨æäº¤æ¨¡å¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä¸æ˜¾å¼ä½¿ç”¨ START TRASACTION è¯­å¥æ¥å¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼Œé‚£ä¹ˆæ¯ä¸ªæŸ¥è¯¢éƒ½ä¼šè¢«å½“ä½œä¸€ä¸ªäº‹åŠ¡è‡ªåŠ¨æäº¤ã€‚&lt;/p&gt;
&lt;h1 id=&#34;5å¹¶å‘äº‹åŠ¡å¸¦æ¥å“ªäº›é—®é¢˜&#34;&gt;5.å¹¶å‘äº‹åŠ¡å¸¦æ¥å“ªäº›é—®é¢˜ï¼Ÿ&lt;/h1&gt;
&lt;h2 id=&#34;1-ä¸¢å¤±ä¿®æ”¹&#34;&gt;(1) ä¸¢å¤±ä¿®æ”¹&lt;/h2&gt;
&lt;p&gt;T1 å’Œ T2 ä¸¤ä¸ªäº‹åŠ¡éƒ½å¯¹ä¸€ä¸ªæ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œ T1 å…ˆä¿®æ”¹ï¼ŒT2 éšåä¿®æ”¹ï¼ŒT2 çš„ä¿®æ”¹è¦†ç›–äº† T1 çš„ä¿®æ”¹ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E4%B8%A2%E5%A4%B1%E4%BF%AE%E6%94%B9.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;2-è¯»è„æ•°æ®&#34;&gt;(2) è¯»è„æ•°æ®&lt;/h2&gt;
&lt;p&gt;T1 ä¿®æ”¹ä¸€ä¸ªæ•°æ®ï¼ŒT2 éšåè¯»å–è¿™ä¸ªæ•°æ®ï¼Œå¦‚æœ T1 æ’¤é”€äº†è¿™æ¬¡ä¿®æ”¹ï¼Œé‚£ä¹ˆ T2 è¯»å–åˆ°çš„æ•°æ®æ˜¯è„æ•°æ®ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%84%8F%E8%AF%BB.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;3-ä¸å¯é‡å¤è¯»&#34;&gt;(3) ä¸å¯é‡å¤è¯»&lt;/h2&gt;
&lt;p&gt;T2 è¯»å–ä¸€ä¸ªæ•°æ®ï¼ŒT1 å¯¹è¿™ä¸ªæ•°æ®è¿›è¡Œäº†ä¿®æ”¹ã€‚å¦‚æœ T2 å†æ¬¡è¯»å–è¿™ä¸ªæ•°æ®ï¼Œæ­¤æ—¶è¯»å–çš„ç»“æœå’Œç¬¬ä¸€æ¬¡è¯»å–çš„ç»“æœä¸åŒã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E4%B8%8D%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;4-å¹»å½±è¯»&#34;&gt;(4) å¹»å½±è¯»&lt;/h2&gt;
&lt;p&gt;T1 è¯»å–æŸä¸ªèŒƒå›´çš„æ•°æ®ï¼ŒT2 åœ¨è¿™ä¸ªèŒƒå›´å†…æ’å…¥æ–°çš„æ•°æ®ï¼ŒT1 å†æ¬¡è¯»å–è¿™ä¸ªèŒƒå›´å†…çš„æ•°æ®ï¼Œæ­¤æ—¶è¯»å–çš„ç»“æœå’Œç¬¬ä¸€æ¬¡è¯»å–çš„ç»“æœä¸åŒã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%B9%BB%E8%AF%BB.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸å¯é‡å¤è¯»å’Œå¹»è¯»çš„åŒºåˆ«ï¼š&lt;br&gt;
ä¸å¯é‡å¤è¯»çš„é‡ç‚¹æ˜¯ä¿®æ”¹ï¼Œæ¯”å¦‚å¤šæ¬¡è¯»å–ä¸€æ¡è®°å½•å‘ç°å…¶ä¸­çš„æŸäº›åˆ—çš„å€¼è¢«ä¿®æ”¹ï¼›å¹»è¯»çš„é‡ç‚¹åœ¨äºæ–°å¢æˆ–è€…åˆ é™¤ï¼Œæ¯”å¦‚å¤šæ¬¡è¯»å–åŒä¸€èŒƒå›´å‘ç°è®°å½•å¢å¤šæˆ–å‡å°‘äº†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;p&gt;äº§ç”Ÿå¹¶å‘ä¸ä¸€è‡´é—®é¢˜ä¸»è¦åŸå› æ˜¯ç ´åäº†äº‹åŠ¡çš„éš”ç¦»æ€§ï¼Œè§£å†³æ–¹æ³•æ—¶é€šè¿‡å¹¶å‘æ§åˆ¶æ¥ä¿è¯éš”ç¦»æ€§ã€‚å¹¶å‘æ§åˆ¶å¯ä»¥é€šè¿‡å°é”æ¥å®ç°ï¼Œä½†æ˜¯å°é”æ“ä½œéœ€è¦ç”¨æˆ·è‡ªå·±æ§åˆ¶ï¼Œç›¸å½“å¤æ‚ã€‚æ•°æ®åº“ç®¡ç†ç³»ç»Ÿæä¾›äº†äº‹åŠ¡çš„éš”ç¦»çº§åˆ«ï¼Œè®©ç”¨æˆ·ä»¥ä¸€ç§æ›´è½»æ¾çš„æ–¹å¼å¤„ç†å¹¶å‘ä¸€è‡´æ€§é—®é¢˜ã€‚&lt;/p&gt;
&lt;h1 id=&#34;6äº‹åŠ¡çš„éš”ç¦»çº§åˆ«æœ‰å“ªäº›&#34;&gt;6.äº‹åŠ¡çš„éš”ç¦»çº§åˆ«æœ‰å“ªäº›ï¼Ÿ&lt;/h1&gt;
&lt;h2 id=&#34;1-è¯»æœªæäº¤read-uncommitted&#34;&gt;(1) è¯»æœªæäº¤ï¼ˆREAD UNCOMMITTEDï¼‰&lt;/h2&gt;
&lt;p&gt;äº‹åŠ¡ä¸­çš„ä¿®æ”¹ï¼Œå³ä½¿æ²¡æœ‰æäº¤ï¼Œå¯¹å…¶ä»–äº‹åŠ¡ä¹Ÿæ˜¯å¯è§çš„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;2-è¯»å·²æäº¤read-committed&#34;&gt;(2) è¯»å·²æäº¤ï¼ˆREAD COMMITTEDï¼‰&lt;/h2&gt;
&lt;p&gt;ä¸€ä¸ªäº‹åŠ¡åªèƒ½è¯»å–å·²ç»æäº¤çš„äº‹åŠ¡æ‰€åšçš„ä¿®æ”¹ã€‚æ¢å¥è¯è¯´ï¼Œä¸€ä¸ªäº‹åŠ¡æ‰€åšçš„ä¿®æ”¹åœ¨æäº¤ä¹‹å‰å¯¹å…¶å®ƒäº‹åŠ¡æ˜¯ä¸å¯è§çš„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;3-å¯é‡å¤è¯»repeatable-read&#34;&gt;(3) å¯é‡å¤è¯»ï¼ˆREPEATABLE READï¼‰&lt;/h2&gt;
&lt;p&gt;ä¸€ä¸ªäº‹åŠ¡åœ¨ç¬¬ä¸€æ¬¡è¯»å–è¿‡æŸæ¡è®°å½•åï¼Œå³ä½¿å…¶ä»–äº‹åŠ¡ä¿®æ”¹äº†è¯¥è®°å½•çš„å€¼å¹¶ä¸”æäº¤ï¼Œè¯¥&lt;strong&gt;äº‹ç‰©ä¹‹åå†è¯»è¯¥æ¡è®°å½•æ—¶ï¼Œè¯»åˆ°çš„ä»æ˜¯ç¬¬ä¸€æ¬¡è¯»åˆ°çš„å€¼&lt;/strong&gt;ã€‚è€Œä¸æ˜¯æ¯æ¬¡éƒ½è¯»åˆ°ä¸åŒçš„æ•°æ®ï¼Œè¿™å°±æ˜¯å¯é‡å¤è¯»ã€‚&lt;/p&gt;
&lt;h2 id=&#34;4-å¯ä¸²è¡ŒåŒ–serializable&#34;&gt;(4) å¯ä¸²è¡ŒåŒ–ï¼ˆSERIALIZABLEï¼‰&lt;/h2&gt;
&lt;p&gt;å¼ºåˆ¶äº‹åŠ¡ä¸²è¡Œæ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦åŠ é”å®ç°ï¼Œè€Œå…¶å®ƒéš”ç¦»çº§åˆ«é€šå¸¸ä¸éœ€è¦ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;éš”ç¦»çº§åˆ«&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;è„è¯»&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;ä¸å¯é‡å¤è¯»&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;å¹»å½±è¯»&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è¯»æœªæäº¤&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;âˆš&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;âˆš&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;âˆš&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è¯»å·²æäº¤&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Ã—&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;âˆš&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;âˆš&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å¯é‡å¤è¯»&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Ã—&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Ã—&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;âˆš&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å¯ä¸²è¡ŒåŒ–&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Ã—&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Ã—&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Ã—&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;MySQL InnoDB å­˜å‚¨å¼•æ“é»˜è®¤çš„éš”ç¦»çº§åˆ«æ˜¯&lt;strong&gt;å¯é‡å¤è¯»&lt;/strong&gt;ã€‚InnoDB å­˜å‚¨å¼•æ“åœ¨å¯é‡è¯»äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸‹ä½¿ç”¨çš„æ˜¯ Next-Key Lock ç®—æ³•ï¼Œå› æ­¤å¯ä»¥é¿å…å¹»è¯»çš„äº§ç”Ÿã€‚&lt;/p&gt;
&lt;h1 id=&#34;7-é”æœºåˆ¶ä¸-innodb-é”ç®—æ³•&#34;&gt;7. é”æœºåˆ¶ä¸ InnoDB é”ç®—æ³•&lt;/h1&gt;
&lt;p&gt;MyISAM å’Œ InnoDB å­˜å‚¨å¼•æ“ä½¿ç”¨çš„é”&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;MyISAM ä½¿ç”¨è¡¨çº§é”&lt;/li&gt;
&lt;li&gt;InnoDB æ”¯æŒè¡Œçº§é”å’Œè¡¨çº§é”ï¼Œé»˜è®¤ä½¿ç”¨è¡Œçº§é”&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¡Œçº§é”å’Œè¡¨çº§é”çš„å¯¹æ¯”ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¡¨çº§é”ï¼šMySQL ä¸­é”å®šç²’åº¦æœ€å¤§çš„ä¸€ç§é”ï¼Œå¯¹å½“å‰æ“ä½œçš„æ•´å¼ è¡¨åŠ é”ï¼Œå®ç°ç®€å•ï¼Œèµ„æºè€—è´¹ä¹Ÿæ¯”è¾ƒå°‘ï¼ŒåŠ é”å¿«ï¼Œä¸ä¼šå‡ºç°æ­»é”ã€‚å…¶é”å®šç²’åº¦æœ€å¤§ï¼Œè§¦å‘é”å†²çªçš„æ¦‚ç‡æœ€é«˜ï¼Œå¹¶å‘ç‡æœ€ä½ï¼ŒMyISAM å’Œ InnoDB å¼•æ“éƒ½æ”¯æŒè¡¨çº§é”ã€‚&lt;/li&gt;
&lt;li&gt;è¡Œçº§é”ï¼šMySQL ä¸­é”å®šç²’åº¦æœ€å°çš„ä¸€ç§é”ï¼Œåªé’ˆå¯¹å½“å‰æ“ä½œçš„è¡Œè¿›è¡ŒåŠ é”ã€‚è¡Œçº§é”èƒ½å¤§å¤§å‡å°‘æ•°æ®åº“æ“ä½œçš„å†²çªã€‚å…¶åŠ é”ç²’åº¦æœ€å°ï¼Œå¹¶å‘åº¦é«˜ï¼Œä½†åŠ é”çš„å¼€é”€ä¹Ÿæœ€å¤§ï¼ŒåŠ é”æ…¢ï¼Œä¼šå‡ºç°æ­»é”ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;InnoDB å­˜å‚¨å¼•æ“çš„é”çš„ç®—æ³•æœ‰ä¸‰ç§ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Record Lock&lt;/strong&gt;ï¼šå•ä¸ªè¡Œè®°å½•ä¸Šçš„é”&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Gap Lock&lt;/strong&gt;ï¼šé—´éš™é”ï¼Œé”å®šä¸€ä¸ªèŒƒå›´ï¼Œä¸åŒ…æ‹¬è®°å½•æœ¬èº«ã€‚GAPé”çš„â½¬çš„ï¼Œæ˜¯ä¸ºäº†é˜²â½ŒåŒâ¼€äº‹åŠ¡çš„ä¸¤æ¬¡å½“å‰è¯»ï¼Œå‡ºç°å¹»è¯»çš„æƒ…å†µã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Next-key Lock&lt;/strong&gt;ï¼šRecord + Gap é”å®šä¸€ä¸ªèŒƒå›´ï¼ŒåŒ…å«è®°å½•æœ¬èº«ã€‚å¯¹äºâ¾çš„æŸ¥è¯¢ï¼Œéƒ½æ˜¯é‡‡â½¤è¯¥æ–¹æ³•ï¼Œä¸»è¦ç›®çš„æ˜¯è§£å†³å¹»è¯»çš„é—®é¢˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç›¸å…³çŸ¥è¯†ç‚¹ï¼š&lt;/p&gt;
&lt;p&gt;1.InnoDB å¯¹äº&lt;strong&gt;è¡Œçš„æŸ¥è¯¢&lt;/strong&gt;ä½¿ç”¨ Next-key Lock&lt;/p&gt;
&lt;p&gt;2.Next-locking keyingä¸ºäº†è§£å†³Phantom Problemå¹»è¯»é—®é¢˜&lt;/p&gt;
&lt;p&gt;3.å½“æŸ¥è¯¢çš„ç´¢å¼•å«æœ‰å”¯ä¸€å±æ€§æ—¶ï¼Œå°† next-key lock é™çº§ä¸º record key&lt;/p&gt;
&lt;p&gt;4.Gapé”è®¾è®¡çš„ç›®çš„æ˜¯ä¸ºäº†é˜»æ­¢å¤šä¸ªäº‹åŠ¡å°†è®°å½•æ’å…¥åˆ°åŒä¸€èŒƒå›´å†…ï¼Œè€Œè¿™ä¼šå¯¼è‡´å¹»è¯»é—®é¢˜çš„äº§ç”Ÿ&lt;/p&gt;
&lt;p&gt;5.æœ‰ä¸¤ç§æ–¹å¼æ˜¾å¼å…³é—­gapé”ï¼šï¼ˆé™¤äº†å¤–é”®çº¦æŸå’Œå”¯ä¸€æ€§æ£€æŸ¥å¤–ï¼Œå…¶ä½™æƒ…å†µä»…ä½¿ç”¨record lockï¼‰&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;A.å°†äº‹åŠ¡éš”ç¦»çº§åˆ«è®¾ç½®ä¸ºRC&lt;/li&gt;
&lt;li&gt;B.å°†å‚æ•°innodb_locks_unsafe_for_binlogè®¾ç½®ä¸º1&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;8ä»‹ç»ä¸€ä¸‹ä¸¤æ®µé”åè®®&#34;&gt;8.ä»‹ç»ä¸€ä¸‹ä¸¤æ®µé”åè®®&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;é˜¶æ®µä¸€ï¼š&lt;strong&gt;åŠ é”é˜¶æ®µ&lt;/strong&gt;ã€‚åœ¨è¿™é˜¶æ®µï¼Œäº‹åŠ¡å¯ä»¥ç”³è¯·è·å¾—ä»»ä½•æ•°æ®é¡¹ä¸Šçš„ä»»ä½•ç±»å‹çš„é”ï¼Œä½†æ˜¯ä¸èƒ½é‡Šæ”¾ä»»ä½•é”ã€‚&lt;/li&gt;
&lt;li&gt;é˜¶æ®µäºŒï¼š&lt;strong&gt;è§£é”é˜¶æ®µ&lt;/strong&gt;ã€‚åœ¨è¿™é˜¶æ®µï¼Œäº‹åŠ¡å¯ä»¥é‡Šæ”¾ä»»ä½•æ•°æ®é¡¹ä¸Šçš„ä»»ä½•ç±»å‹çš„çï¼Œä½†æ˜¯ä¸èƒ½å†ç”³è¯·ä»»ä½•é”ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;æ³¨æ„ï¼šä¸¤æ®µé”åè®®å¯èƒ½ä¼šå¯¼è‡´æ­»é”ã€‚&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E4%B8%A4%E6%AE%B5%E9%94%81%E5%AF%BC%E8%87%B4%E7%9A%84%E6%AD%BB%E9%94%81.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&#34;9ä»‹ç»ä¸€ä¸‹å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶mvcc&#34;&gt;9.ä»‹ç»ä¸€ä¸‹å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCCï¼‰&lt;/h1&gt;
&lt;p&gt;å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCCï¼‰æ˜¯ MySQL çš„ InnoDB å­˜å‚¨å¼•æ“å®ç°éš”ç¦»çº§åˆ«çš„ä¸€ç§å…·ä½“æ–¹å¼ï¼Œç”¨äºå®ç°è¯»å·²æäº¤å’Œå¯é‡å¤è¯»è¿™ä¸¤ç§éš”ç¦»çº§åˆ«ã€‚è€Œè¯»æœªæäº¤æ€»æ˜¯è¯»å–æœ€æ–°çš„æ•°æ®è¡Œï¼Œæ— éœ€ä½¿ç”¨ MVCCã€‚å¯ä¸²è¡ŒåŒ–éš”ç¦»çº§åˆ«éœ€è¦å¯¹æ‰€æœ‰è¯»å–çš„è¡Œéƒ½åŠ é”ï¼Œå•çº¯ä½¿ç”¨ MVCC æ— æ³•å®ç°ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºä½¿ç”¨ InnoDB å­˜å‚¨å¼•æ“çš„è¡¨æ¥è¯´ï¼Œå®ƒçš„èšç°‡ç´¢å¼•è®°å½•ä¸­éƒ½åŒ…ä¸‰ä¸ªéšè—åˆ—ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;&lt;strong&gt;åˆ—å&lt;/strong&gt;&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;&lt;strong&gt;æ˜¯å¦å¿…é¡»&lt;/strong&gt;&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;&lt;strong&gt;å ç”¨ç©ºé—´&lt;/strong&gt;&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;&lt;strong&gt;æè¿°&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;row_id&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;å¦&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;6å­—èŠ‚&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;è¡ŒIDï¼Œå”¯ä¸€æ ‡è¯†ä¸€æ¡è®°å½•&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;transaction_id&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;æ˜¯&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;6å­—èŠ‚&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;äº‹åŠ¡ID&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;roll_pointer&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;æ˜¯&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;7å­—èŠ‚&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;å›æ»šæŒ‡é’ˆ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;trx_idï¼šæ¯æ¬¡å¯¹æŸæ¡è®°å½•è¿›è¡Œæ”¹åŠ¨æ—¶ï¼Œéƒ½ä¼šæŠŠå¯¹åº”çš„ &lt;strong&gt;äº‹åŠ¡ id&lt;/strong&gt; èµ‹å€¼ç»™ trx_id åˆ—ã€‚&lt;/li&gt;
&lt;li&gt;roll_pointerï¼šæ¯æ¬¡å¯¹æŸæ¡è®°å½•è¿›è¡Œæ”¹åŠ¨æ—¶ï¼Œè¿™ä¸ªéšè—åˆ—éƒ½ä¼šå­˜ä¸€ä¸ªæŒ‡é’ˆï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªæŒ‡é’ˆæ‰¾åˆ°è¯¥è®°å½•ä¿®æ”¹å‰çš„ä¿¡æ¯ï¼ˆ&lt;strong&gt;å›æ»šæŒ‡é’ˆ&lt;/strong&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;readview&#34;&gt;ReadView&lt;/h2&gt;
&lt;p&gt;å¯¹äºä½¿ç”¨ &lt;code&gt;READ UNCOMMITTED&lt;/code&gt;éš”ç¦»çº§åˆ«çš„äº‹åŠ¡æ¥è¯´ï¼Œç›´æ¥è¯»å–è®°å½•çš„æœ€æ–°ç‰ˆæœ¬å°±å¥½äº†ï¼Œå¯¹äºä½¿ç”¨ &lt;code&gt;SERIALIZABLE&lt;/code&gt; éš”ç¦»çº§åˆ«çš„äº‹åŠ¡æ¥è¯´ï¼Œä½¿ç”¨åŠ é”çš„æ–¹å¼æ¥è®¿é—®è®°å½•ã€‚å¯¹äºä½¿ç”¨ &lt;code&gt;READ COMMITTED&lt;/code&gt; å’Œ &lt;code&gt;REPEATABLE READ&lt;/code&gt; éš”ç¦»çº§åˆ«çš„äº‹åŠ¡æ¥è¯´ï¼Œå°±éœ€è¦ç”¨åˆ°æˆ‘ä»¬ä¸Šè¾¹æ‰€è¯´çš„ç‰ˆæœ¬é“¾äº†ï¼Œæ ¸å¿ƒé—®é¢˜å°±æ˜¯ï¼š&lt;strong&gt;éœ€è¦åˆ¤æ–­ä¸€ä¸‹ç‰ˆæœ¬é“¾ä¸­çš„å“ªä¸ªç‰ˆæœ¬æ˜¯å½“å‰äº‹åŠ¡å¯è§çš„&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ReadView ä¸­ä¸»è¦åŒ…å«4ä¸ªæ¯”è¾ƒé‡è¦çš„å†…å®¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;m_idsï¼šè¡¨ç¤ºåœ¨ç”Ÿæˆ ReadView æ—¶å½“å‰ç³»ç»Ÿä¸­&lt;strong&gt;æ´»è·ƒçš„ï¼ˆæœªæäº¤çš„ï¼‰è¯»å†™äº‹åŠ¡çš„äº‹åŠ¡idåˆ—è¡¨&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;min_trx_idï¼šè¡¨ç¤ºåœ¨ç”Ÿæˆ ReadView æ—¶å½“å‰ç³»ç»Ÿä¸­&lt;strong&gt;æ´»è·ƒçš„è¯»å†™äº‹åŠ¡ä¸­æœ€å°çš„äº‹åŠ¡id&lt;/strong&gt;ï¼Œä¹Ÿå°±æ˜¯m_ids ä¸­çš„æœ€å°å€¼ã€‚&lt;/li&gt;
&lt;li&gt;max_trx_idï¼šè¡¨ç¤ºç”Ÿæˆ ReadView æ—¶ç³»ç»Ÿä¸­åº”è¯¥&lt;strong&gt;åˆ†é…ç»™ä¸‹ä¸€ä¸ªäº‹åŠ¡çš„ idå€¼&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;creator_trx_idï¼šè¡¨ç¤º&lt;strong&gt;ç”Ÿæˆè¯¥ ReadView çš„äº‹åŠ¡çš„äº‹åŠ¡id&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;æ³¨æ„max_trx_idå¹¶ä¸æ˜¯m_idsä¸­çš„æœ€å¤§å€¼ï¼Œäº‹åŠ¡ id æ˜¯é€’å¢åˆ†é…çš„ã€‚æ¯”æ–¹è¯´ç°åœ¨æœ‰ id ä¸º1ï¼Œ2ï¼Œ3è¿™ä¸‰ä¸ªäº‹åŠ¡ï¼Œä¹‹å id ä¸º 3 çš„äº‹åŠ¡æäº¤äº†ã€‚é‚£ä¹ˆä¸€ä¸ªæ–°çš„è¯»äº‹åŠ¡åœ¨ç”Ÿæˆ ReadView æ—¶ï¼Œm_ids å°±åŒ…æ‹¬ 1 å’Œ2ï¼Œmin_trx_idçš„å€¼å°±æ˜¯ 1ï¼Œmax_trx_idçš„å€¼å°±æ˜¯ 4 ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;read-commited-å®ç°æ–¹å¼&#34;&gt;READ COMMITED å®ç°æ–¹å¼&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;æ¯æ¬¡è¯»å–æ•°æ®å‰éƒ½ç”Ÿæˆä¸€ä¸ªReadView&lt;/strong&gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%AF%BB%E5%B7%B2%E6%8F%90%E4%BA%A4MVCC.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;repeatable-read-å®ç°æ–¹å¼&#34;&gt;REPEATABLE READ å®ç°æ–¹å¼&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;åœ¨ç¬¬ä¸€æ¬¡è¯»å–æ•°æ®æ—¶ç”Ÿæˆä¸€ä¸ªReadViewï¼Œç¬¬äºŒæ¬¡è¯»å–æ•°æ®æ—¶ä½¿ç”¨ç¬¬ä¸€æ¬¡ç”Ÿæˆçš„ ReadViewã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BBMVCC.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;mvccæ€»ç»“&#34;&gt;MVCCæ€»ç»“&lt;/h2&gt;
&lt;p&gt;MVCCï¼ˆMulti-Version Concurrency Control ï¼Œå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰æŒ‡çš„å°±æ˜¯åœ¨ä½¿ç”¨ &lt;code&gt;READ COMMITTD&lt;/code&gt;ã€ &lt;code&gt;REPEATABLE READ&lt;/code&gt; è¿™ä¸¤ç§éš”ç¦»çº§åˆ«çš„äº‹åŠ¡åœ¨æ‰§è¡Œæ™®é€šçš„ SEELCT æ“ä½œæ—¶è®¿é—®è®°å½•çš„ç‰ˆæœ¬é“¾çš„è¿‡ç¨‹ã€‚å¯ä»¥ä½¿ä¸åŒäº‹åŠ¡çš„è¯»-å†™ã€å†™-è¯»æ“ä½œå¹¶å‘æ‰§è¡Œï¼Œä»è€Œæå‡ç³»ç»Ÿæ€§èƒ½ã€‚&lt;code&gt;READ COMMITTD&lt;/code&gt;ã€&lt;code&gt;REPEATABLE READ&lt;/code&gt; è¿™ä¸¤ä¸ªéš”ç¦»çº§åˆ«çš„ä¸€ä¸ªå¾ˆå¤§ä¸åŒå°±æ˜¯ï¼š&lt;strong&gt;ç”ŸæˆReadView çš„æ—¶æœºä¸åŒ&lt;/strong&gt;ï¼Œ&lt;code&gt;READ COMMITTD&lt;/code&gt; åœ¨æ¯ä¸€æ¬¡è¿›è¡Œæ™®é€š SELECT æ“ä½œå‰éƒ½ä¼šç”Ÿæˆä¸€ä¸ª ReadViewï¼Œè€Œ &lt;code&gt;REPEATABLE READ&lt;/code&gt; åªåœ¨ç¬¬ä¸€æ¬¡è¿›è¡Œæ™®é€š SELECT æ“ä½œå‰ç”Ÿæˆä¸€ä¸ªReadViewï¼Œä¹‹åçš„æŸ¥è¯¢æ“ä½œéƒ½é‡å¤ä½¿ç”¨è¿™ä¸ªReadViewå°±å¥½äº†ã€‚&lt;/p&gt;
&lt;h1 id=&#34;10next-key-locks&#34;&gt;10.Next-Key Locks&lt;/h1&gt;
&lt;p&gt;Next-Key Locks æ˜¯ MySQL çš„ InnoDB å­˜å‚¨å¼•æ“çš„ä¸€ç§é”å®ç°ã€‚&lt;/p&gt;
&lt;p&gt;MVCC ä¸èƒ½è§£å†³å¹»å½±è¯»é—®é¢˜ï¼ŒNext-Key Locks å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜è€Œå­˜åœ¨çš„ã€‚åœ¨å¯é‡å¤è¯»ï¼ˆ&lt;code&gt;REPEATABLE READ&lt;/code&gt;ï¼‰éš”ç¦»çº§åˆ«ä¸‹ï¼Œä½¿ç”¨ &lt;code&gt;MVCC + Next-Key Locks&lt;/code&gt; å¯ä»¥è§£å†³å¹»è¯»é—®é¢˜ã€‚&lt;/p&gt;
&lt;h2 id=&#34;record-locks&#34;&gt;Record Locks&lt;/h2&gt;
&lt;p&gt;é”å®šä¸€ä¸ªè®°å½•ä¸Šçš„ç´¢å¼•ï¼Œè€Œä¸æ˜¯è®°å½•æœ¬èº«ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœè¡¨æ²¡æœ‰è®¾ç½®ç´¢å¼•ï¼ŒInnoDB ä¼šè‡ªåŠ¨åœ¨ä¸»é”®ä¸Šåˆ›å»ºéšè—çš„èšç°‡ç´¢å¼•ï¼Œå› æ­¤ Record Locks ä¾ç„¶å¯ä»¥ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;h2 id=&#34;gap-locks&#34;&gt;Gap Locks&lt;/h2&gt;
&lt;p&gt;é”å®šç´¢å¼•ä¹‹é—´çš„é—´éš™ï¼Œä½†æ˜¯ä¸åŒ…å«ç´¢å¼•æœ¬èº«ã€‚ä¾‹å¦‚å½“ä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œä»¥ä¸‹è¯­å¥ï¼Œå…¶å®ƒäº‹åŠ¡å°±ä¸èƒ½åœ¨ t.c ä¸­æ’å…¥ 15ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;SELECT c FROM t WHERE c BETWEEN 10 and 20 FOR UPDATE;
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;next-key-locks&#34;&gt;Next-Key Locks&lt;/h2&gt;
&lt;p&gt;å®ƒæ˜¯ Record Locks å’Œ Gap Locks çš„ç»“åˆï¼Œä¸ä»…é”å®šä¸€ä¸ªè®°å½•ä¸Šçš„ç´¢å¼•ï¼Œä¹Ÿé”å®šç´¢å¼•ä¹‹é—´çš„é—´éš™ã€‚å®ƒé”å®šä¸€ä¸ªå‰å¼€åé—­åŒºé—´ï¼Œä¾‹å¦‚ä¸€ä¸ªç´¢å¼•åŒ…å«ä»¥ä¸‹å€¼ï¼š10, 11, 13, and 20ï¼Œé‚£ä¹ˆå°±éœ€è¦é”å®šä»¥ä¸‹åŒºé—´ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;(-âˆ, 10]
(10, 11]
(11, 13]
(13, 20]
(20, +âˆ)
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;11å¤§è¡¨ä¼˜åŒ–&#34;&gt;11.å¤§è¡¨ä¼˜åŒ–&lt;/h1&gt;
&lt;p&gt;å½“ MySQL å•è¡¨è®°å½•æ•°è¿‡å¤§æ—¶ï¼Œæ•°æ®åº“çš„ CRUD æ€§èƒ½ä¼šæ˜æ˜¾ä¸‹é™ï¼Œä¸€äº›å¸¸è§çš„ä¼˜åŒ–æªæ–½å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;h2 id=&#34;é™å®šæ•°æ®çš„èŒƒå›´&#34;&gt;é™å®šæ•°æ®çš„èŒƒå›´&lt;/h2&gt;
&lt;p&gt;åŠ¡å¿…ç¦æ­¢ä¸å¸¦ä»»ä½•é™åˆ¶æ•°æ®èŒƒå›´æ¡ä»¶çš„æŸ¥è¯¢è¯­å¥ã€‚æ¯”å¦‚ï¼šæˆ‘ä»¬å½“ç”¨æˆ·åœ¨æŸ¥è¯¢å†å²è®¢å•çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶åœ¨ä¸€ä¸ªæœˆçš„èŒƒå›´å†…ï¼›&lt;/p&gt;
&lt;h2 id=&#34;è¯»å†™åˆ†ç¦»&#34;&gt;è¯»/å†™åˆ†ç¦»&lt;/h2&gt;
&lt;p&gt;ç»å…¸çš„æ•°æ®åº“æ‹†åˆ†æ–¹æ¡ˆï¼Œä¸»åº“è´Ÿè´£å†™ï¼Œä»åº“è´Ÿè´£è¯»ï¼›&lt;/p&gt;
&lt;h2 id=&#34;å‚ç›´åˆ†åŒº&#34;&gt;å‚ç›´åˆ†åŒº&lt;/h2&gt;
&lt;p&gt;æ ¹æ®æ•°æ®åº“é‡Œé¢æ•°æ®è¡¨çš„ç›¸å…³æ€§è¿›è¡Œæ‹†åˆ†ã€‚ä¾‹å¦‚ï¼Œç”¨æˆ·è¡¨ä¸­æ—¢æœ‰ç”¨æˆ·çš„ç™»å½•ä¿¡æ¯åˆæœ‰ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯ï¼Œå¯ä»¥å°†ç”¨æˆ·è¡¨æ‹†åˆ†æˆä¸¤ä¸ªå•ç‹¬çš„è¡¨ï¼Œç”šè‡³æ”¾åˆ°å•ç‹¬çš„åº“åšåˆ†åº“ã€‚&lt;/p&gt;
&lt;p&gt;ç®€å•æ¥è¯´å‚ç›´æ‹†åˆ†æ˜¯æŒ‡æ•°æ®è¡¨&lt;strong&gt;åˆ—çš„æ‹†åˆ†&lt;/strong&gt;ï¼ŒæŠŠä¸€å¼ åˆ—æ¯”è¾ƒå¤šçš„è¡¨æ‹†åˆ†ä¸ºå¤šå¼ è¡¨ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¿™æ ·æ¥è¯´å¤§å®¶åº”è¯¥å°±æ›´å®¹æ˜“ç†è§£äº†ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%9E%82%E7%9B%B4%E5%88%86%E5%8C%BA.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;å‚ç›´æ‹†åˆ†çš„ä¼˜ç‚¹ï¼šå¯ä»¥ä½¿å¾—åˆ—æ•°æ®å˜å°ï¼Œåœ¨æŸ¥è¯¢æ—¶å‡å°‘è¯»å–çš„ Block æ•°ï¼Œ&lt;strong&gt;å‡å°‘ I/O æ¬¡æ•°&lt;/strong&gt;ã€‚æ­¤å¤–ï¼Œå‚ç›´åˆ†åŒºå¯ä»¥ç®€åŒ–è¡¨çš„ç»“æ„ï¼Œæ˜“äºç»´æŠ¤ã€‚&lt;/li&gt;
&lt;li&gt;å‚ç›´æ‹†åˆ†çš„ç¼ºç‚¹ï¼š&lt;strong&gt;ä¸»é”®ä¼šå‡ºç°å†—ä½™&lt;/strong&gt;ï¼Œéœ€è¦ç®¡ç†å†—ä½™åˆ—ï¼Œå¹¶ä¼šå¼•èµ· join æ“ä½œï¼Œå¯ä»¥é€šè¿‡åœ¨åº”ç”¨å±‚è¿›è¡Œ join æ¥è§£å†³ã€‚æ­¤å¤–ï¼Œå‚ç›´åˆ†åŒºä¼šè®©äº‹åŠ¡å˜å¾—æ›´åŠ å¤æ‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æ°´å¹³åˆ†åŒº&#34;&gt;æ°´å¹³åˆ†åŒº&lt;/h2&gt;
&lt;p&gt;ä¿æŒæ•°æ®è¡¨ç»“æ„ä¸å˜ï¼Œé€šè¿‡æŸç§ç­–ç•¥å­˜å‚¨æ•°æ®åˆ†ç‰‡ã€‚è¿™æ ·æ¯ä¸€ç‰‡æ•°æ®åˆ†æ•£åˆ°ä¸åŒçš„è¡¨æˆ–è€…åº“ä¸­ï¼Œè¾¾åˆ°äº†åˆ†å¸ƒå¼çš„ç›®çš„ã€‚æ°´å¹³æ‹†åˆ†å¯ä»¥æ”¯æ’‘éå¸¸å¤§çš„æ•°æ®é‡ã€‚&lt;/p&gt;
&lt;p&gt;æ°´å¹³æ‹†åˆ†æ˜¯æŒ‡æ•°æ®è¡¨&lt;strong&gt;è¡Œçš„æ‹†åˆ†&lt;/strong&gt;ï¼Œè¡¨çš„è¡Œæ•°è¶…è¿‡200ä¸‡è¡Œæ—¶ï¼Œå°±ä¼šå˜æ…¢ï¼Œè¿™æ—¶å¯ä»¥æŠŠä¸€å¼ çš„è¡¨çš„æ•°æ®æ‹†æˆå¤šå¼ è¡¨æ¥å­˜æ”¾ã€‚ä¸¾ä¸ªä¾‹å­ï¼šæˆ‘ä»¬å¯ä»¥å°†ç”¨æˆ·ä¿¡æ¯è¡¨æ‹†åˆ†æˆå¤šä¸ªç”¨æˆ·ä¿¡æ¯è¡¨ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…å•ä¸€è¡¨æ•°æ®é‡è¿‡å¤§å¯¹æ€§èƒ½é€ æˆå½±å“ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%B0%B4%E5%B9%B3%E5%88%86%E5%8C%BA.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;æ°´å¹³æ‹†åˆ†å¯ä»¥æ”¯æŒéå¸¸å¤§çš„æ•°æ®é‡ã€‚éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼šåˆ†è¡¨ä»…ä»…æ˜¯è§£å†³äº†å•ä¸€è¡¨æ•°æ®è¿‡å¤§çš„é—®é¢˜ï¼Œä½†ç”±äºè¡¨çš„æ•°æ®è¿˜æ˜¯åœ¨åŒä¸€å°æœºå™¨ä¸Šï¼Œå…¶å®å¯¹äºæå‡MySQLå¹¶å‘èƒ½åŠ›æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰ï¼Œæ‰€ä»¥æ°´å¹³æ‹†åˆ†æœ€å¥½åˆ†åº“ã€‚&lt;/p&gt;
&lt;p&gt;æ°´å¹³æ‹†åˆ†èƒ½å¤Ÿæ”¯æŒéå¸¸å¤§çš„æ•°æ®é‡å­˜å‚¨ï¼Œåº”ç”¨ç«¯æ”¹é€ ä¹Ÿå°‘ï¼Œä½†åˆ†ç‰‡äº‹åŠ¡éš¾ä»¥è§£å†³ï¼Œè·¨èŠ‚ç‚¹Joinæ€§èƒ½è¾ƒå·®ï¼Œé€»è¾‘å¤æ‚ã€‚ã€ŠJavaå·¥ç¨‹å¸ˆä¿®ç‚¼ä¹‹é“ã€‹çš„ä½œè€…æ¨èå°½é‡ä¸è¦å¯¹æ•°æ®è¿›è¡Œåˆ†ç‰‡ï¼Œå› ä¸ºæ‹†åˆ†ä¼šå¸¦æ¥é€»è¾‘ã€éƒ¨ç½²ã€è¿ç»´çš„å„ç§å¤æ‚åº¦ï¼Œä¸€èˆ¬çš„æ•°æ®è¡¨åœ¨ä¼˜åŒ–å¾—å½“çš„æƒ…å†µä¸‹æ”¯æ’‘åƒä¸‡ä»¥ä¸‹çš„æ•°æ®é‡æ˜¯æ²¡æœ‰å¤ªå¤§é—®é¢˜çš„ã€‚å¦‚æœå®åœ¨è¦åˆ†ç‰‡ï¼Œå°½é‡é€‰æ‹©å®¢æˆ·ç«¯åˆ†ç‰‡æ¶æ„ï¼Œè¿™æ ·å¯ä»¥å‡å°‘ä¸€æ¬¡å’Œä¸­é—´ä»¶çš„ç½‘ç»œI/Oã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢è¡¥å……ä¸€ä¸‹æ•°æ®åº“åˆ†ç‰‡çš„ä¸¤ç§å¸¸è§æ–¹æ¡ˆï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å®¢æˆ·ç«¯ä»£ç†ï¼šåˆ†ç‰‡é€»è¾‘åœ¨åº”ç”¨ç«¯ï¼Œå°è£…åœ¨jaråŒ…ä¸­ï¼Œé€šè¿‡ä¿®æ”¹æˆ–è€…å°è£…JDBCå±‚æ¥å®ç°ã€‚å½“å½“ç½‘çš„Sharding-JDBCã€é˜¿é‡Œçš„TDDLæ˜¯ä¸¤ç§æ¯”è¾ƒå¸¸ç”¨çš„å®ç°ã€‚&lt;/li&gt;
&lt;li&gt;ä¸­é—´ä»¶ä»£ç†ï¼šåœ¨åº”ç”¨å’Œæ•°æ®ä¸­é—´åŠ äº†ä¸€ä¸ªä»£ç†å±‚ã€‚åˆ†ç‰‡é€»è¾‘ç»Ÿä¸€ç»´æŠ¤åœ¨ä¸­é—´ä»¶æœåŠ¡ä¸­ã€‚æˆ‘ä»¬ç°åœ¨è°ˆçš„Mycatã€360çš„Atlasã€ç½‘æ˜“çš„DDBç­‰ç­‰éƒ½æ˜¯è¿™ç§æ¶æ„çš„å®ç°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¯¦ç»†å†…å®¹å¯ä»¥å‚è€ƒï¼šMySQLå¤§è¡¨ä¼˜åŒ–æ–¹æ¡ˆï¼š&lt;a href=&#34;https://segmentfault.com/a/1190000006158186&#34;&gt;https://segmentfault.com/a/1190000006158186&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&#34;12åˆ†åº“åˆ†è¡¨ä¹‹åid-ä¸»é”®å¦‚ä½•å¤„ç†&#34;&gt;12.åˆ†åº“åˆ†è¡¨ä¹‹åï¼Œid ä¸»é”®å¦‚ä½•å¤„ç†ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;å› ä¸ºè¦åˆ†æˆå¤šä¸ªè¡¨ä¹‹åï¼Œæ¯ä¸ªè¡¨éƒ½æ˜¯ä» 1 å¼€å§‹ç´¯åŠ ï¼Œè¿™æ ·æ˜¯ä¸å¯¹çš„ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„ id æ¥æ”¯æŒã€‚&lt;/p&gt;
&lt;p&gt;ç”Ÿæˆå…¨å±€ id æœ‰ä¸€ä¸‹è¿™å‡ ç§æ–¹å¼ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;UUID&lt;/strong&gt;ï¼šä¸é€‚åˆä½œä¸ºä¸»é”®ï¼Œå› ä¸ºå¤ªé•¿äº†ï¼Œå¹¶ä¸”æ— åºä¸å¯è¯»ï¼ŒæŸ¥è¯¢æ•ˆç‡ä½ã€‚æ¯”è¾ƒé€‚åˆç”¨äºç”Ÿæˆå”¯ä¸€çš„åå­—çš„æ ‡è¯†ï¼Œæ¯”å¦‚æ–‡ä»¶çš„åå­—ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®åº“è‡ªå¢ id&lt;/strong&gt;ï¼šä¸¤å°æ•°æ®åº“åˆ†åˆ«è®¾ç½®ä¸åŒæ­¥é•¿ï¼Œç”Ÿæˆä¸é‡å¤ ID çš„ç­–ç•¥æ¥å®ç°é«˜å¯ç”¨ã€‚è¿™ç§æ–¹å¼ç”Ÿæˆçš„ id æœ‰åºï¼Œä½†æ˜¯éœ€è¦ç‹¬ç«‹éƒ¨ç½²æ•°æ®åº“å®ä¾‹ï¼Œæˆæœ¬é«˜ï¼Œè¿˜ä¼šæœ‰æ€§èƒ½ç“¶é¢ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ©ç”¨ redis ç”Ÿæˆ id&lt;/strong&gt;ï¼šæ€§èƒ½æ¯”è¾ƒå¥½ï¼Œçµæ´»æ–¹ä¾¿ï¼Œä¸ä¾èµ–äºæ•°æ®åº“ã€‚ä½†æ˜¯ï¼Œå¼•å…¥äº†æ–°çš„ç»„ä»¶é€ æˆç³»ç»Ÿæ›´åŠ å¤æ‚ï¼Œå¯ç”¨æ€§é™ä½ï¼Œç¼–ç æ›´åŠ å¤æ‚ï¼Œå¢åŠ äº†ç³»ç»Ÿæˆæœ¬ã€‚&lt;/li&gt;
&lt;li&gt;......&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;13æŸ¥è¯¢è¯­å¥ä¸åŒå…ƒç´ where-join-limit-group-by-havingç­‰çš„å…ˆåæ‰§è¡Œé¡ºåº&#34;&gt;13.æŸ¥è¯¢è¯­å¥ä¸åŒå…ƒç´ ï¼ˆwhereã€joinã€limitã€group byã€havingç­‰ï¼‰çš„å…ˆåæ‰§è¡Œé¡ºåºï¼Ÿ&lt;/h1&gt;
&lt;p&gt;æŸ¥è¯¢ä¸­ä½¿ç”¨åˆ°çš„å…³é”®å­—ä¸»è¦åŒ…å«å…­ä¸ªï¼Œå¹¶ä¸”å®ƒä»¬çš„ä¹¦å†™é¡ºåºä¾æ¬¡ä¸ºï¼š&lt;/p&gt;
&lt;p&gt;select â€”â€” from â€”â€” where â€”â€” group by â€”â€” having  â€”â€” order by&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ select å’Œ from æ˜¯å¿…é¡»çš„ï¼Œå…¶ä»–å…³é”®è¯æ˜¯å¯é€‰çš„ï¼Œè¿™å…­ä¸ªå…³é”®è¯çš„æ‰§è¡Œé¡ºåºä¸ sql è¯­å¥çš„ä¹¦å†™é¡ºåºå¹¶ä¸æ˜¯ä¸€æ ·çš„ï¼Œè€Œæ˜¯æŒ‰ç…§ä¸‹é¢çš„é¡ºåºæ¥æ‰§è¡Œã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;fromï¼šéœ€è¦ä»å“ªä¸ªæ•°æ®åº“è¡¨æ£€ç´¢æ•°æ®&lt;/li&gt;
&lt;li&gt;whereï¼šè¿‡æ»¤è¡¨ä¸­çš„æ•°æ®æ¡ä»¶&lt;/li&gt;
&lt;li&gt;group byï¼šå¦‚ä½•å°†ä¸Šé¢è¿‡æ»¤å‡ºçš„æ•°æ®è¿›è¡Œåˆ†ç»„&lt;/li&gt;
&lt;li&gt;havingï¼šå¯¹ä¸Šé¢å·²ç»åˆ†ç»„çš„æ•°æ®è¿›è¡Œè¿‡æ»¤çš„æ¡ä»¶&lt;/li&gt;
&lt;li&gt;selectï¼šæŸ¥çœ‹ç»“æœé›†ä¸­çš„å“ªä¸ªåˆ—ï¼Œæˆ–è€…åˆ—çš„è®¡ç®—ç»“æœ&lt;/li&gt;
&lt;li&gt;order byï¼šæŒ‰ç…§ä»€ä¹ˆé¡ºåºæ¥æŸ¥çœ‹è¿”å›çš„æ•°æ®&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;from åé¢çš„è¡¨å…³è”ï¼Œæ˜¯è‡ªå³å‘å·¦è§£æï¼Œè€Œ where æ¡ä»¶çš„è§£æé¡ºåºæ˜¯è‡ªä¸‹å‘ä¸Šçš„ã€‚&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨å†™ SQL çš„æ—¶å€™ï¼Œå°½é‡æŠŠæ•°æ®é‡å°çš„è¡¨æ”¾åœ¨æœ€å³è¾¹æ¥è¿›è¡Œå…³è”ï¼ˆç”¨å°è¡¨å»åŒ¹é…å¤§è¡¨ï¼‰ï¼Œè€ŒæŠŠç­›é€‰å‡ºé”€é‡æ•°æ®çš„æ¡ä»¶å°½é‡æ”¾åœ¨ where è¯­å¥çš„æœ€å·¦è¾¹ï¼ˆç”¨å°è¡¨å»åŒ¹é…å¤§è¡¨ï¼‰ã€‚&lt;/p&gt;
&lt;h1 id=&#34;14å…³ç³»å‹æ•°æ®åº“ä¸éå…³ç³»å‹æ•°æ®åº“&#34;&gt;14.å…³ç³»å‹æ•°æ®åº“ä¸éå…³ç³»å‹æ•°æ®åº“&lt;/h1&gt;
&lt;p&gt;(1) å…³ç³»å‹æ•°æ®åº“&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ SQL è¯­å¥æ–¹ä¾¿çš„åœ¨ä¸€ä¸ªè¡¨ä»¥åŠå¤šä¸ªè¡¨ä¹‹é—´åšéå¸¸&lt;strong&gt;å¤æ‚çš„æ•°æ®æŸ¥è¯¢&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ”¯æŒäº‹åŠ¡ï¼Œå¯¹äº&lt;strong&gt;å®‰å…¨æ€§èƒ½å¾ˆé«˜&lt;/strong&gt;çš„æ•°æ®è®¿é—®è¦æ±‚å¾—ä»¥å®ç°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;(2) éå…³ç³»å‹æ•°æ®åº“&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;NoSQL åŸºäºé”®å€¼å¯¹ï¼Œä¸éœ€è¦ç»è¿‡ SQL å±‚çš„è§£æï¼Œ&lt;strong&gt;æ€§èƒ½é«˜&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç»™äºˆå‡ä¼šå¯¹ï¼Œæ•°æ®ä¹‹é—´æ²¡æœ‰è€¦åˆæ€§ï¼Œ&lt;strong&gt;å®¹æ˜“æ°´å¹³æ‰©å±•&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;15b-æ ‘çš„æ•°æ®ç»“æ„&#34;&gt;15.B+ æ ‘çš„æ•°æ®ç»“æ„ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;B Tree æŒ‡çš„æ˜¯ Balance Treeï¼Œä¹Ÿå°±æ˜¯å¹³è¡¡æ ‘ã€‚å¹³è¡¡æ ‘æ˜¯ä¸€é¢—æŸ¥æ‰¾æ ‘ï¼Œå¹¶ä¸”æ‰€æœ‰å¶å­èŠ‚ç‚¹ä½äºåŒä¸€å±‚ã€‚&lt;/p&gt;
&lt;p&gt;B+ Tree æ˜¯åŸºäº B Tree å’Œå¶å­èŠ‚ç‚¹é¡ºåºè®¿é—®æŒ‡é’ˆè¿›è¡Œå®ç°ï¼Œå®ƒå…·æœ‰ B Tree çš„å¹³è¡¡æ€§ï¼Œå¹¶ä¸”é€šè¿‡é¡ºåºè®¿é—®æŒ‡é’ˆæ¥æé«˜åŒºé—´æŸ¥è¯¢çš„æ€§èƒ½ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ B+ Tree ä¸­ï¼Œä¸€ä¸ªèŠ‚ç‚¹ä¸­çš„ key ä»å·¦åˆ°å³éé€’å‡æ’åˆ—ï¼Œå¦‚æœæŸä¸ªæŒ‡é’ˆçš„å·¦å³ç›¸é‚» key åˆ†åˆ«æ˜¯ keyi å’Œ keyi+1ï¼Œä¸”ä¸ä¸º nullï¼Œåˆ™è¯¥æŒ‡é’ˆæŒ‡å‘èŠ‚ç‚¹çš„æ‰€æœ‰ key å¤§äºç­‰äº keyi ä¸”å°äºç­‰äº keyi+1ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;9&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/B+%E6%A0%91%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h1 id=&#34;16ä¸ºä»€ä¹ˆä½¿ç”¨-b-æ ‘ç´¢å¼•è€Œä¸ç”¨çº¢é»‘æ ‘&#34;&gt;16.ä¸ºä»€ä¹ˆä½¿ç”¨ B+ æ ‘ç´¢å¼•ï¼Œè€Œä¸ç”¨çº¢é»‘æ ‘ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;çº¢é»‘æ ‘ç­‰å¹³è¡¡æ ‘ä¹Ÿå¯ä»¥ç”¨æ¥å®ç°ç´¢å¼•ï¼Œä½†æ˜¯æ–‡ä»¶ç³»ç»ŸåŠæ•°æ®åº“ç³»ç»Ÿæ™®éé‡‡ç”¨ B+ Tree ä½œä¸ºç´¢å¼•ç»“æ„ï¼Œä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ä¸ªåŸå› ï¼š&lt;/p&gt;
&lt;p&gt;ï¼ˆä¸€ï¼‰æ›´å°‘çš„æŸ¥æ‰¾æ¬¡æ•°&lt;/p&gt;
&lt;p&gt;å¹³è¡¡æ ‘æŸ¥æ‰¾æ“ä½œçš„æ—¶é—´å¤æ‚åº¦å’Œæ ‘é«˜ h ç›¸å…³ï¼ŒO(h)=O(logdN)ï¼Œå…¶ä¸­ d ä¸ºæ¯ä¸ªèŠ‚ç‚¹çš„å‡ºåº¦ã€‚&lt;/p&gt;
&lt;p&gt;çº¢é»‘æ ‘çš„å‡ºåº¦ä¸º 2ï¼Œè€Œ B+ Tree çš„å‡ºåº¦ä¸€èˆ¬éƒ½éå¸¸å¤§ï¼Œæ‰€ä»¥çº¢é»‘æ ‘çš„æ ‘é«˜ h å¾ˆæ˜æ˜¾æ¯” B+ Tree å¤§éå¸¸å¤šï¼ŒæŸ¥æ‰¾çš„æ¬¡æ•°ä¹Ÿå°±æ›´å¤šã€‚&lt;/p&gt;
&lt;p&gt;ï¼ˆäºŒï¼‰åˆ©ç”¨ç£ç›˜é¢„è¯»ç‰¹æ€§&lt;/p&gt;
&lt;p&gt;ä¸ºäº†å‡å°‘ç£ç›˜ I/O æ“ä½œï¼Œç£ç›˜å¾€å¾€ä¸æ˜¯ä¸¥æ ¼æŒ‰éœ€è¯»å–ï¼Œè€Œæ˜¯æ¯æ¬¡éƒ½ä¼šé¢„è¯»ã€‚é¢„è¯»è¿‡ç¨‹ä¸­ï¼Œç£ç›˜è¿›è¡Œé¡ºåºè¯»å–ï¼Œé¡ºåºè¯»å–ä¸éœ€è¦è¿›è¡Œç£ç›˜å¯»é“ï¼Œå¹¶ä¸”åªéœ€è¦å¾ˆçŸ­çš„ç£ç›˜æ—‹è½¬æ—¶é—´ï¼Œé€Ÿåº¦ä¼šéå¸¸å¿«ã€‚&lt;/p&gt;
&lt;p&gt;æ“ä½œç³»ç»Ÿä¸€èˆ¬å°†å†…å­˜å’Œç£ç›˜åˆ†å‰²æˆå›ºå®šå¤§å°çš„å—ï¼Œæ¯ä¸€å—ç§°ä¸ºä¸€é¡µï¼Œå†…å­˜ä¸ç£ç›˜ä»¥é¡µä¸ºå•ä½äº¤æ¢æ•°æ®ã€‚æ•°æ®åº“ç³»ç»Ÿå°†ç´¢å¼•çš„ä¸€ä¸ªèŠ‚ç‚¹çš„å¤§å°è®¾ç½®ä¸ºé¡µçš„å¤§å°ï¼Œä½¿å¾—ä¸€æ¬¡ I/O å°±èƒ½å®Œå…¨è½½å…¥ä¸€ä¸ªèŠ‚ç‚¹ã€‚å¹¶ä¸”å¯ä»¥åˆ©ç”¨é¢„è¯»ç‰¹æ€§ï¼Œç›¸é‚»çš„èŠ‚ç‚¹ä¹Ÿèƒ½å¤Ÿè¢«é¢„å…ˆè½½å…¥ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&#34;https://mp.weixin.qq.com/s/IZpRNTKs3EHiXO-vYphk1w&#34;&gt;ä¸ºä»€ä¹ˆMySQLçš„ç´¢å¼•è¦ä½¿ç”¨B+æ ‘è€Œä¸æ˜¯å…¶å®ƒæ ‘å½¢ç»“æ„?æ¯”å¦‚Bæ ‘ï¼Ÿ&lt;/a&gt;&lt;br&gt;
å› ä¸ºBæ ‘ä¸ç®¡å¶å­èŠ‚ç‚¹è¿˜æ˜¯éå¶å­èŠ‚ç‚¹ï¼Œéƒ½ä¼šä¿å­˜æ•°æ®ï¼Œè¿™æ ·å¯¼è‡´åœ¨éå¶å­èŠ‚ç‚¹ä¸­èƒ½ä¿å­˜çš„æŒ‡é’ˆæ•°é‡å˜ï¼ˆæœ‰äº›èµ„æ–™ä¹Ÿç§°ä¸ºæ‰‡å‡ºï¼‰&lt;br&gt;
æŒ‡é’ˆå°‘çš„æƒ…å†µä¸‹è¦ä¿å­˜å¤§é‡æ•°æ®ï¼Œåªèƒ½å¢åŠ æ ‘çš„é«˜åº¦ï¼Œå¯¼è‡´IOæ“ä½œå˜å¤šï¼ŒæŸ¥è¯¢æ€§èƒ½å˜ä½ï¼›&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&#34;17mysql-è¯»å†™åˆ†ç¦»-ä¸»ä»å¤åˆ¶&#34;&gt;17.MySQL è¯»å†™åˆ†ç¦»ã€ä¸»ä»å¤åˆ¶&lt;/h1&gt;
&lt;h2 id=&#34;è¯»å†™åˆ†ç¦»-2&#34;&gt;è¯»å†™åˆ†ç¦»&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;10&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;MySQL è¯»å†™åˆ†ç¦»åŸºæœ¬åŸç†æ˜¯è®© &lt;strong&gt;master æ•°æ®åº“å¤„ç†å†™æ“ä½œï¼Œslave æ•°æ®åº“å¤„ç†è¯»æ“ä½œ&lt;/strong&gt;ã€‚master å°†å†™æ“ä½œçš„å˜æ›´åŒæ­¥åˆ°å„ä¸ª slave èŠ‚ç‚¹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸»ä»å¤åˆ¶åŸç†&#34;&gt;ä¸»ä»å¤åˆ¶åŸç†&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;11&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;masteræœåŠ¡å™¨å°†æ•°æ®çš„æ”¹å˜è®°å½•äºŒè¿›åˆ¶binlogæ—¥å¿—ï¼Œå½“masterä¸Šçš„æ•°æ®å‘ç”Ÿæ”¹å˜æ—¶ï¼Œåˆ™å°†å…¶æ”¹å˜å†™å…¥äºŒè¿›åˆ¶æ—¥å¿—ä¸­ï¼›&lt;/li&gt;
&lt;li&gt;slaveæœåŠ¡å™¨ä¼šåœ¨ä¸€å®šæ—¶é—´é—´éš”å†…å¯¹masteräºŒè¿›åˆ¶æ—¥å¿—è¿›è¡Œæ¢æµ‹å…¶æ˜¯å¦å‘ç”Ÿæ”¹å˜ï¼Œå¦‚æœå‘ç”Ÿæ”¹å˜ï¼Œåˆ™å¼€å§‹ä¸€ä¸ªI/OThreadè¯·æ±‚masteräºŒè¿›åˆ¶äº‹ä»¶&lt;/li&gt;
&lt;li&gt;åŒæ—¶ä¸»èŠ‚ç‚¹ä¸ºæ¯ä¸ªI/Oçº¿ç¨‹å¯åŠ¨ä¸€ä¸ªdumpçº¿ç¨‹ï¼Œç”¨äºå‘å…¶å‘é€äºŒè¿›åˆ¶äº‹ä»¶ï¼Œå¹¶ä¿å­˜è‡³ä»èŠ‚ç‚¹æœ¬åœ°çš„ä¸­ç»§æ—¥å¿—ä¸­ï¼Œä»èŠ‚ç‚¹å°†å¯åŠ¨SQLçº¿ç¨‹ä»ä¸­ç»§æ—¥å¿—ä¸­è¯»å–äºŒè¿›åˆ¶æ—¥å¿—ï¼Œåœ¨æœ¬åœ°é‡æ”¾ï¼Œä½¿å¾—å…¶æ•°æ®å’Œä¸»èŠ‚ç‚¹çš„ä¿æŒä¸€è‡´ï¼Œæœ€åI/OThreadå’ŒSQLThreadå°†è¿›å…¥ç¡çœ çŠ¶æ€ï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡è¢«å”¤é†’ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;18åˆ†é¡µ&#34;&gt;18.åˆ†é¡µ&lt;/h1&gt;
&lt;p&gt;LIMIT æ¥å—ä¸€ä¸ªæˆ–ä¸¤ä¸ªæ•°å­—å‚æ•°ã€‚å‚æ•°å¿…é¡»æ˜¯ä¸€ä¸ªæ•´æ•°å¸¸é‡ã€‚&lt;br&gt;
å¦‚æœç»™å®šä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šç¬¬ä¸€ä¸ªè¿”å›è®°å½•è¡Œçš„åç§»é‡ï¼Œç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šè¿”å›è®°å½•è¡Œçš„æœ€å¤§æ•°ç›®ã€‚åˆå§‹è®°å½•è¡Œçš„åç§»é‡æ˜¯ 0(è€Œä¸æ˜¯ 1)ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;//å¦‚æœåªç»™å®šä¸€ä¸ªå‚æ•°ï¼Œå®ƒè¡¨ç¤ºè¿”å›æœ€å¤§çš„è®°å½•è¡Œæ•°ç›®ï¼š
mysql&amp;gt; SELECT * FROM table LIMIT 5; //æ£€ç´¢å‰ 5 ä¸ªè®°å½•è¡Œ
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ¢å¥è¯è¯´ï¼ŒLIMIT n ç­‰ä»·äº LIMIT 0,nã€‚&lt;br&gt;
&lt;a href=&#34;https://segmentfault.com/a/1190000008859706&#34;&gt;https://segmentfault.com/a/1190000008859706&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&#34;19mybatiså¦‚ä½•é˜²æ­¢sqlæ³¨å…¥çš„&#34;&gt;19.MyBatiså¦‚ä½•é˜²æ­¢SQLæ³¨å…¥çš„ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;mybatisçš„#{}å’Œ&lt;span class=&#39;katex-error&#39; title=&#39;ParseError: KaTeX parse error: Expected &amp;#039;EOF&amp;#039;, got &amp;#039;#&amp;#039; at position 21: â€¦ä»¥åŠorder byæ³¨å…¥é—®é¢˜
#Ì²{}ï¼šç›¸å½“äº JDBC ä¸­çš„ â€¦&#39;&gt;{}çš„åŒºåˆ«ä»¥åŠorder byæ³¨å…¥é—®é¢˜
#{}ï¼šç›¸å½“äº JDBC ä¸­çš„ PreparedStatement
&lt;/span&gt;{}ï¼šæ˜¯è¾“å‡ºå˜é‡çš„å€¼&lt;br&gt;
ç®€å•è¯´ï¼Œ#{}æ˜¯ç»è¿‡é¢„ç¼–è¯‘çš„ï¼Œæ˜¯å®‰å…¨çš„ï¼›${}æ˜¯æœªç»è¿‡é¢„ç¼–è¯‘çš„ï¼Œä»…ä»…æ˜¯å–å˜é‡çš„å€¼ï¼Œæ˜¯éå®‰å…¨çš„ï¼Œå­˜åœ¨SQLæ³¨å…¥ã€‚&lt;/p&gt;
&lt;h1 id=&#34;å‚è€ƒé“¾æ¥&#34;&gt;å‚è€ƒé“¾æ¥ï¼š&lt;/h1&gt;
&lt;p&gt;&lt;a href=&#34;https://cyc2018.github.io/CS-Notes/#/notes/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86&#34;&gt;https://cyc2018.github.io/CS-Notes/#/notes/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/Snailclimb/JavaGuide/blob/master/docs/database/MySQL.md&#34;&gt;https://github.com/Snailclimb/JavaGuide/blob/master/docs/database/MySQL.md&lt;/a&gt;&lt;/p&gt;
">é¢è¯•é¢˜ç³»åˆ— â€”â€” MySQL æ•°æ®åº“</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/mian-shi-ti-xi-lie-jvm/"" data-c="
          &lt;h1 id=&#34;1-æ¯”è¾ƒ-jvm-jre-jdk&#34;&gt;1. æ¯”è¾ƒ JVM ã€JREã€JDK&lt;/h1&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/jre-jvm-jdk.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;JVMï¼šJava Virtual Machineï¼šJava è™šæ‹Ÿæœº&lt;/li&gt;
&lt;li&gt;JREï¼šJava Runtime Environmentï¼šJava è¿è¡Œç¯å¢ƒï¼ˆJVM + åŸºç¡€ç±»åº“ï¼‰&lt;/li&gt;
&lt;li&gt;JDKï¼šJVM + åŸºç¡€ç±»åº“ + ç¼–è¯‘å·¥å…·ï¼ˆjavaã€javacã€javapï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;2-ä»‹ç»ä¸‹-java-å†…å­˜åŒºåŸŸ-ç»“æ„è¿è¡Œæ—¶æ•°æ®åŒº&#34;&gt;2. ä»‹ç»ä¸‹ Java å†…å­˜åŒºåŸŸ / ç»“æ„ï¼ˆè¿è¡Œæ—¶æ•°æ®åŒºï¼‰&lt;/h1&gt;
&lt;h2 id=&#34;çº¿ç¨‹ç§æœ‰çš„&#34;&gt;çº¿ç¨‹ç§æœ‰çš„ï¼š&lt;/h2&gt;
&lt;h3 id=&#34;ç¨‹åºè®¡æ•°å™¨&#34;&gt;ç¨‹åºè®¡æ•°å™¨&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ä½œç”¨ï¼šè®°å½•æ­£åœ¨æ‰§è¡Œçš„è™šæ‹Ÿæœº&lt;strong&gt;å­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€&lt;/strong&gt;ï¼ˆå¦‚æœæ­£åœ¨æ‰§è¡Œçš„æ˜¯æœ¬åœ°æ–¹æ³•åˆ™ä¸ºç©ºï¼‰&lt;/li&gt;
&lt;li&gt;å”¯ä¸€ä¸€ä¸ª&lt;strong&gt;ä¸ä¼š OutOfMemory&lt;/strong&gt; çš„å†…å­˜åŒºåŸŸ&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;è™šæ‹Ÿæœºæ ˆçº¿ç¨‹æ ˆ&#34;&gt;è™šæ‹Ÿæœºæ ˆï¼ˆçº¿ç¨‹æ ˆï¼‰&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ç»„æˆï¼š&lt;strong&gt;æ ˆå¸§&lt;/strong&gt;ï¼ˆæ¯ä¸ªæ–¹æ³•æœ‰ä¸€ä¸ªæ ˆå¸§ï¼‰
&lt;ul&gt;
&lt;li&gt;å±€éƒ¨å˜é‡è¡¨&lt;/li&gt;
&lt;li&gt;æ“ä½œæ•°æ ˆ&lt;/li&gt;
&lt;li&gt;åŠ¨æ€é“¾æ¥&lt;/li&gt;
&lt;li&gt;å‡ºå£ä¿¡æ¯&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;psï¼šå‡ ä¸ªå°é—®é¢˜&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åƒåœ¾å›æ”¶æ˜¯å¦æ¶‰åŠæ ˆå†…å­˜ï¼Ÿ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ ˆå†…å­˜æ”¾çš„æ˜¯æ ˆå¸§ï¼Œæ¯ä¸€æ¬¡æ–¹æ³•è°ƒç”¨ç»“æŸåï¼ˆæˆ–æŠ›å‡ºå¼‚å¸¸åï¼‰æ ˆå¸§éƒ½ä¼šè‡ªåŠ¨å¼¹å‡ºæ ˆï¼Œæ‰€ä»¥ä¸éœ€è¦åƒåœ¾å›æ”¶æ¥ç®¡ç†æ ˆå†…å­˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ˆå†…å­˜åˆ†é…è¶Šå¤§è¶Šå¥½å—&lt;/strong&gt;ï¼Ÿ
&lt;ul&gt;
&lt;li&gt;ä¸ï¼Œç‰©ç†å†…å­˜çš„å¤§å°æ˜¯ä¸€å®šçš„ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªæ ˆï¼Œå¦‚æœæ ˆå†…å­˜è¿‡å¤§ï¼Œä¼šè®©çº¿ç¨‹æ•°å˜å°‘ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–¹æ³•å†…çš„å±€éƒ¨å˜é‡æ˜¯å¦çº¿ç¨‹å®‰å…¨&lt;/strong&gt;ï¼Ÿ
&lt;ul&gt;
&lt;li&gt;å¦‚æœæ–¹æ³•å†…å±€éƒ¨å˜é‡æ²¡æœ‰é€ƒé€¸å‡ºæ–¹æ³•ï¼Œçº¿ç¨‹å®‰å…¨&lt;/li&gt;
&lt;li&gt;å¦‚æœæ–¹æ³•å†…å±€éƒ¨å˜é‡é€ƒé€¸å‡ºæ–¹æ³•çš„ä½œç”¨èŒƒå›´ï¼Œ
&lt;ul&gt;
&lt;li&gt;åŸºæœ¬æ•°æ®ç±»å‹å­˜åœ¨&lt;strong&gt;æ ˆå¸§&lt;/strong&gt;å†…ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•è®¿é—®ï¼Œçº¿ç¨‹å®‰å…¨ã€‚&lt;/li&gt;
&lt;li&gt;å¼•ç”¨æ•°æ®ç±»å‹å­˜åœ¨äº&lt;strong&gt;å †&lt;/strong&gt;å†…ï¼Œå¦‚æœé€ƒé€¸å‡ºæ–¹æ³•ï¼ˆæ–¹æ³•å‚æ•°ã€è¿”å›å€¼ï¼‰ï¼Œå…¶ä»–çº¿ç¨‹æ‹¿åˆ°å¯¹è±¡çš„å¼•ç”¨ï¼Œå°±å¯ä»¥é€šè¿‡å¼•ç”¨æ‰¾åˆ°å †å†…å­˜ä¸­çš„å¯¹è±¡è¿›è¡Œä¿®æ”¹ï¼Œçº¿ç¨‹ä¸å®‰å…¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ˆå†…å­˜æº¢å‡ºï¼š&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ ˆå¸§è¿‡å¤šï¼šé€’å½’è°ƒç”¨ä¸­æ²¡æœ‰è®¾ç½®æ­£ç¡®çš„ç»“æŸæ¡ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;æ ˆå¸§è¿‡å¤§&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æœ¬åœ°æ–¹æ³•æ ˆ&#34;&gt;æœ¬åœ°æ–¹æ³•æ ˆ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;JVM åœ¨è°ƒç”¨æœ¬åœ°æ–¹æ³•ï¼ˆnative ä¿®é¥°çš„æ–¹æ³•ï¼‰æ—¶ï¼Œéœ€è¦ä¸ºæœ¬åœ°æ–¹æ³•æä¾›çš„å†…å­˜ç©ºé—´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;çº¿ç¨‹å…±æœ‰çš„&#34;&gt;çº¿ç¨‹å…±æœ‰çš„&lt;/h2&gt;
&lt;h3 id=&#34;å †&#34;&gt;å †&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ &lt;strong&gt;new&lt;/strong&gt; å…³é”®å­—åˆ›å»ºå‡ºæ¥çš„å¯¹è±¡å­˜æ”¾åœ¨å †å†…å­˜ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;æœ‰&lt;strong&gt;åƒåœ¾å›æ”¶&lt;/strong&gt;æœºåˆ¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ–¹æ³•åŒºæ–¹æ³•åŒºå†…æœ‰å¸¸é‡æ± &#34;&gt;æ–¹æ³•åŒºï¼ˆæ–¹æ³•åŒºå†…æœ‰å¸¸é‡æ± ï¼‰&lt;/h3&gt;
&lt;p&gt;å­˜å‚¨&lt;strong&gt;ç±»ç»“æ„&lt;/strong&gt;ç›¸å…³çš„ä¿¡æ¯ï¼šæˆå‘˜å˜é‡ã€æˆå‘˜æ–¹æ³•å’Œæ„é€ å™¨æ–¹æ³•çš„ä»£ç éƒ¨åˆ†ã€åŒ…æ‹¬ä¸€äº›ç‰¹æ®Šæ–¹æ³•ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%96%B9%E6%B3%95%E5%8C%BA1.6.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;HotSpot 1.6 è™šæ‹Ÿæœºå†…å­˜ç»“æ„ï¼š&lt;br&gt;
æ–¹æ³•åŒºæ˜¯ä¸€ä¸ªæ¦‚å¿µï¼Œç”¨ä¸€ä¸ª&lt;strong&gt;æ°¸ä¹…ä»£&lt;/strong&gt;ä½œä¸ºæ–¹æ³•åŒºçš„å®ç°ã€‚æ°¸ä¹…ä»£åŒ…æ‹¬ï¼šClass ç±»ä¿¡æ¯ã€ç±»åŠ è½½å™¨ã€è¿è¡Œæ—¶å¸¸é‡æ± ã€‚StringTable å­˜åœ¨äºè¿è¡Œæ—¶å¸¸é‡æ± ä¸­ã€‚&lt;br&gt;
æ–¹æ³•åŒºä¸æ°¸ä¹…ä»£ï¼šæ–¹æ³•åŒºæ˜¯ä¸€ç§&lt;strong&gt;æ¦‚å¿µ&lt;/strong&gt;ï¼Œæ°¸ä¹…ä»£æ˜¯ HotSpot è™šæ‹Ÿæœºå¯¹è™šæ‹Ÿæœºè§„èŒƒä¸­æ–¹æ³•åŒºçš„ä¸€ç§&lt;strong&gt;å®ç°&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%96%B9%E6%B3%95%E5%8C%BA.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;HotSpot 1.8 è™šæ‹Ÿæœºå†…å­˜ç»“æ„ï¼š&lt;br&gt;
æ–¹æ³•åŒºè¿˜æ˜¯ä¸€ä¸ªæ¦‚å¿µä¸Šçš„ä¸œè¥¿ï¼Œæ–¹æ³•åŒºçš„å®ç°ä½¿ç”¨&lt;strong&gt;å…ƒç©ºé—´&lt;/strong&gt;ã€‚å…ƒç©ºé—´å†…åŒ…å«äº†ï¼šClass ç±»ä¿¡æ¯ã€ç±»åŠ è½½å™¨ã€å¸¸é‡æ± ï¼Œä¸è¿‡ä»–å·²ç»ä¸å†å ç”¨å †å†…å­˜äº†ï¼ˆä¸æ˜¯ç”± JVM ç®¡ç†å®ƒçš„å†…å­˜ç»“æ„ï¼‰ï¼Œç§»å‡ºåˆ°æœ¬åœ°å†…å­˜ï¼ˆ&lt;strong&gt;æ“ä½œç³»ç»Ÿå†…å­˜&lt;/strong&gt;ï¼‰ä¸­ã€‚æœ¬åœ°å†…å­˜ä¸­è¿˜ä¼šæ”¾ä¸€äº›å…¶ä»–è¿›ç¨‹ï¼Œæœ‰ä¸€å—æ˜¯å…ƒç©ºé—´ã€‚StringTable ä¸²è¢«ç§»åŠ¨åˆ°äº†å †ä¸­ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&#34;3-ä»‹ç»ä¸‹-java-å†…å­˜æ¨¡å‹&#34;&gt;3. ä»‹ç»ä¸‹ Java å†…å­˜æ¨¡å‹&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;JMMï¼šJava Memory Mmodel&lt;/li&gt;
&lt;li&gt;Java å†…å­˜æ¨¡å‹å®šä¹‰äº†ä¸€å¥—åœ¨&lt;strong&gt;å¤šçº¿ç¨‹&lt;/strong&gt;è¯»å†™å…±äº«æ•°æ®æ—¶ï¼Œå¯¹æ•°æ®çš„å¯è§æ€§ã€æœ‰åºæ€§å’ŒåŸå­æ€§çš„ä¿éšœã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/jmm.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h1 id=&#34;4-å¦‚ä½•åˆ¤æ–­å¯¹è±¡æ˜¯å¦æ­»äº¡&#34;&gt;4. å¦‚ä½•åˆ¤æ–­å¯¹è±¡æ˜¯å¦æ­»äº¡ï¼Ÿ&lt;/h1&gt;
&lt;h2 id=&#34;å¼•ç”¨è®¡æ•°æ³•&#34;&gt;å¼•ç”¨è®¡æ•°æ³•&lt;/h2&gt;
&lt;p&gt;ä¸ºæ¯ä¸ªå¯¹è±¡æ·»åŠ ä¸€ä¸ª&lt;strong&gt;å¼•ç”¨è®¡æ•°å™¨&lt;/strong&gt;ï¼Œæ¯å½“æœ‰ä¸€ä¸ªå¼•ç”¨æŒ‡å‘è¿™ä¸ªå¯¹è±¡ï¼Œå°±æŠŠå¼•ç”¨è®¡æ•°å™¨çš„å€¼ +1ï¼Œå½“å¼•ç”¨å¤±æ•ˆï¼Œè®¡æ•°å™¨å€¼ -1ï¼Œç›´åˆ°å¼•ç”¨è®¡æ•°å™¨çš„å€¼ä¸º 0ï¼Œè¡¨ç¤ºä¸å†æœ‰å¼•ç”¨æŒ‡å‘è¿™ä¸ªå¯¹è±¡ï¼Œå°±å¯åˆ¤å®šè¿™ä¸ªå¯¹è±¡å·²æ­»äº¡ã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸ºæ— æ³•è§£å†³å¯¹è±¡é—´&lt;strong&gt;å¾ªç¯å¼•ç”¨&lt;/strong&gt;çš„é—®é¢˜ï¼Œæ‰€ä»¥ä¸»æµçš„ Java è™šæ‹Ÿæœºä¸­æ²¡æœ‰é‡‡ç”¨è¿™ç§æ–¹æ³•æ¥ç®¡ç†å†…å­˜ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¯è¾¾æ€§åˆ†ææ³•&#34;&gt;å¯è¾¾æ€§åˆ†ææ³•&lt;/h2&gt;
&lt;p&gt;ä»¥ GC Root ä¸ºèµ·ç‚¹å‘ä¸‹æœç´¢ï¼Œæœç´¢è¿‡çš„è·¯å¾„ç§°ä¸ºå¼•ç”¨é“¾ï¼Œå½“ä¸€ä¸ªå¯¹è±¡åˆ° GC Root æ²¡æœ‰ä»»ä½•å¼•ç”¨é“¾ç›¸è¿æ—¶ï¼Œåˆ™è¯æ˜è¿™ä¸ªå¯¹è±¡æ˜¯ä¸å¯ç”¨çš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å“ªäº›å¯¹è±¡å¯ä»¥ä½œä¸º-gc-root&#34;&gt;å“ªäº›å¯¹è±¡å¯ä»¥ä½œä¸º GC Rootï¼Ÿ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;è™šæ‹Ÿæœºæ ˆä¸­å±€éƒ¨å˜é‡å¼•ç”¨çš„å¯¹è±¡&lt;/li&gt;
&lt;li&gt;æœ¬åœ°æ–¹æ³•æ ˆä¸­ JNI ä¸­å¼•ç”¨çš„å¯¹è±¡&lt;/li&gt;
&lt;li&gt;æ–¹æ³•åŒºé™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡&lt;/li&gt;
&lt;li&gt;æ–¹æ³•åŒºä¸­çš„å¸¸é‡å¼•ç”¨çš„å¯¹è±¡&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;5-ä»‹ç»ä¸€ä¸‹-å¼ºå¼•ç”¨-è½¯å¼•ç”¨-å¼±å¼•ç”¨-è™šå¼•ç”¨&#34;&gt;5. ä»‹ç»ä¸€ä¸‹ å¼ºå¼•ç”¨ã€è½¯å¼•ç”¨ã€å¼±å¼•ç”¨ã€è™šå¼•ç”¨&lt;/h1&gt;
&lt;h2 id=&#34;å¼ºå¼•ç”¨&#34;&gt;å¼ºå¼•ç”¨&lt;/h2&gt;
&lt;p&gt;åªè¦ä¸€ä¸ªå¯¹è±¡è¿˜æœ‰&lt;strong&gt;å¼ºå¼•ç”¨&lt;/strong&gt;æŒ‡å‘å®ƒï¼Œå®ƒå°±ä¸ä¼šè¢«å›æ”¶ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;new&lt;/code&gt;ä¸€ä¸ªå¯¹è±¡çš„æ–¹å¼æ¥åˆ›å»ºå¼ºå¼•ç”¨ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Object obj = new Object();
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;è½¯å¼•ç”¨&#34;&gt;è½¯å¼•ç”¨&lt;/h2&gt;
&lt;p&gt;ä»…æœ‰è½¯å¼•ç”¨æŒ‡å‘è¯¥å¯¹è±¡æ—¶ï¼Œåœ¨&lt;strong&gt;åƒåœ¾å›æ”¶åï¼Œå†…å­˜ä»ä¸è¶³&lt;/strong&gt;å°±ä¼šå†æ¬¡è§¦å‘åƒåœ¾å›æ”¶ï¼Œå›æ”¶&lt;strong&gt;è½¯å¼•ç”¨å¯¹è±¡&lt;/strong&gt;ã€‚å¯é…åˆå¼•ç”¨é˜Ÿåˆ—å›æ”¶è½¯å¼•ç”¨æœ¬èº«ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;SoftReference&lt;/code&gt; ç±»æ¥åˆ›å»ºè½¯å¼•ç”¨ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Object obj = new Object();
SoftReference&amp;lt;Ojbect&amp;gt; sf = new SoftReference&amp;lt;Object&amp;gt;(obj);
obj = null; // ä½¿å¯¹è±¡åªè¢«è½¯å¼•ç”¨å…³è”
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;å¼±å¼•ç”¨&#34;&gt;å¼±å¼•ç”¨&lt;/h2&gt;
&lt;p&gt;å½“ä»…æœ‰å¼±å¼•ç”¨æŒ‡å‘è¯¥å¯¹è±¡æ—¶ï¼Œåœ¨&lt;strong&gt;åƒåœ¾å›æ”¶&lt;/strong&gt;æ—¶ï¼Œæ— è®ºå†…å­˜æ˜¯å¦å……è¶³ï¼Œéƒ½ä¼šå›æ”¶å¼±å¼•ç”¨å¯¹è±¡ã€‚å¯é…åˆå¼•ç”¨é˜Ÿåˆ—å›æ”¶è½¯å¼•ç”¨æœ¬èº«ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;WeakReference&lt;/code&gt;ç±»æ¥åˆ›å»ºå¼±å¼•ç”¨ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Object obj = new Object();
WeakReference&amp;lt;Object&amp;gt; wf = new WeakReference&amp;lt;Object&amp;gt;(obj);
obj = null;
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;è™šå¼•ç”¨&#34;&gt;è™šå¼•ç”¨&lt;/h2&gt;
&lt;p&gt;ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æœ‰è™šå¼•ç”¨çš„å­˜åœ¨ï¼Œä¸ä¼šå¯¹å…¶ç”Ÿå­˜æ—¶é—´é€ æˆå½±å“ï¼Œä¹Ÿ&lt;strong&gt;æ— æ³•é€šè¿‡è™šå¼•ç”¨å¾—åˆ°ä¸€ä¸ªå¯¹è±¡&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºä¸€ä¸ªå¯¹è±¡è®¾ç½®è™šå¼•ç”¨çš„å”¯ä¸€ç›®çš„å°±æ˜¯èƒ½&lt;strong&gt;åœ¨è¿™ä¸ªå¯¹è±¡è¢«å›æ”¶æ—¶æ”¶åˆ°ä¸€ä¸ªç³»ç»Ÿé€šçŸ¥&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ &lt;strong&gt;PhantomReference&lt;/strong&gt; æ¥åˆ›å»ºè™šå¼•ç”¨ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Object obj = new Object();
PhantomReferenceÂ &amp;lt;Object&amp;gt; wf = new PhantomReferenceÂ &amp;lt;Object&amp;gt;(obj, null);
obj = null;
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;6-åƒåœ¾æ”¶é›†æœ‰å“ªäº›ç®—æ³•å„è‡ªçš„ç‰¹ç‚¹&#34;&gt;6. åƒåœ¾æ”¶é›†æœ‰å“ªäº›ç®—æ³•ï¼Ÿå„è‡ªçš„ç‰¹ç‚¹ï¼Ÿ&lt;/h1&gt;
&lt;h2 id=&#34;æ ‡è®°æ¸…é™¤ç®—æ³•&#34;&gt;æ ‡è®°æ¸…é™¤ç®—æ³•&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%A0%87%E8%AE%B0%E6%B8%85%E9%99%A4.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;è¿‡ç¨‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ‡è®°&lt;/strong&gt;ï¼šä» GC Root å¼€å§‹å‘ä¸‹æ‰¾ï¼Œå¦‚æœæŸä¸ªå¯¹è±¡æ²¡æœ‰ç»è¿‡ä»»æ„ä¸€æ¡å¼•ç”¨é“¾ï¼Œåˆ™æŠŠè¿™ä¸ªå¯¹è±¡æ ‡è®°ä¸ºåƒåœ¾å¯¹è±¡&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¸…é™¤&lt;/strong&gt;ï¼šæ¸…é™¤æ ‡è®°ä¸ºåƒåœ¾çš„å¯¹è±¡ï¼Œå¹¶ä¸æ˜¯æŠŠå†…å­˜ä¸­æ¯ä¸ªå­—èŠ‚éƒ½æ¸…é›¶ï¼Œåªæ˜¯æŠŠè¿™æ®µå†…å­˜çš„èµ·å§‹ã€ç»“æŸåœ°å€æ”¾å…¥ä¸€ä¸ªç©ºé—²åœ°å€åˆ—è¡¨ï¼Œä¸‹æ¬¡åˆ†é…å†…å­˜æ—¶ä»ç©ºé—²åœ°å€åˆ—è¡¨é€‰æ‹©ä¸€å—ç©ºé—²å†…å­˜è¿›è¡Œåˆ†é…ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€Ÿåº¦å¿«&lt;/li&gt;
&lt;li&gt;æ˜“é€ æˆå†…ç¢ç‰‡&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æ ‡è®°æ•´ç†ç®—æ³•&#34;&gt;æ ‡è®°æ•´ç†ç®—æ³•&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E6%A0%87%E8%AE%B0%E6%95%B4%E7%90%86.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;è¿‡ç¨‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ ‡è®°&lt;/strong&gt;ï¼šç”± GC Root å‘ä¸‹æ‰¾ï¼Œç»è¿‡çš„è·¯å¾„ç§°ä¸ºå¼•ç”¨é“¾ï¼Œå¦‚æœæŸä¸ªå¯¹è±¡æ²¡æœ‰ç»è¿‡ä»»ä½•ä¸€æ¡å¼•ç”¨é“¾ï¼Œå°†å…¶æ ‡è®°ä¸ºåƒåœ¾å¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•´ç†&lt;/strong&gt;ï¼šæ¸…ç†åƒåœ¾çš„è¿‡ç¨‹ä¸­ï¼Œå°†éåƒåœ¾å¯¹è±¡ä¾æ¬¡å‘å‰ç§»åŠ¨ï¼Œä½¿å†…å­˜æ›´åŠ ç´§å‡‘ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ¶‰åŠåˆ°å¤§é‡å¯¹è±¡çš„ç§»åŠ¨ï¼Œ&lt;strong&gt;é€Ÿåº¦æ…¢&lt;/strong&gt;ã€‚å¯¹è±¡åœ¨æ•´ç†çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæœ‰å…¶ä»–å¼•ç”¨æŒ‡å‘è¿™ä¸ªå¯¹è±¡ï¼Œéœ€è¦æ›´æ”¹è¿™äº›å¼•ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;æ²¡æœ‰å†…ç¢ç‰‡&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å¤åˆ¶ç®—æ³•&#34;&gt;å¤åˆ¶ç®—æ³•&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%A4%8D%E5%88%B61.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%A4%8D%E5%88%B62.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;9&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%A4%8D%E5%88%B63.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;è¿‡ç¨‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ ‡è®°ï¼šå°†ä¸ç»è¿‡å¼•ç”¨é“¾çš„å¯¹è±¡æ ‡è®°åƒåœ¾å¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;å¤åˆ¶ï¼šå°†éåƒåœ¾å¯¹è±¡ä» FROM åŒºåŸŸå¤åˆ¶åˆ° TO åŒºåŸŸï¼Œåœ¨å¤åˆ¶çš„è¿‡ç¨‹ä¸­å®Œæˆäº†æ•´ç†ï¼ŒFROM åŒºåŸŸå­˜åœ¨çš„éƒ½æ˜¯åƒåœ¾å¯¹è±¡ï¼Œå…¨éƒ¨æ¸…é™¤ï¼Œäº¤æ¢ FROM åŒºåŸŸå’Œ TO åŒºåŸŸã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸ä¼šæœ‰å†…ç¢ç‰‡&lt;/li&gt;
&lt;li&gt;éœ€è¦å ç”¨åŒå€ç©ºé—´&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;åˆ†ä»£æ”¶é›†ç®—æ³•&#34;&gt;åˆ†ä»£æ”¶é›†ç®—æ³•&lt;/h2&gt;
&lt;p&gt;å°†å †åˆ’åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ–°ç”Ÿä»£ä½¿ç”¨ï¼šå¤åˆ¶ç®—æ³•&lt;/li&gt;
&lt;li&gt;è€å¹´ä»£ä½¿ç”¨ï¼šæ ‡è®°-æ¸…é™¤ ç®—æ³• æˆ– æ ‡è®°-æ•´ç† ç®—æ³•&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;7-hotspot-ä¸ºä»€ä¹ˆè¦åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£&#34;&gt;7. HotSpot ä¸ºä»€ä¹ˆè¦åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;HotSpot æ ¹æ®å¯¹è±¡å­˜æ´»å‘¨æœŸçš„ä¸åŒå°†å†…å­˜åˆ’åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼Œ&lt;strong&gt;æ–°ç”Ÿä»£&lt;/strong&gt;åœ¨åƒåœ¾å›æ”¶åï¼Œåªæœ‰å°‘éƒ¨åˆ†å¯¹è±¡ä¼šè¢«ä¿ç•™ï¼Œæ‰€ä»¥é‡‡ç”¨&lt;strong&gt;å¤åˆ¶ç®—æ³•&lt;/strong&gt;ï¼›è€Œ&lt;strong&gt;è€å¹´ä»£åˆ™&lt;/strong&gt;æœ‰å¤§éƒ¨åˆ†å¯¹è±¡è¢«ä¿ç•™ï¼Œä½¿ç”¨&lt;strong&gt;æ ‡è®°-æ¸…é™¤&lt;/strong&gt; æˆ– &lt;strong&gt;æ ‡è®°-æ•´ç†&lt;/strong&gt; ç®—æ³•ã€‚&lt;/p&gt;
&lt;h1 id=&#34;8-æ–¹æ³•åŒºçš„å›æ”¶&#34;&gt;8. æ–¹æ³•åŒºçš„å›æ”¶&lt;/h1&gt;
&lt;p&gt;ä¸»è¦æ˜¯å¯¹å¸¸é‡æ± çš„å›æ”¶å’Œç±»çš„å›æ”¶ã€‚&lt;/p&gt;
&lt;p&gt;ç±»çš„å›æ”¶éœ€è¦æ»¡è¶³ä¸‰ä¸ªæ¡ä»¶ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¯¥ç±»çš„æ‰€æœ‰å®ä¾‹å·²ç»è¢«å›æ”¶ï¼Œæ­¤æ—¶å †ä¸­ä¸å­˜åœ¨è¯¥ç±»çš„ä»»ä½•å®ä¾‹ã€‚&lt;/li&gt;
&lt;li&gt;è¯¥ç±»çš„ç±»åŠ è½½å™¨å·²ç»è¢«å›æ”¶ã€‚&lt;/li&gt;
&lt;li&gt;è¯¥ç±»çš„ç±»å¯¹è±¡æ²¡æœ‰åœ¨ä»»ä½•åœ°æ–¹è¢«å¼•ç”¨ï¼Œä¸”é€šè¿‡åå°„ä¹Ÿæ— æ³•è·å¾—è¯¥ç±»æ–¹æ³•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;9-hotspot-gc-çš„è§¦å‘æ¡ä»¶&#34;&gt;9. HotSpot GC çš„è§¦å‘æ¡ä»¶&lt;/h1&gt;
&lt;h2 id=&#34;minor-gc&#34;&gt;Minor GC&lt;/h2&gt;
&lt;p&gt;æ–°ç”Ÿä»£ä¸­çš„ Eden åŒºåŸŸå†…å­˜ä¸è¶³æ—¶è§¦å‘ Minor GCã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Minor GC ä¼šå›æ”¶æ–°ç”Ÿä»£ï¼Œå› ä¸ºæ–°ç”Ÿä»£å¯¹è±¡å­˜æ´»æ—¶é—´è¾ƒçŸ­ï¼Œå› æ­¤ Minor GC ä¼šé¢‘ç¹æ‰§è¡Œï¼Œæ‰§è¡Œçš„é€Ÿåº¦ä¸€èˆ¬ä¹Ÿä¼šæ¯”è¾ƒå¿«&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;full-gc&#34;&gt;Full GC&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;è°ƒç”¨ System.gc() å»ºè®®è™šæ‹Ÿæœºæ‰§è¡Œ Full GC&lt;/li&gt;
&lt;li&gt;è€å¹´ä»£ç©ºé—´ä¸è¶³ï¼ˆå¤§å¯¹è±¡æˆ–é•¿æœŸå­˜æ´»çš„å¯¹è±¡è¿›å…¥è€å¹´ä»£å¯¼è‡´è€å¹´ä»£ç©ºé—´ä¸è¶³ï¼‰æ—¶è§¦å‘ Full GC&lt;/li&gt;
&lt;li&gt;ç©ºé—´åˆ†é…æ‹…ä¿å¤±è´¥&lt;/li&gt;
&lt;li&gt;JDK1.7 åŠä»¥å‰çš„æ°¸ä¹…ä»£ç©ºé—´ä¸è¶³&lt;/li&gt;
&lt;li&gt;Concurrent Mode Failure&lt;br&gt;
æ‰§è¡Œ CMS GC çš„è¿‡ç¨‹ä¸­åŒæ—¶æœ‰å¯¹è±¡è¦æ”¾å…¥è€å¹´ä»£ï¼Œè€Œæ­¤æ—¶è€å¹´ä»£ç©ºé—´ä¸è¶³ï¼ˆå¯èƒ½æ˜¯ GC è¿‡ç¨‹ä¸­æµ®åŠ¨åƒåœ¾è¿‡å¤šå¯¼è‡´æš‚æ—¶æ€§çš„ç©ºé—´ä¸è¶³ï¼‰ï¼Œä¾¿ä¼šæŠ¥ Concurrent Mode Failure é”™è¯¯ï¼Œå¹¶è§¦å‘ Full GCã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;Full GC å›æ”¶è€å¹´ä»£å’Œæ–°ç”Ÿä»£ï¼Œè€å¹´ä»£å¯¹è±¡å…¶å­˜æ´»æ—¶é—´é•¿ï¼Œå› æ­¤ Full GC å¾ˆå°‘æ‰§è¡Œï¼Œæ‰§è¡Œé€Ÿåº¦ä¼šæ¯” Minor GC æ…¢å¾ˆå¤šã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&#34;10-ä»€ä¹ˆæƒ…å†µä¸‹æ–°ç”Ÿä»£å¯¹è±¡ä¼šæ™‹å‡åˆ°è€å¹´ä»£&#34;&gt;10. ä»€ä¹ˆæƒ…å†µä¸‹æ–°ç”Ÿä»£å¯¹è±¡ä¼šæ™‹å‡åˆ°è€å¹´ä»£ï¼Ÿ&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;æ™‹å‡å¹´é¾„è¾¾åˆ°é˜ˆå€¼çš„å¯¹è±¡ï¼Œä¼šæ™‹å‡åˆ°è€å¹´ä»£ã€‚&lt;/li&gt;
&lt;li&gt;å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£ï¼šé¿å…åœ¨ Eden å’Œ Survior ä¹‹é—´æ¥å›è¿›è¡Œå¤§é‡å¤åˆ¶ã€‚&lt;/li&gt;
&lt;li&gt;Minor GC åï¼Œå¦‚æœå¯¹è±¡å¤ªå¤§æ— æ³•è¿›å…¥ Survior åŒºï¼Œåˆ™ç›´æ¥è¿›å…¥è€å¹´ä»£ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœåœ¨ Survior åŒºä¸­ç›¸åŒå¹´é¾„æ‰€æœ‰å¯¹è±¡å¤§å°çš„æ€»å’Œå¤§äº Survivor ç©ºé—´çš„ä¸€åŠï¼Œå¹´é¾„å¤§äºæˆ–ç­‰äºè¯¥å¹´é¾„å¯¹è±¡å°±å¯ä»¥ç›´æ¥è¿›å…¥è€å¹´ä»£ï¼Œæ— é¡»ç­‰å¹´é¾„è¾¾åˆ°æ™‹å‡é˜ˆå€¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;11-å¸¸è§çš„åƒåœ¾æ”¶é›†å™¨æœ‰å“ªäº›&#34;&gt;11. å¸¸è§çš„åƒåœ¾æ”¶é›†å™¨æœ‰å“ªäº›ï¼Ÿ&lt;/h1&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;10&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ä»¥ä¸Šæ˜¯ HotSpot è™šæ‹Ÿæœºä¸­çš„ 7 ä¸ªåƒåœ¾æ”¶é›†å™¨ï¼Œè¿çº¿è¡¨ç¤ºåƒåœ¾æ”¶é›†å™¨å¯ä»¥é…åˆä½¿ç”¨ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å•çº¿ç¨‹ä¸å¤šçº¿ç¨‹ï¼šå•çº¿ç¨‹æŒ‡çš„æ˜¯åƒåœ¾æ”¶é›†å™¨åªä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹ï¼Œè€Œå¤šçº¿ç¨‹ä½¿ç”¨å¤šä¸ªçº¿ç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;ä¸²è¡Œä¸å¹¶è¡Œï¼šä¸²è¡ŒæŒ‡çš„æ˜¯åƒåœ¾æ”¶é›†å™¨å·¥ä½œçš„æ—¶å€™å¿…é¡»åœæ­¢ç”¨æˆ·çº¿ç¨‹ï¼›å¹¶è¡ŒæŒ‡çš„æ˜¯åƒåœ¾æ”¶é›†å™¨å’Œç”¨æˆ·çº¿ç¨‹åŒæ—¶å·¥ä½œã€‚é™¤äº† CMS å’Œ G1ä¹‹å¤–ï¼Œå…¶ä»–åƒåœ¾æ”¶é›†å™¨éƒ½æ˜¯ä»¥ä¸²è¡Œçš„æ–¹å¼æ‰§è¡Œçš„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;serialä¸²è¡Œå•çº¿ç¨‹æ”¶é›†å™¨&#34;&gt;Serialï¼ˆä¸²è¡Œå•çº¿ç¨‹ï¼‰æ”¶é›†å™¨&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å·¥ä½œåœ¨&lt;strong&gt;æ–°ç”Ÿä»£&lt;/strong&gt;ã€‚&lt;strong&gt;å¤åˆ¶&lt;/strong&gt;ç®—æ³•&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸²è¡Œ&lt;/strong&gt;æ–¹å¼æ‰§è¡Œ&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å•çº¿ç¨‹&lt;/strong&gt;æ”¶é›†å™¨ï¼Œåªä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œåƒåœ¾æ‰‹æœºå·¥ä½œ&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç®€å•é«˜æ•ˆ&lt;/strong&gt;ï¼Œå•ä¸ª CPU æ²¡æœ‰è¿›ç¨‹åˆ‡æ¢çš„å¼€é”€ã€‚&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E4%B8%B2%E8%A1%8C%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E5%99%A8.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;å››ä¸ª CPU åœ¨è¿è¡Œï¼ŒæŸæ—¶åˆ»å †å†…å­˜ä¸è¶³ï¼Œè§¦å‘åƒåœ¾å›æ”¶ã€‚è§¦å‘åƒåœ¾å›æ”¶æ—¶ï¼Œéœ€è¦è®©è¿™äº›çº¿ç¨‹åˆ°è¾¾ä¸€ä¸ªå®‰å…¨ç‚¹å†åœä¸‹ï¼Œå› ä¸ºåœ¨åƒåœ¾å›æ”¶çš„è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½å¯¹è±¡çš„åœ°å€å‘ç”Ÿæ”¹å˜ï¼Œä¸ºäº†ä¿è¯å®‰å…¨åœ°ä½¿ç”¨è¿™äº›å¯¹è±¡åœ°å€ï¼Œéœ€è¦æ‰€æœ‰æ­£åœ¨å·¥ä½œçš„ç”¨æˆ·çº¿ç¨‹åˆ°è¾¾è¿™ä¸ªå®‰å…¨ç‚¹åœ¨åœä¸‹ã€‚å› ä¸º Serialã€SerialOld éƒ½æ˜¯å•çº¿ç¨‹çš„åƒåœ¾å›æ”¶å™¨ï¼Œå› æ­¤åœ¨ä¸€ä¸ªåƒåœ¾å›æ”¶çº¿ç¨‹è¿è¡Œæ—¶ï¼Œå…¶ä»–çš„ç”¨æˆ·çº¿ç¨‹éƒ½è¦é˜»å¡ï¼Œç­‰åˆ°åƒåœ¾å›æ”¶çº¿ç¨‹ç»“æŸåï¼Œå…¶ä»–çš„ç”¨æˆ·çº¿ç¨‹å†æ¢å¤è¿è¡Œã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å®ƒæ˜¯ Client åœºæ™¯ä¸‹çš„é»˜è®¤æ–°ç”Ÿä»£æ”¶é›†å™¨ï¼Œå› ä¸ºåœ¨è¯¥åœºæ™¯ä¸‹å†…å­˜ä¸€èˆ¬æ¥è¯´ä¸ä¼šå¾ˆå¤§ã€‚å®ƒæ”¶é›†ä¸€ä¸¤ç™¾å…†åƒåœ¾çš„åœé¡¿æ—¶é—´å¯ä»¥æ§åˆ¶åœ¨ä¸€ç™¾å¤šæ¯«ç§’ä»¥å†…ï¼Œåªè¦ä¸æ˜¯å¤ªé¢‘ç¹ï¼Œè¿™ç‚¹åœé¡¿æ—¶é—´æ˜¯å¯ä»¥æ¥å—çš„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;parnewä¸²è¡Œå¤šçº¿ç¨‹-æ”¶é›†å™¨&#34;&gt;ParNewï¼ˆä¸²è¡Œå¤šçº¿ç¨‹ï¼‰ æ”¶é›†å™¨&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¸²è¡Œ&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤šçº¿ç¨‹&lt;/strong&gt;åƒåœ¾æ”¶é›†å™¨&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å®ƒæ˜¯ Server åœºæ™¯ä¸‹é»˜è®¤çš„æ–°ç”Ÿä»£æ”¶é›†å™¨ï¼Œé™¤äº†æ€§èƒ½åŸå› å¤–ï¼Œä¸»è¦æ˜¯å› ä¸ºé™¤äº† Serial æ”¶é›†å™¨ï¼Œåªæœ‰å®ƒèƒ½ä¸ CMS æ”¶é›†å™¨é…åˆä½¿ç”¨ã€‚&lt;/p&gt;
&lt;h2 id=&#34;parallel-scavengeå¤šçº¿ç¨‹ååé‡-æ”¶é›†å™¨&#34;&gt;Parallel Scavengeï¼ˆå¤šçº¿ç¨‹ååé‡ï¼‰ æ”¶é›†å™¨&lt;/h2&gt;
&lt;p&gt;JDK 1.8 é»˜è®¤ä½¿ç”¨ Parallel Scavenge + Parallel Old åƒåœ¾å›æ”¶å™¨ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¤šçº¿ç¨‹&lt;/strong&gt;åƒåœ¾æ”¶é›†å™¨&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ååé‡ä¼˜å…ˆ&lt;/strong&gt;ã€‚ååé‡ï¼šCPU ç”¨äºè¿è¡Œç”¨æˆ·ç¨‹åºçš„æ—¶é—´ä¸æ€»æ—¶é—´çš„æ¯”å€¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;11&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%90%9E%E5%90%90%E9%87%8F%E4%BC%98%E5%85%88%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E5%99%A8.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;åœé¡¿æ—¶é—´è¶ŠçŸ­å°±è¶Šé€‚åˆéœ€è¦ä¸ç”¨æˆ·äº¤äº’çš„ç¨‹åºï¼Œè‰¯å¥½çš„å“åº”é€Ÿåº¦èƒ½æå‡ç”¨æˆ·ä½“éªŒã€‚è€Œé«˜ååé‡åˆ™å¯ä»¥é«˜æ•ˆç‡åœ°åˆ©ç”¨ CPU æ—¶é—´ï¼Œå°½å¿«å®Œæˆç¨‹åºçš„è¿ç®—ä»»åŠ¡ï¼Œé€‚åˆåœ¨åå°è¿ç®—è€Œä¸éœ€è¦å¤ªå¤šäº¤äº’çš„ä»»åŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç¼©çŸ­åœé¡¿æ—¶é—´æ˜¯ä»¥ç‰ºç‰²ååé‡å’Œæ–°ç”Ÿä»£ç©ºé—´æ¥æ¢å–çš„&lt;/strong&gt;ï¼šæ–°ç”Ÿä»£ç©ºé—´å˜å°ï¼Œåƒåœ¾å›æ”¶å˜å¾—é¢‘ç¹ï¼Œå¯¼è‡´ååé‡ä¸‹é™ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥é€šè¿‡ä¸€ä¸ªå¼€å…³å‚æ•°æ‰“å¼€ GC è‡ªé€‚åº”çš„è°ƒèŠ‚ç­–ç•¥ï¼ˆGC Ergonomicsï¼‰ï¼Œå°±ä¸éœ€è¦æ‰‹å·¥æŒ‡å®šæ–°ç”Ÿä»£çš„å¤§å°ï¼ˆ-Xmnï¼‰ã€Eden å’Œ Survivor åŒºçš„æ¯”ä¾‹ã€æ™‹å‡è€å¹´ä»£å¯¹è±¡å¹´é¾„ç­‰ç»†èŠ‚å‚æ•°äº†ã€‚è™šæ‹Ÿæœºä¼šæ ¹æ®å½“å‰ç³»ç»Ÿçš„è¿è¡Œæƒ…å†µæ”¶é›†æ€§èƒ½ç›‘æ§ä¿¡æ¯ï¼ŒåŠ¨æ€è°ƒæ•´è¿™äº›å‚æ•°ä»¥æä¾›æœ€åˆé€‚çš„åœé¡¿æ—¶é—´æˆ–è€…æœ€å¤§çš„ååé‡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;serial-oldä¸²è¡Œå•çº¿ç¨‹è€å¹´ä»£-æ”¶é›†å™¨&#34;&gt;Serial Oldï¼ˆä¸²è¡Œå•çº¿ç¨‹è€å¹´ä»£ï¼‰ æ”¶é›†å™¨&lt;/h2&gt;
&lt;p&gt;æ˜¯ Serial æ”¶é›†å™¨çš„è€å¹´ä»£ç‰ˆæœ¬ï¼Œä¹Ÿæ˜¯ç»™ Client åœºæ™¯ä¸‹çš„è™šæ‹Ÿæœºä½¿ç”¨ã€‚å¦‚æœç”¨åœ¨ Server åœºæ™¯ä¸‹ï¼Œå®ƒæœ‰ä¸¤å¤§ç”¨é€”ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨ JDK 1.5 ä»¥åŠä¹‹å‰ç‰ˆæœ¬ï¼ˆParallel Old è¯ç”Ÿä»¥å‰ï¼‰ä¸­ä¸ Parallel Scavenge æ”¶é›†å™¨æ­é…ä½¿ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;ä½œä¸º CMS æ”¶é›†å™¨çš„åå¤‡é¢„æ¡ˆï¼Œåœ¨å¹¶å‘æ”¶é›†å‘ç”Ÿ Concurrent Mode Failure æ—¶ä½¿ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;parallel-oldå¤šçº¿ç¨‹ååé‡è€å¹´ä»£-æ”¶é›†å™¨&#34;&gt;Parallel Oldï¼ˆå¤šçº¿ç¨‹ååé‡è€å¹´ä»£ï¼‰ æ”¶é›†å™¨&lt;/h2&gt;
&lt;p&gt;æ˜¯ Parallel Scavenge æ”¶é›†å™¨çš„è€å¹´ä»£ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ³¨é‡ååé‡ä»¥åŠ CPU èµ„æºæ•æ„Ÿçš„åœºåˆï¼Œéƒ½å¯ä»¥ä¼˜å…ˆè€ƒè™‘ Parallel Scavenge åŠ  Parallel Old æ”¶é›†å™¨ã€‚&lt;/p&gt;
&lt;h2 id=&#34;cms-æ”¶é›†å™¨&#34;&gt;CMS æ”¶é›†å™¨&lt;/h2&gt;
&lt;p&gt;CMSï¼ˆConcurrent Mark Sweepï¼‰ï¼ŒMark Sweep æŒ‡çš„æ˜¯æ ‡è®° - æ¸…é™¤ç®—æ³•ã€‚&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%93%8D%E5%BA%94%E6%97%B6%E9%97%B4%E4%BC%98%E5%85%88%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E5%99%A8.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
åˆ†ä¸ºä»¥ä¸‹å››ä¸ªæµç¨‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åˆå§‹æ ‡è®°ï¼šä»…ä»…åªæ˜¯æ ‡è®°ä¸€ä¸‹ &lt;strong&gt;GC Roots èƒ½ç›´æ¥å…³è”åˆ°çš„å¯¹è±¡&lt;/strong&gt;ï¼Œé€Ÿåº¦å¾ˆå¿«ï¼Œéœ€è¦åœé¡¿ã€‚&lt;/li&gt;
&lt;li&gt;å¹¶å‘æ ‡è®°ï¼šè¿›è¡Œ &lt;strong&gt;GC Roots Tracing&lt;/strong&gt; çš„è¿‡ç¨‹ï¼Œå®ƒåœ¨æ•´ä¸ªå›æ”¶è¿‡ç¨‹ä¸­è€—æ—¶æœ€é•¿ï¼Œä¸éœ€è¦åœé¡¿ã€‚&lt;/li&gt;
&lt;li&gt;é‡æ–°æ ‡è®°ï¼šä¸ºäº†ä¿®æ­£å¹¶å‘æ ‡è®°æœŸé—´å› ç”¨æˆ·ç¨‹åºç»§ç»­è¿ä½œè€Œå¯¼è‡´æ ‡è®°äº§ç”Ÿ&lt;strong&gt;å˜åŠ¨&lt;/strong&gt;çš„é‚£ä¸€éƒ¨åˆ†å¯¹è±¡çš„æ ‡è®°è®°å½•ï¼Œéœ€è¦åœé¡¿ã€‚&lt;/li&gt;
&lt;li&gt;å¹¶å‘æ¸…é™¤ï¼šä¸éœ€è¦åœé¡¿ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­è€—æ—¶æœ€é•¿çš„å¹¶å‘æ ‡è®°å’Œå¹¶å‘æ¸…é™¤è¿‡ç¨‹ä¸­ï¼Œæ”¶é›†å™¨çº¿ç¨‹éƒ½å¯ä»¥ä¸ç”¨æˆ·çº¿ç¨‹ä¸€èµ·å·¥ä½œï¼Œä¸éœ€è¦è¿›è¡Œåœé¡¿ã€‚&lt;/p&gt;
&lt;p&gt;å…·æœ‰ä»¥ä¸‹ç¼ºç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ååé‡ä½&lt;/strong&gt;ï¼šä½åœé¡¿æ—¶é—´æ˜¯ä»¥ç‰ºç‰²ååé‡ä¸ºä»£ä»·çš„ï¼Œå¯¼è‡´ CPU åˆ©ç”¨ç‡ä¸å¤Ÿé«˜ã€‚&lt;/li&gt;
&lt;li&gt;æ— æ³•å¤„ç†&lt;strong&gt;æµ®åŠ¨åƒåœ¾&lt;/strong&gt;ï¼Œå¯èƒ½å‡ºç° Concurrent Mode Failureã€‚æµ®åŠ¨åƒåœ¾æ˜¯æŒ‡&lt;strong&gt;å¹¶å‘æ¸…é™¤&lt;/strong&gt;é˜¶æ®µç”±äºç”¨æˆ·çº¿ç¨‹ç»§ç»­è¿è¡Œè€Œäº§ç”Ÿçš„åƒåœ¾ï¼Œè¿™éƒ¨åˆ†åƒåœ¾åªèƒ½åˆ°ä¸‹ä¸€æ¬¡ GC æ—¶æ‰èƒ½è¿›è¡Œå›æ”¶ã€‚ç”±äºæµ®åŠ¨åƒåœ¾çš„å­˜åœ¨ï¼Œå› æ­¤éœ€è¦é¢„ç•™å‡ºä¸€éƒ¨åˆ†å†…å­˜ï¼Œæ„å‘³ç€ CMS æ”¶é›†ä¸èƒ½åƒå…¶å®ƒæ”¶é›†å™¨é‚£æ ·ç­‰å¾…è€å¹´ä»£å¿«æ»¡çš„æ—¶å€™å†å›æ”¶ã€‚å¦‚æœé¢„ç•™çš„å†…å­˜ä¸å¤Ÿå­˜æ”¾æµ®åŠ¨åƒåœ¾ï¼Œå°±ä¼šå‡ºç° Concurrent Mode Failureï¼Œè¿™æ—¶è™šæ‹Ÿæœºå°†ä¸´æ—¶å¯ç”¨ Serial Old æ¥æ›¿ä»£ CMSã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ ‡è®° - æ¸…é™¤ç®—æ³•å¯¼è‡´çš„ç©ºé—´ç¢ç‰‡&lt;/strong&gt;ï¼Œå¾€å¾€å‡ºç°è€å¹´ä»£ç©ºé—´å‰©ä½™ï¼Œä½†æ— æ³•æ‰¾åˆ°è¶³å¤Ÿå¤§è¿ç»­ç©ºé—´æ¥åˆ†é…å½“å‰å¯¹è±¡ï¼Œä¸å¾—ä¸æå‰è§¦å‘ä¸€æ¬¡ Full GCã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;g1-æ”¶é›†å™¨&#34;&gt;G1 æ”¶é›†å™¨&lt;/h2&gt;
&lt;p&gt;G1ï¼ˆGarbage-Firstï¼‰ï¼Œå®ƒæ˜¯ä¸€æ¬¾é¢å‘æœåŠ¡ç«¯åº”ç”¨çš„åƒåœ¾æ”¶é›†å™¨ï¼Œåœ¨å¤š CPU å’Œå¤§å†…å­˜çš„åœºæ™¯ä¸‹æœ‰å¾ˆå¥½çš„æ€§èƒ½ã€‚ HotSpot å¼€å‘å›¢é˜Ÿèµ‹äºˆå®ƒçš„ä½¿å‘½æ˜¯æœªæ¥å¯ä»¥æ›¿æ¢æ‰ CMS æ”¶é›†å™¨ã€‚&lt;/p&gt;
&lt;p&gt;å †è¢«åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼Œå…¶å®ƒæ”¶é›†å™¨è¿›è¡Œæ”¶é›†çš„èŒƒå›´éƒ½æ˜¯æ•´ä¸ªæ–°ç”Ÿä»£æˆ–è€…è€å¹´ä»£ï¼Œè€Œ G1 å¯ä»¥ç›´æ¥å¯¹æ–°ç”Ÿä»£å’Œè€å¹´ä»£ä¸€èµ·å›æ”¶ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;12&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/heap.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;G1 æŠŠå †åˆ’åˆ†æˆå¤šä¸ªå¤§å°ç›¸ç­‰çš„ç‹¬ç«‹åŒºåŸŸï¼ˆRegionï¼‰ï¼Œæ–°ç”Ÿä»£å’Œè€å¹´ä»£ä¸å†ç‰©ç†éš”ç¦»ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;13&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/G1.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;é€šè¿‡å¼•å…¥ Region çš„æ¦‚å¿µï¼Œä»è€Œå°†åŸæ¥çš„ä¸€æ•´å—å†…å­˜ç©ºé—´åˆ’åˆ†æˆå¤šä¸ªçš„å°ç©ºé—´ï¼Œä½¿å¾—&lt;strong&gt;æ¯ä¸ªå°ç©ºé—´å¯ä»¥å•ç‹¬è¿›è¡Œåƒåœ¾å›æ”¶&lt;/strong&gt;ã€‚è¿™ç§åˆ’åˆ†æ–¹æ³•å¸¦æ¥äº†å¾ˆå¤§çš„çµæ´»æ€§ï¼Œä½¿å¾—å¯é¢„æµ‹çš„åœé¡¿æ—¶é—´æ¨¡å‹æˆä¸ºå¯èƒ½ã€‚é€šè¿‡è®°å½•æ¯ä¸ª Region åƒåœ¾å›æ”¶æ—¶é—´ä»¥åŠå›æ”¶æ‰€è·å¾—çš„ç©ºé—´ï¼ˆè¿™ä¸¤ä¸ªå€¼æ˜¯é€šè¿‡è¿‡å»å›æ”¶çš„ç»éªŒè·å¾—ï¼‰ï¼Œå¹¶ç»´æŠ¤ä¸€ä¸ªä¼˜å…ˆåˆ—è¡¨ï¼Œæ¯æ¬¡æ ¹æ®å…è®¸çš„æ”¶é›†æ—¶é—´ï¼Œä¼˜å…ˆå›æ”¶ä»·å€¼æœ€å¤§çš„ Regionã€‚&lt;/p&gt;
&lt;p&gt;æ¯ä¸ª Region éƒ½æœ‰ä¸€ä¸ª Remembered Setï¼Œç”¨æ¥è®°å½•è¯¥ Region å¯¹è±¡çš„å¼•ç”¨å¯¹è±¡æ‰€åœ¨çš„ Regionã€‚é€šè¿‡ä½¿ç”¨ Remembered Setï¼Œåœ¨åšå¯è¾¾æ€§åˆ†æçš„æ—¶å€™å°±å¯ä»¥é¿å…å…¨å †æ‰«æ&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;14&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/G1_2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Card.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æ–°ç”Ÿä»£åƒåœ¾å›æ”¶ï¼šæ‰¾åˆ°æ ¹å¯¹è±¡ï¼Œæ²¿ç€å¼•ç”¨é“¾æ‰¾åˆ°å­˜æ´»å¯¹è±¡ï¼Œå­˜æ´»å¯¹è±¡è¿›è¡Œå¤åˆ¶åˆ°å¹¸å­˜åŒºã€‚è¦æ‰¾æ–°ç”Ÿä»£å¯¹è±¡çš„æ ¹å¯¹è±¡ï¼Œ&lt;strong&gt;æ ¹å¯¹è±¡æœ‰ä¸€éƒ¨åˆ†æ¥è‡ªäºè€å¹´ä»£&lt;/strong&gt;ï¼Œè€å¹´ä»£çš„å­˜æ´»å¯¹è±¡éå¸¸å¤šï¼Œå¦‚æœéå†è€å¹´ä»£æ‰¾æ ¹å¯¹è±¡æ•ˆç‡ä½ï¼Œå› æ­¤æŠŠ&lt;strong&gt;è€å¹´ä»£åŒºåŸŸå†è¿›è¡Œç»†åˆ†&lt;/strong&gt;ï¼Œåˆ†æˆä¸€ä¸ªä¸ª Cardï¼Œæ¯ä¸ª Card æ˜¯512KBï¼Œå¦‚æœè€å¹´ä»£å…¶ä¸­æœ‰ä¸€ä¸ª &lt;strong&gt;Card ä¸­çš„å¯¹è±¡å¼•ç”¨äº†æ–°ç”Ÿä»£çš„æŸä¸€ä¸ªå¯¹è±¡&lt;/strong&gt;ï¼Œå°±æŠŠè¿™ä¸ª &lt;strong&gt;Card æ ‡è®°ä¸ºè„&lt;/strong&gt;ï¼Œè¿™æ ·ä»¥åï¼Œåš GC Root éå†çš„æ—¶å€™å°±ä¸ç”¨å»æ‰¾æ•´ä¸ªè€å¹´ä»£äº†ï¼Œåªéœ€è¦å…³æ³¨é‚£äº›è„ Card å³å¯ï¼Œå‡å°‘æœç´¢èŒƒå›´ï¼Œæé«˜æ‰«ææ ¹å¯¹è±¡çš„æ•ˆç‡ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¡è¡¨ä¸ Remembered Set&lt;/li&gt;
&lt;li&gt;åœ¨å¼•ç”¨å˜æ›´æ—¶é€šè¿‡ post-write barrier + dirty card queue&lt;/li&gt;
&lt;li&gt;concurrent refinement threads æ›´æ–° Remembered Set&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/Card2.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ç²‰è‰²çš„ Card éƒ½æ˜¯&lt;strong&gt;è„å¡åŒº&lt;/strong&gt;ï¼ŒCard å†…æœ‰å¯¹è±¡æŒ‡å‘æ–°ç”Ÿä»£åŒºåŸŸçš„å¯¹è±¡ï¼Œæ–°ç”Ÿä»£ä¼šè®°å½• Remembered Setï¼šä»å¤–éƒ¨å¯¹æˆ‘çš„å¼•ç”¨ï¼Œå°†æ¥å¯¹æ–°ç”Ÿä»£ Eden è¿›è¡Œåƒåœ¾å›æ”¶æ—¶ï¼Œå°±å¯ä»¥å…ˆé€šè¿‡ Remembered Set çŸ¥é“å®ƒå¯¹åº”çš„å“ªäº›è„ Cardï¼Œç„¶ååœ¨åˆ°è¿™äº›è„å¡åŒºéå†å¯¹è±¡æ‰¾åˆ° GC Rootã€‚é€šè¿‡ post-write barrierï¼šå†™å±éšœåœ¨æ¯æ¬¡&lt;strong&gt;å¯¹è±¡çš„å¼•ç”¨å‘ç”Ÿå˜æ›´æ—¶ï¼Œå»æ›´æ–°è„ Card&lt;/strong&gt;ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯å¼‚æ­¥æ“ä½œï¼Œä¸ä¼šç«‹åˆ»å®Œæˆè„å¡çš„æ›´æ–°ï¼Œä¼šæŠŠæ›´æ–°æŒ‡ä»¤æ”¾åœ¨ dirty card queue è„å¡é˜Ÿåˆ—ä¸­ï¼Œå°†æ¥ç”±ä¸€ä¸ªçº¿ç¨‹å®Œæˆè„å¡æ›´æ–°çš„æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä¸è®¡ç®—ç»´æŠ¤ Remembered Set çš„æ“ä½œï¼ŒG1 æ”¶é›†å™¨çš„è¿ä½œå¤§è‡´å¯åˆ’åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åˆå§‹æ ‡è®°ï¼šæ‰¾åˆ°é‚£äº›æ ¹å¯¹è±¡ï¼Œæ ‡è®°æ ¹å¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;å¹¶å‘æ ‡è®°ï¼šä»æ ¹å¯¹è±¡å‡ºå‘ï¼Œé¡ºç€å¼•ç”¨é“¾æ‰¾åˆ°å…¶ä»–éåƒåœ¾å¯¹è±¡ï¼Œæ ‡è®°é‚£äº›å…¶ä»–éåƒåœ¾å¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;æœ€ç»ˆæ ‡è®°ï¼šä¸ºäº†ä¿®æ­£åœ¨å¹¶å‘æ ‡è®°æœŸé—´å› ç”¨æˆ·ç¨‹åºç»§ç»­è¿ä½œè€Œå¯¼è‡´æ ‡è®°äº§ç”Ÿå˜åŠ¨çš„é‚£ä¸€éƒ¨åˆ†æ ‡è®°è®°å½•ï¼Œè™šæ‹Ÿæœºå°†è¿™æ®µæ—¶é—´å¯¹è±¡å˜åŒ–è®°å½•åœ¨çº¿ç¨‹çš„ Remembered Set Logs é‡Œé¢ï¼Œæœ€ç»ˆæ ‡è®°é˜¶æ®µéœ€è¦æŠŠ Remembered Set Logs çš„æ•°æ®åˆå¹¶åˆ° Remembered Set ä¸­ã€‚è¿™é˜¶æ®µéœ€è¦åœé¡¿çº¿ç¨‹ï¼Œä½†æ˜¯å¯å¹¶è¡Œæ‰§è¡Œã€‚&lt;/li&gt;
&lt;li&gt;ç­›é€‰å›æ”¶ï¼šé¦–å…ˆå¯¹å„ä¸ª Region ä¸­çš„å›æ”¶ä»·å€¼å’Œæˆæœ¬è¿›è¡Œæ’åºï¼Œæ ¹æ®ç”¨æˆ·æ‰€æœŸæœ›çš„ GC åœé¡¿æ—¶é—´æ¥åˆ¶å®šå›æ”¶è®¡åˆ’ã€‚æ­¤é˜¶æ®µå…¶å®ä¹Ÿå¯ä»¥åšåˆ°ä¸ç”¨æˆ·ç¨‹åºä¸€èµ·å¹¶å‘æ‰§è¡Œï¼Œä½†æ˜¯å› ä¸ºåªå›æ”¶ä¸€éƒ¨åˆ† Regionï¼Œæ—¶é—´æ˜¯ç”¨æˆ·å¯æ§åˆ¶çš„ï¼Œè€Œä¸”åœé¡¿ç”¨æˆ·çº¿ç¨‹å°†å¤§å¹…åº¦æé«˜æ”¶é›†æ•ˆç‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å…·å¤‡å¦‚ä¸‹ç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç©ºé—´æ•´åˆï¼šæ•´ä½“æ¥çœ‹æ˜¯åŸºäºâ€œ&lt;strong&gt;æ ‡è®° - æ•´ç†&lt;/strong&gt;â€ç®—æ³•å®ç°çš„æ”¶é›†å™¨ï¼Œä»å±€éƒ¨ï¼ˆä¸¤ä¸ª Region ä¹‹é—´ï¼‰ä¸Šæ¥çœ‹æ˜¯åŸºäºâ€œ&lt;strong&gt;å¤åˆ¶&lt;/strong&gt;â€ç®—æ³•å®ç°çš„ï¼Œè¿™æ„å‘³ç€è¿è¡ŒæœŸé—´ä¸ä¼šäº§ç”Ÿå†…å­˜ç©ºé—´ç¢ç‰‡ã€‚&lt;/li&gt;
&lt;li&gt;å¯é¢„æµ‹çš„åœé¡¿ï¼šèƒ½è®©ä½¿ç”¨è€…æ˜ç¡®æŒ‡å®šåœ¨ä¸€ä¸ªé•¿åº¦ä¸º M æ¯«ç§’çš„æ—¶é—´ç‰‡æ®µå†…ï¼Œæ¶ˆè€—åœ¨ GC ä¸Šçš„æ—¶é—´ä¸å¾—è¶…è¿‡ N æ¯«ç§’&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;12-ç±»åŠ è½½çš„è¿‡ç¨‹&#34;&gt;12. ç±»åŠ è½½çš„è¿‡ç¨‹&lt;/h1&gt;
&lt;p&gt;åŒ…å«äº†åŠ è½½ã€éªŒè¯ã€å‡†å¤‡ã€è§£æå’Œåˆå§‹åŒ–è¿™ 5 ä¸ªé˜¶æ®µã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1. åŠ è½½&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åŠ è½½æ˜¯ç±»åŠ è½½çš„ä¸€ä¸ªé˜¶æ®µï¼Œæ³¨æ„ä¸è¦æ··æ·†ã€‚&lt;/p&gt;
&lt;p&gt;åŠ è½½è¿‡ç¨‹å®Œæˆä»¥ä¸‹ä¸‰ä»¶äº‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ç±»çš„å®Œå…¨é™å®šåç§°è·å–å®šä¹‰è¯¥ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµã€‚&lt;/li&gt;
&lt;li&gt;å°†è¯¥å­—èŠ‚æµè¡¨ç¤ºçš„é™æ€å­˜å‚¨ç»“æ„è½¬æ¢ä¸ºæ–¹æ³•åŒºçš„è¿è¡Œæ—¶å­˜å‚¨ç»“æ„ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ªä»£è¡¨è¯¥ç±»çš„ Class å¯¹è±¡ï¼Œä½œä¸ºæ–¹æ³•åŒºä¸­è¯¥ç±»å„ç§æ•°æ®çš„è®¿é—®å…¥å£ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å…¶ä¸­äºŒè¿›åˆ¶å­—èŠ‚æµå¯ä»¥ä»ä»¥ä¸‹æ–¹å¼ä¸­è·å–ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä» ZIP åŒ…è¯»å–ï¼Œæˆä¸º JARã€EARã€WAR æ ¼å¼çš„åŸºç¡€ã€‚&lt;/li&gt;
&lt;li&gt;ä»ç½‘ç»œä¸­è·å–ï¼Œæœ€å…¸å‹çš„åº”ç”¨æ˜¯ Appletã€‚&lt;/li&gt;
&lt;li&gt;è¿è¡Œæ—¶è®¡ç®—ç”Ÿæˆï¼Œä¾‹å¦‚åŠ¨æ€ä»£ç†æŠ€æœ¯ï¼Œåœ¨ java.lang.reflflect.Proxy ä½¿ç”¨ ProxyGenerator.generateProxyClass çš„ä»£ç†ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµã€‚&lt;/li&gt;
&lt;li&gt;ç”±å…¶ä»–æ–‡ä»¶ç”Ÿæˆï¼Œä¾‹å¦‚ç”± JSP æ–‡ä»¶ç”Ÿæˆå¯¹åº”çš„ Class ç±»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;2. éªŒè¯&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç¡®ä¿ Class æ–‡ä»¶çš„å­—èŠ‚æµä¸­åŒ…å«çš„ä¿¡æ¯ç¬¦åˆå½“å‰è™šæ‹Ÿæœºçš„è¦æ±‚ï¼Œå¹¶ä¸”ä¸ä¼šå±å®³è™šæ‹Ÿæœºè‡ªèº«çš„å®‰å…¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3. å‡†å¤‡&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç±»å˜é‡æ˜¯è¢« static ä¿®é¥°çš„å˜é‡ï¼Œå‡†å¤‡é˜¶æ®µä¸ºç±»å˜é‡åˆ†é…å†…å­˜å¹¶è®¾ç½®åˆå§‹å€¼ï¼Œä½¿ç”¨çš„æ˜¯æ–¹æ³•åŒºçš„å†…å­˜ã€‚&lt;/p&gt;
&lt;p&gt;å®ä¾‹å˜é‡ä¸ä¼šåœ¨è¿™é˜¶æ®µåˆ†é…å†…å­˜ï¼Œå®ƒä¼šåœ¨å¯¹è±¡å®ä¾‹åŒ–æ—¶éšç€å¯¹è±¡ä¸€èµ·è¢«åˆ†é…åœ¨å †ä¸­ã€‚åº”è¯¥æ³¨æ„åˆ°ï¼Œå®ä¾‹åŒ–ä¸æ˜¯ç±»åŠ è½½çš„ä¸€ä¸ªè¿‡ç¨‹ï¼Œç±»åŠ è½½å‘ç”Ÿåœ¨æ‰€æœ‰å®ä¾‹åŒ–æ“ä½œä¹‹å‰ï¼Œå¹¶ä¸”ç±»åŠ è½½åªè¿›è¡Œä¸€æ¬¡ï¼Œå®ä¾‹åŒ–å¯ä»¥è¿›è¡Œå¤šæ¬¡ã€‚&lt;/p&gt;
&lt;p&gt;åˆå§‹å€¼ä¸€èˆ¬ä¸º 0 å€¼ï¼Œä¾‹å¦‚ä¸‹é¢çš„ç±»å˜é‡ value è¢«åˆå§‹åŒ–ä¸º 0 è€Œä¸æ˜¯ 123ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public static int value = 123; 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœç±»å˜é‡æ˜¯å¸¸é‡ï¼Œé‚£ä¹ˆå®ƒå°†åˆå§‹åŒ–ä¸ºè¡¨è¾¾å¼æ‰€å®šä¹‰çš„å€¼è€Œä¸æ˜¯ 0ã€‚ä¾‹å¦‚ä¸‹é¢çš„å¸¸é‡ value è¢«åˆå§‹åŒ–ä¸º 123 è€Œä¸æ˜¯ 0ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public static final int value = 123; 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;4. è§£æ&lt;/strong&gt;&lt;br&gt;
å°†å¸¸é‡æ± çš„ç¬¦å·å¼•ç”¨æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;å…¶ä¸­è§£æè¿‡ç¨‹åœ¨æŸäº›æƒ…å†µä¸‹å¯ä»¥åœ¨åˆå§‹åŒ–é˜¶æ®µä¹‹åå†å¼€å§‹ï¼Œè¿™æ˜¯ä¸ºäº†æ”¯æŒ Java çš„åŠ¨æ€ç»‘å®šã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;5. åˆå§‹åŒ–&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åˆå§‹åŒ–é˜¶æ®µæ‰çœŸæ­£å¼€å§‹æ‰§è¡Œç±»ä¸­å®šä¹‰çš„ Java ç¨‹åºä»£ç ã€‚åˆå§‹åŒ–é˜¶æ®µæ˜¯è™šæ‹Ÿæœºæ‰§è¡Œç±»æ„é€ å™¨ &lt;clinit&gt;() æ–¹æ³•çš„è¿‡ç¨‹ã€‚åœ¨å‡†å¤‡é˜¶æ®µï¼Œç±»å˜é‡å·²ç»èµ‹è¿‡ä¸€æ¬¡ç³»ç»Ÿè¦æ±‚çš„åˆå§‹å€¼ï¼Œè€Œåœ¨åˆå§‹åŒ–é˜¶æ®µï¼Œæ ¹æ®ç¨‹åºå‘˜é€šè¿‡ç¨‹åºåˆ¶å®šçš„ä¸»è§‚è®¡åˆ’å»åˆå§‹åŒ–ç±»å˜é‡å’Œå…¶å®ƒèµ„æºã€‚&lt;/p&gt;
&lt;p&gt;&lt;clinit&gt;() æ˜¯ç”±ç¼–è¯‘å™¨è‡ªåŠ¨æ”¶é›†ç±»ä¸­æ‰€æœ‰ç±»å˜é‡çš„èµ‹å€¼åŠ¨ä½œå’Œé™æ€è¯­å¥å—ä¸­çš„è¯­å¥åˆå¹¶äº§ç”Ÿçš„ï¼Œç¼–è¯‘å™¨æ”¶é›†çš„é¡ºåºç”±è¯­å¥åœ¨æºæ–‡ä»¶ä¸­å‡ºç°çš„é¡ºåºå†³å®šã€‚ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œé™æ€è¯­å¥å—åªèƒ½è®¿é—®åˆ°å®šä¹‰åœ¨å®ƒä¹‹å‰çš„ç±»å˜é‡ï¼Œå®šä¹‰åœ¨å®ƒä¹‹åçš„ç±»å˜é‡åªèƒ½èµ‹å€¼ï¼Œä¸èƒ½è®¿é—®ã€‚ä¾‹å¦‚ä»¥ä¸‹ä»£ç ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public class Test { 
    static { 
        i = 0; // ç»™å˜é‡èµ‹å€¼å¯ä»¥æ­£å¸¸ç¼–è¯‘é€šè¿‡ 
        System.out.print(i); // è¿™å¥ç¼–è¯‘å™¨ä¼šæç¤ºâ€œéæ³•å‘å‰å¼•ç”¨â€ 
    }
    static int i = 1; 
} 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç”±äºçˆ¶ç±»çš„ &lt;clinit&gt;() æ–¹æ³•å…ˆæ‰§è¡Œï¼Œä¹Ÿå°±æ„å‘³ç€çˆ¶ç±»ä¸­å®šä¹‰çš„é™æ€è¯­å¥å—çš„æ‰§è¡Œè¦ä¼˜å…ˆäºå­ç±»ã€‚ä¾‹å¦‚ä»¥ä¸‹ä»£ç ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;static class Parent { 
    public static int A = 1; 
    static { 
        A = 2; 
    } 
}
static class Sub extends Parent { 
    public static int B = A; 
}
public static void main(String[] args) { 
    System.out.println(Sub.B); // 2 
} 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ¥å£ä¸­ä¸å¯ä»¥ä½¿ç”¨é™æ€è¯­å¥å—ï¼Œä½†ä»ç„¶æœ‰ç±»å˜é‡åˆå§‹åŒ–çš„èµ‹å€¼æ“ä½œï¼Œå› æ­¤æ¥å£ä¸ç±»ä¸€æ ·éƒ½ä¼šç”Ÿæˆ &lt;clinit&gt;() æ–¹æ³•ã€‚ä½†æ¥å£ä¸ç±»ä¸åŒçš„æ˜¯ï¼Œæ‰§è¡Œæ¥å£çš„ &lt;clinit&gt;() æ–¹æ³•ä¸éœ€è¦å…ˆæ‰§è¡Œçˆ¶æ¥å£çš„ &lt;clinit&gt;() æ–¹æ³•ã€‚åªæœ‰å½“çˆ¶æ¥å£ä¸­å®šä¹‰çš„å˜é‡ä½¿&lt;br&gt;
ç”¨æ—¶ï¼Œçˆ¶æ¥å£æ‰ä¼šåˆå§‹åŒ–ã€‚å¦å¤–ï¼Œæ¥å£çš„å®ç°ç±»åœ¨åˆå§‹åŒ–æ—¶ä¹Ÿä¸€æ ·ä¸ä¼šæ‰§è¡Œæ¥å£çš„ &lt;clinit&gt;() æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;è™šæ‹Ÿæœºä¼šä¿è¯ä¸€ä¸ªç±»çš„ &lt;clinit&gt;() æ–¹æ³•åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹è¢«æ­£ç¡®çš„åŠ é”å’ŒåŒæ­¥ï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶åˆå§‹åŒ–ä¸€ä¸ªç±»ï¼Œåªä¼šæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œè¿™ä¸ªç±»çš„ &lt;clinit&gt;() æ–¹æ³•ï¼Œå…¶å®ƒçº¿ç¨‹éƒ½ä¼šé˜»å¡ç­‰å¾…ï¼Œç›´åˆ°æ´»åŠ¨çº¿ç¨‹æ‰§è¡Œ &lt;clinit&gt;() æ–¹æ³•å®Œæ¯•ã€‚å¦‚æœåœ¨ä¸€ ä¸ªç±»çš„ &lt;clinit&gt;() æ–¹æ³•ä¸­æœ‰è€—æ—¶çš„æ“ä½œï¼Œå°±å¯èƒ½é€ æˆå¤šä¸ªçº¿ç¨‹é˜»å¡ï¼Œåœ¨å®é™…è¿‡ç¨‹ä¸­æ­¤ç§é˜»å¡å¾ˆéšè”½ã€‚&lt;/p&gt;
&lt;h1 id=&#34;13-ç±»åˆå§‹åŒ–æ—¶æœº&#34;&gt;13. ç±»åˆå§‹åŒ–æ—¶æœº&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;1. ä¸»åŠ¨å¼•ç”¨&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è™šæ‹Ÿæœºè§„èŒƒä¸­å¹¶æ²¡æœ‰å¼ºåˆ¶çº¦æŸä½•æ—¶è¿›è¡ŒåŠ è½½ï¼Œä½†æ˜¯è§„èŒƒä¸¥æ ¼è§„å®šäº†æœ‰ä¸”åªæœ‰ä¸‹åˆ—äº”ç§æƒ…å†µå¿…é¡»å¯¹ç±»è¿›è¡Œåˆå§‹åŒ–ï¼ˆåŠ è½½ã€éªŒè¯ã€å‡†å¤‡éƒ½ä¼šéšä¹‹å‘ç”Ÿï¼‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é‡åˆ° newã€getstaticã€putstaticã€invokestatic è¿™å››æ¡å­—èŠ‚ç æŒ‡ä»¤æ—¶ï¼Œå¦‚æœç±»æ²¡æœ‰è¿›è¡Œè¿‡åˆå§‹åŒ–ï¼Œåˆ™å¿…é¡»å…ˆè§¦å‘å…¶åˆå§‹åŒ–ã€‚æœ€å¸¸è§çš„ç”Ÿæˆè¿™ 4 æ¡æŒ‡ä»¤çš„åœºæ™¯æ˜¯ï¼šä½¿ç”¨ new å…³é”®å­—å®ä¾‹åŒ–å¯¹è±¡çš„æ—¶å€™ï¼›è¯»å–æˆ–è®¾ç½®ä¸€ä¸ªç±»çš„é™æ€å­—æ®µï¼ˆè¢« fifinal ä¿®é¥°ã€å·²åœ¨ç¼–è¯‘æœŸæŠŠç»“æœæ”¾å…¥å¸¸é‡æ± çš„é™æ€å­—æ®µé™¤å¤–ï¼‰çš„æ—¶å€™ï¼›ä»¥åŠè°ƒç”¨ä¸€ä¸ªç±»çš„é™æ€æ–¹æ³•çš„æ—¶å€™ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ java.lang.reflflect åŒ…çš„æ–¹æ³•å¯¹ç±»è¿›è¡Œåå°„è°ƒç”¨çš„æ—¶å€™ï¼Œå¦‚æœç±»æ²¡æœ‰è¿›è¡Œåˆå§‹åŒ–ï¼Œåˆ™éœ€è¦å…ˆè§¦å‘å…¶åˆå§‹åŒ–ã€‚&lt;/li&gt;
&lt;li&gt;å½“åˆå§‹åŒ–ä¸€ä¸ªç±»çš„æ—¶å€™ï¼Œå¦‚æœå‘ç°å…¶çˆ¶ç±»è¿˜æ²¡æœ‰è¿›è¡Œè¿‡åˆå§‹åŒ–ï¼Œåˆ™éœ€è¦å…ˆè§¦å‘å…¶çˆ¶ç±»çš„åˆå§‹åŒ–ã€‚&lt;/li&gt;
&lt;li&gt;å½“è™šæ‹Ÿæœºå¯åŠ¨æ—¶ï¼Œç”¨æˆ·éœ€è¦æŒ‡å®šä¸€ä¸ªè¦æ‰§è¡Œçš„ä¸»ç±»ï¼ˆåŒ…å« main() æ–¹æ³•çš„é‚£ä¸ªç±»ï¼‰ï¼Œè™šæ‹Ÿæœºä¼šå…ˆåˆå§‹åŒ–è¿™ä¸ªä¸»ç±»ï¼›&lt;/li&gt;
&lt;li&gt;å½“ä½¿ç”¨ JDK 1.7 çš„åŠ¨æ€è¯­è¨€æ”¯æŒæ—¶ï¼Œå¦‚æœä¸€ä¸ª java.lang.invoke.MethodHandle å®ä¾‹æœ€åçš„è§£æç»“æœä¸º REF_getStatic, REF_putStatic, REF_invokeStatic çš„æ–¹æ³•å¥æŸ„ï¼Œå¹¶ä¸”è¿™ä¸ªæ–¹æ³•å¥æŸ„æ‰€å¯¹åº”çš„ç±»æ²¡æœ‰è¿›è¡Œè¿‡åˆå§‹åŒ–ï¼Œåˆ™éœ€è¦å…ˆè§¦å‘å…¶åˆå§‹åŒ–ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;2. è¢«åŠ¨å¼•ç”¨&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä»¥ä¸Š 5 ç§åœºæ™¯ä¸­çš„è¡Œä¸ºç§°ä¸ºå¯¹ä¸€ä¸ªç±»è¿›è¡Œä¸»åŠ¨å¼•ç”¨ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæ‰€æœ‰å¼•ç”¨ç±»çš„æ–¹å¼éƒ½ä¸ä¼šè§¦å‘åˆå§‹åŒ–ï¼Œç§°ä¸ºè¢«åŠ¨å¼• ç”¨ã€‚è¢«åŠ¨å¼•ç”¨çš„å¸¸è§ä¾‹å­åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡å­ç±»å¼•ç”¨çˆ¶ç±»çš„é™æ€å­—æ®µï¼Œä¸ä¼šå¯¼è‡´å­ç±»åˆå§‹åŒ–ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;System.out.println(SubClass.value); // value å­—æ®µåœ¨ SuperClass ä¸­å®šä¹‰ 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€šè¿‡æ•°ç»„å®šä¹‰æ¥å¼•ç”¨ç±»ï¼Œä¸ä¼šè§¦å‘æ­¤ç±»çš„åˆå§‹åŒ–ã€‚è¯¥è¿‡ç¨‹ä¼šå¯¹æ•°ç»„ç±»è¿›è¡Œåˆå§‹åŒ–ï¼Œæ•°ç»„ç±»æ˜¯ä¸€ä¸ªç”±è™šæ‹Ÿæœºè‡ªåŠ¨ç”Ÿæˆçš„ã€ç›´æ¥ç»§æ‰¿è‡ª Object çš„å­ç±»ï¼Œå…¶ä¸­åŒ…å«äº†æ•°ç»„çš„å±æ€§å’Œæ–¹æ³•ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;SuperClass[] sca = new SuperClass[10]; 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¸¸é‡åœ¨ç¼–è¯‘é˜¶æ®µä¼šå­˜å…¥è°ƒç”¨ç±»çš„å¸¸é‡æ± ä¸­ï¼Œæœ¬è´¨ä¸Šå¹¶æ²¡æœ‰ç›´æ¥å¼•ç”¨åˆ°å®šä¹‰å¸¸é‡çš„ç±»ï¼Œå› æ­¤ä¸ä¼šè§¦å‘å®šä¹‰å¸¸é‡çš„ç±»çš„åˆå§‹åŒ–ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;System.out.println(ConstClass.HELLOWORLD);
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;14-java-è™šæ‹Ÿæœºä¸­æœ‰å“ªäº›ç±»åŠ è½½å™¨&#34;&gt;14. Java è™šæ‹Ÿæœºä¸­æœ‰å“ªäº›ç±»åŠ è½½å™¨ï¼Ÿ&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;&lt;strong&gt;åç§°&lt;/strong&gt;&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;&lt;strong&gt;åŠ è½½å“ªçš„ç±»&lt;/strong&gt;&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;&lt;strong&gt;è¯´æ˜&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Bootstrap ClassLoaderï¼ˆå¯åŠ¨ç±»åŠ è½½å™¨ï¼‰&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;JAVA_HOME/jre/lib&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;æ— æ³•ç›´æ¥è®¿é—®&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Extension ClassLoaderï¼ˆæ‰©å±•ç±»åŠ è½½å™¨ï¼‰&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;JAVA_HOME/jre/lib/ext&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;ä¸Šçº§ä¸º Bootstrapï¼Œæ˜¾ç¤ºä¸º null&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Application ClassLoaderï¼ˆåº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ï¼‰&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;classpath&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;ä¸Šçº§ä¸º Extension&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è‡ªå®šä¹‰ç±»åŠ è½½å™¨&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è‡ªå®šä¹‰&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;ä¸Šçº§ä¸º Application&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;15-ä»€ä¹ˆæ˜¯åŒäº²å§”æ´¾æ¨¡å‹&#34;&gt;15. ä»€ä¹ˆæ˜¯åŒäº²å§”æ´¾æ¨¡å‹ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;å¦‚æœä¸€ä¸ªç±»åŠ è½½å™¨æ”¶åˆ°äº†ç±»åŠ è½½è¯·æ±‚ï¼Œå®ƒé¦–å…ˆä¸ä¼šè‡ªå·±å»å°è¯•åŠ è½½è¿™ä¸ªç±»ï¼Œè€Œæ˜¯æŠŠç±»åŠ è½½çš„è¯·æ±‚å§”æ´¾ç»™çˆ¶ç±»åŠ è½½å™¨å»å®Œæˆï¼Œæ¯ä¸€å±‚æ¬¡çš„ç±»åŠ è½½å™¨éƒ½æ˜¯å¦‚æ­¤ï¼Œå› æ­¤æ‰€æœ‰çš„åŠ è½½è¯·æ±‚æœ€ç»ˆéƒ½ä¼šä¼ é€åˆ°é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨ä¸­ï¼Œåªæœ‰å½“çˆ¶ç±»æ— æ³•å¤„ç†è¿™ä¸ªåŠ è½½è¯·æ±‚ï¼ˆå®ƒçš„æœç´¢èŒƒå›´ä¸­æ²¡æœ‰æ‰¾åˆ°æ‰€éœ€çš„ç±»ï¼‰æ—¶ï¼Œå­åŠ è½½å™¨æ‰ä¼šå°è¯•è‡ªå·±å»åŠ è½½ã€‚&lt;/p&gt;
&lt;h1 id=&#34;16-ä½¿ç”¨åŒäº²å§”æ´¾æ¨¡å‹æœ‰ä»€ä¹ˆå¥½å¤„&#34;&gt;16. ä½¿ç”¨åŒäº²å§”æ´¾æ¨¡å‹æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;åŒäº²å§”æ´¾æ¨¡å‹ä¿è¯äº† Java ç¨‹åºçš„ç¨³å®šè¿è¡Œï¼Œå¯ä»¥&lt;strong&gt;é¿å…ç±»çš„é‡å¤åŠ è½½&lt;/strong&gt;ï¼ˆJVM åŒºåˆ†ç±»çš„æ–¹å¼ä¸ä»…ä»…æ ¹æ®ç±»åï¼Œç›¸åŒçš„ç±»æ–‡ä»¶è¢«ä¸åŒçš„ç±»åŠ è½½å™¨åŠ è½½äº§ç”Ÿçš„æ˜¯ä¸¤ä¸ªä¸åŒçš„ç±»ï¼‰ï¼Œä¹Ÿ&lt;strong&gt;ä¿è¯äº† Java çš„æ ¸å¿ƒ API ä¸è¢«ç¯¡æ”¹&lt;/strong&gt;ã€‚å¦‚æœæ²¡æœ‰ä½¿ç”¨åŒäº²å§”æ´¾æ¨¡å‹ï¼Œè€Œæ˜¯æ¯ä¸ªç±»åŠ è½½å™¨åŠ è½½è‡ªå·±çš„è¯å°±ä¼šå‡ºç°ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚æˆ‘ä»¬ç¼–å†™ä¸€ä¸ª java.lang.Object ç±»çš„è¯ï¼Œé‚£ä¹ˆç¨‹åºè¿è¡Œçš„æ—¶å€™ï¼Œç³»ç»Ÿå°±ä¼šå‡ºç°å¤šä¸ªä¸åŒçš„ Object ç±»ã€‚&lt;/p&gt;
&lt;h1 id=&#34;17-å†…å­˜åˆ†é…ç­–ç•¥&#34;&gt;17. å†…å­˜åˆ†é…ç­–ç•¥&lt;/h1&gt;
&lt;h2 id=&#34;å¯¹è±¡ä¼˜å…ˆåœ¨-eden-åˆ†é…&#34;&gt;å¯¹è±¡ä¼˜å…ˆåœ¨ Eden åˆ†é…&lt;/h2&gt;
&lt;p&gt;å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¯¹è±¡åœ¨æ–°ç”Ÿä»£ Eden ä¸Šåˆ†é…ï¼Œå½“ Eden ç©ºé—´ä¸è¶³æ—¶ï¼Œè§¦å‘ Minor GCã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£&#34;&gt;å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£&lt;/h2&gt;
&lt;p&gt;å¤§å¯¹è±¡æ˜¯æŒ‡éœ€è¦è¿ç»­å†…å­˜ç©ºé—´çš„å¯¹è±¡ï¼Œæœ€å…¸å‹çš„å¤§å¯¹è±¡æ˜¯é‚£ç§å¾ˆé•¿çš„å­—ç¬¦ä¸²ä»¥åŠæ•°ç»„ã€‚&lt;br&gt;
ç»å¸¸å‡ºç°å¤§å¯¹è±¡ä¼šæå‰è§¦å‘åƒåœ¾æ”¶é›†ä»¥è·å–è¶³å¤Ÿçš„è¿ç»­ç©ºé—´åˆ†é…ç»™å¤§å¯¹è±¡ã€‚&lt;br&gt;
-XX:PretenureSizeThresholdï¼Œå¤§äºæ­¤å€¼çš„å¯¹è±¡ç›´æ¥åœ¨è€å¹´ä»£åˆ†é…ï¼Œé¿å…åœ¨ Eden å’Œ Survivor ä¹‹é—´çš„å¤§é‡å†…å­˜å¤åˆ¶ã€‚&lt;/p&gt;
&lt;h2 id=&#34;é•¿æœŸå­˜æ´»çš„å¯¹è±¡è¿›å…¥è€å¹´ä»£&#34;&gt;é•¿æœŸå­˜æ´»çš„å¯¹è±¡è¿›å…¥è€å¹´ä»£&lt;/h2&gt;
&lt;p&gt;ä¸ºå¯¹è±¡å®šä¹‰å¹´é¾„è®¡æ•°å™¨ï¼Œå¯¹è±¡åœ¨ Eden å‡ºç”Ÿå¹¶ç»è¿‡ Minor GC ä¾ç„¶å­˜æ´»ï¼Œå°†ç§»åŠ¨åˆ° Survivor ä¸­ï¼Œå¹´é¾„å°±å¢åŠ  1 å²ï¼Œå¢åŠ åˆ°ä¸€å®šå¹´é¾„åˆ™ç§»åŠ¨åˆ°è€å¹´ä»£ä¸­ã€‚&lt;br&gt;
-XX:MaxTenuringThreshold ç”¨æ¥å®šä¹‰å¹´é¾„çš„é˜ˆå€¼ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åŠ¨æ€å¯¹è±¡å¹´é¾„ä¸åˆ¤å®š&#34;&gt;åŠ¨æ€å¯¹è±¡å¹´é¾„ä¸åˆ¤å®š&lt;/h2&gt;
&lt;p&gt;è™šæ‹Ÿæœºå¹¶ä¸æ˜¯æ°¸è¿œè¦æ±‚å¯¹è±¡çš„å¹´é¾„å¿…é¡»è¾¾åˆ° MaxTenuringThreshold æ‰èƒ½æ™‹å‡è€å¹´ä»£ï¼Œå¦‚æœåœ¨ Survivor ä¸­ç›¸åŒå¹´é¾„æ‰€æœ‰å¯¹è±¡å¤§å°çš„æ€»å’Œå¤§äº Survivor ç©ºé—´çš„ä¸€åŠï¼Œåˆ™å¹´é¾„å¤§äºæˆ–ç­‰äºè¯¥å¹´é¾„çš„å¯¹è±¡å¯ä»¥ç›´æ¥è¿›å…¥è€å¹´ä»£ï¼Œæ— éœ€ç­‰åˆ°MaxTenuringThreshold ä¸­è¦æ±‚çš„å¹´é¾„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç©ºé—´åˆ†é…æ‹…ä¿&#34;&gt;ç©ºé—´åˆ†é…æ‹…ä¿&lt;/h2&gt;
&lt;p&gt;åœ¨å‘ç”Ÿ Minor GC ä¹‹å‰ï¼Œè™šæ‹Ÿæœºå…ˆæ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºæ–°ç”Ÿä»£æ‰€æœ‰å¯¹è±¡æ€»ç©ºé—´ï¼Œå¦‚æœæ¡ä»¶æˆç«‹çš„è¯ï¼Œé‚£ä¹ˆ Minor GC å¯ä»¥ç¡®è®¤æ˜¯å®‰å…¨çš„ã€‚&lt;br&gt;
å¦‚æœä¸æˆç«‹çš„è¯è™šæ‹Ÿæœºä¼šæŸ¥çœ‹ HandlePromotionFailure çš„å€¼æ˜¯å¦å…è®¸æ‹…ä¿å¤±è´¥ï¼Œå¦‚æœå…è®¸é‚£ä¹ˆå°±ä¼šç»§ç»­æ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºå†æ¬¡æ™‹å‡åˆ°è€å¹´ä»£å¯¹è±¡çš„å¹³å‡å¤§å°ï¼Œå¦‚æœå¤§äºï¼Œå°†å°è¯•ç€è¿›è¡Œä¸€æ¬¡ Minor GCï¼›å¦‚æœå°äºï¼Œæˆ–è€… HandlePromotionFailure çš„å€¼ä¸å…è®¸å†’é™©ï¼Œé‚£ä¹ˆå°±è¦è¿›è¡Œä¸€æ¬¡ Full GCã€‚&lt;/p&gt;
&lt;h1 id=&#34;18-è¯´ä¸€ä¸‹-java-å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹&#34;&gt;18. è¯´ä¸€ä¸‹ Java å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹&lt;/h1&gt;
&lt;p&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/java%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%88%9B%E5%BB%BA%E8%BF%87%E7%A8%8B.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
â‘  &lt;strong&gt;ç±»åŠ è½½æ£€æŸ¥&lt;/strong&gt;ï¼šè™šæ‹Ÿæœºé‡åˆ°ä¸€æ¡ new æŒ‡ä»¤æ—¶ï¼Œé¦–å…ˆå°†å»æ£€æŸ¥è¿™ä¸ªæŒ‡ä»¤çš„å‚æ•°æ˜¯å¦èƒ½åœ¨å¸¸é‡æ± ä¸­å®šä½åˆ°è¿™ä¸ªç±»çš„ç¬¦å·å¼•ç”¨ï¼Œå¹¶ä¸”æ£€æŸ¥è¿™ä¸ªç¬¦å·å¼•ç”¨ä»£è¡¨çš„ç±»æ˜¯å¦å·²è¢«åŠ è½½è¿‡ã€è§£æå’Œåˆå§‹åŒ–è¿‡ã€‚å¦‚æœæ²¡æœ‰ï¼Œé‚£å¿…é¡»å…ˆæ‰§è¡Œç›¸åº”çš„ç±»åŠ è½½è¿‡ç¨‹ã€‚&lt;br&gt;
â‘¡ &lt;strong&gt;åˆ†é…å†…å­˜&lt;/strong&gt;ï¼šåœ¨ç±»åŠ è½½æ£€æŸ¥é€šè¿‡åï¼Œæ¥ä¸‹æ¥è™šæ‹Ÿæœºå°†ä¸ºæ–°ç”Ÿä»£å¯¹è±¡åˆ†é…å†…å­˜ã€‚å¯¹è±¡æ‰€éœ€çš„å†…å­˜å¤§å°åœ¨ç±»åŠ è½½å®Œæˆåä¾¿å¯ç¡®å®šï¼Œä¸ºå¯¹è±¡åˆ†é…ç©ºé—´çš„ä»»åŠ¡ç­‰åŒäºæŠŠä¸€å—ç¡®å®šå¤§å°çš„å†…å­˜ä» Java å †ä¸­åˆ’åˆ†å‡ºæ¥ã€‚åˆ†é…æ–¹å¼æœ‰ â€œæŒ‡é’ˆç¢°æ’â€ å’Œ â€œç©ºé—²åˆ—è¡¨â€ ä¸¤ç§ï¼Œé€‰æ‹©å“ªç§æ–¹å¼ç”± Java å †æ˜¯å¦è§„æ•´å†³å®šï¼Œè€Œ Java å †æ˜¯å¦è§„æ•´åˆç”±æ‰€é‡‡ç”¨çš„åƒåœ¾æ”¶é›†å™¨æ˜¯å¦å¸¦æœ‰å‹ç¼©æ•´ç†åŠŸèƒ½å†³å®šã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å†…å­˜åˆ†é…çš„ä¸¤ç§æ–¹å¼ï¼šé€‰æ‹©å“ªç§ç©ºé—´åˆ†é…æ–¹å¼ç”± Java å †æ˜¯å¦è§„æ•´å†³å®šï¼Œè€Œ Java å †æ˜¯å¦è§„æ•´åˆç”± GC æ”¶é›†å™¨çš„ç®—æ³•æ˜¯ â€œæ ‡è®°-æ¸…é™¤â€ï¼Œè¿˜æ˜¯â€œæ ‡è®°-æ•´ç†â€/ &amp;quot;å¤åˆ¶&amp;quot;ã€‚&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%96%B9%E5%BC%8F.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å†…å­˜åˆ†é…å¹¶å‘é—®é¢˜ï¼šåœ¨åˆ›å»ºå¯¹è±¡çš„æ—¶å€™æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„é—®é¢˜ï¼Œå°±æ˜¯çº¿ç¨‹å®‰å…¨ï¼Œå› ä¸ºåœ¨å®é™…å¼€å‘è¿‡ç¨‹ä¸­ï¼Œåˆ›å»ºå¯¹è±¡æ˜¯å¾ˆé¢‘ç¹çš„äº‹æƒ…ï¼Œä½œä¸ºè™šæ‹Ÿæœºæ¥è¯´ï¼Œå¿…é¡»è¦ä¿è¯çº¿ç¨‹æ˜¯å®‰å…¨çš„ï¼Œé€šå¸¸æ¥è®²ï¼Œè™šæ‹Ÿæœºé‡‡ç”¨ä¸¤ç§æ–¹å¼æ¥ä¿è¯çº¿ç¨‹å®‰å…¨ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;CAS+å¤±è´¥é‡è¯•ï¼šCAS æ˜¯ä¹è§‚é”çš„ä¸€ç§å®ç°æ–¹å¼ã€‚æ‰€è°“ä¹è§‚é”å°±æ˜¯ï¼Œæ¯æ¬¡ä¸åŠ é”è€Œæ˜¯å‡è®¾æ²¡æœ‰å†²çªè€Œå»å®ŒæˆæŸé¡¹æ“ä½œï¼Œå¦‚æœå› ä¸ºå†²çªé‡è¯•å°±å¤±è´¥ï¼Œç›´åˆ°æˆåŠŸä¸ºæ­¢ã€‚è™šæ‹Ÿæœºé‡‡ç”¨ CAS é…ä¸Šå¤±è´¥é‡è¯•çš„æ–¹å¼æ¥ä¿è¯æ›´æ–°æ“ä½œçš„åŸå­æ€§ã€‚&lt;/li&gt;
&lt;li&gt;TLABï¼šä¸ºæ¯ä¸ªçº¿ç¨‹é¢„å…ˆåœ¨ Eden åŒºåˆ†é…ä¸€å—å†…å­˜ï¼ŒJVM åœ¨ç»™çº¿ç¨‹ä¸­çš„å¯¹è±¡åˆ†é…å†…å­˜æ—¶ï¼Œé¦–å…ˆåœ¨ TLAB åˆ†é…ï¼Œå½“å¯¹è±¡å¤§äº TLAB ä¸­çš„å‰©ä½™å†…å­˜æˆ– TLAB çš„å†…å­˜å·²ç”¨å°½æ—¶ï¼Œå†é‡‡ç”¨ä¸Šè¿°çš„ CAS è¿›è¡Œå†…å­˜åˆ†é…ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;â‘¢ &lt;strong&gt;åˆå§‹åŒ–é›¶å€¼&lt;/strong&gt;ï¼šå†…å­˜åˆ†é…å®Œæˆåï¼Œè™šæ‹Ÿæœºéœ€è¦å°†åˆ†é…åˆ°çš„å†…å­˜ç©ºé—´éƒ½åˆå§‹åŒ–ä¸ºé›¶å€¼ï¼ˆä¸åŒ…æ‹¬å¯¹è±¡å¤´ï¼‰ï¼Œè¿™ä¸€æ­¥æ“ä½œä¿è¯äº†å¯¹è±¡çš„å®ä¾‹å­—æ®µåœ¨ Java ä»£ç ä¸­å¯ä»¥ä¸èµ‹åˆå§‹å€¼å°±ç›´æ¥ä½¿ç”¨ï¼Œç¨‹åºèƒ½è®¿é—®åˆ°è¿™äº›å­—æ®µçš„æ•°æ®ç±»å‹æ‰€å¯¹åº”çš„é›¶å€¼ã€‚&lt;br&gt;
â‘£ &lt;strong&gt;è®¾ç½®å¯¹è±¡å¤´&lt;/strong&gt;ï¼šåˆå§‹åŒ–é›¶å€¼å®Œæˆä¹‹åï¼Œè™šæ‹Ÿæœºè¦å¯¹å¯¹è±¡è¿›è¡Œå¿…è¦çš„è®¾ç½®ï¼Œä¾‹å¦‚è¿™ä¸ªå¯¹è±¡æ˜¯é‚£ä¸ªç±»çš„å®ä¾‹ã€å¦‚ä½•æ‰èƒ½æ‰¾åˆ°ç±»çš„å…ƒæ•°æ®ä¿¡æ¯ã€å¯¹è±¡çš„å“ˆå¸Œç ã€å¯¹è±¡çš„ GC åˆ†ä»£å¹´é¾„ç­‰ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯å­˜æ”¾åœ¨å¯¹è±¡å¤´ä¸­ã€‚å¦å¤–ï¼Œæ ¹æ®è™šæ‹Ÿæœºå½“å‰è¿è¡ŒçŠ¶æ€çš„ä¸åŒï¼Œå¦‚æ˜¯å¦å¯ç”¨åå‘é”ç­‰ï¼Œå¯¹è±¡å¤´ä¼šæœ‰ä¸åŒçš„è®¾ç½®æ–¹å¼ã€‚&lt;br&gt;
â‘¤ &lt;strong&gt;æ‰§è¡Œ init æ–¹æ³•&lt;/strong&gt;ï¼šåœ¨ä¸Šé¢å·¥ä½œéƒ½å®Œæˆä¹‹åï¼Œä»è™šæ‹Ÿæœºçš„è§†è§’æ¥çœ‹ï¼Œä¸€ä¸ªæ–°çš„å¯¹è±¡å·²ç»äº§ç”Ÿäº†ï¼Œä½†ä»Javaç¨‹åºçš„è§†è§’æ¥çœ‹ï¼Œå¯¹è±¡åˆ›å»ºæ‰åˆšå¼€å§‹ï¼Œ&amp;lt; init &amp;gt;æ–¹æ³•è¿˜æ²¡æœ‰æ‰§è¡Œï¼Œæ‰€æœ‰çš„å­—æ®µéƒ½è¿˜ä¸ºé›¶ã€‚æ‰€ä»¥ä¸€èˆ¬æ¥è¯´ï¼Œæ‰§è¡ŒnewæŒ‡ä»¤ä¹‹åä¼šæ¥ç€æ‰§è¡Œ&amp;lt; init &amp;gt;æ–¹æ³•ï¼ŒæŠŠå¯¹è±¡æŒ‰ç…§ç¨‹åºå‘˜çš„æ„æ„¿è¿›è¡Œåˆå§‹åŒ–ï¼Œè¿™æ ·ä¸€ä¸ªçœŸæ­£å¯ç”¨çš„å¯¹è±¡æ‰ç®—å®Œå…¨äº§ç”Ÿå‡ºæ¥ã€‚&lt;/p&gt;
">é¢è¯•é¢˜ç³»åˆ— â€”â€” JVM</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/mian-shi-ti-xi-lie-java-ji-he/"" data-c="
          &lt;h1 id=&#34;1-è¯´ä¸€è¯´-list-set-map-ä¸‰è€…çš„åŒºåˆ«&#34;&gt;1. è¯´ä¸€è¯´ Listã€Setã€Map ä¸‰è€…çš„åŒºåˆ«&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;List&lt;/code&gt; æ˜¯å­˜å‚¨&lt;strong&gt;æœ‰åº&lt;/strong&gt;çš„é›†åˆ&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Set&lt;/code&gt; é›†åˆå…ƒç´ &lt;strong&gt;ä¸å¯é‡å¤&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Map&lt;/code&gt; æ˜¯å­˜å‚¨&lt;strong&gt;é”®å€¼å¯¹&lt;/strong&gt;çš„é›†åˆ&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;2-arraylist-ä¸-linkedlist-çš„åŒºåˆ«&#34;&gt;2. ArrayList ä¸ LinkedList çš„åŒºåˆ«&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;åº•å±‚å­˜å‚¨æ•°æ®ç»“æ„ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ArrayList&lt;/code&gt; åˆå§‹å®¹é‡æ—¶ 10ï¼Œåº•å±‚æ˜¯&lt;strong&gt;Object æ•°ç»„&lt;/strong&gt;ï¼Œæ‰€ä»¥å…·æœ‰æ•°ç»„çš„ç‰¹æ€§ï¼Œå¯&lt;strong&gt;éšæœºè®¿é—®&lt;/strong&gt;ï¼Œå¹¶ä¸”å®ç°äº†&lt;code&gt;RandomAccess&lt;/code&gt; æ¥å£æ ‡è¯†æ”¯æŒéšæœºè®¿é—®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;LinkedList&lt;/code&gt; åº•å±‚æ˜¯&lt;strong&gt;åŒå‘é“¾è¡¨&lt;/strong&gt;ï¼Œæ‰€ä»¥å…·æœ‰é“¾è¡¨çš„ç‰¹æ€§ï¼Œ&lt;strong&gt;å¢åˆ é€Ÿåº¦å¿«&lt;/strong&gt;ï¼Œä½†æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ç»´æŠ¤å‰åä¸¤ä¸ªæŒ‡é’ˆï¼Œå ç”¨&lt;strong&gt;å­˜å‚¨ç©ºé—´è¾ƒå¤§&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;å¢åˆ æŸ¥æ•ˆç‡ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ArrayList&lt;/code&gt; å¦‚æœæ·»åŠ åˆ°&lt;strong&gt;æœ«å°¾&lt;/strong&gt;ï¼Œæ—¶é—´å¤æ‚åº¦&lt;strong&gt;O(1)&lt;/strong&gt;ï¼›å¦‚æœæ·»åŠ &lt;strong&gt;ä¸­é—´&lt;/strong&gt;åˆ°æŒ‡å®š i ä½ç½®ï¼Œéœ€è¦æŠŠ i ~ n ä½ç½®çš„å…ƒç´ ç»Ÿä¸€å‘åç§»åŠ¨ï¼Œæ—¶é—´å¤æ‚åº¦ &lt;strong&gt;O(n-i)&lt;/strong&gt;ã€‚å¦‚æœ&lt;strong&gt;æŒ‰ä¸‹æ ‡æŸ¥æ‰¾&lt;/strong&gt;ï¼Œæ—¶é—´å¤æ‚åº¦&lt;strong&gt;O(1)&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;LinkedList&lt;/code&gt; å¦‚æœæ·»åŠ &lt;strong&gt;æœ«å°¾&lt;/strong&gt;ï¼Œæ—¶é—´å¤æ‚åº¦ &lt;strong&gt;O(1)&lt;/strong&gt;ï¼Œå¦‚æœæ’å…¥åˆ°&lt;strong&gt;ä¸­é—´&lt;/strong&gt;ç¬¬ i ä¸ªä½ç½®ï¼Œéœ€è¦å…ˆæŸ¥æ‰¾åˆ°åˆ° i ä¸ªä½ç½®çš„å…ƒç´ ï¼ŒæŸ¥æ‰¾æ•ˆç‡ &lt;strong&gt;O(n)&lt;/strong&gt;ï¼Œç„¶åæ‰§è¡Œæ·»åŠ æ“ä½œï¼Œä¿®æ”¹æŒ‡é’ˆæŒ‡å‘ï¼Œå¤æ‚åº¦&lt;strong&gt;O(1)&lt;/strong&gt;ã€‚å¦‚æœ&lt;strong&gt;æŒ‰ä¸‹æ ‡æŸ¥æ‰¾&lt;/strong&gt;ï¼Œéœ€è¦åˆ¤æ–­ä¸‹æ ‡æ˜¯å¦å°äºå½“å‰ &lt;code&gt;size/2&lt;/code&gt; ï¼Œå¦‚æœå°äºåˆ™ä»å¤´å‘ä¸­é—´æŸ¥æ‰¾ï¼›å¦åˆ™ä»æœ«å°¾å‘ä¸­é—´æŸ¥æ‰¾ï¼Œæ—¶é—´å¤æ‚åº¦&lt;strong&gt;O(n)&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;LinkedList å‘ç¬¬ index ä½ç½®æ’å…¥å…ƒç´  element&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code&gt;public void add(int index, E element) {
    // æ£€æŸ¥ index æ˜¯å¦åˆç†
    checkPositionIndex(index);
    // æ’å…¥åˆ°é“¾è¡¨å°¾
    if (index == size)
        linkLast(element);
    // æ’å…¥åˆ°é“¾è¡¨ä¸­é—´
    else
        linkBefore(element, node(index));
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;Node&amp;lt;E&amp;gt; node(int index) {
    // assert isElementIndex(index);
    // å¦‚æœæ’å…¥ä½ç½®ä¸‹æ ‡ index &amp;lt; æ•´ä¸ªé“¾è¡¨é•¿åº¦çš„ä¸€åŠ
    if (index &amp;lt; (size &amp;gt;&amp;gt; 1)) {
        // ä»é“¾è¡¨å¤´å‘ä¸­é—´éå†ï¼Œç›´åˆ°æ‰¾åˆ°ç¬¬ index ä¸ªä½ç½®
        Node&amp;lt;E&amp;gt; x = first;
        for (int i = 0; i &amp;lt; index; i++)
            x = x.next;
        return x;
    } else {
        // ä»é“¾è¡¨å°¾å‘ä¸­é—´éå†
        Node&amp;lt;E&amp;gt; x = last;
        // ç›´åˆ°æ‰¾åˆ°ç¬¬ index ä¸ªå…ƒç´ 
        for (int i = size - 1; i &amp;gt; index; i--)
            x = x.prev;
        return x;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&#34;3-arraylist-æ‰©å®¹æœºåˆ¶&#34;&gt;3. ArrayList æ‰©å®¹æœºåˆ¶&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;public boolean add(E e) {
    // ç¡®ä¿æ•°ç»„å®¹é‡èƒ½å®¹çº³ä¸‹å½“å‰æ•°ç»„å†…å®é™…çš„å…ƒç´ ä¸ªæ•°+1
    ensureCapacityInternal(size + 1);  // Increments modCount!!
    elementData[size++] = e;
    return true;
}

private void ensureCapacityInternal(int minCapacity) {
    ensureExplicitCapacity(calculateCapacity(elementData, minCapacity));
}

private void ensureExplicitCapacity(int minCapacity) {
    modCount++;

    // overflow-conscious code
    // å¦‚æœå½“å‰æ•°ç»„éœ€è¦çš„æœ€å°å®¹é‡ &amp;gt; æ•°ç»„çš„é•¿åº¦ï¼Œåˆ™éœ€è¦æ‰©å®¹
    if (minCapacity - elementData.length &amp;gt; 0)
        grow(minCapacity);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;private void grow(int minCapacity) {
    // overflow-conscious code
    int oldCapacity = elementData.length;
    int newCapacity = oldCapacity + (oldCapacity &amp;gt;&amp;gt; 1);
    if (newCapacity - minCapacity &amp;lt; 0)
        newCapacity = minCapacity;
    if (newCapacity - MAX_ARRAY_SIZE &amp;gt; 0)
        newCapacity = hugeCapacity(minCapacity);
    // minCapacity is usually close to size, so this is a win:
    elementData = Arrays.copyOf(elementData, newCapacity);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç åŸºäº JDK1.8&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&#34;4-arraylist-å’Œ-vector-çš„åŒºåˆ«&#34;&gt;4. ArrayList å’Œ Vector çš„åŒºåˆ«&lt;/h1&gt;
&lt;p&gt;çº¿ç¨‹å®‰å…¨&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ArrayList&lt;/code&gt; çº¿ç¨‹ä¸å®‰å…¨&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Vector&lt;/code&gt; æ–¹æ³•éƒ½ä½¿ç”¨ &lt;code&gt;synchronized&lt;/code&gt; ä¿®é¥°ï¼Œæ‰€ä»¥çº¿ç¨‹å®‰å…¨ï¼ŒåŒæ—¶æ•ˆç‡ä¹Ÿä½ã€‚æ­£å› ä¸º &lt;code&gt;Vector&lt;/code&gt; æ•ˆç‡ä½ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸ä¼šä½¿ç”¨ï¼Œå¦‚æœæƒ³å®ç°åŒæ­¥ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code&gt;Collections.synchronizedList(new ArrayList&amp;lt;&amp;gt;());&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ‰©å®¹æœºåˆ¶ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ArrayList&lt;/code&gt; æ‰©å®¹åçš„å®¹é‡ä¸ºåŸæ¥çš„ 1.5 å€&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Vector&lt;/code&gt; æ‰©å®¹åçš„å®¹é‡ æ˜¯åŸæ¥çš„ 2 å€&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;5-hashmap-å’Œ-hashtableçš„åŒºåˆ«&#34;&gt;5. HashMap å’Œ Hashtableçš„åŒºåˆ«&lt;/h1&gt;
&lt;p&gt;çº¿ç¨‹å®‰å…¨ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;HashMap&lt;/code&gt; çº¿ç¨‹ä¸å®‰å…¨&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Hashtable&lt;/code&gt; çš„æ–¹æ³•ä½¿ç”¨ &lt;code&gt;synchronized&lt;/code&gt; ä¿®é¥°ï¼Œæ‰€ä»¥çº¿ç¨‹å®‰å…¨ï¼Œä¹Ÿæ˜¯æ­£å› ä¸ºç”¨ &lt;code&gt;synchronized&lt;/code&gt; ä¿®é¥°ï¼Œæ‰€ä»¥æ•ˆç‡è¾ƒä½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åˆå§‹å¤§å°æ‰©å®¹æœºåˆ¶ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;HashMap&lt;/code&gt; çš„é»˜è®¤åˆå§‹å®¹é‡ä¸º 16ï¼ˆ2 &amp;lt;&amp;lt; 4ï¼‰ï¼›å¦‚æœæŒ‡å®šäº†åˆå§‹å®¹é‡ï¼Œä¼šæŠŠå®ƒæ‰©å……ä¸º 2 çš„å¹‚æ¬¡ã€‚æ‰©å®¹åå®¹é‡ä¸ºåŸæ¥çš„ 2n&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Hashtable&lt;/code&gt; é»˜è®¤åˆå§‹å®¹é‡æ—¶ 11ï¼Œå¦‚æœæŒ‡å®šåˆå§‹å®¹é‡ï¼Œä½¿ç”¨åˆå§‹å®¹é‡ã€‚æ‰©å®¹åå®¹é‡ä¸ºåŸæ¥çš„ 2n+1&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ˜¯å¦å…è®¸ null é”®å€¼&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;HashMap&lt;/code&gt; å…è®¸ null é”®å€¼&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Hashtable&lt;/code&gt; ä¸å…è®¸ null é”®å€¼&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;6-hashmap-çš„-put-æ–¹æ³•çš„å…·ä½“æµç¨‹&#34;&gt;6. HashMap çš„ put æ–¹æ³•çš„å…·ä½“æµç¨‹&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;public V put(K key, V value) {
    return putVal(hash(key), key, value, false, true);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;/**
 * Implements Map.put and related methods
 *
 * @param hash hash for key
 * @param key the key
 * @param value the value to put
 * @param onlyIfAbsent if true, don&#39;t change existing value
 * @param evict if false, the table is in creation mode.
 * @return previous value, or null if none
 */
final V putVal(int hash, K key, V value, boolean onlyIfAbsent,
               boolean evict) {
    Node&amp;lt;K,V&amp;gt;[] tab; Node&amp;lt;K,V&amp;gt; p; int n, i;
    // å¦‚æœæ•°ç»„æ˜¯ç©ºçš„
    if ((tab = table) == null || (n = tab.length) == 0)
        // åˆå§‹åŒ–é›†åˆ
        n = (tab = resize()).length;
    // å¦‚æœæ•°ç»„ä¸­ç¬¬ i ä¸ªä½ç½®ä¸ºç©ºï¼Œç›´æ¥åˆ©ç”¨key-valueåˆ›å»ºèŠ‚ç‚¹å¹¶æ’å…¥
    if ((p = tab[i = (n - 1) &amp;amp; hash]) == null)
        tab[i] = newNode(hash, key, value, null);
    // å¦‚æœæ•°ç»„ä¸­ç¬¬ i ä¸ªä½ç½®ä¸ç©º
    else {
        Node&amp;lt;K,V&amp;gt; e; K k;
        // å¦‚æœå­˜åœ¨ key å€¼ç›¸åŒï¼Œåˆ™å…ˆå°†æ­¤èŠ‚ç‚¹è®°å½•ä¸‹æ¥ï¼ˆè¦†ç›– valueï¼‰
        if (p.hash == hash &amp;amp;&amp;amp;
            ((k = p.key) == key || (key != null &amp;amp;&amp;amp; key.equals(k))))
            e = p;
        // å¦‚æœæ˜¯çº¢é»‘æ ‘
        else if (p instanceof TreeNode)
            e = ((TreeNode&amp;lt;K,V&amp;gt;)p).putTreeVal(this, tab, hash, key, value);
        // å¦‚æœæ˜¯é“¾è¡¨
        else {
            for (int binCount = 0; ; ++binCount) {
                // ä¸æ–­å¾ªç¯æ‰¾åˆ°é“¾è¡¨çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°†æ–°èŠ‚ç‚¹æ·»åŠ åˆ°è¿™ä¸ªèŠ‚ç‚¹åé¢
                if ((e = p.next) == null) {
                    p.next = newNode(hash, key, value, null);
                    // å¦‚æœèŠ‚ç‚¹ä¸ªæ•° &amp;gt;= 7ï¼Œè½¬æˆçº¢é»‘æ ‘
                    if (binCount &amp;gt;= TREEIFY_THRESHOLD - 1) // -1 for 1st
                        treeifyBin(tab, hash);
                    break;
                }
                if (e.hash == hash &amp;amp;&amp;amp;
                    ((k = e.key) == key || (key != null &amp;amp;&amp;amp; key.equals(k))))
                    break;
                p = e;
            }
        }
        // å¦‚æœ key å€¼ç›¸åŒï¼Œè¦†ç›– value
        if (e != null) { // existing mapping for key
            // æš‚å­˜æ—§å€¼
            V oldValue = e.value;
            if (!onlyIfAbsent || oldValue == null)
                e.value = value;
            afterNodeAccess(e);
            // è¿”å›æ—§å€¼
            return oldValue;
        }
    }
    ++modCount;
    if (++size &amp;gt; threshold)
        resize();
    afterNodeInsertion(evict);
    return null;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/put.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ol&gt;
&lt;li&gt;å¦‚æœæ•£åˆ—è¡¨ä¸º nullï¼Œ&lt;code&gt;resize()&lt;/code&gt; åˆå§‹åŒ–æ•£åˆ—è¡¨&lt;/li&gt;
&lt;li&gt;æ²¡æœ‰å‘ç”Ÿç¢°æ’ï¼Œç›´æ¥æ·»åŠ å…ƒç´ åˆ°æ•£åˆ—è¡¨ä¸­&lt;/li&gt;
&lt;li&gt;å¦‚æœå‘ç”Ÿç¢°æ’ï¼Œåˆ¤æ–­æ—¶çº¢é»‘æ ‘è¿˜æ˜¯é“¾è¡¨ï¼Œç„¶åè°ƒç”¨ç›¸åº”çš„æ’å…¥æ–¹æ³•&lt;/li&gt;
&lt;li&gt;HashMap çš„ resize() æ‰©å®¹æ–¹æ³•&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;7-hashmap-çš„-resize-æ‰©å®¹æ–¹æ³•&#34;&gt;7. HashMap çš„ resize() æ‰©å®¹æ–¹æ³•&lt;/h1&gt;
&lt;p&gt;å¦‚æœå½“å‰size &amp;gt; é˜ˆå€¼ï¼ˆå®¹é‡ * è£…å¡«å› å­ï¼‰ï¼Œåˆ™æ‰©å®¹&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/resize.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h1 id=&#34;8-hashmap-å®¹é‡ä¸ºä»€ä¹ˆæ˜¯-2-çš„å¹‚æ¬¡&#34;&gt;8. HashMap å®¹é‡ä¸ºä»€ä¹ˆæ˜¯ 2 çš„å¹‚æ¬¡&lt;/h1&gt;
&lt;p&gt;å‡å°‘ &lt;code&gt;hash&lt;/code&gt; å†²çªï¼Œå› ä¸ºè¦ç”¨ &lt;code&gt;hash &amp;amp; (n-1)&lt;/code&gt; ç¡®å®šå…ƒç´ å­˜åœ¨æ•°ç»„ä¸­çš„ä¸‹æ ‡ä½ç½®ï¼Œå¦‚æœ n æ˜¯ 2 çš„å¹‚ï¼ˆ1000ï¼‰ï¼Œé‚£ä¹ˆ n-1 å¾—åˆ°çš„ç»“æœå°±å…¨ä¸º 1 ï¼ˆ10000 - 1 = 1111ï¼‰ï¼Œè¿™æ · &lt;code&gt;(n-1) &amp;amp; hash&lt;/code&gt; çš„å€¼å°±æ˜¯ hashã€‚å¦‚æœ n-1 ä¸­æœ‰æŸä½ä¸º 0ï¼Œé‚£ä¹ˆ 0 ä¸ä»»ä½•æ•° &amp;amp; ç»“æœéƒ½ä¸º0ï¼Œå¢åŠ äº†hash å†²çªçš„æ¦‚ç‡ã€‚&lt;/p&gt;
&lt;h1 id=&#34;9-hashmap-17-18-å¯¹æ¯”&#34;&gt;9. HashMap 1.7 1.8 å¯¹æ¯”&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;JDK1.7&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ•°æ®ç»“æ„ï¼šæ•°ç»„+é“¾è¡¨&lt;/p&gt;
&lt;p&gt;JDK1.7 hash æ–¹æ³•ï¼š9 æ¬¡æ‰°åŠ¨ï¼ˆ4 æ¬¡ä½è¿ç®—ï¼Œ5 æ¬¡å¼‚æˆ–è¿ç®—ï¼‰&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;static int hash(int h) {
    // This function ensures that hashCodes that differ only by
    // constant multiples at each bit position have a bounded
    // number of collisions (approximately 8 at default load factor).
    h ^= (h &amp;gt;&amp;gt;&amp;gt; 20) ^ (h &amp;gt;&amp;gt;&amp;gt; 12);
    return h ^ (h &amp;gt;&amp;gt;&amp;gt; 7) ^ (h &amp;gt;&amp;gt;&amp;gt; 4);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;JDK 1.8&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ•°æ®ç»“æ„ï¼šæ•°ç»„ + é“¾è¡¨ + çº¢é»‘æ ‘&lt;/p&gt;
&lt;p&gt;JDK 1.8 hash æ–¹æ³•ï¼š2 æ¬¡æ‰°åŠ¨ï¼ˆ1 æ¬¡ä½è¿ç®—ï¼Œ1 æ¬¡å¼‚æˆ–è¿ç®—ï¼‰&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;static final int hash(Object key) {
    int h;
    // key.hashCode()ï¼šè¿”å›æ•£åˆ—å€¼ä¹Ÿå°±æ˜¯hashcode
    // ^ ï¼šæŒ‰ä½å¼‚æˆ–
    // &amp;gt;&amp;gt;&amp;gt;:â½†ç¬¦å·å³ç§»ï¼Œå¿½ç•¥ç¬¦å·ä½ï¼Œç©ºä½éƒ½ä»¥0è¡¥â»¬
    return (key == null) ? 0 : (h = key.hashCode()) ^ (h &amp;gt;&amp;gt;&amp;gt; 16);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è´´ä¸€å¼ æ¯”è¾ƒè¯¦ç»†çš„å›¾ï¼š&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/hashmap.png&#34; alt=&#34;å›¾ç‰‡&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;å›¾ç‰‡æ¥æºï¼›&lt;a href=&#34;https://mp.weixin.qq.com/s?__biz=MzI4Njg5MDA5NA==&amp;amp;mid=2247485685&amp;amp;idx=2&amp;amp;sn=b393e444487c88e8c204821faddff370&amp;amp;chksm=ebd749f4dca0c0e257e15c656f4504f224456495ad78e8aeb9ea370214ebd4b5c455b15e6045&amp;amp;token=1948873548&amp;amp;lang=zh_CN#rd&#34;&gt;https://mp.weixin.qq.com/s?__biz=MzI4Njg5MDA5NA==&amp;amp;mid=2247485685&amp;amp;idx=2&amp;amp;sn=b393e444487c88e8c204821faddff370&amp;amp;chksm=ebd749f4dca0c0e257e15c656f4504f224456495ad78e8aeb9ea370214ebd4b5c455b15e6045&amp;amp;token=1948873548&amp;amp;lang=zh_CN#rd&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&#34;10-hashmap-æ˜¯æ€ä¹ˆè§£å†³å“ˆå¸Œå†²çªçš„&#34;&gt;10. HashMap æ˜¯æ€ä¹ˆè§£å†³å“ˆå¸Œå†²çªçš„&lt;/h1&gt;
&lt;p&gt;ä»€ä¹ˆæ˜¯å“ˆå¸Œå†²çªï¼šä¸¤ä¸ªä¸åŒçš„è¾“å…¥å€¼ï¼Œæ ¹æ®åŒä¸€æ•£åˆ—å‡½æ•°ï¼Œè®¡ç®—å‡ºç›¸åŒçš„æ•£åˆ—å€¼ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨&lt;strong&gt;æ‹‰é“¾æ³•&lt;/strong&gt;æ¥é“¾æ¥å…·æœ‰ç›¸åŒ hash å€¼çš„æ•°æ®&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨&lt;strong&gt;ä¸¤æ¬¡æ‰°åŠ¨å‡½æ•°&lt;/strong&gt;ï¼ˆhash å‡½æ•°ï¼‰æ¥é™ä½å“ˆå¸Œå†²çªçš„æ¦‚ç‡ï¼Œä½¿å¾—&lt;strong&gt;æ•°æ®åˆ†å¸ƒæ›´å‡åŒ€&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;å¼•å…¥&lt;strong&gt;çº¢é»‘æ ‘&lt;/strong&gt;é™ä½æŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;11-hashmap-17-18å¤šçº¿ç¨‹æ“ä½œå¯¼è‡´æ­»å¾ªç¯é—®é¢˜&#34;&gt;11. HashMap 1.7 1.8å¤šçº¿ç¨‹æ“ä½œå¯¼è‡´æ­»å¾ªç¯é—®é¢˜&lt;/h1&gt;
&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;a href=&#34;https://coolshell.cn/articles/9606.html&#34;&gt;https://coolshell.cn/articles/9606.html&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&#34;12-hashmap-çš„-key-å€¼è¦æ˜¯ä¸ºç±»å¯¹è±¡åˆ™è¯¥ç±»éœ€è¦æ»¡è¶³ä»€ä¹ˆæ¡ä»¶&#34;&gt;12. HashMap çš„ key å€¼è¦æ˜¯ä¸ºç±»å¯¹è±¡åˆ™è¯¥ç±»éœ€è¦æ»¡â¾œä»€ä¹ˆæ¡ä»¶ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;é‡å†™ hashCode() å’Œ equals() æ–¹æ³•ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Hashmap&lt;/code&gt; ä¸­æ”¾å…¥ç›¸åŒçš„ &lt;code&gt;key&lt;/code&gt;ï¼Œä¼šè¦†ç›– &lt;code&gt;value&lt;/code&gt; å€¼ï¼Œè€Œä¸æ˜¯é‡æ–°æ·»åŠ ä¸€ä¸ª &lt;code&gt;key-value&lt;/code&gt; å¯¹ï¼Œè¿™å°±è¦æ±‚æˆ‘ä»¬åˆ¤æ–­ &lt;code&gt;key&lt;/code&gt; æ˜¯å¦ç›¸åŒã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹ä¸º &lt;code&gt;HashMap&lt;/code&gt; çš„ &lt;code&gt;final V putVal(int hash, K key, V value, boolean onlyIfAbsent, boolean evict)&lt;/code&gt; æ–¹æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;if (p.hash == hash &amp;amp;&amp;amp;
    ((k = p.key) == key || (key != null &amp;amp;&amp;amp; key.equals(k))))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»æºç å¾—çŸ¥åˆ¤æ–­åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼šâ‘ åˆ¤æ–­ &lt;code&gt;key&lt;/code&gt; çš„ &lt;code&gt;hash&lt;/code&gt; å€¼æ˜¯å¦ç›¸åŒï¼Œè¿™å°±è¦æ±‚æˆ‘ä»¬é‡å†™ &lt;code&gt;hashCode()&lt;/code&gt; æ–¹æ³•ï¼›â‘¡ é€šè¿‡ &lt;code&gt;==&lt;/code&gt; åˆ¤æ–­ &lt;code&gt;key&lt;/code&gt; å¯¹è±¡å¼•ç”¨æ˜¯å¦ç›¸ç­‰ï¼›â‘¢ ä½¿ç”¨ &lt;code&gt;equals()&lt;/code&gt; åˆ¤æ–­å¯¹è±¡æ˜¯å¦ç›¸ç­‰ï¼Œè¿™å°±è¦æ±‚æˆ‘ä»¬é‡å†™ &lt;code&gt;equals()&lt;/code&gt; æ–¹æ³•ã€‚&lt;/p&gt;
&lt;h1 id=&#34;13-concurrenthashmap-çš„åº•å±‚å®ç°æ–¹å¼&#34;&gt;13. ConcurrentHashMap çš„åº•å±‚å®ç°æ–¹å¼&lt;/h1&gt;
&lt;p&gt;JDK1.7&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ•°æ®ç»“æ„ï¼šåˆ†æ®µæ•°ç»„ï¼ˆ&lt;code&gt;Segment&lt;/code&gt; ç»§æ‰¿äº† &lt;code&gt;ReentrantLock&lt;/code&gt;ï¼Œæ¯ä¸ªæ®µéƒ½æœ‰ä¸€ä¸ªé”ï¼‰ + é“¾è¡¨ï¼ˆ&lt;code&gt;HashEntry&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;çº¿ç¨‹å®‰å…¨ï¼šå¯¹æ•´ä¸ªæ¡¶æ•°ç»„è¿›è¡Œäº†åˆ†å‰²åˆ†æ®µï¼Œæ¯æŠŠé”åªé”ä½ä¸€&lt;strong&gt;æ®µ&lt;/strong&gt;ï¼Œå¤šçº¿ç¨‹è®¿é—®å…¶ä»–æ®µçš„æ•°æ®æ—¶ä¸ä¼šäº§ç”Ÿå†²çªã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;JDK1.8&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ•°æ®ç»“æ„ï¼šæ•°ç»„ + é“¾è¡¨ + çº¢é»‘æ ‘&lt;/li&gt;
&lt;li&gt;çº¿ç¨‹å®‰å…¨ï¼šéƒ¨åˆ†é”å®š + CASã€‚&lt;code&gt;synchronized&lt;/code&gt; åªé”å®š&lt;strong&gt;å½“å‰é“¾è¡¨æˆ–çº¢é»‘äºŒå‰æ ‘çš„é¦–èŠ‚ç‚¹&lt;/strong&gt;ï¼Œè¿™æ ·åªè¦ hash ä¸å†²çªï¼Œå°±ä¸ä¼šäº§ç”Ÿå¹¶å‘ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;14-concurrenthashmap-å’Œ-hashtable-çš„åŒºåˆ«&#34;&gt;14. ConcurrentHashMap å’Œ Hashtable çš„åŒºåˆ«&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Hashtable&lt;br&gt;
æ•°æ®ç»“æ„ï¼šæ•°ç»„ + é“¾è¡¨&lt;br&gt;
å®ç°çº¿ç¨‹å®‰å…¨ï¼šä¼šé”ä½æ•´ä¸ªæ•°ç»„ï¼ŒæŸä¸ªçº¿ç¨‹åœ¨è¿›è¡Œ put æ“ä½œæ—¶ï¼Œå…¶ä»–çº¿ç¨‹åªèƒ½é˜»å¡ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;JDK1.7 ConcurrentHashMap&lt;br&gt;
æ•°æ®ç»“æ„ï¼šåˆ†æ®µæ•°ç»„+é“¾è¡¨&lt;br&gt;
å®ç°çº¿ç¨‹å®‰å…¨ï¼šåˆ†æ®µé”&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;JDK1.8 ConcurrentHashMap&lt;br&gt;
æ•°æ®ç»“æ„ï¼šæ•°ç»„ + é“¾è¡¨ / çº¢é»‘æ ‘&lt;br&gt;
é€šè¿‡åœ¨éƒ¨åˆ†åŠ é”å’Œåˆ©ç”¨CASç®—æ³•æ¥å®ç°åŒæ­¥ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;15-å¦‚ä½•é€‰ç”¨é›†åˆ&#34;&gt;15. å¦‚ä½•é€‰ç”¨é›†åˆ&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœå­˜å‚¨é”®å€¼å¯¹ï¼Œé€‰ &lt;code&gt;Map&lt;/code&gt; æ¥å£ä¸‹çš„é›†åˆ
&lt;ul&gt;
&lt;li&gt;å¦‚æœéœ€è¦æ’åºï¼Œé€‰æ‹© &lt;code&gt;TreeMap&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;å¦‚æœä¸éœ€è¦æ’åºï¼Œä¼˜å…ˆé€‰æ‹© &lt;code&gt;HashMap&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;å¦‚æœéœ€è¦çº¿ç¨‹å®‰å…¨ï¼Œé€‰æ‹© &lt;code&gt;ConcurrentHashMap&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;åªéœ€è¦å­˜æ”¾å…ƒç´ å€¼æ—¶ï¼Œé€‰æ‹© &lt;code&gt;Collection&lt;/code&gt; æ¥å£ä¸‹çš„é›†åˆ
&lt;ul&gt;
&lt;li&gt;å¦‚æœéœ€è¦é¡ºåºæ”¾å–ï¼Œé€‰æ‹© &lt;code&gt;ArrayList&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;å¦‚æœéœ€è¦é¢‘ç¹å¢åˆ ï¼Œé€‰æ‹© &lt;code&gt;LinkedList&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;å¦‚æœéœ€è¦å…ƒç´ ä¸é‡å¤ä¸”æ’åºï¼Œé€‰æ‹© &lt;code&gt;TreeSet&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;å¦‚æœéœ€è¦å…ƒç´ ä¸é‡å¤ä½†æ— éœ€æ’åºï¼Œä¼˜å…ˆé€‰æ‹© &lt;code&gt;HashSet&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å‚è€ƒé“¾æ¥ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/ZhongFuCheng3y/3y&#34;&gt;https://github.com/ZhongFuCheng3y/3y&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/Snailclimb/JavaGuide&#34;&gt;https://github.com/Snailclimb/JavaGuide&lt;/a&gt;&lt;/p&gt;
">é¢è¯•é¢˜ç³»åˆ— â€”â€” Java é›†åˆ</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/zookeeper-mian-shi-ti/"" data-c="
          &lt;h1 id=&#34;1-è°ˆè°ˆä½ å¯¹-zookeeper-çš„è®¤è¯†&#34;&gt;1. è°ˆè°ˆä½ å¯¹ Zookeeper çš„è®¤è¯†&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;Zookeeper&lt;/code&gt; æ˜¯ä¸€ä¸ª&lt;strong&gt;åˆ†å¸ƒå¼åè°ƒæœåŠ¡&lt;/strong&gt;çš„å¼€æºæ¡†æ¶ã€‚ä¸»è¦ç”¨æ¥è§£å†³åˆ†å¸ƒå¼é›†ç¾¤ä¸­åº”ç”¨ç³»ç»Ÿçš„&lt;strong&gt;ä¸€è‡´æ€§&lt;/strong&gt;é—®é¢˜ï¼Œä¾‹å¦‚æ€æ ·é¿å…åŒæ—¶æ“ä½œåŒä¸€æ•°æ®é€ æˆè„è¯»çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;ZooKeeper&lt;/code&gt; æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„å°æ–‡ä»¶å­˜å‚¨ç³»ç»Ÿ&lt;/strong&gt;ã€‚æä¾›åŸºäºç±»ä¼¼äºæ–‡ä»¶ç³»ç»Ÿçš„ç›®å½•æ ‘æ–¹å¼çš„æ•°æ®å­˜å‚¨ï¼Œå¹¶ä¸”å¯ä»¥å¯¹æ ‘ä¸­çš„èŠ‚ç‚¹è¿›è¡Œæœ‰æ•ˆç®¡ç†ã€‚ä»è€Œç”¨æ¥ç»´æŠ¤å’Œç›‘æ§ä½ å­˜å‚¨çš„æ•°æ®çš„çŠ¶æ€å˜åŒ–ã€‚é€šè¿‡ç›‘æ§è¿™äº›æ•°æ®çŠ¶æ€çš„å˜åŒ–ï¼Œä»è€Œå¯ä»¥è¾¾åˆ°åŸºäºæ•°æ®çš„é›†ç¾¤ç®¡ç†ã€‚è¯¸å¦‚ï¼šç»Ÿä¸€å‘½åæœåŠ¡ã€åˆ†å¸ƒå¼é…ç½®ç®¡ç†ã€åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—ã€åˆ†å¸ƒå¼é”ã€åˆ†å¸ƒå¼åè°ƒç­‰åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;zookeeper-é›†ç¾¤è§’è‰²&#34;&gt;Zookeeper é›†ç¾¤è§’è‰²&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/zk%E9%9B%86%E7%BE%A4%E8%A7%92%E8%89%B2.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;leader&#34;&gt;Leader:&lt;/h3&gt;
&lt;p&gt;Zookeeper é›†ç¾¤å·¥ä½œçš„æ ¸å¿ƒ&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;äº‹åŠ¡è¯·æ±‚&lt;/strong&gt;ï¼ˆå†™æ“ä½œï¼‰çš„å”¯ä¸€è°ƒåº¦å’Œå¤„ç†è€…ï¼Œä¿è¯é›†ç¾¤äº‹åŠ¡å¤„ç†çš„é¡ºåºæ€§ï¼›&lt;/p&gt;
&lt;p&gt;é›†ç¾¤å†…éƒ¨å„ä¸ªæœåŠ¡å™¨çš„&lt;strong&gt;è°ƒåº¦è€…&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å¯¹äº createï¼ŒsetDataï¼Œdelete ç­‰æœ‰å†™æ“ä½œçš„è¯·æ±‚ï¼Œåˆ™éœ€è¦ç»Ÿä¸€è½¬å‘ç»™ leader å¤„ç†ï¼Œleader éœ€è¦å†³å®šç¼–å·ã€æ‰§è¡Œæ“ä½œï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºä¸€ä¸ª&lt;strong&gt;äº‹åŠ¡&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;follower&#34;&gt;Follower:&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;å¤„ç†å®¢æˆ·ç«¯éäº‹åŠ¡ï¼ˆè¯»æ“ä½œï¼‰è¯·æ±‚ï¼Œè½¬å‘äº‹åŠ¡è¯·æ±‚ç»™ Leaderï¼›&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å‚ä¸é›†ç¾¤ Leader é€‰ä¸¾æŠ•ç¥¨ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ­¤å¤–ï¼Œé’ˆå¯¹è®¿é—®é‡æ¯”è¾ƒå¤§çš„ zookeeper é›†ç¾¤ï¼Œè¿˜å¯æ–°å¢è§‚å¯Ÿè€…è§’è‰²ã€‚&lt;/p&gt;
&lt;h3 id=&#34;observer&#34;&gt;Observer:&lt;/h3&gt;
&lt;p&gt;è§‚å¯Ÿè€…è§’è‰²ï¼Œè§‚å¯Ÿ Zookeeper é›†ç¾¤çš„æœ€æ–°çŠ¶æ€å˜åŒ–å¹¶å°†è¿™äº›çŠ¶æ€åŒæ­¥è¿‡æ¥ï¼Œå…¶å¯¹äºéäº‹åŠ¡è¯·æ±‚å¯ä»¥è¿›è¡Œç‹¬ç«‹å¤„ç†ï¼Œå¯¹äºäº‹åŠ¡è¯·æ±‚ï¼Œåˆ™ä¼šè½¬å‘ç»™ Leader æœåŠ¡å™¨è¿›è¡Œå¤„ç†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸ä¼šå‚ä¸ä»»ä½•å½¢å¼çš„æŠ•ç¥¨&lt;/strong&gt;åªæä¾›éäº‹åŠ¡æœåŠ¡ï¼Œé€šå¸¸ç”¨äºåœ¨ä¸å½±å“é›†ç¾¤äº‹åŠ¡å¤„ç†èƒ½åŠ›çš„å‰æä¸‹æå‡é›†ç¾¤çš„éäº‹åŠ¡å¤„ç†èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;h1 id=&#34;2-zookeeper-ç‰¹æ€§&#34;&gt;2. ZooKeeper ç‰¹æ€§&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å…¨å±€æ•°æ®ä¸€è‡´&lt;/strong&gt;ï¼šé›†ç¾¤ä¸­æ¯ä¸ªæœåŠ¡å™¨ä¿å­˜ä¸€ä»½ç›¸åŒçš„æ•°æ®å‰¯æœ¬ï¼Œ&lt;code&gt;client&lt;/code&gt; æ— è®ºè¿æ¥åˆ°å“ªä¸ªæœåŠ¡å™¨ï¼Œå±•ç¤ºçš„æ•°æ®éƒ½æ˜¯ä¸€è‡´çš„ï¼Œè¿™æ˜¯æœ€é‡è¦çš„ç‰¹å¾ï¼›&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/zk%E5%85%A8%E5%B1%80%E4%B8%80%E8%87%B4%E6%80%A7.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯é æ€§&lt;/strong&gt;ï¼šå¦‚æœæ¶ˆæ¯ã€&lt;strong&gt;å¢ã€åˆ ã€æ”¹ã€æŸ¥&lt;/strong&gt;ã€‘è¢«å…¶ä¸­ä¸€å°æœåŠ¡å™¨æ¥å—ï¼Œé‚£ä¹ˆå°†è¢«æ‰€æœ‰çš„æœåŠ¡å™¨æ¥å—ã€‚&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/zk%E5%8F%AF%E9%9D%A0%E6%80%A7.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¡ºåºæ€§&lt;/strong&gt;ï¼šåŒ…æ‹¬å…¨å±€æœ‰åºå’Œååºä¸¤ç§ï¼šå…¨å±€æœ‰åºæ˜¯æŒ‡å¦‚æœåœ¨ä¸€å°æœåŠ¡å™¨ä¸Šæ¶ˆæ¯ a åœ¨æ¶ˆæ¯ b å‰å‘å¸ƒï¼Œåˆ™åœ¨æ‰€æœ‰ &lt;code&gt;Server&lt;/code&gt; ä¸Šæ¶ˆæ¯ a éƒ½å°†åœ¨æ¶ˆæ¯ b å‰è¢«å‘å¸ƒï¼›ååºæ˜¯æŒ‡å¦‚æœä¸€ä¸ªæ¶ˆæ¯ b åœ¨æ¶ˆæ¯ a åè¢«åŒä¸€ä¸ªå‘é€è€…å‘å¸ƒï¼Œa å¿…å°†æ’åœ¨ b å‰é¢ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®æ›´æ–°åŸå­æ€§&lt;/strong&gt;ï¼šä¸€æ¬¡æ•°æ®æ›´æ–°è¦ä¹ˆæˆåŠŸï¼ˆåŠæ•°ä»¥ä¸ŠèŠ‚ç‚¹æˆåŠŸï¼‰ï¼Œè¦ä¹ˆå¤±è´¥ï¼Œä¸å­˜åœ¨ä¸­é—´çŠ¶æ€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®æ—¶æ€§&lt;/strong&gt;ï¼š&lt;code&gt;Zookeeper&lt;/code&gt; ä¿è¯å®¢æˆ·ç«¯å°†åœ¨ä¸€ä¸ªæ—¶é—´é—´éš”èŒƒå›´å†…è·å¾—æœåŠ¡å™¨çš„æ›´æ–°ä¿¡æ¯ï¼Œæˆ–è€…æœåŠ¡å™¨å¤±æ•ˆçš„ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;3-zookeeper-æ•°æ®æ¨¡å‹&#34;&gt;3ï¼ ZooKeeper æ•°æ®æ¨¡å‹&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;ZooKeeper&lt;/code&gt; çš„æ•°æ®æ¨¡å‹ï¼Œåœ¨ç»“æ„ä¸Šå’Œæ ‡å‡†æ–‡ä»¶ç³»ç»Ÿçš„éå¸¸ç›¸ä¼¼ï¼Œæ‹¥æœ‰ä¸€ä¸ªå±‚æ¬¡çš„å‘½åç©ºé—´ï¼Œéƒ½æ˜¯é‡‡ç”¨&lt;strong&gt;æ ‘å½¢å±‚æ¬¡ç»“æ„&lt;/strong&gt;ï¼Œ&lt;code&gt;ZooKeeper&lt;/code&gt; æ ‘ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹è¢«ç§°ä¸ºâ€” &lt;strong&gt;&lt;code&gt;Znode&lt;/code&gt;&lt;/strong&gt;ã€‚å’Œæ–‡ä»¶ç³»ç»Ÿçš„ç›®å½•æ ‘ä¸€æ ·ï¼Œ&lt;code&gt;ZooKeeper&lt;/code&gt; æ ‘ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹å¯ä»¥æ‹¥æœ‰å­èŠ‚ç‚¹ã€‚ä½†ä¹Ÿæœ‰ä¸åŒä¹‹å¤„ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Znode&lt;/code&gt; å…¼å…·æ–‡ä»¶å’Œç›®å½•ä¸¤ç§ç‰¹ç‚¹&lt;/strong&gt;ã€‚æ—¢åƒæ–‡ä»¶ä¸€æ ·ç»´æŠ¤ç€æ•°æ®ã€å…ƒä¿¡æ¯ã€ACLã€æ—¶é—´æˆ³ç­‰æ•°æ®ç»“æ„ï¼Œåˆåƒç›®å½•ä¸€æ ·å¯ä»¥ä½œä¸ºè·¯å¾„æ ‡è¯†çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶å¯ä»¥å…·æœ‰å­ &lt;code&gt;Znode&lt;/code&gt;ã€‚ç”¨æˆ·å¯¹ &lt;code&gt;Znode&lt;/code&gt; å…·æœ‰å¢ã€åˆ ã€æ”¹ã€æŸ¥ç­‰æ“ä½œï¼ˆæƒé™å…è®¸çš„æƒ…å†µä¸‹ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Znode&lt;/code&gt; å…·æœ‰åŸå­æ€§æ“ä½œ&lt;/strong&gt;ï¼Œè¯»æ“ä½œå°†è·å–ä¸èŠ‚ç‚¹ç›¸å…³çš„æ‰€æœ‰æ•°æ®ï¼Œå†™æ“ä½œä¹Ÿå°†æ›¿æ¢æ‰èŠ‚ç‚¹çš„æ‰€æœ‰æ•°æ®ã€‚å¦å¤–ï¼Œæ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½æ‹¥æœ‰è‡ªå·±çš„ ACL(è®¿é—®æ§åˆ¶åˆ—è¡¨)ï¼Œè¿™ä¸ªåˆ—è¡¨è§„å®šäº†ç”¨æˆ·çš„æƒé™ï¼Œå³é™å®šäº†ç‰¹å®šç”¨æˆ·å¯¹ç›®æ ‡èŠ‚ç‚¹å¯ä»¥æ‰§è¡Œçš„æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Znode&lt;/code&gt; å­˜å‚¨æ•°æ®å¤§å°æœ‰é™åˆ¶&lt;/strong&gt;ã€‚&lt;code&gt;ZooKeeper&lt;/code&gt; è™½ç„¶å¯ä»¥å…³è”ä¸€äº›æ•°æ®ï¼Œä½†å¹¶æ²¡æœ‰è¢«è®¾è®¡ä¸ºå¸¸è§„çš„æ•°æ®åº“æˆ–è€…å¤§æ•°æ®å­˜å‚¨ï¼Œç›¸åçš„æ˜¯ï¼Œå®ƒç”¨æ¥ç®¡ç†è°ƒåº¦æ•°æ®ï¼Œæ¯”å¦‚åˆ†å¸ƒå¼åº”ç”¨ä¸­çš„é…ç½®æ–‡ä»¶ä¿¡æ¯ã€çŠ¶æ€ä¿¡æ¯ã€æ±‡é›†ä½ç½®ç­‰ç­‰ã€‚è¿™äº›æ•°æ®çš„å…±åŒç‰¹æ€§å°±æ˜¯å®ƒä»¬éƒ½æ˜¯å¾ˆå°çš„æ•°æ®ï¼Œ&lt;strong&gt;é€šå¸¸ä»¥ KB ä¸ºå¤§å°å•ä½&lt;/strong&gt;ã€‚ZooKeeper çš„æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯éƒ½è¢«è®¾è®¡ä¸ºä¸¥æ ¼æ£€æŸ¥å¹¶é™åˆ¶æ¯ä¸ª Znode çš„æ•°æ®å¤§å°è‡³å¤š 1Mï¼Œå½“æ—¶å¸¸è§„ä½¿ç”¨ä¸­åº”è¯¥è¿œå°äºæ­¤å€¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;Znode&lt;/code&gt; é€šè¿‡è·¯å¾„å¼•ç”¨&lt;/strong&gt;ï¼Œå¦‚åŒ &lt;code&gt;Unix&lt;/code&gt; ä¸­çš„æ–‡ä»¶è·¯å¾„ã€‚&lt;strong&gt;è·¯å¾„å¿…é¡»æ˜¯ç»å¯¹çš„&lt;/strong&gt;ï¼Œå› æ­¤ä»–ä»¬å¿…é¡»&lt;strong&gt;ç”±æ–œæ å­—ç¬¦æ¥å¼€å¤´&lt;/strong&gt;ã€‚é™¤æ­¤ä»¥å¤–ï¼Œä»–ä»¬å¿…é¡»æ˜¯å”¯ä¸€çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯ä¸€ä¸ªè·¯å¾„åªæœ‰ä¸€ä¸ªè¡¨ç¤ºï¼Œå› æ­¤è¿™äº›è·¯å¾„ä¸èƒ½æ”¹å˜ã€‚åœ¨ &lt;code&gt;ZooKeeper&lt;/code&gt; ä¸­ï¼Œè·¯å¾„ç”± &lt;code&gt;Unicode&lt;/code&gt; å­—ç¬¦ä¸²ç»„æˆï¼Œå¹¶ä¸”æœ‰ä¸€äº›é™åˆ¶ã€‚å­—ç¬¦ä¸²&amp;quot;/zookeeper&amp;quot;ç”¨ä»¥ä¿å­˜ç®¡ç†ä¿¡æ¯ï¼Œæ¯”å¦‚å…³é”®é…é¢ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;31æ•°æ®ç»“æ„å›¾&#34;&gt;3.1ï¼æ•°æ®ç»“æ„å›¾&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/1584240732240.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å›¾ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹ç§°ä¸ºä¸€ä¸ª &lt;code&gt;Znode&lt;/code&gt;ã€‚ æ¯ä¸ª &lt;code&gt;Znode&lt;/code&gt; ç”± 3 éƒ¨åˆ†ç»„æˆ:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;stat&lt;/code&gt;ï¼šæ­¤ä¸ºçŠ¶æ€ä¿¡æ¯, æè¿°è¯¥ &lt;code&gt;Znode&lt;/code&gt; çš„ç‰ˆæœ¬, æƒé™ç­‰ä¿¡æ¯&lt;/li&gt;
&lt;li&gt;&lt;code&gt;data&lt;/code&gt;ï¼šä¸è¯¥ &lt;code&gt;Znode&lt;/code&gt; å…³è”çš„æ•°æ®&lt;/li&gt;
&lt;li&gt;&lt;code&gt;children&lt;/code&gt;ï¼šè¯¥ &lt;code&gt;Znode&lt;/code&gt; ä¸‹çš„å­èŠ‚ç‚¹&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;32èŠ‚ç‚¹ç±»å‹&#34;&gt;3.2ï¼èŠ‚ç‚¹ç±»å‹&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;Znode&lt;/code&gt; æœ‰ä¸¤ç§ï¼Œåˆ†åˆ«ä¸º&lt;strong&gt;ä¸´æ—¶èŠ‚ç‚¹&lt;/strong&gt;å’Œ&lt;strong&gt;æ°¸ä¹…èŠ‚ç‚¹&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;èŠ‚ç‚¹çš„ç±»å‹&lt;strong&gt;åœ¨åˆ›å»ºæ—¶å³è¢«ç¡®å®šï¼Œå¹¶ä¸”ä¸èƒ½æ”¹å˜ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸´æ—¶èŠ‚ç‚¹&lt;/strong&gt;ï¼šè¯¥èŠ‚ç‚¹çš„ç”Ÿå‘½å‘¨æœŸä¾èµ–äºåˆ›å»ºå®ƒä»¬çš„ä¼šè¯ã€‚ä¸€æ—¦&lt;strong&gt;ä¼šè¯ç»“æŸï¼Œä¸´æ—¶èŠ‚ç‚¹å°†è¢«è‡ªåŠ¨åˆ é™¤&lt;/strong&gt;ï¼Œå½“ç„¶å¯ä»¥ä¹Ÿå¯ä»¥æ‰‹åŠ¨åˆ é™¤ã€‚&lt;strong&gt;ä¸´æ—¶èŠ‚ç‚¹ä¸å…è®¸æ‹¥æœ‰å­èŠ‚ç‚¹&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ°¸ä¹…èŠ‚ç‚¹&lt;/strong&gt;ï¼šè¯¥èŠ‚ç‚¹çš„ç”Ÿå‘½å‘¨æœŸä¸ä¾èµ–äºä¼šè¯ï¼Œå¹¶ä¸”åªæœ‰åœ¨å®¢æˆ·ç«¯æ˜¾ç¤ºæ‰§è¡Œåˆ é™¤æ“ä½œçš„æ—¶å€™ï¼Œä»–ä»¬æ‰èƒ½è¢«åˆ é™¤ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Znode&lt;/code&gt; è¿˜æœ‰ä¸€ä¸ª&lt;strong&gt;åºåˆ—åŒ–&lt;/strong&gt;çš„ç‰¹æ€§ï¼Œå¦‚æœåˆ›å»ºçš„æ—¶å€™æŒ‡å®šçš„è¯ï¼Œè¯¥ &lt;code&gt;Znode&lt;/code&gt; çš„åå­—åé¢ä¼š&lt;strong&gt;è‡ªåŠ¨è¿½åŠ ä¸€ä¸ªä¸æ–­å¢åŠ çš„åºåˆ—å·&lt;/strong&gt;ã€‚åºåˆ—å·å¯¹äºæ­¤èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹æ¥è¯´æ˜¯å”¯ä¸€çš„ï¼Œè¿™æ ·ä¾¿ä¼š&lt;strong&gt;è®°å½•æ¯ä¸ªå­èŠ‚ç‚¹åˆ›å»ºçš„å…ˆåé¡ºåº&lt;/strong&gt;ã€‚å®ƒçš„æ ¼å¼ä¸ºâ€œ%10dâ€(10 ä½æ•°å­—ï¼Œæ²¡æœ‰æ•°å€¼çš„æ•°ä½ç”¨ 0 è¡¥å……ï¼Œä¾‹å¦‚â€œ0000000001â€)ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/1584240804281.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;è¿™æ ·ä¾¿ä¼šå­˜åœ¨å››ç§ç±»å‹çš„ &lt;code&gt;Znode&lt;/code&gt; èŠ‚ç‚¹ï¼Œåˆ†åˆ«å¯¹åº”ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;PERSISTENT&lt;/code&gt;ï¼šæ°¸ä¹…èŠ‚ç‚¹&lt;/li&gt;
&lt;li&gt;&lt;code&gt;EPHEMERAL&lt;/code&gt;ï¼šä¸´æ—¶èŠ‚ç‚¹&lt;/li&gt;
&lt;li&gt;&lt;code&gt;PERSISTENT_SEQUENTIAL&lt;/code&gt;ï¼šæ°¸ä¹…èŠ‚ç‚¹ã€åºåˆ—åŒ–&lt;/li&gt;
&lt;li&gt;&lt;code&gt;EPHEMERAL_SEQUENTIAL&lt;/code&gt;ï¼šä¸´æ—¶èŠ‚ç‚¹ã€åºåˆ—åŒ–&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;4-zookeeper-watcher&#34;&gt;4ï¼ ZooKeeper Watcher&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;ZooKeeper&lt;/code&gt; æä¾›äº†åˆ†å¸ƒå¼æ•°æ®&lt;strong&gt;å‘å¸ƒ/è®¢é˜…åŠŸèƒ½&lt;/strong&gt;ï¼Œä¸€ä¸ªå…¸å‹çš„å‘å¸ƒ/è®¢é˜…æ¨¡å‹ç³»ç»Ÿå®šä¹‰äº†ä¸€ç§ä¸€å¯¹å¤šçš„è®¢é˜…å…³ç³»ï¼Œèƒ½è®©å¤šä¸ªè®¢é˜…è€…åŒæ—¶ç›‘å¬æŸä¸€ä¸ªä¸»é¢˜å¯¹è±¡ï¼Œå½“è¿™ä¸ªä¸»é¢˜å¯¹è±¡è‡ªèº«çŠ¶æ€å˜åŒ–æ—¶ï¼Œä¼šé€šçŸ¥æ‰€æœ‰è®¢é˜…è€…ï¼Œä½¿ä»–ä»¬èƒ½å¤Ÿåšå‡ºç›¸åº”çš„å¤„ç†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ZooKeeper&lt;/code&gt; ä¸­ï¼Œå¼•å…¥äº† &lt;strong&gt;Watcher æœºåˆ¶æ¥å®ç°è¿™ç§åˆ†å¸ƒå¼çš„é€šçŸ¥åŠŸèƒ½&lt;/strong&gt; ã€‚ &lt;code&gt;ZooKeeper&lt;/code&gt; å…è®¸å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯æ³¨å†Œä¸€ä¸ª &lt;code&gt;Watcher&lt;/code&gt; ç›‘å¬ï¼Œå½“æœåŠ¡ç«¯çš„ä¸€äº›äº‹ä»¶è§¦å‘äº†è¿™ä¸ª &lt;code&gt;Watcher&lt;/code&gt;ï¼Œé‚£ä¹ˆå°±ä¼šå‘æŒ‡å®šå®¢æˆ·ç«¯å‘é€ä¸€ä¸ªäº‹ä»¶é€šçŸ¥æ¥å®ç°åˆ†å¸ƒå¼çš„é€šçŸ¥åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;è§¦å‘äº‹ä»¶ç§ç±»å¾ˆå¤šï¼Œå¦‚ï¼šèŠ‚ç‚¹åˆ›å»ºï¼ŒèŠ‚ç‚¹åˆ é™¤ï¼ŒèŠ‚ç‚¹æ”¹å˜ï¼Œå­èŠ‚ç‚¹æ”¹å˜ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;æ€»çš„æ¥è¯´å¯ä»¥æ¦‚æ‹¬ &lt;code&gt;Watcher&lt;/code&gt; ä¸ºä»¥ä¸‹ä¸‰ä¸ªè¿‡ç¨‹ï¼š&lt;strong&gt;å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯æ³¨å†Œ &lt;code&gt;Watcher&lt;/code&gt;ã€æœåŠ¡ç«¯äº‹ä»¶å‘ç”Ÿè§¦å‘ &lt;code&gt;Watcher&lt;/code&gt;ã€å®¢æˆ·ç«¯å›è°ƒ &lt;code&gt;Watcher&lt;/code&gt; å¾—åˆ°è§¦å‘äº‹ä»¶æƒ…å†µ&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;41-watch-æœºåˆ¶ç‰¹ç‚¹&#34;&gt;4.1ï¼ Watch æœºåˆ¶ç‰¹ç‚¹&lt;/h2&gt;
&lt;h3 id=&#34;ä¸€æ¬¡æ€§è§¦å‘&#34;&gt;&lt;strong&gt;ä¸€æ¬¡æ€§è§¦å‘&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;äº‹ä»¶å‘ç”Ÿè§¦å‘ç›‘å¬ï¼Œä¸€ä¸ª &lt;code&gt;watcher event&lt;/code&gt; å°±ä¼šè¢«å‘é€åˆ°è®¾ç½®ç›‘å¬çš„å®¢æˆ·ç«¯ï¼Œè¿™ç§æ•ˆæœæ˜¯ä¸€æ¬¡æ€§çš„ï¼Œåç»­å†æ¬¡å‘ç”ŸåŒæ ·çš„äº‹ä»¶ï¼Œä¸ä¼šå†æ¬¡è§¦å‘ã€‚&lt;/p&gt;
&lt;h3 id=&#34;äº‹ä»¶å°è£…&#34;&gt;&lt;strong&gt;äº‹ä»¶å°è£…&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;ZooKeeper&lt;/code&gt; ä½¿ç”¨ &lt;code&gt;WatchedEvent&lt;/code&gt; å¯¹è±¡æ¥å°è£…æœåŠ¡ç«¯äº‹ä»¶å¹¶ä¼ é€’ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;WatchedEvent&lt;/code&gt; åŒ…å«äº†æ¯ä¸€ä¸ªäº‹ä»¶çš„ä¸‰ä¸ªåŸºæœ¬å±æ€§ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;é€šçŸ¥çŠ¶æ€ï¼ˆ&lt;code&gt;keeperState&lt;/code&gt;ï¼‰ï¼Œäº‹ä»¶ç±»å‹ï¼ˆ&lt;code&gt;EventType&lt;/code&gt;ï¼‰å’ŒèŠ‚ç‚¹è·¯å¾„ï¼ˆ&lt;code&gt;path&lt;/code&gt;ï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&#34;event-å¼‚æ­¥å‘é€&#34;&gt;&lt;strong&gt;event å¼‚æ­¥å‘é€&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;watcher&lt;/code&gt; çš„é€šçŸ¥äº‹ä»¶ä»æœåŠ¡ç«¯å‘é€åˆ°å®¢æˆ·ç«¯æ˜¯å¼‚æ­¥çš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å…ˆæ³¨å†Œå†è§¦å‘&#34;&gt;&lt;strong&gt;å…ˆæ³¨å†Œå†è§¦å‘&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;Zookeeper&lt;/code&gt; ä¸­çš„ &lt;code&gt;watch&lt;/code&gt; æœºåˆ¶ï¼Œå¿…é¡»å®¢æˆ·ç«¯å…ˆå»æœåŠ¡ç«¯æ³¨å†Œç›‘å¬ï¼Œè¿™æ ·äº‹ä»¶å‘é€æ‰ä¼šè§¦å‘ç›‘å¬ï¼Œé€šçŸ¥ç»™å®¢æˆ·ç«¯ã€‚&lt;/p&gt;
&lt;h1 id=&#34;5-zookeeper-é€‰ä¸¾æœºåˆ¶&#34;&gt;5ï¼ ZooKeeper é€‰ä¸¾æœºåˆ¶&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;zookeeper&lt;/code&gt; é»˜è®¤çš„ç®—æ³•æ˜¯ &lt;code&gt;FastLeaderElection&lt;/code&gt;ï¼Œé‡‡ç”¨æŠ•ç¥¨æ•°å¤§äºåŠæ•°åˆ™èƒœå‡ºçš„é€»è¾‘ã€‚&lt;/p&gt;
&lt;h2 id=&#34;51-æ¦‚å¿µ&#34;&gt;5.1ï¼ æ¦‚å¿µ&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;æœåŠ¡å™¨ ID&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ¯”å¦‚æœ‰ä¸‰å°æœåŠ¡å™¨ï¼Œç¼–å·åˆ†åˆ«æ˜¯ 1,2,3ã€‚&lt;/li&gt;
&lt;li&gt;ç¼–å·è¶Šå¤§åœ¨é€‰æ‹©ç®—æ³•ä¸­çš„æƒé‡è¶Šå¤§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;é€‰ä¸¾çŠ¶æ€&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;LOOKING&lt;/code&gt;ï¼Œç«é€‰çŠ¶æ€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;FOLLOWING&lt;/code&gt;ï¼Œéšä»çŠ¶æ€ï¼ŒåŒæ­¥ &lt;code&gt;leader&lt;/code&gt; çŠ¶æ€ï¼Œå‚ä¸æŠ•ç¥¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;OBSERVING&lt;/code&gt;ï¼Œè§‚å¯ŸçŠ¶æ€,åŒæ­¥ &lt;code&gt;leader&lt;/code&gt; çŠ¶æ€ï¼Œä¸å‚ä¸æŠ•ç¥¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;LEADING&lt;/code&gt;ï¼Œé¢†å¯¼è€…çŠ¶æ€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;æ•°æ® ID&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æœåŠ¡å™¨ä¸­å­˜æ”¾çš„æœ€æ–°æ•°æ® &lt;code&gt;version&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å€¼è¶Šå¤§è¯´æ˜æ•°æ®è¶Šæ–°ï¼Œåœ¨é€‰ä¸¾ç®—æ³•ä¸­æ•°æ®è¶Šæ–°æƒé‡è¶Šå¤§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;é€»è¾‘æ—¶é’Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¹Ÿå«æŠ•ç¥¨çš„æ¬¡æ•°ï¼ŒåŒä¸€è½®æŠ•ç¥¨è¿‡ç¨‹ä¸­çš„é€»è¾‘æ—¶é’Ÿå€¼æ˜¯ç›¸åŒçš„ã€‚æ¯æŠ•å®Œä¸€æ¬¡ç¥¨è¿™ä¸ªæ•°æ®å°±ä¼šå¢åŠ ï¼Œç„¶åä¸æ¥æ”¶åˆ°çš„å…¶å®ƒæœåŠ¡å™¨è¿”å›çš„æŠ•ç¥¨ä¿¡æ¯ä¸­çš„æ•°å€¼ç›¸æ¯”ï¼Œæ ¹æ®ä¸åŒçš„å€¼åšå‡ºä¸åŒçš„åˆ¤æ–­ã€‚&lt;/p&gt;
&lt;h2 id=&#34;52-å…¨æ–°é›†ç¾¤é€‰ä¸¾&#34;&gt;5.2ï¼ å…¨æ–°é›†ç¾¤é€‰ä¸¾&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/1584240883089.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;å‡è®¾ç›®å‰æœ‰ 5 å°æœåŠ¡å™¨ï¼Œ&lt;strong&gt;æ¯å°æœåŠ¡å™¨å‡æ²¡æœ‰æ•°æ®&lt;/strong&gt;ï¼Œå®ƒä»¬çš„ç¼–å·åˆ†åˆ«æ˜¯1,2,3,4,5,&lt;strong&gt;æŒ‰ç¼–å·ä¾æ¬¡å¯åŠ¨&lt;/strong&gt;ï¼Œå®ƒä»¬çš„é€‰æ‹©ä¸¾è¿‡ç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æœåŠ¡å™¨ 1 å¯åŠ¨ï¼Œç»™è‡ªå·±æŠ•ç¥¨ï¼Œç„¶åå‘æŠ•ç¥¨ä¿¡æ¯ï¼Œç”±äºå…¶å®ƒæœºå™¨è¿˜æ²¡æœ‰å¯åŠ¨æ‰€ä»¥å®ƒæ”¶ä¸åˆ°åé¦ˆä¿¡æ¯ï¼ŒæœåŠ¡å™¨ 1 çš„çŠ¶æ€ä¸€ç›´å±äº &lt;code&gt;Looking&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æœåŠ¡å™¨ 2 å¯åŠ¨ï¼Œç»™è‡ªå·±æŠ•ç¥¨ï¼ŒåŒæ—¶ä¸ä¹‹å‰å¯åŠ¨çš„æœåŠ¡å™¨ 1 äº¤æ¢ç»“æœï¼Œç”±äºæœåŠ¡å™¨ 2 çš„ç¼–å·å¤§æ‰€ä»¥æœåŠ¡å™¨ 2 èƒœå‡ºï¼Œä½†æ­¤æ—¶æŠ•ç¥¨æ•°æ²¡æœ‰å¤§äºåŠæ•°ï¼Œæ‰€ä»¥ä¸¤ä¸ªæœåŠ¡å™¨çš„çŠ¶æ€ä¾ç„¶æ˜¯ &lt;code&gt;LOOKING&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æœåŠ¡å™¨ 3 å¯åŠ¨ï¼Œç»™è‡ªå·±æŠ•ç¥¨ï¼ŒåŒæ—¶ä¸ä¹‹å‰å¯åŠ¨çš„æœåŠ¡å™¨ 1,2 äº¤æ¢ä¿¡æ¯ï¼Œç”±äºæœåŠ¡å™¨ 3 çš„ç¼–å·æœ€å¤§æ‰€ä»¥æœåŠ¡å™¨ 3 èƒœå‡ºï¼Œæ­¤æ—¶æŠ•ç¥¨æ•°æ­£å¥½å¤§äºåŠæ•°ï¼Œæ‰€ä»¥æœåŠ¡å™¨ 3 æˆä¸ºé¢†å¯¼è€…ï¼ŒæœåŠ¡å™¨ 1,2 æˆä¸ºå°å¼Ÿã€‚&lt;/li&gt;
&lt;li&gt;æœåŠ¡å™¨ 4 å¯åŠ¨ï¼Œç»™è‡ªå·±æŠ•ç¥¨ï¼ŒåŒæ—¶ä¸ä¹‹å‰å¯åŠ¨çš„æœåŠ¡å™¨ 1,2,3 äº¤æ¢ä¿¡æ¯ï¼Œå°½ç®¡æœåŠ¡å™¨ 4 çš„ç¼–å·å¤§ï¼Œä½†ä¹‹å‰æœåŠ¡å™¨ 3 å·²ç»èƒœå‡ºï¼Œæ‰€ä»¥æœåŠ¡å™¨ 4 åªèƒ½æˆä¸ºå°å¼Ÿã€‚&lt;/li&gt;
&lt;li&gt;æœåŠ¡å™¨ 5 å¯åŠ¨ï¼Œåé¢çš„é€»è¾‘åŒæœåŠ¡å™¨ 4 æˆä¸ºå°å¼Ÿã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;53-éå…¨æ–°é›†ç¾¤é€‰ä¸¾&#34;&gt;5.3ï¼ éå…¨æ–°é›†ç¾¤é€‰ä¸¾&lt;/h2&gt;
&lt;p&gt;å¯¹äºè¿è¡Œæ­£å¸¸çš„ &lt;code&gt;zookeeper&lt;/code&gt; é›†ç¾¤ï¼Œä¸­é€”æœ‰æœºå™¨ &lt;code&gt;down&lt;/code&gt; æ‰ï¼Œéœ€è¦é‡æ–°é€‰ä¸¾æ—¶ï¼Œé€‰ä¸¾è¿‡ç¨‹å°±éœ€è¦åŠ å…¥&lt;strong&gt;æ•°æ® ID&lt;/strong&gt;ã€&lt;strong&gt;æœåŠ¡å™¨ ID&lt;/strong&gt; å’Œ&lt;strong&gt;é€»è¾‘æ—¶é’Ÿ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ•°æ® IDï¼šæ•°æ®æ–°çš„ &lt;code&gt;version&lt;/code&gt; å°±å¤§ï¼Œæ•°æ®æ¯æ¬¡æ›´æ–°éƒ½ä¼šæ›´æ–° &lt;code&gt;version&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æœåŠ¡å™¨ IDï¼šå°±æ˜¯æˆ‘ä»¬é…ç½®çš„ &lt;code&gt;myid&lt;/code&gt; ä¸­çš„å€¼ï¼Œæ¯ä¸ªæœºå™¨ä¸€ä¸ªã€‚&lt;/p&gt;
&lt;p&gt;é€»è¾‘æ—¶é’Ÿï¼šè¿™ä¸ªå€¼ä» 0 å¼€å§‹é€’å¢,æ¯æ¬¡é€‰ä¸¾å¯¹åº”ä¸€ä¸ªå€¼ã€‚ å¦‚æœåœ¨åŒä¸€æ¬¡é€‰ä¸¾ä¸­,è¿™ä¸ªå€¼æ˜¯ä¸€è‡´çš„ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ ·é€‰ä¸¾çš„æ ‡å‡†å°±å˜æˆï¼š&lt;/p&gt;
&lt;p&gt;1ã€é€»è¾‘æ—¶é’Ÿå°çš„é€‰ä¸¾ç»“æœè¢«å¿½ç•¥ï¼Œé‡æ–°æŠ•ç¥¨ï¼›&lt;/p&gt;
&lt;p&gt;2ã€ç»Ÿä¸€é€»è¾‘æ—¶é’Ÿåï¼Œæ•°æ® id å¤§çš„èƒœå‡ºï¼›&lt;/p&gt;
&lt;p&gt;3ã€æ•°æ® id ç›¸åŒçš„æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨ id å¤§çš„èƒœå‡ºï¼›æ ¹æ®è¿™ä¸ªè§„åˆ™é€‰å‡º &lt;code&gt;leader&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h1 id=&#34;6-zookeeper-å…¸å‹åº”ç”¨&#34;&gt;6ï¼ ZooKeeper å…¸å‹åº”ç”¨&lt;/h1&gt;
&lt;h2 id=&#34;61-æ•°æ®å‘å¸ƒä¸è®¢é˜…é…ç½®ä¸­å¿ƒ&#34;&gt;6.1ï¼ æ•°æ®å‘å¸ƒä¸è®¢é˜…ï¼ˆé…ç½®ä¸­å¿ƒï¼‰&lt;/h2&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/1584241030128.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;å‘å¸ƒä¸è®¢é˜…æ¨¡å‹ï¼Œå³æ‰€è°“çš„é…ç½®ä¸­å¿ƒï¼Œé¡¾åæ€ä¹‰å°±æ˜¯&lt;strong&gt;å‘å¸ƒè€…å°†æ•°æ®å‘å¸ƒåˆ° ZKèŠ‚ç‚¹ä¸Šï¼Œä¾›è®¢é˜…è€…åŠ¨æ€è·å–æ•°æ®ï¼Œå®ç°é…ç½®ä¿¡æ¯çš„é›†ä¸­å¼ç®¡ç†å’ŒåŠ¨æ€æ›´æ–°&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åº”ç”¨åœ¨å¯åŠ¨çš„æ—¶å€™ä¼šä¸»åŠ¨æ¥è·å–ä¸€æ¬¡é…ç½®ï¼ŒåŒæ—¶ï¼Œåœ¨èŠ‚ç‚¹ä¸Šæ³¨å†Œä¸€ä¸ª &lt;code&gt;Watcher&lt;/code&gt;ï¼Œè¿™æ ·ä¸€æ¥ï¼Œä»¥åæ¯æ¬¡é…ç½®æœ‰æ›´æ–°çš„æ—¶å€™ï¼Œéƒ½ä¼šå®æ—¶é€šçŸ¥åˆ°è®¢é˜…çš„å®¢æˆ·ç«¯ï¼Œä»æ¥è¾¾åˆ°è·å–æœ€æ–°é…ç½®ä¿¡æ¯çš„ç›®çš„ã€‚æ¯”å¦‚ï¼š&lt;/p&gt;
&lt;p&gt;åˆ†å¸ƒå¼æœç´¢æœåŠ¡ä¸­ï¼Œç´¢å¼•çš„å…ƒä¿¡æ¯å’ŒæœåŠ¡å™¨é›†ç¾¤æœºå™¨çš„èŠ‚ç‚¹çŠ¶æ€å­˜æ”¾åœ¨ ZK çš„ä¸€äº›æŒ‡å®šèŠ‚ç‚¹ï¼Œä¾›å„ä¸ªå®¢æˆ·ç«¯è®¢é˜…ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„ï¼šé€‚åˆ&lt;strong&gt;æ•°æ®é‡å¾ˆå°çš„åœºæ™¯&lt;/strong&gt;ï¼Œè¿™æ ·æ•°æ®æ›´æ–°å¯èƒ½ä¼šæ¯”è¾ƒå¿«ã€‚&lt;/p&gt;
&lt;h2 id=&#34;62-å‘½åæœåŠ¡naming-service&#34;&gt;6.2ï¼ å‘½åæœåŠ¡(Naming Service)&lt;/h2&gt;
&lt;p&gt;åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œ&lt;strong&gt;é€šè¿‡ä½¿ç”¨å‘½åæœåŠ¡ï¼Œå®¢æˆ·ç«¯åº”ç”¨èƒ½å¤Ÿæ ¹æ®æŒ‡å®šåå­—æ¥è·å–èµ„æºæˆ–æœåŠ¡çš„åœ°å€ï¼Œæä¾›è€…ç­‰ä¿¡æ¯&lt;/strong&gt;ã€‚è¢«å‘½åçš„å®ä½“é€šå¸¸å¯ä»¥æ˜¯é›†ç¾¤ä¸­çš„æœºå™¨ï¼Œæä¾›çš„æœåŠ¡åœ°å€ï¼Œè¿œç¨‹å¯¹è±¡ç­‰ç­‰â€”â€”è¿™äº›æˆ‘ä»¬éƒ½å¯ä»¥ç»Ÿç§°ä»–ä»¬ä¸ºåå­—ï¼ˆNameï¼‰ã€‚å…¶ä¸­è¾ƒä¸ºå¸¸è§çš„å°±æ˜¯ä¸€äº›åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶ä¸­çš„æœåŠ¡åœ°å€åˆ—è¡¨ã€‚é€šè¿‡&lt;strong&gt;è°ƒç”¨ ZK æä¾›çš„åˆ›å»ºèŠ‚ç‚¹çš„ API&lt;/strong&gt;ï¼Œèƒ½å¤Ÿå¾ˆå®¹æ˜“åˆ›å»ºä¸€ä¸ª&lt;strong&gt;å…¨å±€å”¯ä¸€çš„ path&lt;/strong&gt;ï¼Œè¿™ä¸ª path å°±å¯ä»¥ä½œä¸ºä¸€ä¸ªåç§°ã€‚&lt;/p&gt;
&lt;p&gt;é˜¿é‡Œå·´å·´é›†å›¢å¼€æºçš„åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶ &lt;strong&gt;Dubbo ä¸­ä½¿ç”¨ ZooKeeper æ¥ä½œä¸ºå…¶å‘½åæœåŠ¡&lt;/strong&gt;ï¼Œç»´æŠ¤å…¨å±€çš„æœåŠ¡åœ°å€åˆ—è¡¨ã€‚&lt;/p&gt;
&lt;h2 id=&#34;63-åˆ†å¸ƒå¼é”&#34;&gt;6.3ï¼ åˆ†å¸ƒå¼é”&lt;/h2&gt;
&lt;p&gt;åˆ†å¸ƒå¼é”ï¼Œè¿™ä¸ªä¸»è¦å¾—ç›Šäº &lt;code&gt;ZooKeeper&lt;/code&gt; ä¿è¯äº†æ•°æ®çš„å¼ºä¸€è‡´æ€§ã€‚é”æœåŠ¡å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ä¸ªæ˜¯&lt;strong&gt;ä¿æŒç‹¬å &lt;/strong&gt;ï¼Œå¦ä¸€ä¸ªæ˜¯&lt;strong&gt;æ§åˆ¶æ—¶åº&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/1584241059824.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;æ‰€è°“&lt;strong&gt;ä¿æŒç‹¬å &lt;/strong&gt;ï¼Œå°±æ˜¯æ‰€æœ‰è¯•å›¾æ¥è·å–è¿™ä¸ªé”çš„å®¢æˆ·ç«¯ï¼Œæœ€ç»ˆåªæœ‰ä¸€ä¸ªå¯ä»¥æˆåŠŸè·å¾—è¿™æŠŠé”ã€‚é€šå¸¸çš„åšæ³•æ˜¯æŠŠ zk ä¸Šçš„ä¸€ä¸ª &lt;code&gt;znode&lt;/code&gt; çœ‹ä½œæ˜¯ä¸€æŠŠé”ï¼Œé€šè¿‡ &lt;code&gt;create znode&lt;/code&gt; çš„æ–¹å¼æ¥å®ç°ã€‚æ‰€æœ‰å®¢æˆ·ç«¯éƒ½å»åˆ›å»º &lt;code&gt;/distribute_lock&lt;/code&gt; &lt;strong&gt;ä¸´æ—¶éåºåˆ—åŒ–&lt;/strong&gt;èŠ‚ç‚¹ï¼Œæœ€ç»ˆæˆåŠŸåˆ›å»ºçš„é‚£ä¸ªå®¢æˆ·ç«¯ä¹Ÿå³æ‹¥æœ‰äº†è¿™æŠŠé”ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ§åˆ¶æ—¶åº&lt;/strong&gt;ï¼Œå°±æ˜¯æ‰€æœ‰è¯•å›¾æ¥è·å–è¿™ä¸ªé”çš„å®¢æˆ·ç«¯ï¼Œæœ€ç»ˆéƒ½æ˜¯ä¼šè¢«å®‰æ’æ‰§è¡Œï¼Œåªæ˜¯æœ‰ä¸ªå…¨å±€æ—¶åºäº†ã€‚åšæ³•å’Œä¸Šé¢åŸºæœ¬ç±»ä¼¼ï¼Œåªæ˜¯è¿™é‡Œ&lt;code&gt;/distribute_lock&lt;/code&gt; å·²ç»é¢„å…ˆå­˜åœ¨ï¼Œå®¢æˆ·ç«¯åœ¨å®ƒä¸‹é¢åˆ›å»º&lt;strong&gt;ä¸´æ—¶æœ‰åº&lt;/strong&gt;èŠ‚ç‚¹ï¼ˆè¿™ä¸ªå¯ä»¥é€šè¿‡èŠ‚ç‚¹çš„å±æ€§æ§åˆ¶ï¼š&lt;code&gt;CreateMode.EPHEMERAL_SEQUENTIAL&lt;/code&gt; æ¥æŒ‡å®šï¼‰ã€‚Zk çš„çˆ¶èŠ‚ç‚¹ï¼ˆ&lt;code&gt;/distribute_lock&lt;/code&gt;ï¼‰ç»´æŒä¸€ä»½ &lt;code&gt;sequence&lt;/code&gt;,ä¿è¯å­èŠ‚ç‚¹åˆ›å»ºçš„æ—¶åºæ€§ï¼Œä»è€Œä¹Ÿå½¢æˆäº†æ¯ä¸ªå®¢æˆ·ç«¯çš„å…¨å±€æ—¶åºã€‚&lt;/p&gt;
&lt;h1 id=&#34;7-zab-åè®®&#34;&gt;7ï¼ ZAB åè®®ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;ZAB åè®®æ˜¯ä¸ºåˆ†å¸ƒå¼åè°ƒæœåŠ¡ Zookeeper ä¸“é—¨è®¾è®¡çš„ä¸€ç§æ”¯æŒå´©æºƒæ¢å¤çš„åŸå­å¹¿æ’­åè®®ã€‚&lt;br&gt;
ZAB åè®®åŒ…æ‹¬ä¸¤ç§åŸºæœ¬çš„æ¨¡å¼ï¼š&lt;strong&gt;å´©æºƒæ¢å¤&lt;/strong&gt;å’Œ&lt;strong&gt;æ¶ˆæ¯å¹¿æ’­&lt;/strong&gt;ã€‚&lt;br&gt;
å½“æ•´ä¸ª zookeeper é›†ç¾¤åˆšåˆšå¯åŠ¨æˆ–è€… Leader æœåŠ¡å™¨å®•æœºã€é‡å¯æˆ–è€…ç½‘ç»œæ•…éšœå¯¼è‡´ä¸å­˜åœ¨è¿‡åŠçš„æœåŠ¡å™¨ä¸ Leader æœåŠ¡å™¨ä¿æŒæ­£å¸¸é€šä¿¡æ—¶ï¼Œæ‰€æœ‰è¿›ç¨‹ï¼ˆæœåŠ¡å™¨ï¼‰è¿›å…¥å´©æºƒæ¢å¤æ¨¡å¼ï¼Œé¦–å…ˆé€‰ä¸¾äº§ç”Ÿæ–°çš„ Leader æœåŠ¡å™¨ï¼Œç„¶åé›†ç¾¤ä¸­ Follower æœåŠ¡å™¨å¼€å§‹ä¸æ–°çš„ Leader æœåŠ¡å™¨è¿›è¡Œæ•°æ®åŒæ­¥ï¼Œå½“é›†ç¾¤ä¸­è¶…è¿‡åŠæ•°æœºå™¨ä¸è¯¥ LeaderæœåŠ¡å™¨å®Œæˆæ•°æ®åŒæ­¥ä¹‹åï¼Œé€€å‡ºæ¢å¤æ¨¡å¼è¿›å…¥æ¶ˆæ¯å¹¿æ’­æ¨¡å¼ï¼ŒLeader æœåŠ¡å™¨å¼€å§‹æ¥æ”¶å®¢æˆ·ç«¯çš„äº‹åŠ¡è¯·æ±‚ç”Ÿæˆäº‹ç‰©ææ¡ˆæ¥è¿›è¡Œäº‹åŠ¡è¯·æ±‚å¤„ç†ã€‚&lt;/p&gt;
&lt;h1 id=&#34;7-cap-å®šç†&#34;&gt;7ï¼ CAP å®šç†ï¼Ÿ&lt;/h1&gt;
&lt;p&gt;ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸å¯èƒ½åŒæ—¶æ»¡è¶³ä»¥ä¸‹ä¸‰ç§,&lt;strong&gt;ä¸€è‡´æ€§&lt;/strong&gt;ï¼ˆC:Consistencyï¼‰,&lt;strong&gt;å¯ç”¨æ€§&lt;/strong&gt;ï¼ˆA:Availableï¼‰,&lt;strong&gt;åˆ†åŒºå®¹é”™æ€§&lt;/strong&gt;ï¼ˆP:Partition Toleranceï¼‰.åœ¨æ­¤ZooKeeperä¿è¯çš„æ˜¯CPï¼ŒZooKeeperä¸èƒ½ä¿è¯æ¯æ¬¡æœåŠ¡è¯·æ±‚çš„å¯ç”¨æ€§ï¼Œåœ¨æç«¯ç¯å¢ƒä¸‹ï¼ŒZooKeeperå¯èƒ½ä¼šä¸¢å¼ƒä¸€äº›è¯·æ±‚ï¼Œæ¶ˆè´¹è€…ç¨‹åºéœ€è¦é‡æ–°è¯·æ±‚æ‰èƒ½è·å¾—ç»“æœã€‚å¦å¤–åœ¨è¿›è¡Œleaderé€‰ä¸¾æ—¶é›†ç¾¤éƒ½æ˜¯ä¸å¯ç”¨ï¼Œæ‰€ä»¥è¯´ï¼ŒZooKeeperä¸èƒ½ä¿è¯æœåŠ¡å¯ç”¨æ€§ã€‚ï¼ˆBaseç†è®ºCAå¼ºä¸€è‡´æ€§å’Œæœ€ç»ˆä¸€è‡´æ€§ï¼‰&lt;/p&gt;
">é¢è¯•é¢˜ç³»åˆ— â€”â€” Zookeeper</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/gridea-jian-ce-yuan-cheng-lian-jie-shi-bai/"" data-c="
          &lt;h1 id=&#34;é—®é¢˜ä¸€&#34;&gt;é—®é¢˜ä¸€&lt;/h1&gt;
&lt;h3 id=&#34;æˆ‘çš„ç¯å¢ƒ&#34;&gt;æˆ‘çš„ç¯å¢ƒ&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;åç§°&lt;/th&gt;
&lt;th&gt;å€¼&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;æ“ä½œç³»ç»Ÿ&lt;/td&gt;
&lt;td&gt;Windows10&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;è½¯ä»¶ç‰ˆæœ¬&lt;/td&gt;
&lt;td&gt;0.9.1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ä¸»é¢˜åç§°&lt;/td&gt;
&lt;td&gt;Notes&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;é—®é¢˜æè¿°&#34;&gt;é—®é¢˜æè¿°&lt;/h2&gt;
&lt;p&gt;æ ¹æ®æ•™ç¨‹è®¾ç½®å¥½ä¸€ç³»åˆ—ä¿¡æ¯ï¼Œç»æµ‹è¯•åŸŸåå¯è®¿é—®ï¼Œå¹¶ä¸”ç¡®ä¿å…¶ä»–ä¿¡æ¯å‡æ­£ç¡®&lt;/p&gt;
&lt;p&gt;æ£€æŸ¥è¿œç¨‹è¿æ¥é”™è¯¯ï¼š&lt;strong&gt;è¿œç¨‹è¿æ¥å¤±è´¥,è¯·æ£€æŸ¥ä»“åº“ã€ç”¨æˆ·åå’Œ token è®¾ç½®&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;é—®é¢˜åˆ†æ&#34;&gt;é—®é¢˜åˆ†æ&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;å…ˆæŸ¥çœ‹ &lt;code&gt;Gridea&lt;/code&gt; æ–‡ä»¶å­˜å‚¨ç›®å½•ï¼šC:\Users\Only\Documents\Gridea\output.git ä¸‹çš„ config æ–‡ä»¶ï¼Œçœ‹æ˜¯å¦æœ‰ [remote &amp;quot;origin&amp;quot;] ä¿¡æ¯ï¼Œå¦‚æœæ²¡æœ‰è‡ªè¡Œæ·»åŠ &lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;[remote &amp;quot;origin&amp;quot;]
	url = https://ä½ çš„githubç”¨æˆ·å:Token@github.com/ä½ çš„githubç”¨æˆ·/ä»“åº“å
	fetch = +refs/heads/*:refs/remotes/origin/*
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é™„ï¼šæŸ¥çœ‹&lt;code&gt;Gridea&lt;/code&gt;æ–‡ä»¶å­˜å‚¨ç›®å½•&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/1582604204611.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;æ£€æŸ¥é”™è¯¯ä¿¡æ¯ï¼š&lt;br&gt;
&lt;img src=&#34;https://epitomm.github.io/post-images/1582041933549.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;[&lt;em&gt;&amp;quot;fatal: unable to access &#39;https://github.com/Epitomâ€¦led to connect to github.com port 443: Timed outâ†µ&amp;quot;&lt;/em&gt;]&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;é—®é¢˜è§£å†³&#34;&gt;é—®é¢˜è§£å†³&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;è°·æ­Œ 433 é”™è¯¯ï¼Œå¾—çŸ¥æ˜¯&lt;strong&gt;æ²¡æœ‰è®¾ç½®ä»£ç†æœåŠ¡å™¨&lt;/strong&gt;çš„åŸå› ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä»¥ä¸‹ä¸ºç½‘ä¸Šä¸€é«˜èµè§£å†³æ–¹å¼ï¼Œå¯è‡ªè¡Œå°è¯•ï¼Œï¼ˆä¸è¿‡å¯¹æˆ‘çš„é—®é¢˜æ— æ•ˆæœï¼‰&lt;br&gt;
å‚è€ƒé“¾æ¥ï¼š&lt;a href=&#34;https://blog.csdn.net/runningman2012/article/details/54633677&#34;&gt;https://blog.csdn.net/runningman2012/article/details/54633677&lt;/a&gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/1582604339501.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;å†æ¬¡è°·æ­Œ git å¦‚ä½•è®¾ç½®ä»£ç†æœåŠ¡å™¨&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code&gt;git config --global http.proxy &#39;socks5://127.0.0.1:1080&#39;

git config --global https.proxy &#39;socks5://127.0.0.1:1080&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;a href=&#34;https://blog.csdn.net/isea533/article/details/84748009&#34;&gt;https://blog.csdn.net/isea533/article/details/84748009&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;å†æ¬¡å°è¯•æ£€æµ‹è¿œç¨‹è¿æ¥æˆåŠŸ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ¥ä¸‹æ¥åŒæ­¥æŸ¥çœ‹æ•ˆæœå®Œæˆåå°±å¯ä»¥å¼€å¯å¼€å¿ƒçš„å†™ä½œä¹‹æ—…å•¦~&lt;/p&gt;
&lt;h1 id=&#34;é—®é¢˜äºŒ&#34;&gt;é—®é¢˜äºŒ&lt;/h1&gt;
&lt;h3 id=&#34;æˆ‘çš„ç¯å¢ƒ-2&#34;&gt;æˆ‘çš„ç¯å¢ƒ&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;åç§°&lt;/th&gt;
&lt;th&gt;å€¼&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;æ“ä½œç³»ç»Ÿ&lt;/td&gt;
&lt;td&gt;Windows10&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;è½¯ä»¶ç‰ˆæœ¬&lt;/td&gt;
&lt;td&gt;0.9.2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ä¸»é¢˜åç§°&lt;/td&gt;
&lt;td&gt;Notes&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;é—®é¢˜æè¿°-2&#34;&gt;é—®é¢˜æè¿°&lt;/h2&gt;
&lt;p&gt;ç‰ˆæœ¬æ›´æ–°åˆ° 0.9.2 åé‡æ–°å®‰è£…äº† Gridea ï¼Œå†æ¬¡æ£€æµ‹è¿œç¨‹è¿æ¥å¤±è´¥&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/1582604400732.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;é”™è¯¯ä¿¡æ¯&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;connect ETIMEDOUT 140.82.114.4:443
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;é—®é¢˜åˆ†æ-2&#34;&gt;é—®é¢˜åˆ†æ&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;cmd å‘½ä»¤è¡Œ ping github.com å¤±è´¥ã€‚ä»£ç†é—®é¢˜&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;é—®é¢˜è§£å†³-2&#34;&gt;é—®é¢˜è§£å†³&lt;/h2&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;
&lt;p&gt;ä½¿ç”¨ ping æ£€æµ‹å·¥å…·æ‰¾ä¸€ä¸ªèƒ½å¤Ÿ ping é€š github.com çš„ IPï¼Œæ£€æµ‹å·¥å…·ç½‘å€å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://ping.chinaz.com/github.com&#34;&gt;http://ping.chinaz.com/github.com&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/1582041969896.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;é€‰æ‹©ä¸€ä¸ªå“åº”è¾ƒå¿«çš„ IPï¼Œæ·»åŠ åˆ° C:\Windows\System32\drivers\etc\host æ–‡ä»¶æœ«å°¾ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://epitomm.github.io/post-images/1582041983918.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;140.82.113.3 github.com
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;å†æ¬¡æ£€æµ‹è¿œç¨‹è¿æ¥ï¼ŒæˆåŠŸã€‚&lt;/li&gt;
&lt;/ol&gt;
">Gridea æ£€æµ‹è¿œç¨‹è¿æ¥å¤±è´¥</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://epitomm.github.io/post/about/"" data-c="
          &lt;blockquote&gt;
&lt;p&gt;æ¬¢è¿æ¥åˆ°æˆ‘çš„å°ç«™å‘€ï¼Œå¾ˆé«˜å…´é‡è§ä½ ï¼ğŸ¤&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;å…³äºæœ¬ç«™&#34;&gt;ğŸ  å…³äºæœ¬ç«™&lt;/h2&gt;
&lt;p&gt;æœ¬ç«™æ˜¯ä½¿ç”¨ &lt;code&gt;Gridea&lt;/code&gt; æ­å»ºçš„åšå®¢ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åšä¸»æ˜¯è°&#34;&gt;ğŸ‘¨â€ğŸ’» åšä¸»æ˜¯è°&lt;/h2&gt;
&lt;p&gt;åšä¸»æ˜¯ä¸€ä¸ª&lt;strong&gt;çƒ­æƒ…è€å¿ƒ&lt;/strong&gt;ï¼Œç›®å‰æ­£å‡†å¤‡æ‰¾å·¥ä½œçš„è€å­¦å§å‘€ï¼Œå¦‚æœæœ‰å¿—åŒé“åˆæƒ³è¦ä¸€èµ·å­¦ä¹ çš„å°ä¼™ä¼´ï¼Œæ¬¢è¿è”ç³»æˆ‘ä¸€èµ·å­¦ä¹ è¿›æ­¥å‘€ï¼›å¦‚æœæœ‰å¯¹å‰è·¯è¿·èŒ«ä¸çŸ¥æ‰€æªçš„å­¦å¼Ÿå­¦å¦¹ï¼Œä¹Ÿæ¬¢è¿è”ç³»æˆ‘æŠŠæˆ‘å­¦ä¹ çš„ç»éªŒä¼ æˆç»™ä½ ä»¬ï¼Œä¸æ•¢è¯´åšä½ ä»¬çš„æŒ‡è·¯æ˜ç¯ï¼Œä½†è‡³å°‘ä¼šè®©ä½ ä»¬åšå®šä¿¡å¿ƒã€ä¸å†ä¸çŸ¥æ‰€æªï¼›å¦‚æœæœ‰é—®é¢˜æƒ³å‘æˆ‘è¯·æ•™ï¼Œä¹Ÿæ¬¢è¿éšæ—¶æ¥æ‰¾æˆ‘å‘€ï¼Œæˆ‘æ˜¯çœŸçš„å¸®åŠ©å¾ˆå¤šäººè§£å†³è¿‡å„ç§&lt;code&gt;bug&lt;/code&gt; çš„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è”ç³»æˆ‘å‘€&#34;&gt;ğŸ“¬ è”ç³»æˆ‘å‘€&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;tencent://AddContact/?fromId=45&amp;amp;fromSubId=1&amp;amp;subcmd=all&amp;amp;uin=985317010&amp;amp;website=www.oicqzone.com&#34;&gt;QQ&lt;/a&gt;&lt;br&gt;
é‚®ç®±ï¼š985317010@qq.com&lt;/p&gt;
">å…³äº</a>
      </div>
      
    </div>
    <div class="page">
      <div id="page_ul"></div>
    </div>
  </div>
</div>
<script>
  !function () {
    let searchMask = document.querySelector('#search_mask');
    let result = document.querySelector('#result');
    let items = document.querySelectorAll('.item');
    let searchBox = document.querySelector('#search');
    let statCount = document.querySelector('#stat_count');
    let statTimes = document.querySelector('#stat_times');
    let pageUl = document.querySelector('#page_ul');
    let close = document.querySelector('#close');
    
    close.addEventListener('click', function() {
      searchMask.style = 'display: none;'
    })

    let finds = [];
    let contents = [];
    let pageSize = 10;
    items.forEach(item => {
      let a = item.querySelector('a');
      contents.push({
        title: a.innerText,
        details: a.dataset.c,
        link: a.href
      })
      item.remove();
    })

    function insertStr(soure, start, count) {
      let newStr = soure.substr(start, count);
      return soure.slice(0, start) + '<em>' + newStr + '</em>' + soure.slice(start + count);
    }

    pageUl.addEventListener('click', function(event) {
      let target = event.target;
      if (target.__proto__ === HTMLSpanElement.prototype) {
        appendResults(parseInt(target.dataset.i));
      }
    })

    function appendResults(index) {
      let htmlResult = '';
      let start = index || 0;
      let end = Math.min(start + pageSize, finds.length);
      for (let i = start; i < end; i++) {
        const current = finds[i];
        let html = current.title;
        let sum = 0;
        let positions = current.positions;
        positions.forEach(position => {
          html = insertStr(html, position.start + sum, position.count);
          sum += 9;
        })
        htmlResult += `<div class="item"><a class="result-title" href="${current.link}">${html}</a></div>`;
      }
      result.innerHTML = htmlResult;
      pageUl.innerHTML = '';
      let count = finds.length / pageSize;
      let lis = '';
      if (start !== 0) {
        lis += `<span class="fa fa-angle-left" data-i='${start - 1}'></span>`;
      }
      for (let i = 0; i < count; i++) {
        lis += `<span class='${i === start?'current':''}' data-i='${i}'>${i+1}</span>`;     
      }
      if (start+1 < count) {
        lis += `<span class="fa fa-angle-right" data-i='${start+1}'></span>`;  
      }
      pageUl.innerHTML = lis;
    }

    function search(delay) {
      let timer = null
      return function () {
        clearTimeout(timer)
        timer = setTimeout(() => {
          let start = Date.now();
          let segments = searchBox.value.split(' ').filter(c => c != '');
          if (segments.length <= 0) {
            return;
          }
          finds = [];
          let htmlResult = '';
          contents.forEach(content => {
            let title = content.title;
            let positions = [];
            let find = false;
            segments.forEach((segment) => {
              if (content.title.includes(segment)) {
                find = true;
                positions.push({
                  start: content.title.indexOf(segment),
                  count: segment.length
                })
              } else if (content.details.includes(segment)) {
                find = true;
              }
            });
            if (find) {
              finds.push({
                title: content.title,
                link: content.link,
                positions
              });
            }
          })
          appendResults(0);
          statCount.textContent = finds.length;
          statTimes.textContent = Date.now() - start;
        }, delay)
      }
    }
    searchBox.addEventListener('input', search(200));
  }()
</script>

<input hidden id="copy" />
<script>
  let language = '';
  if (language !== '') {
    let map = new Map();
    if (language === 'en') {
      map.set('search', 'Search');
      map.set('category', 'Categories');
      map.set('article', 'Articles');
      map.set('tag', 'Tags');
      map.set('top', 'Top');
      map.set('publish', 'published');
      map.set('minute', ' minutes');
      map.set('read-more', 'Read More');
      map.set('view', 'View');
      map.set('words', ' words');
      map.set('category-in', 'category in');
      map.set('preview', 'Meta');
      map.set('index', 'Toc');
      map.set('no-archives', "You haven't created yet");
      map.set('archives', " articles in total");
      map.set('cloud-tags', " tags in total");
      map.set('copyright', "Copyright: ");
      map.set('author', "Author: ");
      map.set('link', "Link: ");
      map.set('leave-message', "Leave a message");
      map.set('format', "Links Format");
      map.set('site-name', "Name: ");
      map.set('site-link', "Link: ");
      map.set('site-desc', "Desc: ");
      map.set('stat', " related results, taking ");
      map.set('stat-time', " ms");
      map.set('site-img', "Image: ");
    }

    if (map.size > 0) {
      let lanElems = document.querySelectorAll('.language');
      lanElems.forEach(elem => {
        let lan = elem.dataset.lan, text = map.get(lan);
        if (elem.__proto__ === HTMLInputElement.prototype) {
          elem.placeholder = text
        } else {
          if (elem.dataset.count) {
            text = elem.dataset.count + text;
          }
          elem.textContent = text;
        }
      })
    }
  }
  //æ‹¿æ¥ä¸»ä¹‰(çœŸé¦™)^_^ï¼ŒClipboard å®ç°æ‘˜è‡ªæ˜é‡‘ https://juejin.im/post/5aefeb6e6fb9a07aa43c20af
  window.Clipboard = (function (window, document, navigator) {
    var textArea,
      copy;

    // åˆ¤æ–­æ˜¯ä¸æ˜¯iosç«¯
    function isOS() {
      return navigator.userAgent.match(/ipad|iphone/i);
    }
    //åˆ›å»ºæ–‡æœ¬å…ƒç´ 
    function createTextArea(text) {
      textArea = document.createElement('textArea');
      textArea.value = text;
      textArea.style.width = 0;
      textArea.style.height = 0;
      textArea.clientHeight = 0;
      textArea.clientWidth = 0;
      document.body.appendChild(textArea);
    }
    //é€‰æ‹©å†…å®¹
    function selectText() {
      var range,
        selection;

      if (isOS()) {
        range = document.createRange();
        range.selectNodeContents(textArea);
        selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);
        textArea.setSelectionRange(0, 999999);
      } else {
        textArea.select();
      }
    }

    //å¤åˆ¶åˆ°å‰ªè´´æ¿
    function copyToClipboard() {
      try {
        document.execCommand("Copy")
      } catch (err) {
        alert("å¤åˆ¶é”™è¯¯ï¼è¯·æ‰‹åŠ¨å¤åˆ¶ï¼")
      }
      document.body.removeChild(textArea);
    }

    copy = function (text) {
      createTextArea(text);
      selectText();
      copyToClipboard();
    };

    return {
      copy: copy
    };
  })(window, document, navigator);

  function copyCode(e) {
    if (e.srcElement.tagName === 'SPAN' && e.srcElement.classList.contains('copy-code')) {
      let code = e.currentTarget.querySelector('code');
      var text = code.innerText;
      if (e.srcElement.textContent === 'å¤åˆ¶æˆåŠŸ') {
        console.log('å¤åˆ¶æ“ä½œé¢‘ç‡è¿‡é«˜');
        return;
      }
      e.srcElement.textContent = 'å¤åˆ¶æˆåŠŸ';
      (function (elem) {
        setTimeout(() => {
          if (elem.textContent === 'å¤åˆ¶æˆåŠŸ') {
            elem.textContent = 'å¤åˆ¶ä»£ç '
          }
        }, 1000);
      })(e.srcElement)
      Clipboard.copy(text);
    }
  }

  let pres = document.querySelectorAll('pre');
  pres.forEach(pre => {
    let code = pre.querySelector('code');
    let copyElem = document.createElement('span');
    copyElem.classList.add('copy-code');
    copyElem.textContent = 'å¤åˆ¶ä»£ç ';
    pre.appendChild(copyElem);
    pre.onclick = copyCode
  })

</script>
<script src="/media/js/motion.js"></script>

<script src="https://cdn.jsdelivr.net/gh/cferdinandi/smooth-scroll/dist/smooth-scroll.polyfills.min.js"></script>
<script>
  var scroll = new SmoothScroll('a[href*="#"]', {
    speed: 200
  });
</script>


<script src="/media/js/mouse/love.js"></script>


</html>